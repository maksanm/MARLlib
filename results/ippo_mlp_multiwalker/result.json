{"episode_reward_max": -271.59768710657954, "episode_reward_min": -344.72374200820923, "episode_reward_mean": -310.59417893035885, "episode_len_mean": 68.22727272727273, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {"shared_policy": -122.00295833746593}, "policy_reward_max": {"shared_policy": -85.54239647711317}, "policy_reward_mean": {"shared_policy": -103.5313929767863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-327.9740587621927, -344.72374200820923, -303.20558243989944, -316.65458101034164, -315.88307450711727, -300.4063839763403, -299.92387084662914, -284.34326358139515, -303.096837438643, -316.7059860378504, -317.149120874703, -314.8106687217951, -296.75751516222954, -302.203913718462, -305.13986027240753, -326.38130071759224, -334.1387130767107, -321.9666491448879, -329.7617204785347, -322.36758591234684, -282.48233702778816, -290.09100548923016, -290.3135578632355, -321.9963483065367, -305.84918485581875, -293.9128164870199, -296.97064507752657, -326.05867356061935, -305.4446603357792, -336.98602616786957, -317.3566083088517, -305.60772013664246, -271.59768710657954, -329.4210835099221, -282.91325274109846, -313.05883261561394, -304.15123304724693, -308.78040965646505, -314.9345145523548, -296.75219383090734, -299.7417227253318, -298.8884358033538, -294.6820483226329, -311.51541644334793, -300.07928970456123, -304.4345198199153, -314.00589549541473, -296.61322401463985, -306.9318514019251, -326.7376966923475, -305.07257398962975, -313.47302630543714, -306.59627309441566, -319.4107309877873, -338.54188179224735, -311.51798917632556, -318.11199064552784, -310.2107308059931, -311.7278046011925, -335.0139065980911, -320.1767241284251, -320.00997388362885, -337.3117011189461, -298.54307121410966, -312.5322956535966, -309.0618156194687], "episode_lengths": [50, 86, 67, 55, 63, 54, 56, 61, 61, 71, 49, 67, 64, 81, 59, 61, 104, 52, 70, 69, 73, 102, 66, 79, 60, 80, 87, 66, 68, 67, 61, 81, 87, 58, 72, 60, 64, 79, 63, 66, 66, 74, 62, 69, 71, 72, 81, 66, 49, 78, 79, 70, 62, 69, 107, 54, 65, 61, 57, 72, 76, 62, 60, 63, 59, 60], "policy_shared_policy_reward": [-104.54366974532604, -107.44405210018158, -115.9863369166851, -108.6418092250824, -117.34008014202118, -118.74185264110565, -97.08098762234053, -96.88844107588133, -109.23615374167761, -101.70159271359444, -113.39122927188873, -101.56175902485847, -101.76975136995316, -113.98973441123962, -100.12358872592449, -98.14713752269745, -95.33675698935986, -106.92248946428299, -95.80962570508322, -96.14976192017397, -107.96448322137198, -102.5988127787908, -90.7486723860105, -90.99577841659388, -108.26594427227974, -95.97797948867083, -98.85291367769241, -100.95953740179539, -102.25344389677048, -113.49300473928452, -101.09775426735482, -113.57500567038855, -102.4763609369596, -100.39048832158248, -112.6903856197993, -101.72979478041331, -95.64081334074339, -106.1163834532102, -95.00031836827597, -97.80071857571602, -108.18610447645187, -96.2170906662941, -98.97083870569865, -109.24037657181422, -96.92864499489467, -104.15652643640837, -114.9745252331098, -107.2502490480741, -106.74393759667873, -119.08565247058868, -108.30912300944328, -114.28118795156479, -103.5089461505413, -104.17651504278183, -115.19675906499228, -106.9990551074346, -107.56590630610785, -102.44004006683826, -115.73333728313446, -104.19420856237411, -90.74853141109149, -90.6299198071162, -101.10388580958049, -92.77380332350731, -104.7384038567543, -92.57879830896854, -93.3144276936849, -104.50785990556082, -92.49127026398978, -117.87315920988719, -101.09619298080604, -103.02699611584346, -111.81265143553416, -98.44250736633937, -95.59402605394523, -94.77934086322784, -93.59822284406982, -105.53525277972221, -107.09937453269958, -94.88054513931274, -94.99072540551424, -114.82057442267737, -106.3013701637586, -104.93672897418341, -97.88946752746901, -109.15301760037741, -98.4021752079328, -106.57000561555228, -120.82099934418997, -109.59502120812735, -115.69816243648529, -100.20312712341547, -101.45531874895096, -95.51858657598495, -98.00048226118088, -112.08865129947662, -85.54239647711317, -87.3629825214545, -98.69230810801189, -104.17589630683264, -117.5386321147283, -107.70655508836111, -91.7879607876142, -90.32693128784499, -100.79836066563925, -101.28349498907725, -112.10592673222224, -99.66941089431445, -97.3268495326241, -109.63188799222311, -97.19249552239975, -111.04105999072394, -99.52834715445837, -98.21100251128277, -112.20941899220149, -101.56530884901683, -101.1597867111365, -93.43241071949403, -107.12917069594066, -96.19061241547267, -95.5354589248697, -96.50360975662868, -107.70265404383342, -107.88314785559973, -95.22364027549824, -95.78164767225584, -93.78867566771805, -106.57497602701187, -94.31839662790298, -100.0810349782308, -110.38445570071539, -101.04992576440176, -107.23472958803177, -95.39783111214638, -97.44672900438309, -100.81823925177257, -96.04046395669381, -107.57581661144893, -111.37991456190746, -100.93238977591197, -101.69359115759532, -106.79977146784465, -94.55435475210349, -95.25909779469173, -110.23878260453543, -98.41830245157084, -98.27476634581885, -105.30733926097552, -117.13690040508907, -104.29345702628295, -108.67985937992732, -97.86197532216708, -98.53073928753535, -111.88070287307104, -101.15743537743887, -100.4348880549272, -109.21986055374146, -97.9179799258709, -99.45843261480331, -102.5995139082273, -102.91807793577513, -113.89313914378485, -107.68009537706773, -108.85882807771365, -122.00295833746593, -112.417609055837, -99.67463569467267, -99.42574442581585, -102.9463818271955, -101.2342447390159, -113.93136407931647, -110.07875442504883, -98.71679551899433, -101.41518086194992, -101.40718203783035, -99.26617217063904, -111.05445039272308, -118.739357372125, -108.87946345408758, -107.39508577187857, -114.71308741966884, -103.42369277278583, -102.03994393597047, -103.33498848478, -103.4005981485049, -113.27438725034396, -109.33518427610397, -107.80926096439362, -120.16725587844849, -94.95779475445549, -95.56457501153152, -108.02070144812267, -111.35262521107992, -98.27510330018899, -102.90456714232764, -99.33581055204074, -110.29633299509685, -99.42967207233112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18472558283552584, "mean_inference_ms": 0.6972929011581092, "mean_action_processing_ms": 0.09941155899070098, "mean_env_wait_ms": 0.8082382879116166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 4800, "timesteps_this_iter": 0, "agent_timesteps_total": 14400, "timers": {"sample_time_ms": 8663.083, "sample_throughput": 554.075, "load_time_ms": 1.001, "load_throughput": 4795773.988, "learn_time_ms": 1150.0, "learn_throughput": 4173.913, "update_time_ms": 1.0}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 4531.724609375, "policy_loss": -0.006322128635753543, "vf_loss": 4531.786804199219, "vf_explained_var": -0.0001964271068572998, "kl": 0.005507248002686606, "entropy": 5.684651672840118, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4800, "num_agent_steps_sampled": 14400, "num_steps_trained": 4800, "num_agent_steps_trained": 14400}, "done": false, "episodes_total": 66, "training_iteration": 1, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-42-46", "timestamp": 1706146966, "time_this_iter_s": 9.793139457702637, "time_total_s": 9.793139457702637, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000537CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9.793139457702637, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.485714285714284, "ram_util_percent": 43.93571428571429}}
{"episode_reward_max": -30.33140212297441, "episode_reward_min": -358.15698307752615, "episode_reward_mean": -302.69389836738117, "episode_len_mean": 73.19, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {"shared_policy": -129.01588960488638}, "policy_reward_max": {"shared_policy": -9.886105234424278}, "policy_reward_mean": {"shared_policy": -100.8979661224604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.4210835099221, -282.91325274109846, -313.05883261561394, -304.15123304724693, -308.78040965646505, -314.9345145523548, -296.75219383090734, -299.7417227253318, -298.8884358033538, -294.6820483226329, -311.51541644334793, -300.07928970456123, -304.4345198199153, -314.00589549541473, -296.61322401463985, -306.9318514019251, -326.7376966923475, -305.07257398962975, -313.47302630543714, -306.59627309441566, -319.4107309877873, -338.54188179224735, -311.51798917632556, -318.11199064552784, -310.2107308059931, -311.7278046011925, -335.0139065980911, -320.1767241284251, -320.00997388362885, -337.3117011189461, -298.54307121410966, -312.5322956535966, -309.0618156194687, -30.33140212297441, -303.5790857076645, -305.75847470760345, -319.83227314427495, -317.9036968052387, -297.07192216813564, -299.5641407072544, -308.71221567946486, -315.21434485912323, -319.19274029135704, -304.47395832370967, -311.1306696087122, -318.40888081490993, -300.4273675978184, -289.04102635383606, -309.7318900451064, -317.959104700014, -358.15698307752615, -294.00780864059925, -300.829796075821, -319.52576327323914, -324.41855327785015, -306.96200780570507, -328.955400288105, -315.404538474977, -308.86408710479736, -305.9805920869112, -259.1187002658844, -330.2379542440176, -285.3613290786743, -312.93351963628083, -302.00004971027374, -326.4672472327948, -321.2606637477875, -317.1439592838288, -313.0579721927643, -286.8684811145067, -338.6870817542076, -325.40391832590103, -309.75061848759657, -299.5862789899111, -306.57816475629807, -331.111732782796, -312.0765925762244, -317.9337748810649, -321.10644014924765, -304.8951795995236, -299.5833289921284, -311.144102409482, -320.9212952554226, -331.5330327153206, -291.2632638514042, -303.49224576354027, -306.9997583851218, -309.4415048509837, -34.02306213974953, -305.7004431784153, -295.78576439619064, -321.44789132475853, -53.077481165528326, -298.19755789637566, -320.5462272465229, -328.8338732123375, -291.8156290948391, -314.6809684038162, -298.33038522303104, -308.5995286889374], "episode_lengths": [58, 72, 60, 64, 79, 63, 66, 66, 74, 62, 69, 71, 72, 81, 66, 49, 78, 79, 70, 62, 69, 107, 54, 65, 61, 57, 72, 76, 62, 60, 63, 59, 60, 300, 60, 59, 44, 65, 79, 72, 38, 73, 86, 55, 79, 69, 80, 73, 52, 51, 68, 72, 57, 78, 60, 68, 81, 59, 76, 74, 132, 70, 69, 67, 79, 57, 68, 61, 46, 90, 77, 65, 61, 53, 63, 73, 60, 40, 41, 71, 68, 58, 66, 85, 66, 61, 61, 52, 300, 63, 57, 49, 300, 53, 49, 66, 75, 57, 66, 70], "policy_shared_policy_reward": [-104.17589630683264, -117.5386321147283, -107.70655508836111, -91.7879607876142, -90.32693128784499, -100.79836066563925, -101.28349498907725, -112.10592673222224, -99.66941089431445, -97.3268495326241, -109.63188799222311, -97.19249552239975, -111.04105999072394, -99.52834715445837, -98.21100251128277, -112.20941899220149, -101.56530884901683, -101.1597867111365, -93.43241071949403, -107.12917069594066, -96.19061241547267, -95.5354589248697, -96.50360975662868, -107.70265404383342, -107.88314785559973, -95.22364027549824, -95.78164767225584, -93.78867566771805, -106.57497602701187, -94.31839662790298, -100.0810349782308, -110.38445570071539, -101.04992576440176, -107.23472958803177, -95.39783111214638, -97.44672900438309, -100.81823925177257, -96.04046395669381, -107.57581661144893, -111.37991456190746, -100.93238977591197, -101.69359115759532, -106.79977146784465, -94.55435475210349, -95.25909779469173, -110.23878260453543, -98.41830245157084, -98.27476634581885, -105.30733926097552, -117.13690040508907, -104.29345702628295, -108.67985937992732, -97.86197532216708, -98.53073928753535, -111.88070287307104, -101.15743537743887, -100.4348880549272, -109.21986055374146, -97.9179799258709, -99.45843261480331, -102.5995139082273, -102.91807793577513, -113.89313914378485, -107.68009537706773, -108.85882807771365, -122.00295833746593, -112.417609055837, -99.67463569467267, -99.42574442581585, -102.9463818271955, -101.2342447390159, -113.93136407931647, -110.07875442504883, -98.71679551899433, -101.41518086194992, -101.40718203783035, -99.26617217063904, -111.05445039272308, -118.739357372125, -108.87946345408758, -107.39508577187857, -114.71308741966884, -103.42369277278583, -102.03994393597047, -103.33498848478, -103.4005981485049, -113.27438725034396, -109.33518427610397, -107.80926096439362, -120.16725587844849, -94.95779475445549, -95.56457501153152, -108.02070144812267, -111.35262521107992, -98.27510330018899, -102.90456714232764, -99.33581055204074, -110.29633299509685, -99.42967207233112, -10.254660795132324, -9.886105234424278, -10.190636093417808, -97.21760857105255, -97.21109855175018, -109.15037858486176, -98.73098008831343, -109.20300193627676, -97.82449268301329, -114.7830797235171, -101.45798382038872, -103.59120960036914, -107.90688193837802, -109.43036935726802, -100.5664455095927, -97.16292156775793, -93.98809528847536, -105.92090531190237, -96.60613655050597, -107.26172043879828, -95.6962837179502, -100.17004433274269, -110.40220040082932, -98.13997094589286, -100.18884241580963, -112.70057708024979, -102.32492536306381, -113.12737299998602, -101.6437354584535, -104.42163183291754, -98.08961031834285, -96.85202305546652, -109.53232494990031, -100.59349729617438, -111.4375026424726, -99.09966967006525, -103.28770798444748, -100.69777791202068, -114.42339491844177, -107.44169753789902, -95.93266513943672, -97.05300492048264, -93.30803120136261, -103.47807222604752, -92.25492292642593, -98.5806101585428, -100.13482753435771, -111.01645235220592, -114.98789105812709, -102.47273881236713, -100.4984748295198, -114.36152531703314, -129.01588960488638, -114.7795681556066, -97.30776111284892, -104.44399307171504, -92.2560544560353, -96.91751565535864, -108.3090293010076, -95.60325111945471, -102.97082574168842, -102.18174667159717, -114.37319085995357, -102.2243955284357, -103.13733759522438, -119.05682015419006, -100.02870480219524, -97.54993262390296, -109.38337037960689, -106.54793371756872, -104.6970879038175, -117.71037866671881, -112.66093984246254, -100.54111566394567, -102.2024829685688, -99.93987131118774, -99.32413849234581, -109.60007730126381, -109.28283888101578, -97.37226451933384, -99.32548868656158, -93.34619281689326, -81.98255209128062, -83.78995535771053, -118.48256003856659, -105.4737528115511, -106.28164139389992, -93.31563107172649, -102.21959195534389, -89.82610605160396, -102.06430753072104, -111.74267937739691, -99.12653272816291, -96.35719077785811, -108.1606111129125, -97.48224781950316, -117.6449074347814, -103.72452539702257, -105.09781440099081, -103.21606373786926, -115.72378969192505, -102.32081031799316, -113.56695618232092, -101.21826123197874, -102.3587418695291, -99.61290751894316, -111.99464892347655, -101.4504157503446, -93.01298767328262, -103.32138866186142, -90.53410477936268, -110.12224260965984, -117.6045594016711, -110.9602797428767, -103.80427534381549, -104.01597316066425, -117.58366982142131, -101.19711716969809, -109.42171027263007, -99.13179104526839, -107.24787259101868, -97.50372850894928, -94.83467788994312, -109.40948388973872, -98.48824820915858, -98.68043265740077, -104.55261523711185, -106.71749217311542, -119.84162537256877, -98.54722947052991, -112.74450107415518, -100.78486203153929, -115.11029746135077, -101.1217876498898, -101.70168976982436, -102.2818142498533, -102.99754805366199, -115.82707784573238, -98.91226734717688, -109.44960083564123, -96.53331141670546, -96.12649436791739, -107.46325399478278, -95.99358062942824, -100.46563554803531, -99.78549268345039, -110.89297417799632, -103.68683620293936, -103.48276688655218, -113.75169216593108, -103.32914334535599, -117.00059425830841, -111.20329511165619, -94.73252540826797, -92.4665949344635, -104.06414350867271, -98.06726637482643, -108.24270579218864, -97.18227359652519, -98.60255254308383, -96.41273030887048, -111.98447553316753, -99.56490700443587, -111.37786080439886, -98.49873704214892, -11.52755193412304, -11.32483933120966, -11.170670874416828, -97.82798899213473, -108.90769151846568, -98.9647626678149, -95.42563749353091, -94.49599144856136, -105.86413545409839, -104.40675125519435, -102.34993279973666, -114.69120726982753, -16.886071388920158, -17.291700740655273, -18.899709035952895, -95.70376166701317, -95.94524943828583, -106.54854679107666, -102.12566231687865, -115.39770205815634, -103.02286287148794, -116.5095023115476, -105.15660174687704, -107.16776915391287, -92.71139813462894, -105.1441055337588, -93.96012542645137, -112.04658047358195, -101.00481406847636, -101.62957386175792, -96.00578821698825, -107.53730140129726, -94.78729560474555, -98.93945741156737, -111.04472021261851, -98.61535106475155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18110266074421028, "mean_inference_ms": 0.6755563483643613, "mean_action_processing_ms": 0.0977857030797896, "mean_env_wait_ms": 0.7910304930955414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"sample_time_ms": 8923.487, "sample_throughput": 537.906, "load_time_ms": 0.5, "load_throughput": 9591547.975, "learn_time_ms": 1155.5, "learn_throughput": 4154.044, "update_time_ms": 1.0}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 4462.9256591796875, "policy_loss": -0.003944226198170142, "vf_loss": 4462.985656738281, "vf_explained_var": -0.00030860304832458496, "kl": 0.003733172843567916, "entropy": 5.680843830108643, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 28800, "num_steps_trained": 9600, "num_agent_steps_trained": 28800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 133, "training_iteration": 2, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-42-55", "timestamp": 1706146975, "time_this_iter_s": 9.160216093063354, "time_total_s": 18.95335555076599, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 18.95335555076599, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 9.215384615384615, "ram_util_percent": 44.02307692307692}}
{"episode_reward_max": 17.184573829174013, "episode_reward_min": -354.711376696825, "episode_reward_mean": -297.5473039468584, "episode_len_mean": 73.48, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {"shared_policy": -132.79444241523743}, "policy_reward_max": {"shared_policy": 5.969404245416314}, "policy_reward_mean": {"shared_policy": -99.18243464895282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.2606637477875, -317.1439592838288, -313.0579721927643, -286.8684811145067, -338.6870817542076, -325.40391832590103, -309.75061848759657, -299.5862789899111, -306.57816475629807, -331.111732782796, -312.0765925762244, -317.9337748810649, -321.10644014924765, -304.8951795995236, -299.5833289921284, -311.144102409482, -320.9212952554226, -331.5330327153206, -291.2632638514042, -303.49224576354027, -306.9997583851218, -309.4415048509837, -34.02306213974953, -305.7004431784153, -295.78576439619064, -321.44789132475853, -53.077481165528326, -298.19755789637566, -320.5462272465229, -328.8338732123375, -291.8156290948391, -314.6809684038162, -298.33038522303104, -308.5995286889374, -315.30975592136383, -312.5212022252381, -328.3285279273987, -303.37135900064914, -319.5663205711171, -306.1934428066016, -319.59046894311905, -315.30394065380096, -294.5339833311737, -298.7763997465372, -316.8325025886297, -310.7940299306065, -325.8248655200005, -313.59180253744125, -307.14801724255085, -300.0694631934166, -321.07779754698277, -318.94185101240873, -303.1681337803602, -326.3448069691658, -311.8987719938159, -314.2495645880699, -295.3603612482548, -304.4264497458935, -307.4514340162277, -354.711376696825, -301.4954074192792, -338.18709811568266, -313.7138624191285, -303.3816221654415, 17.184573829174013, -319.08871488273144, -317.6483183503151, -305.2682153880597, -314.3164467290044, -349.82783791422844, -328.60680416226387, -334.8234185874462, -327.1915639638901, -299.3476102054119, -292.6382898837328, -285.08483678102493, -298.8765871487558, -285.8694056123495, -312.2089164406061, -12.078746020793929, -295.3978464305401, -292.92130659520626, -315.31741658598185, -295.92783163487917, -314.1688400916755, -315.8743780553341, -326.31237939000135, -282.10615118965507, -310.6700030863285, -299.0407800525427, -313.70359259843826, -96.17972710728645, -326.58948873355985, -313.69163039326673, -299.80909782648087, -302.3621317129582, -286.5721271671355, -330.5846920311451, -309.8782322257757, -308.8887808434665], "episode_lengths": [68, 61, 46, 90, 77, 65, 61, 53, 63, 73, 60, 40, 41, 71, 68, 58, 66, 85, 66, 61, 61, 52, 300, 63, 57, 49, 300, 53, 49, 66, 75, 57, 66, 70, 56, 60, 57, 55, 48, 51, 80, 59, 60, 65, 61, 63, 59, 45, 57, 57, 42, 53, 55, 50, 52, 55, 65, 65, 65, 114, 52, 63, 44, 56, 300, 61, 53, 43, 68, 74, 51, 84, 63, 92, 65, 66, 55, 74, 57, 300, 65, 55, 59, 61, 57, 53, 67, 70, 74, 70, 68, 300, 66, 44, 62, 44, 71, 66, 64, 71], "policy_shared_policy_reward": [-103.21606373786926, -115.72378969192505, -102.32081031799316, -113.56695618232092, -101.21826123197874, -102.3587418695291, -99.61290751894316, -111.99464892347655, -101.4504157503446, -93.01298767328262, -103.32138866186142, -90.53410477936268, -110.12224260965984, -117.6045594016711, -110.9602797428767, -103.80427534381549, -104.01597316066425, -117.58366982142131, -101.19711716969809, -109.42171027263007, -99.13179104526839, -107.24787259101868, -97.50372850894928, -94.83467788994312, -109.40948388973872, -98.48824820915858, -98.68043265740077, -104.55261523711185, -106.71749217311542, -119.84162537256877, -98.54722947052991, -112.74450107415518, -100.78486203153929, -115.11029746135077, -101.1217876498898, -101.70168976982436, -102.2818142498533, -102.99754805366199, -115.82707784573238, -98.91226734717688, -109.44960083564123, -96.53331141670546, -96.12649436791739, -107.46325399478278, -95.99358062942824, -100.46563554803531, -99.78549268345039, -110.89297417799632, -103.68683620293936, -103.48276688655218, -113.75169216593108, -103.32914334535599, -117.00059425830841, -111.20329511165619, -94.73252540826797, -92.4665949344635, -104.06414350867271, -98.06726637482643, -108.24270579218864, -97.18227359652519, -98.60255254308383, -96.41273030887048, -111.98447553316753, -99.56490700443587, -111.37786080439886, -98.49873704214892, -11.52755193412304, -11.32483933120966, -11.170670874416828, -97.82798899213473, -108.90769151846568, -98.9647626678149, -95.42563749353091, -94.49599144856136, -105.86413545409839, -104.40675125519435, -102.34993279973666, -114.69120726982753, -16.886071388920158, -17.291700740655273, -18.899709035952895, -95.70376166701317, -95.94524943828583, -106.54854679107666, -102.12566231687865, -115.39770205815634, -103.02286287148794, -116.5095023115476, -105.15660174687704, -107.16776915391287, -92.71139813462894, -105.1441055337588, -93.96012542645137, -112.04658047358195, -101.00481406847636, -101.62957386175792, -96.00578821698825, -107.53730140129726, -94.78729560474555, -98.93945741156737, -111.04472021261851, -98.61535106475155, -112.48180135091147, -101.65949880083403, -101.16845576961836, -110.22186679641406, -97.99299552912514, -104.3063398996989, -106.42472996314368, -115.41931732495627, -106.48448063929877, -98.09960014621417, -109.14428911606471, -96.12746973837027, -115.91797631978989, -101.6815862832591, -101.96675796806812, -98.20595801373324, -97.80697890122732, -110.18050589164099, -114.05963130791983, -102.12285094459853, -103.40798669060072, -112.36501520872116, -101.54939031600952, -101.38953512907028, -93.4756341551741, -93.23542764162025, -107.82292153437933, -96.43441623449326, -107.03349268436432, -95.30849082767963, -101.78439806898436, -101.41042325397333, -113.63768126567206, -98.69785859125356, -111.50139836470287, -100.59477297465007, -116.07400103410086, -105.96904142697653, -103.7818230589231, -107.20683777332306, -101.63597220182419, -104.748992562294, -100.17151540517807, -97.9844838231802, -108.99201801419258, -97.09108718236288, -95.74804984529814, -107.2303261657556, -102.64367634554705, -115.321404059728, -103.11271714170775, -100.77465742081404, -115.73779511451721, -102.42939847707748, -97.39080227414767, -96.54912322262923, -109.22820828358333, -103.86530701319377, -104.36944935719173, -118.11005059878032, -101.39442972342174, -111.52555189530055, -98.97879037509362, -112.62927826245627, -100.94645272692046, -100.67383359869322, -105.8776820898056, -95.41608762741089, -94.06659153103828, -97.424385368824, -109.63872265815735, -97.36334171891212, -99.30464541912079, -108.8535932302475, -99.29319536685944, -109.81003740429878, -112.10689687728882, -132.79444241523743, -95.4170770291239, -95.50631832331419, -110.57201206684113, -107.48564915855727, -109.93008555968603, -120.77136339743933, -100.67932470639548, -100.07371171315512, -112.96082599957785, -108.521337668101, -96.70957476894061, -98.15070972839992, 5.969404245416314, 5.40302228430906, 5.81214729944864, -113.87948004404704, -103.26887307564418, -101.94036176304023, -101.6886265873909, -114.74396991729736, -101.21572184562683, -96.95705627401671, -98.48144938548407, -109.82970972855887, -100.2822385802865, -113.43739879131317, -100.59680935740471, -110.23939623435339, -120.71120723088583, -118.87723444898924, -107.08057542641959, -118.12202533086142, -103.4042034049829, -119.75910838445029, -108.01866437991461, -107.04564582308134, -115.84986581405005, -105.77754809459051, -105.56415005524954, -106.61798592408499, -95.10315637787184, -97.62646790345511, -105.56080575784048, -93.92231728633246, -93.15516683955988, -91.01843486229579, -92.48046259085338, -101.58593932787578, -110.00344979763031, -94.12274458631873, -94.75039276480675, -100.7418521642685, -98.93977904319763, -86.18777440488338, -99.43761439621449, -100.14412635564804, -112.62717568874359, -3.86592596272628, -3.917352477709457, -4.295467580358192, -93.98145145177841, -106.85115432739258, -94.5652406513691, -93.83515463272731, -105.74358508984248, -93.34256687263648, -101.16735798120499, -100.5691762343049, -113.58088237047195, -107.78957839806876, -94.32471763094267, -93.81353560586771, -98.63194843257467, -111.51148132483165, -104.02541033426921, -101.09059059619904, -100.76312431693077, -114.02066314220428, -101.40638445814452, -102.4503113826116, -122.45568354924521, -89.03891886894903, -101.84171040852866, -91.22552191217741, -98.236470947663, -112.56668595472972, -99.8668461839358, -95.18084133168063, -96.08310433228812, -107.77683438857397, -101.71794380744299, -100.48802491029105, -111.49762388070425, -31.776370237270996, -31.679803113142654, -32.72355375687282, -106.34665524959564, -117.43032908439636, -102.81250439956784, -99.9095059533914, -112.49500330289206, -101.28712113698325, -96.1143420735995, -96.93027273813884, -106.76448301474254, -108.87781155109406, -96.29971802048385, -97.18460214138031, -91.56719459593296, -91.26861744001508, -103.73631513118744, -106.28883470098178, -107.29894463221233, -116.996912697951, -98.98516681293647, -99.86173037687938, -111.03133503595988, -110.02342266837756, -100.40175719062488, -98.4636009844641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17700455038949683, "mean_inference_ms": 0.6557866232631474, "mean_action_processing_ms": 0.09438337690486776, "mean_env_wait_ms": 0.7769973195347478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 14400, "timesteps_this_iter": 0, "agent_timesteps_total": 43200, "timers": {"sample_time_ms": 8972.976, "sample_throughput": 534.94, "load_time_ms": 0.334, "load_throughput": 14387321.963, "learn_time_ms": 1159.308, "learn_throughput": 4140.4, "update_time_ms": 1.0}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 4286.68798828125, "policy_loss": -0.003757883827395947, "vf_loss": 4286.747863769531, "vf_explained_var": 0.0015453845262527466, "kl": 0.0051535563980003125, "entropy": 5.675731599330902, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 14400, "num_agent_steps_sampled": 43200, "num_steps_trained": 14400, "num_agent_steps_trained": 43200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 199, "training_iteration": 3, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-43-04", "timestamp": 1706146984, "time_this_iter_s": 9.057441473007202, "time_total_s": 28.010797023773193, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000568550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28.010797023773193, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 6.13846153846154, "ram_util_percent": 43.95384615384615}}
{"episode_reward_max": -12.078746020793929, "episode_reward_min": -581.9349088668823, "episode_reward_mean": -302.7925259529054, "episode_len_mean": 74.71, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {"shared_policy": -200.79616455237073}, "policy_reward_max": {"shared_policy": -3.86592596272628}, "policy_reward_mean": {"shared_policy": -100.93084198430181}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317.6483183503151, -305.2682153880597, -314.3164467290044, -349.82783791422844, -328.60680416226387, -334.8234185874462, -327.1915639638901, -299.3476102054119, -292.6382898837328, -285.08483678102493, -298.8765871487558, -285.8694056123495, -312.2089164406061, -12.078746020793929, -295.3978464305401, -292.92130659520626, -315.31741658598185, -295.92783163487917, -314.1688400916755, -315.8743780553341, -326.31237939000135, -282.10615118965507, -310.6700030863285, -299.0407800525427, -313.70359259843826, -96.17972710728645, -326.58948873355985, -313.69163039326673, -299.80909782648087, -302.3621317129582, -286.5721271671355, -330.5846920311451, -309.8782322257757, -308.8887808434665, -348.55618143081665, -319.9196773394942, -320.3371160328388, -297.97338289022446, -329.140286847949, -316.5125669538975, -301.534377515316, -313.13990223407745, -325.59188744425774, -336.3199476599694, -296.75571182742715, -323.3913540393114, -311.47534741461277, -313.3598248884082, -55.21584782004358, -298.75440768152475, -299.64989490807056, -293.5545926392079, -303.5594845712185, -296.1953391134739, -301.6682839989662, -310.93743366003036, -303.45164881646633, -324.53815907239914, -305.16810109093785, -314.0481999963522, -331.92084085941315, -313.8067925274372, -316.6849463582039, -325.2170703113079, -294.9883072897792, -297.91675105690956, -301.5006723999977, -335.5758859217167, -310.39426520466805, -303.78067694604397, -321.0090060830116, -309.91905836761, -317.2284220457077, -323.0176323056221, -295.64450043439865, -308.0196323990822, -319.12219828367233, -299.21272534132004, -308.2302426099777, -321.98878137208527, -313.4856006205082, -316.9021014869213, -320.7839087098837, -320.6599396765232, -581.9349088668823, -300.8279941678048, -307.4107255935669, -295.46483176946646, -305.1078548133373, -309.1672822833061, -305.89026279747486, -303.0172569453716, -318.4294295310974, -308.03736229240894, -291.6343863904476, -293.64630404114723, -297.48583509773016, -24.367152988910703, -328.91454190015793, -320.37411837279797], "episode_lengths": [53, 43, 68, 74, 51, 84, 63, 92, 65, 66, 55, 74, 57, 300, 65, 55, 59, 61, 57, 53, 67, 70, 74, 70, 68, 300, 66, 44, 62, 44, 71, 66, 64, 71, 60, 85, 75, 47, 67, 89, 87, 69, 76, 64, 78, 50, 63, 62, 300, 60, 62, 54, 78, 64, 58, 80, 56, 55, 64, 63, 67, 59, 85, 71, 53, 56, 56, 71, 66, 64, 47, 57, 71, 91, 55, 54, 77, 56, 66, 51, 64, 46, 117, 59, 73, 49, 74, 68, 60, 88, 61, 66, 70, 42, 84, 61, 109, 300, 57, 52], "policy_shared_policy_reward": [-101.6886265873909, -114.74396991729736, -101.21572184562683, -96.95705627401671, -98.48144938548407, -109.82970972855887, -100.2822385802865, -113.43739879131317, -100.59680935740471, -110.23939623435339, -120.71120723088583, -118.87723444898924, -107.08057542641959, -118.12202533086142, -103.4042034049829, -119.75910838445029, -108.01866437991461, -107.04564582308134, -115.84986581405005, -105.77754809459051, -105.56415005524954, -106.61798592408499, -95.10315637787184, -97.62646790345511, -105.56080575784048, -93.92231728633246, -93.15516683955988, -91.01843486229579, -92.48046259085338, -101.58593932787578, -110.00344979763031, -94.12274458631873, -94.75039276480675, -100.7418521642685, -98.93977904319763, -86.18777440488338, -99.43761439621449, -100.14412635564804, -112.62717568874359, -3.86592596272628, -3.917352477709457, -4.295467580358192, -93.98145145177841, -106.85115432739258, -94.5652406513691, -93.83515463272731, -105.74358508984248, -93.34256687263648, -101.16735798120499, -100.5691762343049, -113.58088237047195, -107.78957839806876, -94.32471763094267, -93.81353560586771, -98.63194843257467, -111.51148132483165, -104.02541033426921, -101.09059059619904, -100.76312431693077, -114.02066314220428, -101.40638445814452, -102.4503113826116, -122.45568354924521, -89.03891886894903, -101.84171040852866, -91.22552191217741, -98.236470947663, -112.56668595472972, -99.8668461839358, -95.18084133168063, -96.08310433228812, -107.77683438857397, -101.71794380744299, -100.48802491029105, -111.49762388070425, -31.776370237270996, -31.679803113142654, -32.72355375687282, -106.34665524959564, -117.43032908439636, -102.81250439956784, -99.9095059533914, -112.49500330289206, -101.28712113698325, -96.1143420735995, -96.93027273813884, -106.76448301474254, -108.87781155109406, -96.29971802048385, -97.18460214138031, -91.56719459593296, -91.26861744001508, -103.73631513118744, -106.28883470098178, -107.29894463221233, -116.996912697951, -98.98516681293647, -99.86173037687938, -111.03133503595988, -110.02342266837756, -100.40175719062488, -98.4636009844641, -119.18307208021483, -120.42125590642294, -108.95185344417891, -101.37925973782937, -102.8448664645354, -115.69555113712947, -102.58985114097595, -116.01073038578033, -101.73653450608253, -95.28736143310866, -96.41496731837591, -106.27105413873991, -104.24835292994976, -105.74843204021454, -119.14350187778473, -101.46951566139857, -112.94486338893573, -102.09818790356319, -96.81166629989943, -107.84285630782446, -96.87985490759215, -100.80291873216629, -111.37361681461334, -100.96336668729782, -116.85220313072205, -104.08619996905327, -104.65348434448242, -105.13914748032889, -108.23888494571051, -122.94191523392996, -93.94983201598129, -107.26116706927618, -95.54471274216971, -101.90445198118687, -103.06216305494308, -118.42473900318146, -107.19096399346988, -95.24948521951835, -109.03489820162456, -99.19713356345892, -113.61595463752747, -100.5467366874218, -17.836916754643127, -19.22183842460315, -18.157092640797302, -95.48007612178723, -95.87429330746333, -107.4000382522742, -96.41891871889433, -108.89700671037039, -94.33396947880587, -93.54974614580473, -93.77013744910559, -106.23470904429755, -97.94159857432048, -109.10679397980373, -96.5110920170943, -94.79356567064922, -95.70626760522525, -105.69550583759944, -96.84081476926804, -107.85646837949753, -96.97100085020065, -99.91466287771861, -111.55155096451442, -99.47121981779735, -99.91884932418665, -103.8494316538175, -99.6833678384622, -104.29377739628157, -104.42624126871428, -115.81814040740332, -98.3287137846152, -109.62447957197826, -97.21490773434441, -100.53933716317019, -112.65515609582266, -100.85370673735937, -105.58522953589758, -120.33187373479208, -106.00373758872351, -111.48088024059932, -100.37167460719745, -101.95423767964046, -112.69624047478041, -101.872011055549, -102.11669482787451, -116.55205663045248, -104.07266195615134, -104.59235172470412, -95.91494901974997, -105.84769620498022, -93.22566206504902, -94.86414556701979, -106.98647310336432, -96.06613238652548, -97.4209251999855, -107.98386842012405, -96.09587877988815, -121.56145989894867, -106.04079380631447, -107.97363221645355, -98.92033249139786, -111.51300817728043, -99.96092453598976, -108.81559014320374, -96.87929101288319, -98.08579578995705, -104.5861799120903, -103.86172032356262, -112.5611058473587, -100.431216776371, -97.39393804967403, -112.09390354156494, -97.6445611913999, -111.68014045556387, -107.90372039874396, -105.55256851514181, -103.38150389989218, -114.08355989058813, -94.23174372315407, -105.89487886428833, -95.51787784695625, -110.32768617073695, -99.56491629282634, -98.1270299355189, -102.84758326411247, -102.61744526028633, -113.65716975927353, -106.02633372942607, -95.25794253746669, -97.92844907442729, -98.9998092353344, -98.75742694735527, -110.47300642728806, -102.4351555009683, -118.00613506635031, -101.54749080476662, -111.41521388292313, -99.06561651825905, -103.00477021932602, -101.999006519715, -113.38696698347728, -101.51612798372905, -114.43596237897873, -102.53756822645664, -103.81037810444832, -104.11183035373688, -102.29443749785423, -114.2536718249321, -190.17059562603635, -200.79616455237073, -190.9681486884753, -97.87571920951208, -107.69096179803213, -95.26131316026053, -99.52281453212103, -97.78466113408408, -110.10324992736182, -107.00625981887183, -93.76182671387991, -94.69674523671469, -97.7409808288018, -109.95281569163005, -97.4140582929055, -100.163214802742, -99.17159587144852, -109.8324716091156, -98.59165802598, -109.90159273147583, -97.39701204001904, -96.68001416325569, -97.0732929110527, -109.26394987106323, -102.19984700282416, -101.30035003026327, -114.92923249801001, -97.73453631997108, -113.01300549507141, -97.28982047736645, -92.56845019261043, -93.80602545539539, -105.25991074244182, -104.94600033760071, -94.3672271668911, -94.33307653665543, -106.59711779157321, -96.09924689928691, -94.78947040687005, -7.941887085636466, -8.216486727197974, -8.208779176076263, -104.42523951331775, -105.06307239333789, -119.4262299935023, -102.36221625904243, -104.14479426542918, -113.86710784832637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17554964917497595, "mean_inference_ms": 0.655102172792993, "mean_action_processing_ms": 0.09401418799433373, "mean_env_wait_ms": 0.7771812017295858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"sample_time_ms": 9128.843, "sample_throughput": 525.806, "load_time_ms": 0.25, "load_throughput": 19183095.95, "learn_time_ms": 1166.232, "learn_throughput": 4115.819, "update_time_ms": 1.25}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 4373.024108886719, "policy_loss": -0.002832767728735419, "vf_loss": 4373.0836181640625, "vf_explained_var": 0.0012812167406082153, "kl": 0.0044395101740527685, "entropy": 5.715785264968872, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 57600, "num_steps_trained": 19200, "num_agent_steps_trained": 57600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 265, "training_iteration": 4, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-43-14", "timestamp": 1706146994, "time_this_iter_s": 9.587831735610962, "time_total_s": 37.598628759384155, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F4E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37.598628759384155, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 6.921428571428571, "ram_util_percent": 44.02142857142859}}
{"episode_reward_max": 9.201636537909508, "episode_reward_min": -581.9349088668823, "episode_reward_mean": -307.8631486115861, "episode_len_mean": 73.93, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {"shared_policy": -200.79616455237073}, "policy_reward_max": {"shared_policy": 3.2273565605282784}, "policy_reward_mean": {"shared_policy": -102.62104953719536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-294.9883072897792, -297.91675105690956, -301.5006723999977, -335.5758859217167, -310.39426520466805, -303.78067694604397, -321.0090060830116, -309.91905836761, -317.2284220457077, -323.0176323056221, -295.64450043439865, -308.0196323990822, -319.12219828367233, -299.21272534132004, -308.2302426099777, -321.98878137208527, -313.4856006205082, -316.9021014869213, -320.7839087098837, -320.6599396765232, -581.9349088668823, -300.8279941678048, -307.4107255935669, -295.46483176946646, -305.1078548133373, -309.1672822833061, -305.89026279747486, -303.0172569453716, -318.4294295310974, -308.03736229240894, -291.6343863904476, -293.64630404114723, -297.48583509773016, -24.367152988910703, -328.91454190015793, -320.37411837279797, -299.9295106306672, -314.3209980726242, -311.9010978192091, -317.6597231924534, -306.49452466517687, -304.19810122996574, -304.4503517448902, -299.91995459608734, -316.66747161000967, -316.5690972432495, -363.7399892807007, -318.490815192461, -304.85783675312996, -318.538755774498, -328.3372822403908, -316.49191358685493, -297.9752076715231, -307.48158279061323, -296.53939621150494, -322.86825346946716, -296.8993251249194, -337.1960623562336, -329.3669516146183, -311.4149379655719, -303.1583197936416, -318.2250561118126, -299.4610288515687, -324.82288071513176, -322.4860387444496, -316.70518931746483, -326.3786526918411, -302.50823651254177, -296.2642006725073, -297.7878234088421, -301.1768808520865, -331.15037044882774, 9.201636537909508, -321.1460883617401, -310.8239258378744, -280.6396297700703, -332.4187866002321, -303.2069188654423, -321.54318805783987, -323.0302127301693, -317.1487109065056, -329.70976942777634, -290.7481527533382, -300.3381793498993, -313.39575040340424, -318.7243761718273, -301.1431420966983, -333.39298874139786, -304.3667787536979, -291.865768417716, -312.10116666555405, -281.2890220731497, -284.5969421416521, -319.78992831707, -325.11938608437777, -317.0676548928023, -299.6620656102896, -329.88597363233566, -303.1668595969677, -315.67075607180595], "episode_lengths": [53, 56, 56, 71, 66, 64, 47, 57, 71, 91, 55, 54, 77, 56, 66, 51, 64, 46, 117, 59, 73, 49, 74, 68, 60, 88, 61, 66, 70, 42, 84, 61, 109, 300, 57, 52, 62, 75, 61, 44, 58, 58, 68, 68, 81, 61, 80, 50, 69, 71, 75, 65, 54, 75, 151, 78, 52, 57, 72, 58, 68, 81, 70, 58, 77, 65, 78, 76, 77, 103, 93, 70, 300, 78, 59, 100, 72, 51, 64, 72, 65, 74, 76, 60, 64, 57, 123, 95, 63, 77, 56, 97, 71, 47, 64, 80, 65, 62, 74, 77], "policy_shared_policy_reward": [-95.91494901974997, -105.84769620498022, -93.22566206504902, -94.86414556701979, -106.98647310336432, -96.06613238652548, -97.4209251999855, -107.98386842012405, -96.09587877988815, -121.56145989894867, -106.04079380631447, -107.97363221645355, -98.92033249139786, -111.51300817728043, -99.96092453598976, -108.81559014320374, -96.87929101288319, -98.08579578995705, -104.5861799120903, -103.86172032356262, -112.5611058473587, -100.431216776371, -97.39393804967403, -112.09390354156494, -97.6445611913999, -111.68014045556387, -107.90372039874396, -105.55256851514181, -103.38150389989218, -114.08355989058813, -94.23174372315407, -105.89487886428833, -95.51787784695625, -110.32768617073695, -99.56491629282634, -98.1270299355189, -102.84758326411247, -102.61744526028633, -113.65716975927353, -106.02633372942607, -95.25794253746669, -97.92844907442729, -98.9998092353344, -98.75742694735527, -110.47300642728806, -102.4351555009683, -118.00613506635031, -101.54749080476662, -111.41521388292313, -99.06561651825905, -103.00477021932602, -101.999006519715, -113.38696698347728, -101.51612798372905, -114.43596237897873, -102.53756822645664, -103.81037810444832, -104.11183035373688, -102.29443749785423, -114.2536718249321, -190.17059562603635, -200.79616455237073, -190.9681486884753, -97.87571920951208, -107.69096179803213, -95.26131316026053, -99.52281453212103, -97.78466113408408, -110.10324992736182, -107.00625981887183, -93.76182671387991, -94.69674523671469, -97.7409808288018, -109.95281569163005, -97.4140582929055, -100.163214802742, -99.17159587144852, -109.8324716091156, -98.59165802598, -109.90159273147583, -97.39701204001904, -96.68001416325569, -97.0732929110527, -109.26394987106323, -102.19984700282416, -101.30035003026327, -114.92923249801001, -97.73453631997108, -113.01300549507141, -97.28982047736645, -92.56845019261043, -93.80602545539539, -105.25991074244182, -104.94600033760071, -94.3672271668911, -94.33307653665543, -106.59711779157321, -96.09924689928691, -94.78947040687005, -7.941887085636466, -8.216486727197974, -8.208779176076263, -104.42523951331775, -105.06307239333789, -119.4262299935023, -102.36221625904243, -104.14479426542918, -113.86710784832637, -95.77223135034244, -108.43670515219371, -95.72057412813108, -100.39676657319069, -100.79109391570091, -113.1331375837326, -101.629978120327, -111.70697093009949, -98.56414876878262, -101.95781162381172, -101.48273384571075, -114.21917772293091, -98.31461558739345, -111.33901665608089, -96.84089242170255, -97.27370489140353, -109.95902623732886, -96.96537010123333, -97.46270328760147, -95.71121260523796, -111.27643585205078, -110.57115213076274, -95.66825644175212, -93.68054602357249, -115.67739748954773, -101.55141481757164, -99.4386593028903, -101.48809917767844, -114.5820070107778, -100.49899105479321, -123.66411890586218, -111.95437278350195, -128.12149759133658, -101.45728211601576, -114.64140113194784, -102.39213194449744, -105.64627774556479, -105.53026326497397, -93.68129574259123, -101.72898168365161, -102.45103562871616, -114.35873846213023, -105.68488915761313, -117.63074596722922, -105.02164711554846, -102.55709030230841, -99.8983388443788, -114.03648444016775, -95.09985596934955, -107.82238678137462, -95.05296492079894, -98.02175741394362, -110.09684707721075, -99.36297829945883, -106.60981384913127, -94.43606352309386, -95.49351883927982, -103.23028292258581, -116.50134619077048, -103.1366243561109, -94.81575003017983, -94.99934101601443, -107.08423407872519, -111.08960578838985, -106.6600205997626, -119.44643596808116, -118.01842159032822, -106.25557696819305, -105.09295305609703, -99.93159391979377, -98.99750446031491, -112.48583958546321, -111.31038554509482, -96.42228015263876, -95.42565409590802, -102.60657753547034, -101.78585406144461, -113.83262451489767, -94.80907829354207, -96.66180727879207, -107.99014327923457, -102.77872456113498, -104.08257989088695, -117.96157626310985, -112.64129636685054, -104.44292692343394, -105.40181545416515, -114.20411968231201, -99.48477962613106, -103.01629000902176, -105.7558696269989, -104.48732423782349, -116.13545882701874, -97.36622287829718, -96.54500401516756, -108.59700961907706, -94.38107180595398, -92.87081371247768, -109.01231515407562, -95.29353356361389, -107.34943544864655, -95.14485439658165, -95.7798135188253, -96.71689773102602, -108.68016960223517, -118.6591708858808, -106.23232679565749, -106.25887276728949, 3.2273565605282784, 2.8437069058418274, 3.130573071539402, -103.4918600221475, -114.78229596217474, -102.87193237741789, -100.88908628622691, -112.33993963400523, -97.59489991764228, -101.2981327176094, -88.1739333756268, -91.1675636768341, -114.63214723269145, -102.2085378120343, -115.5781015555064, -109.52955400943756, -97.22774094343185, -96.44962391257286, -102.20497428129117, -116.3979462782542, -102.94026749829452, -116.77057466904323, -102.68948487440746, -103.57015318671863, -102.63770802815756, -100.98349614938101, -113.52750672896704, -118.51768898963928, -105.67794638872147, -105.51413404941559, -92.44017627152304, -105.68805501858394, -92.61992146323125, -95.14996961752574, -110.13069943586986, -95.05751029650371, -100.37004913886389, -111.34996261199316, -101.67573865254721, -101.48963637153308, -102.80586800972621, -114.42887179056804, -95.63925888389349, -108.29673796892166, -97.20714524388313, -105.92242379983267, -122.89286931355795, -104.57769562800726, -97.02166772882144, -110.58768353859584, -96.7574274862806, -105.30665399630865, -92.58191460867724, -93.97719981273016, -110.73211256663005, -100.5707219640414, -100.79833213488261, -100.99257614215216, -91.19603272279105, -89.1004132082065, -89.88317154347897, -90.77133700251579, -103.94243359565735, -103.87296183904013, -102.43737383683523, -113.47959264119467, -115.40086871385574, -102.9759028032422, -106.74261456727982, -101.37608156104884, -113.6063993771871, -102.08517395456633, -107.40652815500896, -95.20259478191535, -97.05294267336528, -109.67728674411774, -105.05537688732147, -115.15331000089645, -95.30217533310255, -98.2648809750875, -109.59980328877768, -108.01381055514018, -104.64349393049876, -103.01345158616702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17509214891662295, "mean_inference_ms": 0.6549657400141946, "mean_action_processing_ms": 0.09446469265591624, "mean_env_wait_ms": 0.7772820717503663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 9161.727, "sample_throughput": 523.919, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1161.401, "learn_throughput": 4132.941, "update_time_ms": 1.398}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 4404.365783691406, "policy_loss": -0.0035422579139574584, "vf_loss": 4404.426574707031, "vf_explained_var": -0.007874682545661926, "kl": 0.0043742436591866045, "entropy": 5.733748435974121, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 72000, "num_steps_trained": 24000, "num_agent_steps_trained": 72000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 329, "training_iteration": 5, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-43-23", "timestamp": 1706147003, "time_this_iter_s": 9.227068901062012, "time_total_s": 46.82569766044617, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C298B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 46.82569766044617, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 10.223076923076924, "ram_util_percent": 44.0923076923077}}
{"episode_reward_max": 9.201636537909508, "episode_reward_min": -603.2892135828733, "episode_reward_mean": -303.922159404892, "episode_len_mean": 82.35, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {"shared_policy": -210.31379536787668}, "policy_reward_max": {"shared_policy": 3.2273565605282784}, "policy_reward_mean": {"shared_policy": -101.30738646829734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-322.86825346946716, -296.8993251249194, -337.1960623562336, -329.3669516146183, -311.4149379655719, -303.1583197936416, -318.2250561118126, -299.4610288515687, -324.82288071513176, -322.4860387444496, -316.70518931746483, -326.3786526918411, -302.50823651254177, -296.2642006725073, -297.7878234088421, -301.1768808520865, -331.15037044882774, 9.201636537909508, -321.1460883617401, -310.8239258378744, -280.6396297700703, -332.4187866002321, -303.2069188654423, -321.54318805783987, -323.0302127301693, -317.1487109065056, -329.70976942777634, -290.7481527533382, -300.3381793498993, -313.39575040340424, -318.7243761718273, -301.1431420966983, -333.39298874139786, -304.3667787536979, -291.865768417716, -312.10116666555405, -281.2890220731497, -284.5969421416521, -319.78992831707, -325.11938608437777, -317.0676548928023, -299.6620656102896, -329.88597363233566, -303.1668595969677, -315.67075607180595, -292.62357237935066, -341.8559142947197, -315.86335464566946, -43.637112058699145, -327.8651955127716, -307.11938843131065, -300.4815105833113, -302.5099352300167, -291.34767071530223, -320.2939276099205, -53.6416085958481, -347.7847535014153, -320.4525169879198, -336.76238867640495, -307.7279775738716, -302.213662520051, -292.1313550621271, -325.13631054759026, -327.0572298169136, -298.1348282694817, -310.97084495425224, -296.1494491249323, -292.87034310400486, -603.2892135828733, -361.5851452052593, -323.9727834351361, -329.3668508529663, -314.6845931112766, -333.724720954895, -32.40688940882683, -298.5380426943302, -315.5675517618657, -314.9080222696066, -290.8910761550069, -309.035796046257, -288.504226565361, -303.820932134986, -284.6500259190798, -307.87898080050945, -305.8331202864647, -332.0963721871376, -316.22310039401054, -292.33905406296253, -318.52761698514223, -310.0593556165695, -320.78654362261295, -328.0885939002037, -318.78791822493076, -308.3630978167057, -303.37634605169296, -321.6379226148129, -315.7131233215332, -311.67510136961937, -303.84953664243227, -306.74274185299873], "episode_lengths": [78, 52, 57, 72, 58, 68, 81, 70, 58, 77, 65, 78, 76, 77, 103, 93, 70, 300, 78, 59, 100, 72, 51, 64, 72, 65, 74, 76, 60, 64, 57, 123, 95, 63, 77, 56, 97, 71, 47, 64, 80, 65, 62, 74, 77, 116, 78, 55, 300, 48, 72, 54, 79, 67, 63, 300, 82, 69, 212, 60, 91, 67, 63, 59, 77, 53, 72, 108, 52, 92, 138, 61, 66, 64, 300, 63, 63, 59, 96, 77, 72, 60, 76, 93, 65, 58, 74, 82, 56, 94, 54, 72, 67, 72, 45, 74, 78, 68, 67, 56], "policy_shared_policy_reward": [-103.23028292258581, -116.50134619077048, -103.1366243561109, -94.81575003017983, -94.99934101601443, -107.08423407872519, -111.08960578838985, -106.6600205997626, -119.44643596808116, -118.01842159032822, -106.25557696819305, -105.09295305609703, -99.93159391979377, -98.99750446031491, -112.48583958546321, -111.31038554509482, -96.42228015263876, -95.42565409590802, -102.60657753547034, -101.78585406144461, -113.83262451489767, -94.80907829354207, -96.66180727879207, -107.99014327923457, -102.77872456113498, -104.08257989088695, -117.96157626310985, -112.64129636685054, -104.44292692343394, -105.40181545416515, -114.20411968231201, -99.48477962613106, -103.01629000902176, -105.7558696269989, -104.48732423782349, -116.13545882701874, -97.36622287829718, -96.54500401516756, -108.59700961907706, -94.38107180595398, -92.87081371247768, -109.01231515407562, -95.29353356361389, -107.34943544864655, -95.14485439658165, -95.7798135188253, -96.71689773102602, -108.68016960223517, -118.6591708858808, -106.23232679565749, -106.25887276728949, 3.2273565605282784, 2.8437069058418274, 3.130573071539402, -103.4918600221475, -114.78229596217474, -102.87193237741789, -100.88908628622691, -112.33993963400523, -97.59489991764228, -101.2981327176094, -88.1739333756268, -91.1675636768341, -114.63214723269145, -102.2085378120343, -115.5781015555064, -109.52955400943756, -97.22774094343185, -96.44962391257286, -102.20497428129117, -116.3979462782542, -102.94026749829452, -116.77057466904323, -102.68948487440746, -103.57015318671863, -102.63770802815756, -100.98349614938101, -113.52750672896704, -118.51768898963928, -105.67794638872147, -105.51413404941559, -92.44017627152304, -105.68805501858394, -92.61992146323125, -95.14996961752574, -110.13069943586986, -95.05751029650371, -100.37004913886389, -111.34996261199316, -101.67573865254721, -101.48963637153308, -102.80586800972621, -114.42887179056804, -95.63925888389349, -108.29673796892166, -97.20714524388313, -105.92242379983267, -122.89286931355795, -104.57769562800726, -97.02166772882144, -110.58768353859584, -96.7574274862806, -105.30665399630865, -92.58191460867724, -93.97719981273016, -110.73211256663005, -100.5707219640414, -100.79833213488261, -100.99257614215216, -91.19603272279105, -89.1004132082065, -89.88317154347897, -90.77133700251579, -103.94243359565735, -103.87296183904013, -102.43737383683523, -113.47959264119467, -115.40086871385574, -102.9759028032422, -106.74261456727982, -101.37608156104884, -113.6063993771871, -102.08517395456633, -107.40652815500896, -95.20259478191535, -97.05294267336528, -109.67728674411774, -105.05537688732147, -115.15331000089645, -95.30217533310255, -98.2648809750875, -109.59980328877768, -108.01381055514018, -104.64349393049876, -103.01345158616702, -93.440608193477, -92.73616727193198, -106.44679691394171, -109.51697031656902, -110.4952938357989, -121.84365014235179, -112.18333518505096, -103.7765816450119, -99.9034378156066, -13.5232027048866, -14.407043586174652, -15.706865767637893, -104.24785095453262, -105.36687242984772, -118.25047212839127, -112.51992921034496, -97.7564328412215, -96.84302637974422, -107.6758101185163, -95.34770389770469, -97.45799656709036, -108.73702085018158, -96.82073301076889, -96.95218136906624, -105.92799053589503, -92.80246638755004, -92.61721379185717, -115.4772242307663, -101.64591097831726, -103.17079240083694, -17.387508655587837, -17.974721471468612, -18.27937846879165, -122.78398694594702, -111.49825962384543, -113.50250693162283, -116.73051484425864, -100.89513019224009, -102.82687195142111, -108.26067046324413, -107.50677914420764, -120.9949390689532, -99.09841247399649, -98.8478314181169, -109.78173368175825, -96.60891437033813, -108.85737226406734, -96.74737588564555, -106.85521320501964, -93.99326817194621, -91.28287368516128, -104.18120094140372, -103.45170282324156, -117.503406782945, -104.53652970989546, -105.2002107401689, -117.32048936684927, -93.43177700539431, -111.23901100953421, -93.46404025455317, -99.42387820283572, -112.32988373438518, -99.21708301703136, -94.1581729054451, -109.43939089775085, -92.55188532173634, -94.23497140407562, -105.11923789978027, -93.51613380014896, -210.31379536787668, -196.2599454174439, -196.71547279755274, -113.73338199655215, -119.36299137274425, -128.48877183596295, -104.18835772573948, -103.19866761937737, -116.58575809001923, -105.73325554529826, -106.04525516430537, -117.58834014336269, -99.78460104266803, -101.30830005804698, -113.59169201056163, -105.60730840762457, -118.37549712260565, -109.74191542466482, -10.754240162670612, -10.894799053668976, -10.75785019248724, -96.01495358347893, -95.65815824270248, -106.8649308681488, -113.23126884301504, -101.67570116122565, -100.66058175762495, -96.94709424674511, -108.49639308452606, -109.46453493833542, -93.41296496987343, -105.19639003276825, -92.28172115236521, -99.88082800308864, -111.08539764086406, -98.06957040230434, -92.0487756729126, -93.56446784734726, -102.89098304510117, -96.41666082044443, -108.3160794277986, -99.08819188674292, -92.60016837219398, -99.29716126124065, -92.75269628564517, -98.52800585826239, -112.78065808614096, -96.57031685610613, -97.67954725027084, -110.38685369491577, -97.76671934127808, -117.59191312392554, -107.49747343858084, -107.00698562463126, -100.65887276331584, -113.97682581345241, -101.58740181724231, -92.97831662495932, -106.40959360202154, -92.9511438359817, -102.56051076451938, -100.80812634776036, -115.1589798728625, -111.12058275938034, -98.92846995592117, -100.010302901268, -102.06524823606014, -115.22475343942642, -103.49654194712639, -117.34717035293579, -104.97554355859756, -105.76587998867035, -114.87239531675975, -101.32948174575965, -102.58604116241138, -98.1218992372354, -110.05545260508856, -100.18574597438177, -97.0096975217263, -109.67090461651485, -96.69574391345184, -99.81345944603285, -116.84988268216452, -104.97458048661551, -112.36301151911418, -99.93212519089381, -103.41798661152522, -99.7988377014796, -112.80780653158824, -99.06845713655154, -96.47821859021983, -110.69592007001242, -96.6753979822, -98.52081475655238, -98.07756347457568, -110.14436362187068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17377135690223036, "mean_inference_ms": 0.6547626459761298, "mean_action_processing_ms": 0.09436912874804956, "mean_env_wait_ms": 0.7779109324248266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"sample_time_ms": 9209.012, "sample_throughput": 521.229, "load_time_ms": 0.167, "load_throughput": 28774643.926, "learn_time_ms": 1183.012, "learn_throughput": 4057.439, "update_time_ms": 1.331}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 3714.1327514648438, "policy_loss": -0.002620936520834505, "vf_loss": 3714.1930541992188, "vf_explained_var": 0.004394263029098511, "kl": 0.004729906053399933, "entropy": 5.7802571058273315, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 86400, "num_steps_trained": 28800, "num_agent_steps_trained": 86400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 384, "training_iteration": 6, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-43-32", "timestamp": 1706147012, "time_this_iter_s": 9.56498646736145, "time_total_s": 56.39068412780762, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C2D8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 56.39068412780762, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 8.038461538461538, "ram_util_percent": 44.16923076923077}}
{"episode_reward_max": -32.40688940882683, "episode_reward_min": -603.2892135828733, "episode_reward_mean": -307.56379304242364, "episode_len_mean": 73.15, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {"shared_policy": -210.31379536787668}, "policy_reward_max": {"shared_policy": -10.754240162670612}, "policy_reward_mean": {"shared_policy": -102.52126434747454}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-603.2892135828733, -361.5851452052593, -323.9727834351361, -329.3668508529663, -314.6845931112766, -333.724720954895, -32.40688940882683, -298.5380426943302, -315.5675517618657, -314.9080222696066, -290.8910761550069, -309.035796046257, -288.504226565361, -303.820932134986, -284.6500259190798, -307.87898080050945, -305.8331202864647, -332.0963721871376, -316.22310039401054, -292.33905406296253, -318.52761698514223, -310.0593556165695, -320.78654362261295, -328.0885939002037, -318.78791822493076, -308.3630978167057, -303.37634605169296, -321.6379226148129, -315.7131233215332, -311.67510136961937, -303.84953664243227, -306.74274185299873, -309.8478158004582, -322.3550908565521, -304.09878221154213, -310.3930062390864, -302.03582118451595, -299.9567318558693, -310.0357346534729, -316.7338660657406, -300.63262474536896, -302.67238377034664, -326.9261910766363, -329.6311120390892, -301.6312373280525, -293.4563166499138, -322.35776291787624, -318.15695041418076, -306.0619804859162, -304.66521011292934, -325.79163908958435, -332.42402279376984, -314.28086296096444, -308.4757700935006, -293.86533765494823, -313.95542415976524, -323.61966244876385, -305.98631957173353, -287.9846690520644, -314.95125891268253, -321.37244871258736, -299.33159914612776, -286.46798571944237, -326.57245430350304, -297.3016757900332, -301.36970753222704, -307.5972070544958, -317.88883769512177, -316.0462963283062, -299.24524250626564, -307.0188413653523, -309.4906520694494, -312.99433191120625, -327.31164782494307, -305.04805186390877, -303.14106898754835, -317.33143201470375, -320.52426077425486, -328.7447117269039, -313.7873275578022, -315.5127529799938, -316.34993819892406, -291.3469371199608, -298.70630110800266, -288.8705279827118, -299.9268717765808, -62.46470456197855, -290.7663823068142, -305.3889230787754, -315.1815270558, -306.3674236088991, -298.05220901966095, -309.59398250840604, -289.7368569076061, -294.61567273736, -311.8845351934433, -300.5675770044327, -315.14880988001823, -286.32462736964226, -311.07898196578026], "episode_lengths": [52, 92, 138, 61, 66, 64, 300, 63, 63, 59, 96, 77, 72, 60, 76, 93, 65, 58, 74, 82, 56, 94, 54, 72, 67, 72, 45, 74, 78, 68, 67, 56, 70, 60, 103, 58, 71, 79, 70, 60, 50, 54, 91, 64, 91, 66, 149, 70, 54, 53, 61, 63, 41, 56, 76, 75, 42, 68, 90, 45, 66, 75, 66, 59, 77, 67, 63, 62, 62, 58, 58, 52, 93, 57, 60, 56, 60, 49, 63, 66, 61, 74, 64, 78, 131, 73, 300, 71, 52, 70, 47, 68, 57, 68, 67, 80, 63, 35, 88, 55], "policy_shared_policy_reward": [-210.31379536787668, -196.2599454174439, -196.71547279755274, -113.73338199655215, -119.36299137274425, -128.48877183596295, -104.18835772573948, -103.19866761937737, -116.58575809001923, -105.73325554529826, -106.04525516430537, -117.58834014336269, -99.78460104266803, -101.30830005804698, -113.59169201056163, -105.60730840762457, -118.37549712260565, -109.74191542466482, -10.754240162670612, -10.894799053668976, -10.75785019248724, -96.01495358347893, -95.65815824270248, -106.8649308681488, -113.23126884301504, -101.67570116122565, -100.66058175762495, -96.94709424674511, -108.49639308452606, -109.46453493833542, -93.41296496987343, -105.19639003276825, -92.28172115236521, -99.88082800308864, -111.08539764086406, -98.06957040230434, -92.0487756729126, -93.56446784734726, -102.89098304510117, -96.41666082044443, -108.3160794277986, -99.08819188674292, -92.60016837219398, -99.29716126124065, -92.75269628564517, -98.52800585826239, -112.78065808614096, -96.57031685610613, -97.67954725027084, -110.38685369491577, -97.76671934127808, -117.59191312392554, -107.49747343858084, -107.00698562463126, -100.65887276331584, -113.97682581345241, -101.58740181724231, -92.97831662495932, -106.40959360202154, -92.9511438359817, -102.56051076451938, -100.80812634776036, -115.1589798728625, -111.12058275938034, -98.92846995592117, -100.010302901268, -102.06524823606014, -115.22475343942642, -103.49654194712639, -117.34717035293579, -104.97554355859756, -105.76587998867035, -114.87239531675975, -101.32948174575965, -102.58604116241138, -98.1218992372354, -110.05545260508856, -100.18574597438177, -97.0096975217263, -109.67090461651485, -96.69574391345184, -99.81345944603285, -116.84988268216452, -104.97458048661551, -112.36301151911418, -99.93212519089381, -103.41798661152522, -99.7988377014796, -112.80780653158824, -99.06845713655154, -96.47821859021983, -110.69592007001242, -96.6753979822, -98.52081475655238, -98.07756347457568, -110.14436362187068, -98.30156089738011, -111.39358162879944, -100.15267327427864, -114.87187997500102, -104.63131831089656, -102.85189257065456, -95.76826700568199, -109.9318470954895, -98.39866811037064, -100.50763952732086, -98.68880895152688, -111.19655776023865, -96.21816966434321, -109.05105765660605, -96.76659386356673, -107.53446123997371, -95.61221770445506, -96.81005291144054, -99.01179106036822, -111.34274975458781, -99.68119383851688, -111.9801316757997, -101.96213926871619, -102.79159512122473, -94.97078740596771, -107.25591415166855, -98.4059231877327, -108.88160866498947, -96.70496349036694, -97.08581161499023, -104.54513917366664, -104.79890974859397, -117.58214215437572, -119.01470486323039, -105.06888259450595, -105.54752458135287, -108.2851126988729, -95.86579339702925, -97.4803312321504, -105.62022668123245, -93.7184630036354, -94.11762696504593, -102.31098870933056, -104.22003078460693, -115.82674342393875, -103.34132798512778, -114.00395341714224, -100.81166901191077, -98.90323104461035, -98.52681132157645, -108.63193811972937, -109.22259060541789, -96.77260508636634, -98.67001442114513, -114.14318372805914, -105.48579295476279, -106.16266240676245, -106.04708331823349, -119.85350596904755, -106.5234335064888, -100.0797893802325, -115.41981867949168, -98.78125490124027, -98.31032767891884, -112.35075771808624, -97.81468469649553, -105.7520682811737, -94.64014557003975, -93.47312380373478, -111.35387267669043, -100.63714276750883, -101.96440871556601, -103.11216667294502, -118.31896185874939, -102.18853391706944, -96.32054739197096, -99.76554789145789, -109.90022428830466, -106.19939959049225, -90.97824493795633, -90.80702452361584, -100.18361340463161, -113.64369857311249, -101.12394693493843, -101.91729632019997, -116.14445519447327, -103.31069719791412, -106.75359918673834, -95.19481717546782, -97.38318278392157, -102.60819437106451, -93.10433717568716, -90.75545417269072, -105.0430564681689, -116.76379547516505, -104.7656023601691, -98.21618262926738, -92.9654756521001, -106.12001750866573, -109.10370729366939, -95.29787193487088, -96.96812830368678, -98.71087163686752, -111.59962058067322, -97.28671483695507, -104.48917059103648, -111.99881700674693, -101.40085009733836, -102.49749366442363, -101.7376493314902, -111.81115333239238, -95.45798963308334, -107.54396921396255, -96.24328365921974, -109.93354141712189, -99.30222377181053, -97.78307617641985, -99.3752774298191, -112.08339047431946, -98.03198416531086, -99.13368991514048, -113.04227634270987, -100.81836565335593, -117.55322909355164, -104.05094685405493, -105.7074718773365, -96.86131202181181, -109.67114545901617, -98.51559438308081, -110.9358780781428, -96.48269257942836, -95.7224983299772, -101.92967128753662, -110.76622840762138, -104.63553231954575, -101.70772758622965, -114.71478392680487, -104.1017492612203, -105.84143534302711, -117.00779378414154, -105.89548259973526, -100.66157802939415, -111.30239218473434, -101.8233573436737, -113.649682700634, -100.1970674097538, -101.66600286960602, -101.47450031836829, -113.3224427898725, -101.55299509068331, -93.6249029636383, -92.76721745729446, -104.95481669902802, -96.20484993855159, -94.59464066723983, -107.90681050221126, -91.45145881175995, -104.02045685052872, -93.39861232042313, -94.32866994539897, -106.10012714068095, -99.4980746905009, -19.975345169504486, -19.58612864588698, -22.90323074658712, -91.80308618148169, -105.29692896207175, -93.66636716326079, -97.58261045316856, -110.1647913257281, -97.64152129987876, -112.90883149703345, -101.60522069533667, -100.66747486342987, -110.24261315663657, -98.62870772679648, -97.4961027254661, -106.57058507204056, -95.6363870203495, -95.84523692727089, -98.25325661587219, -113.00818626085918, -98.33253963167469, -92.42555705706279, -104.6793183485667, -92.63198150197665, -105.37982267141342, -95.44488352537155, -93.79096654057503, -112.95799521605174, -97.82796291510265, -101.09857706228892, -107.93870651721954, -95.9881209731102, -96.64074951410294, -100.8939248174429, -100.13672707974911, -114.11815798282623, -99.89062104622523, -87.18126435081165, -99.25274197260539, -112.33069312572479, -99.75111362338066, -98.9971752166748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1752049659478839, "mean_inference_ms": 0.6644105227515581, "mean_action_processing_ms": 0.09598849418687096, "mean_env_wait_ms": 0.78460950615273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 33600, "timesteps_this_iter": 0, "agent_timesteps_total": 100800, "timers": {"sample_time_ms": 9385.403, "sample_throughput": 511.433, "load_time_ms": 0.143, "load_throughput": 33570417.913, "learn_time_ms": 1203.562, "learn_throughput": 3988.162, "update_time_ms": 1.284}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 3987.2353515625, "policy_loss": -0.002595971258738672, "vf_loss": 3987.296875, "vf_explained_var": -0.0021117478609085083, "kl": 0.005572685644439381, "entropy": 5.900856137275696, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 33600, "num_agent_steps_sampled": 100800, "num_steps_trained": 33600, "num_agent_steps_trained": 100800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 452, "training_iteration": 7, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-43-43", "timestamp": 1706147023, "time_this_iter_s": 10.45573091506958, "time_total_s": 66.8464150428772, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015C9040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 66.8464150428772, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 8.373333333333333, "ram_util_percent": 44.406666666666666}}
{"episode_reward_max": -25.462611630558968, "episode_reward_min": -591.6781243830919, "episode_reward_mean": -291.0632128085433, "episode_len_mean": 83.94, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {"shared_policy": -207.78225886821747}, "policy_reward_max": {"shared_policy": -7.041005112230778}, "policy_reward_mean": {"shared_policy": -97.0210709361811}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306.0619804859162, -304.66521011292934, -325.79163908958435, -332.42402279376984, -314.28086296096444, -308.4757700935006, -293.86533765494823, -313.95542415976524, -323.61966244876385, -305.98631957173353, -287.9846690520644, -314.95125891268253, -321.37244871258736, -299.33159914612776, -286.46798571944237, -326.57245430350304, -297.3016757900332, -301.36970753222704, -307.5972070544958, -317.88883769512177, -316.0462963283062, -299.24524250626564, -307.0188413653523, -309.4906520694494, -312.99433191120625, -327.31164782494307, -305.04805186390877, -303.14106898754835, -317.33143201470375, -320.52426077425486, -328.7447117269039, -313.7873275578022, -315.5127529799938, -316.34993819892406, -291.3469371199608, -298.70630110800266, -288.8705279827118, -299.9268717765808, -62.46470456197855, -290.7663823068142, -305.3889230787754, -315.1815270558, -306.3674236088991, -298.05220901966095, -309.59398250840604, -289.7368569076061, -294.61567273736, -311.8845351934433, -300.5675770044327, -315.14880988001823, -286.32462736964226, -311.07898196578026, -61.75713026523591, -326.5712220482528, -312.68697172403336, -591.6781243830919, -312.3982546031475, -310.2573382668197, -64.6946246773005, -308.113023519516, -322.0132463425398, -307.67491459846497, -293.8984343856573, -310.3004667162895, -315.6334555596113, -306.8661846742034, -296.1427091360093, -320.20026874542236, -36.33356538414958, -303.8353915885091, -316.88090535625815, -305.08217227458954, -319.3656940758229, -308.56986812502146, -318.3809905946255, -308.3480127751828, -297.3235402200371, -312.27798584103584, -288.5818037390709, -320.67052391171455, -312.3697947189212, -331.67652958631516, -326.021868288517, -294.0753127038479, -295.2912752330303, -311.9743825495243, -316.81416015326977, -296.3545986488462, -67.56410019099712, -302.4538455605507, -44.787172280251994, -309.4740409255028, -305.2833256870508, -313.7395990137011, -46.916123773902655, -313.92223888402805, -25.462611630558968, -315.9081572443247, -307.81436532735825, -313.34747433662415], "episode_lengths": [54, 53, 61, 63, 41, 56, 76, 75, 42, 68, 90, 45, 66, 75, 66, 59, 77, 67, 63, 62, 62, 58, 58, 52, 93, 57, 60, 56, 60, 49, 63, 66, 61, 74, 64, 78, 131, 73, 300, 71, 52, 70, 47, 68, 57, 68, 67, 80, 63, 35, 88, 55, 300, 59, 49, 69, 77, 59, 300, 57, 57, 82, 75, 65, 64, 49, 73, 83, 300, 57, 56, 161, 57, 49, 74, 58, 58, 58, 68, 79, 64, 51, 69, 58, 59, 63, 50, 55, 300, 84, 300, 90, 55, 64, 300, 56, 300, 52, 71, 65], "policy_shared_policy_reward": [-98.90323104461035, -98.52681132157645, -108.63193811972937, -109.22259060541789, -96.77260508636634, -98.67001442114513, -114.14318372805914, -105.48579295476279, -106.16266240676245, -106.04708331823349, -119.85350596904755, -106.5234335064888, -100.0797893802325, -115.41981867949168, -98.78125490124027, -98.31032767891884, -112.35075771808624, -97.81468469649553, -105.7520682811737, -94.64014557003975, -93.47312380373478, -111.35387267669043, -100.63714276750883, -101.96440871556601, -103.11216667294502, -118.31896185874939, -102.18853391706944, -96.32054739197096, -99.76554789145789, -109.90022428830466, -106.19939959049225, -90.97824493795633, -90.80702452361584, -100.18361340463161, -113.64369857311249, -101.12394693493843, -101.91729632019997, -116.14445519447327, -103.31069719791412, -106.75359918673834, -95.19481717546782, -97.38318278392157, -102.60819437106451, -93.10433717568716, -90.75545417269072, -105.0430564681689, -116.76379547516505, -104.7656023601691, -98.21618262926738, -92.9654756521001, -106.12001750866573, -109.10370729366939, -95.29787193487088, -96.96812830368678, -98.71087163686752, -111.59962058067322, -97.28671483695507, -104.48917059103648, -111.99881700674693, -101.40085009733836, -102.49749366442363, -101.7376493314902, -111.81115333239238, -95.45798963308334, -107.54396921396255, -96.24328365921974, -109.93354141712189, -99.30222377181053, -97.78307617641985, -99.3752774298191, -112.08339047431946, -98.03198416531086, -99.13368991514048, -113.04227634270987, -100.81836565335593, -117.55322909355164, -104.05094685405493, -105.7074718773365, -96.86131202181181, -109.67114545901617, -98.51559438308081, -110.9358780781428, -96.48269257942836, -95.7224983299772, -101.92967128753662, -110.76622840762138, -104.63553231954575, -101.70772758622965, -114.71478392680487, -104.1017492612203, -105.84143534302711, -117.00779378414154, -105.89548259973526, -100.66157802939415, -111.30239218473434, -101.8233573436737, -113.649682700634, -100.1970674097538, -101.66600286960602, -101.47450031836829, -113.3224427898725, -101.55299509068331, -93.6249029636383, -92.76721745729446, -104.95481669902802, -96.20484993855159, -94.59464066723983, -107.90681050221126, -91.45145881175995, -104.02045685052872, -93.39861232042313, -94.32866994539897, -106.10012714068095, -99.4980746905009, -19.975345169504486, -19.58612864588698, -22.90323074658712, -91.80308618148169, -105.29692896207175, -93.66636716326079, -97.58261045316856, -110.1647913257281, -97.64152129987876, -112.90883149703345, -101.60522069533667, -100.66747486342987, -110.24261315663657, -98.62870772679648, -97.4961027254661, -106.57058507204056, -95.6363870203495, -95.84523692727089, -98.25325661587219, -113.00818626085918, -98.33253963167469, -92.42555705706279, -104.6793183485667, -92.63198150197665, -105.37982267141342, -95.44488352537155, -93.79096654057503, -112.95799521605174, -97.82796291510265, -101.09857706228892, -107.93870651721954, -95.9881209731102, -96.64074951410294, -100.8939248174429, -100.13672707974911, -114.11815798282623, -99.89062104622523, -87.18126435081165, -99.25274197260539, -112.33069312572479, -99.75111362338066, -98.9971752166748, -20.94220527013143, -20.06009884675344, -20.754826148351036, -102.68812146907052, -104.22979890306792, -119.65330167611441, -99.89301001032194, -112.39394476016363, -100.4000169535478, -207.78225886821747, -191.68265442550182, -192.21321108937263, -112.87425971031189, -100.08281460404396, -99.44118028879166, -99.0264013533791, -112.57468690474829, -98.65625000869235, -21.03278542061647, -21.289226879676185, -22.372612377007805, -104.17921976248424, -102.26561398307483, -101.66818977395694, -122.15433994928996, -99.95734299222629, -99.90156340102355, -98.98334324359894, -97.94240832328796, -110.74916303157806, -94.17787717282772, -105.30688160657883, -94.41367560625076, -109.96854643026988, -101.02465788523357, -99.30726240078609, -101.46570373574893, -113.55760548512141, -100.61014633874099, -110.66452223062515, -98.14104062691331, -98.06062181666493, -95.46277995904288, -94.99792273839316, -105.68200643857321, -101.54228264093399, -102.1657287478447, -116.49225735664368, -12.04539253314337, -12.090167542298644, -12.198005308707565, -109.3516633907954, -96.33354036758344, -98.15018783013026, -100.7888143969079, -101.62994257112345, -114.46214838822684, -97.22643304864566, -109.38400898377101, -98.47173024217288, -116.22107287247977, -101.63131431986889, -101.5133068834742, -99.23619062701862, -111.28830806414287, -98.04536943385999, -101.35477273662886, -114.03266086181006, -102.99355699618658, -109.83163895209631, -99.07824950416884, -99.4381243189176, -107.80212503671646, -94.29477838613093, -95.22663679718971, -99.34562694032988, -112.82562847932181, -100.10673042138419, -104.80070143938065, -92.17512279748917, -91.60597950220108, -102.44143497447173, -115.69655571381251, -102.53253322343032, -112.35948057969412, -100.86520569523177, -99.14510844399533, -101.99328738451004, -113.14006733894348, -116.54317486286163, -116.64587179819743, -103.38295618693034, -105.99304030338924, -105.36332714557648, -93.84903255105019, -94.86295300722122, -105.473164220651, -96.07730259497961, -93.74080841739973, -102.71787653366725, -99.09603113929431, -110.16047487656276, -100.98321764171124, -101.1831367611885, -114.64780575037003, -94.45149531712136, -106.13952951629958, -95.76357381542525, -22.083015347520515, -22.525734434525177, -22.955350408951446, -109.55954893430075, -96.74105777343115, -96.15323885281882, -14.864683205882713, -14.226117449502155, -15.696371624867126, -106.9709584315618, -95.59218766291937, -106.91089483102164, -97.45213322341442, -109.43040370941162, -98.40078875422478, -101.468466848135, -112.6593227982521, -99.61180936731398, -14.9380933791399, -14.469923984259367, -17.508106410503387, -99.5160210407339, -113.5841714143753, -100.82204642891884, -7.163365103304386, -7.041005112230778, -11.258241415023804, -100.84755818545818, -114.54229402542114, -100.51830503344536, -110.33007681369781, -98.53861846029758, -98.94567005336285, -111.21353179216385, -99.9752727150917, -102.15866982936859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17534360102623964, "mean_inference_ms": 0.6709053662465013, "mean_action_processing_ms": 0.09697719080095352, "mean_env_wait_ms": 0.7889929967870966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"sample_time_ms": 9458.676, "sample_throughput": 507.471, "load_time_ms": 0.125, "load_throughput": 38366191.901, "learn_time_ms": 1213.718, "learn_throughput": 3954.792, "update_time_ms": 1.248}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 2495.563720703125, "policy_loss": -0.00225228160644797, "vf_loss": 2495.6239624023438, "vf_explained_var": 0.01857040822505951, "kl": 0.0027988524780100444, "entropy": 5.799944460391998, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 115200, "num_steps_trained": 38400, "num_agent_steps_trained": 115200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 500, "training_iteration": 8, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-43-53", "timestamp": 1706147033, "time_this_iter_s": 9.900757074356079, "time_total_s": 76.74717211723328, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015CFAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 76.74717211723328, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 8.542857142857143, "ram_util_percent": 44.464285714285715}}
{"episode_reward_max": 3.877424895763397, "episode_reward_min": -332.1100198626518, "episode_reward_mean": -287.4492559611355, "episode_len_mean": 83.59, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {"shared_policy": -118.58806769053142}, "policy_reward_max": {"shared_policy": 1.7766255512833595}, "policy_reward_mean": {"shared_policy": -95.81641865371184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-293.8984343856573, -310.3004667162895, -315.6334555596113, -306.8661846742034, -296.1427091360093, -320.20026874542236, -36.33356538414958, -303.8353915885091, -316.88090535625815, -305.08217227458954, -319.3656940758229, -308.56986812502146, -318.3809905946255, -308.3480127751828, -297.3235402200371, -312.27798584103584, -288.5818037390709, -320.67052391171455, -312.3697947189212, -331.67652958631516, -326.021868288517, -294.0753127038479, -295.2912752330303, -311.9743825495243, -316.81416015326977, -296.3545986488462, -67.56410019099712, -302.4538455605507, -44.787172280251994, -309.4740409255028, -305.2833256870508, -313.7395990137011, -46.916123773902655, -313.92223888402805, -25.462611630558968, -315.9081572443247, -307.81436532735825, -313.34747433662415, -320.7908818125725, -303.14885982871056, -300.20989783108234, -326.1106877923012, -330.88085263967514, -326.6945217521861, -47.60333479940891, -301.133088670671, -303.9096028935164, -308.50281174108386, -305.58456986770034, -292.6545790657401, -316.7646610736847, -314.6776956617832, -300.02164439857006, -303.4372108876705, -326.13280111551285, -303.18110769987106, -309.1167820096016, -315.4854367673397, -302.4361452162266, -287.82189036905766, -298.1852854490281, -313.2307934407145, -299.33784829080105, -318.37274816632276, -311.19928732514387, -325.78409257531166, -314.46375206578523, -305.6512031853199, -304.76853746175766, -308.53499069809914, -303.14229398965836, -323.40774711966515, -310.98155632615095, -300.81766176223755, -296.9574121274054, -314.4025356769562, -314.24865801632404, -298.94150437042117, -288.98008677363396, -296.6339341402054, 3.877424895763397, -300.3072582781315, -300.71190295368433, -323.1228075623512, -327.965208619833, -332.1100198626518, -32.074120938777924, -310.0578395575285, -305.23722144565545, -323.3024372160435, -310.78765563666826, -309.63551968336105, -322.0229567885399, -298.3853540159762, -290.87306751310825, -294.5730509161949, -328.15740793943405, -298.1850520968437, -308.1112003698945, -308.89899691939354], "episode_lengths": [75, 65, 64, 49, 73, 83, 300, 57, 56, 161, 57, 49, 74, 58, 58, 58, 68, 79, 64, 51, 69, 58, 59, 63, 50, 55, 300, 84, 300, 90, 55, 64, 300, 56, 300, 52, 71, 65, 58, 57, 68, 67, 55, 56, 300, 64, 57, 52, 59, 84, 78, 54, 56, 86, 64, 51, 62, 63, 66, 68, 75, 57, 60, 53, 61, 54, 61, 72, 71, 57, 70, 91, 61, 81, 54, 73, 49, 67, 67, 57, 300, 66, 59, 57, 64, 61, 300, 61, 72, 66, 53, 86, 76, 62, 60, 64, 66, 60, 64, 56], "policy_shared_policy_reward": [-94.17787717282772, -105.30688160657883, -94.41367560625076, -109.96854643026988, -101.02465788523357, -99.30726240078609, -101.46570373574893, -113.55760548512141, -100.61014633874099, -110.66452223062515, -98.14104062691331, -98.06062181666493, -95.46277995904288, -94.99792273839316, -105.68200643857321, -101.54228264093399, -102.1657287478447, -116.49225735664368, -12.04539253314337, -12.090167542298644, -12.198005308707565, -109.3516633907954, -96.33354036758344, -98.15018783013026, -100.7888143969079, -101.62994257112345, -114.46214838822684, -97.22643304864566, -109.38400898377101, -98.47173024217288, -116.22107287247977, -101.63131431986889, -101.5133068834742, -99.23619062701862, -111.28830806414287, -98.04536943385999, -101.35477273662886, -114.03266086181006, -102.99355699618658, -109.83163895209631, -99.07824950416884, -99.4381243189176, -107.80212503671646, -94.29477838613093, -95.22663679718971, -99.34562694032988, -112.82562847932181, -100.10673042138419, -104.80070143938065, -92.17512279748917, -91.60597950220108, -102.44143497447173, -115.69655571381251, -102.53253322343032, -112.35948057969412, -100.86520569523177, -99.14510844399533, -101.99328738451004, -113.14006733894348, -116.54317486286163, -116.64587179819743, -103.38295618693034, -105.99304030338924, -105.36332714557648, -93.84903255105019, -94.86295300722122, -105.473164220651, -96.07730259497961, -93.74080841739973, -102.71787653366725, -99.09603113929431, -110.16047487656276, -100.98321764171124, -101.1831367611885, -114.64780575037003, -94.45149531712136, -106.13952951629958, -95.76357381542525, -22.083015347520515, -22.525734434525177, -22.955350408951446, -109.55954893430075, -96.74105777343115, -96.15323885281882, -14.864683205882713, -14.226117449502155, -15.696371624867126, -106.9709584315618, -95.59218766291937, -106.91089483102164, -97.45213322341442, -109.43040370941162, -98.40078875422478, -101.468466848135, -112.6593227982521, -99.61180936731398, -14.9380933791399, -14.469923984259367, -17.508106410503387, -99.5160210407339, -113.5841714143753, -100.82204642891884, -7.163365103304386, -7.041005112230778, -11.258241415023804, -100.84755818545818, -114.54229402542114, -100.51830503344536, -110.33007681369781, -98.53861846029758, -98.94567005336285, -111.21353179216385, -99.9752727150917, -102.15866982936859, -101.94990873336792, -115.012928545475, -103.82804453372955, -97.59260230263075, -108.85620691378912, -96.70005061229071, -95.05204387009144, -107.97502368688583, -97.18283027410507, -103.25681465864182, -117.12607491016388, -105.72779822349548, -106.97169820467631, -118.58806769053142, -105.32108674446742, -116.54809510707855, -102.50365051347762, -107.64277613162994, -14.715564504265785, -15.616978883743286, -17.27079141139984, -94.77600886672735, -97.76738780736923, -108.5896919965744, -96.88656169983248, -109.5631291071574, -97.45991208652656, -98.72812334696452, -96.46510886276762, -113.30957953135173, -97.27683299407363, -98.7709875702858, -109.53674930334091, -93.39428510765235, -105.68516496817271, -93.57512898991506, -100.63333968321483, -101.50401035944621, -114.62731103102367, -98.66436696052551, -99.99049416184425, -116.02283453941345, -95.50256371994814, -107.58837439616522, -96.93070628245673, -96.65704731146495, -96.41683329145114, -110.36333028475444, -104.05817675590515, -116.61662924289703, -105.45799511671066, -96.76713865995407, -109.22946047782898, -97.18450856208801, -110.51210067669551, -98.32532666126887, -100.27935467163722, -100.74997911850612, -101.75336981813113, -112.98208783070247, -108.7409666577975, -97.10491929451625, -96.59025926391284, -103.73654858271281, -92.82651499907176, -91.2588267872731, -107.18461974461874, -95.94781949122748, -95.05284621318182, -98.97962410685918, -113.88138886292776, -100.36978047092757, -97.00193971892199, -100.46953209241232, -101.86637647946677, -116.24594195683798, -100.89003815253577, -101.23676805694899, -100.09408523639044, -100.61829735835394, -110.48690473039946, -116.40431867043178, -106.2524674932162, -103.1273064116637, -113.29087764024734, -101.82297587394714, -99.34989855159074, -98.19987846414249, -109.9102011124293, -97.54112360874812, -97.51848152279854, -109.6349168419838, -97.61513909697533, -111.52371029059093, -97.6804422835509, -99.33083812395732, -104.36479553580284, -104.80975687503815, -93.96774157881737, -103.58437805374464, -115.31896783908209, -104.50440122683844, -109.9519227941831, -99.55850904186568, -101.47112449010214, -96.05329291025798, -96.71881274382274, -108.04555610815684, -94.47479055201015, -107.74054123957953, -94.74208033581576, -99.90671638647716, -100.30850891272227, -114.18731037775676, -100.4834655324618, -113.92854068676631, -99.83665179709594, -95.15077909206352, -108.26508607467017, -95.52563920368752, -103.73482004801433, -92.4829436937968, -92.76232303182285, -94.75140826900801, -107.11181165774664, -94.77071421345076, 1.6640553995966911, 0.43674394488334656, 1.7766255512833595, -109.38421181837718, -95.11486641565959, -95.80818004409473, -108.53124616543452, -96.24011447528999, -95.94054231295983, -116.5831566254298, -103.43640718857448, -103.10324374834697, -117.11030101776123, -105.49190557003021, -105.36300203204155, -107.1954125960668, -106.49966367085776, -118.4149435957273, -11.656545847654343, -10.158580541610718, -10.258994549512863, -110.73132352034251, -100.30583293239276, -99.02068310479324, -110.98743768533072, -98.48091723521551, -95.76886652510925, -103.92983590563139, -104.33643688758215, -115.03616442282996, -99.00550646086535, -111.50560220082602, -100.27654697497687, -97.84415155649185, -99.35450375080109, -112.43686437606812, -102.59783333539963, -102.62680208683014, -116.79832136631012, -96.6264967918396, -93.92647621408105, -107.83238101005554, -92.93026774624984, -92.97126613060634, -104.97153363625209, -93.75235205888748, -106.52432119846344, -94.296377658844, -105.45014838377635, -115.53583721319835, -107.17142234245937, -96.1257304151853, -106.53980269034705, -95.5195189913114, -99.73707805077235, -110.93976239363353, -97.43435992548864, -110.98212720950445, -98.77804191907248, -99.13882779081663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17484323206388652, "mean_inference_ms": 0.6788538788150161, "mean_action_processing_ms": 0.09751142854445086, "mean_env_wait_ms": 0.7959031632812688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 43200, "timesteps_this_iter": 0, "agent_timesteps_total": 129600, "timers": {"sample_time_ms": 9571.719, "sample_throughput": 501.477, "load_time_ms": 0.111, "load_throughput": 43161965.889, "learn_time_ms": 1225.009, "learn_throughput": 3918.34, "update_time_ms": 1.332}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 3122.4776000976562, "policy_loss": -0.0030119830790661384, "vf_loss": 3122.5397338867188, "vf_explained_var": 0.011759787797927856, "kl": 0.008691473496584747, "entropy": 5.934084415435791, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 43200, "num_agent_steps_sampled": 129600, "num_steps_trained": 43200, "num_agent_steps_trained": 129600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 562, "training_iteration": 9, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-44-03", "timestamp": 1706147043, "time_this_iter_s": 10.484865188598633, "time_total_s": 87.23203730583191, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C24790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 87.23203730583191, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 44.399999999999984}}
{"episode_reward_max": 3.877424895763397, "episode_reward_min": -350.29025490581995, "episode_reward_mean": -296.6039836586244, "episode_len_mean": 82.68, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {"shared_policy": -124.30375226338705}, "policy_reward_max": {"shared_policy": 1.7766255512833595}, "policy_reward_mean": {"shared_policy": -98.86799455287478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-326.13280111551285, -303.18110769987106, -309.1167820096016, -315.4854367673397, -302.4361452162266, -287.82189036905766, -298.1852854490281, -313.2307934407145, -299.33784829080105, -318.37274816632276, -311.19928732514387, -325.78409257531166, -314.46375206578523, -305.6512031853199, -304.76853746175766, -308.53499069809914, -303.14229398965836, -323.40774711966515, -310.98155632615095, -300.81766176223755, -296.9574121274054, -314.4025356769562, -314.24865801632404, -298.94150437042117, -288.98008677363396, -296.6339341402054, 3.877424895763397, -300.3072582781315, -300.71190295368433, -323.1228075623512, -327.965208619833, -332.1100198626518, -32.074120938777924, -310.0578395575285, -305.23722144565545, -323.3024372160435, -310.78765563666826, -309.63551968336105, -322.0229567885399, -298.3853540159762, -290.87306751310825, -294.5730509161949, -328.15740793943405, -298.1850520968437, -308.1112003698945, -308.89899691939354, -340.47608833014965, -304.55782520771027, -316.4338462501765, -310.9755806028843, -318.8961142003536, -303.6893518567085, -285.96837559342384, -301.2450486794114, -323.607764005661, -304.48842680454254, -345.8470071852207, -288.865358017385, -310.56895551644266, -301.1081486940384, -320.091763459146, -320.5958053097129, -325.66010758280754, -318.0987595319748, -336.29743483662605, -68.00243395566942, -320.3123422265053, -297.72501743771136, -304.5490726083517, -281.01216788589954, -314.5228020548821, -327.61957374215126, -299.7105641961098, -303.1674480587244, -336.2034482061863, -324.1716766357422, -333.58839893341064, -302.17449559643865, -320.08109394460917, -316.3682506708428, -337.1865202486515, -324.8361085355282, -290.15460029244423, -331.62213665246964, -298.1960345059633, -321.32635456323624, -309.42002438008785, -350.29025490581995, -278.7465377729386, 0.2624849006533623, -301.40847516059875, -289.47286012768745, -298.78223840892315, -347.92290085554123, -277.94382689893246, -290.9210299551487, -321.53097146749496, -18.43077897280456, -321.8128931336105, -311.1180105507374], "episode_lengths": [64, 51, 62, 63, 66, 68, 75, 57, 60, 53, 61, 54, 61, 72, 71, 57, 70, 91, 61, 81, 54, 73, 49, 67, 67, 57, 300, 66, 59, 57, 64, 61, 300, 61, 72, 66, 53, 86, 76, 62, 60, 64, 66, 60, 64, 56, 226, 77, 56, 64, 62, 57, 59, 118, 66, 130, 60, 107, 62, 85, 52, 63, 95, 64, 96, 300, 59, 57, 70, 97, 67, 44, 70, 67, 56, 38, 70, 61, 45, 80, 78, 65, 77, 46, 61, 73, 46, 212, 86, 300, 74, 64, 72, 135, 129, 71, 46, 300, 61, 74], "policy_shared_policy_reward": [-104.05817675590515, -116.61662924289703, -105.45799511671066, -96.76713865995407, -109.22946047782898, -97.18450856208801, -110.51210067669551, -98.32532666126887, -100.27935467163722, -100.74997911850612, -101.75336981813113, -112.98208783070247, -108.7409666577975, -97.10491929451625, -96.59025926391284, -103.73654858271281, -92.82651499907176, -91.2588267872731, -107.18461974461874, -95.94781949122748, -95.05284621318182, -98.97962410685918, -113.88138886292776, -100.36978047092757, -97.00193971892199, -100.46953209241232, -101.86637647946677, -116.24594195683798, -100.89003815253577, -101.23676805694899, -100.09408523639044, -100.61829735835394, -110.48690473039946, -116.40431867043178, -106.2524674932162, -103.1273064116637, -113.29087764024734, -101.82297587394714, -99.34989855159074, -98.19987846414249, -109.9102011124293, -97.54112360874812, -97.51848152279854, -109.6349168419838, -97.61513909697533, -111.52371029059093, -97.6804422835509, -99.33083812395732, -104.36479553580284, -104.80975687503815, -93.96774157881737, -103.58437805374464, -115.31896783908209, -104.50440122683844, -109.9519227941831, -99.55850904186568, -101.47112449010214, -96.05329291025798, -96.71881274382274, -108.04555610815684, -94.47479055201015, -107.74054123957953, -94.74208033581576, -99.90671638647716, -100.30850891272227, -114.18731037775676, -100.4834655324618, -113.92854068676631, -99.83665179709594, -95.15077909206352, -108.26508607467017, -95.52563920368752, -103.73482004801433, -92.4829436937968, -92.76232303182285, -94.75140826900801, -107.11181165774664, -94.77071421345076, 1.6640553995966911, 0.43674394488334656, 1.7766255512833595, -109.38421181837718, -95.11486641565959, -95.80818004409473, -108.53124616543452, -96.24011447528999, -95.94054231295983, -116.5831566254298, -103.43640718857448, -103.10324374834697, -117.11030101776123, -105.49190557003021, -105.36300203204155, -107.1954125960668, -106.49966367085776, -118.4149435957273, -11.656545847654343, -10.158580541610718, -10.258994549512863, -110.73132352034251, -100.30583293239276, -99.02068310479324, -110.98743768533072, -98.48091723521551, -95.76886652510925, -103.92983590563139, -104.33643688758215, -115.03616442282996, -99.00550646086535, -111.50560220082602, -100.27654697497687, -97.84415155649185, -99.35450375080109, -112.43686437606812, -102.59783333539963, -102.62680208683014, -116.79832136631012, -96.6264967918396, -93.92647621408105, -107.83238101005554, -92.93026774624984, -92.97126613060634, -104.97153363625209, -93.75235205888748, -106.52432119846344, -94.296377658844, -105.45014838377635, -115.53583721319835, -107.17142234245937, -96.1257304151853, -106.53980269034705, -95.5195189913114, -99.73707805077235, -110.93976239363353, -97.43435992548864, -110.98212720950445, -98.77804191907248, -99.13882779081663, -114.31479261318843, -112.97785581151645, -113.18343990544479, -98.47838119665782, -97.19939814011256, -108.8800458709399, -115.06122692426047, -99.87163043518862, -101.50098889072737, -99.31830481191477, -112.30516888697943, -99.35210690399012, -102.53627264499664, -114.12294501066208, -102.2368965446949, -96.4005982230107, -110.66028759876887, -96.62846603492896, -91.46448421478271, -90.71919444203377, -103.78469693660736, -96.90860023101172, -108.26075752576193, -96.07569092263779, -102.63926647106807, -103.02202604214351, -117.94647149244945, -110.34444542725882, -97.40874098738036, -96.7352403899034, -118.05441190799078, -120.33269663651785, -107.45989864071211, -93.21058515707652, -103.85829452673595, -91.79647833357255, -112.75772454341254, -97.90447750252983, -99.90675347050032, -110.02316157023112, -95.34604380528133, -95.73894331852595, -103.70582527915637, -114.57939289013545, -101.80654528985421, -102.8537396589915, -115.70097933212917, -102.04108631859224, -115.86524824301402, -103.73635078469913, -106.0585085550944, -114.19803138573965, -102.07640137275061, -101.82432677348456, -119.62454680601756, -108.1666270295779, -108.50626100103061, -22.610673218965538, -22.75024181604386, -22.641518920660026, -115.59737519423167, -102.26930619279544, -102.44566083947818, -93.90663075695436, -109.93456176916759, -93.88382491158943, -108.92230461041133, -97.05629619459312, -98.57047180334727, -89.97959140439829, -100.14554273088774, -90.88703375061354, -112.6028098066648, -101.29596783717474, -100.62402441104254, -115.85572504997253, -104.66684857010841, -107.09700012207031, -109.14783791701, -96.10801682869594, -94.45470945040385, -95.5796077400446, -108.77500134706497, -98.81283897161484, -109.71933827797572, -120.186616341273, -106.29749358693759, -116.49526129166286, -103.67277095715205, -104.00364438692729, -117.67764849464099, -107.28806687394778, -108.62268356482188, -96.48526687423389, -109.63335249821345, -96.05587622399132, -100.88370217631261, -116.23408476511638, -102.96330700318019, -114.42014394203822, -102.17680347959201, -99.77130324921261, -107.24520499507587, -120.69159368673961, -109.24972156683604, -104.45484990874927, -116.1597619454066, -104.22149668137233, -105.14647761980693, -93.33216081062953, -91.67596186200778, -118.55760101477306, -106.77231643597285, -106.29221920172374, -98.4441465139389, -97.55122847855091, -102.20065951347351, -102.2405306895574, -114.69867750008902, -104.38714637358984, -99.4248528778553, -111.61536246538162, -98.37980903685093, -112.1267758657535, -123.49439989527067, -114.66907914479575, -88.86001540720463, -101.6316614151001, -88.25486095063388, -0.24402593076229095, 0.2532675415277481, 0.2532432898879051, -97.55528046687445, -108.55718984206518, -95.29600485165915, -94.82014095783234, -103.73099809885025, -90.92172107100487, -97.27189932266872, -95.2967129300038, -106.21362615625064, -124.30375226338705, -111.69706710179648, -111.92208149035773, -88.21184018750986, -100.05336793263754, -89.67861877878508, -92.49596543113391, -105.91141096750896, -92.51365355650584, -104.53488765160243, -102.05829767386119, -114.93778614203136, -5.8864865178863255, -5.933892587820694, -6.6103998670975415, -104.44998959700267, -115.67038307587306, -101.69252046073477, -98.95193973183632, -99.5329018831253, -112.63316893577576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1751832751304451, "mean_inference_ms": 0.6844967852900079, "mean_action_processing_ms": 0.09792118448224514, "mean_env_wait_ms": 0.8016351058814467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 9642.596, "sample_throughput": 497.791, "load_time_ms": 0.1, "load_throughput": 47957739.876, "learn_time_ms": 1221.452, "learn_throughput": 3929.75, "update_time_ms": 1.399}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 2715.148223876953, "policy_loss": -0.0025526457052426066, "vf_loss": 2715.2100219726562, "vf_explained_var": 0.009788952767848969, "kl": 0.0046460096382381485, "entropy": 5.929652392864227, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 144000, "num_steps_trained": 48000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 616, "training_iteration": 10, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-44-13", "timestamp": 1706147053, "time_this_iter_s": 10.11652159690857, "time_total_s": 97.34855890274048, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000537DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 97.34855890274048, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 5.379999999999999, "ram_util_percent": 44.4}}
{"episode_reward_max": 0.2624849006533623, "episode_reward_min": -591.4954724609852, "episode_reward_mean": -285.7142353988823, "episode_len_mean": 98.9, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {"shared_policy": -204.51128149032593}, "policy_reward_max": {"shared_policy": 0.2532675415277481}, "policy_reward_mean": {"shared_policy": -95.2380784662941}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-308.1112003698945, -308.89899691939354, -340.47608833014965, -304.55782520771027, -316.4338462501765, -310.9755806028843, -318.8961142003536, -303.6893518567085, -285.96837559342384, -301.2450486794114, -323.607764005661, -304.48842680454254, -345.8470071852207, -288.865358017385, -310.56895551644266, -301.1081486940384, -320.091763459146, -320.5958053097129, -325.66010758280754, -318.0987595319748, -336.29743483662605, -68.00243395566942, -320.3123422265053, -297.72501743771136, -304.5490726083517, -281.01216788589954, -314.5228020548821, -327.61957374215126, -299.7105641961098, -303.1674480587244, -336.2034482061863, -324.1716766357422, -333.58839893341064, -302.17449559643865, -320.08109394460917, -316.3682506708428, -337.1865202486515, -324.8361085355282, -290.15460029244423, -331.62213665246964, -298.1960345059633, -321.32635456323624, -309.42002438008785, -350.29025490581995, -278.7465377729386, 0.2624849006533623, -301.40847516059875, -289.47286012768745, -298.78223840892315, -347.92290085554123, -277.94382689893246, -290.9210299551487, -321.53097146749496, -18.43077897280456, -321.8128931336105, -311.1180105507374, -15.278220169246211, -315.5251037552953, -33.07933176308873, -23.250700138509274, -319.78901812434196, -302.21802854537964, -14.330000236630454, -334.013905107975, -313.90454329364, -591.4954724609852, -299.46138662099844, -313.93203897878993, -307.35764276981354, -316.4828234314919, -317.2612601518631, -307.3204208910466, -292.66094526648527, -312.37753431499004, -246.14204394817352, -321.86949878931046, -310.62674729526043, -313.54849833250046, -309.1121139600873, -322.8542296886444, -300.318153552711, -305.15307170152664, -318.87501285225153, -298.961761623621, -322.2171223312617, -321.848484814167, -300.4710727632046, -51.80677862465383, -291.61869186162954, -289.0630256980658, -305.224310323596, -307.0722509622574, -330.82822473347187, -314.56100974977016, -316.63285860419273, -323.89624002575874, -305.0136150419712, -51.798847794532776, -19.08515631407502, -278.5355248861015], "episode_lengths": [64, 56, 226, 77, 56, 64, 62, 57, 59, 118, 66, 130, 60, 107, 62, 85, 52, 63, 95, 64, 96, 300, 59, 57, 70, 97, 67, 44, 70, 67, 56, 38, 70, 61, 45, 80, 78, 65, 77, 46, 61, 73, 46, 212, 86, 300, 74, 64, 72, 135, 129, 71, 46, 300, 61, 74, 300, 71, 300, 300, 48, 78, 300, 63, 59, 76, 71, 69, 59, 67, 65, 44, 71, 72, 203, 53, 56, 62, 74, 63, 135, 81, 69, 85, 65, 57, 60, 300, 83, 69, 118, 64, 55, 87, 76, 83, 74, 300, 300, 135], "policy_shared_policy_reward": [-99.73707805077235, -110.93976239363353, -97.43435992548864, -110.98212720950445, -98.77804191907248, -99.13882779081663, -114.31479261318843, -112.97785581151645, -113.18343990544479, -98.47838119665782, -97.19939814011256, -108.8800458709399, -115.06122692426047, -99.87163043518862, -101.50098889072737, -99.31830481191477, -112.30516888697943, -99.35210690399012, -102.53627264499664, -114.12294501066208, -102.2368965446949, -96.4005982230107, -110.66028759876887, -96.62846603492896, -91.46448421478271, -90.71919444203377, -103.78469693660736, -96.90860023101172, -108.26075752576193, -96.07569092263779, -102.63926647106807, -103.02202604214351, -117.94647149244945, -110.34444542725882, -97.40874098738036, -96.7352403899034, -118.05441190799078, -120.33269663651785, -107.45989864071211, -93.21058515707652, -103.85829452673595, -91.79647833357255, -112.75772454341254, -97.90447750252983, -99.90675347050032, -110.02316157023112, -95.34604380528133, -95.73894331852595, -103.70582527915637, -114.57939289013545, -101.80654528985421, -102.8537396589915, -115.70097933212917, -102.04108631859224, -115.86524824301402, -103.73635078469913, -106.0585085550944, -114.19803138573965, -102.07640137275061, -101.82432677348456, -119.62454680601756, -108.1666270295779, -108.50626100103061, -22.610673218965538, -22.75024181604386, -22.641518920660026, -115.59737519423167, -102.26930619279544, -102.44566083947818, -93.90663075695436, -109.93456176916759, -93.88382491158943, -108.92230461041133, -97.05629619459312, -98.57047180334727, -89.97959140439829, -100.14554273088774, -90.88703375061354, -112.6028098066648, -101.29596783717474, -100.62402441104254, -115.85572504997253, -104.66684857010841, -107.09700012207031, -109.14783791701, -96.10801682869594, -94.45470945040385, -95.5796077400446, -108.77500134706497, -98.81283897161484, -109.71933827797572, -120.186616341273, -106.29749358693759, -116.49526129166286, -103.67277095715205, -104.00364438692729, -117.67764849464099, -107.28806687394778, -108.62268356482188, -96.48526687423389, -109.63335249821345, -96.05587622399132, -100.88370217631261, -116.23408476511638, -102.96330700318019, -114.42014394203822, -102.17680347959201, -99.77130324921261, -107.24520499507587, -120.69159368673961, -109.24972156683604, -104.45484990874927, -116.1597619454066, -104.22149668137233, -105.14647761980693, -93.33216081062953, -91.67596186200778, -118.55760101477306, -106.77231643597285, -106.29221920172374, -98.4441465139389, -97.55122847855091, -102.20065951347351, -102.2405306895574, -114.69867750008902, -104.38714637358984, -99.4248528778553, -111.61536246538162, -98.37980903685093, -112.1267758657535, -123.49439989527067, -114.66907914479575, -88.86001540720463, -101.6316614151001, -88.25486095063388, -0.24402593076229095, 0.2532675415277481, 0.2532432898879051, -97.55528046687445, -108.55718984206518, -95.29600485165915, -94.82014095783234, -103.73099809885025, -90.92172107100487, -97.27189932266872, -95.2967129300038, -106.21362615625064, -124.30375226338705, -111.69706710179648, -111.92208149035773, -88.21184018750986, -100.05336793263754, -89.67861877878508, -92.49596543113391, -105.91141096750896, -92.51365355650584, -104.53488765160243, -102.05829767386119, -114.93778614203136, -5.8864865178863255, -5.933892587820694, -6.6103998670975415, -104.44998959700267, -115.67038307587306, -101.69252046073477, -98.95193973183632, -99.5329018831253, -112.63316893577576, -4.90502541015546, -5.087507079044983, -5.285687680045768, -112.97725133101146, -100.15064786622922, -102.39720455805461, -10.386901107927173, -10.507344623406738, -12.185086031754821, -7.098209664225578, -7.19707927852869, -8.955411195755005, -103.17445236444473, -115.3425829410553, -101.27198281884193, -96.85296980539958, -108.88787863651912, -96.47718010346095, -4.425989250342056, -4.1152244160572735, -5.7887865702311245, -106.10062803824744, -104.96107991536459, -122.952197154363, -114.51880935827892, -99.74539099509518, -99.64034294026594, -204.51128149032593, -192.3612720668316, -194.62291890382767, -107.59324057896933, -96.13971068461737, -95.72843535741171, -113.81802177429199, -101.0633354485035, -99.05068175599445, -97.55046696960926, -97.8179736584425, -111.98920214176178, -100.04423834880194, -113.12253602345785, -103.31604905923209, -101.86817650993666, -114.33580269416174, -101.05728094776472, -99.29519106944403, -110.24253507455191, -97.78269474705061, -105.95935316880545, -94.14362939198813, -92.55796270569166, -112.3891413807869, -100.43971946835518, -99.54867346584797, -79.31631893912952, -89.6994097630183, -77.12631524602573, -102.30570415655772, -102.58978019158046, -116.97401444117229, -100.58286062876384, -98.50429161886375, -111.53959504763286, -107.79531534512839, -95.54331864913306, -110.20986433823904, -110.3977784216404, -98.97038684040308, -99.74394869804382, -110.18251107136409, -98.5182921687762, -114.15342644850413, -107.92553889751434, -96.74376937747002, -95.64884527772665, -97.77547979354858, -109.55968075990677, -97.81791114807129, -115.14650011062622, -102.54776248335838, -101.18075025826693, -101.79739113648733, -96.92150186498961, -100.24286862214407, -115.30381121238074, -101.20922700067362, -105.7040841182073, -102.86050809423129, -102.01065255204837, -116.97732416788737, -98.33944920698802, -106.68585215012233, -95.44577140609424, -16.40148749450843, -17.283289263645813, -18.122001866499588, -94.82574458916983, -104.46650769313177, -92.32643957932791, -99.79737373193106, -95.69255204995474, -93.57309991617998, -98.26342451572418, -97.15085040032864, -109.81003540754318, -99.08331686258316, -97.77130210399628, -110.21763199567795, -108.95472236474356, -117.8099516828855, -104.06355068584284, -99.07358295222124, -99.75709184010825, -115.7303349574407, -100.92839085062346, -101.35994531710944, -114.34452243645987, -104.81682962179184, -103.4407248198986, -115.6386855840683, -111.24258140722911, -97.51507545510928, -96.25595817963283, -17.0361111164093, -18.127079963684082, -16.635656714439392, -5.793790144224971, -6.593524326880782, -6.697841842969268, -100.85385203361511, -87.57234452292323, -90.10932832956314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17430701283763952, "mean_inference_ms": 0.6842949398405738, "mean_action_processing_ms": 0.09780549485575701, "mean_env_wait_ms": 0.8032961455086216, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 52800, "timesteps_this_iter": 0, "agent_timesteps_total": 158400, "timers": {"sample_time_ms": 9703.65, "sample_throughput": 494.659, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1225.404, "learn_throughput": 3917.075, "update_time_ms": 1.465}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 2197.2317810058594, "policy_loss": -0.0022890781590994003, "vf_loss": 2197.29345703125, "vf_explained_var": 0.012379691004753113, "kl": 0.005175893173147599, "entropy": 5.939860165119171, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52800, "num_agent_steps_sampled": 158400, "num_steps_trained": 52800, "num_agent_steps_trained": 158400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 660, "training_iteration": 11, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-44-23", "timestamp": 1706147063, "time_this_iter_s": 9.243633270263672, "time_total_s": 106.59219217300415, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015CD040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 106.59219217300415, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 3.038461538461538, "ram_util_percent": 44.24615384615385}}
{"episode_reward_max": -14.330000236630454, "episode_reward_min": -591.4954724609852, "episode_reward_mean": -291.58733686488006, "episode_len_mean": 97.1, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {"shared_policy": -204.51128149032593}, "policy_reward_max": {"shared_policy": -4.1152244160572735}, "policy_reward_mean": {"shared_policy": -97.19577895496002}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.278220169246211, -315.5251037552953, -33.07933176308873, -23.250700138509274, -319.78901812434196, -302.21802854537964, -14.330000236630454, -334.013905107975, -313.90454329364, -591.4954724609852, -299.46138662099844, -313.93203897878993, -307.35764276981354, -316.4828234314919, -317.2612601518631, -307.3204208910466, -292.66094526648527, -312.37753431499004, -246.14204394817352, -321.86949878931046, -310.62674729526043, -313.54849833250046, -309.1121139600873, -322.8542296886444, -300.318153552711, -305.15307170152664, -318.87501285225153, -298.961761623621, -322.2171223312617, -321.848484814167, -300.4710727632046, -51.80677862465383, -291.61869186162954, -289.0630256980658, -305.224310323596, -307.0722509622574, -330.82822473347187, -314.56100974977016, -316.63285860419273, -323.89624002575874, -305.0136150419712, -51.798847794532776, -19.08515631407502, -278.5355248861015, -339.7346468567848, -324.05675610899925, -310.58827240765095, -293.74981278181076, -291.7396537065506, -314.80748241208494, -314.31305876374245, -321.5604590252042, -305.17552193999296, -317.488822221756, -293.51050676451996, -308.2066677436233, -286.1888129711151, -316.2902960255742, -366.1932959854603, -332.88332497328526, -294.31656166911125, -286.9922285079956, -316.7420675754547, -317.70706973969936, -304.0920084407553, -308.86117220669985, -342.8453899025917, -322.35151921212673, -333.69647508859634, -319.35815638303757, -305.4180460050702, -306.1710535511375, -340.4565859781579, -59.03415902704002, -304.0266270637513, -317.6625891625881, -321.4436630466953, -80.98615515232095, -334.2232121527195, -329.7439002469182, -303.3049908876419, -324.20620030164724, -290.3201680080965, -313.19716915488243, -338.91760884225374, -309.3408741056919, -329.47061851620674, -307.2665901631117, -304.8329458236695, -314.2743761911988, -327.28320306539536, -312.39439796679653, -307.36858093738556, -317.40399169921875, -379.0491583943367, -291.52794309705496, -322.5256242156029, -336.30158856511116, -315.44623421132565, -324.81266924738884], "episode_lengths": [300, 71, 300, 300, 48, 78, 300, 63, 59, 76, 71, 69, 59, 67, 65, 44, 71, 72, 203, 53, 56, 62, 74, 63, 135, 81, 69, 85, 65, 57, 60, 300, 83, 69, 118, 64, 55, 87, 76, 83, 74, 300, 300, 135, 57, 76, 65, 86, 143, 65, 74, 72, 66, 76, 64, 87, 83, 50, 130, 65, 60, 69, 71, 69, 71, 58, 55, 57, 164, 63, 84, 59, 52, 300, 72, 63, 48, 300, 101, 61, 76, 83, 101, 78, 114, 60, 94, 59, 96, 61, 61, 82, 70, 69, 166, 110, 73, 90, 59, 52], "policy_shared_policy_reward": [-4.90502541015546, -5.087507079044983, -5.285687680045768, -112.97725133101146, -100.15064786622922, -102.39720455805461, -10.386901107927173, -10.507344623406738, -12.185086031754821, -7.098209664225578, -7.19707927852869, -8.955411195755005, -103.17445236444473, -115.3425829410553, -101.27198281884193, -96.85296980539958, -108.88787863651912, -96.47718010346095, -4.425989250342056, -4.1152244160572735, -5.7887865702311245, -106.10062803824744, -104.96107991536459, -122.952197154363, -114.51880935827892, -99.74539099509518, -99.64034294026594, -204.51128149032593, -192.3612720668316, -194.62291890382767, -107.59324057896933, -96.13971068461737, -95.72843535741171, -113.81802177429199, -101.0633354485035, -99.05068175599445, -97.55046696960926, -97.8179736584425, -111.98920214176178, -100.04423834880194, -113.12253602345785, -103.31604905923209, -101.86817650993666, -114.33580269416174, -101.05728094776472, -99.29519106944403, -110.24253507455191, -97.78269474705061, -105.95935316880545, -94.14362939198813, -92.55796270569166, -112.3891413807869, -100.43971946835518, -99.54867346584797, -79.31631893912952, -89.6994097630183, -77.12631524602573, -102.30570415655772, -102.58978019158046, -116.97401444117229, -100.58286062876384, -98.50429161886375, -111.53959504763286, -107.79531534512839, -95.54331864913306, -110.20986433823904, -110.3977784216404, -98.97038684040308, -99.74394869804382, -110.18251107136409, -98.5182921687762, -114.15342644850413, -107.92553889751434, -96.74376937747002, -95.64884527772665, -97.77547979354858, -109.55968075990677, -97.81791114807129, -115.14650011062622, -102.54776248335838, -101.18075025826693, -101.79739113648733, -96.92150186498961, -100.24286862214407, -115.30381121238074, -101.20922700067362, -105.7040841182073, -102.86050809423129, -102.01065255204837, -116.97732416788737, -98.33944920698802, -106.68585215012233, -95.44577140609424, -16.40148749450843, -17.283289263645813, -18.122001866499588, -94.82574458916983, -104.46650769313177, -92.32643957932791, -99.79737373193106, -95.69255204995474, -93.57309991617998, -98.26342451572418, -97.15085040032864, -109.81003540754318, -99.08331686258316, -97.77130210399628, -110.21763199567795, -108.95472236474356, -117.8099516828855, -104.06355068584284, -99.07358295222124, -99.75709184010825, -115.7303349574407, -100.92839085062346, -101.35994531710944, -114.34452243645987, -104.81682962179184, -103.4407248198986, -115.6386855840683, -111.24258140722911, -97.51507545510928, -96.25595817963283, -17.0361111164093, -18.127079963684082, -16.635656714439392, -5.793790144224971, -6.593524326880782, -6.697841842969268, -100.85385203361511, -87.57234452292323, -90.10932832956314, -108.81402349472046, -105.98518854379654, -124.93543481826782, -113.92101528247198, -103.86516230305037, -106.27057852347693, -99.1191166539987, -98.6238867690166, -112.84526898463568, -99.12692674001059, -96.367271622022, -98.2556144197782, -105.67723951737086, -92.96166046957175, -93.100753719608, -99.37845418353876, -98.93126093906662, -116.49776728947958, -115.94054214159648, -99.27932470540206, -99.09319191674392, -104.84511981407802, -101.33374630163114, -115.38159290949504, -110.80831213792166, -97.6902699371179, -96.67693986495337, -103.88160413503647, -99.88318210840225, -113.72403597831726, -94.10390821099281, -106.83606904745102, -92.57052950607613, -96.74855611970028, -111.05688269933066, -100.40122892459235, -91.87832620243232, -91.23428564767043, -103.07620112101237, -101.89613420764606, -114.55350999037425, -99.84065182755391, -115.76352801422279, -115.91431614259879, -134.51545182863873, -107.3070856233438, -120.39054699738821, -105.18569235255322, -94.35888096690178, -106.22643530368805, -93.73124539852142, -94.71445894241333, -102.50807499885559, -89.76969456672668, -99.87278379996619, -102.5687966545423, -114.30048712094626, -115.87638715902965, -100.0402897844712, -101.79039279619853, -96.19617720351866, -97.37178425987562, -110.52404697736105, -106.1904182434082, -99.04781056195498, -103.62294340133667, -109.73424675067267, -107.75297792752585, -125.35816522439322, -102.35071134070556, -103.71347058812778, -116.28733728329341, -105.82087657848994, -107.94400803248088, -119.93159047762553, -102.33764044443767, -114.40653971831004, -102.61397622028987, -96.62929980705182, -109.89039609829585, -98.89835009972255, -96.29106347014508, -109.8546282251676, -100.0253618558248, -109.60281588633856, -108.32096510597816, -122.53280498584112, -18.525118055442974, -18.932209471861526, -21.57683149973552, -96.60282953580221, -108.82469936211905, -98.59909816582999, -100.67845570047697, -100.93068244059882, -116.05345102151236, -102.29517697294554, -101.00959477418414, -118.13889129956564, -28.322471241156265, -25.417175749937698, -27.246508161226913, -107.19824954867363, -119.82151299715042, -107.20344960689545, -118.92927231391272, -104.76382931818566, -106.05079861481985, -109.054183781147, -96.6249857544899, -97.625821352005, -119.36605366071066, -103.61867996056876, -101.2214666803678, -105.17484881480536, -93.28002565105757, -91.86529354223362, -99.71631541848183, -112.26895570755005, -101.21189802885056, -108.52214201788108, -108.6795418659846, -121.71592495838802, -110.89523573716482, -99.54902177055678, -98.89661659797034, -105.96912016471228, -104.99286805589995, -118.50863029559454, -97.07914372781913, -97.93634144465129, -112.25110499064128, -97.46657924850783, -109.00863828261694, -98.35772829254469, -115.02672199408214, -100.71808491150539, -98.52956928561132, -116.59482769171397, -105.15737495819728, -105.53100041548412, -100.29461897412936, -113.56297365824382, -98.53680533442336, -97.37713990608852, -110.53738979498546, -99.4540512363116, -101.47667334477107, -113.9409126440684, -101.98640571037929, -119.34610038995743, -138.1152456998825, -121.58781230449677, -101.24437375863394, -94.82376399387917, -95.45980534454188, -102.87643970052402, -116.02458314100902, -103.62460137406985, -107.18727265795073, -120.26221056779227, -108.8521053393682, -98.89846722781658, -114.87803149223328, -101.66973549127579, -102.89182924230894, -102.29111351569495, -119.62972648938498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17360188664689055, "mean_inference_ms": 0.6824288061709431, "mean_action_processing_ms": 0.09792479957741143, "mean_env_wait_ms": 0.8029354627340705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"sample_time_ms": 9774.37, "sample_throughput": 491.08, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1266.113, "learn_throughput": 3791.131, "update_time_ms": 1.365}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 2953.7969970703125, "policy_loss": -0.003433384817132179, "vf_loss": 2953.8612365722656, "vf_explained_var": 0.00016500800848007202, "kl": 0.004190458845189453, "entropy": 6.083246350288391, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 172800, "num_steps_trained": 57600, "num_agent_steps_trained": 172800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 716, "training_iteration": 12, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-44-33", "timestamp": 1706147073, "time_this_iter_s": 10.254639148712158, "time_total_s": 116.84683132171631, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004D1C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 116.84683132171631, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 44.42142857142857}}
{"episode_reward_max": -26.645821608603, "episode_reward_min": -389.74189300090075, "episode_reward_mean": -294.627542618101, "episode_len_mean": 92.76, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {"shared_policy": -141.24562482039136}, "policy_reward_max": {"shared_policy": -8.16453678409259}, "policy_reward_mean": {"shared_policy": -98.20918087270033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-291.7396537065506, -314.80748241208494, -314.31305876374245, -321.5604590252042, -305.17552193999296, -317.488822221756, -293.51050676451996, -308.2066677436233, -286.1888129711151, -316.2902960255742, -366.1932959854603, -332.88332497328526, -294.31656166911125, -286.9922285079956, -316.7420675754547, -317.70706973969936, -304.0920084407553, -308.86117220669985, -342.8453899025917, -322.35151921212673, -333.69647508859634, -319.35815638303757, -305.4180460050702, -306.1710535511375, -340.4565859781579, -59.03415902704002, -304.0266270637513, -317.6625891625881, -321.4436630466953, -80.98615515232095, -334.2232121527195, -329.7439002469182, -303.3049908876419, -324.20620030164724, -290.3201680080965, -313.19716915488243, -338.91760884225374, -309.3408741056919, -329.47061851620674, -307.2665901631117, -304.8329458236695, -314.2743761911988, -327.28320306539536, -312.39439796679653, -307.36858093738556, -317.40399169921875, -379.0491583943367, -291.52794309705496, -322.5256242156029, -336.30158856511116, -315.44623421132565, -324.81266924738884, -30.630304142832784, -298.6951670497656, -42.93753074854614, -318.1734313964844, -299.1066475510597, -27.515649586915984, -318.4770184904337, -334.92049799859524, -336.3046272844077, -315.7570595443249, -305.2554562911391, -26.645821608603, -318.64369791559875, -312.25929189473396, -319.9143367558718, -314.44341185316443, -316.8274224102497, -312.9632907435298, -313.23684369027615, -309.45258420705795, -330.3144277334214, -321.822133526206, -304.64079320430756, -335.6838363111019, -277.08710241224617, -310.5985228717327, -318.43880358338356, -323.451167345047, -306.9187307432294, -320.6921159029007, -301.78389889001846, -334.9462035894394, -317.9539070688188, -315.9661687090993, -325.42295199632645, -311.86856204271317, -389.74189300090075, -63.28592046350242, -290.9820581525564, -304.05924851447344, -298.22503978386527, -288.5480655133724, -311.55359494686127, -322.86671423912054, -293.6443861424923, -53.84010567516091, -323.5487196762115, -308.97762256860733], "episode_lengths": [143, 65, 74, 72, 66, 76, 64, 87, 83, 50, 130, 65, 60, 69, 71, 69, 71, 58, 55, 57, 164, 63, 84, 59, 52, 300, 72, 63, 48, 300, 101, 61, 76, 83, 101, 78, 114, 60, 94, 59, 96, 61, 61, 82, 70, 69, 166, 110, 73, 90, 59, 52, 300, 78, 300, 70, 66, 300, 52, 55, 58, 76, 45, 300, 62, 49, 35, 57, 69, 57, 73, 66, 51, 76, 51, 61, 103, 67, 62, 53, 63, 65, 93, 77, 71, 83, 44, 70, 265, 300, 82, 81, 67, 76, 53, 79, 73, 300, 68, 68], "policy_shared_policy_reward": [-105.67723951737086, -92.96166046957175, -93.100753719608, -99.37845418353876, -98.93126093906662, -116.49776728947958, -115.94054214159648, -99.27932470540206, -99.09319191674392, -104.84511981407802, -101.33374630163114, -115.38159290949504, -110.80831213792166, -97.6902699371179, -96.67693986495337, -103.88160413503647, -99.88318210840225, -113.72403597831726, -94.10390821099281, -106.83606904745102, -92.57052950607613, -96.74855611970028, -111.05688269933066, -100.40122892459235, -91.87832620243232, -91.23428564767043, -103.07620112101237, -101.89613420764606, -114.55350999037425, -99.84065182755391, -115.76352801422279, -115.91431614259879, -134.51545182863873, -107.3070856233438, -120.39054699738821, -105.18569235255322, -94.35888096690178, -106.22643530368805, -93.73124539852142, -94.71445894241333, -102.50807499885559, -89.76969456672668, -99.87278379996619, -102.5687966545423, -114.30048712094626, -115.87638715902965, -100.0402897844712, -101.79039279619853, -96.19617720351866, -97.37178425987562, -110.52404697736105, -106.1904182434082, -99.04781056195498, -103.62294340133667, -109.73424675067267, -107.75297792752585, -125.35816522439322, -102.35071134070556, -103.71347058812778, -116.28733728329341, -105.82087657848994, -107.94400803248088, -119.93159047762553, -102.33764044443767, -114.40653971831004, -102.61397622028987, -96.62929980705182, -109.89039609829585, -98.89835009972255, -96.29106347014508, -109.8546282251676, -100.0253618558248, -109.60281588633856, -108.32096510597816, -122.53280498584112, -18.525118055442974, -18.932209471861526, -21.57683149973552, -96.60282953580221, -108.82469936211905, -98.59909816582999, -100.67845570047697, -100.93068244059882, -116.05345102151236, -102.29517697294554, -101.00959477418414, -118.13889129956564, -28.322471241156265, -25.417175749937698, -27.246508161226913, -107.19824954867363, -119.82151299715042, -107.20344960689545, -118.92927231391272, -104.76382931818566, -106.05079861481985, -109.054183781147, -96.6249857544899, -97.625821352005, -119.36605366071066, -103.61867996056876, -101.2214666803678, -105.17484881480536, -93.28002565105757, -91.86529354223362, -99.71631541848183, -112.26895570755005, -101.21189802885056, -108.52214201788108, -108.6795418659846, -121.71592495838802, -110.89523573716482, -99.54902177055678, -98.89661659797034, -105.96912016471228, -104.99286805589995, -118.50863029559454, -97.07914372781913, -97.93634144465129, -112.25110499064128, -97.46657924850783, -109.00863828261694, -98.35772829254469, -115.02672199408214, -100.71808491150539, -98.52956928561132, -116.59482769171397, -105.15737495819728, -105.53100041548412, -100.29461897412936, -113.56297365824382, -98.53680533442336, -97.37713990608852, -110.53738979498546, -99.4540512363116, -101.47667334477107, -113.9409126440684, -101.98640571037929, -119.34610038995743, -138.1152456998825, -121.58781230449677, -101.24437375863394, -94.82376399387917, -95.45980534454188, -102.87643970052402, -116.02458314100902, -103.62460137406985, -107.18727265795073, -120.26221056779227, -108.8521053393682, -98.89846722781658, -114.87803149223328, -101.66973549127579, -102.89182924230894, -102.29111351569495, -119.62972648938498, -8.63746536274752, -10.394006272157043, -11.598832507928222, -107.1172945102056, -98.45037504037222, -93.1274974991878, -13.073554071287319, -15.109607497851059, -14.75436917940776, -113.5671971042951, -102.94830032189688, -101.65793397029242, -106.33213873704275, -94.87262304623923, -97.90188576777777, -8.16453678409259, -9.819723943869278, -9.531388858954116, -101.50790287057559, -116.25234929720561, -100.7167663226525, -107.40523996949196, -106.16913612186909, -121.34612190723419, -121.0732384522756, -109.19619907935461, -106.03518975277743, -101.80422701438269, -112.90979035695395, -101.04304217298827, -106.08975084622702, -99.36463011552891, -99.80107532938322, -8.714881084859371, -8.948641523718834, -8.982299000024796, -114.62557194630305, -100.30104384633403, -103.71708212296168, -100.31154548128447, -98.65425461282334, -113.29349180062613, -102.30478262901306, -116.68674862384796, -100.92280550301075, -112.81084889173508, -101.60738030076027, -100.02518266066909, -100.40303668379784, -101.39608091115952, -115.02830481529236, -98.73314984391133, -115.35757664839427, -98.8725642512242, -112.7405879298846, -100.74503992001216, -99.7512158403794, -100.10172460476558, -97.3869210879008, -111.96393851439159, -105.56701972087225, -106.17996974786124, -118.56743826468787, -111.19230178991954, -97.62274553875129, -113.0070861975352, -96.8507826824983, -97.09945951898894, -110.69055100282034, -106.88160219788551, -106.51332312822342, -122.28891098499298, -88.18855903297663, -101.18996518850327, -87.70857819076627, -99.98450264334679, -110.69215327501297, -99.92186695337296, -115.81335957845053, -102.03168358405432, -100.59376042087874, -104.5420507589976, -115.69341311852138, -103.21570346752803, -101.61675715446472, -109.82506448030472, -95.47690910845995, -103.33097175757091, -114.89471451441447, -102.46642963091533, -96.32672264178595, -109.59128840764365, -95.8658878405889, -106.3377826611201, -108.08418385187785, -120.52423707644145, -102.2094096938769, -99.66890779758494, -116.07558957735698, -113.05667406320572, -100.94914207607508, -101.9603525698185, -104.86071958144507, -104.657530327638, -115.90470208724341, -98.75744966665904, -98.355710486571, -114.75540188948314, -123.29338802645604, -125.20288015405337, -141.24562482039136, -19.136771681408092, -21.00180820624034, -23.14734057585399, -92.9000110278527, -93.47777725259463, -104.6042698721091, -96.1454732293884, -109.1292061607043, -98.78456912438075, -98.07105978329977, -102.13707198699316, -98.0169080135723, -91.09342160820961, -104.43037259578705, -93.02427130937576, -99.70592871059975, -99.72454882909855, -112.123117407163, -114.2254955371221, -103.70537348588309, -104.93584521611533, -105.34828992684683, -93.3006124397119, -94.9954837759336, -17.2494989608725, -17.087077980240196, -19.503528734048217, -105.4509982864062, -115.96335415045421, -102.13436723935108, -98.3082576195399, -112.7419038216273, -97.92746112744014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17334433346980346, "mean_inference_ms": 0.6818501975909865, "mean_action_processing_ms": 0.09842560249051129, "mean_env_wait_ms": 0.8012280398827546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 62400, "timesteps_this_iter": 0, "agent_timesteps_total": 187200, "timers": {"sample_time_ms": 9828.735, "sample_throughput": 488.364, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1266.521, "learn_throughput": 3789.91, "update_time_ms": 1.466}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 2062.6405487060547, "policy_loss": -0.0026059752073424036, "vf_loss": 2062.7030181884766, "vf_explained_var": 0.010165736079216003, "kl": 0.005403030027084871, "entropy": 6.001093685626984, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 62400, "num_agent_steps_sampled": 187200, "num_steps_trained": 62400, "num_agent_steps_trained": 187200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 764, "training_iteration": 13, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-44-42", "timestamp": 1706147082, "time_this_iter_s": 9.193882465362549, "time_total_s": 126.04071378707886, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100057DF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 126.04071378707886, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 8.576923076923077, "ram_util_percent": 44.599999999999994}}
{"episode_reward_max": 0.7119733327999427, "episode_reward_min": -389.74189300090075, "episode_reward_mean": -292.8890692385752, "episode_len_mean": 88.81, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {"shared_policy": -141.24562482039136}, "policy_reward_max": {"shared_policy": 0.7283242528016274}, "policy_reward_mean": {"shared_policy": -97.62968974619173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-318.1734313964844, -299.1066475510597, -27.515649586915984, -318.4770184904337, -334.92049799859524, -336.3046272844077, -315.7570595443249, -305.2554562911391, -26.645821608603, -318.64369791559875, -312.25929189473396, -319.9143367558718, -314.44341185316443, -316.8274224102497, -312.9632907435298, -313.23684369027615, -309.45258420705795, -330.3144277334214, -321.822133526206, -304.64079320430756, -335.6838363111019, -277.08710241224617, -310.5985228717327, -318.43880358338356, -323.451167345047, -306.9187307432294, -320.6921159029007, -301.78389889001846, -334.9462035894394, -317.9539070688188, -315.9661687090993, -325.42295199632645, -311.86856204271317, -389.74189300090075, -63.28592046350242, -290.9820581525564, -304.05924851447344, -298.22503978386527, -288.5480655133724, -311.55359494686127, -322.86671423912054, -293.6443861424923, -53.84010567516091, -323.5487196762115, -308.97762256860733, -317.419999614358, -313.96127907186747, -319.99618396162987, 0.7119733327999427, -327.12493842840195, -319.3288571238518, -331.33546954393387, -316.90157432854176, -305.4283846616745, -293.1967582628131, -304.4200400914997, -309.57000428438187, -322.498925819993, -292.81073746085167, -304.2896073833108, -313.80936003476387, -322.95443303883076, -290.8768847584725, -24.36148665845397, -319.61058036237955, -334.8532903790474, -320.65061011165386, -296.66671398282057, -338.0121750533581, -320.3436843752861, -294.60292598605156, -323.4414458833635, -315.0200489386916, -40.88533281534913, -332.9225848019123, -330.07441902160645, -288.69753294065595, -6.136267647147179, -311.50759322568774, -282.9326793849468, -301.82061913609505, -317.4915537536145, -313.0894510447979, -366.34329421818256, -307.62034851312643, -319.2242968827486, -322.56134102866054, -311.34787848591805, -307.34856702387333, -331.9400048106909, -305.4794240891934, -318.3639976978302, -337.8010392189026, -315.6218489306048, -325.82373213768005, -305.4477884694934, -322.3954143598676, -330.9014445245266, -319.4663634747267, -316.1278961226344], "episode_lengths": [70, 66, 300, 52, 55, 58, 76, 45, 300, 62, 49, 35, 57, 69, 57, 73, 66, 51, 76, 51, 61, 103, 67, 62, 53, 63, 65, 93, 77, 71, 83, 44, 70, 265, 300, 82, 81, 67, 76, 53, 79, 73, 300, 68, 68, 97, 49, 56, 300, 67, 79, 70, 45, 78, 61, 74, 63, 52, 78, 54, 44, 67, 84, 300, 58, 58, 74, 58, 51, 54, 78, 41, 55, 300, 55, 62, 97, 300, 50, 76, 80, 111, 83, 223, 88, 49, 82, 59, 101, 77, 79, 71, 62, 47, 52, 93, 44, 90, 74, 39], "policy_shared_policy_reward": [-113.5671971042951, -102.94830032189688, -101.65793397029242, -106.33213873704275, -94.87262304623923, -97.90188576777777, -8.16453678409259, -9.819723943869278, -9.531388858954116, -101.50790287057559, -116.25234929720561, -100.7167663226525, -107.40523996949196, -106.16913612186909, -121.34612190723419, -121.0732384522756, -109.19619907935461, -106.03518975277743, -101.80422701438269, -112.90979035695395, -101.04304217298827, -106.08975084622702, -99.36463011552891, -99.80107532938322, -8.714881084859371, -8.948641523718834, -8.982299000024796, -114.62557194630305, -100.30104384633403, -103.71708212296168, -100.31154548128447, -98.65425461282334, -113.29349180062613, -102.30478262901306, -116.68674862384796, -100.92280550301075, -112.81084889173508, -101.60738030076027, -100.02518266066909, -100.40303668379784, -101.39608091115952, -115.02830481529236, -98.73314984391133, -115.35757664839427, -98.8725642512242, -112.7405879298846, -100.74503992001216, -99.7512158403794, -100.10172460476558, -97.3869210879008, -111.96393851439159, -105.56701972087225, -106.17996974786124, -118.56743826468787, -111.19230178991954, -97.62274553875129, -113.0070861975352, -96.8507826824983, -97.09945951898894, -110.69055100282034, -106.88160219788551, -106.51332312822342, -122.28891098499298, -88.18855903297663, -101.18996518850327, -87.70857819076627, -99.98450264334679, -110.69215327501297, -99.92186695337296, -115.81335957845053, -102.03168358405432, -100.59376042087874, -104.5420507589976, -115.69341311852138, -103.21570346752803, -101.61675715446472, -109.82506448030472, -95.47690910845995, -103.33097175757091, -114.89471451441447, -102.46642963091533, -96.32672264178595, -109.59128840764365, -95.8658878405889, -106.3377826611201, -108.08418385187785, -120.52423707644145, -102.2094096938769, -99.66890779758494, -116.07558957735698, -113.05667406320572, -100.94914207607508, -101.9603525698185, -104.86071958144507, -104.657530327638, -115.90470208724341, -98.75744966665904, -98.355710486571, -114.75540188948314, -123.29338802645604, -125.20288015405337, -141.24562482039136, -19.136771681408092, -21.00180820624034, -23.14734057585399, -92.9000110278527, -93.47777725259463, -104.6042698721091, -96.1454732293884, -109.1292061607043, -98.78456912438075, -98.07105978329977, -102.13707198699316, -98.0169080135723, -91.09342160820961, -104.43037259578705, -93.02427130937576, -99.70592871059975, -99.72454882909855, -112.123117407163, -114.2254955371221, -103.70537348588309, -104.93584521611533, -105.34828992684683, -93.3006124397119, -94.9954837759336, -17.2494989608725, -17.087077980240196, -19.503528734048217, -105.4509982864062, -115.96335415045421, -102.13436723935108, -98.3082576195399, -112.7419038216273, -97.92746112744014, -105.61013897260031, -111.03042533000311, -100.77943531175455, -113.30785709619522, -98.9561014547944, -101.69732052087784, -102.49101380507152, -101.84790874520938, -115.65726141134898, 0.7283242528016274, -0.1478971292575295, 0.13154620925584481, -118.54687861601512, -104.06787983576457, -104.51017997662227, -100.30361912647884, -102.3890190521876, -116.63621894518535, -118.69584065675735, -105.58742848038673, -107.05220040678978, -114.72131752967834, -101.94340670108795, -100.23685009777546, -113.2312119404475, -95.93621496359508, -96.26095775763194, -94.38310036063194, -92.52872546762228, -106.28493243455887, -96.77414606014888, -111.30228767792384, -96.34360635342698, -110.68733590841293, -99.51927649974823, -99.3633918762207, -103.75606014331183, -116.657763560613, -102.08510211606821, -93.41302830974261, -104.8481768767039, -94.54953227440517, -96.52830501894157, -96.09451422343652, -111.66678814093272, -113.77657588322958, -99.63529027750096, -100.3974938740333, -102.98349623878798, -102.69708198805651, -117.2738548119863, -91.38628413279852, -91.53475960095724, -107.9558410247167, -7.105773811539024, -7.089077730973571, -10.166635115941375, -117.8716208934784, -101.88972362875938, -99.84923584014177, -105.21708093086879, -120.4747991959254, -109.16141025225322, -101.73080130418143, -99.74015603711209, -119.17965277036032, -106.97970833381018, -94.87720232208571, -94.80980332692465, -109.19980454444885, -107.50323089957237, -121.30913960933685, -115.49676581223807, -102.78078271945319, -102.06613584359488, -94.27385128537814, -106.04390345017116, -94.28517125050227, -116.80300811926524, -103.8219744215409, -102.81646334255736, -99.75000620633364, -100.09373266994953, -115.17631006240845, -13.8012010951837, -12.4905266587933, -14.59360506137213, -107.43333725134532, -106.03474540511768, -119.45450214544933, -105.50968525807063, -118.39371053377788, -106.17102322975795, -92.16342906281352, -104.21801087260246, -92.31609300523996, -2.6873073279857635, -1.9828597009181976, -1.4661006182432175, -98.55300325279435, -112.8933005531629, -100.06128941973051, -91.18894404172897, -89.99867996573448, -101.74505537748337, -95.241218517224, -94.9369825522105, -111.64241806666057, -100.71483563383421, -101.84726025660834, -114.9294578631719, -113.13638041416804, -99.46390415231387, -100.489166478316, -117.92600417633852, -129.59285708268484, -118.82443295915922, -98.1207227309545, -97.19461884101233, -112.30500694115958, -101.52607319255671, -103.33294232686362, -114.36528136332831, -116.25698322057724, -102.06326223537326, -104.24109557271004, -109.45738431811333, -99.83528715372086, -102.05520701408386, -97.11034911374252, -109.53161130348842, -100.70660660664241, -104.50387015442054, -106.86180464426677, -120.57433001200359, -109.95752282937369, -97.89996646841368, -97.621934791406, -102.09010503689449, -101.41819856564204, -114.85569409529369, -107.88631796836853, -108.93039643764496, -120.9843248128891, -116.51971419652304, -99.86200114091238, -99.24013359316936, -117.12365492184958, -103.95354851086935, -104.74652870496115, -96.91996628046036, -95.54216926544905, -112.98565292358398, -116.87536311149597, -103.16003595292568, -102.36001529544592, -105.9289419054985, -105.73129811882973, -119.24120450019836, -101.59428804616134, -115.02042941252391, -102.85164601604144, -115.70901234944662, -100.65410365660986, -99.76478011657795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17274474308566462, "mean_inference_ms": 0.6794840753457799, "mean_action_processing_ms": 0.09863858408425402, "mean_env_wait_ms": 0.7982084799261357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 201600, "timers": {"sample_time_ms": 9809.757, "sample_throughput": 489.309, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1262.72, "learn_throughput": 3801.317, "update_time_ms": 1.366}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 2412.5760192871094, "policy_loss": -0.002571664879829516, "vf_loss": 2412.6394653320312, "vf_explained_var": 0.006177231669425964, "kl": 0.005490494564585852, "entropy": 6.091062366962433, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 201600, "num_steps_trained": 67200, "num_agent_steps_trained": 201600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 819, "training_iteration": 14, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-44-52", "timestamp": 1706147092, "time_this_iter_s": 9.357112407684326, "time_total_s": 135.39782619476318, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015AD040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 135.39782619476318, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 9.971428571428572, "ram_util_percent": 44.292857142857144}}
{"episode_reward_max": -6.136267647147179, "episode_reward_min": -366.34329421818256, "episode_reward_mean": -296.5637143134279, "episode_len_mean": 86.75, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {"shared_policy": -129.59285708268484}, "policy_reward_max": {"shared_policy": -1.4661006182432175}, "policy_reward_mean": {"shared_policy": -98.85457143780931}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305.4283846616745, -293.1967582628131, -304.4200400914997, -309.57000428438187, -322.498925819993, -292.81073746085167, -304.2896073833108, -313.80936003476387, -322.95443303883076, -290.8768847584725, -24.36148665845397, -319.61058036237955, -334.8532903790474, -320.65061011165386, -296.66671398282057, -338.0121750533581, -320.3436843752861, -294.60292598605156, -323.4414458833635, -315.0200489386916, -40.88533281534913, -332.9225848019123, -330.07441902160645, -288.69753294065595, -6.136267647147179, -311.50759322568774, -282.9326793849468, -301.82061913609505, -317.4915537536145, -313.0894510447979, -366.34329421818256, -307.62034851312643, -319.2242968827486, -322.56134102866054, -311.34787848591805, -307.34856702387333, -331.9400048106909, -305.4794240891934, -318.3639976978302, -337.8010392189026, -315.6218489306048, -325.82373213768005, -305.4477884694934, -322.3954143598676, -330.9014445245266, -319.4663634747267, -316.1278961226344, -313.62211057543755, -311.6119259893894, -314.56669372320175, -337.4069653004408, -319.7438866645098, -335.3425641655922, -329.068036198616, -16.612707443535328, -322.56794621795416, -313.40827268362045, -314.5608567595482, -306.43864064477384, -342.4143781065941, -324.443467438221, -311.30844861269, -309.404616445303, -322.37465369328856, -279.7540490478277, -348.62280565779656, -356.9709916114807, -319.94491040334105, -326.1437790803611, -308.17891189455986, -311.9111343920231, -27.74628364667298, -315.5298281162977, -27.708446204662337, -321.3180352076888, -303.7418277040124, -312.63489896059036, -318.02573493495584, -318.94465988874435, -299.5675674676895, -338.97256314754486, -331.2727122604847, -338.1714494228363, -303.79230588674545, -340.6543953642249, -320.8885523453355, -327.34518989920616, -318.3434170335532, -340.6195905208588, -301.95924946479505, -310.6079270839692, -327.99649492651224, -309.8389083743096, -329.5981438457966, -299.4352524243295, -296.0491941571236, -295.1097622513771, -314.4992364696227, -40.27708118408921, -292.5091591104865], "episode_lengths": [78, 61, 74, 63, 52, 78, 54, 44, 67, 84, 300, 58, 58, 74, 58, 51, 54, 78, 41, 55, 300, 55, 62, 97, 300, 50, 76, 80, 111, 83, 223, 88, 49, 82, 59, 101, 77, 79, 71, 62, 47, 52, 93, 44, 90, 74, 39, 73, 64, 66, 115, 64, 59, 61, 300, 85, 65, 127, 65, 75, 54, 70, 56, 46, 107, 113, 93, 46, 73, 81, 76, 300, 58, 300, 63, 65, 69, 46, 70, 103, 55, 52, 66, 58, 99, 93, 59, 38, 66, 63, 97, 57, 65, 64, 55, 86, 67, 42, 300, 59], "policy_shared_policy_reward": [-113.2312119404475, -95.93621496359508, -96.26095775763194, -94.38310036063194, -92.52872546762228, -106.28493243455887, -96.77414606014888, -111.30228767792384, -96.34360635342698, -110.68733590841293, -99.51927649974823, -99.3633918762207, -103.75606014331183, -116.657763560613, -102.08510211606821, -93.41302830974261, -104.8481768767039, -94.54953227440517, -96.52830501894157, -96.09451422343652, -111.66678814093272, -113.77657588322958, -99.63529027750096, -100.3974938740333, -102.98349623878798, -102.69708198805651, -117.2738548119863, -91.38628413279852, -91.53475960095724, -107.9558410247167, -7.105773811539024, -7.089077730973571, -10.166635115941375, -117.8716208934784, -101.88972362875938, -99.84923584014177, -105.21708093086879, -120.4747991959254, -109.16141025225322, -101.73080130418143, -99.74015603711209, -119.17965277036032, -106.97970833381018, -94.87720232208571, -94.80980332692465, -109.19980454444885, -107.50323089957237, -121.30913960933685, -115.49676581223807, -102.78078271945319, -102.06613584359488, -94.27385128537814, -106.04390345017116, -94.28517125050227, -116.80300811926524, -103.8219744215409, -102.81646334255736, -99.75000620633364, -100.09373266994953, -115.17631006240845, -13.8012010951837, -12.4905266587933, -14.59360506137213, -107.43333725134532, -106.03474540511768, -119.45450214544933, -105.50968525807063, -118.39371053377788, -106.17102322975795, -92.16342906281352, -104.21801087260246, -92.31609300523996, -2.6873073279857635, -1.9828597009181976, -1.4661006182432175, -98.55300325279435, -112.8933005531629, -100.06128941973051, -91.18894404172897, -89.99867996573448, -101.74505537748337, -95.241218517224, -94.9369825522105, -111.64241806666057, -100.71483563383421, -101.84726025660834, -114.9294578631719, -113.13638041416804, -99.46390415231387, -100.489166478316, -117.92600417633852, -129.59285708268484, -118.82443295915922, -98.1207227309545, -97.19461884101233, -112.30500694115958, -101.52607319255671, -103.33294232686362, -114.36528136332831, -116.25698322057724, -102.06326223537326, -104.24109557271004, -109.45738431811333, -99.83528715372086, -102.05520701408386, -97.11034911374252, -109.53161130348842, -100.70660660664241, -104.50387015442054, -106.86180464426677, -120.57433001200359, -109.95752282937369, -97.89996646841368, -97.621934791406, -102.09010503689449, -101.41819856564204, -114.85569409529369, -107.88631796836853, -108.93039643764496, -120.9843248128891, -116.51971419652304, -99.86200114091238, -99.24013359316936, -117.12365492184958, -103.95354851086935, -104.74652870496115, -96.91996628046036, -95.54216926544905, -112.98565292358398, -116.87536311149597, -103.16003595292568, -102.36001529544592, -105.9289419054985, -105.73129811882973, -119.24120450019836, -101.59428804616134, -115.02042941252391, -102.85164601604144, -115.70901234944662, -100.65410365660986, -99.76478011657795, -99.51246423522632, -113.6940523783366, -100.41559396187465, -100.56955552101135, -112.62976920604706, -98.41260126233101, -99.10058373212814, -114.99128782749176, -100.47482216358185, -108.51655777295431, -107.43146795531115, -121.45893957217535, -100.07495092848937, -115.587344566981, -104.08159116903941, -107.07212310036024, -107.22586076458296, -121.04458030064902, -104.01750389734904, -106.7490125099818, -118.3015197912852, -6.107494592666626, -5.23263106495142, -5.272581785917282, -102.57484751939774, -100.968511544168, -119.02458715438843, -101.23074277242026, -112.85591824849448, -99.32161166270575, -99.39412427941959, -100.03317905465762, -115.13355342547099, -95.5524216995885, -113.56263120969138, -97.32358773549399, -110.4651386141777, -123.99121797084808, -107.9580215215683, -103.3620022336642, -103.0402882496516, -118.0411769549052, -110.49273699522018, -102.47783482074738, -98.33787679672241, -97.85897695024809, -110.03559150298437, -101.51004799207053, -104.50503939390182, -101.56476914510131, -116.30484515428543, -104.35587096214294, -86.6481510847807, -88.75002700090408, -117.51504022162408, -119.64390754699707, -111.46385788917542, -114.5805345873038, -127.60946545998256, -114.78099156419437, -116.90391449133556, -100.82392711068194, -102.21706880132358, -102.84613516057532, -119.0202185312907, -104.27742538849513, -98.05552714069685, -110.29576905568442, -99.82761569817862, -111.49174962441127, -100.3512050608794, -100.06817970673244, -7.964485986779138, -8.167860480646297, -11.613937179247543, -99.79477431873481, -114.66728333632152, -101.06777046124141, -8.9677303681771, -8.766442949573204, -9.974272886912033, -115.21861696243286, -100.8447720631957, -105.25464618206024, -112.81527829170227, -95.26509978622198, -95.66144962608814, -99.15851496656737, -98.78676854570708, -114.68961544831595, -100.96825398132205, -101.04213585704565, -116.01534509658813, -115.0198202530543, -101.34629211823146, -102.5785475174586, -95.54906886816025, -107.01492440700531, -97.00357419252396, -108.30362170934677, -109.99182522296906, -120.67711621522903, -118.62338187297186, -107.03598262866339, -105.61334775884947, -108.35136864582698, -121.26780871550243, -108.55227206150691, -109.18700953324637, -97.3353456457456, -97.26995070775351, -106.48373326659203, -116.26563134044409, -117.9050307571888, -103.1521738866965, -115.47506121794383, -102.26131724069516, -119.7872825463613, -103.56422190864882, -103.99368544419607, -101.43605316181979, -102.157803495725, -114.74956037600836, -120.61513402064642, -110.00024803479513, -110.00420846541724, -111.93966301282248, -95.98142685492834, -94.0381595970442, -99.11395542820296, -111.70319684346518, -99.79077481230101, -104.30056823045015, -105.47959843277931, -118.21632826328278, -112.13244171937308, -98.97058697541556, -98.73587967952093, -106.24480078617732, -120.89556495348613, -102.45777810613315, -94.32697668299079, -109.21018117666245, -95.89809456467628, -107.62256189187369, -94.67054217060408, -93.75609009464583, -95.38414339224498, -91.89286063114803, -107.83275822798412, -114.59703254699707, -100.63782516121864, -99.26437876140699, -12.596125831206649, -12.161205751200526, -15.519749601682037, -93.45116217931113, -106.43073370059332, -92.62726323058209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17241197727824684, "mean_inference_ms": 0.6769093442153803, "mean_action_processing_ms": 0.09855275524471477, "mean_env_wait_ms": 0.7961682927594245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"sample_time_ms": 9795.782, "sample_throughput": 490.007, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1265.113, "learn_throughput": 3794.126, "update_time_ms": 1.267}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 2315.4031372070312, "policy_loss": -0.003060251007942938, "vf_loss": 2315.4664611816406, "vf_explained_var": 0.005188196897506714, "kl": 0.007229680486491862, "entropy": 6.031553149223328, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 216000, "num_steps_trained": 72000, "num_agent_steps_trained": 216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 872, "training_iteration": 15, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-45-01", "timestamp": 1706147101, "time_this_iter_s": 9.142738580703735, "time_total_s": 144.54056477546692, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C16A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 144.54056477546692, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 10.669230769230769, "ram_util_percent": 44.10769230769232}}
{"episode_reward_max": 23.480437830090523, "episode_reward_min": -356.9709916114807, "episode_reward_mean": -290.1437425377499, "episode_len_mean": 89.8, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {"shared_policy": -127.60946545998256}, "policy_reward_max": {"shared_policy": 8.387417018413544}, "policy_reward_mean": {"shared_policy": -96.71458084591664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.612707443535328, -322.56794621795416, -313.40827268362045, -314.5608567595482, -306.43864064477384, -342.4143781065941, -324.443467438221, -311.30844861269, -309.404616445303, -322.37465369328856, -279.7540490478277, -348.62280565779656, -356.9709916114807, -319.94491040334105, -326.1437790803611, -308.17891189455986, -311.9111343920231, -27.74628364667298, -315.5298281162977, -27.708446204662337, -321.3180352076888, -303.7418277040124, -312.63489896059036, -318.02573493495584, -318.94465988874435, -299.5675674676895, -338.97256314754486, -331.2727122604847, -338.1714494228363, -303.79230588674545, -340.6543953642249, -320.8885523453355, -327.34518989920616, -318.3434170335532, -340.6195905208588, -301.95924946479505, -310.6079270839692, -327.99649492651224, -309.8389083743096, -329.5981438457966, -299.4352524243295, -296.0491941571236, -295.1097622513771, -314.4992364696227, -40.27708118408921, -292.5091591104865, -6.784325011074571, -334.4812018573284, -310.09969687461853, -341.65237988531595, -302.7419215142727, -322.66078451275826, -293.9817795455456, -313.4021140038967, -297.16537910699844, -316.4376636184752, -310.0122557193973, -316.0300869047642, -322.66155874636024, -310.9296100512147, -307.50052950531244, -5.447715304791956, -309.6017945408821, 23.480437830090523, -328.9292032271624, -53.49733640253544, -349.24068434536457, -313.1628943681717, -287.97799974679947, -285.2572438791394, -326.2736352980137, -306.97983062267303, -329.8449777252972, -324.7305438891053, -309.3657466471195, -337.47142150998116, -317.31936579942703, -322.98349545896053, -313.5956525504589, -317.6971120610833, -318.6287056207657, -302.935652396176, -291.5088296830654, -326.19210754334927, -313.95198753476143, -312.1041684523225, -314.066757902503, -338.17390537261963, -308.4716890901327, -315.26992742717266, -309.8702599927783, -327.4989643618465, -325.2467514574528, -321.9440758228302, -322.3345754146576, -21.018659383058576, -321.3276179805398, -312.61992125213146, -310.1428255313076, -320.4109317138791], "episode_lengths": [300, 85, 65, 127, 65, 75, 54, 70, 56, 46, 107, 113, 93, 46, 73, 81, 76, 300, 58, 300, 63, 65, 69, 46, 70, 103, 55, 52, 66, 58, 99, 93, 59, 38, 66, 63, 97, 57, 65, 64, 55, 86, 67, 42, 300, 59, 300, 62, 67, 86, 100, 60, 79, 55, 72, 66, 92, 59, 64, 72, 51, 300, 52, 300, 69, 300, 105, 40, 63, 78, 95, 71, 56, 59, 78, 55, 57, 55, 69, 51, 76, 58, 72, 58, 56, 73, 87, 88, 94, 41, 65, 67, 49, 58, 57, 300, 68, 72, 56, 100], "policy_shared_policy_reward": [-6.107494592666626, -5.23263106495142, -5.272581785917282, -102.57484751939774, -100.968511544168, -119.02458715438843, -101.23074277242026, -112.85591824849448, -99.32161166270575, -99.39412427941959, -100.03317905465762, -115.13355342547099, -95.5524216995885, -113.56263120969138, -97.32358773549399, -110.4651386141777, -123.99121797084808, -107.9580215215683, -103.3620022336642, -103.0402882496516, -118.0411769549052, -110.49273699522018, -102.47783482074738, -98.33787679672241, -97.85897695024809, -110.03559150298437, -101.51004799207053, -104.50503939390182, -101.56476914510131, -116.30484515428543, -104.35587096214294, -86.6481510847807, -88.75002700090408, -117.51504022162408, -119.64390754699707, -111.46385788917542, -114.5805345873038, -127.60946545998256, -114.78099156419437, -116.90391449133556, -100.82392711068194, -102.21706880132358, -102.84613516057532, -119.0202185312907, -104.27742538849513, -98.05552714069685, -110.29576905568442, -99.82761569817862, -111.49174962441127, -100.3512050608794, -100.06817970673244, -7.964485986779138, -8.167860480646297, -11.613937179247543, -99.79477431873481, -114.66728333632152, -101.06777046124141, -8.9677303681771, -8.766442949573204, -9.974272886912033, -115.21861696243286, -100.8447720631957, -105.25464618206024, -112.81527829170227, -95.26509978622198, -95.66144962608814, -99.15851496656737, -98.78676854570708, -114.68961544831595, -100.96825398132205, -101.04213585704565, -116.01534509658813, -115.0198202530543, -101.34629211823146, -102.5785475174586, -95.54906886816025, -107.01492440700531, -97.00357419252396, -108.30362170934677, -109.99182522296906, -120.67711621522903, -118.62338187297186, -107.03598262866339, -105.61334775884947, -108.35136864582698, -121.26780871550243, -108.55227206150691, -109.18700953324637, -97.3353456457456, -97.26995070775351, -106.48373326659203, -116.26563134044409, -117.9050307571888, -103.1521738866965, -115.47506121794383, -102.26131724069516, -119.7872825463613, -103.56422190864882, -103.99368544419607, -101.43605316181979, -102.157803495725, -114.74956037600836, -120.61513402064642, -110.00024803479513, -110.00420846541724, -111.93966301282248, -95.98142685492834, -94.0381595970442, -99.11395542820296, -111.70319684346518, -99.79077481230101, -104.30056823045015, -105.47959843277931, -118.21632826328278, -112.13244171937308, -98.97058697541556, -98.73587967952093, -106.24480078617732, -120.89556495348613, -102.45777810613315, -94.32697668299079, -109.21018117666245, -95.89809456467628, -107.62256189187369, -94.67054217060408, -93.75609009464583, -95.38414339224498, -91.89286063114803, -107.83275822798412, -114.59703254699707, -100.63782516121864, -99.26437876140699, -12.596125831206649, -12.161205751200526, -15.519749601682037, -93.45116217931113, -106.43073370059332, -92.62726323058209, -2.1018014823397095, -2.0646335532267983, -2.6178899755080636, -106.82390062014262, -107.64346910516421, -120.01383213202159, -98.48323992888133, -113.43979529539745, -98.17666165033977, -123.57785161336264, -108.57480410238108, -109.4997241695722, -96.76235466202101, -97.06755920251211, -108.91200764973959, -114.96477353572845, -102.53664496541023, -105.15936601161957, -105.72971061865489, -93.16914410392444, -95.08292482296626, -99.30953505635262, -98.31547874212265, -115.77710020542145, -95.8695820569992, -95.03017550706863, -106.2656215429306, -103.34071554740271, -113.86657663186392, -99.2303714392086, -111.9060260852178, -98.17335809379196, -99.93287154038748, -101.45419449607532, -101.29250542322795, -113.28338698546092, -119.2502304315567, -100.99344420339912, -102.41788411140442, -112.16393685340881, -97.47250536829233, -101.29316782951355, -105.18677151203156, -100.1606793180108, -102.15307867527008, -1.8412993748982842, -1.8179625545938904, -1.788453375299781, -109.45036055644354, -99.04030652840933, -101.11112745602927, 8.015167012810707, 8.387417018413544, 7.077853798866272, -118.52310399214427, -105.32640042404334, -105.07969881097476, -16.54843033850193, -17.88426810503006, -19.06463795900345, -112.45506169398627, -125.14472188552222, -111.64090076585612, -114.8967791001002, -99.43553943435352, -98.83057583371799, -96.17996086676916, -96.3104205330213, -95.48761834700903, -91.89919562141101, -102.92236016194026, -90.43568809578817, -103.46588103969893, -104.09386946757635, -118.71388479073843, -97.1392803589503, -97.3077361981074, -112.53281406561534, -104.57920617734393, -105.62823494275412, -119.63753660519919, -117.39620916048686, -102.24800165245931, -105.08633307615916, -97.31898763775826, -99.48903167247772, -112.55772733688354, -107.9413098593553, -108.44835450251898, -121.0817571481069, -117.08322219053905, -100.27866072456042, -99.95748288432758, -103.40706117947897, -102.64624089499316, -116.93019338448843, -100.15327388048172, -98.74562421441078, -114.6967544555664, -102.34431050221126, -114.90281633536021, -100.44998522351186, -114.42360417048137, -101.50084541241328, -102.70425603787105, -109.21143569548926, -96.87656030322736, -96.84765639745942, -106.95684639612834, -93.08767286936443, -91.46431041757266, -117.22719822327296, -103.66774644951026, -105.29716287056605, -99.51027504603069, -99.45687777797382, -114.98483471075694, -113.83725559711456, -100.04279306530952, -98.2241197898984, -101.29013939698538, -113.11213566859564, -99.66448283692202, -108.97483529647192, -108.18740995724997, -121.01166011889777, -97.99385510881743, -97.1349252810081, -113.34290870030722, -113.56781029701233, -101.69181624054909, -100.01030088961124, -99.72764590382576, -111.96885639429092, -98.17375769466162, -118.80188520749411, -103.70082981636128, -104.99624933799109, -117.94682572285335, -103.88542300711076, -103.41450272748868, -101.4252308756113, -101.43543027341366, -119.08341467380524, -101.73979115486145, -104.25201785564423, -116.34276640415192, -6.927038302024215, -6.523279120524734, -7.568341960509628, -102.42816204577684, -115.64086800813675, -103.2585879266262, -113.68916364510855, -98.46685329576334, -100.4639043112596, -97.22991158301011, -97.85212126374245, -115.06079268455505, -101.49736685305834, -103.0192899107933, -115.89427495002747]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1718034826384494, "mean_inference_ms": 0.6739105555809055, "mean_action_processing_ms": 0.09830703646571362, "mean_env_wait_ms": 0.7937010142132286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"sample_time_ms": 9762.762, "sample_throughput": 491.664, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1253.406, "learn_throughput": 3829.564, "update_time_ms": 1.267}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 2191.7582092285156, "policy_loss": -0.0025613335431585726, "vf_loss": 2191.8217163085938, "vf_explained_var": 0.006677009165287018, "kl": 0.006227953177588482, "entropy": 6.098653793334961, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 230400, "num_steps_trained": 76800, "num_agent_steps_trained": 230400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 926, "training_iteration": 16, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-45-10", "timestamp": 1706147110, "time_this_iter_s": 9.099933862686157, "time_total_s": 153.64049863815308, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000545790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 153.64049863815308, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 8.241666666666667, "ram_util_percent": 44.11666666666667}}
{"episode_reward_max": 23.480437830090523, "episode_reward_min": -611.1913800090551, "episode_reward_mean": -294.1442538200179, "episode_len_mean": 92.4, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {"shared_policy": -215.8989136616389}, "policy_reward_max": {"shared_policy": 8.387417018413544}, "policy_reward_mean": {"shared_policy": -98.04808460667263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302.7419215142727, -322.66078451275826, -293.9817795455456, -313.4021140038967, -297.16537910699844, -316.4376636184752, -310.0122557193973, -316.0300869047642, -322.66155874636024, -310.9296100512147, -307.50052950531244, -5.447715304791956, -309.6017945408821, 23.480437830090523, -328.9292032271624, -53.49733640253544, -349.24068434536457, -313.1628943681717, -287.97799974679947, -285.2572438791394, -326.2736352980137, -306.97983062267303, -329.8449777252972, -324.7305438891053, -309.3657466471195, -337.47142150998116, -317.31936579942703, -322.98349545896053, -313.5956525504589, -317.6971120610833, -318.6287056207657, -302.935652396176, -291.5088296830654, -326.19210754334927, -313.95198753476143, -312.1041684523225, -314.066757902503, -338.17390537261963, -308.4716890901327, -315.26992742717266, -309.8702599927783, -327.4989643618465, -325.2467514574528, -321.9440758228302, -322.3345754146576, -21.018659383058576, -321.3276179805398, -312.61992125213146, -310.1428255313076, -320.4109317138791, -355.23573368787766, -306.6251197606325, -293.3312507420779, -310.6619805917144, -50.76173061132434, -317.4611853808165, -303.6662941426039, -324.94341675937176, -329.17777612805367, -321.6519056092948, -284.8132767379284, -331.5742201283574, -328.052541255951, -317.86935906112194, -320.6556148827076, -313.305881485343, -326.0184954851866, -305.062790364027, -328.390517398715, -34.6433362737298, -317.8595999404788, -316.1443395554088, -36.92634769901633, -339.81887954473495, -318.0592491924763, -297.6299993097782, -303.90004381909966, -321.5626780092716, -304.45295917987823, -299.55784380435944, -339.8956942260266, -47.684729451313615, -317.99868455156684, -315.8458254635334, -309.23123119259253, -375.85505378991365, -316.5697453022003, -292.5831426382065, -336.10633489489555, -322.1714873313904, -321.7145473062992, -324.85047256946564, -336.21615470200777, -314.0241622030735, -611.1913800090551, -315.40485176444054, 7.69993724673985, -344.8859356343746, -314.66383333504206, -342.2794736325741], "episode_lengths": [100, 60, 79, 55, 72, 66, 92, 59, 64, 72, 51, 300, 52, 300, 69, 300, 105, 40, 63, 78, 95, 71, 56, 59, 78, 55, 57, 55, 69, 51, 76, 58, 72, 58, 56, 73, 87, 88, 94, 41, 65, 67, 49, 58, 57, 300, 68, 72, 56, 100, 194, 64, 104, 71, 300, 65, 77, 63, 59, 62, 127, 63, 50, 62, 54, 74, 64, 50, 127, 300, 43, 47, 300, 57, 45, 74, 71, 42, 87, 86, 77, 300, 47, 58, 54, 260, 61, 64, 95, 74, 51, 83, 115, 50, 53, 69, 300, 82, 84, 63], "policy_shared_policy_reward": [-96.76235466202101, -97.06755920251211, -108.91200764973959, -114.96477353572845, -102.53664496541023, -105.15936601161957, -105.72971061865489, -93.16914410392444, -95.08292482296626, -99.30953505635262, -98.31547874212265, -115.77710020542145, -95.8695820569992, -95.03017550706863, -106.2656215429306, -103.34071554740271, -113.86657663186392, -99.2303714392086, -111.9060260852178, -98.17335809379196, -99.93287154038748, -101.45419449607532, -101.29250542322795, -113.28338698546092, -119.2502304315567, -100.99344420339912, -102.41788411140442, -112.16393685340881, -97.47250536829233, -101.29316782951355, -105.18677151203156, -100.1606793180108, -102.15307867527008, -1.8412993748982842, -1.8179625545938904, -1.788453375299781, -109.45036055644354, -99.04030652840933, -101.11112745602927, 8.015167012810707, 8.387417018413544, 7.077853798866272, -118.52310399214427, -105.32640042404334, -105.07969881097476, -16.54843033850193, -17.88426810503006, -19.06463795900345, -112.45506169398627, -125.14472188552222, -111.64090076585612, -114.8967791001002, -99.43553943435352, -98.83057583371799, -96.17996086676916, -96.3104205330213, -95.48761834700903, -91.89919562141101, -102.92236016194026, -90.43568809578817, -103.46588103969893, -104.09386946757635, -118.71388479073843, -97.1392803589503, -97.3077361981074, -112.53281406561534, -104.57920617734393, -105.62823494275412, -119.63753660519919, -117.39620916048686, -102.24800165245931, -105.08633307615916, -97.31898763775826, -99.48903167247772, -112.55772733688354, -107.9413098593553, -108.44835450251898, -121.0817571481069, -117.08322219053905, -100.27866072456042, -99.95748288432758, -103.40706117947897, -102.64624089499316, -116.93019338448843, -100.15327388048172, -98.74562421441078, -114.6967544555664, -102.34431050221126, -114.90281633536021, -100.44998522351186, -114.42360417048137, -101.50084541241328, -102.70425603787105, -109.21143569548926, -96.87656030322736, -96.84765639745942, -106.95684639612834, -93.08767286936443, -91.46431041757266, -117.22719822327296, -103.66774644951026, -105.29716287056605, -99.51027504603069, -99.45687777797382, -114.98483471075694, -113.83725559711456, -100.04279306530952, -98.2241197898984, -101.29013939698538, -113.11213566859564, -99.66448283692202, -108.97483529647192, -108.18740995724997, -121.01166011889777, -97.99385510881743, -97.1349252810081, -113.34290870030722, -113.56781029701233, -101.69181624054909, -100.01030088961124, -99.72764590382576, -111.96885639429092, -98.17375769466162, -118.80188520749411, -103.70082981636128, -104.99624933799109, -117.94682572285335, -103.88542300711076, -103.41450272748868, -101.4252308756113, -101.43543027341366, -119.08341467380524, -101.73979115486145, -104.25201785564423, -116.34276640415192, -6.927038302024215, -6.523279120524734, -7.568341960509628, -102.42816204577684, -115.64086800813675, -103.2585879266262, -113.68916364510855, -98.46685329576334, -100.4639043112596, -97.22991158301011, -97.85212126374245, -115.06079268455505, -101.49736685305834, -103.0192899107933, -115.89427495002747, -126.71703100204468, -112.87235021591187, -115.64635246992111, -97.02723275125027, -111.54601085186005, -98.0518761575222, -107.41477711995444, -93.11497240265211, -92.8015012194713, -113.10227457682292, -98.61521702508132, -98.94448898981015, -17.07050093015036, -17.60747425754866, -16.08375542362532, -103.04846872886023, -98.88133806486925, -115.531378587087, -113.62572511037192, -95.21866296728453, -94.82190606494746, -103.82436520357928, -117.77359559138617, -103.34545596440634, -104.00397126873335, -119.05849476655325, -106.11531009276709, -103.84671857953072, -101.64474086277187, -116.16044616699219, -104.53454685211182, -90.61476451158524, -89.66396537423134, -120.9961405992508, -102.80345792323351, -107.77462160587311, -105.12494124968848, -119.12404723962149, -103.80355276664099, -101.22896150747935, -100.3570879350106, -116.283309618632, -102.14893832802773, -114.60861593484879, -103.89806061983109, -114.97353998819987, -98.63874724010627, -99.69359425703685, -103.15604336559772, -104.04043301939964, -118.82201910018921, -112.49302903811137, -95.89293027917545, -96.67683104674022, -118.3564656774203, -105.78099859754245, -104.25305312375228, -10.480384416878223, -12.11930826306343, -12.043643593788147, -115.02001045147578, -102.05536438028018, -100.78422510872285, -116.61056907971701, -98.42555440853661, -101.10821606715521, -12.350947320461273, -13.303099483251572, -11.272300895303488, -120.0602320432663, -109.19230169057846, -110.5663458108902, -102.21251258254051, -101.74812906980515, -114.09860754013062, -93.4081657032172, -95.41095612446468, -108.81087748209636, -112.53993920485179, -96.15255563954513, -95.20754897470276, -102.46839784582457, -115.02251662810644, -104.07176353534064, -110.40270433823268, -96.95739314953487, -97.0928616921107, -93.3128962914149, -97.41706887880962, -108.82787863413493, -108.38970858852069, -122.2322374979655, -109.27374813954036, -16.062253057956696, -16.017587274312973, -15.604889119043946, -100.0318229260544, -102.34594414631526, -115.62091747919719, -100.96902606884639, -114.70636157194774, -100.17043782273929, -114.43426557381949, -97.07993042453504, -97.71703519423804, -118.72716234872739, -120.08028088013332, -137.04761056105298, -114.14245736598969, -101.46273386478424, -100.96455407142639, -96.36366885403793, -99.8682547012965, -96.35121908287208, -107.253403455019, -107.84345024824142, -121.00948119163513, -116.84891903400421, -101.90350288152695, -103.41906541585922, -117.06333692868552, -101.43630426128706, -103.21490611632666, -104.49846895535788, -103.91939493020377, -116.43260868390402, -108.42258849740028, -120.97533696889877, -106.81822923570871, -101.06302084525427, -99.52373521526656, -113.4374061425527, -215.8989136616389, -196.78608849147955, -198.50637785593668, -115.35902913411459, -100.20431603988013, -99.84150659044585, 2.179016490777329, 2.397950758536652, 3.1229699974258693, -110.243289321661, -122.86637306213379, -111.77627325057983, -98.65086402495703, -97.96434852977595, -118.04862078030905, -109.10268657406172, -123.01862366994223, -110.15816338857016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17116824125163663, "mean_inference_ms": 0.6724475609486561, "mean_action_processing_ms": 0.09810754694181015, "mean_env_wait_ms": 0.7929341776324079, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 81600, "timesteps_this_iter": 0, "agent_timesteps_total": 244800, "timers": {"sample_time_ms": 9672.148, "sample_throughput": 496.27, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1247.72, "learn_throughput": 3847.018, "update_time_ms": 1.267}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 2209.1836853027344, "policy_loss": -0.003482189780301681, "vf_loss": 2209.246795654297, "vf_explained_var": 0.004726104438304901, "kl": 0.006163396414197637, "entropy": 5.9666372537612915, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 81600, "num_agent_steps_sampled": 244800, "num_steps_trained": 81600, "num_agent_steps_trained": 244800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 976, "training_iteration": 17, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-45-20", "timestamp": 1706147120, "time_this_iter_s": 9.605218172073364, "time_total_s": 163.24571681022644, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C16820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 163.24571681022644, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 8.535714285714286, "ram_util_percent": 44.192857142857136}}
{"episode_reward_max": 33.06329452991483, "episode_reward_min": -621.343785867095, "episode_reward_mean": -284.4156753665162, "episode_len_mean": 104.02, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {"shared_policy": -216.69251505533856}, "policy_reward_max": {"shared_policy": 11.046608592073113}, "policy_reward_mean": {"shared_policy": -94.80522512217208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-322.3345754146576, -21.018659383058576, -321.3276179805398, -312.61992125213146, -310.1428255313076, -320.4109317138791, -355.23573368787766, -306.6251197606325, -293.3312507420779, -310.6619805917144, -50.76173061132434, -317.4611853808165, -303.6662941426039, -324.94341675937176, -329.17777612805367, -321.6519056092948, -284.8132767379284, -331.5742201283574, -328.052541255951, -317.86935906112194, -320.6556148827076, -313.305881485343, -326.0184954851866, -305.062790364027, -328.390517398715, -34.6433362737298, -317.8595999404788, -316.1443395554088, -36.92634769901633, -339.81887954473495, -318.0592491924763, -297.6299993097782, -303.90004381909966, -321.5626780092716, -304.45295917987823, -299.55784380435944, -339.8956942260266, -47.684729451313615, -317.99868455156684, -315.8458254635334, -309.23123119259253, -375.85505378991365, -316.5697453022003, -292.5831426382065, -336.10633489489555, -322.1714873313904, -321.7145473062992, -324.85047256946564, -336.21615470200777, -314.0241622030735, -611.1913800090551, -315.40485176444054, 7.69993724673985, -344.8859356343746, -314.66383333504206, -342.2794736325741, -311.38100872933865, -325.528400875628, -293.1413847375661, -73.47851365804672, -310.4758803471923, -319.6968252765946, -326.9670378863812, -322.1879837214947, -329.35794157162314, -338.66461609164253, -315.2949950993061, -336.275738067925, -282.4273491501809, -320.4338655769825, -300.93620834406465, 25.890983134508105, -3.4637134522199915, -19.251024827361135, -326.80380350351334, -306.78087375313044, -309.71923622488976, -29.419842824339895, -303.463268622756, -320.09048967063427, -331.3828702867031, -310.03527814149857, -329.991754738614, -288.3039056584239, 33.06329452991483, 13.604938775300951, -318.7284081205726, -314.30083099752665, -621.343785867095, -327.1636832654476, -297.8563975840807, -281.76521307229996, -290.59229685366154, -317.2160175293684, -317.05362037569284, -317.768068253994, -339.366681098938, -288.6406006515026, -302.2791438922286, -335.9564941227436], "episode_lengths": [57, 300, 68, 72, 56, 100, 194, 64, 104, 71, 300, 65, 77, 63, 59, 62, 127, 63, 50, 62, 54, 74, 64, 50, 127, 300, 43, 47, 300, 57, 45, 74, 71, 42, 87, 86, 77, 300, 47, 58, 54, 260, 61, 64, 95, 74, 51, 83, 115, 50, 53, 69, 300, 82, 84, 63, 63, 60, 65, 300, 85, 62, 58, 40, 66, 89, 71, 111, 81, 60, 99, 300, 300, 300, 57, 168, 63, 300, 70, 61, 75, 64, 65, 71, 300, 300, 116, 58, 66, 54, 118, 76, 105, 35, 68, 52, 56, 82, 74, 63], "policy_shared_policy_reward": [-101.73979115486145, -104.25201785564423, -116.34276640415192, -6.927038302024215, -6.523279120524734, -7.568341960509628, -102.42816204577684, -115.64086800813675, -103.2585879266262, -113.68916364510855, -98.46685329576334, -100.4639043112596, -97.22991158301011, -97.85212126374245, -115.06079268455505, -101.49736685305834, -103.0192899107933, -115.89427495002747, -126.71703100204468, -112.87235021591187, -115.64635246992111, -97.02723275125027, -111.54601085186005, -98.0518761575222, -107.41477711995444, -93.11497240265211, -92.8015012194713, -113.10227457682292, -98.61521702508132, -98.94448898981015, -17.07050093015036, -17.60747425754866, -16.08375542362532, -103.04846872886023, -98.88133806486925, -115.531378587087, -113.62572511037192, -95.21866296728453, -94.82190606494746, -103.82436520357928, -117.77359559138617, -103.34545596440634, -104.00397126873335, -119.05849476655325, -106.11531009276709, -103.84671857953072, -101.64474086277187, -116.16044616699219, -104.53454685211182, -90.61476451158524, -89.66396537423134, -120.9961405992508, -102.80345792323351, -107.77462160587311, -105.12494124968848, -119.12404723962149, -103.80355276664099, -101.22896150747935, -100.3570879350106, -116.283309618632, -102.14893832802773, -114.60861593484879, -103.89806061983109, -114.97353998819987, -98.63874724010627, -99.69359425703685, -103.15604336559772, -104.04043301939964, -118.82201910018921, -112.49302903811137, -95.89293027917545, -96.67683104674022, -118.3564656774203, -105.78099859754245, -104.25305312375228, -10.480384416878223, -12.11930826306343, -12.043643593788147, -115.02001045147578, -102.05536438028018, -100.78422510872285, -116.61056907971701, -98.42555440853661, -101.10821606715521, -12.350947320461273, -13.303099483251572, -11.272300895303488, -120.0602320432663, -109.19230169057846, -110.5663458108902, -102.21251258254051, -101.74812906980515, -114.09860754013062, -93.4081657032172, -95.41095612446468, -108.81087748209636, -112.53993920485179, -96.15255563954513, -95.20754897470276, -102.46839784582457, -115.02251662810644, -104.07176353534064, -110.40270433823268, -96.95739314953487, -97.0928616921107, -93.3128962914149, -97.41706887880962, -108.82787863413493, -108.38970858852069, -122.2322374979655, -109.27374813954036, -16.062253057956696, -16.017587274312973, -15.604889119043946, -100.0318229260544, -102.34594414631526, -115.62091747919719, -100.96902606884639, -114.70636157194774, -100.17043782273929, -114.43426557381949, -97.07993042453504, -97.71703519423804, -118.72716234872739, -120.08028088013332, -137.04761056105298, -114.14245736598969, -101.46273386478424, -100.96455407142639, -96.36366885403793, -99.8682547012965, -96.35121908287208, -107.253403455019, -107.84345024824142, -121.00948119163513, -116.84891903400421, -101.90350288152695, -103.41906541585922, -117.06333692868552, -101.43630426128706, -103.21490611632666, -104.49846895535788, -103.91939493020377, -116.43260868390402, -108.42258849740028, -120.97533696889877, -106.81822923570871, -101.06302084525427, -99.52373521526656, -113.4374061425527, -215.8989136616389, -196.78608849147955, -198.50637785593668, -115.35902913411459, -100.20431603988013, -99.84150659044585, 2.179016490777329, 2.397950758536652, 3.1229699974258693, -110.243289321661, -122.86637306213379, -111.77627325057983, -98.65086402495703, -97.96434852977595, -118.04862078030905, -109.10268657406172, -123.01862366994223, -110.15816338857016, -99.68963276346526, -113.83579250176749, -97.85558346410593, -104.7038996219635, -117.77817279100418, -103.04632846266031, -95.55989058005314, -96.59157481292884, -100.98991934458415, -23.71782749891282, -24.67796817421914, -25.082717984914787, -99.89630228281021, -112.05128586292267, -98.52829220145941, -101.12484369256224, -101.30854451159637, -117.26343707243602, -116.93820103009543, -104.8601844807466, -105.16865237553915, -116.35706808169684, -102.91829418142638, -102.91262145837149, -104.52780252074203, -118.13662077983221, -106.69351827104887, -107.28272855638838, -122.17508377631506, -109.20680375893912, -103.85925122102103, -113.88863094647726, -97.54711293180785, -121.73711001873016, -107.89307966828346, -106.64554838091135, -102.32956381638846, -88.5911148985227, -91.50667043526968, -116.26151907444, -102.7155673801899, -101.4567791223526, -109.53334152698517, -94.50779942329973, -96.89506739377975, 8.267460296551377, 8.207363317410142, 9.416159520546586, -1.6856942077477868, -0.6386968990167077, -1.139322345455497, -6.698792015512794, -6.4499920954307015, -6.10224071641764, -105.20143550634384, -104.85776376724243, -116.74460422992706, -96.2806643024087, -97.34050726890564, -113.1597021818161, -98.9212594528993, -98.90675749381384, -111.89121927817664, -9.157958855231612, -9.241488729914039, -11.020395239194244, -97.19193954269092, -110.07495943705241, -96.19636964301269, -115.68537147839865, -102.19344029327235, -102.2116778989633, -119.25952049096426, -106.95033611853918, -105.17301367719969, -98.44465790192287, -112.06616846720378, -99.52445177237193, -118.99441703160605, -103.82053123724958, -107.17680646975836, -93.72998420397441, -88.41236517081659, -106.16155628363292, 11.026495488981396, 11.046608592073113, 10.990190448860318, 3.977192992965371, 4.877103621760995, 4.750642160574586, -101.83424119402966, -114.75692786773047, -102.13723905881247, -99.6712580199043, -114.07966415087382, -100.54990882674853, -216.69251505533856, -202.22970944146317, -202.42156137029332, -103.99114003280799, -103.7408684740464, -119.43167475859325, -108.44010488192241, -95.18995539347331, -94.22633730868499, -102.88167111078899, -90.34296266237895, -88.54057929913203, -100.09379398822784, -94.62234561145306, -95.87615725398064, -100.95147817830245, -101.83772034446399, -114.42681900660197, -100.16985563188791, -101.72081851959229, -115.16294622421265, -114.98172946770987, -100.02026089032492, -102.76607789595923, -111.8725423415502, -120.44574602444968, -107.04839273293814, -92.39689843853316, -92.31212766965231, -103.93157454331717, -93.48267630984387, -110.74152847131094, -98.05493911107382, -120.22191884120306, -108.03738894065222, -107.69718634088835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17024497659762616, "mean_inference_ms": 0.6710204911094132, "mean_action_processing_ms": 0.09792398268628488, "mean_env_wait_ms": 0.7926567023361892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 259200, "timers": {"sample_time_ms": 9590.7, "sample_throughput": 500.485, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1233.149, "learn_throughput": 3892.474, "update_time_ms": 1.268}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 1808.201644897461, "policy_loss": -0.0028917665183283425, "vf_loss": 1808.2647094726562, "vf_explained_var": 0.0069862231612205505, "kl": 0.007355863264823204, "entropy": 6.022722780704498, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 259200, "num_steps_trained": 86400, "num_agent_steps_trained": 259200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1020, "training_iteration": 18, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-45-29", "timestamp": 1706147129, "time_this_iter_s": 9.002337217330933, "time_total_s": 172.24805402755737, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100054C280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 172.24805402755737, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 44.25384615384615}}
{"episode_reward_max": 33.06329452991483, "episode_reward_min": -621.343785867095, "episode_reward_mean": -278.11570502753136, "episode_len_mean": 110.02, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {"shared_policy": -216.69251505533856}, "policy_reward_max": {"shared_policy": 11.046608592073113}, "policy_reward_mean": {"shared_policy": -92.70523500917712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-375.85505378991365, -316.5697453022003, -292.5831426382065, -336.10633489489555, -322.1714873313904, -321.7145473062992, -324.85047256946564, -336.21615470200777, -314.0241622030735, -611.1913800090551, -315.40485176444054, 7.69993724673985, -344.8859356343746, -314.66383333504206, -342.2794736325741, -311.38100872933865, -325.528400875628, -293.1413847375661, -73.47851365804672, -310.4758803471923, -319.6968252765946, -326.9670378863812, -322.1879837214947, -329.35794157162314, -338.66461609164253, -315.2949950993061, -336.275738067925, -282.4273491501809, -320.4338655769825, -300.93620834406465, 25.890983134508105, -3.4637134522199915, -19.251024827361135, -326.80380350351334, -306.78087375313044, -309.71923622488976, -29.419842824339895, -303.463268622756, -320.09048967063427, -331.3828702867031, -310.03527814149857, -329.991754738614, -288.3039056584239, 33.06329452991483, 13.604938775300951, -318.7284081205726, -314.30083099752665, -621.343785867095, -327.1636832654476, -297.8563975840807, -281.76521307229996, -290.59229685366154, -317.2160175293684, -317.05362037569284, -317.768068253994, -339.366681098938, -288.6406006515026, -302.2791438922286, -335.9564941227436, -303.91147616505623, -4.351043522357941, -1.6442023366689682, -317.81064143776894, -323.96843084692955, -323.8589262366295, -302.4887363910675, -307.89226937294006, -324.7013970166445, -315.4763856828213, -314.57421396672726, -321.54349821805954, -309.7017982304096, -339.3549766987562, -327.4604301676154, -8.542243003845215, -321.2829193174839, -321.8760654479265, -27.945565335452557, -330.8615262210369, -326.74105973541737, -327.79054732620716, -308.601769156754, -289.8322094529867, -291.60097348690033, -314.74323398899287, -3.4387535452842855, -317.3588945120573, -46.898581415414824, -336.3671335950494, -330.84780544042593, -341.8660348802805, -328.20902717113495, -295.8300415351987, -316.89651703089476, -326.63984966278076, -337.7433609627187, -32.52525459975007, -324.5692020356655, -320.7920923146885, -299.78894133865833], "episode_lengths": [260, 61, 64, 95, 74, 51, 83, 115, 50, 53, 69, 300, 82, 84, 63, 63, 60, 65, 300, 85, 62, 58, 40, 66, 89, 71, 111, 81, 60, 99, 300, 300, 300, 57, 168, 63, 300, 70, 61, 75, 64, 65, 71, 300, 300, 116, 58, 66, 54, 118, 76, 105, 35, 68, 52, 56, 82, 74, 63, 152, 300, 300, 37, 64, 84, 86, 67, 55, 56, 43, 96, 73, 112, 65, 300, 91, 75, 300, 74, 68, 58, 58, 83, 73, 47, 300, 76, 300, 89, 83, 169, 76, 58, 66, 69, 93, 300, 65, 57, 53], "policy_shared_policy_reward": [-118.72716234872739, -120.08028088013332, -137.04761056105298, -114.14245736598969, -101.46273386478424, -100.96455407142639, -96.36366885403793, -99.8682547012965, -96.35121908287208, -107.253403455019, -107.84345024824142, -121.00948119163513, -116.84891903400421, -101.90350288152695, -103.41906541585922, -117.06333692868552, -101.43630426128706, -103.21490611632666, -104.49846895535788, -103.91939493020377, -116.43260868390402, -108.42258849740028, -120.97533696889877, -106.81822923570871, -101.06302084525427, -99.52373521526656, -113.4374061425527, -215.8989136616389, -196.78608849147955, -198.50637785593668, -115.35902913411459, -100.20431603988013, -99.84150659044585, 2.179016490777329, 2.397950758536652, 3.1229699974258693, -110.243289321661, -122.86637306213379, -111.77627325057983, -98.65086402495703, -97.96434852977595, -118.04862078030905, -109.10268657406172, -123.01862366994223, -110.15816338857016, -99.68963276346526, -113.83579250176749, -97.85558346410593, -104.7038996219635, -117.77817279100418, -103.04632846266031, -95.55989058005314, -96.59157481292884, -100.98991934458415, -23.71782749891282, -24.67796817421914, -25.082717984914787, -99.89630228281021, -112.05128586292267, -98.52829220145941, -101.12484369256224, -101.30854451159637, -117.26343707243602, -116.93820103009543, -104.8601844807466, -105.16865237553915, -116.35706808169684, -102.91829418142638, -102.91262145837149, -104.52780252074203, -118.13662077983221, -106.69351827104887, -107.28272855638838, -122.17508377631506, -109.20680375893912, -103.85925122102103, -113.88863094647726, -97.54711293180785, -121.73711001873016, -107.89307966828346, -106.64554838091135, -102.32956381638846, -88.5911148985227, -91.50667043526968, -116.26151907444, -102.7155673801899, -101.4567791223526, -109.53334152698517, -94.50779942329973, -96.89506739377975, 8.267460296551377, 8.207363317410142, 9.416159520546586, -1.6856942077477868, -0.6386968990167077, -1.139322345455497, -6.698792015512794, -6.4499920954307015, -6.10224071641764, -105.20143550634384, -104.85776376724243, -116.74460422992706, -96.2806643024087, -97.34050726890564, -113.1597021818161, -98.9212594528993, -98.90675749381384, -111.89121927817664, -9.157958855231612, -9.241488729914039, -11.020395239194244, -97.19193954269092, -110.07495943705241, -96.19636964301269, -115.68537147839865, -102.19344029327235, -102.2116778989633, -119.25952049096426, -106.95033611853918, -105.17301367719969, -98.44465790192287, -112.06616846720378, -99.52445177237193, -118.99441703160605, -103.82053123724958, -107.17680646975836, -93.72998420397441, -88.41236517081659, -106.16155628363292, 11.026495488981396, 11.046608592073113, 10.990190448860318, 3.977192992965371, 4.877103621760995, 4.750642160574586, -101.83424119402966, -114.75692786773047, -102.13723905881247, -99.6712580199043, -114.07966415087382, -100.54990882674853, -216.69251505533856, -202.22970944146317, -202.42156137029332, -103.99114003280799, -103.7408684740464, -119.43167475859325, -108.44010488192241, -95.18995539347331, -94.22633730868499, -102.88167111078899, -90.34296266237895, -88.54057929913203, -100.09379398822784, -94.62234561145306, -95.87615725398064, -100.95147817830245, -101.83772034446399, -114.42681900660197, -100.16985563188791, -101.72081851959229, -115.16294622421265, -114.98172946770987, -100.02026089032492, -102.76607789595923, -111.8725423415502, -120.44574602444968, -107.04839273293814, -92.39689843853316, -92.31212766965231, -103.93157454331717, -93.48267630984387, -110.74152847131094, -98.05493911107382, -120.22191884120306, -108.03738894065222, -107.69718634088835, -110.02263323465984, -96.98315651218097, -96.90568641821544, -2.3147521317005157, -1.350456416606903, -0.6858349740505219, -0.44628816843032837, -0.47864194214344025, -0.7192722260951996, -101.93159304062526, -101.5783659319083, -114.3006824652354, -105.08564966917038, -115.90442287921906, -102.97835829854012, -104.26974945267042, -116.28440268834433, -103.30477409561476, -90.82424179712932, -105.93796328703563, -105.72653130690257, -97.33958796660106, -111.82116941610973, -98.7315119902293, -103.54834053913753, -103.5024191091458, -117.65063736836116, -100.51112444202106, -114.38900129000346, -100.57625995079677, -100.29627980291843, -113.8210608959198, -100.45687326788902, -101.16385326782863, -101.89103261629741, -118.48861233393352, -113.74684874216716, -98.68734020988147, -97.26760927836101, -108.02144088285665, -123.25416378180186, -108.07937203409772, -118.34644623597464, -105.5170967479547, -103.5968871836861, -3.8480485677719116, -2.9054172039031982, -1.788777232170105, -115.85614287853241, -102.21506336331367, -103.21171307563782, -103.72278439998627, -116.64945828914642, -101.50382275879383, -9.4270731061697, -9.66678011417389, -8.851712115108967, -105.97239800294241, -104.84404795368513, -120.04508026440939, -103.90274574855964, -105.08327973882358, -117.75503424803416, -118.82597692807516, -102.76636854310831, -106.19820185502371, -98.31492296854655, -95.94528506944577, -114.3415611187617, -106.34505208333334, -92.24360447128615, -91.24355289836726, -103.15397288401923, -92.90956344207129, -95.53743716080984, -115.58561027050018, -99.96145948767662, -99.19616423081607, -1.345546687642738, -0.9553027848402706, -1.1379040728012768, -101.40288947025935, -100.1778208265702, -115.77818421522777, -14.865500191847488, -15.789773623148605, -16.24330760041873, -120.04077980915706, -105.96966846535604, -110.3566853205363, -118.30747177203497, -106.06142734487852, -106.4789063235124, -110.60470002889633, -109.35347492992878, -121.90785992145538, -105.80299441019694, -104.96529553333919, -117.44073722759883, -93.75192085653543, -106.93705028295517, -95.14107039570808, -99.66484029342732, -115.83136626084647, -101.400310476621, -119.20495235919952, -103.54005867242813, -103.8948386311531, -109.75744155049324, -120.01108852028847, -107.97483089193702, -10.904605289300292, -9.815311891337245, -11.805337419112533, -119.23808121681213, -102.46917048096657, -102.86195033788681, -117.80216538906097, -100.47685479256324, -102.51307213306427, -98.12164591252804, -98.36359688639641, -103.30369853973389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16921867866964221, "mean_inference_ms": 0.6688762769985124, "mean_action_processing_ms": 0.09783870307105474, "mean_env_wait_ms": 0.7917842193969039, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 91200, "timesteps_this_iter": 0, "agent_timesteps_total": 273600, "timers": {"sample_time_ms": 9457.089, "sample_throughput": 507.556, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1215.015, "learn_throughput": 3950.569, "update_time_ms": 1.268}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 1501.5365600585938, "policy_loss": -0.0030045947054169186, "vf_loss": 1501.598861694336, "vf_explained_var": 0.007604427635669708, "kl": 0.006525722114023304, "entropy": 5.931327700614929, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 91200, "num_agent_steps_sampled": 273600, "num_steps_trained": 91200, "num_agent_steps_trained": 273600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1061, "training_iteration": 19, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-45-38", "timestamp": 1706147138, "time_this_iter_s": 9.10741376876831, "time_total_s": 181.35546779632568, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100053C790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 181.35546779632568, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 6.176923076923078, "ram_util_percent": 44.25384615384615}}
{"episode_reward_max": 1.3915626257658005, "episode_reward_min": -609.9310020422563, "episode_reward_mean": -282.30463063078116, "episode_len_mean": 103.07, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {"shared_policy": -213.37406452496847}, "policy_reward_max": {"shared_policy": 0.8938426375389099}, "policy_reward_mean": {"shared_policy": -94.10154354359372}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-297.8563975840807, -281.76521307229996, -290.59229685366154, -317.2160175293684, -317.05362037569284, -317.768068253994, -339.366681098938, -288.6406006515026, -302.2791438922286, -335.9564941227436, -303.91147616505623, -4.351043522357941, -1.6442023366689682, -317.81064143776894, -323.96843084692955, -323.8589262366295, -302.4887363910675, -307.89226937294006, -324.7013970166445, -315.4763856828213, -314.57421396672726, -321.54349821805954, -309.7017982304096, -339.3549766987562, -327.4604301676154, -8.542243003845215, -321.2829193174839, -321.8760654479265, -27.945565335452557, -330.8615262210369, -326.74105973541737, -327.79054732620716, -308.601769156754, -289.8322094529867, -291.60097348690033, -314.74323398899287, -3.4387535452842855, -317.3588945120573, -46.898581415414824, -336.3671335950494, -330.84780544042593, -341.8660348802805, -328.20902717113495, -295.8300415351987, -316.89651703089476, -326.63984966278076, -337.7433609627187, -32.52525459975007, -324.5692020356655, -320.7920923146885, -299.78894133865833, -24.562430208548932, -281.4853480756283, -310.8938523121178, -335.70199969410896, -319.75235390663147, -325.44962276518345, -310.36114460229874, -6.2304542735219, -19.976670708507314, -609.9310020422563, -304.76308089494705, -317.5443203449249, -313.80839627981186, -23.555478657013737, -601.9269412308931, -310.1284925788641, -296.84431952238083, -314.48807471990585, -309.3925842195749, -293.0145723223686, -297.13188354671, -311.38456746935844, -315.4877036064863, -321.8177600800991, -321.5335766598582, 1.3915626257658005, -293.5786053556949, -286.39380103349686, -306.2535783648491, -336.0248446986079, -324.28040343523026, -289.5186017230153, -330.7020260095597, -289.3051089793444, -303.47816053032875, -323.87420461606234, -323.8069424778223, -322.25170154869556, -322.98361986875534, -325.6304939985275, -333.13974249362946, -322.2649112045765, -291.97023913264275, -330.0079157650471, -308.49017587304115, -333.03376268595457, -303.2566371932626, -49.68806633353236, -327.9318894222379], "episode_lengths": [118, 76, 105, 35, 68, 52, 56, 82, 74, 63, 152, 300, 300, 37, 64, 84, 86, 67, 55, 56, 43, 96, 73, 112, 65, 300, 91, 75, 300, 74, 68, 58, 58, 83, 73, 47, 300, 76, 300, 89, 83, 169, 76, 58, 66, 69, 93, 300, 65, 57, 53, 300, 88, 47, 57, 44, 59, 50, 300, 300, 67, 89, 56, 74, 300, 64, 72, 76, 40, 55, 59, 133, 52, 72, 42, 72, 300, 75, 66, 76, 55, 59, 67, 87, 101, 72, 58, 50, 80, 47, 58, 138, 61, 78, 59, 71, 100, 173, 300, 108], "policy_shared_policy_reward": [-108.44010488192241, -95.18995539347331, -94.22633730868499, -102.88167111078899, -90.34296266237895, -88.54057929913203, -100.09379398822784, -94.62234561145306, -95.87615725398064, -100.95147817830245, -101.83772034446399, -114.42681900660197, -100.16985563188791, -101.72081851959229, -115.16294622421265, -114.98172946770987, -100.02026089032492, -102.76607789595923, -111.8725423415502, -120.44574602444968, -107.04839273293814, -92.39689843853316, -92.31212766965231, -103.93157454331717, -93.48267630984387, -110.74152847131094, -98.05493911107382, -120.22191884120306, -108.03738894065222, -107.69718634088835, -110.02263323465984, -96.98315651218097, -96.90568641821544, -2.3147521317005157, -1.350456416606903, -0.6858349740505219, -0.44628816843032837, -0.47864194214344025, -0.7192722260951996, -101.93159304062526, -101.5783659319083, -114.3006824652354, -105.08564966917038, -115.90442287921906, -102.97835829854012, -104.26974945267042, -116.28440268834433, -103.30477409561476, -90.82424179712932, -105.93796328703563, -105.72653130690257, -97.33958796660106, -111.82116941610973, -98.7315119902293, -103.54834053913753, -103.5024191091458, -117.65063736836116, -100.51112444202106, -114.38900129000346, -100.57625995079677, -100.29627980291843, -113.8210608959198, -100.45687326788902, -101.16385326782863, -101.89103261629741, -118.48861233393352, -113.74684874216716, -98.68734020988147, -97.26760927836101, -108.02144088285665, -123.25416378180186, -108.07937203409772, -118.34644623597464, -105.5170967479547, -103.5968871836861, -3.8480485677719116, -2.9054172039031982, -1.788777232170105, -115.85614287853241, -102.21506336331367, -103.21171307563782, -103.72278439998627, -116.64945828914642, -101.50382275879383, -9.4270731061697, -9.66678011417389, -8.851712115108967, -105.97239800294241, -104.84404795368513, -120.04508026440939, -103.90274574855964, -105.08327973882358, -117.75503424803416, -118.82597692807516, -102.76636854310831, -106.19820185502371, -98.31492296854655, -95.94528506944577, -114.3415611187617, -106.34505208333334, -92.24360447128615, -91.24355289836726, -103.15397288401923, -92.90956344207129, -95.53743716080984, -115.58561027050018, -99.96145948767662, -99.19616423081607, -1.345546687642738, -0.9553027848402706, -1.1379040728012768, -101.40288947025935, -100.1778208265702, -115.77818421522777, -14.865500191847488, -15.789773623148605, -16.24330760041873, -120.04077980915706, -105.96966846535604, -110.3566853205363, -118.30747177203497, -106.06142734487852, -106.4789063235124, -110.60470002889633, -109.35347492992878, -121.90785992145538, -105.80299441019694, -104.96529553333919, -117.44073722759883, -93.75192085653543, -106.93705028295517, -95.14107039570808, -99.66484029342732, -115.83136626084647, -101.400310476621, -119.20495235919952, -103.54005867242813, -103.8948386311531, -109.75744155049324, -120.01108852028847, -107.97483089193702, -10.904605289300292, -9.815311891337245, -11.805337419112533, -119.23808121681213, -102.46917048096657, -102.86195033788681, -117.80216538906097, -100.47685479256324, -102.51307213306427, -98.12164591252804, -98.36359688639641, -103.30369853973389, -7.765953402345389, -8.227568512161582, -8.568908294041961, -87.70533289512, -105.15275712807974, -88.62725805242857, -115.62932089964549, -97.49046317363779, -97.77406823883454, -106.86301758885384, -106.61241686344147, -122.22656524181366, -101.98201533158621, -115.05003627141318, -102.72030230363211, -116.42056588331859, -104.01737761000793, -105.01167927185695, -113.88590506712596, -98.4193623761336, -98.05587715903918, -2.048399180173874, -2.191109463572502, -1.9909456297755241, -6.72812792907159, -6.476729227850839, -6.771813551584884, -195.79851911620548, -213.37406452496847, -200.75841840108237, -97.85097776850066, -109.64570357402167, -97.26639955242476, -101.70494108398756, -101.46337627371153, -114.37600298722586, -114.45473178227743, -99.90859798093638, -99.44506651659808, -8.049451008439064, -7.933558344841003, -7.572469303733669, -211.38769324620566, -195.57049829264483, -194.96874969204268, -98.47897065679233, -97.6064658711354, -114.04305605093639, -94.78130920728049, -108.00586714347205, -94.05714317162833, -113.88366051514944, -100.66089906295142, -99.94351514180502, -103.6740625500679, -101.49221999943256, -104.22630167007446, -93.60318886240324, -105.59058399995169, -93.82079946001372, -93.86802307267985, -107.81041367848715, -95.45344679554304, -112.1834127108256, -99.9115168551604, -99.28963790337245, -102.55609015623729, -113.46120069424312, -99.47041275600593, -103.6742471853892, -115.51192812124889, -102.63158477346103, -116.95780634880066, -102.7741564810276, -101.80161383002996, -0.06356918811798096, 0.5612891763448715, 0.8938426375389099, -96.6156314133356, -97.30095000068347, -99.66202394167583, -93.9548587501049, -94.23062261939049, -98.20831966400146, -109.8277975122134, -97.53104428450267, -98.89473656813304, -108.05521714687347, -106.54642610996962, -121.42320144176483, -104.79506602883339, -116.7725065946579, -102.71283081173897, -95.2204166278243, -95.46844701468945, -98.82973808050156, -118.743559161822, -105.65899316469829, -106.29947368303935, -105.87459429105124, -91.13993368049464, -92.29058100779852, -98.13949054479599, -108.30922490358353, -97.02944508194923, -117.24277315537135, -102.75714946320902, -103.87428199748199, -116.6826597849528, -101.70200484494369, -105.42227784792583, -109.5511652181546, -111.22076217333476, -101.47977415720622, -115.98203519980113, -103.05272529522578, -103.94885937372844, -117.90022877852122, -102.91723428169887, -104.81303093830745, -121.34257968266806, -106.12875643869242, -105.668406372269, -116.08608537912369, -102.66571888327599, -103.51310694217682, -92.91367828845978, -107.51323878765106, -91.5433220565319, -105.42648900548618, -105.25643918911616, -119.32498757044475, -98.53466335932414, -111.21627602974574, -98.73923648397128, -106.40597285081944, -119.94565208752951, -106.68213774760565, -112.3343833287557, -95.93099166949591, -94.99126219501099, -16.139752273758262, -17.752468516429275, -15.795845543344825, -105.47882092992465, -117.9393845597903, -104.51368393252294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.167887236779273, "mean_inference_ms": 0.6660823281499259, "mean_action_processing_ms": 0.09773124538540008, "mean_env_wait_ms": 0.7903323968696097, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 9321.831, "sample_throughput": 514.92, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1212.671, "learn_throughput": 3958.206, "update_time_ms": 1.168}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 2199.849639892578, "policy_loss": -0.0034263387473442153, "vf_loss": 2199.91259765625, "vf_explained_var": 0.003910958766937256, "kl": 0.0068057477692528, "entropy": 5.946132719516754, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 288000, "num_steps_trained": 96000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1110, "training_iteration": 20, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-45-47", "timestamp": 1706147147, "time_this_iter_s": 8.934977293014526, "time_total_s": 190.2904450893402, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 190.2904450893402, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 6.916666666666668, "ram_util_percent": 44.26666666666667}}
{"episode_reward_max": 15.279295302927494, "episode_reward_min": -609.9310020422563, "episode_reward_mean": -265.94153614949084, "episode_len_mean": 118.02, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -213.37406452496847}, "policy_reward_max": {"shared_policy": 5.452664323151112}, "policy_reward_mean": {"shared_policy": -88.64717871649695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289.8322094529867, -291.60097348690033, -314.74323398899287, -3.4387535452842855, -317.3588945120573, -46.898581415414824, -336.3671335950494, -330.84780544042593, -341.8660348802805, -328.20902717113495, -295.8300415351987, -316.89651703089476, -326.63984966278076, -337.7433609627187, -32.52525459975007, -324.5692020356655, -320.7920923146885, -299.78894133865833, -24.562430208548932, -281.4853480756283, -310.8938523121178, -335.70199969410896, -319.75235390663147, -325.44962276518345, -310.36114460229874, -6.2304542735219, -19.976670708507314, -609.9310020422563, -304.76308089494705, -317.5443203449249, -313.80839627981186, -23.555478657013737, -601.9269412308931, -310.1284925788641, -296.84431952238083, -314.48807471990585, -309.3925842195749, -293.0145723223686, -297.13188354671, -311.38456746935844, -315.4877036064863, -321.8177600800991, -321.5335766598582, 1.3915626257658005, -293.5786053556949, -286.39380103349686, -306.2535783648491, -336.0248446986079, -324.28040343523026, -289.5186017230153, -330.7020260095597, -289.3051089793444, -303.47816053032875, -323.87420461606234, -323.8069424778223, -322.25170154869556, -322.98361986875534, -325.6304939985275, -333.13974249362946, -322.2649112045765, -291.97023913264275, -330.0079157650471, -308.49017587304115, -333.03376268595457, -303.2566371932626, -49.68806633353236, -327.9318894222379, -332.8998167193495, -16.82536792382598, 6.552384179085479, -325.6335740238428, -295.77180081605917, 0.30742475390431423, -339.82555393874645, -292.30155719816685, -321.46723948419094, -313.6305198967457, -46.44631544500592, -39.14048494026066, -332.9482508599758, -327.3163474574685, -325.11559596657753, -303.84112161397934, -307.002661973238, 15.279295302927494, -323.5173407010734, -340.3213454335928, -37.84837333112955, -321.2797643095255, -319.78828006982803, -341.61924785375595, -33.48583789169791, -321.2881283201277, -323.08911547064787, -329.27885922789574, -328.9091007448733, -7.779397413134603, -313.3148173317313, -326.2256701402366, 1.2071751207113266], "episode_lengths": [83, 73, 47, 300, 76, 300, 89, 83, 169, 76, 58, 66, 69, 93, 300, 65, 57, 53, 300, 88, 47, 57, 44, 59, 50, 300, 300, 67, 89, 56, 74, 300, 64, 72, 76, 40, 55, 59, 133, 52, 72, 42, 72, 300, 75, 66, 76, 55, 59, 67, 87, 101, 72, 58, 50, 80, 47, 58, 138, 61, 78, 59, 71, 100, 173, 300, 108, 81, 300, 300, 81, 190, 300, 61, 54, 62, 58, 300, 300, 50, 63, 116, 78, 55, 300, 61, 167, 300, 90, 97, 63, 300, 42, 51, 59, 72, 300, 57, 130, 300], "policy_shared_policy_reward": [-106.34505208333334, -92.24360447128615, -91.24355289836726, -103.15397288401923, -92.90956344207129, -95.53743716080984, -115.58561027050018, -99.96145948767662, -99.19616423081607, -1.345546687642738, -0.9553027848402706, -1.1379040728012768, -101.40288947025935, -100.1778208265702, -115.77818421522777, -14.865500191847488, -15.789773623148605, -16.24330760041873, -120.04077980915706, -105.96966846535604, -110.3566853205363, -118.30747177203497, -106.06142734487852, -106.4789063235124, -110.60470002889633, -109.35347492992878, -121.90785992145538, -105.80299441019694, -104.96529553333919, -117.44073722759883, -93.75192085653543, -106.93705028295517, -95.14107039570808, -99.66484029342732, -115.83136626084647, -101.400310476621, -119.20495235919952, -103.54005867242813, -103.8948386311531, -109.75744155049324, -120.01108852028847, -107.97483089193702, -10.904605289300292, -9.815311891337245, -11.805337419112533, -119.23808121681213, -102.46917048096657, -102.86195033788681, -117.80216538906097, -100.47685479256324, -102.51307213306427, -98.12164591252804, -98.36359688639641, -103.30369853973389, -7.765953402345389, -8.227568512161582, -8.568908294041961, -87.70533289512, -105.15275712807974, -88.62725805242857, -115.62932089964549, -97.49046317363779, -97.77406823883454, -106.86301758885384, -106.61241686344147, -122.22656524181366, -101.98201533158621, -115.05003627141318, -102.72030230363211, -116.42056588331859, -104.01737761000793, -105.01167927185695, -113.88590506712596, -98.4193623761336, -98.05587715903918, -2.048399180173874, -2.191109463572502, -1.9909456297755241, -6.72812792907159, -6.476729227850839, -6.771813551584884, -195.79851911620548, -213.37406452496847, -200.75841840108237, -97.85097776850066, -109.64570357402167, -97.26639955242476, -101.70494108398756, -101.46337627371153, -114.37600298722586, -114.45473178227743, -99.90859798093638, -99.44506651659808, -8.049451008439064, -7.933558344841003, -7.572469303733669, -211.38769324620566, -195.57049829264483, -194.96874969204268, -98.47897065679233, -97.6064658711354, -114.04305605093639, -94.78130920728049, -108.00586714347205, -94.05714317162833, -113.88366051514944, -100.66089906295142, -99.94351514180502, -103.6740625500679, -101.49221999943256, -104.22630167007446, -93.60318886240324, -105.59058399995169, -93.82079946001372, -93.86802307267985, -107.81041367848715, -95.45344679554304, -112.1834127108256, -99.9115168551604, -99.28963790337245, -102.55609015623729, -113.46120069424312, -99.47041275600593, -103.6742471853892, -115.51192812124889, -102.63158477346103, -116.95780634880066, -102.7741564810276, -101.80161383002996, -0.06356918811798096, 0.5612891763448715, 0.8938426375389099, -96.6156314133356, -97.30095000068347, -99.66202394167583, -93.9548587501049, -94.23062261939049, -98.20831966400146, -109.8277975122134, -97.53104428450267, -98.89473656813304, -108.05521714687347, -106.54642610996962, -121.42320144176483, -104.79506602883339, -116.7725065946579, -102.71283081173897, -95.2204166278243, -95.46844701468945, -98.82973808050156, -118.743559161822, -105.65899316469829, -106.29947368303935, -105.87459429105124, -91.13993368049464, -92.29058100779852, -98.13949054479599, -108.30922490358353, -97.02944508194923, -117.24277315537135, -102.75714946320902, -103.87428199748199, -116.6826597849528, -101.70200484494369, -105.42227784792583, -109.5511652181546, -111.22076217333476, -101.47977415720622, -115.98203519980113, -103.05272529522578, -103.94885937372844, -117.90022877852122, -102.91723428169887, -104.81303093830745, -121.34257968266806, -106.12875643869242, -105.668406372269, -116.08608537912369, -102.66571888327599, -103.51310694217682, -92.91367828845978, -107.51323878765106, -91.5433220565319, -105.42648900548618, -105.25643918911616, -119.32498757044475, -98.53466335932414, -111.21627602974574, -98.73923648397128, -106.40597285081944, -119.94565208752951, -106.68213774760565, -112.3343833287557, -95.93099166949591, -94.99126219501099, -16.139752273758262, -17.752468516429275, -15.795845543344825, -105.47882092992465, -117.9393845597903, -104.51368393252294, -105.7794805642528, -120.56663044293722, -106.55370571215948, -5.98802675306797, -5.920674026012421, -4.916667144745588, 1.2168504794438633, 2.3017476250727924, 3.033786074568823, -117.1936627626419, -103.46640841662884, -104.97350284457207, -107.30636008580527, -94.43760417898497, -94.0278365512689, 0.2676875690619056, -0.056970362861960666, 0.09670754770436929, -109.40202672282855, -108.1584529230992, -122.26507429281871, -95.53443754216036, -97.16692762573561, -99.6001920302709, -117.34032710393271, -101.42049742241701, -102.70641495784125, -99.51125097026429, -99.56160922100148, -114.55765970547995, -15.381482151647418, -15.269151871403068, -15.795681421955436, -13.07328061262767, -13.184250156084701, -12.882954171548292, -106.4951277077198, -119.3107904791832, -107.14233267307281, -105.32294394572577, -118.09243979056677, -103.900963721176, -117.07178197304408, -104.07777599493663, -103.96603799859683, -101.04783797264099, -100.50517731904984, -102.28810632228851, -101.38328418135643, -101.66728287935257, -103.95209491252899, 4.838701575994492, 4.987929403781891, 5.452664323151112, -102.62850978101294, -104.34434274832408, -116.5444881717364, -108.28744946420193, -110.20846581459045, -121.82543015480042, -12.845972582697868, -12.63142316788435, -12.370977580547333, -117.37632763385773, -102.25316402316093, -101.65027265250683, -101.8223679860433, -115.35032786925635, -102.61558421452841, -108.98837091525397, -121.99104549487433, -110.63983144362768, -11.00222994138798, -11.402367358406394, -11.081240591903537, -116.56533763806026, -102.72722379366557, -101.99556688840191, -116.43780906995138, -103.91627987225851, -102.73502652843794, -118.84609228372574, -105.06430512666702, -105.36846181750298, -97.41151215011875, -115.8288966814677, -115.66869191328685, -2.620571469267219, -2.6989637588461335, -2.459862185021251, -99.67595403641462, -100.08299627900124, -113.55586701631546, -105.44492836793265, -115.75700949629149, -105.02373227601251, 0.44863588362932205, 0.4826052412390709, 0.27593399584293365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1669623224950083, "mean_inference_ms": 0.6642202800075888, "mean_action_processing_ms": 0.09770554960824981, "mean_env_wait_ms": 0.7893181140068952, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 100800, "timesteps_this_iter": 0, "agent_timesteps_total": 302400, "timers": {"sample_time_ms": 9297.112, "sample_throughput": 516.289, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1209.518, "learn_throughput": 3968.522, "update_time_ms": 1.101}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 1069.4226837158203, "policy_loss": -0.004008591252883553, "vf_loss": 1069.4827728271484, "vf_explained_var": 0.005249813199043274, "kl": 0.009917468640200518, "entropy": 5.612535893917084, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100800, "num_agent_steps_sampled": 302400, "num_steps_trained": 100800, "num_agent_steps_trained": 302400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1143, "training_iteration": 21, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-45-56", "timestamp": 1706147156, "time_this_iter_s": 8.98143482208252, "time_total_s": 199.27187991142273, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D4E940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 199.27187991142273, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 6.961538461538462, "ram_util_percent": 44.284615384615385}}
{"episode_reward_max": 15.279295302927494, "episode_reward_min": -355.9594488888979, "episode_reward_mean": -253.02833500254434, "episode_len_mean": 124.02, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -128.07999730110168}, "policy_reward_max": {"shared_policy": 5.452664323151112}, "policy_reward_mean": {"shared_policy": -84.34277833418145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.48807471990585, -309.3925842195749, -293.0145723223686, -297.13188354671, -311.38456746935844, -315.4877036064863, -321.8177600800991, -321.5335766598582, 1.3915626257658005, -293.5786053556949, -286.39380103349686, -306.2535783648491, -336.0248446986079, -324.28040343523026, -289.5186017230153, -330.7020260095597, -289.3051089793444, -303.47816053032875, -323.87420461606234, -323.8069424778223, -322.25170154869556, -322.98361986875534, -325.6304939985275, -333.13974249362946, -322.2649112045765, -291.97023913264275, -330.0079157650471, -308.49017587304115, -333.03376268595457, -303.2566371932626, -49.68806633353236, -327.9318894222379, -332.8998167193495, -16.82536792382598, 6.552384179085479, -325.6335740238428, -295.77180081605917, 0.30742475390431423, -339.82555393874645, -292.30155719816685, -321.46723948419094, -313.6305198967457, -46.44631544500592, -39.14048494026066, -332.9482508599758, -327.3163474574685, -325.11559596657753, -303.84112161397934, -307.002661973238, 15.279295302927494, -323.5173407010734, -340.3213454335928, -37.84837333112955, -321.2797643095255, -319.78828006982803, -341.61924785375595, -33.48583789169791, -321.2881283201277, -323.08911547064787, -329.27885922789574, -328.9091007448733, -7.779397413134603, -313.3148173317313, -326.2256701402366, 1.2071751207113266, -302.8346509188414, -21.827755875885515, -304.0281531214714, -286.87082166969776, -330.42639714479446, -295.9841813445091, -27.750555984675913, -14.55077003687623, -315.6819938570261, 7.362315207719803, -13.703951656818418, -299.7534879744053, -291.7554017761722, -355.9594488888979, -301.59517254680395, -292.3021419867873, -303.8434354364872, -329.57462011277676, -291.8668935112655, -307.5934347845614, -309.5585235878825, 6.308696493506417, -16.986527726054206, -353.94141651690006, -345.6729543581605, -346.2413552924991, -285.81117434799677, -344.3557338118553, -20.656068623065963, -313.94237170368433, -310.6620149612427, -327.5808633491397, 13.062130976468296, -307.8751277923584, -333.08944234997034], "episode_lengths": [40, 55, 59, 133, 52, 72, 42, 72, 300, 75, 66, 76, 55, 59, 67, 87, 101, 72, 58, 50, 80, 47, 58, 138, 61, 78, 59, 71, 100, 173, 300, 108, 81, 300, 300, 81, 190, 300, 61, 54, 62, 58, 300, 300, 50, 63, 116, 78, 55, 300, 61, 167, 300, 90, 97, 63, 300, 42, 51, 59, 72, 300, 57, 130, 300, 71, 300, 58, 86, 80, 84, 300, 300, 68, 300, 300, 58, 80, 95, 91, 61, 64, 61, 81, 64, 80, 300, 300, 77, 97, 132, 79, 105, 300, 53, 68, 85, 300, 47, 75], "policy_shared_policy_reward": [-113.88366051514944, -100.66089906295142, -99.94351514180502, -103.6740625500679, -101.49221999943256, -104.22630167007446, -93.60318886240324, -105.59058399995169, -93.82079946001372, -93.86802307267985, -107.81041367848715, -95.45344679554304, -112.1834127108256, -99.9115168551604, -99.28963790337245, -102.55609015623729, -113.46120069424312, -99.47041275600593, -103.6742471853892, -115.51192812124889, -102.63158477346103, -116.95780634880066, -102.7741564810276, -101.80161383002996, -0.06356918811798096, 0.5612891763448715, 0.8938426375389099, -96.6156314133356, -97.30095000068347, -99.66202394167583, -93.9548587501049, -94.23062261939049, -98.20831966400146, -109.8277975122134, -97.53104428450267, -98.89473656813304, -108.05521714687347, -106.54642610996962, -121.42320144176483, -104.79506602883339, -116.7725065946579, -102.71283081173897, -95.2204166278243, -95.46844701468945, -98.82973808050156, -118.743559161822, -105.65899316469829, -106.29947368303935, -105.87459429105124, -91.13993368049464, -92.29058100779852, -98.13949054479599, -108.30922490358353, -97.02944508194923, -117.24277315537135, -102.75714946320902, -103.87428199748199, -116.6826597849528, -101.70200484494369, -105.42227784792583, -109.5511652181546, -111.22076217333476, -101.47977415720622, -115.98203519980113, -103.05272529522578, -103.94885937372844, -117.90022877852122, -102.91723428169887, -104.81303093830745, -121.34257968266806, -106.12875643869242, -105.668406372269, -116.08608537912369, -102.66571888327599, -103.51310694217682, -92.91367828845978, -107.51323878765106, -91.5433220565319, -105.42648900548618, -105.25643918911616, -119.32498757044475, -98.53466335932414, -111.21627602974574, -98.73923648397128, -106.40597285081944, -119.94565208752951, -106.68213774760565, -112.3343833287557, -95.93099166949591, -94.99126219501099, -16.139752273758262, -17.752468516429275, -15.795845543344825, -105.47882092992465, -117.9393845597903, -104.51368393252294, -105.7794805642528, -120.56663044293722, -106.55370571215948, -5.98802675306797, -5.920674026012421, -4.916667144745588, 1.2168504794438633, 2.3017476250727924, 3.033786074568823, -117.1936627626419, -103.46640841662884, -104.97350284457207, -107.30636008580527, -94.43760417898497, -94.0278365512689, 0.2676875690619056, -0.056970362861960666, 0.09670754770436929, -109.40202672282855, -108.1584529230992, -122.26507429281871, -95.53443754216036, -97.16692762573561, -99.6001920302709, -117.34032710393271, -101.42049742241701, -102.70641495784125, -99.51125097026429, -99.56160922100148, -114.55765970547995, -15.381482151647418, -15.269151871403068, -15.795681421955436, -13.07328061262767, -13.184250156084701, -12.882954171548292, -106.4951277077198, -119.3107904791832, -107.14233267307281, -105.32294394572577, -118.09243979056677, -103.900963721176, -117.07178197304408, -104.07777599493663, -103.96603799859683, -101.04783797264099, -100.50517731904984, -102.28810632228851, -101.38328418135643, -101.66728287935257, -103.95209491252899, 4.838701575994492, 4.987929403781891, 5.452664323151112, -102.62850978101294, -104.34434274832408, -116.5444881717364, -108.28744946420193, -110.20846581459045, -121.82543015480042, -12.845972582697868, -12.63142316788435, -12.370977580547333, -117.37632763385773, -102.25316402316093, -101.65027265250683, -101.8223679860433, -115.35032786925635, -102.61558421452841, -108.98837091525397, -121.99104549487433, -110.63983144362768, -11.00222994138798, -11.402367358406394, -11.081240591903537, -116.56533763806026, -102.72722379366557, -101.99556688840191, -116.43780906995138, -103.91627987225851, -102.73502652843794, -118.84609228372574, -105.06430512666702, -105.36846181750298, -97.41151215011875, -115.8288966814677, -115.66869191328685, -2.620571469267219, -2.6989637588461335, -2.459862185021251, -99.67595403641462, -100.08299627900124, -113.55586701631546, -105.44492836793265, -115.75700949629149, -105.02373227601251, 0.44863588362932205, 0.4826052412390709, 0.27593399584293365, -103.72731610139212, -100.19321410854658, -98.91412070890269, -7.221283306678146, -7.065451396008342, -7.541021173199027, -95.8875754972299, -96.54818629225096, -111.59239133199057, -93.9049755508701, -93.41441919157903, -99.55142692724864, -118.70482021570206, -106.39536985754967, -105.32620707154274, -106.2245040734609, -94.75167643030485, -95.00800084074339, -9.02129100014767, -9.344591175516456, -9.384673809011787, -4.785093863805145, -5.134629582365363, -4.631046590705722, -114.66590944925944, -99.53000258902709, -101.48608181873958, 2.265203297138214, 2.1709463000297546, 2.926165610551834, -4.386793514092773, -4.030143757661193, -5.287014385064452, -98.00723780194919, -98.83812401692073, -102.90812615553538, -105.22368788719177, -93.73766355216503, -92.79405033681542, -113.50858472287655, -127.6764178276062, -114.77444633841515, -96.94182053208351, -95.80741595476866, -108.84593605995178, -100.84381846586864, -96.46315721670787, -94.99516630421083, -97.33462351560593, -97.71990272402763, -108.78890919685364, -118.97004318237305, -104.98327095806599, -105.62130597233772, -91.20911645516753, -91.94139216840267, -108.71638488769531, -111.69291772445044, -97.40183400486907, -98.49868305524191, -113.93198267618816, -98.19259227315585, -97.43394863853852, 1.6147888203461918, 2.1888803442319187, 2.505027328928307, -5.414319145182773, -5.4998646999398915, -6.072343880931541, -110.28746165335178, -115.5739575624466, -128.07999730110168, -111.1627416064342, -124.12646790345511, -110.38374484827122, -111.17770606527726, -123.9156961242358, -111.14795310298602, -90.30715102454027, -104.75294442971548, -90.75107889374098, -123.80343083540599, -110.52385363976161, -110.02844933668773, -6.624911936620876, -7.325086320439979, -6.7060703660051075, -113.11070215702057, -100.21766469627619, -100.61400485038757, -112.35685006777446, -99.3825762073199, -98.92258868614833, -120.88521540164948, -102.47450347989798, -104.22114446759224, 4.011616210142762, 4.450249659518391, 4.600265106807143, -112.07696855068207, -98.51529821753502, -97.28286102414131, -104.90351151178281, -106.08240134517352, -122.10352949301402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16585505049107518, "mean_inference_ms": 0.6622091777608904, "mean_action_processing_ms": 0.09762654654507319, "mean_env_wait_ms": 0.7883930746244789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 105600, "timesteps_this_iter": 0, "agent_timesteps_total": 316800, "timers": {"sample_time_ms": 9208.228, "sample_throughput": 521.273, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1167.715, "learn_throughput": 4110.59, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 1236.3632049560547, "policy_loss": -0.0030601640824332033, "vf_loss": 1236.4243927001953, "vf_explained_var": 0.005684368312358856, "kl": 0.008948939270343938, "entropy": 5.80973619222641, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 105600, "num_agent_steps_sampled": 316800, "num_steps_trained": 105600, "num_agent_steps_trained": 316800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1178, "training_iteration": 22, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-46-05", "timestamp": 1706147165, "time_this_iter_s": 8.970082998275757, "time_total_s": 208.2419629096985, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632F9A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 208.2419629096985, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 5.746153846153845, "ram_util_percent": 44.29230769230769}}
{"episode_reward_max": 15.279295302927494, "episode_reward_min": -624.7865798026323, "episode_reward_mean": -224.6462973805936, "episode_len_mean": 151.01, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {"shared_policy": -219.4638667901357}, "policy_reward_max": {"shared_policy": 5.452664323151112}, "policy_reward_mean": {"shared_policy": -74.88209912686453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-291.97023913264275, -330.0079157650471, -308.49017587304115, -333.03376268595457, -303.2566371932626, -49.68806633353236, -327.9318894222379, -332.8998167193495, -16.82536792382598, 6.552384179085479, -325.6335740238428, -295.77180081605917, 0.30742475390431423, -339.82555393874645, -292.30155719816685, -321.46723948419094, -313.6305198967457, -46.44631544500592, -39.14048494026066, -332.9482508599758, -327.3163474574685, -325.11559596657753, -303.84112161397934, -307.002661973238, 15.279295302927494, -323.5173407010734, -340.3213454335928, -37.84837333112955, -321.2797643095255, -319.78828006982803, -341.61924785375595, -33.48583789169791, -321.2881283201277, -323.08911547064787, -329.27885922789574, -328.9091007448733, -7.779397413134603, -313.3148173317313, -326.2256701402366, 1.2071751207113266, -302.8346509188414, -21.827755875885515, -304.0281531214714, -286.87082166969776, -330.42639714479446, -295.9841813445091, -27.750555984675913, -14.55077003687623, -315.6819938570261, 7.362315207719803, -13.703951656818418, -299.7534879744053, -291.7554017761722, -355.9594488888979, -301.59517254680395, -292.3021419867873, -303.8434354364872, -329.57462011277676, -291.8668935112655, -307.5934347845614, -309.5585235878825, 6.308696493506417, -16.986527726054206, -353.94141651690006, -345.6729543581605, -346.2413552924991, -285.81117434799677, -344.3557338118553, -20.656068623065963, -313.94237170368433, -310.6620149612427, -327.5808633491397, 13.062130976468296, -307.8751277923584, -333.08944234997034, -39.389435889199405, -25.52624636888507, -318.680092997849, -24.543146528303637, -6.271763186901836, -307.22753766179085, -305.3205569945276, -382.59620789438486, -324.8917606472969, -314.6139916777611, -57.1127064228058, -624.7865798026323, -331.23969735205173, 11.829577356576905, -301.96487196162343, -312.59854874014854, -326.7339693568647, 4.4785981625318385, -314.86106073856354, -14.380623761564507, -18.166531533002853, -37.91221100836992, -273.3806248344481, 5.255329057574244, -37.50748335942626], "episode_lengths": [78, 59, 71, 100, 173, 300, 108, 81, 300, 300, 81, 190, 300, 61, 54, 62, 58, 300, 300, 50, 63, 116, 78, 55, 300, 61, 167, 300, 90, 97, 63, 300, 42, 51, 59, 72, 300, 57, 130, 300, 71, 300, 58, 86, 80, 84, 300, 300, 68, 300, 300, 58, 80, 95, 91, 61, 64, 61, 81, 64, 80, 300, 300, 77, 97, 132, 79, 105, 300, 53, 68, 85, 300, 47, 75, 300, 300, 101, 300, 300, 57, 56, 236, 74, 51, 300, 71, 59, 300, 82, 75, 75, 300, 55, 300, 300, 300, 82, 300, 300], "policy_shared_policy_reward": [-92.91367828845978, -107.51323878765106, -91.5433220565319, -105.42648900548618, -105.25643918911616, -119.32498757044475, -98.53466335932414, -111.21627602974574, -98.73923648397128, -106.40597285081944, -119.94565208752951, -106.68213774760565, -112.3343833287557, -95.93099166949591, -94.99126219501099, -16.139752273758262, -17.752468516429275, -15.795845543344825, -105.47882092992465, -117.9393845597903, -104.51368393252294, -105.7794805642528, -120.56663044293722, -106.55370571215948, -5.98802675306797, -5.920674026012421, -4.916667144745588, 1.2168504794438633, 2.3017476250727924, 3.033786074568823, -117.1936627626419, -103.46640841662884, -104.97350284457207, -107.30636008580527, -94.43760417898497, -94.0278365512689, 0.2676875690619056, -0.056970362861960666, 0.09670754770436929, -109.40202672282855, -108.1584529230992, -122.26507429281871, -95.53443754216036, -97.16692762573561, -99.6001920302709, -117.34032710393271, -101.42049742241701, -102.70641495784125, -99.51125097026429, -99.56160922100148, -114.55765970547995, -15.381482151647418, -15.269151871403068, -15.795681421955436, -13.07328061262767, -13.184250156084701, -12.882954171548292, -106.4951277077198, -119.3107904791832, -107.14233267307281, -105.32294394572577, -118.09243979056677, -103.900963721176, -117.07178197304408, -104.07777599493663, -103.96603799859683, -101.04783797264099, -100.50517731904984, -102.28810632228851, -101.38328418135643, -101.66728287935257, -103.95209491252899, 4.838701575994492, 4.987929403781891, 5.452664323151112, -102.62850978101294, -104.34434274832408, -116.5444881717364, -108.28744946420193, -110.20846581459045, -121.82543015480042, -12.845972582697868, -12.63142316788435, -12.370977580547333, -117.37632763385773, -102.25316402316093, -101.65027265250683, -101.8223679860433, -115.35032786925635, -102.61558421452841, -108.98837091525397, -121.99104549487433, -110.63983144362768, -11.00222994138798, -11.402367358406394, -11.081240591903537, -116.56533763806026, -102.72722379366557, -101.99556688840191, -116.43780906995138, -103.91627987225851, -102.73502652843794, -118.84609228372574, -105.06430512666702, -105.36846181750298, -97.41151215011875, -115.8288966814677, -115.66869191328685, -2.620571469267219, -2.6989637588461335, -2.459862185021251, -99.67595403641462, -100.08299627900124, -113.55586701631546, -105.44492836793265, -115.75700949629149, -105.02373227601251, 0.44863588362932205, 0.4826052412390709, 0.27593399584293365, -103.72731610139212, -100.19321410854658, -98.91412070890269, -7.221283306678146, -7.065451396008342, -7.541021173199027, -95.8875754972299, -96.54818629225096, -111.59239133199057, -93.9049755508701, -93.41441919157903, -99.55142692724864, -118.70482021570206, -106.39536985754967, -105.32620707154274, -106.2245040734609, -94.75167643030485, -95.00800084074339, -9.02129100014767, -9.344591175516456, -9.384673809011787, -4.785093863805145, -5.134629582365363, -4.631046590705722, -114.66590944925944, -99.53000258902709, -101.48608181873958, 2.265203297138214, 2.1709463000297546, 2.926165610551834, -4.386793514092773, -4.030143757661193, -5.287014385064452, -98.00723780194919, -98.83812401692073, -102.90812615553538, -105.22368788719177, -93.73766355216503, -92.79405033681542, -113.50858472287655, -127.6764178276062, -114.77444633841515, -96.94182053208351, -95.80741595476866, -108.84593605995178, -100.84381846586864, -96.46315721670787, -94.99516630421083, -97.33462351560593, -97.71990272402763, -108.78890919685364, -118.97004318237305, -104.98327095806599, -105.62130597233772, -91.20911645516753, -91.94139216840267, -108.71638488769531, -111.69291772445044, -97.40183400486907, -98.49868305524191, -113.93198267618816, -98.19259227315585, -97.43394863853852, 1.6147888203461918, 2.1888803442319187, 2.505027328928307, -5.414319145182773, -5.4998646999398915, -6.072343880931541, -110.28746165335178, -115.5739575624466, -128.07999730110168, -111.1627416064342, -124.12646790345511, -110.38374484827122, -111.17770606527726, -123.9156961242358, -111.14795310298602, -90.30715102454027, -104.75294442971548, -90.75107889374098, -123.80343083540599, -110.52385363976161, -110.02844933668773, -6.624911936620876, -7.325086320439979, -6.7060703660051075, -113.11070215702057, -100.21766469627619, -100.61400485038757, -112.35685006777446, -99.3825762073199, -98.92258868614833, -120.88521540164948, -102.47450347989798, -104.22114446759224, 4.011616210142762, 4.450249659518391, 4.600265106807143, -112.07696855068207, -98.51529821753502, -97.28286102414131, -104.90351151178281, -106.08240134517352, -122.10352949301402, -13.33803026874861, -12.67684008864066, -13.374565531810134, -8.108954136570304, -9.175714631875366, -8.241577600439399, -102.03725518286228, -101.65979181975126, -114.98304599523544, -7.921460407475635, -7.688655207554504, -8.933030913273498, -2.305669916172832, -2.0644192968805726, -1.9016739738484318, -105.5713516076406, -101.3779243429502, -100.27826171120009, -96.8599685691297, -98.16583773493767, -110.2947506904602, -130.18046696980795, -126.13120005776486, -126.28454086681208, -102.55550911029181, -104.01250024636587, -118.32375129063925, -113.47035467624664, -100.61576768755913, -100.5278693139553, -18.77523232499759, -18.889392132560417, -19.448081965247795, -219.4638667901357, -202.9766058822473, -202.34610713024935, -104.43130868673325, -104.6610986739397, -122.14728999137878, 3.8093714316685947, 3.498996784289673, 4.521209140618637, -95.37426107997696, -96.08235559860866, -110.50825528303783, -113.57317439715068, -99.84281114737193, -99.18256319562595, -104.27941804130873, -102.49664808933935, -119.95790322621664, 1.6688717653353962, 1.4429659893115314, 1.366760407884911, -100.10992370049159, -113.91331128279369, -100.83782575527827, -5.117136503259346, -4.7530427972475735, -4.510444461057588, -6.19439896941185, -5.987600207328796, -5.984532356262207, -12.45353166013956, -12.703467234969139, -12.755212113261223, -87.10444803535938, -100.2852948307991, -85.99088196828961, 1.8512242684761588, 1.7339012424151008, 1.670203546682984, -13.057209879159927, -11.70036220178008, -12.749911278486252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16495661522814067, "mean_inference_ms": 0.6606300564907235, "mean_action_processing_ms": 0.09752850825534651, "mean_env_wait_ms": 0.7877716916447725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 110400, "timesteps_this_iter": 0, "agent_timesteps_total": 331200, "timers": {"sample_time_ms": 9148.219, "sample_throughput": 524.692, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1165.116, "learn_throughput": 4119.76, "update_time_ms": 1.2}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 847.7718353271484, "policy_loss": -0.0035988336637576834, "vf_loss": 847.8300018310547, "vf_explained_var": 0.006377071142196655, "kl": 0.009832006697256649, "entropy": 5.457459509372711, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 110400, "num_agent_steps_sampled": 331200, "num_steps_trained": 110400, "num_agent_steps_trained": 331200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1203, "training_iteration": 23, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-46-14", "timestamp": 1706147174, "time_this_iter_s": 8.954394817352295, "time_total_s": 217.19635772705078, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F9160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 217.19635772705078, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 9.23846153846154, "ram_util_percent": 44.29230769230769}}
{"episode_reward_max": 14.275823455303879, "episode_reward_min": -624.7865798026323, "episode_reward_mean": -214.0677031607274, "episode_len_mean": 160.02, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {"shared_policy": -219.4638667901357}, "policy_reward_max": {"shared_policy": 5.204339510450751}, "policy_reward_mean": {"shared_policy": -71.35590105357579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.84837333112955, -321.2797643095255, -319.78828006982803, -341.61924785375595, -33.48583789169791, -321.2881283201277, -323.08911547064787, -329.27885922789574, -328.9091007448733, -7.779397413134603, -313.3148173317313, -326.2256701402366, 1.2071751207113266, -302.8346509188414, -21.827755875885515, -304.0281531214714, -286.87082166969776, -330.42639714479446, -295.9841813445091, -27.750555984675913, -14.55077003687623, -315.6819938570261, 7.362315207719803, -13.703951656818418, -299.7534879744053, -291.7554017761722, -355.9594488888979, -301.59517254680395, -292.3021419867873, -303.8434354364872, -329.57462011277676, -291.8668935112655, -307.5934347845614, -309.5585235878825, 6.308696493506417, -16.986527726054206, -353.94141651690006, -345.6729543581605, -346.2413552924991, -285.81117434799677, -344.3557338118553, -20.656068623065963, -313.94237170368433, -310.6620149612427, -327.5808633491397, 13.062130976468296, -307.8751277923584, -333.08944234997034, -39.389435889199405, -25.52624636888507, -318.680092997849, -24.543146528303637, -6.271763186901836, -307.22753766179085, -305.3205569945276, -382.59620789438486, -324.8917606472969, -314.6139916777611, -57.1127064228058, -624.7865798026323, -331.23969735205173, 11.829577356576905, -301.96487196162343, -312.59854874014854, -326.7339693568647, 4.4785981625318385, -314.86106073856354, -14.380623761564507, -18.166531533002853, -37.91221100836992, -273.3806248344481, 5.255329057574244, -37.50748335942626, -2.1529779136180878, -326.14706763625145, -6.970242272131173, -1.01490662992002, -301.3512500822544, -23.276004925370245, -292.90577541291714, -19.895986258983626, -21.35904598981145, -295.4392694979906, -267.80268673598766, 14.275823455303879, -315.01113349199295, 4.4682022780179835, -39.91065075993538, -335.6080162674189, -612.1434879926965, -287.4179211258888, -321.0122616216541, -41.011691741645365, -338.2790812551975, -14.593179583549528, -19.429463930428057, -341.17142394185066, -304.7309660091996, -618.2271288409829, -320.26746039092546], "episode_lengths": [300, 90, 97, 63, 300, 42, 51, 59, 72, 300, 57, 130, 300, 71, 300, 58, 86, 80, 84, 300, 300, 68, 300, 300, 58, 80, 95, 91, 61, 64, 61, 81, 64, 80, 300, 300, 77, 97, 132, 79, 105, 300, 53, 68, 85, 300, 47, 75, 300, 300, 101, 300, 300, 57, 56, 236, 74, 51, 300, 71, 59, 300, 82, 75, 75, 300, 55, 300, 300, 300, 82, 300, 300, 300, 61, 300, 300, 116, 300, 83, 300, 300, 59, 99, 300, 56, 300, 300, 119, 53, 87, 86, 300, 57, 300, 300, 70, 65, 83, 73], "policy_shared_policy_reward": [-12.845972582697868, -12.63142316788435, -12.370977580547333, -117.37632763385773, -102.25316402316093, -101.65027265250683, -101.8223679860433, -115.35032786925635, -102.61558421452841, -108.98837091525397, -121.99104549487433, -110.63983144362768, -11.00222994138798, -11.402367358406394, -11.081240591903537, -116.56533763806026, -102.72722379366557, -101.99556688840191, -116.43780906995138, -103.91627987225851, -102.73502652843794, -118.84609228372574, -105.06430512666702, -105.36846181750298, -97.41151215011875, -115.8288966814677, -115.66869191328685, -2.620571469267219, -2.6989637588461335, -2.459862185021251, -99.67595403641462, -100.08299627900124, -113.55586701631546, -105.44492836793265, -115.75700949629149, -105.02373227601251, 0.44863588362932205, 0.4826052412390709, 0.27593399584293365, -103.72731610139212, -100.19321410854658, -98.91412070890269, -7.221283306678146, -7.065451396008342, -7.541021173199027, -95.8875754972299, -96.54818629225096, -111.59239133199057, -93.9049755508701, -93.41441919157903, -99.55142692724864, -118.70482021570206, -106.39536985754967, -105.32620707154274, -106.2245040734609, -94.75167643030485, -95.00800084074339, -9.02129100014767, -9.344591175516456, -9.384673809011787, -4.785093863805145, -5.134629582365363, -4.631046590705722, -114.66590944925944, -99.53000258902709, -101.48608181873958, 2.265203297138214, 2.1709463000297546, 2.926165610551834, -4.386793514092773, -4.030143757661193, -5.287014385064452, -98.00723780194919, -98.83812401692073, -102.90812615553538, -105.22368788719177, -93.73766355216503, -92.79405033681542, -113.50858472287655, -127.6764178276062, -114.77444633841515, -96.94182053208351, -95.80741595476866, -108.84593605995178, -100.84381846586864, -96.46315721670787, -94.99516630421083, -97.33462351560593, -97.71990272402763, -108.78890919685364, -118.97004318237305, -104.98327095806599, -105.62130597233772, -91.20911645516753, -91.94139216840267, -108.71638488769531, -111.69291772445044, -97.40183400486907, -98.49868305524191, -113.93198267618816, -98.19259227315585, -97.43394863853852, 1.6147888203461918, 2.1888803442319187, 2.505027328928307, -5.414319145182773, -5.4998646999398915, -6.072343880931541, -110.28746165335178, -115.5739575624466, -128.07999730110168, -111.1627416064342, -124.12646790345511, -110.38374484827122, -111.17770606527726, -123.9156961242358, -111.14795310298602, -90.30715102454027, -104.75294442971548, -90.75107889374098, -123.80343083540599, -110.52385363976161, -110.02844933668773, -6.624911936620876, -7.325086320439979, -6.7060703660051075, -113.11070215702057, -100.21766469627619, -100.61400485038757, -112.35685006777446, -99.3825762073199, -98.92258868614833, -120.88521540164948, -102.47450347989798, -104.22114446759224, 4.011616210142762, 4.450249659518391, 4.600265106807143, -112.07696855068207, -98.51529821753502, -97.28286102414131, -104.90351151178281, -106.08240134517352, -122.10352949301402, -13.33803026874861, -12.67684008864066, -13.374565531810134, -8.108954136570304, -9.175714631875366, -8.241577600439399, -102.03725518286228, -101.65979181975126, -114.98304599523544, -7.921460407475635, -7.688655207554504, -8.933030913273498, -2.305669916172832, -2.0644192968805726, -1.9016739738484318, -105.5713516076406, -101.3779243429502, -100.27826171120009, -96.8599685691297, -98.16583773493767, -110.2947506904602, -130.18046696980795, -126.13120005776486, -126.28454086681208, -102.55550911029181, -104.01250024636587, -118.32375129063925, -113.47035467624664, -100.61576768755913, -100.5278693139553, -18.77523232499759, -18.889392132560417, -19.448081965247795, -219.4638667901357, -202.9766058822473, -202.34610713024935, -104.43130868673325, -104.6610986739397, -122.14728999137878, 3.8093714316685947, 3.498996784289673, 4.521209140618637, -95.37426107997696, -96.08235559860866, -110.50825528303783, -113.57317439715068, -99.84281114737193, -99.18256319562595, -104.27941804130873, -102.49664808933935, -119.95790322621664, 1.6688717653353962, 1.4429659893115314, 1.366760407884911, -100.10992370049159, -113.91331128279369, -100.83782575527827, -5.117136503259346, -4.7530427972475735, -4.510444461057588, -6.19439896941185, -5.987600207328796, -5.984532356262207, -12.45353166013956, -12.703467234969139, -12.755212113261223, -87.10444803535938, -100.2852948307991, -85.99088196828961, 1.8512242684761588, 1.7339012424151008, 1.670203546682984, -13.057209879159927, -11.70036220178008, -12.749911278486252, -0.49961788952350616, -0.21886973083019257, -1.434490293264389, -104.05044856667519, -104.23692363500595, -117.85969543457031, -2.7356236477693017, -2.3335119759043152, -1.9011066484575565, -1.1922514239947049, 0.035892819364860884, 0.14145197470982396, -94.8895085627834, -111.61936048666637, -94.84238103280465, -7.90686356027922, -7.848004867633193, -7.521136497457832, -108.06653694311778, -90.43430843452613, -94.40493003527324, -6.908435056606933, -6.4071614469091145, -6.5803897554675785, -6.694324811299651, -7.966173191865295, -6.698547986646503, -109.28846017519633, -92.69153826932113, -93.45927105347316, -85.56081264217696, -98.20733561118445, -84.03453848262629, 4.344773645202309, 4.726710299650819, 5.204339510450751, -99.4644780009985, -116.71708035469055, -98.8295751363039, 1.7967049976189884, 1.6395385016997608, 1.0319587786992344, -13.849634498357773, -13.288635581731796, -12.77238067984581, -121.24621637662253, -107.33704932530722, -107.02475056548914, -209.72933944066367, -194.129732691062, -208.28441586097082, -99.68139787515005, -94.48749085267386, -93.24903239806494, -102.57209350665411, -100.21417619039616, -118.22599192460379, -13.414205243190139, -13.43231622626385, -14.165170272191375, -107.06305324037871, -120.99530263741812, -110.22072537740073, -4.604471047719329, -5.099947919448226, -4.888760616381973, -6.378560451169818, -6.607202713688224, -6.443700765570014, -108.79016454021136, -108.56652836004893, -123.81473104159038, -111.12606749931972, -96.58995878944795, -97.01493972043197, -216.6909520228704, -201.52640878160796, -200.0097680365046, -102.82854153712591, -115.3518770535787, -102.08704180022082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16416393901162415, "mean_inference_ms": 0.6591001190985628, "mean_action_processing_ms": 0.09732225236399303, "mean_env_wait_ms": 0.7872052456680632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"sample_time_ms": 9122.705, "sample_throughput": 526.16, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1164.71, "learn_throughput": 4121.196, "update_time_ms": 1.2}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 1124.581283569336, "policy_loss": -0.00456079717783725, "vf_loss": 1124.6438446044922, "vf_explained_var": 0.0059847161173820496, "kl": 0.0132800519932115, "entropy": 5.8072516322135925, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 345600, "num_steps_trained": 115200, "num_agent_steps_trained": 345600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1230, "training_iteration": 24, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-46-23", "timestamp": 1706147183, "time_this_iter_s": 9.126587152481079, "time_total_s": 226.32294487953186, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D4E940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 226.32294487953186, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 7.03076923076923, "ram_util_percent": 44.32307692307692}}
{"episode_reward_max": 14.275823455303879, "episode_reward_min": -624.7865798026323, "episode_reward_mean": -202.49500462179188, "episode_len_mean": 172.02, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {"shared_policy": -219.4638667901357}, "policy_reward_max": {"shared_policy": 5.204339510450751}, "policy_reward_mean": {"shared_policy": -67.49833487393063}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-291.7554017761722, -355.9594488888979, -301.59517254680395, -292.3021419867873, -303.8434354364872, -329.57462011277676, -291.8668935112655, -307.5934347845614, -309.5585235878825, 6.308696493506417, -16.986527726054206, -353.94141651690006, -345.6729543581605, -346.2413552924991, -285.81117434799677, -344.3557338118553, -20.656068623065963, -313.94237170368433, -310.6620149612427, -327.5808633491397, 13.062130976468296, -307.8751277923584, -333.08944234997034, -39.389435889199405, -25.52624636888507, -318.680092997849, -24.543146528303637, -6.271763186901836, -307.22753766179085, -305.3205569945276, -382.59620789438486, -324.8917606472969, -314.6139916777611, -57.1127064228058, -624.7865798026323, -331.23969735205173, 11.829577356576905, -301.96487196162343, -312.59854874014854, -326.7339693568647, 4.4785981625318385, -314.86106073856354, -14.380623761564507, -18.166531533002853, -37.91221100836992, -273.3806248344481, 5.255329057574244, -37.50748335942626, -2.1529779136180878, -326.14706763625145, -6.970242272131173, -1.01490662992002, -301.3512500822544, -23.276004925370245, -292.90577541291714, -19.895986258983626, -21.35904598981145, -295.4392694979906, -267.80268673598766, 14.275823455303879, -315.01113349199295, 4.4682022780179835, -39.91065075993538, -335.6080162674189, -612.1434879926965, -287.4179211258888, -321.0122616216541, -41.011691741645365, -338.2790812551975, -14.593179583549528, -19.429463930428057, -341.17142394185066, -304.7309660091996, -618.2271288409829, -320.26746039092546, -35.18434051424268, -3.781589992344408, -1.0979411808075525, -320.62379685789347, -350.9001207202673, -333.15646070986986, -21.306479625403895, -16.22938808053732, -29.420603614300504, -30.785993637517095, -269.6678636074066, -312.45440733432775, -345.8861035704613, 12.739019289612756, -15.216073565185098, -619.0772065073252, 2.6712861061095907, -328.6616882830859, -30.506433822214632, -295.4694359302521, -327.9145068228245, -47.22095686197281, -303.84838899970055, -4.596166837960482, -23.88432578742507], "episode_lengths": [80, 95, 91, 61, 64, 61, 81, 64, 80, 300, 300, 77, 97, 132, 79, 105, 300, 53, 68, 85, 300, 47, 75, 300, 300, 101, 300, 300, 57, 56, 236, 74, 51, 300, 71, 59, 300, 82, 75, 75, 300, 55, 300, 300, 300, 82, 300, 300, 300, 61, 300, 300, 116, 300, 83, 300, 300, 59, 99, 300, 56, 300, 300, 119, 53, 87, 86, 300, 57, 300, 300, 70, 65, 83, 73, 300, 300, 300, 60, 99, 124, 300, 300, 300, 300, 117, 51, 93, 300, 300, 73, 300, 55, 300, 80, 59, 300, 55, 300, 300], "policy_shared_policy_reward": [-105.22368788719177, -93.73766355216503, -92.79405033681542, -113.50858472287655, -127.6764178276062, -114.77444633841515, -96.94182053208351, -95.80741595476866, -108.84593605995178, -100.84381846586864, -96.46315721670787, -94.99516630421083, -97.33462351560593, -97.71990272402763, -108.78890919685364, -118.97004318237305, -104.98327095806599, -105.62130597233772, -91.20911645516753, -91.94139216840267, -108.71638488769531, -111.69291772445044, -97.40183400486907, -98.49868305524191, -113.93198267618816, -98.19259227315585, -97.43394863853852, 1.6147888203461918, 2.1888803442319187, 2.505027328928307, -5.414319145182773, -5.4998646999398915, -6.072343880931541, -110.28746165335178, -115.5739575624466, -128.07999730110168, -111.1627416064342, -124.12646790345511, -110.38374484827122, -111.17770606527726, -123.9156961242358, -111.14795310298602, -90.30715102454027, -104.75294442971548, -90.75107889374098, -123.80343083540599, -110.52385363976161, -110.02844933668773, -6.624911936620876, -7.325086320439979, -6.7060703660051075, -113.11070215702057, -100.21766469627619, -100.61400485038757, -112.35685006777446, -99.3825762073199, -98.92258868614833, -120.88521540164948, -102.47450347989798, -104.22114446759224, 4.011616210142762, 4.450249659518391, 4.600265106807143, -112.07696855068207, -98.51529821753502, -97.28286102414131, -104.90351151178281, -106.08240134517352, -122.10352949301402, -13.33803026874861, -12.67684008864066, -13.374565531810134, -8.108954136570304, -9.175714631875366, -8.241577600439399, -102.03725518286228, -101.65979181975126, -114.98304599523544, -7.921460407475635, -7.688655207554504, -8.933030913273498, -2.305669916172832, -2.0644192968805726, -1.9016739738484318, -105.5713516076406, -101.3779243429502, -100.27826171120009, -96.8599685691297, -98.16583773493767, -110.2947506904602, -130.18046696980795, -126.13120005776486, -126.28454086681208, -102.55550911029181, -104.01250024636587, -118.32375129063925, -113.47035467624664, -100.61576768755913, -100.5278693139553, -18.77523232499759, -18.889392132560417, -19.448081965247795, -219.4638667901357, -202.9766058822473, -202.34610713024935, -104.43130868673325, -104.6610986739397, -122.14728999137878, 3.8093714316685947, 3.498996784289673, 4.521209140618637, -95.37426107997696, -96.08235559860866, -110.50825528303783, -113.57317439715068, -99.84281114737193, -99.18256319562595, -104.27941804130873, -102.49664808933935, -119.95790322621664, 1.6688717653353962, 1.4429659893115314, 1.366760407884911, -100.10992370049159, -113.91331128279369, -100.83782575527827, -5.117136503259346, -4.7530427972475735, -4.510444461057588, -6.19439896941185, -5.987600207328796, -5.984532356262207, -12.45353166013956, -12.703467234969139, -12.755212113261223, -87.10444803535938, -100.2852948307991, -85.99088196828961, 1.8512242684761588, 1.7339012424151008, 1.670203546682984, -13.057209879159927, -11.70036220178008, -12.749911278486252, -0.49961788952350616, -0.21886973083019257, -1.434490293264389, -104.05044856667519, -104.23692363500595, -117.85969543457031, -2.7356236477693017, -2.3335119759043152, -1.9011066484575565, -1.1922514239947049, 0.035892819364860884, 0.14145197470982396, -94.8895085627834, -111.61936048666637, -94.84238103280465, -7.90686356027922, -7.848004867633193, -7.521136497457832, -108.06653694311778, -90.43430843452613, -94.40493003527324, -6.908435056606933, -6.4071614469091145, -6.5803897554675785, -6.694324811299651, -7.966173191865295, -6.698547986646503, -109.28846017519633, -92.69153826932113, -93.45927105347316, -85.56081264217696, -98.20733561118445, -84.03453848262629, 4.344773645202309, 4.726710299650819, 5.204339510450751, -99.4644780009985, -116.71708035469055, -98.8295751363039, 1.7967049976189884, 1.6395385016997608, 1.0319587786992344, -13.849634498357773, -13.288635581731796, -12.77238067984581, -121.24621637662253, -107.33704932530722, -107.02475056548914, -209.72933944066367, -194.129732691062, -208.28441586097082, -99.68139787515005, -94.48749085267386, -93.24903239806494, -102.57209350665411, -100.21417619039616, -118.22599192460379, -13.414205243190139, -13.43231622626385, -14.165170272191375, -107.06305324037871, -120.99530263741812, -110.22072537740073, -4.604471047719329, -5.099947919448226, -4.888760616381973, -6.378560451169818, -6.607202713688224, -6.443700765570014, -108.79016454021136, -108.56652836004893, -123.81473104159038, -111.12606749931972, -96.58995878944795, -97.01493972043197, -216.6909520228704, -201.52640878160796, -200.0097680365046, -102.82854153712591, -115.3518770535787, -102.08704180022082, -11.505420667429775, -12.013979603846877, -11.664940242966026, -1.424394105871528, -1.245471430321544, -1.111724456151336, -0.7497351268927304, -0.3122379841903893, -0.035968069724432894, -102.38220192988715, -101.35497432698807, -116.88662060101828, -111.7765279809634, -111.5844444880883, -127.53914825121562, -115.1312250395616, -113.24885481347641, -104.77638085683188, -6.937196905414268, -6.945979463557407, -7.42330325643222, -5.539270490407944, -5.241273753345013, -5.448843836784363, -9.937081525723144, -9.916707130769893, -9.566814957807466, -10.45571281015873, -10.428936690092087, -9.901344137266278, -100.55107843875885, -84.56011098623276, -84.55667418241501, -100.80969407161078, -99.40675004323325, -112.2379632194837, -111.48042407631874, -124.0535659790039, -110.35211351513863, 3.966708322366074, 4.399744634826973, 4.372566332419709, -5.141717774172633, -4.987924565871566, -5.086431225140899, -200.90071550011635, -199.6249788850546, -218.55151212215424, 1.1664963314930503, 0.8662372628847663, 0.6385525117317741, -120.31890281041464, -103.61513957877955, -104.72764589389166, -10.104223830004543, -10.248612095912307, -10.153597896297782, -93.93357089161873, -107.60332381725311, -93.93254122138023, -106.14333248138428, -117.3734295964241, -104.3977447450161, -15.65868093073368, -15.79189321398735, -15.770382717251778, -99.88713827729225, -103.89678013324738, -100.06447058916092, -1.6922142058610916, -1.0684380568563938, -1.8355145752429962, -8.136685942610114, -7.517592464884132, -8.230047379930824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16344446802434923, "mean_inference_ms": 0.6576507837263602, "mean_action_processing_ms": 0.09708348827943074, "mean_env_wait_ms": 0.7867103587335892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 9106.573, "sample_throughput": 527.092, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1163.61, "learn_throughput": 4125.093, "update_time_ms": 1.3}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 801.3836288452148, "policy_loss": -0.0039113375225376945, "vf_loss": 801.440299987793, "vf_explained_var": 0.006738968193531036, "kl": 0.009226649490307461, "entropy": 5.28083348274231, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 360000, "num_steps_trained": 120000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1255, "training_iteration": 25, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-46-32", "timestamp": 1706147192, "time_this_iter_s": 8.97451901435852, "time_total_s": 235.29746389389038, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050CD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 235.29746389389038, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 9.191666666666665, "ram_util_percent": 44.40833333333333}}
{"episode_reward_max": 41.21016603708266, "episode_reward_min": -624.7865798026323, "episode_reward_mean": -175.0810933608201, "episode_len_mean": 191.11, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"shared_policy": -219.4638667901357}, "policy_reward_max": {"shared_policy": 13.865410675605133}, "policy_reward_mean": {"shared_policy": -58.36036445360669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.389435889199405, -25.52624636888507, -318.680092997849, -24.543146528303637, -6.271763186901836, -307.22753766179085, -305.3205569945276, -382.59620789438486, -324.8917606472969, -314.6139916777611, -57.1127064228058, -624.7865798026323, -331.23969735205173, 11.829577356576905, -301.96487196162343, -312.59854874014854, -326.7339693568647, 4.4785981625318385, -314.86106073856354, -14.380623761564507, -18.166531533002853, -37.91221100836992, -273.3806248344481, 5.255329057574244, -37.50748335942626, -2.1529779136180878, -326.14706763625145, -6.970242272131173, -1.01490662992002, -301.3512500822544, -23.276004925370245, -292.90577541291714, -19.895986258983626, -21.35904598981145, -295.4392694979906, -267.80268673598766, 14.275823455303879, -315.01113349199295, 4.4682022780179835, -39.91065075993538, -335.6080162674189, -612.1434879926965, -287.4179211258888, -321.0122616216541, -41.011691741645365, -338.2790812551975, -14.593179583549528, -19.429463930428057, -341.17142394185066, -304.7309660091996, -618.2271288409829, -320.26746039092546, -35.18434051424268, -3.781589992344408, -1.0979411808075525, -320.62379685789347, -350.9001207202673, -333.15646070986986, -21.306479625403895, -16.22938808053732, -29.420603614300504, -30.785993637517095, -269.6678636074066, -312.45440733432775, -345.8861035704613, 12.739019289612756, -15.216073565185098, -619.0772065073252, 2.6712861061095907, -328.6616882830859, -30.506433822214632, -295.4694359302521, -327.9145068228245, -47.22095686197281, -303.84838899970055, -4.596166837960482, -23.88432578742507, 3.7015445828437805, -44.778251260519056, -333.7804684191942, -325.1458459198475, -27.512070134282112, -319.0774901807308, 41.21016603708266, -1.156596675515189, -29.937254615128055, -48.04849914461374, -9.685515601187944, -302.3400468379259, -316.01289716362953, -304.13278440386057, -339.3202007710934, 19.670816063880906, -27.502093598246574, 6.075781352817984, -23.702075645327596, -308.0470210313797, -8.04880467057231, -316.8111636042595, -315.7213982567191], "episode_lengths": [300, 300, 101, 300, 300, 57, 56, 236, 74, 51, 300, 71, 59, 300, 82, 75, 75, 300, 55, 300, 300, 300, 82, 300, 300, 300, 61, 300, 300, 116, 300, 83, 300, 300, 59, 99, 300, 56, 300, 300, 119, 53, 87, 86, 300, 57, 300, 300, 70, 65, 83, 73, 300, 300, 300, 60, 99, 124, 300, 300, 300, 300, 117, 51, 93, 300, 300, 73, 300, 55, 300, 80, 59, 300, 55, 300, 300, 300, 300, 72, 60, 300, 81, 300, 300, 300, 300, 300, 73, 43, 86, 67, 300, 300, 300, 300, 89, 300, 67, 66], "policy_shared_policy_reward": [-13.33803026874861, -12.67684008864066, -13.374565531810134, -8.108954136570304, -9.175714631875366, -8.241577600439399, -102.03725518286228, -101.65979181975126, -114.98304599523544, -7.921460407475635, -7.688655207554504, -8.933030913273498, -2.305669916172832, -2.0644192968805726, -1.9016739738484318, -105.5713516076406, -101.3779243429502, -100.27826171120009, -96.8599685691297, -98.16583773493767, -110.2947506904602, -130.18046696980795, -126.13120005776486, -126.28454086681208, -102.55550911029181, -104.01250024636587, -118.32375129063925, -113.47035467624664, -100.61576768755913, -100.5278693139553, -18.77523232499759, -18.889392132560417, -19.448081965247795, -219.4638667901357, -202.9766058822473, -202.34610713024935, -104.43130868673325, -104.6610986739397, -122.14728999137878, 3.8093714316685947, 3.498996784289673, 4.521209140618637, -95.37426107997696, -96.08235559860866, -110.50825528303783, -113.57317439715068, -99.84281114737193, -99.18256319562595, -104.27941804130873, -102.49664808933935, -119.95790322621664, 1.6688717653353962, 1.4429659893115314, 1.366760407884911, -100.10992370049159, -113.91331128279369, -100.83782575527827, -5.117136503259346, -4.7530427972475735, -4.510444461057588, -6.19439896941185, -5.987600207328796, -5.984532356262207, -12.45353166013956, -12.703467234969139, -12.755212113261223, -87.10444803535938, -100.2852948307991, -85.99088196828961, 1.8512242684761588, 1.7339012424151008, 1.670203546682984, -13.057209879159927, -11.70036220178008, -12.749911278486252, -0.49961788952350616, -0.21886973083019257, -1.434490293264389, -104.05044856667519, -104.23692363500595, -117.85969543457031, -2.7356236477693017, -2.3335119759043152, -1.9011066484575565, -1.1922514239947049, 0.035892819364860884, 0.14145197470982396, -94.8895085627834, -111.61936048666637, -94.84238103280465, -7.90686356027922, -7.848004867633193, -7.521136497457832, -108.06653694311778, -90.43430843452613, -94.40493003527324, -6.908435056606933, -6.4071614469091145, -6.5803897554675785, -6.694324811299651, -7.966173191865295, -6.698547986646503, -109.28846017519633, -92.69153826932113, -93.45927105347316, -85.56081264217696, -98.20733561118445, -84.03453848262629, 4.344773645202309, 4.726710299650819, 5.204339510450751, -99.4644780009985, -116.71708035469055, -98.8295751363039, 1.7967049976189884, 1.6395385016997608, 1.0319587786992344, -13.849634498357773, -13.288635581731796, -12.77238067984581, -121.24621637662253, -107.33704932530722, -107.02475056548914, -209.72933944066367, -194.129732691062, -208.28441586097082, -99.68139787515005, -94.48749085267386, -93.24903239806494, -102.57209350665411, -100.21417619039616, -118.22599192460379, -13.414205243190139, -13.43231622626385, -14.165170272191375, -107.06305324037871, -120.99530263741812, -110.22072537740073, -4.604471047719329, -5.099947919448226, -4.888760616381973, -6.378560451169818, -6.607202713688224, -6.443700765570014, -108.79016454021136, -108.56652836004893, -123.81473104159038, -111.12606749931972, -96.58995878944795, -97.01493972043197, -216.6909520228704, -201.52640878160796, -200.0097680365046, -102.82854153712591, -115.3518770535787, -102.08704180022082, -11.505420667429775, -12.013979603846877, -11.664940242966026, -1.424394105871528, -1.245471430321544, -1.111724456151336, -0.7497351268927304, -0.3122379841903893, -0.035968069724432894, -102.38220192988715, -101.35497432698807, -116.88662060101828, -111.7765279809634, -111.5844444880883, -127.53914825121562, -115.1312250395616, -113.24885481347641, -104.77638085683188, -6.937196905414268, -6.945979463557407, -7.42330325643222, -5.539270490407944, -5.241273753345013, -5.448843836784363, -9.937081525723144, -9.916707130769893, -9.566814957807466, -10.45571281015873, -10.428936690092087, -9.901344137266278, -100.55107843875885, -84.56011098623276, -84.55667418241501, -100.80969407161078, -99.40675004323325, -112.2379632194837, -111.48042407631874, -124.0535659790039, -110.35211351513863, 3.966708322366074, 4.399744634826973, 4.372566332419709, -5.141717774172633, -4.987924565871566, -5.086431225140899, -200.90071550011635, -199.6249788850546, -218.55151212215424, 1.1664963314930503, 0.8662372628847663, 0.6385525117317741, -120.31890281041464, -103.61513957877955, -104.72764589389166, -10.104223830004543, -10.248612095912307, -10.153597896297782, -93.93357089161873, -107.60332381725311, -93.93254122138023, -106.14333248138428, -117.3734295964241, -104.3977447450161, -15.65868093073368, -15.79189321398735, -15.770382717251778, -99.88713827729225, -103.89678013324738, -100.06447058916092, -1.6922142058610916, -1.0684380568563938, -1.8355145752429962, -8.136685942610114, -7.517592464884132, -8.230047379930824, 1.2770692855119705, 1.3726309537887573, 1.0518443435430527, -14.572059494753688, -15.898852815230697, -14.307338950534671, -105.99060386916003, -121.51663370927176, -106.27323084076247, -104.25623860955238, -104.76699781417847, -116.12260949611664, -9.05188025534153, -9.049603283405304, -9.410586595535278, -99.70116945107779, -100.16122298439345, -119.21509774525961, 13.677363087733582, 13.865410675605133, 13.667392273743943, -0.17445973555247463, -0.3142636964718548, -0.6678732434908596, -10.052648166815445, -10.006961430112526, -9.877645018200084, -16.128488764166832, -15.902943894267082, -16.01706648617983, -3.0244041569530964, -3.4422252476215363, -3.2188861966133118, -99.79142218828201, -99.15262915194035, -103.39599549770355, -102.60391924778621, -111.60729084412257, -101.80168707172076, -96.23760682344437, -95.06789550930262, -112.82728207111359, -109.49792631467184, -120.09173252185187, -109.73054193456969, 6.509403785069779, 6.65408619989951, 6.507326078911618, -9.251053676009178, -9.080799117684364, -9.170240804553032, 1.661377186576516, 2.33788591871658, 2.076518247524888, -7.8897378270824845, -7.973929238816112, -7.838408579429, -101.36357958118121, -102.12892676393191, -104.55451468626659, -2.5936925311883385, -2.6862790336211617, -2.768833105762809, -100.19671793778738, -100.83782519896826, -115.77662046750388, -108.82672329743704, -103.48846783240637, -103.40620712687573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16273505306985953, "mean_inference_ms": 0.6562626416959979, "mean_action_processing_ms": 0.09680587096464745, "mean_env_wait_ms": 0.7861048085543806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 374400, "timers": {"sample_time_ms": 9089.626, "sample_throughput": 528.075, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1161.817, "learn_throughput": 4131.461, "update_time_ms": 1.3}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 606.305793762207, "policy_loss": -0.0032297933660447864, "vf_loss": 606.3624801635742, "vf_explained_var": 0.012378513813018799, "kl": 0.012023351824616007, "entropy": 5.345285058021545, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 374400, "num_steps_trained": 124800, "num_agent_steps_trained": 374400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1278, "training_iteration": 26, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-46-41", "timestamp": 1706147201, "time_this_iter_s": 8.92070198059082, "time_total_s": 244.2181658744812, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 244.2181658744812, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 7.007692307692308, "ram_util_percent": 44.353846153846156}}
{"episode_reward_max": 41.21016603708266, "episode_reward_min": -619.0772065073252, "episode_reward_mean": -164.9324035975241, "episode_len_mean": 193.97, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {"shared_policy": -218.55151212215424}, "policy_reward_max": {"shared_policy": 13.865410675605133}, "policy_reward_mean": {"shared_policy": -54.977467865841376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1529779136180878, -326.14706763625145, -6.970242272131173, -1.01490662992002, -301.3512500822544, -23.276004925370245, -292.90577541291714, -19.895986258983626, -21.35904598981145, -295.4392694979906, -267.80268673598766, 14.275823455303879, -315.01113349199295, 4.4682022780179835, -39.91065075993538, -335.6080162674189, -612.1434879926965, -287.4179211258888, -321.0122616216541, -41.011691741645365, -338.2790812551975, -14.593179583549528, -19.429463930428057, -341.17142394185066, -304.7309660091996, -618.2271288409829, -320.26746039092546, -35.18434051424268, -3.781589992344408, -1.0979411808075525, -320.62379685789347, -350.9001207202673, -333.15646070986986, -21.306479625403895, -16.22938808053732, -29.420603614300504, -30.785993637517095, -269.6678636074066, -312.45440733432775, -345.8861035704613, 12.739019289612756, -15.216073565185098, -619.0772065073252, 2.6712861061095907, -328.6616882830859, -30.506433822214632, -295.4694359302521, -327.9145068228245, -47.22095686197281, -303.84838899970055, -4.596166837960482, -23.88432578742507, 3.7015445828437805, -44.778251260519056, -333.7804684191942, -325.1458459198475, -27.512070134282112, -319.0774901807308, 41.21016603708266, -1.156596675515189, -29.937254615128055, -48.04849914461374, -9.685515601187944, -302.3400468379259, -316.01289716362953, -304.13278440386057, -339.3202007710934, 19.670816063880906, -27.502093598246574, 6.075781352817984, -23.702075645327596, -308.0470210313797, -8.04880467057231, -316.8111636042595, -315.7213982567191, -12.919460453093066, -10.832768201828003, 7.326097801327691, -312.210004016757, -30.7852276340127, -253.35555459558967, -23.286031164228916, -330.8899895250797, -301.0220096409321, -304.0884185433388, -317.64457074925303, -16.758945889771013, -309.2826427668333, -15.163481041789069, -321.1397983272036, -316.7189635448158, -342.4767340421677, -317.8912708237767, -36.10393616557123, 10.88611736893651, -8.87265440635386, 9.118405114859328, -29.052385702729254, -37.60002555698158, -42.50891530513765], "episode_lengths": [300, 61, 300, 300, 116, 300, 83, 300, 300, 59, 99, 300, 56, 300, 300, 119, 53, 87, 86, 300, 57, 300, 300, 70, 65, 83, 73, 300, 300, 300, 60, 99, 124, 300, 300, 300, 300, 117, 51, 93, 300, 300, 73, 300, 55, 300, 80, 59, 300, 55, 300, 300, 300, 300, 72, 60, 300, 81, 300, 300, 300, 300, 300, 73, 43, 86, 67, 300, 300, 300, 300, 89, 300, 67, 66, 300, 300, 300, 79, 300, 94, 300, 53, 78, 62, 41, 300, 61, 300, 79, 85, 80, 48, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-0.49961788952350616, -0.21886973083019257, -1.434490293264389, -104.05044856667519, -104.23692363500595, -117.85969543457031, -2.7356236477693017, -2.3335119759043152, -1.9011066484575565, -1.1922514239947049, 0.035892819364860884, 0.14145197470982396, -94.8895085627834, -111.61936048666637, -94.84238103280465, -7.90686356027922, -7.848004867633193, -7.521136497457832, -108.06653694311778, -90.43430843452613, -94.40493003527324, -6.908435056606933, -6.4071614469091145, -6.5803897554675785, -6.694324811299651, -7.966173191865295, -6.698547986646503, -109.28846017519633, -92.69153826932113, -93.45927105347316, -85.56081264217696, -98.20733561118445, -84.03453848262629, 4.344773645202309, 4.726710299650819, 5.204339510450751, -99.4644780009985, -116.71708035469055, -98.8295751363039, 1.7967049976189884, 1.6395385016997608, 1.0319587786992344, -13.849634498357773, -13.288635581731796, -12.77238067984581, -121.24621637662253, -107.33704932530722, -107.02475056548914, -209.72933944066367, -194.129732691062, -208.28441586097082, -99.68139787515005, -94.48749085267386, -93.24903239806494, -102.57209350665411, -100.21417619039616, -118.22599192460379, -13.414205243190139, -13.43231622626385, -14.165170272191375, -107.06305324037871, -120.99530263741812, -110.22072537740073, -4.604471047719329, -5.099947919448226, -4.888760616381973, -6.378560451169818, -6.607202713688224, -6.443700765570014, -108.79016454021136, -108.56652836004893, -123.81473104159038, -111.12606749931972, -96.58995878944795, -97.01493972043197, -216.6909520228704, -201.52640878160796, -200.0097680365046, -102.82854153712591, -115.3518770535787, -102.08704180022082, -11.505420667429775, -12.013979603846877, -11.664940242966026, -1.424394105871528, -1.245471430321544, -1.111724456151336, -0.7497351268927304, -0.3122379841903893, -0.035968069724432894, -102.38220192988715, -101.35497432698807, -116.88662060101828, -111.7765279809634, -111.5844444880883, -127.53914825121562, -115.1312250395616, -113.24885481347641, -104.77638085683188, -6.937196905414268, -6.945979463557407, -7.42330325643222, -5.539270490407944, -5.241273753345013, -5.448843836784363, -9.937081525723144, -9.916707130769893, -9.566814957807466, -10.45571281015873, -10.428936690092087, -9.901344137266278, -100.55107843875885, -84.56011098623276, -84.55667418241501, -100.80969407161078, -99.40675004323325, -112.2379632194837, -111.48042407631874, -124.0535659790039, -110.35211351513863, 3.966708322366074, 4.399744634826973, 4.372566332419709, -5.141717774172633, -4.987924565871566, -5.086431225140899, -200.90071550011635, -199.6249788850546, -218.55151212215424, 1.1664963314930503, 0.8662372628847663, 0.6385525117317741, -120.31890281041464, -103.61513957877955, -104.72764589389166, -10.104223830004543, -10.248612095912307, -10.153597896297782, -93.93357089161873, -107.60332381725311, -93.93254122138023, -106.14333248138428, -117.3734295964241, -104.3977447450161, -15.65868093073368, -15.79189321398735, -15.770382717251778, -99.88713827729225, -103.89678013324738, -100.06447058916092, -1.6922142058610916, -1.0684380568563938, -1.8355145752429962, -8.136685942610114, -7.517592464884132, -8.230047379930824, 1.2770692855119705, 1.3726309537887573, 1.0518443435430527, -14.572059494753688, -15.898852815230697, -14.307338950534671, -105.99060386916003, -121.51663370927176, -106.27323084076247, -104.25623860955238, -104.76699781417847, -116.12260949611664, -9.05188025534153, -9.049603283405304, -9.410586595535278, -99.70116945107779, -100.16122298439345, -119.21509774525961, 13.677363087733582, 13.865410675605133, 13.667392273743943, -0.17445973555247463, -0.3142636964718548, -0.6678732434908596, -10.052648166815445, -10.006961430112526, -9.877645018200084, -16.128488764166832, -15.902943894267082, -16.01706648617983, -3.0244041569530964, -3.4422252476215363, -3.2188861966133118, -99.79142218828201, -99.15262915194035, -103.39599549770355, -102.60391924778621, -111.60729084412257, -101.80168707172076, -96.23760682344437, -95.06789550930262, -112.82728207111359, -109.49792631467184, -120.09173252185187, -109.73054193456969, 6.509403785069779, 6.65408619989951, 6.507326078911618, -9.251053676009178, -9.080799117684364, -9.170240804553032, 1.661377186576516, 2.33788591871658, 2.076518247524888, -7.8897378270824845, -7.973929238816112, -7.838408579429, -101.36357958118121, -102.12892676393191, -104.55451468626659, -2.5936925311883385, -2.6862790336211617, -2.768833105762809, -100.19671793778738, -100.83782519896826, -115.77662046750388, -108.82672329743704, -103.48846783240637, -103.40620712687573, -4.127976196507618, -4.3623490730921475, -4.429135183493301, -4.301706939935684, -3.276924803853035, -3.2541364580392838, 2.425137576957539, 2.337276195486382, 2.5636840288837703, -98.21482762197654, -98.56577030817668, -115.4294060866038, -10.150943346321583, -10.205403849482536, -10.42888043820858, -78.93908451994261, -95.52098687489828, -78.89548320074877, -7.838220849633217, -7.631964340806007, -7.815845973789692, -118.70405731598537, -105.29324052731197, -106.89269168178241, -109.71155571937561, -95.40757152438164, -95.90288239717484, -99.57536500692368, -102.06719261407852, -102.44586092233658, -101.48823566734791, -101.19708707556129, -114.95924800634384, -5.871901949246734, -5.498214689393848, -5.388829251130431, -97.04173923035464, -112.23181374867758, -100.00908978780112, -4.938383969167873, -4.903535815576717, -5.321561257044479, -103.44869643449783, -115.9397628903389, -101.75133900236688, -109.24565827846527, -104.79200920462608, -102.68129606172442, -110.25730906923613, -123.03338303168616, -109.1860419412454, -101.40356421718995, -101.85555007557075, -114.63215653101604, -11.61164202789466, -11.968828673164055, -12.523465464512512, 3.6002527798215453, 3.647047119836003, 3.638817469278962, -3.029022482534259, -3.186706607540458, -2.6569253162791426, 3.1339887653787883, 3.324185156573847, 2.660231192906693, -10.136488010485976, -9.259218429525703, -9.656679262717574, -12.379165808359787, -12.245027827719852, -12.975831920901939, -14.354320446650192, -14.496896396080658, -13.657698462406799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1621746536344669, "mean_inference_ms": 0.6554439249761669, "mean_action_processing_ms": 0.09663706411743046, "mean_env_wait_ms": 0.7857487948025441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 129600, "timesteps_this_iter": 0, "agent_timesteps_total": 388800, "timers": {"sample_time_ms": 9091.546, "sample_throughput": 527.963, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1149.922, "learn_throughput": 4174.194, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 583.3043746948242, "policy_loss": -0.002774989876585754, "vf_loss": 583.3600692749023, "vf_explained_var": 0.01827329397201538, "kl": 0.008994949188497997, "entropy": 5.296053111553192, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 129600, "num_agent_steps_sampled": 388800, "num_steps_trained": 129600, "num_agent_steps_trained": 388800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1303, "training_iteration": 27, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-46-50", "timestamp": 1706147210, "time_this_iter_s": 9.52213716506958, "time_total_s": 253.74030303955078, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 253.74030303955078, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 6.7153846153846155, "ram_util_percent": 44.49230769230769}}
{"episode_reward_max": 41.21016603708266, "episode_reward_min": -619.0772065073252, "episode_reward_mean": -154.90118283579562, "episode_len_mean": 201.42, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {"shared_policy": -218.55151212215424}, "policy_reward_max": {"shared_policy": 13.865410675605133}, "policy_reward_mean": {"shared_policy": -51.63372761193188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.593179583549528, -19.429463930428057, -341.17142394185066, -304.7309660091996, -618.2271288409829, -320.26746039092546, -35.18434051424268, -3.781589992344408, -1.0979411808075525, -320.62379685789347, -350.9001207202673, -333.15646070986986, -21.306479625403895, -16.22938808053732, -29.420603614300504, -30.785993637517095, -269.6678636074066, -312.45440733432775, -345.8861035704613, 12.739019289612756, -15.216073565185098, -619.0772065073252, 2.6712861061095907, -328.6616882830859, -30.506433822214632, -295.4694359302521, -327.9145068228245, -47.22095686197281, -303.84838899970055, -4.596166837960482, -23.88432578742507, 3.7015445828437805, -44.778251260519056, -333.7804684191942, -325.1458459198475, -27.512070134282112, -319.0774901807308, 41.21016603708266, -1.156596675515189, -29.937254615128055, -48.04849914461374, -9.685515601187944, -302.3400468379259, -316.01289716362953, -304.13278440386057, -339.3202007710934, 19.670816063880906, -27.502093598246574, 6.075781352817984, -23.702075645327596, -308.0470210313797, -8.04880467057231, -316.8111636042595, -315.7213982567191, -12.919460453093066, -10.832768201828003, 7.326097801327691, -312.210004016757, -30.7852276340127, -253.35555459558967, -23.286031164228916, -330.8899895250797, -301.0220096409321, -304.0884185433388, -317.64457074925303, -16.758945889771013, -309.2826427668333, -15.163481041789069, -321.1397983272036, -316.7189635448158, -342.4767340421677, -317.8912708237767, -36.10393616557123, 10.88611736893651, -8.87265440635386, 9.118405114859328, -29.052385702729254, -37.60002555698158, -42.50891530513765, -301.72884607315063, -318.0899749174714, -335.0381171107292, -23.306361645460157, -285.52834196388727, -14.606125753372936, -48.913311656564474, -35.744328800588875, -32.640189243014916, -37.18616392463447, 1.2108242884278013, -307.491730555892, -6.252640351653113, -64.71999849379068, -319.73279616981745, -312.616782039404, -10.619210772216334, -47.4419204220176, -326.194644920528, -5.538675112649813, 5.33597993291913], "episode_lengths": [300, 300, 70, 65, 83, 73, 300, 300, 300, 60, 99, 124, 300, 300, 300, 300, 117, 51, 93, 300, 300, 73, 300, 55, 300, 80, 59, 300, 55, 300, 300, 300, 300, 72, 60, 300, 81, 300, 300, 300, 300, 300, 73, 43, 86, 67, 300, 300, 300, 300, 89, 300, 67, 66, 300, 300, 300, 79, 300, 94, 300, 53, 78, 62, 41, 300, 61, 300, 79, 85, 80, 48, 300, 300, 300, 300, 300, 300, 300, 69, 203, 96, 300, 89, 300, 300, 300, 300, 300, 300, 58, 300, 300, 68, 72, 300, 300, 66, 300, 300], "policy_shared_policy_reward": [-4.604471047719329, -5.099947919448226, -4.888760616381973, -6.378560451169818, -6.607202713688224, -6.443700765570014, -108.79016454021136, -108.56652836004893, -123.81473104159038, -111.12606749931972, -96.58995878944795, -97.01493972043197, -216.6909520228704, -201.52640878160796, -200.0097680365046, -102.82854153712591, -115.3518770535787, -102.08704180022082, -11.505420667429775, -12.013979603846877, -11.664940242966026, -1.424394105871528, -1.245471430321544, -1.111724456151336, -0.7497351268927304, -0.3122379841903893, -0.035968069724432894, -102.38220192988715, -101.35497432698807, -116.88662060101828, -111.7765279809634, -111.5844444880883, -127.53914825121562, -115.1312250395616, -113.24885481347641, -104.77638085683188, -6.937196905414268, -6.945979463557407, -7.42330325643222, -5.539270490407944, -5.241273753345013, -5.448843836784363, -9.937081525723144, -9.916707130769893, -9.566814957807466, -10.45571281015873, -10.428936690092087, -9.901344137266278, -100.55107843875885, -84.56011098623276, -84.55667418241501, -100.80969407161078, -99.40675004323325, -112.2379632194837, -111.48042407631874, -124.0535659790039, -110.35211351513863, 3.966708322366074, 4.399744634826973, 4.372566332419709, -5.141717774172633, -4.987924565871566, -5.086431225140899, -200.90071550011635, -199.6249788850546, -218.55151212215424, 1.1664963314930503, 0.8662372628847663, 0.6385525117317741, -120.31890281041464, -103.61513957877955, -104.72764589389166, -10.104223830004543, -10.248612095912307, -10.153597896297782, -93.93357089161873, -107.60332381725311, -93.93254122138023, -106.14333248138428, -117.3734295964241, -104.3977447450161, -15.65868093073368, -15.79189321398735, -15.770382717251778, -99.88713827729225, -103.89678013324738, -100.06447058916092, -1.6922142058610916, -1.0684380568563938, -1.8355145752429962, -8.136685942610114, -7.517592464884132, -8.230047379930824, 1.2770692855119705, 1.3726309537887573, 1.0518443435430527, -14.572059494753688, -15.898852815230697, -14.307338950534671, -105.99060386916003, -121.51663370927176, -106.27323084076247, -104.25623860955238, -104.76699781417847, -116.12260949611664, -9.05188025534153, -9.049603283405304, -9.410586595535278, -99.70116945107779, -100.16122298439345, -119.21509774525961, 13.677363087733582, 13.865410675605133, 13.667392273743943, -0.17445973555247463, -0.3142636964718548, -0.6678732434908596, -10.052648166815445, -10.006961430112526, -9.877645018200084, -16.128488764166832, -15.902943894267082, -16.01706648617983, -3.0244041569530964, -3.4422252476215363, -3.2188861966133118, -99.79142218828201, -99.15262915194035, -103.39599549770355, -102.60391924778621, -111.60729084412257, -101.80168707172076, -96.23760682344437, -95.06789550930262, -112.82728207111359, -109.49792631467184, -120.09173252185187, -109.73054193456969, 6.509403785069779, 6.65408619989951, 6.507326078911618, -9.251053676009178, -9.080799117684364, -9.170240804553032, 1.661377186576516, 2.33788591871658, 2.076518247524888, -7.8897378270824845, -7.973929238816112, -7.838408579429, -101.36357958118121, -102.12892676393191, -104.55451468626659, -2.5936925311883385, -2.6862790336211617, -2.768833105762809, -100.19671793778738, -100.83782519896826, -115.77662046750388, -108.82672329743704, -103.48846783240637, -103.40620712687573, -4.127976196507618, -4.3623490730921475, -4.429135183493301, -4.301706939935684, -3.276924803853035, -3.2541364580392838, 2.425137576957539, 2.337276195486382, 2.5636840288837703, -98.21482762197654, -98.56577030817668, -115.4294060866038, -10.150943346321583, -10.205403849482536, -10.42888043820858, -78.93908451994261, -95.52098687489828, -78.89548320074877, -7.838220849633217, -7.631964340806007, -7.815845973789692, -118.70405731598537, -105.29324052731197, -106.89269168178241, -109.71155571937561, -95.40757152438164, -95.90288239717484, -99.57536500692368, -102.06719261407852, -102.44586092233658, -101.48823566734791, -101.19708707556129, -114.95924800634384, -5.871901949246734, -5.498214689393848, -5.388829251130431, -97.04173923035464, -112.23181374867758, -100.00908978780112, -4.938383969167873, -4.903535815576717, -5.321561257044479, -103.44869643449783, -115.9397628903389, -101.75133900236688, -109.24565827846527, -104.79200920462608, -102.68129606172442, -110.25730906923613, -123.03338303168616, -109.1860419412454, -101.40356421718995, -101.85555007557075, -114.63215653101604, -11.61164202789466, -11.968828673164055, -12.523465464512512, 3.6002527798215453, 3.647047119836003, 3.638817469278962, -3.029022482534259, -3.186706607540458, -2.6569253162791426, 3.1339887653787883, 3.324185156573847, 2.660231192906693, -10.136488010485976, -9.259218429525703, -9.656679262717574, -12.379165808359787, -12.245027827719852, -12.975831920901939, -14.354320446650192, -14.496896396080658, -13.657698462406799, -109.53284351030986, -97.16619966427486, -95.02980289856593, -101.99833475798368, -103.27832353115082, -112.8133166283369, -107.31182165940604, -108.59068789084753, -119.13560756047568, -7.788398583730071, -7.758144830664008, -7.7598182310660775, -89.40601611634096, -105.73602946599325, -90.38629638155302, -4.652069052060455, -4.4712370348473485, -5.482819666465133, -16.41656368225813, -16.349610306322575, -16.14713766798377, -11.451017112781614, -12.677883674701064, -11.615428013106197, -11.202471981445953, -10.641352195447936, -10.796365066121027, -12.645210127035782, -12.587766225139305, -11.953187572459385, 0.3638246903816764, 0.47295695791640924, 0.37404264012971566, -100.54559686283271, -101.0559667746226, -105.89016691843669, -1.9190279940764157, -2.440056184927627, -1.8935561726490704, -21.931679159402854, -21.382058247923858, -21.406261086463935, -117.8188989162445, -101.72605550289154, -100.1878417506814, -113.85711093743643, -99.06993185480437, -99.68973924716315, -3.2897188464800564, -3.133186581234142, -4.196305344502136, -15.65878572811684, -15.776431513329356, -16.006703180571407, -101.94361646225056, -104.96132322152457, -119.28970523675284, -1.5810118174801318, -2.1706401209036557, -1.7870231742660252, 1.3805031826098713, 1.5136902829011234, 2.4417864674081358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16161371737300825, "mean_inference_ms": 0.6548291219261874, "mean_action_processing_ms": 0.09650202407113045, "mean_env_wait_ms": 0.7855418683017871, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"sample_time_ms": 9089.811, "sample_throughput": 528.064, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1192.354, "learn_throughput": 4025.65, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 478.8271369934082, "policy_loss": -0.003679073413562328, "vf_loss": 478.8834800720215, "vf_explained_var": 0.026407428085803986, "kl": 0.011290332135111474, "entropy": 5.270731806755066, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 403200, "num_steps_trained": 134400, "num_agent_steps_trained": 403200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1324, "training_iteration": 28, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-47-00", "timestamp": 1706147220, "time_this_iter_s": 9.53071141242981, "time_total_s": 263.2710144519806, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 263.2710144519806, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 8.357142857142856, "ram_util_percent": 44.32857142857143}}
{"episode_reward_max": 41.21016603708266, "episode_reward_min": -342.4767340421677, "episode_reward_mean": -140.79370800800942, "episode_len_mean": 205.83, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"shared_policy": -123.03338303168616}, "policy_reward_max": {"shared_policy": 13.865410675605133}, "policy_reward_mean": {"shared_policy": -46.93123600266981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-328.6616882830859, -30.506433822214632, -295.4694359302521, -327.9145068228245, -47.22095686197281, -303.84838899970055, -4.596166837960482, -23.88432578742507, 3.7015445828437805, -44.778251260519056, -333.7804684191942, -325.1458459198475, -27.512070134282112, -319.0774901807308, 41.21016603708266, -1.156596675515189, -29.937254615128055, -48.04849914461374, -9.685515601187944, -302.3400468379259, -316.01289716362953, -304.13278440386057, -339.3202007710934, 19.670816063880906, -27.502093598246574, 6.075781352817984, -23.702075645327596, -308.0470210313797, -8.04880467057231, -316.8111636042595, -315.7213982567191, -12.919460453093066, -10.832768201828003, 7.326097801327691, -312.210004016757, -30.7852276340127, -253.35555459558967, -23.286031164228916, -330.8899895250797, -301.0220096409321, -304.0884185433388, -317.64457074925303, -16.758945889771013, -309.2826427668333, -15.163481041789069, -321.1397983272036, -316.7189635448158, -342.4767340421677, -317.8912708237767, -36.10393616557123, 10.88611736893651, -8.87265440635386, 9.118405114859328, -29.052385702729254, -37.60002555698158, -42.50891530513765, -301.72884607315063, -318.0899749174714, -335.0381171107292, -23.306361645460157, -285.52834196388727, -14.606125753372936, -48.913311656564474, -35.744328800588875, -32.640189243014916, -37.18616392463447, 1.2108242884278013, -307.491730555892, -6.252640351653113, -64.71999849379068, -319.73279616981745, -312.616782039404, -10.619210772216334, -47.4419204220176, -326.194644920528, -5.538675112649813, 5.33597993291913, -17.759850017726436, 6.132113032042966, -300.34905789466575, -271.4914611168206, -288.73150800541043, -326.2695267647505, -6.044163629412651, -73.48160195723183, -314.00556664168835, 5.157866433262825, -31.0462446808815, -321.16176506876945, -279.4084666431882, 5.62765321880579, -27.61692859418693, -308.9897499680519, 7.6263646809384085, 0.9531111456453658, -17.178513497114196, 1.497276060283184, -6.570021435618401, -11.854455940425424, -322.0857067555189], "episode_lengths": [55, 300, 80, 59, 300, 55, 300, 300, 300, 300, 72, 60, 300, 81, 300, 300, 300, 300, 300, 73, 43, 86, 67, 300, 300, 300, 300, 89, 300, 67, 66, 300, 300, 300, 79, 300, 94, 300, 53, 78, 62, 41, 300, 61, 300, 79, 85, 80, 48, 300, 300, 300, 300, 300, 300, 300, 69, 203, 96, 300, 89, 300, 300, 300, 300, 300, 300, 58, 300, 300, 68, 72, 300, 300, 66, 300, 300, 300, 300, 69, 128, 78, 52, 300, 300, 64, 300, 300, 69, 80, 300, 300, 127, 300, 300, 300, 300, 300, 300, 82], "policy_shared_policy_reward": [-120.31890281041464, -103.61513957877955, -104.72764589389166, -10.104223830004543, -10.248612095912307, -10.153597896297782, -93.93357089161873, -107.60332381725311, -93.93254122138023, -106.14333248138428, -117.3734295964241, -104.3977447450161, -15.65868093073368, -15.79189321398735, -15.770382717251778, -99.88713827729225, -103.89678013324738, -100.06447058916092, -1.6922142058610916, -1.0684380568563938, -1.8355145752429962, -8.136685942610114, -7.517592464884132, -8.230047379930824, 1.2770692855119705, 1.3726309537887573, 1.0518443435430527, -14.572059494753688, -15.898852815230697, -14.307338950534671, -105.99060386916003, -121.51663370927176, -106.27323084076247, -104.25623860955238, -104.76699781417847, -116.12260949611664, -9.05188025534153, -9.049603283405304, -9.410586595535278, -99.70116945107779, -100.16122298439345, -119.21509774525961, 13.677363087733582, 13.865410675605133, 13.667392273743943, -0.17445973555247463, -0.3142636964718548, -0.6678732434908596, -10.052648166815445, -10.006961430112526, -9.877645018200084, -16.128488764166832, -15.902943894267082, -16.01706648617983, -3.0244041569530964, -3.4422252476215363, -3.2188861966133118, -99.79142218828201, -99.15262915194035, -103.39599549770355, -102.60391924778621, -111.60729084412257, -101.80168707172076, -96.23760682344437, -95.06789550930262, -112.82728207111359, -109.49792631467184, -120.09173252185187, -109.73054193456969, 6.509403785069779, 6.65408619989951, 6.507326078911618, -9.251053676009178, -9.080799117684364, -9.170240804553032, 1.661377186576516, 2.33788591871658, 2.076518247524888, -7.8897378270824845, -7.973929238816112, -7.838408579429, -101.36357958118121, -102.12892676393191, -104.55451468626659, -2.5936925311883385, -2.6862790336211617, -2.768833105762809, -100.19671793778738, -100.83782519896826, -115.77662046750388, -108.82672329743704, -103.48846783240637, -103.40620712687573, -4.127976196507618, -4.3623490730921475, -4.429135183493301, -4.301706939935684, -3.276924803853035, -3.2541364580392838, 2.425137576957539, 2.337276195486382, 2.5636840288837703, -98.21482762197654, -98.56577030817668, -115.4294060866038, -10.150943346321583, -10.205403849482536, -10.42888043820858, -78.93908451994261, -95.52098687489828, -78.89548320074877, -7.838220849633217, -7.631964340806007, -7.815845973789692, -118.70405731598537, -105.29324052731197, -106.89269168178241, -109.71155571937561, -95.40757152438164, -95.90288239717484, -99.57536500692368, -102.06719261407852, -102.44586092233658, -101.48823566734791, -101.19708707556129, -114.95924800634384, -5.871901949246734, -5.498214689393848, -5.388829251130431, -97.04173923035464, -112.23181374867758, -100.00908978780112, -4.938383969167873, -4.903535815576717, -5.321561257044479, -103.44869643449783, -115.9397628903389, -101.75133900236688, -109.24565827846527, -104.79200920462608, -102.68129606172442, -110.25730906923613, -123.03338303168616, -109.1860419412454, -101.40356421718995, -101.85555007557075, -114.63215653101604, -11.61164202789466, -11.968828673164055, -12.523465464512512, 3.6002527798215453, 3.647047119836003, 3.638817469278962, -3.029022482534259, -3.186706607540458, -2.6569253162791426, 3.1339887653787883, 3.324185156573847, 2.660231192906693, -10.136488010485976, -9.259218429525703, -9.656679262717574, -12.379165808359787, -12.245027827719852, -12.975831920901939, -14.354320446650192, -14.496896396080658, -13.657698462406799, -109.53284351030986, -97.16619966427486, -95.02980289856593, -101.99833475798368, -103.27832353115082, -112.8133166283369, -107.31182165940604, -108.59068789084753, -119.13560756047568, -7.788398583730071, -7.758144830664008, -7.7598182310660775, -89.40601611634096, -105.73602946599325, -90.38629638155302, -4.652069052060455, -4.4712370348473485, -5.482819666465133, -16.41656368225813, -16.349610306322575, -16.14713766798377, -11.451017112781614, -12.677883674701064, -11.615428013106197, -11.202471981445953, -10.641352195447936, -10.796365066121027, -12.645210127035782, -12.587766225139305, -11.953187572459385, 0.3638246903816764, 0.47295695791640924, 0.37404264012971566, -100.54559686283271, -101.0559667746226, -105.89016691843669, -1.9190279940764157, -2.440056184927627, -1.8935561726490704, -21.931679159402854, -21.382058247923858, -21.406261086463935, -117.8188989162445, -101.72605550289154, -100.1878417506814, -113.85711093743643, -99.06993185480437, -99.68973924716315, -3.2897188464800564, -3.133186581234142, -4.196305344502136, -15.65878572811684, -15.776431513329356, -16.006703180571407, -101.94361646225056, -104.96132322152457, -119.28970523675284, -1.5810118174801318, -2.1706401209036557, -1.7870231742660252, 1.3805031826098713, 1.5136902829011234, 2.4417864674081358, -6.060166592399284, -5.8705228293935505, -5.829160595933601, 2.0522823904951366, 1.8392876883347782, 2.240542953213051, -109.28451561927795, -93.87583951326087, -97.18870276212692, -84.60155513137579, -102.52412855625153, -84.36577742919326, -95.66308405001959, -93.98272229110202, -99.08570166428885, -102.39040543138981, -120.07101011276245, -103.80811122059822, -1.7406702414155006, -2.6623032987117767, -1.6411900892853737, -24.5044977888465, -24.055025141686208, -24.922079026699073, -98.78758808970451, -98.3244071751833, -116.89357137680054, 1.6523335725069046, 1.7567306607961655, 1.748802199959755, -10.440773539245129, -10.170190468430519, -10.435280673205853, -105.0399638414383, -112.58758690953255, -103.53421431779861, -88.28766639096042, -102.9174169500669, -88.20338330216086, 1.9801017493009567, 1.6663982570171356, 1.9811532124876976, -9.541582276423782, -8.89005136427781, -9.18529495348534, -102.23385874430339, -108.43091409901778, -98.32497712473075, 2.50173072268565, 2.3798292403419765, 2.7448047179107817, 0.18383429696162068, 0.14909518261750065, 0.6201816660662445, -6.014847959081337, -5.796036029855415, -5.367629508177444, 0.5327426791191101, 0.5942555293440819, 0.37027785181999207, -2.1032487228512764, -2.111683376133442, -2.3550893366336823, -4.0313790192206795, -3.6400683050354417, -4.183008616169303, -102.68972531457743, -103.81052278478941, -115.5854586561521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16101830279576088, "mean_inference_ms": 0.6544998526051767, "mean_action_processing_ms": 0.09640768398632556, "mean_env_wait_ms": 0.7854988187748378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 139200, "timesteps_this_iter": 0, "agent_timesteps_total": 417600, "timers": {"sample_time_ms": 9156.302, "sample_throughput": 524.229, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1195.461, "learn_throughput": 4015.188, "update_time_ms": 1.4}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 512.3503761291504, "policy_loss": -0.0033802447192526064, "vf_loss": 512.4033737182617, "vf_explained_var": 0.04540049284696579, "kl": 0.009111054125250415, "entropy": 4.963119328022003, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 139200, "num_agent_steps_sampled": 417600, "num_steps_trained": 139200, "num_agent_steps_trained": 417600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1347, "training_iteration": 29, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-47-09", "timestamp": 1706147229, "time_this_iter_s": 9.370607852935791, "time_total_s": 272.6416223049164, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055ED30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 272.6416223049164, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 6.8076923076923075, "ram_util_percent": 44.93076923076923}}
{"episode_reward_max": 22.691560104489298, "episode_reward_min": -342.4767340421677, "episode_reward_mean": -121.92342749800854, "episode_len_mean": 219.79, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -123.03338303168616}, "policy_reward_max": {"shared_policy": 7.779625857869775}, "policy_reward_mean": {"shared_policy": -40.64114249933618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.04849914461374, -9.685515601187944, -302.3400468379259, -316.01289716362953, -304.13278440386057, -339.3202007710934, 19.670816063880906, -27.502093598246574, 6.075781352817984, -23.702075645327596, -308.0470210313797, -8.04880467057231, -316.8111636042595, -315.7213982567191, -12.919460453093066, -10.832768201828003, 7.326097801327691, -312.210004016757, -30.7852276340127, -253.35555459558967, -23.286031164228916, -330.8899895250797, -301.0220096409321, -304.0884185433388, -317.64457074925303, -16.758945889771013, -309.2826427668333, -15.163481041789069, -321.1397983272036, -316.7189635448158, -342.4767340421677, -317.8912708237767, -36.10393616557123, 10.88611736893651, -8.87265440635386, 9.118405114859328, -29.052385702729254, -37.60002555698158, -42.50891530513765, -301.72884607315063, -318.0899749174714, -335.0381171107292, -23.306361645460157, -285.52834196388727, -14.606125753372936, -48.913311656564474, -35.744328800588875, -32.640189243014916, -37.18616392463447, 1.2108242884278013, -307.491730555892, -6.252640351653113, -64.71999849379068, -319.73279616981745, -312.616782039404, -10.619210772216334, -47.4419204220176, -326.194644920528, -5.538675112649813, 5.33597993291913, -17.759850017726436, 6.132113032042966, -300.34905789466575, -271.4914611168206, -288.73150800541043, -326.2695267647505, -6.044163629412651, -73.48160195723183, -314.00556664168835, 5.157866433262825, -31.0462446808815, -321.16176506876945, -279.4084666431882, 5.62765321880579, -27.61692859418693, -308.9897499680519, 7.6263646809384085, 0.9531111456453658, -17.178513497114196, 1.497276060283184, -6.570021435618401, -11.854455940425424, -322.0857067555189, -46.549223192036166, -10.488341659307494, -25.353310219943538, 22.691560104489298, -51.6452409848571, -16.516139544546604, 5.6198102980851985, -43.0298074707389, 4.489805333316312, -14.001873485744028, 10.53333180397749, -14.56203371658924, -8.405373394489317, -10.631127029657392, -17.040658570826082, -301.77253302931786, 5.111035827547298], "episode_lengths": [300, 300, 73, 43, 86, 67, 300, 300, 300, 300, 89, 300, 67, 66, 300, 300, 300, 79, 300, 94, 300, 53, 78, 62, 41, 300, 61, 300, 79, 85, 80, 48, 300, 300, 300, 300, 300, 300, 300, 69, 203, 96, 300, 89, 300, 300, 300, 300, 300, 300, 58, 300, 300, 68, 72, 300, 300, 66, 300, 300, 300, 300, 69, 128, 78, 52, 300, 300, 64, 300, 300, 69, 80, 300, 300, 127, 300, 300, 300, 300, 300, 300, 82, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 58, 300], "policy_shared_policy_reward": [-16.128488764166832, -15.902943894267082, -16.01706648617983, -3.0244041569530964, -3.4422252476215363, -3.2188861966133118, -99.79142218828201, -99.15262915194035, -103.39599549770355, -102.60391924778621, -111.60729084412257, -101.80168707172076, -96.23760682344437, -95.06789550930262, -112.82728207111359, -109.49792631467184, -120.09173252185187, -109.73054193456969, 6.509403785069779, 6.65408619989951, 6.507326078911618, -9.251053676009178, -9.080799117684364, -9.170240804553032, 1.661377186576516, 2.33788591871658, 2.076518247524888, -7.8897378270824845, -7.973929238816112, -7.838408579429, -101.36357958118121, -102.12892676393191, -104.55451468626659, -2.5936925311883385, -2.6862790336211617, -2.768833105762809, -100.19671793778738, -100.83782519896826, -115.77662046750388, -108.82672329743704, -103.48846783240637, -103.40620712687573, -4.127976196507618, -4.3623490730921475, -4.429135183493301, -4.301706939935684, -3.276924803853035, -3.2541364580392838, 2.425137576957539, 2.337276195486382, 2.5636840288837703, -98.21482762197654, -98.56577030817668, -115.4294060866038, -10.150943346321583, -10.205403849482536, -10.42888043820858, -78.93908451994261, -95.52098687489828, -78.89548320074877, -7.838220849633217, -7.631964340806007, -7.815845973789692, -118.70405731598537, -105.29324052731197, -106.89269168178241, -109.71155571937561, -95.40757152438164, -95.90288239717484, -99.57536500692368, -102.06719261407852, -102.44586092233658, -101.48823566734791, -101.19708707556129, -114.95924800634384, -5.871901949246734, -5.498214689393848, -5.388829251130431, -97.04173923035464, -112.23181374867758, -100.00908978780112, -4.938383969167873, -4.903535815576717, -5.321561257044479, -103.44869643449783, -115.9397628903389, -101.75133900236688, -109.24565827846527, -104.79200920462608, -102.68129606172442, -110.25730906923613, -123.03338303168616, -109.1860419412454, -101.40356421718995, -101.85555007557075, -114.63215653101604, -11.61164202789466, -11.968828673164055, -12.523465464512512, 3.6002527798215453, 3.647047119836003, 3.638817469278962, -3.029022482534259, -3.186706607540458, -2.6569253162791426, 3.1339887653787883, 3.324185156573847, 2.660231192906693, -10.136488010485976, -9.259218429525703, -9.656679262717574, -12.379165808359787, -12.245027827719852, -12.975831920901939, -14.354320446650192, -14.496896396080658, -13.657698462406799, -109.53284351030986, -97.16619966427486, -95.02980289856593, -101.99833475798368, -103.27832353115082, -112.8133166283369, -107.31182165940604, -108.59068789084753, -119.13560756047568, -7.788398583730071, -7.758144830664008, -7.7598182310660775, -89.40601611634096, -105.73602946599325, -90.38629638155302, -4.652069052060455, -4.4712370348473485, -5.482819666465133, -16.41656368225813, -16.349610306322575, -16.14713766798377, -11.451017112781614, -12.677883674701064, -11.615428013106197, -11.202471981445953, -10.641352195447936, -10.796365066121027, -12.645210127035782, -12.587766225139305, -11.953187572459385, 0.3638246903816764, 0.47295695791640924, 0.37404264012971566, -100.54559686283271, -101.0559667746226, -105.89016691843669, -1.9190279940764157, -2.440056184927627, -1.8935561726490704, -21.931679159402854, -21.382058247923858, -21.406261086463935, -117.8188989162445, -101.72605550289154, -100.1878417506814, -113.85711093743643, -99.06993185480437, -99.68973924716315, -3.2897188464800564, -3.133186581234142, -4.196305344502136, -15.65878572811684, -15.776431513329356, -16.006703180571407, -101.94361646225056, -104.96132322152457, -119.28970523675284, -1.5810118174801318, -2.1706401209036557, -1.7870231742660252, 1.3805031826098713, 1.5136902829011234, 2.4417864674081358, -6.060166592399284, -5.8705228293935505, -5.829160595933601, 2.0522823904951366, 1.8392876883347782, 2.240542953213051, -109.28451561927795, -93.87583951326087, -97.18870276212692, -84.60155513137579, -102.52412855625153, -84.36577742919326, -95.66308405001959, -93.98272229110202, -99.08570166428885, -102.39040543138981, -120.07101011276245, -103.80811122059822, -1.7406702414155006, -2.6623032987117767, -1.6411900892853737, -24.5044977888465, -24.055025141686208, -24.922079026699073, -98.78758808970451, -98.3244071751833, -116.89357137680054, 1.6523335725069046, 1.7567306607961655, 1.748802199959755, -10.440773539245129, -10.170190468430519, -10.435280673205853, -105.0399638414383, -112.58758690953255, -103.53421431779861, -88.28766639096042, -102.9174169500669, -88.20338330216086, 1.9801017493009567, 1.6663982570171356, 1.9811532124876976, -9.541582276423782, -8.89005136427781, -9.18529495348534, -102.23385874430339, -108.43091409901778, -98.32497712473075, 2.50173072268565, 2.3798292403419765, 2.7448047179107817, 0.18383429696162068, 0.14909518261750065, 0.6201816660662445, -6.014847959081337, -5.796036029855415, -5.367629508177444, 0.5327426791191101, 0.5942555293440819, 0.37027785181999207, -2.1032487228512764, -2.111683376133442, -2.3550893366336823, -4.0313790192206795, -3.6400683050354417, -4.183008616169303, -102.68972531457743, -103.81052278478941, -115.5854586561521, -15.901701504985496, -15.507379824916526, -15.140141862134143, -3.758252109090492, -3.471657628814384, -3.258431921402618, -8.049579399327442, -8.364057416717216, -8.93967340389888, 7.337182591358811, 7.574751655260712, 7.779625857869775, -17.2120190213124, -17.220764177540943, -17.212457786003753, -5.15156839042902, -5.460328608751297, -5.904242545366287, 1.7751009513934406, 2.0852318902810367, 1.7594774564107212, -14.292617949346706, -14.403593714038536, -14.33359580735366, 1.5581042965253147, 1.5913635765512737, 1.3403374602397236, -4.5940548603733475, -4.644818459947913, -4.763000165422767, 3.550387479364872, 3.5793440118432045, 3.403600312769413, -5.052011256416648, -4.861323182781547, -4.648699277391046, -2.6625353967150147, -3.10208020110926, -2.640757796665042, -3.599643324812263, -3.527497900029033, -3.5039858048160966, -5.73412795116505, -5.728682880600303, -5.577847739060729, -99.09091379741828, -98.90329327682655, -103.77832595507304, 1.5259373535712513, 1.638586369653538, 1.9465121043225082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16057022393474166, "mean_inference_ms": 0.6543456227577975, "mean_action_processing_ms": 0.09638086231310193, "mean_env_wait_ms": 0.7855628499509563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 9180.296, "sample_throughput": 522.859, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1199.661, "learn_throughput": 4001.131, "update_time_ms": 1.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 135.49413776397705, "policy_loss": -0.0024446719246205006, "vf_loss": 135.54264640808105, "vf_explained_var": -0.08309242129325867, "kl": 0.008912289617009272, "entropy": 4.607887923717499, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 432000, "num_steps_trained": 144000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1364, "training_iteration": 30, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-47-19", "timestamp": 1706147239, "time_this_iter_s": 9.186909675598145, "time_total_s": 281.8285319805145, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632B39D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 281.8285319805145, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 8.36923076923077, "ram_util_percent": 44.74615384615385}}
{"episode_reward_max": 22.691560104489298, "episode_reward_min": -342.4767340421677, "episode_reward_mean": -106.81800942059927, "episode_len_mean": 230.83, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {"shared_policy": -123.03338303168616}, "policy_reward_max": {"shared_policy": 7.779625857869775}, "policy_reward_mean": {"shared_policy": -35.60600314019975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.7852276340127, -253.35555459558967, -23.286031164228916, -330.8899895250797, -301.0220096409321, -304.0884185433388, -317.64457074925303, -16.758945889771013, -309.2826427668333, -15.163481041789069, -321.1397983272036, -316.7189635448158, -342.4767340421677, -317.8912708237767, -36.10393616557123, 10.88611736893651, -8.87265440635386, 9.118405114859328, -29.052385702729254, -37.60002555698158, -42.50891530513765, -301.72884607315063, -318.0899749174714, -335.0381171107292, -23.306361645460157, -285.52834196388727, -14.606125753372936, -48.913311656564474, -35.744328800588875, -32.640189243014916, -37.18616392463447, 1.2108242884278013, -307.491730555892, -6.252640351653113, -64.71999849379068, -319.73279616981745, -312.616782039404, -10.619210772216334, -47.4419204220176, -326.194644920528, -5.538675112649813, 5.33597993291913, -17.759850017726436, 6.132113032042966, -300.34905789466575, -271.4914611168206, -288.73150800541043, -326.2695267647505, -6.044163629412651, -73.48160195723183, -314.00556664168835, 5.157866433262825, -31.0462446808815, -321.16176506876945, -279.4084666431882, 5.62765321880579, -27.61692859418693, -308.9897499680519, 7.6263646809384085, 0.9531111456453658, -17.178513497114196, 1.497276060283184, -6.570021435618401, -11.854455940425424, -322.0857067555189, -46.549223192036166, -10.488341659307494, -25.353310219943538, 22.691560104489298, -51.6452409848571, -16.516139544546604, 5.6198102980851985, -43.0298074707389, 4.489805333316312, -14.001873485744028, 10.53333180397749, -14.56203371658924, -8.405373394489317, -10.631127029657392, -17.040658570826082, -301.77253302931786, 5.111035827547298, -301.1565492749214, -18.31148563325408, 14.950731679797144, -4.463693551719189, -44.5068378672004, -325.3130616620183, -0.5432889536023424, -23.378635294735446, 6.608325190842123, 1.0564917996525764, -18.884900636971025, -3.3867950811982297, 19.511935070157037, -46.158153492957354, -23.731073049828424, -314.07474415935576, -4.501332908868818, -25.43716261535883], "episode_lengths": [300, 94, 300, 53, 78, 62, 41, 300, 61, 300, 79, 85, 80, 48, 300, 300, 300, 300, 300, 300, 300, 69, 203, 96, 300, 89, 300, 300, 300, 300, 300, 300, 58, 300, 300, 68, 72, 300, 300, 66, 300, 300, 300, 300, 69, 128, 78, 52, 300, 300, 64, 300, 300, 69, 80, 300, 300, 127, 300, 300, 300, 300, 300, 300, 82, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 58, 300, 55, 300, 300, 300, 300, 57, 300, 300, 300, 300, 300, 300, 300, 300, 300, 62, 300, 300], "policy_shared_policy_reward": [-10.150943346321583, -10.205403849482536, -10.42888043820858, -78.93908451994261, -95.52098687489828, -78.89548320074877, -7.838220849633217, -7.631964340806007, -7.815845973789692, -118.70405731598537, -105.29324052731197, -106.89269168178241, -109.71155571937561, -95.40757152438164, -95.90288239717484, -99.57536500692368, -102.06719261407852, -102.44586092233658, -101.48823566734791, -101.19708707556129, -114.95924800634384, -5.871901949246734, -5.498214689393848, -5.388829251130431, -97.04173923035464, -112.23181374867758, -100.00908978780112, -4.938383969167873, -4.903535815576717, -5.321561257044479, -103.44869643449783, -115.9397628903389, -101.75133900236688, -109.24565827846527, -104.79200920462608, -102.68129606172442, -110.25730906923613, -123.03338303168616, -109.1860419412454, -101.40356421718995, -101.85555007557075, -114.63215653101604, -11.61164202789466, -11.968828673164055, -12.523465464512512, 3.6002527798215453, 3.647047119836003, 3.638817469278962, -3.029022482534259, -3.186706607540458, -2.6569253162791426, 3.1339887653787883, 3.324185156573847, 2.660231192906693, -10.136488010485976, -9.259218429525703, -9.656679262717574, -12.379165808359787, -12.245027827719852, -12.975831920901939, -14.354320446650192, -14.496896396080658, -13.657698462406799, -109.53284351030986, -97.16619966427486, -95.02980289856593, -101.99833475798368, -103.27832353115082, -112.8133166283369, -107.31182165940604, -108.59068789084753, -119.13560756047568, -7.788398583730071, -7.758144830664008, -7.7598182310660775, -89.40601611634096, -105.73602946599325, -90.38629638155302, -4.652069052060455, -4.4712370348473485, -5.482819666465133, -16.41656368225813, -16.349610306322575, -16.14713766798377, -11.451017112781614, -12.677883674701064, -11.615428013106197, -11.202471981445953, -10.641352195447936, -10.796365066121027, -12.645210127035782, -12.587766225139305, -11.953187572459385, 0.3638246903816764, 0.47295695791640924, 0.37404264012971566, -100.54559686283271, -101.0559667746226, -105.89016691843669, -1.9190279940764157, -2.440056184927627, -1.8935561726490704, -21.931679159402854, -21.382058247923858, -21.406261086463935, -117.8188989162445, -101.72605550289154, -100.1878417506814, -113.85711093743643, -99.06993185480437, -99.68973924716315, -3.2897188464800564, -3.133186581234142, -4.196305344502136, -15.65878572811684, -15.776431513329356, -16.006703180571407, -101.94361646225056, -104.96132322152457, -119.28970523675284, -1.5810118174801318, -2.1706401209036557, -1.7870231742660252, 1.3805031826098713, 1.5136902829011234, 2.4417864674081358, -6.060166592399284, -5.8705228293935505, -5.829160595933601, 2.0522823904951366, 1.8392876883347782, 2.240542953213051, -109.28451561927795, -93.87583951326087, -97.18870276212692, -84.60155513137579, -102.52412855625153, -84.36577742919326, -95.66308405001959, -93.98272229110202, -99.08570166428885, -102.39040543138981, -120.07101011276245, -103.80811122059822, -1.7406702414155006, -2.6623032987117767, -1.6411900892853737, -24.5044977888465, -24.055025141686208, -24.922079026699073, -98.78758808970451, -98.3244071751833, -116.89357137680054, 1.6523335725069046, 1.7567306607961655, 1.748802199959755, -10.440773539245129, -10.170190468430519, -10.435280673205853, -105.0399638414383, -112.58758690953255, -103.53421431779861, -88.28766639096042, -102.9174169500669, -88.20338330216086, 1.9801017493009567, 1.6663982570171356, 1.9811532124876976, -9.541582276423782, -8.89005136427781, -9.18529495348534, -102.23385874430339, -108.43091409901778, -98.32497712473075, 2.50173072268565, 2.3798292403419765, 2.7448047179107817, 0.18383429696162068, 0.14909518261750065, 0.6201816660662445, -6.014847959081337, -5.796036029855415, -5.367629508177444, 0.5327426791191101, 0.5942555293440819, 0.37027785181999207, -2.1032487228512764, -2.111683376133442, -2.3550893366336823, -4.0313790192206795, -3.6400683050354417, -4.183008616169303, -102.68972531457743, -103.81052278478941, -115.5854586561521, -15.901701504985496, -15.507379824916526, -15.140141862134143, -3.758252109090492, -3.471657628814384, -3.258431921402618, -8.049579399327442, -8.364057416717216, -8.93967340389888, 7.337182591358811, 7.574751655260712, 7.779625857869775, -17.2120190213124, -17.220764177540943, -17.212457786003753, -5.15156839042902, -5.460328608751297, -5.904242545366287, 1.7751009513934406, 2.0852318902810367, 1.7594774564107212, -14.292617949346706, -14.403593714038536, -14.33359580735366, 1.5581042965253147, 1.5913635765512737, 1.3403374602397236, -4.5940548603733475, -4.644818459947913, -4.763000165422767, 3.550387479364872, 3.5793440118432045, 3.403600312769413, -5.052011256416648, -4.861323182781547, -4.648699277391046, -2.6625353967150147, -3.10208020110926, -2.640757796665042, -3.599643324812263, -3.527497900029033, -3.5039858048160966, -5.73412795116505, -5.728682880600303, -5.577847739060729, -99.09091379741828, -98.90329327682655, -103.77832595507304, 1.5259373535712513, 1.638586369653538, 1.9465121043225082, -98.8163807267944, -98.64089444528024, -103.69927410284679, -5.983548109730094, -6.1804319371779854, -6.147505586346, 4.671091730395943, 4.929443816343934, 5.350196133057267, -1.8358350843191147, -1.0925669521093369, -1.5352915152907372, -14.561047029991954, -14.947067086895316, -14.998723750313133, -103.96552645911774, -105.43999751408896, -115.90753768881163, -0.3659226720531876, -0.15261716892322852, -0.024749112625926273, -7.531891236702606, -7.656858074168369, -8.189885983864471, 2.0513728211323325, 2.2596243719259803, 2.2973279977838104, 0.35605593025684357, 0.8962424322962761, -0.1958065629005432, -5.850849789877742, -6.1354832400878365, -6.898567607005447, -0.9625060136119572, -1.1136350433031765, -1.310654024283096, 6.054416929682091, 6.708329317470387, 6.749188823004559, -15.360215611755848, -15.59384149312973, -15.204096388071775, -8.235345381001636, -7.734869989256069, -7.760857679570719, -101.31653345997135, -111.15157947751383, -101.60663122187059, -1.6521884029110367, -1.6388757427533562, -1.2102687632044251, -7.986630879342556, -8.335522308945656, -9.115009427070618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16010372125796812, "mean_inference_ms": 0.6544071152086863, "mean_action_processing_ms": 0.09639433209824745, "mean_env_wait_ms": 0.7858910779578278, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 148800, "timesteps_this_iter": 0, "agent_timesteps_total": 446400, "timers": {"sample_time_ms": 9244.037, "sample_throughput": 519.254, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1203.174, "learn_throughput": 3989.447, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 209.0560474395752, "policy_loss": -0.00233898607171594, "vf_loss": 209.10714530944824, "vf_explained_var": 0.04897363483905792, "kl": 0.010542215633912095, "entropy": 4.877645313739777, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148800, "num_agent_steps_sampled": 446400, "num_steps_trained": 148800, "num_agent_steps_trained": 446400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1382, "training_iteration": 31, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-47-28", "timestamp": 1706147248, "time_this_iter_s": 9.615964889526367, "time_total_s": 291.4444968700409, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004D1B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 291.4444968700409, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 6.692857142857143, "ram_util_percent": 45.17142857142857}}
{"episode_reward_max": 22.691560104489298, "episode_reward_min": -335.0381171107292, "episode_reward_mean": -84.16501335481648, "episode_len_mean": 247.79, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {"shared_policy": -120.07101011276245}, "policy_reward_max": {"shared_policy": 7.779625857869775}, "policy_reward_mean": {"shared_policy": -28.0550044516055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.052385702729254, -37.60002555698158, -42.50891530513765, -301.72884607315063, -318.0899749174714, -335.0381171107292, -23.306361645460157, -285.52834196388727, -14.606125753372936, -48.913311656564474, -35.744328800588875, -32.640189243014916, -37.18616392463447, 1.2108242884278013, -307.491730555892, -6.252640351653113, -64.71999849379068, -319.73279616981745, -312.616782039404, -10.619210772216334, -47.4419204220176, -326.194644920528, -5.538675112649813, 5.33597993291913, -17.759850017726436, 6.132113032042966, -300.34905789466575, -271.4914611168206, -288.73150800541043, -326.2695267647505, -6.044163629412651, -73.48160195723183, -314.00556664168835, 5.157866433262825, -31.0462446808815, -321.16176506876945, -279.4084666431882, 5.62765321880579, -27.61692859418693, -308.9897499680519, 7.6263646809384085, 0.9531111456453658, -17.178513497114196, 1.497276060283184, -6.570021435618401, -11.854455940425424, -322.0857067555189, -46.549223192036166, -10.488341659307494, -25.353310219943538, 22.691560104489298, -51.6452409848571, -16.516139544546604, 5.6198102980851985, -43.0298074707389, 4.489805333316312, -14.001873485744028, 10.53333180397749, -14.56203371658924, -8.405373394489317, -10.631127029657392, -17.040658570826082, -301.77253302931786, 5.111035827547298, -301.1565492749214, -18.31148563325408, 14.950731679797144, -4.463693551719189, -44.5068378672004, -325.3130616620183, -0.5432889536023424, -23.378635294735446, 6.608325190842123, 1.0564917996525764, -18.884900636971025, -3.3867950811982297, 19.511935070157037, -46.158153492957354, -23.731073049828424, -314.07474415935576, -4.501332908868818, -25.43716261535883, 15.435514356940956, -17.124945059418707, 13.94490242190659, -2.074055951088667, -18.88035776466134, -48.97019858565184, 6.955391950905323, -28.22893629223111, -268.6951203420758, 9.216129869222613, -60.00143858045342, 0.8792002424597598, -273.58800768852234, 6.595988571643801, -12.587110161781325, 9.440780187025652, -310.24636055901647, 17.75252358615397], "episode_lengths": [300, 300, 300, 69, 203, 96, 300, 89, 300, 300, 300, 300, 300, 300, 58, 300, 300, 68, 72, 300, 300, 66, 300, 300, 300, 300, 69, 128, 78, 52, 300, 300, 64, 300, 300, 69, 80, 300, 300, 127, 300, 300, 300, 300, 300, 300, 82, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 58, 300, 55, 300, 300, 300, 300, 57, 300, 300, 300, 300, 300, 300, 300, 300, 300, 62, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 300, 300, 116, 300, 300, 300, 74, 300], "policy_shared_policy_reward": [-10.136488010485976, -9.259218429525703, -9.656679262717574, -12.379165808359787, -12.245027827719852, -12.975831920901939, -14.354320446650192, -14.496896396080658, -13.657698462406799, -109.53284351030986, -97.16619966427486, -95.02980289856593, -101.99833475798368, -103.27832353115082, -112.8133166283369, -107.31182165940604, -108.59068789084753, -119.13560756047568, -7.788398583730071, -7.758144830664008, -7.7598182310660775, -89.40601611634096, -105.73602946599325, -90.38629638155302, -4.652069052060455, -4.4712370348473485, -5.482819666465133, -16.41656368225813, -16.349610306322575, -16.14713766798377, -11.451017112781614, -12.677883674701064, -11.615428013106197, -11.202471981445953, -10.641352195447936, -10.796365066121027, -12.645210127035782, -12.587766225139305, -11.953187572459385, 0.3638246903816764, 0.47295695791640924, 0.37404264012971566, -100.54559686283271, -101.0559667746226, -105.89016691843669, -1.9190279940764157, -2.440056184927627, -1.8935561726490704, -21.931679159402854, -21.382058247923858, -21.406261086463935, -117.8188989162445, -101.72605550289154, -100.1878417506814, -113.85711093743643, -99.06993185480437, -99.68973924716315, -3.2897188464800564, -3.133186581234142, -4.196305344502136, -15.65878572811684, -15.776431513329356, -16.006703180571407, -101.94361646225056, -104.96132322152457, -119.28970523675284, -1.5810118174801318, -2.1706401209036557, -1.7870231742660252, 1.3805031826098713, 1.5136902829011234, 2.4417864674081358, -6.060166592399284, -5.8705228293935505, -5.829160595933601, 2.0522823904951366, 1.8392876883347782, 2.240542953213051, -109.28451561927795, -93.87583951326087, -97.18870276212692, -84.60155513137579, -102.52412855625153, -84.36577742919326, -95.66308405001959, -93.98272229110202, -99.08570166428885, -102.39040543138981, -120.07101011276245, -103.80811122059822, -1.7406702414155006, -2.6623032987117767, -1.6411900892853737, -24.5044977888465, -24.055025141686208, -24.922079026699073, -98.78758808970451, -98.3244071751833, -116.89357137680054, 1.6523335725069046, 1.7567306607961655, 1.748802199959755, -10.440773539245129, -10.170190468430519, -10.435280673205853, -105.0399638414383, -112.58758690953255, -103.53421431779861, -88.28766639096042, -102.9174169500669, -88.20338330216086, 1.9801017493009567, 1.6663982570171356, 1.9811532124876976, -9.541582276423782, -8.89005136427781, -9.18529495348534, -102.23385874430339, -108.43091409901778, -98.32497712473075, 2.50173072268565, 2.3798292403419765, 2.7448047179107817, 0.18383429696162068, 0.14909518261750065, 0.6201816660662445, -6.014847959081337, -5.796036029855415, -5.367629508177444, 0.5327426791191101, 0.5942555293440819, 0.37027785181999207, -2.1032487228512764, -2.111683376133442, -2.3550893366336823, -4.0313790192206795, -3.6400683050354417, -4.183008616169303, -102.68972531457743, -103.81052278478941, -115.5854586561521, -15.901701504985496, -15.507379824916526, -15.140141862134143, -3.758252109090492, -3.471657628814384, -3.258431921402618, -8.049579399327442, -8.364057416717216, -8.93967340389888, 7.337182591358811, 7.574751655260712, 7.779625857869775, -17.2120190213124, -17.220764177540943, -17.212457786003753, -5.15156839042902, -5.460328608751297, -5.904242545366287, 1.7751009513934406, 2.0852318902810367, 1.7594774564107212, -14.292617949346706, -14.403593714038536, -14.33359580735366, 1.5581042965253147, 1.5913635765512737, 1.3403374602397236, -4.5940548603733475, -4.644818459947913, -4.763000165422767, 3.550387479364872, 3.5793440118432045, 3.403600312769413, -5.052011256416648, -4.861323182781547, -4.648699277391046, -2.6625353967150147, -3.10208020110926, -2.640757796665042, -3.599643324812263, -3.527497900029033, -3.5039858048160966, -5.73412795116505, -5.728682880600303, -5.577847739060729, -99.09091379741828, -98.90329327682655, -103.77832595507304, 1.5259373535712513, 1.638586369653538, 1.9465121043225082, -98.8163807267944, -98.64089444528024, -103.69927410284679, -5.983548109730094, -6.1804319371779854, -6.147505586346, 4.671091730395943, 4.929443816343934, 5.350196133057267, -1.8358350843191147, -1.0925669521093369, -1.5352915152907372, -14.561047029991954, -14.947067086895316, -14.998723750313133, -103.96552645911774, -105.43999751408896, -115.90753768881163, -0.3659226720531876, -0.15261716892322852, -0.024749112625926273, -7.531891236702606, -7.656858074168369, -8.189885983864471, 2.0513728211323325, 2.2596243719259803, 2.2973279977838104, 0.35605593025684357, 0.8962424322962761, -0.1958065629005432, -5.850849789877742, -6.1354832400878365, -6.898567607005447, -0.9625060136119572, -1.1136350433031765, -1.310654024283096, 6.054416929682091, 6.708329317470387, 6.749188823004559, -15.360215611755848, -15.59384149312973, -15.204096388071775, -8.235345381001636, -7.734869989256069, -7.760857679570719, -101.31653345997135, -111.15157947751383, -101.60663122187059, -1.6521884029110367, -1.6388757427533562, -1.2102687632044251, -7.986630879342556, -8.335522308945656, -9.115009427070618, 5.187149705986172, 5.581632299969584, 4.6667323509852, -5.593532343705505, -5.605956410368293, -5.925456305344909, 4.163451477885246, 5.126601004973054, 4.65484993904829, -0.7442767545580864, -0.5970082618296146, -0.7327709347009659, -6.234166884173959, -6.197301485886186, -6.448889394601196, -16.578529929121345, -15.529516656262189, -16.86215200026831, 2.0518963038921356, 2.7131718024611473, 2.19032384455204, -9.260159340997546, -9.490271677573531, -9.478505273660033, -84.36626309404771, -99.32568160692851, -85.00317564109962, 2.9770066762963836, 3.0951949755350654, 3.1439282173911636, -19.591706700623043, -19.843696549534805, -20.56603533029557, 0.41329577316840016, -0.25137748817603267, 0.7172819574673923, -94.48887685934703, -89.79375595847766, -89.30537487069766, 2.04569826523462, 2.2700148696700637, 2.2802754367391174, -4.15045514206092, -3.741099531451866, -4.695555488268539, 3.0744575982292446, 2.9125978698333057, 3.4537247189631017, -107.62282677491507, -101.36852406462035, -101.25500971948108, 5.392491300900772, 6.213136320312813, 6.146895964940384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15963728107825406, "mean_inference_ms": 0.6545479072680849, "mean_action_processing_ms": 0.09637875881253136, "mean_env_wait_ms": 0.7864246653577992, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"sample_time_ms": 9322.894, "sample_throughput": 514.862, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1215.268, "learn_throughput": 3949.746, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 207.33146476745605, "policy_loss": -0.003050613237978228, "vf_loss": 207.3844985961914, "vf_explained_var": 0.1261732131242752, "kl": 0.01551433772329611, "entropy": 5.0007389187812805, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 460800, "num_steps_trained": 153600, "num_agent_steps_trained": 460800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1400, "training_iteration": 32, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-47-38", "timestamp": 1706147258, "time_this_iter_s": 9.84378433227539, "time_total_s": 301.2882812023163, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 301.2882812023163, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 10.257142857142858, "ram_util_percent": 45.39999999999999}}
{"episode_reward_max": 22.691560104489298, "episode_reward_min": -326.2695267647505, "episode_reward_mean": -75.48425185146742, "episode_len_mean": 253.65, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -120.07101011276245}, "policy_reward_max": {"shared_policy": 7.779625857869775}, "policy_reward_mean": {"shared_policy": -25.161417283822477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-319.73279616981745, -312.616782039404, -10.619210772216334, -47.4419204220176, -326.194644920528, -5.538675112649813, 5.33597993291913, -17.759850017726436, 6.132113032042966, -300.34905789466575, -271.4914611168206, -288.73150800541043, -326.2695267647505, -6.044163629412651, -73.48160195723183, -314.00556664168835, 5.157866433262825, -31.0462446808815, -321.16176506876945, -279.4084666431882, 5.62765321880579, -27.61692859418693, -308.9897499680519, 7.6263646809384085, 0.9531111456453658, -17.178513497114196, 1.497276060283184, -6.570021435618401, -11.854455940425424, -322.0857067555189, -46.549223192036166, -10.488341659307494, -25.353310219943538, 22.691560104489298, -51.6452409848571, -16.516139544546604, 5.6198102980851985, -43.0298074707389, 4.489805333316312, -14.001873485744028, 10.53333180397749, -14.56203371658924, -8.405373394489317, -10.631127029657392, -17.040658570826082, -301.77253302931786, 5.111035827547298, -301.1565492749214, -18.31148563325408, 14.950731679797144, -4.463693551719189, -44.5068378672004, -325.3130616620183, -0.5432889536023424, -23.378635294735446, 6.608325190842123, 1.0564917996525764, -18.884900636971025, -3.3867950811982297, 19.511935070157037, -46.158153492957354, -23.731073049828424, -314.07474415935576, -4.501332908868818, -25.43716261535883, 15.435514356940956, -17.124945059418707, 13.94490242190659, -2.074055951088667, -18.88035776466134, -48.97019858565184, 6.955391950905323, -28.22893629223111, -268.6951203420758, 9.216129869222613, -60.00143858045342, 0.8792002424597598, -273.58800768852234, 6.595988571643801, -12.587110161781325, 9.440780187025652, -310.24636055901647, 17.75252358615397, -8.52713043987751, -4.356621243059635, 12.195049475878463, -3.255027912557125, -288.47685389220715, 8.809803932905169, -18.47350391000512, -58.72912660241129, -28.045052535831957, -315.8885858505964, -3.7589793354272985, -295.57666923105717, -23.44467505812645, 3.2973802685737326, -16.43837090022862, -6.470432121306686, -3.9816870763897896], "episode_lengths": [68, 72, 300, 300, 66, 300, 300, 300, 300, 69, 128, 78, 52, 300, 300, 64, 300, 300, 69, 80, 300, 300, 127, 300, 300, 300, 300, 300, 300, 82, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 58, 300, 55, 300, 300, 300, 300, 57, 300, 300, 300, 300, 300, 300, 300, 300, 300, 62, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 300, 300, 116, 300, 300, 300, 74, 300, 300, 300, 300, 300, 127, 300, 300, 300, 300, 75, 300, 299, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-117.8188989162445, -101.72605550289154, -100.1878417506814, -113.85711093743643, -99.06993185480437, -99.68973924716315, -3.2897188464800564, -3.133186581234142, -4.196305344502136, -15.65878572811684, -15.776431513329356, -16.006703180571407, -101.94361646225056, -104.96132322152457, -119.28970523675284, -1.5810118174801318, -2.1706401209036557, -1.7870231742660252, 1.3805031826098713, 1.5136902829011234, 2.4417864674081358, -6.060166592399284, -5.8705228293935505, -5.829160595933601, 2.0522823904951366, 1.8392876883347782, 2.240542953213051, -109.28451561927795, -93.87583951326087, -97.18870276212692, -84.60155513137579, -102.52412855625153, -84.36577742919326, -95.66308405001959, -93.98272229110202, -99.08570166428885, -102.39040543138981, -120.07101011276245, -103.80811122059822, -1.7406702414155006, -2.6623032987117767, -1.6411900892853737, -24.5044977888465, -24.055025141686208, -24.922079026699073, -98.78758808970451, -98.3244071751833, -116.89357137680054, 1.6523335725069046, 1.7567306607961655, 1.748802199959755, -10.440773539245129, -10.170190468430519, -10.435280673205853, -105.0399638414383, -112.58758690953255, -103.53421431779861, -88.28766639096042, -102.9174169500669, -88.20338330216086, 1.9801017493009567, 1.6663982570171356, 1.9811532124876976, -9.541582276423782, -8.89005136427781, -9.18529495348534, -102.23385874430339, -108.43091409901778, -98.32497712473075, 2.50173072268565, 2.3798292403419765, 2.7448047179107817, 0.18383429696162068, 0.14909518261750065, 0.6201816660662445, -6.014847959081337, -5.796036029855415, -5.367629508177444, 0.5327426791191101, 0.5942555293440819, 0.37027785181999207, -2.1032487228512764, -2.111683376133442, -2.3550893366336823, -4.0313790192206795, -3.6400683050354417, -4.183008616169303, -102.68972531457743, -103.81052278478941, -115.5854586561521, -15.901701504985496, -15.507379824916526, -15.140141862134143, -3.758252109090492, -3.471657628814384, -3.258431921402618, -8.049579399327442, -8.364057416717216, -8.93967340389888, 7.337182591358811, 7.574751655260712, 7.779625857869775, -17.2120190213124, -17.220764177540943, -17.212457786003753, -5.15156839042902, -5.460328608751297, -5.904242545366287, 1.7751009513934406, 2.0852318902810367, 1.7594774564107212, -14.292617949346706, -14.403593714038536, -14.33359580735366, 1.5581042965253147, 1.5913635765512737, 1.3403374602397236, -4.5940548603733475, -4.644818459947913, -4.763000165422767, 3.550387479364872, 3.5793440118432045, 3.403600312769413, -5.052011256416648, -4.861323182781547, -4.648699277391046, -2.6625353967150147, -3.10208020110926, -2.640757796665042, -3.599643324812263, -3.527497900029033, -3.5039858048160966, -5.73412795116505, -5.728682880600303, -5.577847739060729, -99.09091379741828, -98.90329327682655, -103.77832595507304, 1.5259373535712513, 1.638586369653538, 1.9465121043225082, -98.8163807267944, -98.64089444528024, -103.69927410284679, -5.983548109730094, -6.1804319371779854, -6.147505586346, 4.671091730395943, 4.929443816343934, 5.350196133057267, -1.8358350843191147, -1.0925669521093369, -1.5352915152907372, -14.561047029991954, -14.947067086895316, -14.998723750313133, -103.96552645911774, -105.43999751408896, -115.90753768881163, -0.3659226720531876, -0.15261716892322852, -0.024749112625926273, -7.531891236702606, -7.656858074168369, -8.189885983864471, 2.0513728211323325, 2.2596243719259803, 2.2973279977838104, 0.35605593025684357, 0.8962424322962761, -0.1958065629005432, -5.850849789877742, -6.1354832400878365, -6.898567607005447, -0.9625060136119572, -1.1136350433031765, -1.310654024283096, 6.054416929682091, 6.708329317470387, 6.749188823004559, -15.360215611755848, -15.59384149312973, -15.204096388071775, -8.235345381001636, -7.734869989256069, -7.760857679570719, -101.31653345997135, -111.15157947751383, -101.60663122187059, -1.6521884029110367, -1.6388757427533562, -1.2102687632044251, -7.986630879342556, -8.335522308945656, -9.115009427070618, 5.187149705986172, 5.581632299969584, 4.6667323509852, -5.593532343705505, -5.605956410368293, -5.925456305344909, 4.163451477885246, 5.126601004973054, 4.65484993904829, -0.7442767545580864, -0.5970082618296146, -0.7327709347009659, -6.234166884173959, -6.197301485886186, -6.448889394601196, -16.578529929121345, -15.529516656262189, -16.86215200026831, 2.0518963038921356, 2.7131718024611473, 2.19032384455204, -9.260159340997546, -9.490271677573531, -9.478505273660033, -84.36626309404771, -99.32568160692851, -85.00317564109962, 2.9770066762963836, 3.0951949755350654, 3.1439282173911636, -19.591706700623043, -19.843696549534805, -20.56603533029557, 0.41329577316840016, -0.25137748817603267, 0.7172819574673923, -94.48887685934703, -89.79375595847766, -89.30537487069766, 2.04569826523462, 2.2700148696700637, 2.2802754367391174, -4.15045514206092, -3.741099531451866, -4.695555488268539, 3.0744575982292446, 2.9125978698333057, 3.4537247189631017, -107.62282677491507, -101.36852406462035, -101.25500971948108, 5.392491300900772, 6.213136320312813, 6.146895964940384, -3.1003269404172897, -2.5288183838129044, -2.897985115647316, -1.1902737990021706, -1.1915203928947449, -1.9748270511627197, 4.16514442240198, 3.976384167869881, 4.053520885606602, -1.0942677184939384, -1.1015248820185661, -1.0592353120446205, -92.15829854210219, -104.06588306029639, -92.2526722898086, 2.885773400465638, 3.090679417053849, 2.833351115385682, -6.110867244501918, -6.057427694400161, -6.305208971103042, -19.58580225706101, -19.469336122274406, -19.673988223075874, -9.05553197612366, -9.317526390155166, -9.67199416955313, -101.09914052983126, -102.76043783624968, -112.02900748451552, -1.140341612199947, -1.4306334803501812, -1.1880042428771702, -95.71246806283793, -105.09401075293621, -94.77019041528305, -7.9679978266358376, -7.861890606582165, -7.614786624908447, 1.1515457133452003, 1.1179805497328346, 1.0278540054956977, -5.444543071091175, -5.6967820674180984, -5.297045761719346, -2.2896085580190118, -1.9478045863409932, -2.2330189769466813, -0.978862501680851, -1.2330700904130936, -1.769754484295845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15926250301437384, "mean_inference_ms": 0.6550429896711556, "mean_action_processing_ms": 0.09644702574676194, "mean_env_wait_ms": 0.7872637209427574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 158400, "timesteps_this_iter": 0, "agent_timesteps_total": 475200, "timers": {"sample_time_ms": 9428.457, "sample_throughput": 509.097, "load_time_ms": 0.099, "load_throughput": 48477387.912, "learn_time_ms": 1216.367, "learn_throughput": 3946.177, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 226.51653671264648, "policy_loss": -0.004105390378713811, "vf_loss": 226.56981468200684, "vf_explained_var": -0.06474936008453369, "kl": 0.020884330413543525, "entropy": 4.919529438018799, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 158400, "num_agent_steps_sampled": 475200, "num_steps_trained": 158400, "num_agent_steps_trained": 475200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1417, "training_iteration": 33, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-47-48", "timestamp": 1706147268, "time_this_iter_s": 9.925630569458008, "time_total_s": 311.2139117717743, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 311.2139117717743, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 8.47857142857143, "ram_util_percent": 45.95714285714286}}
{"episode_reward_max": 22.691560104489298, "episode_reward_min": -325.3130616620183, "episode_reward_mean": -56.176454338646735, "episode_len_mean": 266.81, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"shared_policy": -117.08424297968547}, "policy_reward_max": {"shared_policy": 7.779625857869775}, "policy_reward_mean": {"shared_policy": -18.725484779548914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.4084666431882, 5.62765321880579, -27.61692859418693, -308.9897499680519, 7.6263646809384085, 0.9531111456453658, -17.178513497114196, 1.497276060283184, -6.570021435618401, -11.854455940425424, -322.0857067555189, -46.549223192036166, -10.488341659307494, -25.353310219943538, 22.691560104489298, -51.6452409848571, -16.516139544546604, 5.6198102980851985, -43.0298074707389, 4.489805333316312, -14.001873485744028, 10.53333180397749, -14.56203371658924, -8.405373394489317, -10.631127029657392, -17.040658570826082, -301.77253302931786, 5.111035827547298, -301.1565492749214, -18.31148563325408, 14.950731679797144, -4.463693551719189, -44.5068378672004, -325.3130616620183, -0.5432889536023424, -23.378635294735446, 6.608325190842123, 1.0564917996525764, -18.884900636971025, -3.3867950811982297, 19.511935070157037, -46.158153492957354, -23.731073049828424, -314.07474415935576, -4.501332908868818, -25.43716261535883, 15.435514356940956, -17.124945059418707, 13.94490242190659, -2.074055951088667, -18.88035776466134, -48.97019858565184, 6.955391950905323, -28.22893629223111, -268.6951203420758, 9.216129869222613, -60.00143858045342, 0.8792002424597598, -273.58800768852234, 6.595988571643801, -12.587110161781325, 9.440780187025652, -310.24636055901647, 17.75252358615397, -8.52713043987751, -4.356621243059635, 12.195049475878463, -3.255027912557125, -288.47685389220715, 8.809803932905169, -18.47350391000512, -58.72912660241129, -28.045052535831957, -315.8885858505964, -3.7589793354272985, -295.57666923105717, -23.44467505812645, 3.2973802685737326, -16.43837090022862, -6.470432121306686, -3.9816870763897896, -2.6450193487107896, -47.52633589692417, -325.28954470157623, 0.89663762971756, -6.745852991938591, -0.7768664658069895, -19.368702269508532, 15.38927298039198, -319.00714080035686, -22.84962199628356, -286.0005317628384, 3.207497775554657, -4.305700801312952, -3.443417231785162, -5.365226201713085, 2.1979163810610487, 7.39965214207767, 0.882564544677706, -11.728645518422141], "episode_lengths": [80, 300, 300, 127, 300, 300, 300, 300, 300, 300, 82, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 58, 300, 55, 300, 300, 300, 300, 57, 300, 300, 300, 300, 300, 300, 300, 300, 300, 62, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 300, 300, 116, 300, 300, 300, 74, 300, 300, 300, 300, 300, 127, 300, 300, 300, 300, 75, 300, 299, 300, 300, 300, 300, 300, 300, 300, 58, 300, 300, 300, 300, 300, 52, 300, 72, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-88.28766639096042, -102.9174169500669, -88.20338330216086, 1.9801017493009567, 1.6663982570171356, 1.9811532124876976, -9.541582276423782, -8.89005136427781, -9.18529495348534, -102.23385874430339, -108.43091409901778, -98.32497712473075, 2.50173072268565, 2.3798292403419765, 2.7448047179107817, 0.18383429696162068, 0.14909518261750065, 0.6201816660662445, -6.014847959081337, -5.796036029855415, -5.367629508177444, 0.5327426791191101, 0.5942555293440819, 0.37027785181999207, -2.1032487228512764, -2.111683376133442, -2.3550893366336823, -4.0313790192206795, -3.6400683050354417, -4.183008616169303, -102.68972531457743, -103.81052278478941, -115.5854586561521, -15.901701504985496, -15.507379824916526, -15.140141862134143, -3.758252109090492, -3.471657628814384, -3.258431921402618, -8.049579399327442, -8.364057416717216, -8.93967340389888, 7.337182591358811, 7.574751655260712, 7.779625857869775, -17.2120190213124, -17.220764177540943, -17.212457786003753, -5.15156839042902, -5.460328608751297, -5.904242545366287, 1.7751009513934406, 2.0852318902810367, 1.7594774564107212, -14.292617949346706, -14.403593714038536, -14.33359580735366, 1.5581042965253147, 1.5913635765512737, 1.3403374602397236, -4.5940548603733475, -4.644818459947913, -4.763000165422767, 3.550387479364872, 3.5793440118432045, 3.403600312769413, -5.052011256416648, -4.861323182781547, -4.648699277391046, -2.6625353967150147, -3.10208020110926, -2.640757796665042, -3.599643324812263, -3.527497900029033, -3.5039858048160966, -5.73412795116505, -5.728682880600303, -5.577847739060729, -99.09091379741828, -98.90329327682655, -103.77832595507304, 1.5259373535712513, 1.638586369653538, 1.9465121043225082, -98.8163807267944, -98.64089444528024, -103.69927410284679, -5.983548109730094, -6.1804319371779854, -6.147505586346, 4.671091730395943, 4.929443816343934, 5.350196133057267, -1.8358350843191147, -1.0925669521093369, -1.5352915152907372, -14.561047029991954, -14.947067086895316, -14.998723750313133, -103.96552645911774, -105.43999751408896, -115.90753768881163, -0.3659226720531876, -0.15261716892322852, -0.024749112625926273, -7.531891236702606, -7.656858074168369, -8.189885983864471, 2.0513728211323325, 2.2596243719259803, 2.2973279977838104, 0.35605593025684357, 0.8962424322962761, -0.1958065629005432, -5.850849789877742, -6.1354832400878365, -6.898567607005447, -0.9625060136119572, -1.1136350433031765, -1.310654024283096, 6.054416929682091, 6.708329317470387, 6.749188823004559, -15.360215611755848, -15.59384149312973, -15.204096388071775, -8.235345381001636, -7.734869989256069, -7.760857679570719, -101.31653345997135, -111.15157947751383, -101.60663122187059, -1.6521884029110367, -1.6388757427533562, -1.2102687632044251, -7.986630879342556, -8.335522308945656, -9.115009427070618, 5.187149705986172, 5.581632299969584, 4.6667323509852, -5.593532343705505, -5.605956410368293, -5.925456305344909, 4.163451477885246, 5.126601004973054, 4.65484993904829, -0.7442767545580864, -0.5970082618296146, -0.7327709347009659, -6.234166884173959, -6.197301485886186, -6.448889394601196, -16.578529929121345, -15.529516656262189, -16.86215200026831, 2.0518963038921356, 2.7131718024611473, 2.19032384455204, -9.260159340997546, -9.490271677573531, -9.478505273660033, -84.36626309404771, -99.32568160692851, -85.00317564109962, 2.9770066762963836, 3.0951949755350654, 3.1439282173911636, -19.591706700623043, -19.843696549534805, -20.56603533029557, 0.41329577316840016, -0.25137748817603267, 0.7172819574673923, -94.48887685934703, -89.79375595847766, -89.30537487069766, 2.04569826523462, 2.2700148696700637, 2.2802754367391174, -4.15045514206092, -3.741099531451866, -4.695555488268539, 3.0744575982292446, 2.9125978698333057, 3.4537247189631017, -107.62282677491507, -101.36852406462035, -101.25500971948108, 5.392491300900772, 6.213136320312813, 6.146895964940384, -3.1003269404172897, -2.5288183838129044, -2.897985115647316, -1.1902737990021706, -1.1915203928947449, -1.9748270511627197, 4.16514442240198, 3.976384167869881, 4.053520885606602, -1.0942677184939384, -1.1015248820185661, -1.0592353120446205, -92.15829854210219, -104.06588306029639, -92.2526722898086, 2.885773400465638, 3.090679417053849, 2.833351115385682, -6.110867244501918, -6.057427694400161, -6.305208971103042, -19.58580225706101, -19.469336122274406, -19.673988223075874, -9.05553197612366, -9.317526390155166, -9.67199416955313, -101.09914052983126, -102.76043783624968, -112.02900748451552, -1.140341612199947, -1.4306334803501812, -1.1880042428771702, -95.71246806283793, -105.09401075293621, -94.77019041528305, -7.9679978266358376, -7.861890606582165, -7.614786624908447, 1.1515457133452003, 1.1179805497328346, 1.0278540054956977, -5.444543071091175, -5.6967820674180984, -5.297045761719346, -2.2896085580190118, -1.9478045863409932, -2.2330189769466813, -0.978862501680851, -1.2330700904130936, -1.769754484295845, -0.9637115399042813, -0.9768878916899411, -0.7044199171165673, -15.941406359275192, -15.919703004260867, -15.665226533388108, -117.08424297968547, -103.88744084040324, -104.31786088148753, 0.46741071591773675, 0.5826038258771007, -0.15337691207727744, -1.7137100100517273, -2.619423747062683, -2.4127192348241806, -0.361682181557029, -0.27078431596359565, -0.1443999682863648, -6.544327681263297, -6.742198636134475, -6.0821759521107595, 5.1578571274876595, 5.307636260986328, 4.923779591917992, -113.65571629007658, -102.92465623219809, -102.42676827808222, -7.790807013710349, -7.734550734361022, -7.324264248212188, -91.18336675067744, -103.99865021308264, -90.81851479907832, 1.0627732649445534, 0.9332956224679947, 1.211428888142109, -1.421139759322017, -1.5449498941501076, -1.3396111478408272, -1.2718645383914406, -1.2690861051281388, -0.9024665882655825, -1.890065386891365, -1.7928922325372696, -1.6822685822844505, 0.5996693621079032, 0.8083890328804557, 0.7898579860726898, 2.3729162563880237, 2.2792569448550495, 2.747478940834597, 0.44943082580962823, 0.34330222258964227, 0.08983149627843545, -3.966915095845863, -4.045613939563438, -3.71611648301284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1588744280287458, "mean_inference_ms": 0.6555962616824529, "mean_action_processing_ms": 0.09649791375918511, "mean_env_wait_ms": 0.7882763893016677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 163200, "timesteps_this_iter": 0, "agent_timesteps_total": 489600, "timers": {"sample_time_ms": 9456.078, "sample_throughput": 507.61, "load_time_ms": 0.1, "load_throughput": 47980598.665, "learn_time_ms": 1221.374, "learn_throughput": 3930.001, "update_time_ms": 1.4}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023437500000000003, "cur_lr": 0.0005, "total_loss": 214.17271614074707, "policy_loss": -0.0030156616878553866, "vf_loss": 214.2281494140625, "vf_explained_var": 0.07140586525201797, "kl": 0.02120003754681147, "entropy": 5.245733201503754, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 163200, "num_agent_steps_sampled": 489600, "num_steps_trained": 163200, "num_agent_steps_trained": 489600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1436, "training_iteration": 34, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-47-57", "timestamp": 1706147277, "time_this_iter_s": 9.44259524345398, "time_total_s": 320.65650701522827, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 320.65650701522827, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 6.984615384615385, "ram_util_percent": 45.95384615384615}}
{"episode_reward_max": 19.511935070157037, "episode_reward_min": -326.3248326219619, "episode_reward_mean": -71.07833063738072, "episode_len_mean": 255.11, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {"shared_policy": -117.08424297968547}, "policy_reward_max": {"shared_policy": 6.749188823004559}, "policy_reward_mean": {"shared_policy": -23.692776879126914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.56203371658924, -8.405373394489317, -10.631127029657392, -17.040658570826082, -301.77253302931786, 5.111035827547298, -301.1565492749214, -18.31148563325408, 14.950731679797144, -4.463693551719189, -44.5068378672004, -325.3130616620183, -0.5432889536023424, -23.378635294735446, 6.608325190842123, 1.0564917996525764, -18.884900636971025, -3.3867950811982297, 19.511935070157037, -46.158153492957354, -23.731073049828424, -314.07474415935576, -4.501332908868818, -25.43716261535883, 15.435514356940956, -17.124945059418707, 13.94490242190659, -2.074055951088667, -18.88035776466134, -48.97019858565184, 6.955391950905323, -28.22893629223111, -268.6951203420758, 9.216129869222613, -60.00143858045342, 0.8792002424597598, -273.58800768852234, 6.595988571643801, -12.587110161781325, 9.440780187025652, -310.24636055901647, 17.75252358615397, -8.52713043987751, -4.356621243059635, 12.195049475878463, -3.255027912557125, -288.47685389220715, 8.809803932905169, -18.47350391000512, -58.72912660241129, -28.045052535831957, -315.8885858505964, -3.7589793354272985, -295.57666923105717, -23.44467505812645, 3.2973802685737326, -16.43837090022862, -6.470432121306686, -3.9816870763897896, -2.6450193487107896, -47.52633589692417, -325.28954470157623, 0.89663762971756, -6.745852991938591, -0.7768664658069895, -19.368702269508532, 15.38927298039198, -319.00714080035686, -22.84962199628356, -286.0005317628384, 3.207497775554657, -4.305700801312952, -3.443417231785162, -5.365226201713085, 2.1979163810610487, 7.39965214207767, 0.882564544677706, -11.728645518422141, -274.8411076888442, -41.24672507680954, -7.554969998076572, -314.48649321496487, -26.833638899028315, -32.25944129377605, -9.668729335069656, -4.79197423905137, -326.3248326219619, -24.49629670381546, -307.74038824439054, -10.200865123420968, -10.544160589575768, -280.2186505794525, -2.045102193951635, -26.823812015354648, -269.87254782021046, -3.721724644303322, -16.488557688891916, -32.93932695314291, -283.0713935159147, -306.26575817912817], "episode_lengths": [300, 300, 300, 300, 58, 300, 55, 300, 300, 300, 300, 57, 300, 300, 300, 300, 300, 300, 300, 300, 300, 62, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 300, 300, 116, 300, 300, 300, 74, 300, 300, 300, 300, 300, 127, 300, 300, 300, 300, 75, 300, 299, 300, 300, 300, 300, 300, 300, 300, 58, 300, 300, 300, 300, 300, 52, 300, 72, 300, 300, 300, 300, 300, 300, 300, 300, 85, 300, 300, 45, 300, 300, 300, 300, 69, 300, 67, 300, 300, 92, 300, 300, 113, 300, 300, 300, 82, 66], "policy_shared_policy_reward": [-5.052011256416648, -4.861323182781547, -4.648699277391046, -2.6625353967150147, -3.10208020110926, -2.640757796665042, -3.599643324812263, -3.527497900029033, -3.5039858048160966, -5.73412795116505, -5.728682880600303, -5.577847739060729, -99.09091379741828, -98.90329327682655, -103.77832595507304, 1.5259373535712513, 1.638586369653538, 1.9465121043225082, -98.8163807267944, -98.64089444528024, -103.69927410284679, -5.983548109730094, -6.1804319371779854, -6.147505586346, 4.671091730395943, 4.929443816343934, 5.350196133057267, -1.8358350843191147, -1.0925669521093369, -1.5352915152907372, -14.561047029991954, -14.947067086895316, -14.998723750313133, -103.96552645911774, -105.43999751408896, -115.90753768881163, -0.3659226720531876, -0.15261716892322852, -0.024749112625926273, -7.531891236702606, -7.656858074168369, -8.189885983864471, 2.0513728211323325, 2.2596243719259803, 2.2973279977838104, 0.35605593025684357, 0.8962424322962761, -0.1958065629005432, -5.850849789877742, -6.1354832400878365, -6.898567607005447, -0.9625060136119572, -1.1136350433031765, -1.310654024283096, 6.054416929682091, 6.708329317470387, 6.749188823004559, -15.360215611755848, -15.59384149312973, -15.204096388071775, -8.235345381001636, -7.734869989256069, -7.760857679570719, -101.31653345997135, -111.15157947751383, -101.60663122187059, -1.6521884029110367, -1.6388757427533562, -1.2102687632044251, -7.986630879342556, -8.335522308945656, -9.115009427070618, 5.187149705986172, 5.581632299969584, 4.6667323509852, -5.593532343705505, -5.605956410368293, -5.925456305344909, 4.163451477885246, 5.126601004973054, 4.65484993904829, -0.7442767545580864, -0.5970082618296146, -0.7327709347009659, -6.234166884173959, -6.197301485886186, -6.448889394601196, -16.578529929121345, -15.529516656262189, -16.86215200026831, 2.0518963038921356, 2.7131718024611473, 2.19032384455204, -9.260159340997546, -9.490271677573531, -9.478505273660033, -84.36626309404771, -99.32568160692851, -85.00317564109962, 2.9770066762963836, 3.0951949755350654, 3.1439282173911636, -19.591706700623043, -19.843696549534805, -20.56603533029557, 0.41329577316840016, -0.25137748817603267, 0.7172819574673923, -94.48887685934703, -89.79375595847766, -89.30537487069766, 2.04569826523462, 2.2700148696700637, 2.2802754367391174, -4.15045514206092, -3.741099531451866, -4.695555488268539, 3.0744575982292446, 2.9125978698333057, 3.4537247189631017, -107.62282677491507, -101.36852406462035, -101.25500971948108, 5.392491300900772, 6.213136320312813, 6.146895964940384, -3.1003269404172897, -2.5288183838129044, -2.897985115647316, -1.1902737990021706, -1.1915203928947449, -1.9748270511627197, 4.16514442240198, 3.976384167869881, 4.053520885606602, -1.0942677184939384, -1.1015248820185661, -1.0592353120446205, -92.15829854210219, -104.06588306029639, -92.2526722898086, 2.885773400465638, 3.090679417053849, 2.833351115385682, -6.110867244501918, -6.057427694400161, -6.305208971103042, -19.58580225706101, -19.469336122274406, -19.673988223075874, -9.05553197612366, -9.317526390155166, -9.67199416955313, -101.09914052983126, -102.76043783624968, -112.02900748451552, -1.140341612199947, -1.4306334803501812, -1.1880042428771702, -95.71246806283793, -105.09401075293621, -94.77019041528305, -7.9679978266358376, -7.861890606582165, -7.614786624908447, 1.1515457133452003, 1.1179805497328346, 1.0278540054956977, -5.444543071091175, -5.6967820674180984, -5.297045761719346, -2.2896085580190118, -1.9478045863409932, -2.2330189769466813, -0.978862501680851, -1.2330700904130936, -1.769754484295845, -0.9637115399042813, -0.9768878916899411, -0.7044199171165673, -15.941406359275192, -15.919703004260867, -15.665226533388108, -117.08424297968547, -103.88744084040324, -104.31786088148753, 0.46741071591773675, 0.5826038258771007, -0.15337691207727744, -1.7137100100517273, -2.619423747062683, -2.4127192348241806, -0.361682181557029, -0.27078431596359565, -0.1443999682863648, -6.544327681263297, -6.742198636134475, -6.0821759521107595, 5.1578571274876595, 5.307636260986328, 4.923779591917992, -113.65571629007658, -102.92465623219809, -102.42676827808222, -7.790807013710349, -7.734550734361022, -7.324264248212188, -91.18336675067744, -103.99865021308264, -90.81851479907832, 1.0627732649445534, 0.9332956224679947, 1.211428888142109, -1.421139759322017, -1.5449498941501076, -1.3396111478408272, -1.2718645383914406, -1.2690861051281388, -0.9024665882655825, -1.890065386891365, -1.7928922325372696, -1.6822685822844505, 0.5996693621079032, 0.8083890328804557, 0.7898579860726898, 2.3729162563880237, 2.2792569448550495, 2.747478940834597, 0.44943082580962823, 0.34330222258964227, 0.08983149627843545, -3.966915095845863, -4.045613939563438, -3.71611648301284, -90.25951607773702, -94.2091781894366, -90.3724134216706, -13.995072583357498, -13.721195536355182, -13.53045695709686, -2.714826817313835, -2.1783526881287543, -2.6617904926339833, -98.6987066914638, -100.32164438565573, -115.46614213784537, -8.888352642456695, -9.051688219110176, -8.893598037461445, -10.650175827244922, -10.639233792821571, -10.970031673709556, -3.268691658973694, -3.2988684475421906, -3.101169228553772, -1.684477602442115, -1.3992749278744157, -1.7082217087348397, -105.90330474575362, -115.31708445896706, -105.10444341724119, -8.208879984915257, -8.371282637119293, -7.9161340817809105, -101.6569523861011, -101.64567757149538, -104.43775828679404, -3.458031522730991, -3.4405218015114514, -3.3023117991785256, -3.387336887419224, -3.2762438133358955, -3.880579888820648, -102.94957027832668, -88.66694127271573, -88.60213902841012, -1.2502362330754693, -0.37231528510650946, -0.42255067576965644, -9.279451991120979, -8.989804262916252, -8.554555761317417, -86.62196131547293, -96.70336784919104, -86.54721865554652, -1.03119695186615, -1.307543084025383, -1.382984608411789, -5.44571175177893, -5.7159847666819985, -5.326861170430988, -11.254178379972785, -10.974221323927253, -10.710927249242872, -97.01074757178625, -93.01309042175612, -93.04755552237233, -98.0081518292427, -110.4670860171318, -97.79052033275366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15845572835360008, "mean_inference_ms": 0.6562356548489603, "mean_action_processing_ms": 0.09658049881174531, "mean_env_wait_ms": 0.7894195268513877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"sample_time_ms": 9491.383, "sample_throughput": 505.722, "load_time_ms": 0.1, "load_throughput": 47980598.665, "learn_time_ms": 1221.475, "learn_throughput": 3929.677, "update_time_ms": 1.4}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035156250000000005, "cur_lr": 0.0005, "total_loss": 433.0074882507324, "policy_loss": -0.0027226501612717113, "vf_loss": 433.06568145751953, "vf_explained_var": 0.14190185815095901, "kl": 0.011510192591237018, "entropy": 5.552137494087219, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 504000, "num_steps_trained": 168000, "num_agent_steps_trained": 504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1458, "training_iteration": 35, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-48-07", "timestamp": 1706147287, "time_this_iter_s": 9.274724245071411, "time_total_s": 329.9312312602997, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 329.9312312602997, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 6.621428571428572, "ram_util_percent": 45.57857142857143}}
{"episode_reward_max": 17.75252358615397, "episode_reward_min": -335.8886672630906, "episode_reward_mean": -79.65128630739055, "episode_len_mean": 251.11, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"shared_policy": -117.08424297968547}, "policy_reward_max": {"shared_policy": 6.213136320312813}, "policy_reward_mean": {"shared_policy": -26.550428769130193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.158153492957354, -23.731073049828424, -314.07474415935576, -4.501332908868818, -25.43716261535883, 15.435514356940956, -17.124945059418707, 13.94490242190659, -2.074055951088667, -18.88035776466134, -48.97019858565184, 6.955391950905323, -28.22893629223111, -268.6951203420758, 9.216129869222613, -60.00143858045342, 0.8792002424597598, -273.58800768852234, 6.595988571643801, -12.587110161781325, 9.440780187025652, -310.24636055901647, 17.75252358615397, -8.52713043987751, -4.356621243059635, 12.195049475878463, -3.255027912557125, -288.47685389220715, 8.809803932905169, -18.47350391000512, -58.72912660241129, -28.045052535831957, -315.8885858505964, -3.7589793354272985, -295.57666923105717, -23.44467505812645, 3.2973802685737326, -16.43837090022862, -6.470432121306686, -3.9816870763897896, -2.6450193487107896, -47.52633589692417, -325.28954470157623, 0.89663762971756, -6.745852991938591, -0.7768664658069895, -19.368702269508532, 15.38927298039198, -319.00714080035686, -22.84962199628356, -286.0005317628384, 3.207497775554657, -4.305700801312952, -3.443417231785162, -5.365226201713085, 2.1979163810610487, 7.39965214207767, 0.882564544677706, -11.728645518422141, -274.8411076888442, -41.24672507680954, -7.554969998076572, -314.48649321496487, -26.833638899028315, -32.25944129377605, -9.668729335069656, -4.79197423905137, -326.3248326219619, -24.49629670381546, -307.74038824439054, -10.200865123420968, -10.544160589575768, -280.2186505794525, -2.045102193951635, -26.823812015354648, -269.87254782021046, -3.721724644303322, -16.488557688891916, -32.93932695314291, -283.0713935159147, -306.26575817912817, 11.746968161314726, -318.0572899580002, -24.188196912407903, -3.140084034763291, 17.067606117576346, 15.067082535475478, -303.5405588746071, -13.32565828040245, -6.835564720910071, -17.735030688345432, -310.02087010466494, 9.018459521234021, -318.07412292063236, -335.8886672630906, -22.461228560656323, -6.323690775781884, -14.11534085869792, 11.35202038288115, -272.95985389500856], "episode_lengths": [300, 300, 62, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 300, 300, 116, 300, 300, 300, 74, 300, 300, 300, 300, 300, 127, 300, 300, 300, 300, 75, 300, 299, 300, 300, 300, 300, 300, 300, 300, 58, 300, 300, 300, 300, 300, 52, 300, 72, 300, 300, 300, 300, 300, 300, 300, 300, 85, 300, 300, 45, 300, 300, 300, 300, 69, 300, 67, 300, 300, 92, 300, 300, 113, 300, 300, 300, 82, 66, 300, 180, 300, 300, 300, 300, 105, 300, 300, 300, 56, 300, 66, 173, 300, 300, 300, 300, 90], "policy_shared_policy_reward": [-15.360215611755848, -15.59384149312973, -15.204096388071775, -8.235345381001636, -7.734869989256069, -7.760857679570719, -101.31653345997135, -111.15157947751383, -101.60663122187059, -1.6521884029110367, -1.6388757427533562, -1.2102687632044251, -7.986630879342556, -8.335522308945656, -9.115009427070618, 5.187149705986172, 5.581632299969584, 4.6667323509852, -5.593532343705505, -5.605956410368293, -5.925456305344909, 4.163451477885246, 5.126601004973054, 4.65484993904829, -0.7442767545580864, -0.5970082618296146, -0.7327709347009659, -6.234166884173959, -6.197301485886186, -6.448889394601196, -16.578529929121345, -15.529516656262189, -16.86215200026831, 2.0518963038921356, 2.7131718024611473, 2.19032384455204, -9.260159340997546, -9.490271677573531, -9.478505273660033, -84.36626309404771, -99.32568160692851, -85.00317564109962, 2.9770066762963836, 3.0951949755350654, 3.1439282173911636, -19.591706700623043, -19.843696549534805, -20.56603533029557, 0.41329577316840016, -0.25137748817603267, 0.7172819574673923, -94.48887685934703, -89.79375595847766, -89.30537487069766, 2.04569826523462, 2.2700148696700637, 2.2802754367391174, -4.15045514206092, -3.741099531451866, -4.695555488268539, 3.0744575982292446, 2.9125978698333057, 3.4537247189631017, -107.62282677491507, -101.36852406462035, -101.25500971948108, 5.392491300900772, 6.213136320312813, 6.146895964940384, -3.1003269404172897, -2.5288183838129044, -2.897985115647316, -1.1902737990021706, -1.1915203928947449, -1.9748270511627197, 4.16514442240198, 3.976384167869881, 4.053520885606602, -1.0942677184939384, -1.1015248820185661, -1.0592353120446205, -92.15829854210219, -104.06588306029639, -92.2526722898086, 2.885773400465638, 3.090679417053849, 2.833351115385682, -6.110867244501918, -6.057427694400161, -6.305208971103042, -19.58580225706101, -19.469336122274406, -19.673988223075874, -9.05553197612366, -9.317526390155166, -9.67199416955313, -101.09914052983126, -102.76043783624968, -112.02900748451552, -1.140341612199947, -1.4306334803501812, -1.1880042428771702, -95.71246806283793, -105.09401075293621, -94.77019041528305, -7.9679978266358376, -7.861890606582165, -7.614786624908447, 1.1515457133452003, 1.1179805497328346, 1.0278540054956977, -5.444543071091175, -5.6967820674180984, -5.297045761719346, -2.2896085580190118, -1.9478045863409932, -2.2330189769466813, -0.978862501680851, -1.2330700904130936, -1.769754484295845, -0.9637115399042813, -0.9768878916899411, -0.7044199171165673, -15.941406359275192, -15.919703004260867, -15.665226533388108, -117.08424297968547, -103.88744084040324, -104.31786088148753, 0.46741071591773675, 0.5826038258771007, -0.15337691207727744, -1.7137100100517273, -2.619423747062683, -2.4127192348241806, -0.361682181557029, -0.27078431596359565, -0.1443999682863648, -6.544327681263297, -6.742198636134475, -6.0821759521107595, 5.1578571274876595, 5.307636260986328, 4.923779591917992, -113.65571629007658, -102.92465623219809, -102.42676827808222, -7.790807013710349, -7.734550734361022, -7.324264248212188, -91.18336675067744, -103.99865021308264, -90.81851479907832, 1.0627732649445534, 0.9332956224679947, 1.211428888142109, -1.421139759322017, -1.5449498941501076, -1.3396111478408272, -1.2718645383914406, -1.2690861051281388, -0.9024665882655825, -1.890065386891365, -1.7928922325372696, -1.6822685822844505, 0.5996693621079032, 0.8083890328804557, 0.7898579860726898, 2.3729162563880237, 2.2792569448550495, 2.747478940834597, 0.44943082580962823, 0.34330222258964227, 0.08983149627843545, -3.966915095845863, -4.045613939563438, -3.71611648301284, -90.25951607773702, -94.2091781894366, -90.3724134216706, -13.995072583357498, -13.721195536355182, -13.53045695709686, -2.714826817313835, -2.1783526881287543, -2.6617904926339833, -98.6987066914638, -100.32164438565573, -115.46614213784537, -8.888352642456695, -9.051688219110176, -8.893598037461445, -10.650175827244922, -10.639233792821571, -10.970031673709556, -3.268691658973694, -3.2988684475421906, -3.101169228553772, -1.684477602442115, -1.3992749278744157, -1.7082217087348397, -105.90330474575362, -115.31708445896706, -105.10444341724119, -8.208879984915257, -8.371282637119293, -7.9161340817809105, -101.6569523861011, -101.64567757149538, -104.43775828679404, -3.458031522730991, -3.4405218015114514, -3.3023117991785256, -3.387336887419224, -3.2762438133358955, -3.880579888820648, -102.94957027832668, -88.66694127271573, -88.60213902841012, -1.2502362330754693, -0.37231528510650946, -0.42255067576965644, -9.279451991120979, -8.989804262916252, -8.554555761317417, -86.62196131547293, -96.70336784919104, -86.54721865554652, -1.03119695186615, -1.307543084025383, -1.382984608411789, -5.44571175177893, -5.7159847666819985, -5.326861170430988, -11.254178379972785, -10.974221323927253, -10.710927249242872, -97.01074757178625, -93.01309042175612, -93.04755552237233, -98.0081518292427, -110.4670860171318, -97.79052033275366, 4.079342316836119, 3.9191215857863426, 3.7485042586922646, -102.1889434059461, -103.33399348457655, -112.53435306747755, -8.010469821592181, -8.211563711365073, -7.966163379450649, -1.1263744483391491, -1.2604928712050167, -0.7532167152191249, 5.172897373636559, 5.880786274870232, 6.013922469069556, 5.105865673472479, 4.891921934982136, 5.069294927020863, -97.25592888394992, -98.1630121866862, -108.12161780397098, -4.350125667949527, -4.870648299654334, -4.104884312798589, -2.708816771705955, -2.2767710511883195, -1.8499768980157967, -5.789602510631084, -5.891737714409828, -6.05369046330452, -113.97173289457957, -99.12849355737369, -96.92064365271169, 3.013859843214348, 2.7554161896308216, 3.2491834883888515, -114.11329513788223, -102.50727808475494, -101.45354969799519, -112.10627726217112, -111.58056105424961, -112.2018289466699, -7.841285760204002, -7.1649969505767075, -7.454945849875614, -2.4999668846527783, -2.0925398568312374, -1.7311840342978684, -4.513824780782073, -5.043728401263564, -4.557787676652282, 3.9653017719586643, 3.6868742456038746, 3.6998443653186115, -87.24238467713198, -98.82833143075308, -86.88913778712353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1581010853317867, "mean_inference_ms": 0.6566232301704715, "mean_action_processing_ms": 0.09663294583950707, "mean_env_wait_ms": 0.7902924532559268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 518400, "timers": {"sample_time_ms": 9516.387, "sample_throughput": 504.393, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1224.668, "learn_throughput": 3919.43, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035156250000000005, "cur_lr": 0.0005, "total_loss": 340.91464614868164, "policy_loss": -0.0038669939510550255, "vf_loss": 340.97361755371094, "vf_explained_var": 0.04529532790184021, "kl": 0.01124383285060145, "entropy": 5.514338374137878, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 518400, "num_steps_trained": 172800, "num_agent_steps_trained": 518400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1477, "training_iteration": 36, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-48-16", "timestamp": 1706147296, "time_this_iter_s": 9.204164743423462, "time_total_s": 339.13539600372314, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004ECEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 339.13539600372314, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 9.723076923076924, "ram_util_percent": 45.407692307692294}}
{"episode_reward_max": 17.75252358615397, "episode_reward_min": -335.8886672630906, "episode_reward_mean": -87.236454783316, "episode_len_mean": 245.4, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": -119.32378886143367}, "policy_reward_max": {"shared_policy": 6.213136320312813}, "policy_reward_mean": {"shared_policy": -29.07881826110534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.440780187025652, -310.24636055901647, 17.75252358615397, -8.52713043987751, -4.356621243059635, 12.195049475878463, -3.255027912557125, -288.47685389220715, 8.809803932905169, -18.47350391000512, -58.72912660241129, -28.045052535831957, -315.8885858505964, -3.7589793354272985, -295.57666923105717, -23.44467505812645, 3.2973802685737326, -16.43837090022862, -6.470432121306686, -3.9816870763897896, -2.6450193487107896, -47.52633589692417, -325.28954470157623, 0.89663762971756, -6.745852991938591, -0.7768664658069895, -19.368702269508532, 15.38927298039198, -319.00714080035686, -22.84962199628356, -286.0005317628384, 3.207497775554657, -4.305700801312952, -3.443417231785162, -5.365226201713085, 2.1979163810610487, 7.39965214207767, 0.882564544677706, -11.728645518422141, -274.8411076888442, -41.24672507680954, -7.554969998076572, -314.48649321496487, -26.833638899028315, -32.25944129377605, -9.668729335069656, -4.79197423905137, -326.3248326219619, -24.49629670381546, -307.74038824439054, -10.200865123420968, -10.544160589575768, -280.2186505794525, -2.045102193951635, -26.823812015354648, -269.87254782021046, -3.721724644303322, -16.488557688891916, -32.93932695314291, -283.0713935159147, -306.26575817912817, 11.746968161314726, -318.0572899580002, -24.188196912407903, -3.140084034763291, 17.067606117576346, 15.067082535475478, -303.5405588746071, -13.32565828040245, -6.835564720910071, -17.735030688345432, -310.02087010466494, 9.018459521234021, -318.07412292063236, -335.8886672630906, -22.461228560656323, -6.323690775781884, -14.11534085869792, 11.35202038288115, -272.95985389500856, 17.56141658872366, -22.231071151793003, -5.84685867652297, 8.230276152724386, 0.5462169647216513, -335.3532402738929, 14.315163657069206, -288.28814854472876, -1.3074299469590187, -297.68356750905514, -13.426135361194625, -318.3987798988819, 7.795568112283931, -276.32949662953615, 3.1013840306550264, -22.012671299278765, -304.082194596529, 5.859391868114457, -25.464502811431885, 3.47232249379158], "episode_lengths": [300, 74, 300, 300, 300, 300, 300, 127, 300, 300, 300, 300, 75, 300, 299, 300, 300, 300, 300, 300, 300, 300, 58, 300, 300, 300, 300, 300, 52, 300, 72, 300, 300, 300, 300, 300, 300, 300, 300, 85, 300, 300, 45, 300, 300, 300, 300, 69, 300, 67, 300, 300, 92, 300, 300, 113, 300, 300, 300, 82, 66, 300, 180, 300, 300, 300, 300, 105, 300, 300, 300, 56, 300, 66, 173, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 227, 300, 79, 300, 62, 300, 58, 300, 87, 300, 300, 81, 300, 300, 300], "policy_shared_policy_reward": [3.0744575982292446, 2.9125978698333057, 3.4537247189631017, -107.62282677491507, -101.36852406462035, -101.25500971948108, 5.392491300900772, 6.213136320312813, 6.146895964940384, -3.1003269404172897, -2.5288183838129044, -2.897985115647316, -1.1902737990021706, -1.1915203928947449, -1.9748270511627197, 4.16514442240198, 3.976384167869881, 4.053520885606602, -1.0942677184939384, -1.1015248820185661, -1.0592353120446205, -92.15829854210219, -104.06588306029639, -92.2526722898086, 2.885773400465638, 3.090679417053849, 2.833351115385682, -6.110867244501918, -6.057427694400161, -6.305208971103042, -19.58580225706101, -19.469336122274406, -19.673988223075874, -9.05553197612366, -9.317526390155166, -9.67199416955313, -101.09914052983126, -102.76043783624968, -112.02900748451552, -1.140341612199947, -1.4306334803501812, -1.1880042428771702, -95.71246806283793, -105.09401075293621, -94.77019041528305, -7.9679978266358376, -7.861890606582165, -7.614786624908447, 1.1515457133452003, 1.1179805497328346, 1.0278540054956977, -5.444543071091175, -5.6967820674180984, -5.297045761719346, -2.2896085580190118, -1.9478045863409932, -2.2330189769466813, -0.978862501680851, -1.2330700904130936, -1.769754484295845, -0.9637115399042813, -0.9768878916899411, -0.7044199171165673, -15.941406359275192, -15.919703004260867, -15.665226533388108, -117.08424297968547, -103.88744084040324, -104.31786088148753, 0.46741071591773675, 0.5826038258771007, -0.15337691207727744, -1.7137100100517273, -2.619423747062683, -2.4127192348241806, -0.361682181557029, -0.27078431596359565, -0.1443999682863648, -6.544327681263297, -6.742198636134475, -6.0821759521107595, 5.1578571274876595, 5.307636260986328, 4.923779591917992, -113.65571629007658, -102.92465623219809, -102.42676827808222, -7.790807013710349, -7.734550734361022, -7.324264248212188, -91.18336675067744, -103.99865021308264, -90.81851479907832, 1.0627732649445534, 0.9332956224679947, 1.211428888142109, -1.421139759322017, -1.5449498941501076, -1.3396111478408272, -1.2718645383914406, -1.2690861051281388, -0.9024665882655825, -1.890065386891365, -1.7928922325372696, -1.6822685822844505, 0.5996693621079032, 0.8083890328804557, 0.7898579860726898, 2.3729162563880237, 2.2792569448550495, 2.747478940834597, 0.44943082580962823, 0.34330222258964227, 0.08983149627843545, -3.966915095845863, -4.045613939563438, -3.71611648301284, -90.25951607773702, -94.2091781894366, -90.3724134216706, -13.995072583357498, -13.721195536355182, -13.53045695709686, -2.714826817313835, -2.1783526881287543, -2.6617904926339833, -98.6987066914638, -100.32164438565573, -115.46614213784537, -8.888352642456695, -9.051688219110176, -8.893598037461445, -10.650175827244922, -10.639233792821571, -10.970031673709556, -3.268691658973694, -3.2988684475421906, -3.101169228553772, -1.684477602442115, -1.3992749278744157, -1.7082217087348397, -105.90330474575362, -115.31708445896706, -105.10444341724119, -8.208879984915257, -8.371282637119293, -7.9161340817809105, -101.6569523861011, -101.64567757149538, -104.43775828679404, -3.458031522730991, -3.4405218015114514, -3.3023117991785256, -3.387336887419224, -3.2762438133358955, -3.880579888820648, -102.94957027832668, -88.66694127271573, -88.60213902841012, -1.2502362330754693, -0.37231528510650946, -0.42255067576965644, -9.279451991120979, -8.989804262916252, -8.554555761317417, -86.62196131547293, -96.70336784919104, -86.54721865554652, -1.03119695186615, -1.307543084025383, -1.382984608411789, -5.44571175177893, -5.7159847666819985, -5.326861170430988, -11.254178379972785, -10.974221323927253, -10.710927249242872, -97.01074757178625, -93.01309042175612, -93.04755552237233, -98.0081518292427, -110.4670860171318, -97.79052033275366, 4.079342316836119, 3.9191215857863426, 3.7485042586922646, -102.1889434059461, -103.33399348457655, -112.53435306747755, -8.010469821592181, -8.211563711365073, -7.966163379450649, -1.1263744483391491, -1.2604928712050167, -0.7532167152191249, 5.172897373636559, 5.880786274870232, 6.013922469069556, 5.105865673472479, 4.891921934982136, 5.069294927020863, -97.25592888394992, -98.1630121866862, -108.12161780397098, -4.350125667949527, -4.870648299654334, -4.104884312798589, -2.708816771705955, -2.2767710511883195, -1.8499768980157967, -5.789602510631084, -5.891737714409828, -6.05369046330452, -113.97173289457957, -99.12849355737369, -96.92064365271169, 3.013859843214348, 2.7554161896308216, 3.2491834883888515, -114.11329513788223, -102.50727808475494, -101.45354969799519, -112.10627726217112, -111.58056105424961, -112.2018289466699, -7.841285760204002, -7.1649969505767075, -7.454945849875614, -2.4999668846527783, -2.0925398568312374, -1.7311840342978684, -4.513824780782073, -5.043728401263564, -4.557787676652282, 3.9653017719586643, 3.6868742456038746, 3.6998443653186115, -87.24238467713198, -98.82833143075308, -86.88913778712353, 5.967795811593533, 5.604294314980507, 5.98932646214962, -7.2154833897948265, -7.103713020682335, -7.911874741315842, -1.8030604161322117, -1.9898470118641853, -2.053951248526573, 2.669612949093178, 2.5028549109895977, 3.05780829264161, 0.09719158212342904, -0.29218946894010855, 0.7412148515383308, -107.86349931607644, -108.16595209638278, -119.32378886143367, 4.656356230378151, 4.578289493918419, 5.080517932772636, -91.32294624298811, -103.9237140417099, -93.04148826003075, -0.5848101824522018, -0.6276863366365433, -0.09493342787027359, -94.3103371411562, -96.00946000218391, -107.36377036571503, -4.436284760634109, -4.341203058759376, -4.6486475418011395, -102.10729146003723, -112.68991032242775, -103.60157811641693, 2.7200637025137695, 2.3392853339513096, 2.736219075818852, -87.7986196850737, -100.32875337203345, -88.20212357242903, 0.6329245418310165, 1.228286411613226, 1.240173077210784, -7.080034387608379, -7.7259998371203835, -7.206637074550002, -100.25180363158385, -100.39054029683273, -103.43985066811244, 1.302714159091309, 2.3492627193530353, 2.207414989670113, -8.626472905278206, -8.206722170114517, -8.631307736039162, 1.2495575994253159, 0.9533616304397583, 1.269403263926506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15767471694998889, "mean_inference_ms": 0.6566797820366221, "mean_action_processing_ms": 0.09665436594453736, "mean_env_wait_ms": 0.7909190564670001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 177600, "timesteps_this_iter": 0, "agent_timesteps_total": 532800, "timers": {"sample_time_ms": 9480.623, "sample_throughput": 506.296, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1227.663, "learn_throughput": 3909.869, "update_time_ms": 1.4}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035156250000000005, "cur_lr": 0.0005, "total_loss": 289.5634956359863, "policy_loss": -0.00265793649990681, "vf_loss": 289.6227111816406, "vf_explained_var": 0.05599430203437805, "kl": 0.01033150809235481, "entropy": 5.659684658050537, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 177600, "num_agent_steps_sampled": 532800, "num_steps_trained": 177600, "num_agent_steps_trained": 532800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1497, "training_iteration": 37, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-48-25", "timestamp": 1706147305, "time_this_iter_s": 9.162694454193115, "time_total_s": 348.29809045791626, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055EC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 348.29809045791626, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 7.8538461538461535, "ram_util_percent": 45.30769230769231}}
{"episode_reward_max": 19.73486519977449, "episode_reward_min": -335.8886672630906, "episode_reward_mean": -88.4106118794356, "episode_len_mean": 243.8, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"shared_policy": -119.32378886143367}, "policy_reward_max": {"shared_policy": 6.896416903783873}, "policy_reward_mean": {"shared_policy": -29.47020395981188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9816870763897896, -2.6450193487107896, -47.52633589692417, -325.28954470157623, 0.89663762971756, -6.745852991938591, -0.7768664658069895, -19.368702269508532, 15.38927298039198, -319.00714080035686, -22.84962199628356, -286.0005317628384, 3.207497775554657, -4.305700801312952, -3.443417231785162, -5.365226201713085, 2.1979163810610487, 7.39965214207767, 0.882564544677706, -11.728645518422141, -274.8411076888442, -41.24672507680954, -7.554969998076572, -314.48649321496487, -26.833638899028315, -32.25944129377605, -9.668729335069656, -4.79197423905137, -326.3248326219619, -24.49629670381546, -307.74038824439054, -10.200865123420968, -10.544160589575768, -280.2186505794525, -2.045102193951635, -26.823812015354648, -269.87254782021046, -3.721724644303322, -16.488557688891916, -32.93932695314291, -283.0713935159147, -306.26575817912817, 11.746968161314726, -318.0572899580002, -24.188196912407903, -3.140084034763291, 17.067606117576346, 15.067082535475478, -303.5405588746071, -13.32565828040245, -6.835564720910071, -17.735030688345432, -310.02087010466494, 9.018459521234021, -318.07412292063236, -335.8886672630906, -22.461228560656323, -6.323690775781884, -14.11534085869792, 11.35202038288115, -272.95985389500856, 17.56141658872366, -22.231071151793003, -5.84685867652297, 8.230276152724386, 0.5462169647216513, -335.3532402738929, 14.315163657069206, -288.28814854472876, -1.3074299469590187, -297.68356750905514, -13.426135361194625, -318.3987798988819, 7.795568112283931, -276.32949662953615, 3.1013840306550264, -22.012671299278765, -304.082194596529, 5.859391868114457, -25.464502811431885, 3.47232249379158, 16.37753200158474, 19.73486519977449, -332.3730893880129, -5.956577207893162, -9.609953939914732, -2.945049919188037, -9.700798492878704, -14.494672022759929, -8.81220230460167, -298.9084080606699, -2.3264543116092966, -317.3961516954005, -17.42290953919293, -34.023784182965755, -20.914878867566614, -14.558460168540478, -304.0951758623123, -44.88755578920245, -45.2938372017816], "episode_lengths": [300, 300, 300, 58, 300, 300, 300, 300, 300, 52, 300, 72, 300, 300, 300, 300, 300, 300, 300, 300, 85, 300, 300, 45, 300, 300, 300, 300, 69, 300, 67, 300, 300, 92, 300, 300, 113, 300, 300, 300, 82, 66, 300, 180, 300, 300, 300, 300, 105, 300, 300, 300, 56, 300, 66, 173, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 227, 300, 79, 300, 62, 300, 58, 300, 87, 300, 300, 81, 300, 300, 300, 300, 300, 199, 300, 300, 300, 300, 300, 300, 47, 300, 51, 300, 300, 300, 300, 118, 300, 300], "policy_shared_policy_reward": [-0.978862501680851, -1.2330700904130936, -1.769754484295845, -0.9637115399042813, -0.9768878916899411, -0.7044199171165673, -15.941406359275192, -15.919703004260867, -15.665226533388108, -117.08424297968547, -103.88744084040324, -104.31786088148753, 0.46741071591773675, 0.5826038258771007, -0.15337691207727744, -1.7137100100517273, -2.619423747062683, -2.4127192348241806, -0.361682181557029, -0.27078431596359565, -0.1443999682863648, -6.544327681263297, -6.742198636134475, -6.0821759521107595, 5.1578571274876595, 5.307636260986328, 4.923779591917992, -113.65571629007658, -102.92465623219809, -102.42676827808222, -7.790807013710349, -7.734550734361022, -7.324264248212188, -91.18336675067744, -103.99865021308264, -90.81851479907832, 1.0627732649445534, 0.9332956224679947, 1.211428888142109, -1.421139759322017, -1.5449498941501076, -1.3396111478408272, -1.2718645383914406, -1.2690861051281388, -0.9024665882655825, -1.890065386891365, -1.7928922325372696, -1.6822685822844505, 0.5996693621079032, 0.8083890328804557, 0.7898579860726898, 2.3729162563880237, 2.2792569448550495, 2.747478940834597, 0.44943082580962823, 0.34330222258964227, 0.08983149627843545, -3.966915095845863, -4.045613939563438, -3.71611648301284, -90.25951607773702, -94.2091781894366, -90.3724134216706, -13.995072583357498, -13.721195536355182, -13.53045695709686, -2.714826817313835, -2.1783526881287543, -2.6617904926339833, -98.6987066914638, -100.32164438565573, -115.46614213784537, -8.888352642456695, -9.051688219110176, -8.893598037461445, -10.650175827244922, -10.639233792821571, -10.970031673709556, -3.268691658973694, -3.2988684475421906, -3.101169228553772, -1.684477602442115, -1.3992749278744157, -1.7082217087348397, -105.90330474575362, -115.31708445896706, -105.10444341724119, -8.208879984915257, -8.371282637119293, -7.9161340817809105, -101.6569523861011, -101.64567757149538, -104.43775828679404, -3.458031522730991, -3.4405218015114514, -3.3023117991785256, -3.387336887419224, -3.2762438133358955, -3.880579888820648, -102.94957027832668, -88.66694127271573, -88.60213902841012, -1.2502362330754693, -0.37231528510650946, -0.42255067576965644, -9.279451991120979, -8.989804262916252, -8.554555761317417, -86.62196131547293, -96.70336784919104, -86.54721865554652, -1.03119695186615, -1.307543084025383, -1.382984608411789, -5.44571175177893, -5.7159847666819985, -5.326861170430988, -11.254178379972785, -10.974221323927253, -10.710927249242872, -97.01074757178625, -93.01309042175612, -93.04755552237233, -98.0081518292427, -110.4670860171318, -97.79052033275366, 4.079342316836119, 3.9191215857863426, 3.7485042586922646, -102.1889434059461, -103.33399348457655, -112.53435306747755, -8.010469821592181, -8.211563711365073, -7.966163379450649, -1.1263744483391491, -1.2604928712050167, -0.7532167152191249, 5.172897373636559, 5.880786274870232, 6.013922469069556, 5.105865673472479, 4.891921934982136, 5.069294927020863, -97.25592888394992, -98.1630121866862, -108.12161780397098, -4.350125667949527, -4.870648299654334, -4.104884312798589, -2.708816771705955, -2.2767710511883195, -1.8499768980157967, -5.789602510631084, -5.891737714409828, -6.05369046330452, -113.97173289457957, -99.12849355737369, -96.92064365271169, 3.013859843214348, 2.7554161896308216, 3.2491834883888515, -114.11329513788223, -102.50727808475494, -101.45354969799519, -112.10627726217112, -111.58056105424961, -112.2018289466699, -7.841285760204002, -7.1649969505767075, -7.454945849875614, -2.4999668846527783, -2.0925398568312374, -1.7311840342978684, -4.513824780782073, -5.043728401263564, -4.557787676652282, 3.9653017719586643, 3.6868742456038746, 3.6998443653186115, -87.24238467713198, -98.82833143075308, -86.88913778712353, 5.967795811593533, 5.604294314980507, 5.98932646214962, -7.2154833897948265, -7.103713020682335, -7.911874741315842, -1.8030604161322117, -1.9898470118641853, -2.053951248526573, 2.669612949093178, 2.5028549109895977, 3.05780829264161, 0.09719158212342904, -0.29218946894010855, 0.7412148515383308, -107.86349931607644, -108.16595209638278, -119.32378886143367, 4.656356230378151, 4.578289493918419, 5.080517932772636, -91.32294624298811, -103.9237140417099, -93.04148826003075, -0.5848101824522018, -0.6276863366365433, -0.09493342787027359, -94.3103371411562, -96.00946000218391, -107.36377036571503, -4.436284760634109, -4.341203058759376, -4.6486475418011395, -102.10729146003723, -112.68991032242775, -103.60157811641693, 2.7200637025137695, 2.3392853339513096, 2.736219075818852, -87.7986196850737, -100.32875337203345, -88.20212357242903, 0.6329245418310165, 1.228286411613226, 1.240173077210784, -7.080034387608379, -7.7259998371203835, -7.206637074550002, -100.25180363158385, -100.39054029683273, -103.43985066811244, 1.302714159091309, 2.3492627193530353, 2.207414989670113, -8.626472905278206, -8.206722170114517, -8.631307736039162, 1.2495575994253159, 0.9533616304397583, 1.269403263926506, 5.33381640414396, 5.378017308811337, 5.665698288629443, 6.291140546401337, 6.896416903783873, 6.5473077495892795, -107.79199927051863, -117.52620822687945, -107.05488189061484, -1.6076765072842534, -1.9973634233077462, -2.351537277301162, -3.3693976302941735, -2.9259025653203423, -3.314653744300216, -0.8472870017091481, -0.9831103781859127, -1.114652539292976, -3.4465666761001046, -3.1734948505958016, -3.0807369661827977, -4.934022928277656, -4.833767356971904, -4.726881737510368, -2.849241115152836, -3.1300766319036484, -2.832884557545185, -103.61325462659201, -98.28691204388937, -97.00824139018854, -0.8614606087406571, -0.7085501452287133, -0.7564435576399262, -114.9374284942945, -100.71609964345893, -101.74262355764708, -6.0024421686927525, -5.6270407351354805, -5.793426635364696, -10.94762907922268, -11.213893495500088, -11.862261608242989, -7.190819477041572, -6.734503490229457, -6.989555900295585, -4.660393588244915, -4.724090054631233, -5.1739765256643295, -98.07324369748434, -108.19477399190268, -97.82715817292532, -15.071266420185566, -14.850875284522772, -14.965414084494114, -15.408734892805427, -14.667367371109634, -15.217734937866538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15728400966243192, "mean_inference_ms": 0.6564062406569433, "mean_action_processing_ms": 0.09663351886216522, "mean_env_wait_ms": 0.7911410469360781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 182400, "timesteps_this_iter": 0, "agent_timesteps_total": 547200, "timers": {"sample_time_ms": 9503.861, "sample_throughput": 505.058, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1188.722, "learn_throughput": 4037.951, "update_time_ms": 1.299}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035156250000000005, "cur_lr": 0.0005, "total_loss": 248.90980911254883, "policy_loss": -0.0037776134282790363, "vf_loss": 248.9723606109619, "vf_explained_var": -0.010081589221954346, "kl": 0.025878997294062855, "entropy": 5.8867358565330505, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 182400, "num_agent_steps_sampled": 547200, "num_steps_trained": 182400, "num_agent_steps_trained": 547200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1516, "training_iteration": 38, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-48-35", "timestamp": 1706147315, "time_this_iter_s": 9.338563680648804, "time_total_s": 357.63665413856506, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004ECE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 357.63665413856506, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 7.5307692307692315, "ram_util_percent": 45.33846153846154}}
{"episode_reward_max": 19.73486519977449, "episode_reward_min": -335.8886672630906, "episode_reward_mean": -93.85370988602037, "episode_len_mean": 241.86, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"shared_policy": -121.4751213391622}, "policy_reward_max": {"shared_policy": 6.896416903783873}, "policy_reward_mean": {"shared_policy": -31.284569962006795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.728645518422141, -274.8411076888442, -41.24672507680954, -7.554969998076572, -314.48649321496487, -26.833638899028315, -32.25944129377605, -9.668729335069656, -4.79197423905137, -326.3248326219619, -24.49629670381546, -307.74038824439054, -10.200865123420968, -10.544160589575768, -280.2186505794525, -2.045102193951635, -26.823812015354648, -269.87254782021046, -3.721724644303322, -16.488557688891916, -32.93932695314291, -283.0713935159147, -306.26575817912817, 11.746968161314726, -318.0572899580002, -24.188196912407903, -3.140084034763291, 17.067606117576346, 15.067082535475478, -303.5405588746071, -13.32565828040245, -6.835564720910071, -17.735030688345432, -310.02087010466494, 9.018459521234021, -318.07412292063236, -335.8886672630906, -22.461228560656323, -6.323690775781884, -14.11534085869792, 11.35202038288115, -272.95985389500856, 17.56141658872366, -22.231071151793003, -5.84685867652297, 8.230276152724386, 0.5462169647216513, -335.3532402738929, 14.315163657069206, -288.28814854472876, -1.3074299469590187, -297.68356750905514, -13.426135361194625, -318.3987798988819, 7.795568112283931, -276.32949662953615, 3.1013840306550264, -22.012671299278765, -304.082194596529, 5.859391868114457, -25.464502811431885, 3.47232249379158, 16.37753200158474, 19.73486519977449, -332.3730893880129, -5.956577207893162, -9.609953939914732, -2.945049919188037, -9.700798492878704, -14.494672022759929, -8.81220230460167, -298.9084080606699, -2.3264543116092966, -317.3961516954005, -17.42290953919293, -34.023784182965755, -20.914878867566614, -14.558460168540478, -304.0951758623123, -44.88755578920245, -45.2938372017816, -14.729688044637442, -16.18255387432876, -0.002368509769468119, -6.482760854065418, -19.570392437279253, 16.09006429091093, 17.348060399293885, 18.315681807696805, 7.476463057100773, -313.8960201451555, -282.8312641605735, 4.447154179215431, -293.62748493254185, -15.334129013121128, -3.5879435201495937, 11.386327575892196, -12.827175647020354, -331.173161605373, -326.460715316236], "episode_lengths": [300, 85, 300, 300, 45, 300, 300, 300, 300, 69, 300, 67, 300, 300, 92, 300, 300, 113, 300, 300, 300, 82, 66, 300, 180, 300, 300, 300, 300, 105, 300, 300, 300, 56, 300, 66, 173, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 227, 300, 79, 300, 62, 300, 58, 300, 87, 300, 300, 81, 300, 300, 300, 300, 300, 199, 300, 300, 300, 300, 300, 300, 47, 300, 51, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 53, 144, 300, 48, 300, 300, 300, 300, 49, 294], "policy_shared_policy_reward": [-3.966915095845863, -4.045613939563438, -3.71611648301284, -90.25951607773702, -94.2091781894366, -90.3724134216706, -13.995072583357498, -13.721195536355182, -13.53045695709686, -2.714826817313835, -2.1783526881287543, -2.6617904926339833, -98.6987066914638, -100.32164438565573, -115.46614213784537, -8.888352642456695, -9.051688219110176, -8.893598037461445, -10.650175827244922, -10.639233792821571, -10.970031673709556, -3.268691658973694, -3.2988684475421906, -3.101169228553772, -1.684477602442115, -1.3992749278744157, -1.7082217087348397, -105.90330474575362, -115.31708445896706, -105.10444341724119, -8.208879984915257, -8.371282637119293, -7.9161340817809105, -101.6569523861011, -101.64567757149538, -104.43775828679404, -3.458031522730991, -3.4405218015114514, -3.3023117991785256, -3.387336887419224, -3.2762438133358955, -3.880579888820648, -102.94957027832668, -88.66694127271573, -88.60213902841012, -1.2502362330754693, -0.37231528510650946, -0.42255067576965644, -9.279451991120979, -8.989804262916252, -8.554555761317417, -86.62196131547293, -96.70336784919104, -86.54721865554652, -1.03119695186615, -1.307543084025383, -1.382984608411789, -5.44571175177893, -5.7159847666819985, -5.326861170430988, -11.254178379972785, -10.974221323927253, -10.710927249242872, -97.01074757178625, -93.01309042175612, -93.04755552237233, -98.0081518292427, -110.4670860171318, -97.79052033275366, 4.079342316836119, 3.9191215857863426, 3.7485042586922646, -102.1889434059461, -103.33399348457655, -112.53435306747755, -8.010469821592181, -8.211563711365073, -7.966163379450649, -1.1263744483391491, -1.2604928712050167, -0.7532167152191249, 5.172897373636559, 5.880786274870232, 6.013922469069556, 5.105865673472479, 4.891921934982136, 5.069294927020863, -97.25592888394992, -98.1630121866862, -108.12161780397098, -4.350125667949527, -4.870648299654334, -4.104884312798589, -2.708816771705955, -2.2767710511883195, -1.8499768980157967, -5.789602510631084, -5.891737714409828, -6.05369046330452, -113.97173289457957, -99.12849355737369, -96.92064365271169, 3.013859843214348, 2.7554161896308216, 3.2491834883888515, -114.11329513788223, -102.50727808475494, -101.45354969799519, -112.10627726217112, -111.58056105424961, -112.2018289466699, -7.841285760204002, -7.1649969505767075, -7.454945849875614, -2.4999668846527783, -2.0925398568312374, -1.7311840342978684, -4.513824780782073, -5.043728401263564, -4.557787676652282, 3.9653017719586643, 3.6868742456038746, 3.6998443653186115, -87.24238467713198, -98.82833143075308, -86.88913778712353, 5.967795811593533, 5.604294314980507, 5.98932646214962, -7.2154833897948265, -7.103713020682335, -7.911874741315842, -1.8030604161322117, -1.9898470118641853, -2.053951248526573, 2.669612949093178, 2.5028549109895977, 3.05780829264161, 0.09719158212342904, -0.29218946894010855, 0.7412148515383308, -107.86349931607644, -108.16595209638278, -119.32378886143367, 4.656356230378151, 4.578289493918419, 5.080517932772636, -91.32294624298811, -103.9237140417099, -93.04148826003075, -0.5848101824522018, -0.6276863366365433, -0.09493342787027359, -94.3103371411562, -96.00946000218391, -107.36377036571503, -4.436284760634109, -4.341203058759376, -4.6486475418011395, -102.10729146003723, -112.68991032242775, -103.60157811641693, 2.7200637025137695, 2.3392853339513096, 2.736219075818852, -87.7986196850737, -100.32875337203345, -88.20212357242903, 0.6329245418310165, 1.228286411613226, 1.240173077210784, -7.080034387608379, -7.7259998371203835, -7.206637074550002, -100.25180363158385, -100.39054029683273, -103.43985066811244, 1.302714159091309, 2.3492627193530353, 2.207414989670113, -8.626472905278206, -8.206722170114517, -8.631307736039162, 1.2495575994253159, 0.9533616304397583, 1.269403263926506, 5.33381640414396, 5.378017308811337, 5.665698288629443, 6.291140546401337, 6.896416903783873, 6.5473077495892795, -107.79199927051863, -117.52620822687945, -107.05488189061484, -1.6076765072842534, -1.9973634233077462, -2.351537277301162, -3.3693976302941735, -2.9259025653203423, -3.314653744300216, -0.8472870017091481, -0.9831103781859127, -1.114652539292976, -3.4465666761001046, -3.1734948505958016, -3.0807369661827977, -4.934022928277656, -4.833767356971904, -4.726881737510368, -2.849241115152836, -3.1300766319036484, -2.832884557545185, -103.61325462659201, -98.28691204388937, -97.00824139018854, -0.8614606087406571, -0.7085501452287133, -0.7564435576399262, -114.9374284942945, -100.71609964345893, -101.74262355764708, -6.0024421686927525, -5.6270407351354805, -5.793426635364696, -10.94762907922268, -11.213893495500088, -11.862261608242989, -7.190819477041572, -6.734503490229457, -6.989555900295585, -4.660393588244915, -4.724090054631233, -5.1739765256643295, -98.07324369748434, -108.19477399190268, -97.82715817292532, -15.071266420185566, -14.850875284522772, -14.965414084494114, -15.408734892805427, -14.667367371109634, -15.217734937866538, -5.031447723507881, -5.284533217549324, -4.413707103580236, -5.18918254536888, -5.3357135889430936, -5.657657740016788, -0.0264369597037728, 0.048660757640988095, -0.024592307706683414, -2.7472405582666397, -1.8465347662568092, -1.8889855295419693, -6.555436884363502, -6.549148817857116, -6.465806735058635, 4.829796130458504, 5.615975155184657, 5.64429300526777, 5.341808204849556, 6.044613947470978, 5.961638246973351, 6.414652352531746, 6.184640896817044, 5.716388558348015, 2.317594960331917, 2.65926256775856, 2.499605529010296, -99.22754612658173, -113.35524624586105, -101.31322777271271, -91.49939126769702, -100.59549550960462, -90.73637738327186, 1.759634017944336, 1.5674994140863419, 1.1200207471847534, -96.44950520495574, -97.44210247198741, -99.73587725559871, -5.326768934726715, -4.962828375399113, -5.0445317029953, -1.3633970891436036, -0.855771512787527, -1.3687749182184632, 3.9354267281790527, 3.3497811605532917, 4.101119687159851, -3.9168646732966153, -4.215990732113525, -4.694320241610214, -121.4751213391622, -105.27135435243449, -104.42668591377637, -105.05255351712307, -105.39765044053397, -116.01051135857901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1568482682906825, "mean_inference_ms": 0.656046785312582, "mean_action_processing_ms": 0.09665235235120484, "mean_env_wait_ms": 0.7912160716179412, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 187200, "timesteps_this_iter": 0, "agent_timesteps_total": 561600, "timers": {"sample_time_ms": 9454.277, "sample_throughput": 507.707, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1187.915, "learn_throughput": 4040.694, "update_time_ms": 1.2}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0052734375, "cur_lr": 0.0005, "total_loss": 281.5985336303711, "policy_loss": -0.0025503574900923587, "vf_loss": 281.6622734069824, "vf_explained_var": 0.06722738593816757, "kl": 0.023155938404675374, "entropy": 6.130313813686371, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 187200, "num_agent_steps_sampled": 561600, "num_steps_trained": 187200, "num_agent_steps_trained": 561600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1535, "training_iteration": 39, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-48-44", "timestamp": 1706147324, "time_this_iter_s": 9.263877391815186, "time_total_s": 366.90053153038025, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1A040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 366.90053153038025, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 7.461538461538461, "ram_util_percent": 45.39999999999999}}
{"episode_reward_max": 19.73486519977449, "episode_reward_min": -335.8886672630906, "episode_reward_mean": -84.31679981982553, "episode_len_mean": 250.05, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -121.4751213391622}, "policy_reward_max": {"shared_policy": 6.896416903783873}, "policy_reward_mean": {"shared_policy": -28.10559993994185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269.87254782021046, -3.721724644303322, -16.488557688891916, -32.93932695314291, -283.0713935159147, -306.26575817912817, 11.746968161314726, -318.0572899580002, -24.188196912407903, -3.140084034763291, 17.067606117576346, 15.067082535475478, -303.5405588746071, -13.32565828040245, -6.835564720910071, -17.735030688345432, -310.02087010466494, 9.018459521234021, -318.07412292063236, -335.8886672630906, -22.461228560656323, -6.323690775781884, -14.11534085869792, 11.35202038288115, -272.95985389500856, 17.56141658872366, -22.231071151793003, -5.84685867652297, 8.230276152724386, 0.5462169647216513, -335.3532402738929, 14.315163657069206, -288.28814854472876, -1.3074299469590187, -297.68356750905514, -13.426135361194625, -318.3987798988819, 7.795568112283931, -276.32949662953615, 3.1013840306550264, -22.012671299278765, -304.082194596529, 5.859391868114457, -25.464502811431885, 3.47232249379158, 16.37753200158474, 19.73486519977449, -332.3730893880129, -5.956577207893162, -9.609953939914732, -2.945049919188037, -9.700798492878704, -14.494672022759929, -8.81220230460167, -298.9084080606699, -2.3264543116092966, -317.3961516954005, -17.42290953919293, -34.023784182965755, -20.914878867566614, -14.558460168540478, -304.0951758623123, -44.88755578920245, -45.2938372017816, -14.729688044637442, -16.18255387432876, -0.002368509769468119, -6.482760854065418, -19.570392437279253, 16.09006429091093, 17.348060399293885, 18.315681807696805, 7.476463057100773, -313.8960201451555, -282.8312641605735, 4.447154179215431, -293.62748493254185, -15.334129013121128, -3.5879435201495937, 11.386327575892196, -12.827175647020354, -331.173161605373, -326.460715316236, -24.996646739542513, -7.149287268519416, 6.312466561794267, -23.78148285299541, -20.776944246143117, 13.689576152712078, -2.945519477129011, 3.6345156915485575, -332.1731483563781, -320.0007820725441, -22.938809275627165, -39.962387692183256, 8.326852604746804, 6.81779275834559, -15.961201779544368, 13.750813074409933, 0.03936620056629181], "episode_lengths": [113, 300, 300, 300, 82, 66, 300, 180, 300, 300, 300, 300, 105, 300, 300, 300, 56, 300, 66, 173, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 227, 300, 79, 300, 62, 300, 58, 300, 87, 300, 300, 81, 300, 300, 300, 300, 300, 199, 300, 300, 300, 300, 300, 300, 47, 300, 51, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 53, 144, 300, 48, 300, 300, 300, 300, 49, 294, 300, 300, 300, 300, 300, 300, 300, 300, 217, 60, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-86.62196131547293, -96.70336784919104, -86.54721865554652, -1.03119695186615, -1.307543084025383, -1.382984608411789, -5.44571175177893, -5.7159847666819985, -5.326861170430988, -11.254178379972785, -10.974221323927253, -10.710927249242872, -97.01074757178625, -93.01309042175612, -93.04755552237233, -98.0081518292427, -110.4670860171318, -97.79052033275366, 4.079342316836119, 3.9191215857863426, 3.7485042586922646, -102.1889434059461, -103.33399348457655, -112.53435306747755, -8.010469821592181, -8.211563711365073, -7.966163379450649, -1.1263744483391491, -1.2604928712050167, -0.7532167152191249, 5.172897373636559, 5.880786274870232, 6.013922469069556, 5.105865673472479, 4.891921934982136, 5.069294927020863, -97.25592888394992, -98.1630121866862, -108.12161780397098, -4.350125667949527, -4.870648299654334, -4.104884312798589, -2.708816771705955, -2.2767710511883195, -1.8499768980157967, -5.789602510631084, -5.891737714409828, -6.05369046330452, -113.97173289457957, -99.12849355737369, -96.92064365271169, 3.013859843214348, 2.7554161896308216, 3.2491834883888515, -114.11329513788223, -102.50727808475494, -101.45354969799519, -112.10627726217112, -111.58056105424961, -112.2018289466699, -7.841285760204002, -7.1649969505767075, -7.454945849875614, -2.4999668846527783, -2.0925398568312374, -1.7311840342978684, -4.513824780782073, -5.043728401263564, -4.557787676652282, 3.9653017719586643, 3.6868742456038746, 3.6998443653186115, -87.24238467713198, -98.82833143075308, -86.88913778712353, 5.967795811593533, 5.604294314980507, 5.98932646214962, -7.2154833897948265, -7.103713020682335, -7.911874741315842, -1.8030604161322117, -1.9898470118641853, -2.053951248526573, 2.669612949093178, 2.5028549109895977, 3.05780829264161, 0.09719158212342904, -0.29218946894010855, 0.7412148515383308, -107.86349931607644, -108.16595209638278, -119.32378886143367, 4.656356230378151, 4.578289493918419, 5.080517932772636, -91.32294624298811, -103.9237140417099, -93.04148826003075, -0.5848101824522018, -0.6276863366365433, -0.09493342787027359, -94.3103371411562, -96.00946000218391, -107.36377036571503, -4.436284760634109, -4.341203058759376, -4.6486475418011395, -102.10729146003723, -112.68991032242775, -103.60157811641693, 2.7200637025137695, 2.3392853339513096, 2.736219075818852, -87.7986196850737, -100.32875337203345, -88.20212357242903, 0.6329245418310165, 1.228286411613226, 1.240173077210784, -7.080034387608379, -7.7259998371203835, -7.206637074550002, -100.25180363158385, -100.39054029683273, -103.43985066811244, 1.302714159091309, 2.3492627193530353, 2.207414989670113, -8.626472905278206, -8.206722170114517, -8.631307736039162, 1.2495575994253159, 0.9533616304397583, 1.269403263926506, 5.33381640414396, 5.378017308811337, 5.665698288629443, 6.291140546401337, 6.896416903783873, 6.5473077495892795, -107.79199927051863, -117.52620822687945, -107.05488189061484, -1.6076765072842534, -1.9973634233077462, -2.351537277301162, -3.3693976302941735, -2.9259025653203423, -3.314653744300216, -0.8472870017091481, -0.9831103781859127, -1.114652539292976, -3.4465666761001046, -3.1734948505958016, -3.0807369661827977, -4.934022928277656, -4.833767356971904, -4.726881737510368, -2.849241115152836, -3.1300766319036484, -2.832884557545185, -103.61325462659201, -98.28691204388937, -97.00824139018854, -0.8614606087406571, -0.7085501452287133, -0.7564435576399262, -114.9374284942945, -100.71609964345893, -101.74262355764708, -6.0024421686927525, -5.6270407351354805, -5.793426635364696, -10.94762907922268, -11.213893495500088, -11.862261608242989, -7.190819477041572, -6.734503490229457, -6.989555900295585, -4.660393588244915, -4.724090054631233, -5.1739765256643295, -98.07324369748434, -108.19477399190268, -97.82715817292532, -15.071266420185566, -14.850875284522772, -14.965414084494114, -15.408734892805427, -14.667367371109634, -15.217734937866538, -5.031447723507881, -5.284533217549324, -4.413707103580236, -5.18918254536888, -5.3357135889430936, -5.657657740016788, -0.0264369597037728, 0.048660757640988095, -0.024592307706683414, -2.7472405582666397, -1.8465347662568092, -1.8889855295419693, -6.555436884363502, -6.549148817857116, -6.465806735058635, 4.829796130458504, 5.615975155184657, 5.64429300526777, 5.341808204849556, 6.044613947470978, 5.961638246973351, 6.414652352531746, 6.184640896817044, 5.716388558348015, 2.317594960331917, 2.65926256775856, 2.499605529010296, -99.22754612658173, -113.35524624586105, -101.31322777271271, -91.49939126769702, -100.59549550960462, -90.73637738327186, 1.759634017944336, 1.5674994140863419, 1.1200207471847534, -96.44950520495574, -97.44210247198741, -99.73587725559871, -5.326768934726715, -4.962828375399113, -5.0445317029953, -1.3633970891436036, -0.855771512787527, -1.3687749182184632, 3.9354267281790527, 3.3497811605532917, 4.101119687159851, -3.9168646732966153, -4.215990732113525, -4.694320241610214, -121.4751213391622, -105.27135435243449, -104.42668591377637, -105.05255351712307, -105.39765044053397, -116.01051135857901, -8.450916280349105, -8.049259615441173, -8.496470843752235, -2.621770436565086, -2.2754425282279698, -2.25207430372636, 2.2239371885855945, 1.985513915618256, 2.1030154575904163, -8.014068211118385, -8.214492479960128, -7.5529221619168965, -6.849578554431602, -6.572639486442014, -7.3547262052695, 4.55290653059879, 4.488696644703538, 4.647972977409751, -1.3494324733813698, -0.656615277131408, -0.9394717266162331, 0.8561918536821906, 1.467325056592614, 1.310998781273753, -110.49375023382406, -110.60834703656535, -111.07105108598869, -117.12317518393199, -101.46271220842998, -101.41489468018214, -7.640590031941741, -7.63594098140797, -7.662278262277454, -13.460223659873009, -12.99948912486434, -13.502674907445908, 3.27449271579583, 2.73276688655217, 2.319593002398804, 2.484994155665234, 2.095918839176491, 2.2368797635038646, -5.609097416202232, -5.15027453253667, -5.201829830805465, 4.745880002776772, 4.271493638555199, 4.733439433077962, 0.09686674177646637, -0.061784692108631134, 0.0042841508984565735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15649260916931104, "mean_inference_ms": 0.6556926809065066, "mean_action_processing_ms": 0.09662407931423811, "mean_env_wait_ms": 0.7912505783723565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 9457.234, "sample_throughput": 507.548, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1182.421, "learn_throughput": 4059.468, "update_time_ms": 1.2}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 129.618426322937, "policy_loss": -0.0030551298839984198, "vf_loss": 129.6856803894043, "vf_explained_var": -0.00984548032283783, "kl": 0.011413407039077273, "entropy": 6.428333222866058, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 576000, "num_steps_trained": 192000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1552, "training_iteration": 40, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-48-53", "timestamp": 1706147333, "time_this_iter_s": 9.167788028717041, "time_total_s": 376.0683195590973, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021063335700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 376.0683195590973, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 9.907692307692306, "ram_util_percent": 45.55384615384616}}
{"episode_reward_max": 22.662212170660496, "episode_reward_min": -335.8886672630906, "episode_reward_mean": -70.04280282920678, "episode_len_mean": 260.21, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -121.4751213391622}, "policy_reward_max": {"shared_policy": 7.969671286642551}, "policy_reward_mean": {"shared_policy": -23.34760094306893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.018459521234021, -318.07412292063236, -335.8886672630906, -22.461228560656323, -6.323690775781884, -14.11534085869792, 11.35202038288115, -272.95985389500856, 17.56141658872366, -22.231071151793003, -5.84685867652297, 8.230276152724386, 0.5462169647216513, -335.3532402738929, 14.315163657069206, -288.28814854472876, -1.3074299469590187, -297.68356750905514, -13.426135361194625, -318.3987798988819, 7.795568112283931, -276.32949662953615, 3.1013840306550264, -22.012671299278765, -304.082194596529, 5.859391868114457, -25.464502811431885, 3.47232249379158, 16.37753200158474, 19.73486519977449, -332.3730893880129, -5.956577207893162, -9.609953939914732, -2.945049919188037, -9.700798492878704, -14.494672022759929, -8.81220230460167, -298.9084080606699, -2.3264543116092966, -317.3961516954005, -17.42290953919293, -34.023784182965755, -20.914878867566614, -14.558460168540478, -304.0951758623123, -44.88755578920245, -45.2938372017816, -14.729688044637442, -16.18255387432876, -0.002368509769468119, -6.482760854065418, -19.570392437279253, 16.09006429091093, 17.348060399293885, 18.315681807696805, 7.476463057100773, -313.8960201451555, -282.8312641605735, 4.447154179215431, -293.62748493254185, -15.334129013121128, -3.5879435201495937, 11.386327575892196, -12.827175647020354, -331.173161605373, -326.460715316236, -24.996646739542513, -7.149287268519416, 6.312466561794267, -23.78148285299541, -20.776944246143117, 13.689576152712078, -2.945519477129011, 3.6345156915485575, -332.1731483563781, -320.0007820725441, -22.938809275627165, -39.962387692183256, 8.326852604746804, 6.81779275834559, -15.961201779544368, 13.750813074409933, 0.03936620056629181, -37.2696715705097, -14.636737923137844, -17.68877686187625, 14.753027055412531, 5.729821756482124, -46.70696493238212, -15.6228612214327, -297.59542621299624, -0.8173633962869928, -33.99734141677618, 22.662212170660496, 11.266141317784758, -10.968130227178364, 1.673632256686659, 19.367096595466123, -38.20904584228994, 0.1391819529235221], "episode_lengths": [300, 66, 173, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 227, 300, 79, 300, 62, 300, 58, 300, 87, 300, 300, 81, 300, 300, 300, 300, 300, 199, 300, 300, 300, 300, 300, 300, 47, 300, 51, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 53, 144, 300, 48, 300, 300, 300, 300, 49, 294, 300, 300, 300, 300, 300, 300, 300, 300, 217, 60, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.013859843214348, 2.7554161896308216, 3.2491834883888515, -114.11329513788223, -102.50727808475494, -101.45354969799519, -112.10627726217112, -111.58056105424961, -112.2018289466699, -7.841285760204002, -7.1649969505767075, -7.454945849875614, -2.4999668846527783, -2.0925398568312374, -1.7311840342978684, -4.513824780782073, -5.043728401263564, -4.557787676652282, 3.9653017719586643, 3.6868742456038746, 3.6998443653186115, -87.24238467713198, -98.82833143075308, -86.88913778712353, 5.967795811593533, 5.604294314980507, 5.98932646214962, -7.2154833897948265, -7.103713020682335, -7.911874741315842, -1.8030604161322117, -1.9898470118641853, -2.053951248526573, 2.669612949093178, 2.5028549109895977, 3.05780829264161, 0.09719158212342904, -0.29218946894010855, 0.7412148515383308, -107.86349931607644, -108.16595209638278, -119.32378886143367, 4.656356230378151, 4.578289493918419, 5.080517932772636, -91.32294624298811, -103.9237140417099, -93.04148826003075, -0.5848101824522018, -0.6276863366365433, -0.09493342787027359, -94.3103371411562, -96.00946000218391, -107.36377036571503, -4.436284760634109, -4.341203058759376, -4.6486475418011395, -102.10729146003723, -112.68991032242775, -103.60157811641693, 2.7200637025137695, 2.3392853339513096, 2.736219075818852, -87.7986196850737, -100.32875337203345, -88.20212357242903, 0.6329245418310165, 1.228286411613226, 1.240173077210784, -7.080034387608379, -7.7259998371203835, -7.206637074550002, -100.25180363158385, -100.39054029683273, -103.43985066811244, 1.302714159091309, 2.3492627193530353, 2.207414989670113, -8.626472905278206, -8.206722170114517, -8.631307736039162, 1.2495575994253159, 0.9533616304397583, 1.269403263926506, 5.33381640414396, 5.378017308811337, 5.665698288629443, 6.291140546401337, 6.896416903783873, 6.5473077495892795, -107.79199927051863, -117.52620822687945, -107.05488189061484, -1.6076765072842534, -1.9973634233077462, -2.351537277301162, -3.3693976302941735, -2.9259025653203423, -3.314653744300216, -0.8472870017091481, -0.9831103781859127, -1.114652539292976, -3.4465666761001046, -3.1734948505958016, -3.0807369661827977, -4.934022928277656, -4.833767356971904, -4.726881737510368, -2.849241115152836, -3.1300766319036484, -2.832884557545185, -103.61325462659201, -98.28691204388937, -97.00824139018854, -0.8614606087406571, -0.7085501452287133, -0.7564435576399262, -114.9374284942945, -100.71609964345893, -101.74262355764708, -6.0024421686927525, -5.6270407351354805, -5.793426635364696, -10.94762907922268, -11.213893495500088, -11.862261608242989, -7.190819477041572, -6.734503490229457, -6.989555900295585, -4.660393588244915, -4.724090054631233, -5.1739765256643295, -98.07324369748434, -108.19477399190268, -97.82715817292532, -15.071266420185566, -14.850875284522772, -14.965414084494114, -15.408734892805427, -14.667367371109634, -15.217734937866538, -5.031447723507881, -5.284533217549324, -4.413707103580236, -5.18918254536888, -5.3357135889430936, -5.657657740016788, -0.0264369597037728, 0.048660757640988095, -0.024592307706683414, -2.7472405582666397, -1.8465347662568092, -1.8889855295419693, -6.555436884363502, -6.549148817857116, -6.465806735058635, 4.829796130458504, 5.615975155184657, 5.64429300526777, 5.341808204849556, 6.044613947470978, 5.961638246973351, 6.414652352531746, 6.184640896817044, 5.716388558348015, 2.317594960331917, 2.65926256775856, 2.499605529010296, -99.22754612658173, -113.35524624586105, -101.31322777271271, -91.49939126769702, -100.59549550960462, -90.73637738327186, 1.759634017944336, 1.5674994140863419, 1.1200207471847534, -96.44950520495574, -97.44210247198741, -99.73587725559871, -5.326768934726715, -4.962828375399113, -5.0445317029953, -1.3633970891436036, -0.855771512787527, -1.3687749182184632, 3.9354267281790527, 3.3497811605532917, 4.101119687159851, -3.9168646732966153, -4.215990732113525, -4.694320241610214, -121.4751213391622, -105.27135435243449, -104.42668591377637, -105.05255351712307, -105.39765044053397, -116.01051135857901, -8.450916280349105, -8.049259615441173, -8.496470843752235, -2.621770436565086, -2.2754425282279698, -2.25207430372636, 2.2239371885855945, 1.985513915618256, 2.1030154575904163, -8.014068211118385, -8.214492479960128, -7.5529221619168965, -6.849578554431602, -6.572639486442014, -7.3547262052695, 4.55290653059879, 4.488696644703538, 4.647972977409751, -1.3494324733813698, -0.656615277131408, -0.9394717266162331, 0.8561918536821906, 1.467325056592614, 1.310998781273753, -110.49375023382406, -110.60834703656535, -111.07105108598869, -117.12317518393199, -101.46271220842998, -101.41489468018214, -7.640590031941741, -7.63594098140797, -7.662278262277454, -13.460223659873009, -12.99948912486434, -13.502674907445908, 3.27449271579583, 2.73276688655217, 2.319593002398804, 2.484994155665234, 2.095918839176491, 2.2368797635038646, -5.609097416202232, -5.15027453253667, -5.201829830805465, 4.745880002776772, 4.271493638555199, 4.733439433077962, 0.09686674177646637, -0.061784692108631134, 0.0042841508984565735, -12.397588041921466, -12.301680610825628, -12.570402917762607, -4.92665808647871, -5.2899715304374695, -4.420108306221664, -5.8435440473258495, -5.888998493552208, -5.956234320998192, 4.731288328766823, 5.1680864207446575, 4.853652305901051, 2.0872747227549553, 1.7429393231868744, 1.8996077105402946, -15.226891400913402, -15.499840105573341, -15.980233425895378, -5.2346038768688885, -5.172631176809475, -5.215626167754337, -95.1755105132858, -107.39780513445537, -95.02211056525509, -0.04043797155222251, -0.2632511605819161, -0.5136742641528542, -11.07277300953865, -11.295526929199696, -11.629041478037834, 7.906713396310806, 7.969671286642551, 6.785827487707138, 3.8863750944534843, 3.828588950137288, 3.5511772731939857, -3.502368578066438, -3.8247018729647095, -3.641059776147216, 0.9491415793696945, 0.42726093033948587, 0.2972297469774787, 6.49162160356839, 6.445082222421959, 6.430392769475773, -12.660396600763008, -12.598914037148162, -12.949735204378769, -0.4188681195179669, 0.19732678433258855, 0.3607232881089004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15613562218884783, "mean_inference_ms": 0.6552747100522934, "mean_action_processing_ms": 0.09657086867644014, "mean_env_wait_ms": 0.7912722857328444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 196800, "timesteps_this_iter": 0, "agent_timesteps_total": 590400, "timers": {"sample_time_ms": 9402.525, "sample_throughput": 510.501, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1180.602, "learn_throughput": 4065.724, "update_time_ms": 1.299}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 40.96169567108154, "policy_loss": -0.003213468812448106, "vf_loss": 41.03052997589111, "vf_explained_var": -1.0, "kl": 0.009855120271828175, "entropy": 6.569738268852234, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 196800, "num_agent_steps_sampled": 590400, "num_steps_trained": 196800, "num_agent_steps_trained": 590400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1569, "training_iteration": 41, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-49-02", "timestamp": 1706147342, "time_this_iter_s": 9.103570461273193, "time_total_s": 385.1718900203705, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050CAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 385.1718900203705, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 7.176923076923078, "ram_util_percent": 45.39999999999999}}
{"episode_reward_max": 22.662212170660496, "episode_reward_min": -341.0641849637032, "episode_reward_mean": -60.707758951491996, "episode_len_mean": 267.33, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -121.4751213391622}, "policy_reward_max": {"shared_policy": 7.969671286642551}, "policy_reward_mean": {"shared_policy": -20.235919650497337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.3074299469590187, -297.68356750905514, -13.426135361194625, -318.3987798988819, 7.795568112283931, -276.32949662953615, 3.1013840306550264, -22.012671299278765, -304.082194596529, 5.859391868114457, -25.464502811431885, 3.47232249379158, 16.37753200158474, 19.73486519977449, -332.3730893880129, -5.956577207893162, -9.609953939914732, -2.945049919188037, -9.700798492878704, -14.494672022759929, -8.81220230460167, -298.9084080606699, -2.3264543116092966, -317.3961516954005, -17.42290953919293, -34.023784182965755, -20.914878867566614, -14.558460168540478, -304.0951758623123, -44.88755578920245, -45.2938372017816, -14.729688044637442, -16.18255387432876, -0.002368509769468119, -6.482760854065418, -19.570392437279253, 16.09006429091093, 17.348060399293885, 18.315681807696805, 7.476463057100773, -313.8960201451555, -282.8312641605735, 4.447154179215431, -293.62748493254185, -15.334129013121128, -3.5879435201495937, 11.386327575892196, -12.827175647020354, -331.173161605373, -326.460715316236, -24.996646739542513, -7.149287268519416, 6.312466561794267, -23.78148285299541, -20.776944246143117, 13.689576152712078, -2.945519477129011, 3.6345156915485575, -332.1731483563781, -320.0007820725441, -22.938809275627165, -39.962387692183256, 8.326852604746804, 6.81779275834559, -15.961201779544368, 13.750813074409933, 0.03936620056629181, -37.2696715705097, -14.636737923137844, -17.68877686187625, 14.753027055412531, 5.729821756482124, -46.70696493238212, -15.6228612214327, -297.59542621299624, -0.8173633962869928, -33.99734141677618, 22.662212170660496, 11.266141317784758, -10.968130227178364, 1.673632256686659, 19.367096595466123, -38.20904584228994, 0.1391819529235221, 5.702617645263672, -26.489782415330424, -22.84362212195994, -8.738944483920946, 10.213568456470938, -37.767111577093615, -85.60104424506437, -341.0641849637032, -12.01652805507183, -31.11150977015498, 11.448760323226438, -44.75514840334655, -9.830900102853803, 0.5016805045306683, -12.955882797017722, -21.706249875947847], "episode_lengths": [300, 62, 300, 58, 300, 87, 300, 300, 81, 300, 300, 300, 300, 300, 199, 300, 300, 300, 300, 300, 300, 47, 300, 51, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 53, 144, 300, 48, 300, 300, 300, 300, 49, 294, 300, 300, 300, 300, 300, 300, 300, 300, 217, 60, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 147, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-0.5848101824522018, -0.6276863366365433, -0.09493342787027359, -94.3103371411562, -96.00946000218391, -107.36377036571503, -4.436284760634109, -4.341203058759376, -4.6486475418011395, -102.10729146003723, -112.68991032242775, -103.60157811641693, 2.7200637025137695, 2.3392853339513096, 2.736219075818852, -87.7986196850737, -100.32875337203345, -88.20212357242903, 0.6329245418310165, 1.228286411613226, 1.240173077210784, -7.080034387608379, -7.7259998371203835, -7.206637074550002, -100.25180363158385, -100.39054029683273, -103.43985066811244, 1.302714159091309, 2.3492627193530353, 2.207414989670113, -8.626472905278206, -8.206722170114517, -8.631307736039162, 1.2495575994253159, 0.9533616304397583, 1.269403263926506, 5.33381640414396, 5.378017308811337, 5.665698288629443, 6.291140546401337, 6.896416903783873, 6.5473077495892795, -107.79199927051863, -117.52620822687945, -107.05488189061484, -1.6076765072842534, -1.9973634233077462, -2.351537277301162, -3.3693976302941735, -2.9259025653203423, -3.314653744300216, -0.8472870017091481, -0.9831103781859127, -1.114652539292976, -3.4465666761001046, -3.1734948505958016, -3.0807369661827977, -4.934022928277656, -4.833767356971904, -4.726881737510368, -2.849241115152836, -3.1300766319036484, -2.832884557545185, -103.61325462659201, -98.28691204388937, -97.00824139018854, -0.8614606087406571, -0.7085501452287133, -0.7564435576399262, -114.9374284942945, -100.71609964345893, -101.74262355764708, -6.0024421686927525, -5.6270407351354805, -5.793426635364696, -10.94762907922268, -11.213893495500088, -11.862261608242989, -7.190819477041572, -6.734503490229457, -6.989555900295585, -4.660393588244915, -4.724090054631233, -5.1739765256643295, -98.07324369748434, -108.19477399190268, -97.82715817292532, -15.071266420185566, -14.850875284522772, -14.965414084494114, -15.408734892805427, -14.667367371109634, -15.217734937866538, -5.031447723507881, -5.284533217549324, -4.413707103580236, -5.18918254536888, -5.3357135889430936, -5.657657740016788, -0.0264369597037728, 0.048660757640988095, -0.024592307706683414, -2.7472405582666397, -1.8465347662568092, -1.8889855295419693, -6.555436884363502, -6.549148817857116, -6.465806735058635, 4.829796130458504, 5.615975155184657, 5.64429300526777, 5.341808204849556, 6.044613947470978, 5.961638246973351, 6.414652352531746, 6.184640896817044, 5.716388558348015, 2.317594960331917, 2.65926256775856, 2.499605529010296, -99.22754612658173, -113.35524624586105, -101.31322777271271, -91.49939126769702, -100.59549550960462, -90.73637738327186, 1.759634017944336, 1.5674994140863419, 1.1200207471847534, -96.44950520495574, -97.44210247198741, -99.73587725559871, -5.326768934726715, -4.962828375399113, -5.0445317029953, -1.3633970891436036, -0.855771512787527, -1.3687749182184632, 3.9354267281790527, 3.3497811605532917, 4.101119687159851, -3.9168646732966153, -4.215990732113525, -4.694320241610214, -121.4751213391622, -105.27135435243449, -104.42668591377637, -105.05255351712307, -105.39765044053397, -116.01051135857901, -8.450916280349105, -8.049259615441173, -8.496470843752235, -2.621770436565086, -2.2754425282279698, -2.25207430372636, 2.2239371885855945, 1.985513915618256, 2.1030154575904163, -8.014068211118385, -8.214492479960128, -7.5529221619168965, -6.849578554431602, -6.572639486442014, -7.3547262052695, 4.55290653059879, 4.488696644703538, 4.647972977409751, -1.3494324733813698, -0.656615277131408, -0.9394717266162331, 0.8561918536821906, 1.467325056592614, 1.310998781273753, -110.49375023382406, -110.60834703656535, -111.07105108598869, -117.12317518393199, -101.46271220842998, -101.41489468018214, -7.640590031941741, -7.63594098140797, -7.662278262277454, -13.460223659873009, -12.99948912486434, -13.502674907445908, 3.27449271579583, 2.73276688655217, 2.319593002398804, 2.484994155665234, 2.095918839176491, 2.2368797635038646, -5.609097416202232, -5.15027453253667, -5.201829830805465, 4.745880002776772, 4.271493638555199, 4.733439433077962, 0.09686674177646637, -0.061784692108631134, 0.0042841508984565735, -12.397588041921466, -12.301680610825628, -12.570402917762607, -4.92665808647871, -5.2899715304374695, -4.420108306221664, -5.8435440473258495, -5.888998493552208, -5.956234320998192, 4.731288328766823, 5.1680864207446575, 4.853652305901051, 2.0872747227549553, 1.7429393231868744, 1.8996077105402946, -15.226891400913402, -15.499840105573341, -15.980233425895378, -5.2346038768688885, -5.172631176809475, -5.215626167754337, -95.1755105132858, -107.39780513445537, -95.02211056525509, -0.04043797155222251, -0.2632511605819161, -0.5136742641528542, -11.07277300953865, -11.295526929199696, -11.629041478037834, 7.906713396310806, 7.969671286642551, 6.785827487707138, 3.8863750944534843, 3.828588950137288, 3.5511772731939857, -3.502368578066438, -3.8247018729647095, -3.641059776147216, 0.9491415793696945, 0.42726093033948587, 0.2972297469774787, 6.49162160356839, 6.445082222421959, 6.430392769475773, -12.660396600763008, -12.598914037148162, -12.949735204378769, -0.4188681195179669, 0.19732678433258855, 0.3607232881089004, 1.835866704583168, 1.9662873297929764, 1.9004636108875275, -8.745855989555523, -8.558715100089714, -9.185211325685188, -7.447676150749132, -7.528242389361068, -7.867703581849739, -3.0189289400974957, -2.592021428669497, -3.127994115153953, 3.3042338068286483, 3.23200489828983, 3.6773297513524597, -12.67877706388633, -12.629089141885444, -12.459245371321842, -28.376209085186325, -28.30908594777187, -28.91574921210607, -110.72540508707365, -120.40706830223402, -109.93171157439551, -3.8060676530003548, -3.835826314985752, -4.374634087085724, -10.078987357517093, -10.19562224795422, -10.83690016468367, 3.4955268700917514, 4.11754648884137, 3.8356869642933162, -14.770713547865554, -15.064408580462143, -14.920026275018856, -3.24060379465422, -3.4047286858161385, -3.185567622383445, -0.39509832859039307, 0.2637212723493576, 0.6330575607717037, -4.290839587648719, -3.7001004957904513, -4.9649427135785515, -6.846881587679192, -6.947483359525606, -7.911884928743049]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1558168776622493, "mean_inference_ms": 0.6549125914876848, "mean_action_processing_ms": 0.0965037230486529, "mean_env_wait_ms": 0.791331867995375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 201600, "timesteps_this_iter": 0, "agent_timesteps_total": 604800, "timers": {"sample_time_ms": 9350.282, "sample_throughput": 513.353, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1182.002, "learn_throughput": 4060.908, "update_time_ms": 1.399}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 125.61250591278076, "policy_loss": -0.0020052177571859703, "vf_loss": 125.68146800994873, "vf_explained_var": -0.10356025397777557, "kl": 0.009065410336921494, "entropy": 6.703785598278046, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 201600, "num_agent_steps_sampled": 604800, "num_steps_trained": 201600, "num_agent_steps_trained": 604800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1585, "training_iteration": 42, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-49-12", "timestamp": 1706147352, "time_this_iter_s": 9.352669954299927, "time_total_s": 394.5245599746704, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C22AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 394.5245599746704, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 7.453846153846154, "ram_util_percent": 45.53846153846154}}
{"episode_reward_max": 32.46172852814196, "episode_reward_min": -341.0641849637032, "episode_reward_mean": -60.82906810849192, "episode_len_mean": 266.87, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": -121.4751213391622}, "policy_reward_max": {"shared_policy": 10.900682819386319}, "policy_reward_mean": {"shared_policy": -20.27635603616398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.81220230460167, -298.9084080606699, -2.3264543116092966, -317.3961516954005, -17.42290953919293, -34.023784182965755, -20.914878867566614, -14.558460168540478, -304.0951758623123, -44.88755578920245, -45.2938372017816, -14.729688044637442, -16.18255387432876, -0.002368509769468119, -6.482760854065418, -19.570392437279253, 16.09006429091093, 17.348060399293885, 18.315681807696805, 7.476463057100773, -313.8960201451555, -282.8312641605735, 4.447154179215431, -293.62748493254185, -15.334129013121128, -3.5879435201495937, 11.386327575892196, -12.827175647020354, -331.173161605373, -326.460715316236, -24.996646739542513, -7.149287268519416, 6.312466561794267, -23.78148285299541, -20.776944246143117, 13.689576152712078, -2.945519477129011, 3.6345156915485575, -332.1731483563781, -320.0007820725441, -22.938809275627165, -39.962387692183256, 8.326852604746804, 6.81779275834559, -15.961201779544368, 13.750813074409933, 0.03936620056629181, -37.2696715705097, -14.636737923137844, -17.68877686187625, 14.753027055412531, 5.729821756482124, -46.70696493238212, -15.6228612214327, -297.59542621299624, -0.8173633962869928, -33.99734141677618, 22.662212170660496, 11.266141317784758, -10.968130227178364, 1.673632256686659, 19.367096595466123, -38.20904584228994, 0.1391819529235221, 5.702617645263672, -26.489782415330424, -22.84362212195994, -8.738944483920946, 10.213568456470938, -37.767111577093615, -85.60104424506437, -341.0641849637032, -12.01652805507183, -31.11150977015498, 11.448760323226438, -44.75514840334655, -9.830900102853803, 0.5016805045306683, -12.955882797017722, -21.706249875947847, 32.46172852814196, -317.07296124845743, -276.56639437377453, -2.262858979404001, -306.2779226601124, 6.24598245508966, -297.1856059134007, -29.99916002526882, 8.037887498736367, -2.153140148613602, 8.960574120283113, -8.7433611750603, 12.537562958896146, -286.18365367501974, 20.764791570603833, -5.671174623072147, -77.74483155459168, -1.681039422750473, -24.99142336845398, -42.049770981073394], "episode_lengths": [300, 47, 300, 51, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 53, 144, 300, 48, 300, 300, 300, 300, 49, 294, 300, 300, 300, 300, 300, 300, 300, 300, 217, 60, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 147, 300, 300, 300, 300, 300, 300, 300, 300, 300, 59, 112, 300, 70, 300, 76, 300, 300, 300, 300, 300, 300, 124, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-2.849241115152836, -3.1300766319036484, -2.832884557545185, -103.61325462659201, -98.28691204388937, -97.00824139018854, -0.8614606087406571, -0.7085501452287133, -0.7564435576399262, -114.9374284942945, -100.71609964345893, -101.74262355764708, -6.0024421686927525, -5.6270407351354805, -5.793426635364696, -10.94762907922268, -11.213893495500088, -11.862261608242989, -7.190819477041572, -6.734503490229457, -6.989555900295585, -4.660393588244915, -4.724090054631233, -5.1739765256643295, -98.07324369748434, -108.19477399190268, -97.82715817292532, -15.071266420185566, -14.850875284522772, -14.965414084494114, -15.408734892805427, -14.667367371109634, -15.217734937866538, -5.031447723507881, -5.284533217549324, -4.413707103580236, -5.18918254536888, -5.3357135889430936, -5.657657740016788, -0.0264369597037728, 0.048660757640988095, -0.024592307706683414, -2.7472405582666397, -1.8465347662568092, -1.8889855295419693, -6.555436884363502, -6.549148817857116, -6.465806735058635, 4.829796130458504, 5.615975155184657, 5.64429300526777, 5.341808204849556, 6.044613947470978, 5.961638246973351, 6.414652352531746, 6.184640896817044, 5.716388558348015, 2.317594960331917, 2.65926256775856, 2.499605529010296, -99.22754612658173, -113.35524624586105, -101.31322777271271, -91.49939126769702, -100.59549550960462, -90.73637738327186, 1.759634017944336, 1.5674994140863419, 1.1200207471847534, -96.44950520495574, -97.44210247198741, -99.73587725559871, -5.326768934726715, -4.962828375399113, -5.0445317029953, -1.3633970891436036, -0.855771512787527, -1.3687749182184632, 3.9354267281790527, 3.3497811605532917, 4.101119687159851, -3.9168646732966153, -4.215990732113525, -4.694320241610214, -121.4751213391622, -105.27135435243449, -104.42668591377637, -105.05255351712307, -105.39765044053397, -116.01051135857901, -8.450916280349105, -8.049259615441173, -8.496470843752235, -2.621770436565086, -2.2754425282279698, -2.25207430372636, 2.2239371885855945, 1.985513915618256, 2.1030154575904163, -8.014068211118385, -8.214492479960128, -7.5529221619168965, -6.849578554431602, -6.572639486442014, -7.3547262052695, 4.55290653059879, 4.488696644703538, 4.647972977409751, -1.3494324733813698, -0.656615277131408, -0.9394717266162331, 0.8561918536821906, 1.467325056592614, 1.310998781273753, -110.49375023382406, -110.60834703656535, -111.07105108598869, -117.12317518393199, -101.46271220842998, -101.41489468018214, -7.640590031941741, -7.63594098140797, -7.662278262277454, -13.460223659873009, -12.99948912486434, -13.502674907445908, 3.27449271579583, 2.73276688655217, 2.319593002398804, 2.484994155665234, 2.095918839176491, 2.2368797635038646, -5.609097416202232, -5.15027453253667, -5.201829830805465, 4.745880002776772, 4.271493638555199, 4.733439433077962, 0.09686674177646637, -0.061784692108631134, 0.0042841508984565735, -12.397588041921466, -12.301680610825628, -12.570402917762607, -4.92665808647871, -5.2899715304374695, -4.420108306221664, -5.8435440473258495, -5.888998493552208, -5.956234320998192, 4.731288328766823, 5.1680864207446575, 4.853652305901051, 2.0872747227549553, 1.7429393231868744, 1.8996077105402946, -15.226891400913402, -15.499840105573341, -15.980233425895378, -5.2346038768688885, -5.172631176809475, -5.215626167754337, -95.1755105132858, -107.39780513445537, -95.02211056525509, -0.04043797155222251, -0.2632511605819161, -0.5136742641528542, -11.07277300953865, -11.295526929199696, -11.629041478037834, 7.906713396310806, 7.969671286642551, 6.785827487707138, 3.8863750944534843, 3.828588950137288, 3.5511772731939857, -3.502368578066438, -3.8247018729647095, -3.641059776147216, 0.9491415793696945, 0.42726093033948587, 0.2972297469774787, 6.49162160356839, 6.445082222421959, 6.430392769475773, -12.660396600763008, -12.598914037148162, -12.949735204378769, -0.4188681195179669, 0.19732678433258855, 0.3607232881089004, 1.835866704583168, 1.9662873297929764, 1.9004636108875275, -8.745855989555523, -8.558715100089714, -9.185211325685188, -7.447676150749132, -7.528242389361068, -7.867703581849739, -3.0189289400974957, -2.592021428669497, -3.127994115153953, 3.3042338068286483, 3.23200489828983, 3.6773297513524597, -12.67877706388633, -12.629089141885444, -12.459245371321842, -28.376209085186325, -28.30908594777187, -28.91574921210607, -110.72540508707365, -120.40706830223402, -109.93171157439551, -3.8060676530003548, -3.835826314985752, -4.374634087085724, -10.078987357517093, -10.19562224795422, -10.83690016468367, 3.4955268700917514, 4.11754648884137, 3.8356869642933162, -14.770713547865554, -15.064408580462143, -14.920026275018856, -3.24060379465422, -3.4047286858161385, -3.185567622383445, -0.39509832859039307, 0.2637212723493576, 0.6330575607717037, -4.290839587648719, -3.7001004957904513, -4.9649427135785515, -6.846881587679192, -6.947483359525606, -7.911884928743049, 10.76024019469817, 10.900682819386319, 10.800805514057473, -114.65482280651729, -100.40335391710202, -102.01478452483813, -95.35955153157315, -95.39737961937985, -85.80946322282156, -0.7868305121859009, -0.94916454454264, -0.5268639226754601, -100.66422545909882, -101.80755683779716, -103.8061403632164, 2.3274382247278993, 2.0164765367905204, 1.9020676935712402, -106.45661880572638, -94.11635970075926, -96.61262740691504, -10.098596011598914, -10.007892382641643, -9.892671631028264, 2.544285004337624, 2.8169019718964847, 2.6767005225022587, -0.7915039882063866, -0.9102388247847557, -0.45139733562245965, 2.9784502213199886, 3.0071715017159732, 2.9749523972471508, -2.8602207501729424, -3.040132080515235, -2.843008344372123, 4.306592990954712, 4.237638575335339, 3.9933313926060947, -91.47906644145648, -103.60534278551738, -91.0992444480459, 7.278953832884625, 6.59432717164357, 6.891510566075638, -1.903310313820839, -1.6385813131928444, -2.129282996058464, -25.55451600501935, -25.92401670912902, -26.266298840443298, -0.3498190566897392, -0.47720617800951004, -0.8540141880512238, -8.310507483780384, -8.346030734479427, -8.334885150194168, -14.072673554221794, -14.156775186459228, -13.820322240392372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554263382687999, "mean_inference_ms": 0.6545065547707669, "mean_action_processing_ms": 0.0964331202383022, "mean_env_wait_ms": 0.7914602974512719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 206400, "timesteps_this_iter": 0, "agent_timesteps_total": 619200, "timers": {"sample_time_ms": 9295.664, "sample_throughput": 516.37, "load_time_ms": 0.2, "load_throughput": 23978869.938, "learn_time_ms": 1183.902, "learn_throughput": 4054.39, "update_time_ms": 1.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 296.1847610473633, "policy_loss": -0.0033247990319311416, "vf_loss": 296.2575569152832, "vf_explained_var": 0.1589767038822174, "kl": 0.009885465224221394, "entropy": 6.95341283082962, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 206400, "num_agent_steps_sampled": 619200, "num_steps_trained": 206400, "num_agent_steps_trained": 619200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1605, "training_iteration": 43, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-49-21", "timestamp": 1706147361, "time_this_iter_s": 9.345444440841675, "time_total_s": 403.8700044155121, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632B39D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 403.8700044155121, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 5.592307692307691, "ram_util_percent": 45.62307692307694}}
{"episode_reward_max": 32.46172852814196, "episode_reward_min": -341.0641849637032, "episode_reward_mean": -53.220458839500644, "episode_len_mean": 271.81, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -121.4751213391622}, "policy_reward_max": {"shared_policy": 10.900682819386319}, "policy_reward_mean": {"shared_policy": -17.74015294650022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.348060399293885, 18.315681807696805, 7.476463057100773, -313.8960201451555, -282.8312641605735, 4.447154179215431, -293.62748493254185, -15.334129013121128, -3.5879435201495937, 11.386327575892196, -12.827175647020354, -331.173161605373, -326.460715316236, -24.996646739542513, -7.149287268519416, 6.312466561794267, -23.78148285299541, -20.776944246143117, 13.689576152712078, -2.945519477129011, 3.6345156915485575, -332.1731483563781, -320.0007820725441, -22.938809275627165, -39.962387692183256, 8.326852604746804, 6.81779275834559, -15.961201779544368, 13.750813074409933, 0.03936620056629181, -37.2696715705097, -14.636737923137844, -17.68877686187625, 14.753027055412531, 5.729821756482124, -46.70696493238212, -15.6228612214327, -297.59542621299624, -0.8173633962869928, -33.99734141677618, 22.662212170660496, 11.266141317784758, -10.968130227178364, 1.673632256686659, 19.367096595466123, -38.20904584228994, 0.1391819529235221, 5.702617645263672, -26.489782415330424, -22.84362212195994, -8.738944483920946, 10.213568456470938, -37.767111577093615, -85.60104424506437, -341.0641849637032, -12.01652805507183, -31.11150977015498, 11.448760323226438, -44.75514840334655, -9.830900102853803, 0.5016805045306683, -12.955882797017722, -21.706249875947847, 32.46172852814196, -317.07296124845743, -276.56639437377453, -2.262858979404001, -306.2779226601124, 6.24598245508966, -297.1856059134007, -29.99916002526882, 8.037887498736367, -2.153140148613602, 8.960574120283113, -8.7433611750603, 12.537562958896146, -286.18365367501974, 20.764791570603833, -5.671174623072147, -77.74483155459168, -1.681039422750473, -24.99142336845398, -42.049770981073394, -22.98846716806294, 18.223868414759636, -294.52993132174015, -10.176511712372317, -30.42368360608819, -4.547818377614021, -37.47889697924258, -0.8814690485596657, -4.952742926776438, 9.16635236516592, 4.854719422757611, -3.8402664773166464, 7.515769060701118, -35.68666908144952, 3.2846535518765165, 6.8052713088691235, 6.9992320612072945], "episode_lengths": [300, 300, 300, 53, 144, 300, 48, 300, 300, 300, 300, 49, 294, 300, 300, 300, 300, 300, 300, 300, 300, 217, 60, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 147, 300, 300, 300, 300, 300, 300, 300, 300, 300, 59, 112, 300, 70, 300, 76, 300, 300, 300, 300, 300, 300, 124, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.341808204849556, 6.044613947470978, 5.961638246973351, 6.414652352531746, 6.184640896817044, 5.716388558348015, 2.317594960331917, 2.65926256775856, 2.499605529010296, -99.22754612658173, -113.35524624586105, -101.31322777271271, -91.49939126769702, -100.59549550960462, -90.73637738327186, 1.759634017944336, 1.5674994140863419, 1.1200207471847534, -96.44950520495574, -97.44210247198741, -99.73587725559871, -5.326768934726715, -4.962828375399113, -5.0445317029953, -1.3633970891436036, -0.855771512787527, -1.3687749182184632, 3.9354267281790527, 3.3497811605532917, 4.101119687159851, -3.9168646732966153, -4.215990732113525, -4.694320241610214, -121.4751213391622, -105.27135435243449, -104.42668591377637, -105.05255351712307, -105.39765044053397, -116.01051135857901, -8.450916280349105, -8.049259615441173, -8.496470843752235, -2.621770436565086, -2.2754425282279698, -2.25207430372636, 2.2239371885855945, 1.985513915618256, 2.1030154575904163, -8.014068211118385, -8.214492479960128, -7.5529221619168965, -6.849578554431602, -6.572639486442014, -7.3547262052695, 4.55290653059879, 4.488696644703538, 4.647972977409751, -1.3494324733813698, -0.656615277131408, -0.9394717266162331, 0.8561918536821906, 1.467325056592614, 1.310998781273753, -110.49375023382406, -110.60834703656535, -111.07105108598869, -117.12317518393199, -101.46271220842998, -101.41489468018214, -7.640590031941741, -7.63594098140797, -7.662278262277454, -13.460223659873009, -12.99948912486434, -13.502674907445908, 3.27449271579583, 2.73276688655217, 2.319593002398804, 2.484994155665234, 2.095918839176491, 2.2368797635038646, -5.609097416202232, -5.15027453253667, -5.201829830805465, 4.745880002776772, 4.271493638555199, 4.733439433077962, 0.09686674177646637, -0.061784692108631134, 0.0042841508984565735, -12.397588041921466, -12.301680610825628, -12.570402917762607, -4.92665808647871, -5.2899715304374695, -4.420108306221664, -5.8435440473258495, -5.888998493552208, -5.956234320998192, 4.731288328766823, 5.1680864207446575, 4.853652305901051, 2.0872747227549553, 1.7429393231868744, 1.8996077105402946, -15.226891400913402, -15.499840105573341, -15.980233425895378, -5.2346038768688885, -5.172631176809475, -5.215626167754337, -95.1755105132858, -107.39780513445537, -95.02211056525509, -0.04043797155222251, -0.2632511605819161, -0.5136742641528542, -11.07277300953865, -11.295526929199696, -11.629041478037834, 7.906713396310806, 7.969671286642551, 6.785827487707138, 3.8863750944534843, 3.828588950137288, 3.5511772731939857, -3.502368578066438, -3.8247018729647095, -3.641059776147216, 0.9491415793696945, 0.42726093033948587, 0.2972297469774787, 6.49162160356839, 6.445082222421959, 6.430392769475773, -12.660396600763008, -12.598914037148162, -12.949735204378769, -0.4188681195179669, 0.19732678433258855, 0.3607232881089004, 1.835866704583168, 1.9662873297929764, 1.9004636108875275, -8.745855989555523, -8.558715100089714, -9.185211325685188, -7.447676150749132, -7.528242389361068, -7.867703581849739, -3.0189289400974957, -2.592021428669497, -3.127994115153953, 3.3042338068286483, 3.23200489828983, 3.6773297513524597, -12.67877706388633, -12.629089141885444, -12.459245371321842, -28.376209085186325, -28.30908594777187, -28.91574921210607, -110.72540508707365, -120.40706830223402, -109.93171157439551, -3.8060676530003548, -3.835826314985752, -4.374634087085724, -10.078987357517093, -10.19562224795422, -10.83690016468367, 3.4955268700917514, 4.11754648884137, 3.8356869642933162, -14.770713547865554, -15.064408580462143, -14.920026275018856, -3.24060379465422, -3.4047286858161385, -3.185567622383445, -0.39509832859039307, 0.2637212723493576, 0.6330575607717037, -4.290839587648719, -3.7001004957904513, -4.9649427135785515, -6.846881587679192, -6.947483359525606, -7.911884928743049, 10.76024019469817, 10.900682819386319, 10.800805514057473, -114.65482280651729, -100.40335391710202, -102.01478452483813, -95.35955153157315, -95.39737961937985, -85.80946322282156, -0.7868305121859009, -0.94916454454264, -0.5268639226754601, -100.66422545909882, -101.80755683779716, -103.8061403632164, 2.3274382247278993, 2.0164765367905204, 1.9020676935712402, -106.45661880572638, -94.11635970075926, -96.61262740691504, -10.098596011598914, -10.007892382641643, -9.892671631028264, 2.544285004337624, 2.8169019718964847, 2.6767005225022587, -0.7915039882063866, -0.9102388247847557, -0.45139733562245965, 2.9784502213199886, 3.0071715017159732, 2.9749523972471508, -2.8602207501729424, -3.040132080515235, -2.843008344372123, 4.306592990954712, 4.237638575335339, 3.9933313926060947, -91.47906644145648, -103.60534278551738, -91.0992444480459, 7.278953832884625, 6.59432717164357, 6.891510566075638, -1.903310313820839, -1.6385813131928444, -2.129282996058464, -25.55451600501935, -25.92401670912902, -26.266298840443298, -0.3498190566897392, -0.47720617800951004, -0.8540141880512238, -8.310507483780384, -8.346030734479427, -8.334885150194168, -14.072673554221794, -14.156775186459228, -13.820322240392372, -7.779493930439159, -7.738693023721382, -7.470280213902399, 5.912740811705589, 5.96527872979641, 6.345848873257637, -94.30591156085333, -105.68794598182043, -94.53607377906641, -3.456701303521797, -3.107601108650371, -3.612209300200149, -10.018351403375476, -10.01172183950743, -10.393610363205283, -1.3859201967716217, -1.6349676251411438, -1.5269305557012558, -12.606896157066032, -12.325210100660726, -12.54679072151582, -0.4534042328596115, -0.1253662332892418, -0.3026985824108124, -1.8595056434472497, -1.5254541685183938, -1.5677831148107941, 3.2386186557511394, 3.0094393367568557, 2.9182943726579254, 1.450429548819855, 1.6612131049235614, 1.7430767690141948, -1.7391462226708825, -1.3790816416343148, -0.7220386130114491, 2.324613047142819, 2.5271533926327976, 2.664002620925501, -11.80382636437814, -11.97039456168811, -11.912448155383274, 1.1999438131848876, 1.0370279649893348, 1.047681773702294, 2.3710457757115364, 2.627286273986101, 1.806939259171486, 2.355981059372425, 2.242002412676811, 2.401248589158058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550556198859749, "mean_inference_ms": 0.6541370135190243, "mean_action_processing_ms": 0.09637095239919702, "mean_env_wait_ms": 0.7915377083037055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 211200, "timesteps_this_iter": 0, "agent_timesteps_total": 633600, "timers": {"sample_time_ms": 9273.881, "sample_throughput": 517.583, "load_time_ms": 0.1, "load_throughput": 47934902.857, "learn_time_ms": 1178.101, "learn_throughput": 4074.353, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 97.21095275878906, "policy_loss": -0.002608939067577032, "vf_loss": 97.2852144241333, "vf_explained_var": -0.025227472186088562, "kl": 0.018852762768808526, "entropy": 7.180930018424988, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 211200, "num_agent_steps_sampled": 633600, "num_steps_trained": 211200, "num_agent_steps_trained": 633600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1622, "training_iteration": 44, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-49-30", "timestamp": 1706147370, "time_this_iter_s": 9.143584251403809, "time_total_s": 413.0135886669159, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100053F3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 413.0135886669159, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 6.992307692307694, "ram_util_percent": 45.43846153846153}}
{"episode_reward_max": 32.46172852814196, "episode_reward_min": -341.0641849637032, "episode_reward_mean": -40.73252607864794, "episode_len_mean": 278.2, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -120.40706830223402}, "policy_reward_max": {"shared_policy": 10.900682819386319}, "policy_reward_mean": {"shared_policy": -13.57750869288265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.78148285299541, -20.776944246143117, 13.689576152712078, -2.945519477129011, 3.6345156915485575, -332.1731483563781, -320.0007820725441, -22.938809275627165, -39.962387692183256, 8.326852604746804, 6.81779275834559, -15.961201779544368, 13.750813074409933, 0.03936620056629181, -37.2696715705097, -14.636737923137844, -17.68877686187625, 14.753027055412531, 5.729821756482124, -46.70696493238212, -15.6228612214327, -297.59542621299624, -0.8173633962869928, -33.99734141677618, 22.662212170660496, 11.266141317784758, -10.968130227178364, 1.673632256686659, 19.367096595466123, -38.20904584228994, 0.1391819529235221, 5.702617645263672, -26.489782415330424, -22.84362212195994, -8.738944483920946, 10.213568456470938, -37.767111577093615, -85.60104424506437, -341.0641849637032, -12.01652805507183, -31.11150977015498, 11.448760323226438, -44.75514840334655, -9.830900102853803, 0.5016805045306683, -12.955882797017722, -21.706249875947847, 32.46172852814196, -317.07296124845743, -276.56639437377453, -2.262858979404001, -306.2779226601124, 6.24598245508966, -297.1856059134007, -29.99916002526882, 8.037887498736367, -2.153140148613602, 8.960574120283113, -8.7433611750603, 12.537562958896146, -286.18365367501974, 20.764791570603833, -5.671174623072147, -77.74483155459168, -1.681039422750473, -24.99142336845398, -42.049770981073394, -22.98846716806294, 18.223868414759636, -294.52993132174015, -10.176511712372317, -30.42368360608819, -4.547818377614021, -37.47889697924258, -0.8814690485596657, -4.952742926776438, 9.16635236516592, 4.854719422757611, -3.8402664773166464, 7.515769060701118, -35.68666908144952, 3.2846535518765165, 6.8052713088691235, 6.9992320612072945, 23.483734995126696, -303.524380363524, 4.498438164591775, 10.465516667813048, -22.288526702672243, -15.075403802096872, -7.9623840525746346, -3.6280724182725095, -3.8970882594585703, -1.2798723503947542, -10.318899929523468, -2.738069135695696, 9.202640309929848, 14.477593090385184, 8.819623675197334, 1.9607514292001582], "episode_lengths": [300, 300, 300, 300, 300, 217, 60, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 147, 300, 300, 300, 300, 300, 300, 300, 300, 300, 59, 112, 300, 70, 300, 76, 300, 300, 300, 300, 300, 300, 124, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-8.014068211118385, -8.214492479960128, -7.5529221619168965, -6.849578554431602, -6.572639486442014, -7.3547262052695, 4.55290653059879, 4.488696644703538, 4.647972977409751, -1.3494324733813698, -0.656615277131408, -0.9394717266162331, 0.8561918536821906, 1.467325056592614, 1.310998781273753, -110.49375023382406, -110.60834703656535, -111.07105108598869, -117.12317518393199, -101.46271220842998, -101.41489468018214, -7.640590031941741, -7.63594098140797, -7.662278262277454, -13.460223659873009, -12.99948912486434, -13.502674907445908, 3.27449271579583, 2.73276688655217, 2.319593002398804, 2.484994155665234, 2.095918839176491, 2.2368797635038646, -5.609097416202232, -5.15027453253667, -5.201829830805465, 4.745880002776772, 4.271493638555199, 4.733439433077962, 0.09686674177646637, -0.061784692108631134, 0.0042841508984565735, -12.397588041921466, -12.301680610825628, -12.570402917762607, -4.92665808647871, -5.2899715304374695, -4.420108306221664, -5.8435440473258495, -5.888998493552208, -5.956234320998192, 4.731288328766823, 5.1680864207446575, 4.853652305901051, 2.0872747227549553, 1.7429393231868744, 1.8996077105402946, -15.226891400913402, -15.499840105573341, -15.980233425895378, -5.2346038768688885, -5.172631176809475, -5.215626167754337, -95.1755105132858, -107.39780513445537, -95.02211056525509, -0.04043797155222251, -0.2632511605819161, -0.5136742641528542, -11.07277300953865, -11.295526929199696, -11.629041478037834, 7.906713396310806, 7.969671286642551, 6.785827487707138, 3.8863750944534843, 3.828588950137288, 3.5511772731939857, -3.502368578066438, -3.8247018729647095, -3.641059776147216, 0.9491415793696945, 0.42726093033948587, 0.2972297469774787, 6.49162160356839, 6.445082222421959, 6.430392769475773, -12.660396600763008, -12.598914037148162, -12.949735204378769, -0.4188681195179669, 0.19732678433258855, 0.3607232881089004, 1.835866704583168, 1.9662873297929764, 1.9004636108875275, -8.745855989555523, -8.558715100089714, -9.185211325685188, -7.447676150749132, -7.528242389361068, -7.867703581849739, -3.0189289400974957, -2.592021428669497, -3.127994115153953, 3.3042338068286483, 3.23200489828983, 3.6773297513524597, -12.67877706388633, -12.629089141885444, -12.459245371321842, -28.376209085186325, -28.30908594777187, -28.91574921210607, -110.72540508707365, -120.40706830223402, -109.93171157439551, -3.8060676530003548, -3.835826314985752, -4.374634087085724, -10.078987357517093, -10.19562224795422, -10.83690016468367, 3.4955268700917514, 4.11754648884137, 3.8356869642933162, -14.770713547865554, -15.064408580462143, -14.920026275018856, -3.24060379465422, -3.4047286858161385, -3.185567622383445, -0.39509832859039307, 0.2637212723493576, 0.6330575607717037, -4.290839587648719, -3.7001004957904513, -4.9649427135785515, -6.846881587679192, -6.947483359525606, -7.911884928743049, 10.76024019469817, 10.900682819386319, 10.800805514057473, -114.65482280651729, -100.40335391710202, -102.01478452483813, -95.35955153157315, -95.39737961937985, -85.80946322282156, -0.7868305121859009, -0.94916454454264, -0.5268639226754601, -100.66422545909882, -101.80755683779716, -103.8061403632164, 2.3274382247278993, 2.0164765367905204, 1.9020676935712402, -106.45661880572638, -94.11635970075926, -96.61262740691504, -10.098596011598914, -10.007892382641643, -9.892671631028264, 2.544285004337624, 2.8169019718964847, 2.6767005225022587, -0.7915039882063866, -0.9102388247847557, -0.45139733562245965, 2.9784502213199886, 3.0071715017159732, 2.9749523972471508, -2.8602207501729424, -3.040132080515235, -2.843008344372123, 4.306592990954712, 4.237638575335339, 3.9933313926060947, -91.47906644145648, -103.60534278551738, -91.0992444480459, 7.278953832884625, 6.59432717164357, 6.891510566075638, -1.903310313820839, -1.6385813131928444, -2.129282996058464, -25.55451600501935, -25.92401670912902, -26.266298840443298, -0.3498190566897392, -0.47720617800951004, -0.8540141880512238, -8.310507483780384, -8.346030734479427, -8.334885150194168, -14.072673554221794, -14.156775186459228, -13.820322240392372, -7.779493930439159, -7.738693023721382, -7.470280213902399, 5.912740811705589, 5.96527872979641, 6.345848873257637, -94.30591156085333, -105.68794598182043, -94.53607377906641, -3.456701303521797, -3.107601108650371, -3.612209300200149, -10.018351403375476, -10.01172183950743, -10.393610363205283, -1.3859201967716217, -1.6349676251411438, -1.5269305557012558, -12.606896157066032, -12.325210100660726, -12.54679072151582, -0.4534042328596115, -0.1253662332892418, -0.3026985824108124, -1.8595056434472497, -1.5254541685183938, -1.5677831148107941, 3.2386186557511394, 3.0094393367568557, 2.9182943726579254, 1.450429548819855, 1.6612131049235614, 1.7430767690141948, -1.7391462226708825, -1.3790816416343148, -0.7220386130114491, 2.324613047142819, 2.5271533926327976, 2.664002620925501, -11.80382636437814, -11.97039456168811, -11.912448155383274, 1.1999438131848876, 1.0370279649893348, 1.047681773702294, 2.3710457757115364, 2.627286273986101, 1.806939259171486, 2.355981059372425, 2.242002412676811, 2.401248589158058, 8.307923043767602, 7.6639033506313865, 7.511908600727708, -101.37385164697966, -99.84199294199547, -102.30853577454886, 1.4611165722211155, 1.6343392928441318, 1.4029822995265278, 3.584243473907307, 3.3780139361818584, 3.503259257723883, -7.502733014523983, -7.490259811282158, -7.295533876866102, -4.882732224961131, -4.899019827445358, -5.293651749690383, -2.003719724714756, -3.1596662402153015, -2.798998087644577, -1.0300851787130085, -1.262814531723663, -1.335172707835838, -1.1358438481887276, -1.2037941863139565, -1.5574502249558861, -0.7273912032445367, -0.39695467551550223, -0.15552647163471534, -3.190377376973629, -3.3156990483403206, -3.8128235042095184, -0.7001535557210445, -0.7678359523415565, -1.2700796276330948, 3.080092690885067, 3.0829227194190025, 3.039624899625778, 4.916080960383013, 4.7603543077905925, 4.801157822211579, 2.9177209461728637, 2.784055667618901, 3.1178470614055698, 0.8698149075110706, 0.5438332681854519, 0.5471032535036358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15465827835312973, "mean_inference_ms": 0.6536363775391502, "mean_action_processing_ms": 0.09629097186991074, "mean_env_wait_ms": 0.7916013565280903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 9231.597, "sample_throughput": 519.953, "load_time_ms": 0.1, "load_throughput": 47934902.857, "learn_time_ms": 1175.795, "learn_throughput": 4082.345, "update_time_ms": 1.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 56.06206512451172, "policy_loss": -0.002365145943864888, "vf_loss": 56.139490604400635, "vf_explained_var": -0.14091916382312775, "kl": 0.019240779744003577, "entropy": 7.521028518676758, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 648000, "num_steps_trained": 216000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1638, "training_iteration": 45, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-49-39", "timestamp": 1706147379, "time_this_iter_s": 8.887145280838013, "time_total_s": 421.9007339477539, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 421.9007339477539, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 6.123076923076923, "ram_util_percent": 45.33846153846154}}
{"episode_reward_max": 32.46172852814196, "episode_reward_min": -341.0641849637032, "episode_reward_mean": -33.44206373250812, "episode_len_mean": 281.43, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -120.40706830223402}, "policy_reward_max": {"shared_policy": 10.900682819386319}, "policy_reward_mean": {"shared_policy": -11.147354577502707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.68877686187625, 14.753027055412531, 5.729821756482124, -46.70696493238212, -15.6228612214327, -297.59542621299624, -0.8173633962869928, -33.99734141677618, 22.662212170660496, 11.266141317784758, -10.968130227178364, 1.673632256686659, 19.367096595466123, -38.20904584228994, 0.1391819529235221, 5.702617645263672, -26.489782415330424, -22.84362212195994, -8.738944483920946, 10.213568456470938, -37.767111577093615, -85.60104424506437, -341.0641849637032, -12.01652805507183, -31.11150977015498, 11.448760323226438, -44.75514840334655, -9.830900102853803, 0.5016805045306683, -12.955882797017722, -21.706249875947847, 32.46172852814196, -317.07296124845743, -276.56639437377453, -2.262858979404001, -306.2779226601124, 6.24598245508966, -297.1856059134007, -29.99916002526882, 8.037887498736367, -2.153140148613602, 8.960574120283113, -8.7433611750603, 12.537562958896146, -286.18365367501974, 20.764791570603833, -5.671174623072147, -77.74483155459168, -1.681039422750473, -24.99142336845398, -42.049770981073394, -22.98846716806294, 18.223868414759636, -294.52993132174015, -10.176511712372317, -30.42368360608819, -4.547818377614021, -37.47889697924258, -0.8814690485596657, -4.952742926776438, 9.16635236516592, 4.854719422757611, -3.8402664773166464, 7.515769060701118, -35.68666908144952, 3.2846535518765165, 6.8052713088691235, 6.9992320612072945, 23.483734995126696, -303.524380363524, 4.498438164591775, 10.465516667813048, -22.288526702672243, -15.075403802096872, -7.9623840525746346, -3.6280724182725095, -3.8970882594585703, -1.2798723503947542, -10.318899929523468, -2.738069135695696, 9.202640309929848, 14.477593090385184, 8.819623675197334, 1.9607514292001582, 22.80279294773935, 12.480709038674831, 5.371288180351229, 2.044962268322678, -9.588791050016908, -7.78182504326108, 4.017159443115787, 0.38555894047019024, 7.60051741078496, -17.322250004857793, -51.04694303870204, -1.5594528391957283, -7.601817570626764, -21.47533869743347, 0.8846204094588614, 5.647275455296025], "episode_lengths": [300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 147, 300, 300, 300, 300, 300, 300, 300, 300, 300, 59, 112, 300, 70, 300, 76, 300, 300, 300, 300, 300, 300, 124, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-5.8435440473258495, -5.888998493552208, -5.956234320998192, 4.731288328766823, 5.1680864207446575, 4.853652305901051, 2.0872747227549553, 1.7429393231868744, 1.8996077105402946, -15.226891400913402, -15.499840105573341, -15.980233425895378, -5.2346038768688885, -5.172631176809475, -5.215626167754337, -95.1755105132858, -107.39780513445537, -95.02211056525509, -0.04043797155222251, -0.2632511605819161, -0.5136742641528542, -11.07277300953865, -11.295526929199696, -11.629041478037834, 7.906713396310806, 7.969671286642551, 6.785827487707138, 3.8863750944534843, 3.828588950137288, 3.5511772731939857, -3.502368578066438, -3.8247018729647095, -3.641059776147216, 0.9491415793696945, 0.42726093033948587, 0.2972297469774787, 6.49162160356839, 6.445082222421959, 6.430392769475773, -12.660396600763008, -12.598914037148162, -12.949735204378769, -0.4188681195179669, 0.19732678433258855, 0.3607232881089004, 1.835866704583168, 1.9662873297929764, 1.9004636108875275, -8.745855989555523, -8.558715100089714, -9.185211325685188, -7.447676150749132, -7.528242389361068, -7.867703581849739, -3.0189289400974957, -2.592021428669497, -3.127994115153953, 3.3042338068286483, 3.23200489828983, 3.6773297513524597, -12.67877706388633, -12.629089141885444, -12.459245371321842, -28.376209085186325, -28.30908594777187, -28.91574921210607, -110.72540508707365, -120.40706830223402, -109.93171157439551, -3.8060676530003548, -3.835826314985752, -4.374634087085724, -10.078987357517093, -10.19562224795422, -10.83690016468367, 3.4955268700917514, 4.11754648884137, 3.8356869642933162, -14.770713547865554, -15.064408580462143, -14.920026275018856, -3.24060379465422, -3.4047286858161385, -3.185567622383445, -0.39509832859039307, 0.2637212723493576, 0.6330575607717037, -4.290839587648719, -3.7001004957904513, -4.9649427135785515, -6.846881587679192, -6.947483359525606, -7.911884928743049, 10.76024019469817, 10.900682819386319, 10.800805514057473, -114.65482280651729, -100.40335391710202, -102.01478452483813, -95.35955153157315, -95.39737961937985, -85.80946322282156, -0.7868305121859009, -0.94916454454264, -0.5268639226754601, -100.66422545909882, -101.80755683779716, -103.8061403632164, 2.3274382247278993, 2.0164765367905204, 1.9020676935712402, -106.45661880572638, -94.11635970075926, -96.61262740691504, -10.098596011598914, -10.007892382641643, -9.892671631028264, 2.544285004337624, 2.8169019718964847, 2.6767005225022587, -0.7915039882063866, -0.9102388247847557, -0.45139733562245965, 2.9784502213199886, 3.0071715017159732, 2.9749523972471508, -2.8602207501729424, -3.040132080515235, -2.843008344372123, 4.306592990954712, 4.237638575335339, 3.9933313926060947, -91.47906644145648, -103.60534278551738, -91.0992444480459, 7.278953832884625, 6.59432717164357, 6.891510566075638, -1.903310313820839, -1.6385813131928444, -2.129282996058464, -25.55451600501935, -25.92401670912902, -26.266298840443298, -0.3498190566897392, -0.47720617800951004, -0.8540141880512238, -8.310507483780384, -8.346030734479427, -8.334885150194168, -14.072673554221794, -14.156775186459228, -13.820322240392372, -7.779493930439159, -7.738693023721382, -7.470280213902399, 5.912740811705589, 5.96527872979641, 6.345848873257637, -94.30591156085333, -105.68794598182043, -94.53607377906641, -3.456701303521797, -3.107601108650371, -3.612209300200149, -10.018351403375476, -10.01172183950743, -10.393610363205283, -1.3859201967716217, -1.6349676251411438, -1.5269305557012558, -12.606896157066032, -12.325210100660726, -12.54679072151582, -0.4534042328596115, -0.1253662332892418, -0.3026985824108124, -1.8595056434472497, -1.5254541685183938, -1.5677831148107941, 3.2386186557511394, 3.0094393367568557, 2.9182943726579254, 1.450429548819855, 1.6612131049235614, 1.7430767690141948, -1.7391462226708825, -1.3790816416343148, -0.7220386130114491, 2.324613047142819, 2.5271533926327976, 2.664002620925501, -11.80382636437814, -11.97039456168811, -11.912448155383274, 1.1999438131848876, 1.0370279649893348, 1.047681773702294, 2.3710457757115364, 2.627286273986101, 1.806939259171486, 2.355981059372425, 2.242002412676811, 2.401248589158058, 8.307923043767602, 7.6639033506313865, 7.511908600727708, -101.37385164697966, -99.84199294199547, -102.30853577454886, 1.4611165722211155, 1.6343392928441318, 1.4029822995265278, 3.584243473907307, 3.3780139361818584, 3.503259257723883, -7.502733014523983, -7.490259811282158, -7.295533876866102, -4.882732224961131, -4.899019827445358, -5.293651749690383, -2.003719724714756, -3.1596662402153015, -2.798998087644577, -1.0300851787130085, -1.262814531723663, -1.335172707835838, -1.1358438481887276, -1.2037941863139565, -1.5574502249558861, -0.7273912032445367, -0.39695467551550223, -0.15552647163471534, -3.190377376973629, -3.3156990483403206, -3.8128235042095184, -0.7001535557210445, -0.7678359523415565, -1.2700796276330948, 3.080092690885067, 3.0829227194190025, 3.039624899625778, 4.916080960383013, 4.7603543077905925, 4.801157822211579, 2.9177209461728637, 2.784055667618901, 3.1178470614055698, 0.8698149075110706, 0.5438332681854519, 0.5471032535036358, 7.480141331752137, 7.733347171296671, 7.589304444690541, 4.3338537737727165, 4.064829736948013, 4.082025527954102, 1.7451042334238593, 1.771117674807698, 1.8550662721196716, 0.6493902007738654, 0.6195706675449912, 0.7760014000038211, -3.3543756951888497, -3.3130246003468926, -2.921390754481166, -2.4214822476108964, -2.6654099722703393, -2.694932823379844, 1.3875231469670837, 1.8606033161437665, 0.7690329800049369, 0.23156030724445031, -0.03497985502085044, 0.18897848824659036, 2.686122614890337, 2.545924574136734, 2.368470221757889, -6.0394828567902294, -5.305573156724378, -5.977193991343185, -17.076171291371196, -17.135732462008804, -16.83503928532204, -0.4009261652827263, -0.5249401479959488, -0.6335865259170532, -2.3719668959577973, -2.7853241761525567, -2.44452649851641, -7.289658792316914, -6.937336705625057, -7.248343199491501, -0.18774044016997493, 0.6614121211071762, 0.4109487285216602, 2.127701741953686, 1.8303073098262104, 1.689266403516129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15420955180503726, "mean_inference_ms": 0.653097771206076, "mean_action_processing_ms": 0.09622332608466916, "mean_env_wait_ms": 0.7916720414373415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 220800, "timesteps_this_iter": 0, "agent_timesteps_total": 662400, "timers": {"sample_time_ms": 9213.644, "sample_throughput": 520.967, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1173.095, "learn_throughput": 4091.74, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 21.822524785995483, "policy_loss": -0.0015941352773451989, "vf_loss": 21.902202606201172, "vf_explained_var": -1.0, "kl": 0.011426602355650978, "entropy": 7.817281723022461, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220800, "num_agent_steps_sampled": 662400, "num_steps_trained": 220800, "num_agent_steps_trained": 662400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1654, "training_iteration": 46, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-49-48", "timestamp": 1706147388, "time_this_iter_s": 9.019922494888306, "time_total_s": 430.9206564426422, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055EDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 430.9206564426422, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 8.323076923076924, "ram_util_percent": 45.27692307692307}}
{"episode_reward_max": 32.46172852814196, "episode_reward_min": -349.44958862662315, "episode_reward_mean": -35.02027011680243, "episode_len_mean": 278.71, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {"shared_policy": -125.38690918684006}, "policy_reward_max": {"shared_policy": 10.900682819386319}, "policy_reward_mean": {"shared_policy": -11.67342337226748}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.738944483920946, 10.213568456470938, -37.767111577093615, -85.60104424506437, -341.0641849637032, -12.01652805507183, -31.11150977015498, 11.448760323226438, -44.75514840334655, -9.830900102853803, 0.5016805045306683, -12.955882797017722, -21.706249875947847, 32.46172852814196, -317.07296124845743, -276.56639437377453, -2.262858979404001, -306.2779226601124, 6.24598245508966, -297.1856059134007, -29.99916002526882, 8.037887498736367, -2.153140148613602, 8.960574120283113, -8.7433611750603, 12.537562958896146, -286.18365367501974, 20.764791570603833, -5.671174623072147, -77.74483155459168, -1.681039422750473, -24.99142336845398, -42.049770981073394, -22.98846716806294, 18.223868414759636, -294.52993132174015, -10.176511712372317, -30.42368360608819, -4.547818377614021, -37.47889697924258, -0.8814690485596657, -4.952742926776438, 9.16635236516592, 4.854719422757611, -3.8402664773166464, 7.515769060701118, -35.68666908144952, 3.2846535518765165, 6.8052713088691235, 6.9992320612072945, 23.483734995126696, -303.524380363524, 4.498438164591775, 10.465516667813048, -22.288526702672243, -15.075403802096872, -7.9623840525746346, -3.6280724182725095, -3.8970882594585703, -1.2798723503947542, -10.318899929523468, -2.738069135695696, 9.202640309929848, 14.477593090385184, 8.819623675197334, 1.9607514292001582, 22.80279294773935, 12.480709038674831, 5.371288180351229, 2.044962268322678, -9.588791050016908, -7.78182504326108, 4.017159443115787, 0.38555894047019024, 7.60051741078496, -17.322250004857793, -51.04694303870204, -1.5594528391957283, -7.601817570626764, -21.47533869743347, 0.8846204094588614, 5.647275455296025, -0.9579225629568242, 6.588199370948132, 10.76727944612503, 6.508183395490036, 0.040571335703106115, -0.597600214183359, 5.204579263925538, 13.125909179449081, 11.03305465728043, 4.583941526710959, -349.44958862662315, -311.30386620759964, 3.5827679596841193, -13.865985056385412, 11.407459537964286, 13.68376369588077, 12.410623990930617, -10.227593019604711], "episode_lengths": [300, 300, 300, 300, 147, 300, 300, 300, 300, 300, 300, 300, 300, 300, 59, 112, 300, 70, 300, 76, 300, 300, 300, 300, 300, 300, 124, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 39, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-3.0189289400974957, -2.592021428669497, -3.127994115153953, 3.3042338068286483, 3.23200489828983, 3.6773297513524597, -12.67877706388633, -12.629089141885444, -12.459245371321842, -28.376209085186325, -28.30908594777187, -28.91574921210607, -110.72540508707365, -120.40706830223402, -109.93171157439551, -3.8060676530003548, -3.835826314985752, -4.374634087085724, -10.078987357517093, -10.19562224795422, -10.83690016468367, 3.4955268700917514, 4.11754648884137, 3.8356869642933162, -14.770713547865554, -15.064408580462143, -14.920026275018856, -3.24060379465422, -3.4047286858161385, -3.185567622383445, -0.39509832859039307, 0.2637212723493576, 0.6330575607717037, -4.290839587648719, -3.7001004957904513, -4.9649427135785515, -6.846881587679192, -6.947483359525606, -7.911884928743049, 10.76024019469817, 10.900682819386319, 10.800805514057473, -114.65482280651729, -100.40335391710202, -102.01478452483813, -95.35955153157315, -95.39737961937985, -85.80946322282156, -0.7868305121859009, -0.94916454454264, -0.5268639226754601, -100.66422545909882, -101.80755683779716, -103.8061403632164, 2.3274382247278993, 2.0164765367905204, 1.9020676935712402, -106.45661880572638, -94.11635970075926, -96.61262740691504, -10.098596011598914, -10.007892382641643, -9.892671631028264, 2.544285004337624, 2.8169019718964847, 2.6767005225022587, -0.7915039882063866, -0.9102388247847557, -0.45139733562245965, 2.9784502213199886, 3.0071715017159732, 2.9749523972471508, -2.8602207501729424, -3.040132080515235, -2.843008344372123, 4.306592990954712, 4.237638575335339, 3.9933313926060947, -91.47906644145648, -103.60534278551738, -91.0992444480459, 7.278953832884625, 6.59432717164357, 6.891510566075638, -1.903310313820839, -1.6385813131928444, -2.129282996058464, -25.55451600501935, -25.92401670912902, -26.266298840443298, -0.3498190566897392, -0.47720617800951004, -0.8540141880512238, -8.310507483780384, -8.346030734479427, -8.334885150194168, -14.072673554221794, -14.156775186459228, -13.820322240392372, -7.779493930439159, -7.738693023721382, -7.470280213902399, 5.912740811705589, 5.96527872979641, 6.345848873257637, -94.30591156085333, -105.68794598182043, -94.53607377906641, -3.456701303521797, -3.107601108650371, -3.612209300200149, -10.018351403375476, -10.01172183950743, -10.393610363205283, -1.3859201967716217, -1.6349676251411438, -1.5269305557012558, -12.606896157066032, -12.325210100660726, -12.54679072151582, -0.4534042328596115, -0.1253662332892418, -0.3026985824108124, -1.8595056434472497, -1.5254541685183938, -1.5677831148107941, 3.2386186557511394, 3.0094393367568557, 2.9182943726579254, 1.450429548819855, 1.6612131049235614, 1.7430767690141948, -1.7391462226708825, -1.3790816416343148, -0.7220386130114491, 2.324613047142819, 2.5271533926327976, 2.664002620925501, -11.80382636437814, -11.97039456168811, -11.912448155383274, 1.1999438131848876, 1.0370279649893348, 1.047681773702294, 2.3710457757115364, 2.627286273986101, 1.806939259171486, 2.355981059372425, 2.242002412676811, 2.401248589158058, 8.307923043767602, 7.6639033506313865, 7.511908600727708, -101.37385164697966, -99.84199294199547, -102.30853577454886, 1.4611165722211155, 1.6343392928441318, 1.4029822995265278, 3.584243473907307, 3.3780139361818584, 3.503259257723883, -7.502733014523983, -7.490259811282158, -7.295533876866102, -4.882732224961131, -4.899019827445358, -5.293651749690383, -2.003719724714756, -3.1596662402153015, -2.798998087644577, -1.0300851787130085, -1.262814531723663, -1.335172707835838, -1.1358438481887276, -1.2037941863139565, -1.5574502249558861, -0.7273912032445367, -0.39695467551550223, -0.15552647163471534, -3.190377376973629, -3.3156990483403206, -3.8128235042095184, -0.7001535557210445, -0.7678359523415565, -1.2700796276330948, 3.080092690885067, 3.0829227194190025, 3.039624899625778, 4.916080960383013, 4.7603543077905925, 4.801157822211579, 2.9177209461728637, 2.784055667618901, 3.1178470614055698, 0.8698149075110706, 0.5438332681854519, 0.5471032535036358, 7.480141331752137, 7.733347171296671, 7.589304444690541, 4.3338537737727165, 4.064829736948013, 4.082025527954102, 1.7451042334238593, 1.771117674807698, 1.8550662721196716, 0.6493902007738654, 0.6195706675449912, 0.7760014000038211, -3.3543756951888497, -3.3130246003468926, -2.921390754481166, -2.4214822476108964, -2.6654099722703393, -2.694932823379844, 1.3875231469670837, 1.8606033161437665, 0.7690329800049369, 0.23156030724445031, -0.03497985502085044, 0.18897848824659036, 2.686122614890337, 2.545924574136734, 2.368470221757889, -6.0394828567902294, -5.305573156724378, -5.977193991343185, -17.076171291371196, -17.135732462008804, -16.83503928532204, -0.4009261652827263, -0.5249401479959488, -0.6335865259170532, -2.3719668959577973, -2.7853241761525567, -2.44452649851641, -7.289658792316914, -6.937336705625057, -7.248343199491501, -0.18774044016997493, 0.6614121211071762, 0.4109487285216602, 2.127701741953686, 1.8303073098262104, 1.689266403516129, -0.0853855411211697, -0.321675563851997, -0.5508614579836575, 2.132816046476364, 2.5172164155519567, 1.9381669089198112, 3.698996290564537, 3.687426507472992, 3.3808566480875015, 2.078509976466492, 2.08867323895295, 2.341000180070594, -0.054688428839057224, -0.10248282303413703, 0.19774258757630037, -0.17026057591041877, -0.2034793620308335, -0.2238602762421067, 1.695942913492516, 1.8286088829239162, 1.680027467509106, 4.3325614631175995, 4.535473555326462, 4.25787416100502, 3.7182318580647262, 3.571884555121258, 3.7429382440944465, 1.5637118543187682, 1.4270145619908874, 1.593215110401303, -112.00404258072376, -112.05863685905933, -125.38690918684006, -111.99976235628128, -99.9754872918129, -99.32861655950546, 0.9443146934111866, 1.4982807648678573, 1.1401725014050754, -4.2497123486052, -4.593097845713302, -5.023174862066909, 3.78781936566034, 3.3314377019802635, 4.288202470323682, 4.615573659539223, 4.868128625676036, 4.200061410665512, 4.09552264213562, 4.411033445037901, 3.9040679037570953, -3.7916099478801186, -3.265200351675361, -3.170782720049232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372010905627748, "mean_inference_ms": 0.6525704504324229, "mean_action_processing_ms": 0.09619079103435414, "mean_env_wait_ms": 0.7917985641364056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 225600, "timesteps_this_iter": 0, "agent_timesteps_total": 676800, "timers": {"sample_time_ms": 9223.244, "sample_throughput": 520.424, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1175.395, "learn_throughput": 4083.733, "update_time_ms": 1.701}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 120.70764636993408, "policy_loss": -0.004029360251022601, "vf_loss": 120.79181289672852, "vf_explained_var": 0.009929262101650238, "kl": 0.012952391116425424, "entropy": 8.024485468864441, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 225600, "num_agent_steps_sampled": 676800, "num_steps_trained": 225600, "num_agent_steps_trained": 676800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1672, "training_iteration": 47, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-49-57", "timestamp": 1706147397, "time_this_iter_s": 9.309435606002808, "time_total_s": 440.230092048645, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 440.230092048645, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 6.199999999999999, "ram_util_percent": 45.3076923076923}}
{"episode_reward_max": 24.504303008317947, "episode_reward_min": -349.44958862662315, "episode_reward_mean": -29.132319710062006, "episode_len_mean": 280.98, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -125.38690918684006}, "policy_reward_max": {"shared_policy": 8.378659091889858}, "policy_reward_mean": {"shared_policy": -9.71077323668734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306.2779226601124, 6.24598245508966, -297.1856059134007, -29.99916002526882, 8.037887498736367, -2.153140148613602, 8.960574120283113, -8.7433611750603, 12.537562958896146, -286.18365367501974, 20.764791570603833, -5.671174623072147, -77.74483155459168, -1.681039422750473, -24.99142336845398, -42.049770981073394, -22.98846716806294, 18.223868414759636, -294.52993132174015, -10.176511712372317, -30.42368360608819, -4.547818377614021, -37.47889697924258, -0.8814690485596657, -4.952742926776438, 9.16635236516592, 4.854719422757611, -3.8402664773166464, 7.515769060701118, -35.68666908144952, 3.2846535518765165, 6.8052713088691235, 6.9992320612072945, 23.483734995126696, -303.524380363524, 4.498438164591775, 10.465516667813048, -22.288526702672243, -15.075403802096872, -7.9623840525746346, -3.6280724182725095, -3.8970882594585703, -1.2798723503947542, -10.318899929523468, -2.738069135695696, 9.202640309929848, 14.477593090385184, 8.819623675197334, 1.9607514292001582, 22.80279294773935, 12.480709038674831, 5.371288180351229, 2.044962268322678, -9.588791050016908, -7.78182504326108, 4.017159443115787, 0.38555894047019024, 7.60051741078496, -17.322250004857793, -51.04694303870204, -1.5594528391957283, -7.601817570626764, -21.47533869743347, 0.8846204094588614, 5.647275455296025, -0.9579225629568242, 6.588199370948132, 10.76727944612503, 6.508183395490036, 0.040571335703106115, -0.597600214183359, 5.204579263925538, 13.125909179449081, 11.03305465728043, 4.583941526710959, -349.44958862662315, -311.30386620759964, 3.5827679596841193, -13.865985056385412, 11.407459537964286, 13.68376369588077, 12.410623990930617, -10.227593019604711, 10.057662114500985, -13.625057309865966, 23.940415821969495, 7.303466050885618, 12.689247682690606, -320.19864177703863, -26.13410698249936, 6.965610422194004, -1.5466335453093052, 20.171323698013992, 13.866476107388706, 24.504303008317947, 3.7473578825592853, -3.2412468418478966, -12.373804785311222, 10.202223530504824, -314.3575354665518], "episode_lengths": [70, 300, 76, 300, 300, 300, 300, 300, 300, 124, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 39, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 202, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 43], "policy_shared_policy_reward": [-100.66422545909882, -101.80755683779716, -103.8061403632164, 2.3274382247278993, 2.0164765367905204, 1.9020676935712402, -106.45661880572638, -94.11635970075926, -96.61262740691504, -10.098596011598914, -10.007892382641643, -9.892671631028264, 2.544285004337624, 2.8169019718964847, 2.6767005225022587, -0.7915039882063866, -0.9102388247847557, -0.45139733562245965, 2.9784502213199886, 3.0071715017159732, 2.9749523972471508, -2.8602207501729424, -3.040132080515235, -2.843008344372123, 4.306592990954712, 4.237638575335339, 3.9933313926060947, -91.47906644145648, -103.60534278551738, -91.0992444480459, 7.278953832884625, 6.59432717164357, 6.891510566075638, -1.903310313820839, -1.6385813131928444, -2.129282996058464, -25.55451600501935, -25.92401670912902, -26.266298840443298, -0.3498190566897392, -0.47720617800951004, -0.8540141880512238, -8.310507483780384, -8.346030734479427, -8.334885150194168, -14.072673554221794, -14.156775186459228, -13.820322240392372, -7.779493930439159, -7.738693023721382, -7.470280213902399, 5.912740811705589, 5.96527872979641, 6.345848873257637, -94.30591156085333, -105.68794598182043, -94.53607377906641, -3.456701303521797, -3.107601108650371, -3.612209300200149, -10.018351403375476, -10.01172183950743, -10.393610363205283, -1.3859201967716217, -1.6349676251411438, -1.5269305557012558, -12.606896157066032, -12.325210100660726, -12.54679072151582, -0.4534042328596115, -0.1253662332892418, -0.3026985824108124, -1.8595056434472497, -1.5254541685183938, -1.5677831148107941, 3.2386186557511394, 3.0094393367568557, 2.9182943726579254, 1.450429548819855, 1.6612131049235614, 1.7430767690141948, -1.7391462226708825, -1.3790816416343148, -0.7220386130114491, 2.324613047142819, 2.5271533926327976, 2.664002620925501, -11.80382636437814, -11.97039456168811, -11.912448155383274, 1.1999438131848876, 1.0370279649893348, 1.047681773702294, 2.3710457757115364, 2.627286273986101, 1.806939259171486, 2.355981059372425, 2.242002412676811, 2.401248589158058, 8.307923043767602, 7.6639033506313865, 7.511908600727708, -101.37385164697966, -99.84199294199547, -102.30853577454886, 1.4611165722211155, 1.6343392928441318, 1.4029822995265278, 3.584243473907307, 3.3780139361818584, 3.503259257723883, -7.502733014523983, -7.490259811282158, -7.295533876866102, -4.882732224961131, -4.899019827445358, -5.293651749690383, -2.003719724714756, -3.1596662402153015, -2.798998087644577, -1.0300851787130085, -1.262814531723663, -1.335172707835838, -1.1358438481887276, -1.2037941863139565, -1.5574502249558861, -0.7273912032445367, -0.39695467551550223, -0.15552647163471534, -3.190377376973629, -3.3156990483403206, -3.8128235042095184, -0.7001535557210445, -0.7678359523415565, -1.2700796276330948, 3.080092690885067, 3.0829227194190025, 3.039624899625778, 4.916080960383013, 4.7603543077905925, 4.801157822211579, 2.9177209461728637, 2.784055667618901, 3.1178470614055698, 0.8698149075110706, 0.5438332681854519, 0.5471032535036358, 7.480141331752137, 7.733347171296671, 7.589304444690541, 4.3338537737727165, 4.064829736948013, 4.082025527954102, 1.7451042334238593, 1.771117674807698, 1.8550662721196716, 0.6493902007738654, 0.6195706675449912, 0.7760014000038211, -3.3543756951888497, -3.3130246003468926, -2.921390754481166, -2.4214822476108964, -2.6654099722703393, -2.694932823379844, 1.3875231469670837, 1.8606033161437665, 0.7690329800049369, 0.23156030724445031, -0.03497985502085044, 0.18897848824659036, 2.686122614890337, 2.545924574136734, 2.368470221757889, -6.0394828567902294, -5.305573156724378, -5.977193991343185, -17.076171291371196, -17.135732462008804, -16.83503928532204, -0.4009261652827263, -0.5249401479959488, -0.6335865259170532, -2.3719668959577973, -2.7853241761525567, -2.44452649851641, -7.289658792316914, -6.937336705625057, -7.248343199491501, -0.18774044016997493, 0.6614121211071762, 0.4109487285216602, 2.127701741953686, 1.8303073098262104, 1.689266403516129, -0.0853855411211697, -0.321675563851997, -0.5508614579836575, 2.132816046476364, 2.5172164155519567, 1.9381669089198112, 3.698996290564537, 3.687426507472992, 3.3808566480875015, 2.078509976466492, 2.08867323895295, 2.341000180070594, -0.054688428839057224, -0.10248282303413703, 0.19774258757630037, -0.17026057591041877, -0.2034793620308335, -0.2238602762421067, 1.695942913492516, 1.8286088829239162, 1.680027467509106, 4.3325614631175995, 4.535473555326462, 4.25787416100502, 3.7182318580647262, 3.571884555121258, 3.7429382440944465, 1.5637118543187682, 1.4270145619908874, 1.593215110401303, -112.00404258072376, -112.05863685905933, -125.38690918684006, -111.99976235628128, -99.9754872918129, -99.32861655950546, 0.9443146934111866, 1.4982807648678573, 1.1401725014050754, -4.2497123486052, -4.593097845713302, -5.023174862066909, 3.78781936566034, 3.3314377019802635, 4.288202470323682, 4.615573659539223, 4.868128625676036, 4.200061410665512, 4.09552264213562, 4.411033445037901, 3.9040679037570953, -3.7916099478801186, -3.265200351675361, -3.170782720049232, 3.5721252684791835, 3.7291961734493526, 2.756340672572449, -4.600030372540161, -4.574259149531528, -4.450767787794277, 8.18389944483836, 7.824921121199921, 7.931595255931214, 2.631569568067789, 1.9103867262601852, 2.7615097565576434, 4.43006995817025, 4.2741875698169025, 3.9849901547034534, -102.81154291828474, -103.74981897075972, -113.63727988799414, -8.290611002594233, -9.02617409825325, -8.817321881651878, 2.443596124649048, 2.4515942111611366, 2.0704200863838196, -0.6317189410328865, -0.5208158567547798, -0.39409874752163887, 6.912816582868487, 6.621447118620068, 6.637059996525437, 4.502974192301423, 4.723637013385684, 4.6398649017016, 8.232577420771122, 8.378659091889858, 7.893066495656967, 1.476183151205376, 1.2613933061559948, 1.0097814251979145, -0.9805797338485718, -1.4823349863290787, -0.7783321216702461, -3.9096341654658318, -4.21783059835434, -4.246340021491051, 3.341933997968823, 3.1034939984480445, 3.7567955340879564, -113.79933019479117, -99.71749988694987, -100.84070538481078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15326920754082607, "mean_inference_ms": 0.6520104969119908, "mean_action_processing_ms": 0.0961995784159787, "mean_env_wait_ms": 0.7918772604958916, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 230400, "timesteps_this_iter": 0, "agent_timesteps_total": 691200, "timers": {"sample_time_ms": 9206.032, "sample_throughput": 521.397, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1173.294, "learn_throughput": 4091.046, "update_time_ms": 1.801}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 158.56328201293945, "policy_loss": -0.0003333325669074294, "vf_loss": 158.64733505249023, "vf_explained_var": -0.06522154808044434, "kl": 0.011974356166333402, "entropy": 8.380909442901611, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 230400, "num_agent_steps_sampled": 691200, "num_steps_trained": 230400, "num_agent_steps_trained": 691200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1689, "training_iteration": 48, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-50-07", "timestamp": 1706147407, "time_this_iter_s": 9.123398065567017, "time_total_s": 449.35349011421204, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C22E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 449.35349011421204, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 7.199999999999999, "ram_util_percent": 45.30769230769231}}
{"episode_reward_max": 24.855029955506325, "episode_reward_min": -349.44958862662315, "episode_reward_mean": -18.088444506682585, "episode_len_mean": 287.28, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -125.38690918684006}, "policy_reward_max": {"shared_policy": 8.509512692689896}, "policy_reward_mean": {"shared_policy": -6.029481502227529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.98846716806294, 18.223868414759636, -294.52993132174015, -10.176511712372317, -30.42368360608819, -4.547818377614021, -37.47889697924258, -0.8814690485596657, -4.952742926776438, 9.16635236516592, 4.854719422757611, -3.8402664773166464, 7.515769060701118, -35.68666908144952, 3.2846535518765165, 6.8052713088691235, 6.9992320612072945, 23.483734995126696, -303.524380363524, 4.498438164591775, 10.465516667813048, -22.288526702672243, -15.075403802096872, -7.9623840525746346, -3.6280724182725095, -3.8970882594585703, -1.2798723503947542, -10.318899929523468, -2.738069135695696, 9.202640309929848, 14.477593090385184, 8.819623675197334, 1.9607514292001582, 22.80279294773935, 12.480709038674831, 5.371288180351229, 2.044962268322678, -9.588791050016908, -7.78182504326108, 4.017159443115787, 0.38555894047019024, 7.60051741078496, -17.322250004857793, -51.04694303870204, -1.5594528391957283, -7.601817570626764, -21.47533869743347, 0.8846204094588614, 5.647275455296025, -0.9579225629568242, 6.588199370948132, 10.76727944612503, 6.508183395490036, 0.040571335703106115, -0.597600214183359, 5.204579263925538, 13.125909179449081, 11.03305465728043, 4.583941526710959, -349.44958862662315, -311.30386620759964, 3.5827679596841193, -13.865985056385412, 11.407459537964286, 13.68376369588077, 12.410623990930617, -10.227593019604711, 10.057662114500985, -13.625057309865966, 23.940415821969495, 7.303466050885618, 12.689247682690606, -320.19864177703863, -26.13410698249936, 6.965610422194004, -1.5466335453093052, 20.171323698013992, 13.866476107388706, 24.504303008317947, 3.7473578825592853, -3.2412468418478966, -12.373804785311222, 10.202223530504824, -314.3575354665518, -4.148418620228767, 22.261152848601313, -13.630399025976672, 1.3102101087569906, 6.388229943811865, 14.775948733091354, 9.17536198720336, -0.24609877169133654, -7.020714692771463, -21.16924302279952, -7.691431306302576, 6.738158665597439, 24.855029955506325, 6.860997466370435, 15.475931912660585, 24.318519212305517], "episode_lengths": [300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 39, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 202, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 43, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-7.779493930439159, -7.738693023721382, -7.470280213902399, 5.912740811705589, 5.96527872979641, 6.345848873257637, -94.30591156085333, -105.68794598182043, -94.53607377906641, -3.456701303521797, -3.107601108650371, -3.612209300200149, -10.018351403375476, -10.01172183950743, -10.393610363205283, -1.3859201967716217, -1.6349676251411438, -1.5269305557012558, -12.606896157066032, -12.325210100660726, -12.54679072151582, -0.4534042328596115, -0.1253662332892418, -0.3026985824108124, -1.8595056434472497, -1.5254541685183938, -1.5677831148107941, 3.2386186557511394, 3.0094393367568557, 2.9182943726579254, 1.450429548819855, 1.6612131049235614, 1.7430767690141948, -1.7391462226708825, -1.3790816416343148, -0.7220386130114491, 2.324613047142819, 2.5271533926327976, 2.664002620925501, -11.80382636437814, -11.97039456168811, -11.912448155383274, 1.1999438131848876, 1.0370279649893348, 1.047681773702294, 2.3710457757115364, 2.627286273986101, 1.806939259171486, 2.355981059372425, 2.242002412676811, 2.401248589158058, 8.307923043767602, 7.6639033506313865, 7.511908600727708, -101.37385164697966, -99.84199294199547, -102.30853577454886, 1.4611165722211155, 1.6343392928441318, 1.4029822995265278, 3.584243473907307, 3.3780139361818584, 3.503259257723883, -7.502733014523983, -7.490259811282158, -7.295533876866102, -4.882732224961131, -4.899019827445358, -5.293651749690383, -2.003719724714756, -3.1596662402153015, -2.798998087644577, -1.0300851787130085, -1.262814531723663, -1.335172707835838, -1.1358438481887276, -1.2037941863139565, -1.5574502249558861, -0.7273912032445367, -0.39695467551550223, -0.15552647163471534, -3.190377376973629, -3.3156990483403206, -3.8128235042095184, -0.7001535557210445, -0.7678359523415565, -1.2700796276330948, 3.080092690885067, 3.0829227194190025, 3.039624899625778, 4.916080960383013, 4.7603543077905925, 4.801157822211579, 2.9177209461728637, 2.784055667618901, 3.1178470614055698, 0.8698149075110706, 0.5438332681854519, 0.5471032535036358, 7.480141331752137, 7.733347171296671, 7.589304444690541, 4.3338537737727165, 4.064829736948013, 4.082025527954102, 1.7451042334238593, 1.771117674807698, 1.8550662721196716, 0.6493902007738654, 0.6195706675449912, 0.7760014000038211, -3.3543756951888497, -3.3130246003468926, -2.921390754481166, -2.4214822476108964, -2.6654099722703393, -2.694932823379844, 1.3875231469670837, 1.8606033161437665, 0.7690329800049369, 0.23156030724445031, -0.03497985502085044, 0.18897848824659036, 2.686122614890337, 2.545924574136734, 2.368470221757889, -6.0394828567902294, -5.305573156724378, -5.977193991343185, -17.076171291371196, -17.135732462008804, -16.83503928532204, -0.4009261652827263, -0.5249401479959488, -0.6335865259170532, -2.3719668959577973, -2.7853241761525567, -2.44452649851641, -7.289658792316914, -6.937336705625057, -7.248343199491501, -0.18774044016997493, 0.6614121211071762, 0.4109487285216602, 2.127701741953686, 1.8303073098262104, 1.689266403516129, -0.0853855411211697, -0.321675563851997, -0.5508614579836575, 2.132816046476364, 2.5172164155519567, 1.9381669089198112, 3.698996290564537, 3.687426507472992, 3.3808566480875015, 2.078509976466492, 2.08867323895295, 2.341000180070594, -0.054688428839057224, -0.10248282303413703, 0.19774258757630037, -0.17026057591041877, -0.2034793620308335, -0.2238602762421067, 1.695942913492516, 1.8286088829239162, 1.680027467509106, 4.3325614631175995, 4.535473555326462, 4.25787416100502, 3.7182318580647262, 3.571884555121258, 3.7429382440944465, 1.5637118543187682, 1.4270145619908874, 1.593215110401303, -112.00404258072376, -112.05863685905933, -125.38690918684006, -111.99976235628128, -99.9754872918129, -99.32861655950546, 0.9443146934111866, 1.4982807648678573, 1.1401725014050754, -4.2497123486052, -4.593097845713302, -5.023174862066909, 3.78781936566034, 3.3314377019802635, 4.288202470323682, 4.615573659539223, 4.868128625676036, 4.200061410665512, 4.09552264213562, 4.411033445037901, 3.9040679037570953, -3.7916099478801186, -3.265200351675361, -3.170782720049232, 3.5721252684791835, 3.7291961734493526, 2.756340672572449, -4.600030372540161, -4.574259149531528, -4.450767787794277, 8.18389944483836, 7.824921121199921, 7.931595255931214, 2.631569568067789, 1.9103867262601852, 2.7615097565576434, 4.43006995817025, 4.2741875698169025, 3.9849901547034534, -102.81154291828474, -103.74981897075972, -113.63727988799414, -8.290611002594233, -9.02617409825325, -8.817321881651878, 2.443596124649048, 2.4515942111611366, 2.0704200863838196, -0.6317189410328865, -0.5208158567547798, -0.39409874752163887, 6.912816582868487, 6.621447118620068, 6.637059996525437, 4.502974192301423, 4.723637013385684, 4.6398649017016, 8.232577420771122, 8.378659091889858, 7.893066495656967, 1.476183151205376, 1.2613933061559948, 1.0097814251979145, -0.9805797338485718, -1.4823349863290787, -0.7783321216702461, -3.9096341654658318, -4.21783059835434, -4.246340021491051, 3.341933997968823, 3.1034939984480445, 3.7567955340879564, -113.79933019479117, -99.71749988694987, -100.84070538481078, -1.0192376673221588, -1.3526352792978287, -1.77654567360878, 7.6987549612919395, 6.9804775665203636, 7.58192032078901, -4.018662619094059, -5.0010068813959805, -4.610729525486633, 0.6458915869394843, 0.47742025057473825, 0.18689827124276803, 2.2209199617306297, 2.2491641814509933, 1.918145800630242, 4.89364293217659, 5.027376681566238, 4.854929119348526, 3.2386743016541004, 3.198873095214367, 2.7378145903348923, 0.09035848577816807, -0.2468959192434994, -0.0895613382260052, -2.399437067409366, -2.1786001076301034, -2.442677517731994, -6.969712232549995, -7.15999246140322, -7.039538328846305, -2.49344998349747, -2.636921492715686, -2.5610598300894196, 1.9289161562919617, 2.3900776095688343, 2.419164899736643, 8.26995324343443, 8.509512692689896, 8.075564019382, 2.0195282946030204, 2.3029393280545776, 2.538529843712837, 5.118102555473641, 5.313462962706879, 5.044366394480065, 8.219478073219449, 8.398448954025895, 7.700592185060174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15280110189659546, "mean_inference_ms": 0.6514467758626956, "mean_action_processing_ms": 0.09617551776813255, "mean_env_wait_ms": 0.7919405635910155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 235200, "timesteps_this_iter": 0, "agent_timesteps_total": 705600, "timers": {"sample_time_ms": 9189.262, "sample_throughput": 522.349, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1178.588, "learn_throughput": 4072.669, "update_time_ms": 1.801}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 17.268064260482788, "policy_loss": -0.002252853978360614, "vf_loss": 17.35364294052124, "vf_explained_var": -1.0, "kl": 0.005581337005437839, "entropy": 8.336959719657898, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 235200, "num_agent_steps_sampled": 705600, "num_steps_trained": 235200, "num_agent_steps_trained": 705600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1705, "training_iteration": 49, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-50-16", "timestamp": 1706147416, "time_this_iter_s": 9.167382955551147, "time_total_s": 458.5208730697632, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 458.5208730697632, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 7.538461538461538, "ram_util_percent": 45.37692307692308}}
{"episode_reward_max": 48.17502404842524, "episode_reward_min": -349.44958862662315, "episode_reward_mean": -13.770023281463084, "episode_len_mean": 289.18, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -125.38690918684006}, "policy_reward_max": {"shared_policy": 16.132850213286773}, "policy_reward_mean": {"shared_policy": -4.590007760487696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.9992320612072945, 23.483734995126696, -303.524380363524, 4.498438164591775, 10.465516667813048, -22.288526702672243, -15.075403802096872, -7.9623840525746346, -3.6280724182725095, -3.8970882594585703, -1.2798723503947542, -10.318899929523468, -2.738069135695696, 9.202640309929848, 14.477593090385184, 8.819623675197334, 1.9607514292001582, 22.80279294773935, 12.480709038674831, 5.371288180351229, 2.044962268322678, -9.588791050016908, -7.78182504326108, 4.017159443115787, 0.38555894047019024, 7.60051741078496, -17.322250004857793, -51.04694303870204, -1.5594528391957283, -7.601817570626764, -21.47533869743347, 0.8846204094588614, 5.647275455296025, -0.9579225629568242, 6.588199370948132, 10.76727944612503, 6.508183395490036, 0.040571335703106115, -0.597600214183359, 5.204579263925538, 13.125909179449081, 11.03305465728043, 4.583941526710959, -349.44958862662315, -311.30386620759964, 3.5827679596841193, -13.865985056385412, 11.407459537964286, 13.68376369588077, 12.410623990930617, -10.227593019604711, 10.057662114500985, -13.625057309865966, 23.940415821969495, 7.303466050885618, 12.689247682690606, -320.19864177703863, -26.13410698249936, 6.965610422194004, -1.5466335453093052, 20.171323698013992, 13.866476107388706, 24.504303008317947, 3.7473578825592853, -3.2412468418478966, -12.373804785311222, 10.202223530504824, -314.3575354665518, -4.148418620228767, 22.261152848601313, -13.630399025976672, 1.3102101087569906, 6.388229943811865, 14.775948733091354, 9.17536198720336, -0.24609877169133654, -7.020714692771463, -21.16924302279952, -7.691431306302576, 6.738158665597439, 24.855029955506325, 6.860997466370435, 15.475931912660585, 24.318519212305517, -41.466466307872935, 48.17502404842524, 3.7231500335037566, 9.642961703240857, -14.522907510399847, -13.049378983676448, 2.1253587659448243, 5.084130559116588, 3.303322687745066, 9.012750953435898, 18.19307526946065, -14.925970575772254, -13.323121611028924, 9.120067049749196, 10.186948582529993, 14.907355282455683], "episode_lengths": [300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 39, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 202, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 43, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.355981059372425, 2.242002412676811, 2.401248589158058, 8.307923043767602, 7.6639033506313865, 7.511908600727708, -101.37385164697966, -99.84199294199547, -102.30853577454886, 1.4611165722211155, 1.6343392928441318, 1.4029822995265278, 3.584243473907307, 3.3780139361818584, 3.503259257723883, -7.502733014523983, -7.490259811282158, -7.295533876866102, -4.882732224961131, -4.899019827445358, -5.293651749690383, -2.003719724714756, -3.1596662402153015, -2.798998087644577, -1.0300851787130085, -1.262814531723663, -1.335172707835838, -1.1358438481887276, -1.2037941863139565, -1.5574502249558861, -0.7273912032445367, -0.39695467551550223, -0.15552647163471534, -3.190377376973629, -3.3156990483403206, -3.8128235042095184, -0.7001535557210445, -0.7678359523415565, -1.2700796276330948, 3.080092690885067, 3.0829227194190025, 3.039624899625778, 4.916080960383013, 4.7603543077905925, 4.801157822211579, 2.9177209461728637, 2.784055667618901, 3.1178470614055698, 0.8698149075110706, 0.5438332681854519, 0.5471032535036358, 7.480141331752137, 7.733347171296671, 7.589304444690541, 4.3338537737727165, 4.064829736948013, 4.082025527954102, 1.7451042334238593, 1.771117674807698, 1.8550662721196716, 0.6493902007738654, 0.6195706675449912, 0.7760014000038211, -3.3543756951888497, -3.3130246003468926, -2.921390754481166, -2.4214822476108964, -2.6654099722703393, -2.694932823379844, 1.3875231469670837, 1.8606033161437665, 0.7690329800049369, 0.23156030724445031, -0.03497985502085044, 0.18897848824659036, 2.686122614890337, 2.545924574136734, 2.368470221757889, -6.0394828567902294, -5.305573156724378, -5.977193991343185, -17.076171291371196, -17.135732462008804, -16.83503928532204, -0.4009261652827263, -0.5249401479959488, -0.6335865259170532, -2.3719668959577973, -2.7853241761525567, -2.44452649851641, -7.289658792316914, -6.937336705625057, -7.248343199491501, -0.18774044016997493, 0.6614121211071762, 0.4109487285216602, 2.127701741953686, 1.8303073098262104, 1.689266403516129, -0.0853855411211697, -0.321675563851997, -0.5508614579836575, 2.132816046476364, 2.5172164155519567, 1.9381669089198112, 3.698996290564537, 3.687426507472992, 3.3808566480875015, 2.078509976466492, 2.08867323895295, 2.341000180070594, -0.054688428839057224, -0.10248282303413703, 0.19774258757630037, -0.17026057591041877, -0.2034793620308335, -0.2238602762421067, 1.695942913492516, 1.8286088829239162, 1.680027467509106, 4.3325614631175995, 4.535473555326462, 4.25787416100502, 3.7182318580647262, 3.571884555121258, 3.7429382440944465, 1.5637118543187682, 1.4270145619908874, 1.593215110401303, -112.00404258072376, -112.05863685905933, -125.38690918684006, -111.99976235628128, -99.9754872918129, -99.32861655950546, 0.9443146934111866, 1.4982807648678573, 1.1401725014050754, -4.2497123486052, -4.593097845713302, -5.023174862066909, 3.78781936566034, 3.3314377019802635, 4.288202470323682, 4.615573659539223, 4.868128625676036, 4.200061410665512, 4.09552264213562, 4.411033445037901, 3.9040679037570953, -3.7916099478801186, -3.265200351675361, -3.170782720049232, 3.5721252684791835, 3.7291961734493526, 2.756340672572449, -4.600030372540161, -4.574259149531528, -4.450767787794277, 8.18389944483836, 7.824921121199921, 7.931595255931214, 2.631569568067789, 1.9103867262601852, 2.7615097565576434, 4.43006995817025, 4.2741875698169025, 3.9849901547034534, -102.81154291828474, -103.74981897075972, -113.63727988799414, -8.290611002594233, -9.02617409825325, -8.817321881651878, 2.443596124649048, 2.4515942111611366, 2.0704200863838196, -0.6317189410328865, -0.5208158567547798, -0.39409874752163887, 6.912816582868487, 6.621447118620068, 6.637059996525437, 4.502974192301423, 4.723637013385684, 4.6398649017016, 8.232577420771122, 8.378659091889858, 7.893066495656967, 1.476183151205376, 1.2613933061559948, 1.0097814251979145, -0.9805797338485718, -1.4823349863290787, -0.7783321216702461, -3.9096341654658318, -4.21783059835434, -4.246340021491051, 3.341933997968823, 3.1034939984480445, 3.7567955340879564, -113.79933019479117, -99.71749988694987, -100.84070538481078, -1.0192376673221588, -1.3526352792978287, -1.77654567360878, 7.6987549612919395, 6.9804775665203636, 7.58192032078901, -4.018662619094059, -5.0010068813959805, -4.610729525486633, 0.6458915869394843, 0.47742025057473825, 0.18689827124276803, 2.2209199617306297, 2.2491641814509933, 1.918145800630242, 4.89364293217659, 5.027376681566238, 4.854929119348526, 3.2386743016541004, 3.198873095214367, 2.7378145903348923, 0.09035848577816807, -0.2468959192434994, -0.0895613382260052, -2.399437067409366, -2.1786001076301034, -2.442677517731994, -6.969712232549995, -7.15999246140322, -7.039538328846305, -2.49344998349747, -2.636921492715686, -2.5610598300894196, 1.9289161562919617, 2.3900776095688343, 2.419164899736643, 8.26995324343443, 8.509512692689896, 8.075564019382, 2.0195282946030204, 2.3029393280545776, 2.538529843712837, 5.118102555473641, 5.313462962706879, 5.044366394480065, 8.219478073219449, 8.398448954025895, 7.700592185060174, -13.102592503263935, -13.724506681164115, -14.639367123444885, 15.925203514595822, 16.11697032054265, 16.132850213286773, 0.7764668663342746, 1.6900606912871154, 1.2566224758823665, 3.3090212841828617, 3.100476925571755, 3.2334634934862407, -4.537985151012748, -4.99290016790232, -4.992022191484779, -4.59378317991893, -4.141942570606872, -4.313653233150646, 0.712577578922108, 0.34864193697769963, 1.0641392500450166, 1.7507286307712349, 1.6402343784769329, 1.69316754986842, 1.0384361098209922, 1.360735932985932, 0.9041506449381416, 3.177202805876732, 2.972432240843773, 2.863115906715393, 6.032245414952428, 6.041460740069539, 6.119369114438683, -5.09147044767937, -5.114752953251212, -4.719747174841672, -4.644319402674839, -4.32975195969145, -4.3490502486626355, 2.89200209826231, 2.85376113653183, 3.3743038149550557, 3.1349605421225135, 3.5524363170067375, 3.4995517234007423, 4.893330357968807, 4.9198944345116615, 5.094130489975214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1523458895488404, "mean_inference_ms": 0.6508089113043313, "mean_action_processing_ms": 0.09614083023008188, "mean_env_wait_ms": 0.7920468099512008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 9183.353, "sample_throughput": 522.685, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1176.883, "learn_throughput": 4078.571, "update_time_ms": 1.8}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 15.33324944972992, "policy_loss": -0.003013175630993681, "vf_loss": 15.421223640441895, "vf_explained_var": -1.0, "kl": 0.015089780688882951, "entropy": 8.508071780204773, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 720000, "num_steps_trained": 240000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 29.104479044675813, "episode_reward_min": -314.89248040318495, "episode_reward_mean": -20.55027113393883, "episode_len_mean": 273.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.78161721428236}, "policy_reward_max": {"shared_policy": 9.856347930928067}, "policy_reward_mean": {"shared_policy": -6.850090377979609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.958712175488444, 7.563120837789015, 10.53481987863779, -5.299476198852091, 21.224869765341253, 29.104479044675813, 16.291184328496456, 3.6208782643079473, -314.89248040318495, 16.391180967912064], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 36, 300], "policy_shared_policy_reward": [3.353100548187882, 3.611838648716599, 2.993772978583962, 2.7412345868845733, 2.973262940378234, 1.8486233105262073, 3.44252298027277, 3.650199495255947, 3.4420974031090736, -1.686621283491462, -1.7638266955812867, -1.849028219779342, 7.100375833610684, 7.054923827449471, 7.069570104281098, 9.803268206616238, 9.856347930928067, 9.444862907131508, 5.354457564651966, 5.4019405990839005, 5.53478616476059, 1.3224978099266593, 1.4486213127771919, 0.8497591416040962, -101.90307061870894, -111.78161721428236, -101.20779257019362, 5.7895343036701234, 5.083785926302269, 5.517860737939671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13622315991826417, "mean_inference_ms": 0.6105319661818849, "mean_action_processing_ms": 0.08634489559108079, "mean_env_wait_ms": 0.7920317463427075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 1721, "training_iteration": 50, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-50-29", "timestamp": 1706147429, "time_this_iter_s": 13.494958400726318, "time_total_s": 472.0158314704895, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 472.0158314704895, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 5.605263157894737, "ram_util_percent": 45.57368421052632}}
{"episode_reward_max": 48.17502404842524, "episode_reward_min": -349.44958862662315, "episode_reward_mean": -9.5250030102188, "episode_len_mean": 291.91, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -125.38690918684006}, "policy_reward_max": {"shared_policy": 16.132850213286773}, "policy_reward_mean": {"shared_policy": -3.175001003406268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9607514292001582, 22.80279294773935, 12.480709038674831, 5.371288180351229, 2.044962268322678, -9.588791050016908, -7.78182504326108, 4.017159443115787, 0.38555894047019024, 7.60051741078496, -17.322250004857793, -51.04694303870204, -1.5594528391957283, -7.601817570626764, -21.47533869743347, 0.8846204094588614, 5.647275455296025, -0.9579225629568242, 6.588199370948132, 10.76727944612503, 6.508183395490036, 0.040571335703106115, -0.597600214183359, 5.204579263925538, 13.125909179449081, 11.03305465728043, 4.583941526710959, -349.44958862662315, -311.30386620759964, 3.5827679596841193, -13.865985056385412, 11.407459537964286, 13.68376369588077, 12.410623990930617, -10.227593019604711, 10.057662114500985, -13.625057309865966, 23.940415821969495, 7.303466050885618, 12.689247682690606, -320.19864177703863, -26.13410698249936, 6.965610422194004, -1.5466335453093052, 20.171323698013992, 13.866476107388706, 24.504303008317947, 3.7473578825592853, -3.2412468418478966, -12.373804785311222, 10.202223530504824, -314.3575354665518, -4.148418620228767, 22.261152848601313, -13.630399025976672, 1.3102101087569906, 6.388229943811865, 14.775948733091354, 9.17536198720336, -0.24609877169133654, -7.020714692771463, -21.16924302279952, -7.691431306302576, 6.738158665597439, 24.855029955506325, 6.860997466370435, 15.475931912660585, 24.318519212305517, -41.466466307872935, 48.17502404842524, 3.7231500335037566, 9.642961703240857, -14.522907510399847, -13.049378983676448, 2.1253587659448243, 5.084130559116588, 3.303322687745066, 9.012750953435898, 18.19307526946065, -14.925970575772254, -13.323121611028924, 9.120067049749196, 10.186948582529993, 14.907355282455683, 10.060133488848777, 14.653084360063048, 11.259952552616568, 12.540509566664682, 21.3505671834573, -14.981044746935382, 4.352154485881329, 1.3836398646235182, -6.187015125528006, 18.28383622065303, 14.764243584126206, 17.96264772862196, 1.5012479461729384, 10.425347022712216, 3.9732541814446307, 10.393550761044011], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 39, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 202, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 43, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [0.8698149075110706, 0.5438332681854519, 0.5471032535036358, 7.480141331752137, 7.733347171296671, 7.589304444690541, 4.3338537737727165, 4.064829736948013, 4.082025527954102, 1.7451042334238593, 1.771117674807698, 1.8550662721196716, 0.6493902007738654, 0.6195706675449912, 0.7760014000038211, -3.3543756951888497, -3.3130246003468926, -2.921390754481166, -2.4214822476108964, -2.6654099722703393, -2.694932823379844, 1.3875231469670837, 1.8606033161437665, 0.7690329800049369, 0.23156030724445031, -0.03497985502085044, 0.18897848824659036, 2.686122614890337, 2.545924574136734, 2.368470221757889, -6.0394828567902294, -5.305573156724378, -5.977193991343185, -17.076171291371196, -17.135732462008804, -16.83503928532204, -0.4009261652827263, -0.5249401479959488, -0.6335865259170532, -2.3719668959577973, -2.7853241761525567, -2.44452649851641, -7.289658792316914, -6.937336705625057, -7.248343199491501, -0.18774044016997493, 0.6614121211071762, 0.4109487285216602, 2.127701741953686, 1.8303073098262104, 1.689266403516129, -0.0853855411211697, -0.321675563851997, -0.5508614579836575, 2.132816046476364, 2.5172164155519567, 1.9381669089198112, 3.698996290564537, 3.687426507472992, 3.3808566480875015, 2.078509976466492, 2.08867323895295, 2.341000180070594, -0.054688428839057224, -0.10248282303413703, 0.19774258757630037, -0.17026057591041877, -0.2034793620308335, -0.2238602762421067, 1.695942913492516, 1.8286088829239162, 1.680027467509106, 4.3325614631175995, 4.535473555326462, 4.25787416100502, 3.7182318580647262, 3.571884555121258, 3.7429382440944465, 1.5637118543187682, 1.4270145619908874, 1.593215110401303, -112.00404258072376, -112.05863685905933, -125.38690918684006, -111.99976235628128, -99.9754872918129, -99.32861655950546, 0.9443146934111866, 1.4982807648678573, 1.1401725014050754, -4.2497123486052, -4.593097845713302, -5.023174862066909, 3.78781936566034, 3.3314377019802635, 4.288202470323682, 4.615573659539223, 4.868128625676036, 4.200061410665512, 4.09552264213562, 4.411033445037901, 3.9040679037570953, -3.7916099478801186, -3.265200351675361, -3.170782720049232, 3.5721252684791835, 3.7291961734493526, 2.756340672572449, -4.600030372540161, -4.574259149531528, -4.450767787794277, 8.18389944483836, 7.824921121199921, 7.931595255931214, 2.631569568067789, 1.9103867262601852, 2.7615097565576434, 4.43006995817025, 4.2741875698169025, 3.9849901547034534, -102.81154291828474, -103.74981897075972, -113.63727988799414, -8.290611002594233, -9.02617409825325, -8.817321881651878, 2.443596124649048, 2.4515942111611366, 2.0704200863838196, -0.6317189410328865, -0.5208158567547798, -0.39409874752163887, 6.912816582868487, 6.621447118620068, 6.637059996525437, 4.502974192301423, 4.723637013385684, 4.6398649017016, 8.232577420771122, 8.378659091889858, 7.893066495656967, 1.476183151205376, 1.2613933061559948, 1.0097814251979145, -0.9805797338485718, -1.4823349863290787, -0.7783321216702461, -3.9096341654658318, -4.21783059835434, -4.246340021491051, 3.341933997968823, 3.1034939984480445, 3.7567955340879564, -113.79933019479117, -99.71749988694987, -100.84070538481078, -1.0192376673221588, -1.3526352792978287, -1.77654567360878, 7.6987549612919395, 6.9804775665203636, 7.58192032078901, -4.018662619094059, -5.0010068813959805, -4.610729525486633, 0.6458915869394843, 0.47742025057473825, 0.18689827124276803, 2.2209199617306297, 2.2491641814509933, 1.918145800630242, 4.89364293217659, 5.027376681566238, 4.854929119348526, 3.2386743016541004, 3.198873095214367, 2.7378145903348923, 0.09035848577816807, -0.2468959192434994, -0.0895613382260052, -2.399437067409366, -2.1786001076301034, -2.442677517731994, -6.969712232549995, -7.15999246140322, -7.039538328846305, -2.49344998349747, -2.636921492715686, -2.5610598300894196, 1.9289161562919617, 2.3900776095688343, 2.419164899736643, 8.26995324343443, 8.509512692689896, 8.075564019382, 2.0195282946030204, 2.3029393280545776, 2.538529843712837, 5.118102555473641, 5.313462962706879, 5.044366394480065, 8.219478073219449, 8.398448954025895, 7.700592185060174, -13.102592503263935, -13.724506681164115, -14.639367123444885, 15.925203514595822, 16.11697032054265, 16.132850213286773, 0.7764668663342746, 1.6900606912871154, 1.2566224758823665, 3.3090212841828617, 3.100476925571755, 3.2334634934862407, -4.537985151012748, -4.99290016790232, -4.992022191484779, -4.59378317991893, -4.141942570606872, -4.313653233150646, 0.712577578922108, 0.34864193697769963, 1.0641392500450166, 1.7507286307712349, 1.6402343784769329, 1.69316754986842, 1.0384361098209922, 1.360735932985932, 0.9041506449381416, 3.177202805876732, 2.972432240843773, 2.863115906715393, 6.032245414952428, 6.041460740069539, 6.119369114438683, -5.09147044767937, -5.114752953251212, -4.719747174841672, -4.644319402674839, -4.32975195969145, -4.3490502486626355, 2.89200209826231, 2.85376113653183, 3.3743038149550557, 3.1349605421225135, 3.5524363170067375, 3.4995517234007423, 4.893330357968807, 4.9198944345116615, 5.094130489975214, 3.372318121294171, 3.5442757426450555, 3.1435396249095504, 4.792470710972935, 4.879270086685807, 4.981343562404305, 3.8335609535376136, 3.8264329085747306, 3.5999586905042236, 4.202080597480133, 4.358265181382492, 3.9801637878020557, 7.077898108710841, 7.291896082771316, 6.980772991975144, -4.9215788493553845, -5.1161622355381695, -4.943303662041828, 1.8524733856320381, 1.1761577725410461, 1.3235233277082443, 0.3660835052529876, 0.5085184896985595, 0.5090378696719711, -2.2782791828115876, -2.0363648657997544, -1.8723710769166644, 5.978910960257053, 6.519666997046443, 5.785258263349533, 5.140153242895991, 4.852717685202748, 4.7713726560274665, 6.188401125371456, 6.258420377969742, 5.515826225280762, 0.5129167338212284, 0.7072035682698044, 0.2811276440819057, 3.4150339191158565, 3.4919484232862743, 3.5183646803100856, 1.5317373697956356, 1.2049279709656986, 1.2365888406832966, 3.3225144048531803, 3.636698273320988, 3.434338082869843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15194642927770136, "mean_inference_ms": 0.6502577909811705, "mean_action_processing_ms": 0.09611795637084768, "mean_env_wait_ms": 0.7921302223507876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 244800, "timesteps_this_iter": 0, "agent_timesteps_total": 734400, "timers": {"sample_time_ms": 9624.674, "sample_throughput": 498.718, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1173.894, "learn_throughput": 4088.955, "update_time_ms": 1.701}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 14.214828491210938, "policy_loss": -0.0025923237149901163, "vf_loss": 14.305400609970093, "vf_explained_var": -1.0, "kl": 0.014830971696956387, "entropy": 8.80962586402893, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 244800, "num_agent_steps_sampled": 734400, "num_steps_trained": 244800, "num_agent_steps_trained": 734400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1737, "training_iteration": 51, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-50-38", "timestamp": 1706147438, "time_this_iter_s": 9.044111490249634, "time_total_s": 481.05994296073914, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 481.05994296073914, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 5.107692307692307, "ram_util_percent": 45.5}}
{"episode_reward_max": 48.17502404842524, "episode_reward_min": -349.44958862662315, "episode_reward_mean": -11.323958084420601, "episode_len_mean": 289.93, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -125.38690918684006}, "policy_reward_max": {"shared_policy": 16.132850213286773}, "policy_reward_mean": {"shared_policy": -3.7746526948068695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9579225629568242, 6.588199370948132, 10.76727944612503, 6.508183395490036, 0.040571335703106115, -0.597600214183359, 5.204579263925538, 13.125909179449081, 11.03305465728043, 4.583941526710959, -349.44958862662315, -311.30386620759964, 3.5827679596841193, -13.865985056385412, 11.407459537964286, 13.68376369588077, 12.410623990930617, -10.227593019604711, 10.057662114500985, -13.625057309865966, 23.940415821969495, 7.303466050885618, 12.689247682690606, -320.19864177703863, -26.13410698249936, 6.965610422194004, -1.5466335453093052, 20.171323698013992, 13.866476107388706, 24.504303008317947, 3.7473578825592853, -3.2412468418478966, -12.373804785311222, 10.202223530504824, -314.3575354665518, -4.148418620228767, 22.261152848601313, -13.630399025976672, 1.3102101087569906, 6.388229943811865, 14.775948733091354, 9.17536198720336, -0.24609877169133654, -7.020714692771463, -21.16924302279952, -7.691431306302576, 6.738158665597439, 24.855029955506325, 6.860997466370435, 15.475931912660585, 24.318519212305517, -41.466466307872935, 48.17502404842524, 3.7231500335037566, 9.642961703240857, -14.522907510399847, -13.049378983676448, 2.1253587659448243, 5.084130559116588, 3.303322687745066, 9.012750953435898, 18.19307526946065, -14.925970575772254, -13.323121611028924, 9.120067049749196, 10.186948582529993, 14.907355282455683, 10.060133488848777, 14.653084360063048, 11.259952552616568, 12.540509566664682, 21.3505671834573, -14.981044746935382, 4.352154485881329, 1.3836398646235182, -6.187015125528006, 18.28383622065303, 14.764243584126206, 17.96264772862196, 1.5012479461729384, 10.425347022712216, 3.9732541814446307, 10.393550761044011, 12.561175890266867, 15.004015125334249, 8.774994678795323, 1.6094672605395317, -1.6934773772955083, -14.697246663272395, 4.2651223391294195, 18.42061327956617, 19.026544004678726, 6.885739371180534, 8.21039727330205, 14.999705318361507, -4.953575149178533, 20.66078714281319, -341.9638682687655, -7.304719910025611, 7.118035543709993], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 39, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 202, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 43, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 102, 300, 300], "policy_shared_policy_reward": [-0.0853855411211697, -0.321675563851997, -0.5508614579836575, 2.132816046476364, 2.5172164155519567, 1.9381669089198112, 3.698996290564537, 3.687426507472992, 3.3808566480875015, 2.078509976466492, 2.08867323895295, 2.341000180070594, -0.054688428839057224, -0.10248282303413703, 0.19774258757630037, -0.17026057591041877, -0.2034793620308335, -0.2238602762421067, 1.695942913492516, 1.8286088829239162, 1.680027467509106, 4.3325614631175995, 4.535473555326462, 4.25787416100502, 3.7182318580647262, 3.571884555121258, 3.7429382440944465, 1.5637118543187682, 1.4270145619908874, 1.593215110401303, -112.00404258072376, -112.05863685905933, -125.38690918684006, -111.99976235628128, -99.9754872918129, -99.32861655950546, 0.9443146934111866, 1.4982807648678573, 1.1401725014050754, -4.2497123486052, -4.593097845713302, -5.023174862066909, 3.78781936566034, 3.3314377019802635, 4.288202470323682, 4.615573659539223, 4.868128625676036, 4.200061410665512, 4.09552264213562, 4.411033445037901, 3.9040679037570953, -3.7916099478801186, -3.265200351675361, -3.170782720049232, 3.5721252684791835, 3.7291961734493526, 2.756340672572449, -4.600030372540161, -4.574259149531528, -4.450767787794277, 8.18389944483836, 7.824921121199921, 7.931595255931214, 2.631569568067789, 1.9103867262601852, 2.7615097565576434, 4.43006995817025, 4.2741875698169025, 3.9849901547034534, -102.81154291828474, -103.74981897075972, -113.63727988799414, -8.290611002594233, -9.02617409825325, -8.817321881651878, 2.443596124649048, 2.4515942111611366, 2.0704200863838196, -0.6317189410328865, -0.5208158567547798, -0.39409874752163887, 6.912816582868487, 6.621447118620068, 6.637059996525437, 4.502974192301423, 4.723637013385684, 4.6398649017016, 8.232577420771122, 8.378659091889858, 7.893066495656967, 1.476183151205376, 1.2613933061559948, 1.0097814251979145, -0.9805797338485718, -1.4823349863290787, -0.7783321216702461, -3.9096341654658318, -4.21783059835434, -4.246340021491051, 3.341933997968823, 3.1034939984480445, 3.7567955340879564, -113.79933019479117, -99.71749988694987, -100.84070538481078, -1.0192376673221588, -1.3526352792978287, -1.77654567360878, 7.6987549612919395, 6.9804775665203636, 7.58192032078901, -4.018662619094059, -5.0010068813959805, -4.610729525486633, 0.6458915869394843, 0.47742025057473825, 0.18689827124276803, 2.2209199617306297, 2.2491641814509933, 1.918145800630242, 4.89364293217659, 5.027376681566238, 4.854929119348526, 3.2386743016541004, 3.198873095214367, 2.7378145903348923, 0.09035848577816807, -0.2468959192434994, -0.0895613382260052, -2.399437067409366, -2.1786001076301034, -2.442677517731994, -6.969712232549995, -7.15999246140322, -7.039538328846305, -2.49344998349747, -2.636921492715686, -2.5610598300894196, 1.9289161562919617, 2.3900776095688343, 2.419164899736643, 8.26995324343443, 8.509512692689896, 8.075564019382, 2.0195282946030204, 2.3029393280545776, 2.538529843712837, 5.118102555473641, 5.313462962706879, 5.044366394480065, 8.219478073219449, 8.398448954025895, 7.700592185060174, -13.102592503263935, -13.724506681164115, -14.639367123444885, 15.925203514595822, 16.11697032054265, 16.132850213286773, 0.7764668663342746, 1.6900606912871154, 1.2566224758823665, 3.3090212841828617, 3.100476925571755, 3.2334634934862407, -4.537985151012748, -4.99290016790232, -4.992022191484779, -4.59378317991893, -4.141942570606872, -4.313653233150646, 0.712577578922108, 0.34864193697769963, 1.0641392500450166, 1.7507286307712349, 1.6402343784769329, 1.69316754986842, 1.0384361098209922, 1.360735932985932, 0.9041506449381416, 3.177202805876732, 2.972432240843773, 2.863115906715393, 6.032245414952428, 6.041460740069539, 6.119369114438683, -5.09147044767937, -5.114752953251212, -4.719747174841672, -4.644319402674839, -4.32975195969145, -4.3490502486626355, 2.89200209826231, 2.85376113653183, 3.3743038149550557, 3.1349605421225135, 3.5524363170067375, 3.4995517234007423, 4.893330357968807, 4.9198944345116615, 5.094130489975214, 3.372318121294171, 3.5442757426450555, 3.1435396249095504, 4.792470710972935, 4.879270086685807, 4.981343562404305, 3.8335609535376136, 3.8264329085747306, 3.5999586905042236, 4.202080597480133, 4.358265181382492, 3.9801637878020557, 7.077898108710841, 7.291896082771316, 6.980772991975144, -4.9215788493553845, -5.1161622355381695, -4.943303662041828, 1.8524733856320381, 1.1761577725410461, 1.3235233277082443, 0.3660835052529876, 0.5085184896985595, 0.5090378696719711, -2.2782791828115876, -2.0363648657997544, -1.8723710769166644, 5.978910960257053, 6.519666997046443, 5.785258263349533, 5.140153242895991, 4.852717685202748, 4.7713726560274665, 6.188401125371456, 6.258420377969742, 5.515826225280762, 0.5129167338212284, 0.7072035682698044, 0.2811276440819057, 3.4150339191158565, 3.4919484232862743, 3.5183646803100856, 1.5317373697956356, 1.2049279709656986, 1.2365888406832966, 3.3225144048531803, 3.636698273320988, 3.434338082869843, 4.453337910274655, 4.185098270575196, 3.9227397094170158, 5.210335207482174, 5.028395046790436, 4.765284871061638, 2.8047446509202274, 2.930567746361092, 3.039682281514004, 0.5413335785269737, 0.6014407649636269, 0.4666929170489311, -0.5433700072268692, -0.7492725203434674, -0.4008348497251717, -5.054106811682388, -4.699702846507236, -4.943437005082771, 1.468266720573098, 1.5539236615101402, 1.2429319570461814, 5.559013620018959, 6.308363251388073, 6.553236408159137, 6.4772787019610405, 6.107923209667206, 6.44134209305048, 2.1931268870830536, 2.209447830915451, 2.4831646531820297, 2.7603660101691787, 2.7955081636706893, 2.654523099462182, 4.9257558857401165, 5.296471015860632, 4.777478416760758, -1.5734041904409821, -1.406310838957637, -1.9738601197799142, 6.624551450212792, 7.053641227384404, 6.982594465215996, -111.14671117067337, -120.83757704496384, -109.9795800531283, -1.8229203919569699, -3.003945897022888, -2.477853621045753, 2.516078214161098, 2.102986253798008, 2.4989710757508874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15157602083162292, "mean_inference_ms": 0.6496962241508503, "mean_action_processing_ms": 0.09608127364653661, "mean_env_wait_ms": 0.7922981179842759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 249600, "timesteps_this_iter": 0, "agent_timesteps_total": 748800, "timers": {"sample_time_ms": 9614.588, "sample_throughput": 499.241, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1159.794, "learn_throughput": 4138.665, "update_time_ms": 1.701}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007910156250000001, "cur_lr": 0.0005, "total_loss": 112.97804069519043, "policy_loss": -0.0017178480693837428, "vf_loss": 113.07257747650146, "vf_explained_var": -0.024840176105499268, "kl": 0.037528199027315405, "entropy": 9.311715006828308, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 249600, "num_agent_steps_sampled": 748800, "num_steps_trained": 249600, "num_agent_steps_trained": 748800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1754, "training_iteration": 52, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-50-48", "timestamp": 1706147448, "time_this_iter_s": 9.142185688018799, "time_total_s": 490.20212864875793, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 490.20212864875793, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 10.415384615384616, "ram_util_percent": 45.51538461538462}}
{"episode_reward_max": 48.17502404842524, "episode_reward_min": -341.9638682687655, "episode_reward_mean": -4.8649678006812005, "episode_len_mean": 294.47, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -120.83757704496384}, "policy_reward_max": {"shared_policy": 16.132850213286773}, "policy_reward_mean": {"shared_policy": -1.6216559335604015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.410623990930617, -10.227593019604711, 10.057662114500985, -13.625057309865966, 23.940415821969495, 7.303466050885618, 12.689247682690606, -320.19864177703863, -26.13410698249936, 6.965610422194004, -1.5466335453093052, 20.171323698013992, 13.866476107388706, 24.504303008317947, 3.7473578825592853, -3.2412468418478966, -12.373804785311222, 10.202223530504824, -314.3575354665518, -4.148418620228767, 22.261152848601313, -13.630399025976672, 1.3102101087569906, 6.388229943811865, 14.775948733091354, 9.17536198720336, -0.24609877169133654, -7.020714692771463, -21.16924302279952, -7.691431306302576, 6.738158665597439, 24.855029955506325, 6.860997466370435, 15.475931912660585, 24.318519212305517, -41.466466307872935, 48.17502404842524, 3.7231500335037566, 9.642961703240857, -14.522907510399847, -13.049378983676448, 2.1253587659448243, 5.084130559116588, 3.303322687745066, 9.012750953435898, 18.19307526946065, -14.925970575772254, -13.323121611028924, 9.120067049749196, 10.186948582529993, 14.907355282455683, 10.060133488848777, 14.653084360063048, 11.259952552616568, 12.540509566664682, 21.3505671834573, -14.981044746935382, 4.352154485881329, 1.3836398646235182, -6.187015125528006, 18.28383622065303, 14.764243584126206, 17.96264772862196, 1.5012479461729384, 10.425347022712216, 3.9732541814446307, 10.393550761044011, 12.561175890266867, 15.004015125334249, 8.774994678795323, 1.6094672605395317, -1.6934773772955083, -14.697246663272395, 4.2651223391294195, 18.42061327956617, 19.026544004678726, 6.885739371180534, 8.21039727330205, 14.999705318361507, -4.953575149178533, 20.66078714281319, -341.9638682687655, -7.304719910025611, 7.118035543709993, 2.938057237770394, 11.221795655786991, 3.11174613237381, 1.424612369388342, 5.798730798065634, -0.6155903860926912, 7.483153685927363, 16.242784537374945, 9.973843201994868, -2.2874724194407747, -1.5597596541047238, -13.574728488922133, 9.84831974655387, -18.763155691325665, 5.152978140860782, 19.85446020914239], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 202, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 43, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 102, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [4.09552264213562, 4.411033445037901, 3.9040679037570953, -3.7916099478801186, -3.265200351675361, -3.170782720049232, 3.5721252684791835, 3.7291961734493526, 2.756340672572449, -4.600030372540161, -4.574259149531528, -4.450767787794277, 8.18389944483836, 7.824921121199921, 7.931595255931214, 2.631569568067789, 1.9103867262601852, 2.7615097565576434, 4.43006995817025, 4.2741875698169025, 3.9849901547034534, -102.81154291828474, -103.74981897075972, -113.63727988799414, -8.290611002594233, -9.02617409825325, -8.817321881651878, 2.443596124649048, 2.4515942111611366, 2.0704200863838196, -0.6317189410328865, -0.5208158567547798, -0.39409874752163887, 6.912816582868487, 6.621447118620068, 6.637059996525437, 4.502974192301423, 4.723637013385684, 4.6398649017016, 8.232577420771122, 8.378659091889858, 7.893066495656967, 1.476183151205376, 1.2613933061559948, 1.0097814251979145, -0.9805797338485718, -1.4823349863290787, -0.7783321216702461, -3.9096341654658318, -4.21783059835434, -4.246340021491051, 3.341933997968823, 3.1034939984480445, 3.7567955340879564, -113.79933019479117, -99.71749988694987, -100.84070538481078, -1.0192376673221588, -1.3526352792978287, -1.77654567360878, 7.6987549612919395, 6.9804775665203636, 7.58192032078901, -4.018662619094059, -5.0010068813959805, -4.610729525486633, 0.6458915869394843, 0.47742025057473825, 0.18689827124276803, 2.2209199617306297, 2.2491641814509933, 1.918145800630242, 4.89364293217659, 5.027376681566238, 4.854929119348526, 3.2386743016541004, 3.198873095214367, 2.7378145903348923, 0.09035848577816807, -0.2468959192434994, -0.0895613382260052, -2.399437067409366, -2.1786001076301034, -2.442677517731994, -6.969712232549995, -7.15999246140322, -7.039538328846305, -2.49344998349747, -2.636921492715686, -2.5610598300894196, 1.9289161562919617, 2.3900776095688343, 2.419164899736643, 8.26995324343443, 8.509512692689896, 8.075564019382, 2.0195282946030204, 2.3029393280545776, 2.538529843712837, 5.118102555473641, 5.313462962706879, 5.044366394480065, 8.219478073219449, 8.398448954025895, 7.700592185060174, -13.102592503263935, -13.724506681164115, -14.639367123444885, 15.925203514595822, 16.11697032054265, 16.132850213286773, 0.7764668663342746, 1.6900606912871154, 1.2566224758823665, 3.3090212841828617, 3.100476925571755, 3.2334634934862407, -4.537985151012748, -4.99290016790232, -4.992022191484779, -4.59378317991893, -4.141942570606872, -4.313653233150646, 0.712577578922108, 0.34864193697769963, 1.0641392500450166, 1.7507286307712349, 1.6402343784769329, 1.69316754986842, 1.0384361098209922, 1.360735932985932, 0.9041506449381416, 3.177202805876732, 2.972432240843773, 2.863115906715393, 6.032245414952428, 6.041460740069539, 6.119369114438683, -5.09147044767937, -5.114752953251212, -4.719747174841672, -4.644319402674839, -4.32975195969145, -4.3490502486626355, 2.89200209826231, 2.85376113653183, 3.3743038149550557, 3.1349605421225135, 3.5524363170067375, 3.4995517234007423, 4.893330357968807, 4.9198944345116615, 5.094130489975214, 3.372318121294171, 3.5442757426450555, 3.1435396249095504, 4.792470710972935, 4.879270086685807, 4.981343562404305, 3.8335609535376136, 3.8264329085747306, 3.5999586905042236, 4.202080597480133, 4.358265181382492, 3.9801637878020557, 7.077898108710841, 7.291896082771316, 6.980772991975144, -4.9215788493553845, -5.1161622355381695, -4.943303662041828, 1.8524733856320381, 1.1761577725410461, 1.3235233277082443, 0.3660835052529876, 0.5085184896985595, 0.5090378696719711, -2.2782791828115876, -2.0363648657997544, -1.8723710769166644, 5.978910960257053, 6.519666997046443, 5.785258263349533, 5.140153242895991, 4.852717685202748, 4.7713726560274665, 6.188401125371456, 6.258420377969742, 5.515826225280762, 0.5129167338212284, 0.7072035682698044, 0.2811276440819057, 3.4150339191158565, 3.4919484232862743, 3.5183646803100856, 1.5317373697956356, 1.2049279709656986, 1.2365888406832966, 3.3225144048531803, 3.636698273320988, 3.434338082869843, 4.453337910274655, 4.185098270575196, 3.9227397094170158, 5.210335207482174, 5.028395046790436, 4.765284871061638, 2.8047446509202274, 2.930567746361092, 3.039682281514004, 0.5413335785269737, 0.6014407649636269, 0.4666929170489311, -0.5433700072268692, -0.7492725203434674, -0.4008348497251717, -5.054106811682388, -4.699702846507236, -4.943437005082771, 1.468266720573098, 1.5539236615101402, 1.2429319570461814, 5.559013620018959, 6.308363251388073, 6.553236408159137, 6.4772787019610405, 6.107923209667206, 6.44134209305048, 2.1931268870830536, 2.209447830915451, 2.4831646531820297, 2.7603660101691787, 2.7955081636706893, 2.654523099462182, 4.9257558857401165, 5.296471015860632, 4.777478416760758, -1.5734041904409821, -1.406310838957637, -1.9738601197799142, 6.624551450212792, 7.053641227384404, 6.982594465215996, -111.14671117067337, -120.83757704496384, -109.9795800531283, -1.8229203919569699, -3.003945897022888, -2.477853621045753, 2.516078214161098, 2.102986253798008, 2.4989710757508874, 0.7098026325305256, 1.3333297062975618, 0.8949248989423069, 3.555471032857895, 3.986163057386875, 3.680161565542221, 1.1373087540268898, 1.1510100737214088, 0.8234273046255112, 0.37881602346897125, 0.23769651353359222, 0.8080998323857784, 1.8691226045290534, 2.087803589800984, 1.8418046037355964, -0.40887417395910575, -0.1303664793570931, -0.07634973277649237, 2.450785304109246, 2.515487002829701, 2.5168813789884155, 5.132279003659875, 5.433085987965256, 5.677419545749814, 3.3570991555849616, 3.342147293190152, 3.274596753219754, -0.5247809266050751, -1.3957955588897164, -0.3668959339459832, -0.6438204447428433, -0.6127120355765072, -0.30322717378537334, -4.613252545396492, -4.372393826643631, -4.589082116882011, 3.1924320409695213, 3.6333543087045257, 3.0225333968798225, -6.3085112273693085, -5.964545078575611, -6.490099385380745, 1.609234799941376, 2.078276732315615, 1.4654666086037906, 6.289693052570016, 7.046060728064418, 6.518706428507954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15124903774752568, "mean_inference_ms": 0.6491077196206685, "mean_action_processing_ms": 0.09602310935470916, "mean_env_wait_ms": 0.7924110864222156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 254400, "timesteps_this_iter": 0, "agent_timesteps_total": 763200, "timers": {"sample_time_ms": 9567.287, "sample_throughput": 501.71, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1157.701, "learn_throughput": 4146.149, "update_time_ms": 1.601}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.011865234375000002, "cur_lr": 0.0005, "total_loss": 10.72043001651764, "policy_loss": -0.0034501606633420834, "vf_loss": 10.818290948867798, "vf_explained_var": -1.0, "kl": 0.011436995206196558, "entropy": 9.45463490486145, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 254400, "num_agent_steps_sampled": 763200, "num_steps_trained": 254400, "num_agent_steps_trained": 763200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1770, "training_iteration": 53, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-50-57", "timestamp": 1706147457, "time_this_iter_s": 9.030221939086914, "time_total_s": 499.23235058784485, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021063471670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 499.23235058784485, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 8.674999999999999, "ram_util_percent": 45.57500000000001}}
{"episode_reward_max": 48.17502404842524, "episode_reward_min": -341.9638682687655, "episode_reward_mean": -1.1500051658271848, "episode_len_mean": 295.45, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -120.83757704496384}, "policy_reward_max": {"shared_policy": 16.132850213286773}, "policy_reward_mean": {"shared_policy": -0.38333505527572875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.373804785311222, 10.202223530504824, -314.3575354665518, -4.148418620228767, 22.261152848601313, -13.630399025976672, 1.3102101087569906, 6.388229943811865, 14.775948733091354, 9.17536198720336, -0.24609877169133654, -7.020714692771463, -21.16924302279952, -7.691431306302576, 6.738158665597439, 24.855029955506325, 6.860997466370435, 15.475931912660585, 24.318519212305517, -41.466466307872935, 48.17502404842524, 3.7231500335037566, 9.642961703240857, -14.522907510399847, -13.049378983676448, 2.1253587659448243, 5.084130559116588, 3.303322687745066, 9.012750953435898, 18.19307526946065, -14.925970575772254, -13.323121611028924, 9.120067049749196, 10.186948582529993, 14.907355282455683, 10.060133488848777, 14.653084360063048, 11.259952552616568, 12.540509566664682, 21.3505671834573, -14.981044746935382, 4.352154485881329, 1.3836398646235182, -6.187015125528006, 18.28383622065303, 14.764243584126206, 17.96264772862196, 1.5012479461729384, 10.425347022712216, 3.9732541814446307, 10.393550761044011, 12.561175890266867, 15.004015125334249, 8.774994678795323, 1.6094672605395317, -1.6934773772955083, -14.697246663272395, 4.2651223391294195, 18.42061327956617, 19.026544004678726, 6.885739371180534, 8.21039727330205, 14.999705318361507, -4.953575149178533, 20.66078714281319, -341.9638682687655, -7.304719910025611, 7.118035543709993, 2.938057237770394, 11.221795655786991, 3.11174613237381, 1.424612369388342, 5.798730798065634, -0.6155903860926912, 7.483153685927363, 16.242784537374945, 9.973843201994868, -2.2874724194407747, -1.5597596541047238, -13.574728488922133, 9.84831974655387, -18.763155691325665, 5.152978140860782, 19.85446020914239, 1.7883230671286299, 9.122148882597656, 22.45302795618771, 12.78139413520691, 17.360370874404907, 0.2043523956090212, 2.833588525652857, -10.138470724225058, 4.674623746424899, -0.3811205103993558, 16.17061127722262, 16.118200652301283, 13.811743661761255, 12.051426915451856, 14.07345354557036, -0.7442036122083948], "episode_lengths": [300, 300, 43, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 102, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-3.9096341654658318, -4.21783059835434, -4.246340021491051, 3.341933997968823, 3.1034939984480445, 3.7567955340879564, -113.79933019479117, -99.71749988694987, -100.84070538481078, -1.0192376673221588, -1.3526352792978287, -1.77654567360878, 7.6987549612919395, 6.9804775665203636, 7.58192032078901, -4.018662619094059, -5.0010068813959805, -4.610729525486633, 0.6458915869394843, 0.47742025057473825, 0.18689827124276803, 2.2209199617306297, 2.2491641814509933, 1.918145800630242, 4.89364293217659, 5.027376681566238, 4.854929119348526, 3.2386743016541004, 3.198873095214367, 2.7378145903348923, 0.09035848577816807, -0.2468959192434994, -0.0895613382260052, -2.399437067409366, -2.1786001076301034, -2.442677517731994, -6.969712232549995, -7.15999246140322, -7.039538328846305, -2.49344998349747, -2.636921492715686, -2.5610598300894196, 1.9289161562919617, 2.3900776095688343, 2.419164899736643, 8.26995324343443, 8.509512692689896, 8.075564019382, 2.0195282946030204, 2.3029393280545776, 2.538529843712837, 5.118102555473641, 5.313462962706879, 5.044366394480065, 8.219478073219449, 8.398448954025895, 7.700592185060174, -13.102592503263935, -13.724506681164115, -14.639367123444885, 15.925203514595822, 16.11697032054265, 16.132850213286773, 0.7764668663342746, 1.6900606912871154, 1.2566224758823665, 3.3090212841828617, 3.100476925571755, 3.2334634934862407, -4.537985151012748, -4.99290016790232, -4.992022191484779, -4.59378317991893, -4.141942570606872, -4.313653233150646, 0.712577578922108, 0.34864193697769963, 1.0641392500450166, 1.7507286307712349, 1.6402343784769329, 1.69316754986842, 1.0384361098209922, 1.360735932985932, 0.9041506449381416, 3.177202805876732, 2.972432240843773, 2.863115906715393, 6.032245414952428, 6.041460740069539, 6.119369114438683, -5.09147044767937, -5.114752953251212, -4.719747174841672, -4.644319402674839, -4.32975195969145, -4.3490502486626355, 2.89200209826231, 2.85376113653183, 3.3743038149550557, 3.1349605421225135, 3.5524363170067375, 3.4995517234007423, 4.893330357968807, 4.9198944345116615, 5.094130489975214, 3.372318121294171, 3.5442757426450555, 3.1435396249095504, 4.792470710972935, 4.879270086685807, 4.981343562404305, 3.8335609535376136, 3.8264329085747306, 3.5999586905042236, 4.202080597480133, 4.358265181382492, 3.9801637878020557, 7.077898108710841, 7.291896082771316, 6.980772991975144, -4.9215788493553845, -5.1161622355381695, -4.943303662041828, 1.8524733856320381, 1.1761577725410461, 1.3235233277082443, 0.3660835052529876, 0.5085184896985595, 0.5090378696719711, -2.2782791828115876, -2.0363648657997544, -1.8723710769166644, 5.978910960257053, 6.519666997046443, 5.785258263349533, 5.140153242895991, 4.852717685202748, 4.7713726560274665, 6.188401125371456, 6.258420377969742, 5.515826225280762, 0.5129167338212284, 0.7072035682698044, 0.2811276440819057, 3.4150339191158565, 3.4919484232862743, 3.5183646803100856, 1.5317373697956356, 1.2049279709656986, 1.2365888406832966, 3.3225144048531803, 3.636698273320988, 3.434338082869843, 4.453337910274655, 4.185098270575196, 3.9227397094170158, 5.210335207482174, 5.028395046790436, 4.765284871061638, 2.8047446509202274, 2.930567746361092, 3.039682281514004, 0.5413335785269737, 0.6014407649636269, 0.4666929170489311, -0.5433700072268692, -0.7492725203434674, -0.4008348497251717, -5.054106811682388, -4.699702846507236, -4.943437005082771, 1.468266720573098, 1.5539236615101402, 1.2429319570461814, 5.559013620018959, 6.308363251388073, 6.553236408159137, 6.4772787019610405, 6.107923209667206, 6.44134209305048, 2.1931268870830536, 2.209447830915451, 2.4831646531820297, 2.7603660101691787, 2.7955081636706893, 2.654523099462182, 4.9257558857401165, 5.296471015860632, 4.777478416760758, -1.5734041904409821, -1.406310838957637, -1.9738601197799142, 6.624551450212792, 7.053641227384404, 6.982594465215996, -111.14671117067337, -120.83757704496384, -109.9795800531283, -1.8229203919569699, -3.003945897022888, -2.477853621045753, 2.516078214161098, 2.102986253798008, 2.4989710757508874, 0.7098026325305256, 1.3333297062975618, 0.8949248989423069, 3.555471032857895, 3.986163057386875, 3.680161565542221, 1.1373087540268898, 1.1510100737214088, 0.8234273046255112, 0.37881602346897125, 0.23769651353359222, 0.8080998323857784, 1.8691226045290534, 2.087803589800984, 1.8418046037355964, -0.40887417395910575, -0.1303664793570931, -0.07634973277649237, 2.450785304109246, 2.515487002829701, 2.5168813789884155, 5.132279003659875, 5.433085987965256, 5.677419545749814, 3.3570991555849616, 3.342147293190152, 3.274596753219754, -0.5247809266050751, -1.3957955588897164, -0.3668959339459832, -0.6438204447428433, -0.6127120355765072, -0.30322717378537334, -4.613252545396492, -4.372393826643631, -4.589082116882011, 3.1924320409695213, 3.6333543087045257, 3.0225333968798225, -6.3085112273693085, -5.964545078575611, -6.490099385380745, 1.609234799941376, 2.078276732315615, 1.4654666086037906, 6.289693052570016, 7.046060728064418, 6.518706428507954, 0.78429193298021, 0.6501330907146041, 0.3538980434338157, 2.98185824106136, 2.8172373274962013, 3.323053314040095, 7.685518709321812, 7.667694275577858, 7.0998149712880405, 4.488730086634547, 4.216950731972844, 4.0757133165995185, 5.958572082221508, 5.866333223879337, 5.535465568304062, 0.32680189050734043, -0.30761781334877014, 0.1851683184504509, 1.010461422304303, 1.1514385516444747, 0.6716885517040794, -3.1796946401397435, -3.825757915774986, -3.133018168310329, 1.5766260301073345, 1.7744970781107696, 1.323500638206795, -0.11192561189334072, -0.4535485903422085, 0.18435369183619343, 5.386959714194134, 5.431215939422444, 5.352435623606041, 5.767605530718953, 5.43931748966375, 4.91127763191858, 4.753187457720429, 4.40743030110994, 4.651125902930886, 3.901118266085774, 3.823679539064557, 4.326629110301525, 4.859894712766007, 4.434079652031258, 4.7794791807730945, -0.15937471886476828, -0.5184211035569604, -0.06640778978666617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15090764194778816, "mean_inference_ms": 0.6485145173373011, "mean_action_processing_ms": 0.09594232021645328, "mean_env_wait_ms": 0.792496818539671, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 259200, "timesteps_this_iter": 0, "agent_timesteps_total": 777600, "timers": {"sample_time_ms": 9547.719, "sample_throughput": 502.738, "load_time_ms": 0.203, "load_throughput": 23685481.412, "learn_time_ms": 1160.499, "learn_throughput": 4136.152, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.011865234375000002, "cur_lr": 0.0005, "total_loss": 9.885290741920471, "policy_loss": -0.0034302465357339273, "vf_loss": 9.986045598983765, "vf_explained_var": -1.0, "kl": 0.011455548530680253, "entropy": 9.746065139770508, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 259200, "num_agent_steps_sampled": 777600, "num_steps_trained": 259200, "num_agent_steps_trained": 777600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1786, "training_iteration": 54, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-51-06", "timestamp": 1706147466, "time_this_iter_s": 9.002705574035645, "time_total_s": 508.2350561618805, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210005598B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 508.2350561618805, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 6.138461538461538, "ram_util_percent": 45.53076923076924}}
{"episode_reward_max": 48.17502404842524, "episode_reward_min": -341.9638682687655, "episode_reward_mean": -0.7858956223083229, "episode_len_mean": 296.56, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -120.83757704496384}, "policy_reward_max": {"shared_policy": 16.132850213286773}, "policy_reward_mean": {"shared_policy": -0.26196520743610807}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.860997466370435, 15.475931912660585, 24.318519212305517, -41.466466307872935, 48.17502404842524, 3.7231500335037566, 9.642961703240857, -14.522907510399847, -13.049378983676448, 2.1253587659448243, 5.084130559116588, 3.303322687745066, 9.012750953435898, 18.19307526946065, -14.925970575772254, -13.323121611028924, 9.120067049749196, 10.186948582529993, 14.907355282455683, 10.060133488848777, 14.653084360063048, 11.259952552616568, 12.540509566664682, 21.3505671834573, -14.981044746935382, 4.352154485881329, 1.3836398646235182, -6.187015125528006, 18.28383622065303, 14.764243584126206, 17.96264772862196, 1.5012479461729384, 10.425347022712216, 3.9732541814446307, 10.393550761044011, 12.561175890266867, 15.004015125334249, 8.774994678795323, 1.6094672605395317, -1.6934773772955083, -14.697246663272395, 4.2651223391294195, 18.42061327956617, 19.026544004678726, 6.885739371180534, 8.21039727330205, 14.999705318361507, -4.953575149178533, 20.66078714281319, -341.9638682687655, -7.304719910025611, 7.118035543709993, 2.938057237770394, 11.221795655786991, 3.11174613237381, 1.424612369388342, 5.798730798065634, -0.6155903860926912, 7.483153685927363, 16.242784537374945, 9.973843201994868, -2.2874724194407747, -1.5597596541047238, -13.574728488922133, 9.84831974655387, -18.763155691325665, 5.152978140860782, 19.85446020914239, 1.7883230671286299, 9.122148882597656, 22.45302795618771, 12.78139413520691, 17.360370874404907, 0.2043523956090212, 2.833588525652857, -10.138470724225058, 4.674623746424899, -0.3811205103993558, 16.17061127722262, 16.118200652301283, 13.811743661761255, 12.051426915451856, 14.07345354557036, -0.7442036122083948, -9.264183834195137, 12.234944771975279, 19.56576692312956, 8.738712899386869, 3.9714255221187926, 1.8993975222110606, -7.065162166953115, 17.137499734759317, -20.29867140389979, -3.0777794048190117, 18.5429683215916, -327.3237531632185, 3.8090399131178856, 4.484724298119517, 5.433001413941369, 22.69169308606068], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 102, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300], "policy_shared_policy_reward": [2.0195282946030204, 2.3029393280545776, 2.538529843712837, 5.118102555473641, 5.313462962706879, 5.044366394480065, 8.219478073219449, 8.398448954025895, 7.700592185060174, -13.102592503263935, -13.724506681164115, -14.639367123444885, 15.925203514595822, 16.11697032054265, 16.132850213286773, 0.7764668663342746, 1.6900606912871154, 1.2566224758823665, 3.3090212841828617, 3.100476925571755, 3.2334634934862407, -4.537985151012748, -4.99290016790232, -4.992022191484779, -4.59378317991893, -4.141942570606872, -4.313653233150646, 0.712577578922108, 0.34864193697769963, 1.0641392500450166, 1.7507286307712349, 1.6402343784769329, 1.69316754986842, 1.0384361098209922, 1.360735932985932, 0.9041506449381416, 3.177202805876732, 2.972432240843773, 2.863115906715393, 6.032245414952428, 6.041460740069539, 6.119369114438683, -5.09147044767937, -5.114752953251212, -4.719747174841672, -4.644319402674839, -4.32975195969145, -4.3490502486626355, 2.89200209826231, 2.85376113653183, 3.3743038149550557, 3.1349605421225135, 3.5524363170067375, 3.4995517234007423, 4.893330357968807, 4.9198944345116615, 5.094130489975214, 3.372318121294171, 3.5442757426450555, 3.1435396249095504, 4.792470710972935, 4.879270086685807, 4.981343562404305, 3.8335609535376136, 3.8264329085747306, 3.5999586905042236, 4.202080597480133, 4.358265181382492, 3.9801637878020557, 7.077898108710841, 7.291896082771316, 6.980772991975144, -4.9215788493553845, -5.1161622355381695, -4.943303662041828, 1.8524733856320381, 1.1761577725410461, 1.3235233277082443, 0.3660835052529876, 0.5085184896985595, 0.5090378696719711, -2.2782791828115876, -2.0363648657997544, -1.8723710769166644, 5.978910960257053, 6.519666997046443, 5.785258263349533, 5.140153242895991, 4.852717685202748, 4.7713726560274665, 6.188401125371456, 6.258420377969742, 5.515826225280762, 0.5129167338212284, 0.7072035682698044, 0.2811276440819057, 3.4150339191158565, 3.4919484232862743, 3.5183646803100856, 1.5317373697956356, 1.2049279709656986, 1.2365888406832966, 3.3225144048531803, 3.636698273320988, 3.434338082869843, 4.453337910274655, 4.185098270575196, 3.9227397094170158, 5.210335207482174, 5.028395046790436, 4.765284871061638, 2.8047446509202274, 2.930567746361092, 3.039682281514004, 0.5413335785269737, 0.6014407649636269, 0.4666929170489311, -0.5433700072268692, -0.7492725203434674, -0.4008348497251717, -5.054106811682388, -4.699702846507236, -4.943437005082771, 1.468266720573098, 1.5539236615101402, 1.2429319570461814, 5.559013620018959, 6.308363251388073, 6.553236408159137, 6.4772787019610405, 6.107923209667206, 6.44134209305048, 2.1931268870830536, 2.209447830915451, 2.4831646531820297, 2.7603660101691787, 2.7955081636706893, 2.654523099462182, 4.9257558857401165, 5.296471015860632, 4.777478416760758, -1.5734041904409821, -1.406310838957637, -1.9738601197799142, 6.624551450212792, 7.053641227384404, 6.982594465215996, -111.14671117067337, -120.83757704496384, -109.9795800531283, -1.8229203919569699, -3.003945897022888, -2.477853621045753, 2.516078214161098, 2.102986253798008, 2.4989710757508874, 0.7098026325305256, 1.3333297062975618, 0.8949248989423069, 3.555471032857895, 3.986163057386875, 3.680161565542221, 1.1373087540268898, 1.1510100737214088, 0.8234273046255112, 0.37881602346897125, 0.23769651353359222, 0.8080998323857784, 1.8691226045290534, 2.087803589800984, 1.8418046037355964, -0.40887417395910575, -0.1303664793570931, -0.07634973277649237, 2.450785304109246, 2.515487002829701, 2.5168813789884155, 5.132279003659875, 5.433085987965256, 5.677419545749814, 3.3570991555849616, 3.342147293190152, 3.274596753219754, -0.5247809266050751, -1.3957955588897164, -0.3668959339459832, -0.6438204447428433, -0.6127120355765072, -0.30322717378537334, -4.613252545396492, -4.372393826643631, -4.589082116882011, 3.1924320409695213, 3.6333543087045257, 3.0225333968798225, -6.3085112273693085, -5.964545078575611, -6.490099385380745, 1.609234799941376, 2.078276732315615, 1.4654666086037906, 6.289693052570016, 7.046060728064418, 6.518706428507954, 0.78429193298021, 0.6501330907146041, 0.3538980434338157, 2.98185824106136, 2.8172373274962013, 3.323053314040095, 7.685518709321812, 7.667694275577858, 7.0998149712880405, 4.488730086634547, 4.216950731972844, 4.0757133165995185, 5.958572082221508, 5.866333223879337, 5.535465568304062, 0.32680189050734043, -0.30761781334877014, 0.1851683184504509, 1.010461422304303, 1.1514385516444747, 0.6716885517040794, -3.1796946401397435, -3.825757915774986, -3.133018168310329, 1.5766260301073345, 1.7744970781107696, 1.323500638206795, -0.11192561189334072, -0.4535485903422085, 0.18435369183619343, 5.386959714194134, 5.431215939422444, 5.352435623606041, 5.767605530718953, 5.43931748966375, 4.91127763191858, 4.753187457720429, 4.40743030110994, 4.651125902930886, 3.901118266085774, 3.823679539064557, 4.326629110301525, 4.859894712766007, 4.434079652031258, 4.7794791807730945, -0.15937471886476828, -0.5184211035569604, -0.06640778978666617, -3.058855138719082, -3.126918688416481, -3.078410007059574, 3.903712958097458, 4.113978419452906, 4.217253394424915, 6.309324994683266, 6.479438476264477, 6.777003452181816, 3.126106662054852, 3.0258615960677417, 2.586744641264275, 0.9972676833470615, 1.4378550102313312, 1.5363028285404, 0.5763780822356495, 0.6178063278396877, 0.7052131121357235, -2.228167538841575, -2.211506103475898, -2.6254885246356423, 5.713147354622677, 5.728327353795365, 5.696025026341275, -6.839937172830105, -6.388038160279393, -7.070696070790291, -0.8572942242026329, -0.8896417766809464, -1.3308434039354324, 6.562780299534396, 6.112392534812287, 5.867795487244919, -105.56246576209864, -106.16343145569166, -115.59785594542822, 1.3473127856850624, 1.0741559863090515, 1.3875711411237717, 1.7797004083792274, 1.4085987607637946, 1.2964251289764945, 1.5414419670899662, 1.7191155155499729, 2.17244393130143, 7.957618878417023, 7.751198483010128, 6.98287572463353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1505844654047079, "mean_inference_ms": 0.6478645242578247, "mean_action_processing_ms": 0.09586757341141336, "mean_env_wait_ms": 0.7925689762903625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"sample_time_ms": 9559.793, "sample_throughput": 502.103, "load_time_ms": 0.203, "load_throughput": 23685481.412, "learn_time_ms": 1160.605, "learn_throughput": 4135.773, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.011865234375000002, "cur_lr": 0.0005, "total_loss": 115.64515972137451, "policy_loss": -0.0021439926969955003, "vf_loss": 115.74588394165039, "vf_explained_var": -0.03526566922664642, "kl": 0.009960377145070056, "entropy": 9.869280219078064, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 792000, "num_steps_trained": 264000, "num_agent_steps_trained": 792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1802, "training_iteration": 55, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-51-15", "timestamp": 1706147475, "time_this_iter_s": 8.980875492095947, "time_total_s": 517.2159316539764, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021063262EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 517.2159316539764, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 5.338461538461539, "ram_util_percent": 45.5076923076923}}
{"episode_reward_max": 41.540897347033024, "episode_reward_min": -341.9638682687655, "episode_reward_mean": -0.03862827769336576, "episode_len_mean": 296.56, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -120.83757704496384}, "policy_reward_max": {"shared_policy": 13.972820840775967}, "policy_reward_mean": {"shared_policy": -0.012876092564455632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.120067049749196, 10.186948582529993, 14.907355282455683, 10.060133488848777, 14.653084360063048, 11.259952552616568, 12.540509566664682, 21.3505671834573, -14.981044746935382, 4.352154485881329, 1.3836398646235182, -6.187015125528006, 18.28383622065303, 14.764243584126206, 17.96264772862196, 1.5012479461729384, 10.425347022712216, 3.9732541814446307, 10.393550761044011, 12.561175890266867, 15.004015125334249, 8.774994678795323, 1.6094672605395317, -1.6934773772955083, -14.697246663272395, 4.2651223391294195, 18.42061327956617, 19.026544004678726, 6.885739371180534, 8.21039727330205, 14.999705318361507, -4.953575149178533, 20.66078714281319, -341.9638682687655, -7.304719910025611, 7.118035543709993, 2.938057237770394, 11.221795655786991, 3.11174613237381, 1.424612369388342, 5.798730798065634, -0.6155903860926912, 7.483153685927363, 16.242784537374945, 9.973843201994868, -2.2874724194407747, -1.5597596541047238, -13.574728488922133, 9.84831974655387, -18.763155691325665, 5.152978140860782, 19.85446020914239, 1.7883230671286299, 9.122148882597656, 22.45302795618771, 12.78139413520691, 17.360370874404907, 0.2043523956090212, 2.833588525652857, -10.138470724225058, 4.674623746424899, -0.3811205103993558, 16.17061127722262, 16.118200652301283, 13.811743661761255, 12.051426915451856, 14.07345354557036, -0.7442036122083948, -9.264183834195137, 12.234944771975279, 19.56576692312956, 8.738712899386869, 3.9714255221187926, 1.8993975222110606, -7.065162166953115, 17.137499734759317, -20.29867140389979, -3.0777794048190117, 18.5429683215916, -327.3237531632185, 3.8090399131178856, 4.484724298119517, 5.433001413941369, 22.69169308606068, 8.872727572917938, 23.85030791163443, 8.679256282746763, 7.886751614510985, 10.811633192002745, 11.26356575638053, -62.03530156612398, 7.842507105320678, 41.540897347033024, 18.188730388879776, 23.11187523603438, 8.721888706088038, 0.7192294001579285, 4.530148364603491, -0.6161126792431162, 9.98600745201108], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 102, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.89200209826231, 2.85376113653183, 3.3743038149550557, 3.1349605421225135, 3.5524363170067375, 3.4995517234007423, 4.893330357968807, 4.9198944345116615, 5.094130489975214, 3.372318121294171, 3.5442757426450555, 3.1435396249095504, 4.792470710972935, 4.879270086685807, 4.981343562404305, 3.8335609535376136, 3.8264329085747306, 3.5999586905042236, 4.202080597480133, 4.358265181382492, 3.9801637878020557, 7.077898108710841, 7.291896082771316, 6.980772991975144, -4.9215788493553845, -5.1161622355381695, -4.943303662041828, 1.8524733856320381, 1.1761577725410461, 1.3235233277082443, 0.3660835052529876, 0.5085184896985595, 0.5090378696719711, -2.2782791828115876, -2.0363648657997544, -1.8723710769166644, 5.978910960257053, 6.519666997046443, 5.785258263349533, 5.140153242895991, 4.852717685202748, 4.7713726560274665, 6.188401125371456, 6.258420377969742, 5.515826225280762, 0.5129167338212284, 0.7072035682698044, 0.2811276440819057, 3.4150339191158565, 3.4919484232862743, 3.5183646803100856, 1.5317373697956356, 1.2049279709656986, 1.2365888406832966, 3.3225144048531803, 3.636698273320988, 3.434338082869843, 4.453337910274655, 4.185098270575196, 3.9227397094170158, 5.210335207482174, 5.028395046790436, 4.765284871061638, 2.8047446509202274, 2.930567746361092, 3.039682281514004, 0.5413335785269737, 0.6014407649636269, 0.4666929170489311, -0.5433700072268692, -0.7492725203434674, -0.4008348497251717, -5.054106811682388, -4.699702846507236, -4.943437005082771, 1.468266720573098, 1.5539236615101402, 1.2429319570461814, 5.559013620018959, 6.308363251388073, 6.553236408159137, 6.4772787019610405, 6.107923209667206, 6.44134209305048, 2.1931268870830536, 2.209447830915451, 2.4831646531820297, 2.7603660101691787, 2.7955081636706893, 2.654523099462182, 4.9257558857401165, 5.296471015860632, 4.777478416760758, -1.5734041904409821, -1.406310838957637, -1.9738601197799142, 6.624551450212792, 7.053641227384404, 6.982594465215996, -111.14671117067337, -120.83757704496384, -109.9795800531283, -1.8229203919569699, -3.003945897022888, -2.477853621045753, 2.516078214161098, 2.102986253798008, 2.4989710757508874, 0.7098026325305256, 1.3333297062975618, 0.8949248989423069, 3.555471032857895, 3.986163057386875, 3.680161565542221, 1.1373087540268898, 1.1510100737214088, 0.8234273046255112, 0.37881602346897125, 0.23769651353359222, 0.8080998323857784, 1.8691226045290534, 2.087803589800984, 1.8418046037355964, -0.40887417395910575, -0.1303664793570931, -0.07634973277649237, 2.450785304109246, 2.515487002829701, 2.5168813789884155, 5.132279003659875, 5.433085987965256, 5.677419545749814, 3.3570991555849616, 3.342147293190152, 3.274596753219754, -0.5247809266050751, -1.3957955588897164, -0.3668959339459832, -0.6438204447428433, -0.6127120355765072, -0.30322717378537334, -4.613252545396492, -4.372393826643631, -4.589082116882011, 3.1924320409695213, 3.6333543087045257, 3.0225333968798225, -6.3085112273693085, -5.964545078575611, -6.490099385380745, 1.609234799941376, 2.078276732315615, 1.4654666086037906, 6.289693052570016, 7.046060728064418, 6.518706428507954, 0.78429193298021, 0.6501330907146041, 0.3538980434338157, 2.98185824106136, 2.8172373274962013, 3.323053314040095, 7.685518709321812, 7.667694275577858, 7.0998149712880405, 4.488730086634547, 4.216950731972844, 4.0757133165995185, 5.958572082221508, 5.866333223879337, 5.535465568304062, 0.32680189050734043, -0.30761781334877014, 0.1851683184504509, 1.010461422304303, 1.1514385516444747, 0.6716885517040794, -3.1796946401397435, -3.825757915774986, -3.133018168310329, 1.5766260301073345, 1.7744970781107696, 1.323500638206795, -0.11192561189334072, -0.4535485903422085, 0.18435369183619343, 5.386959714194134, 5.431215939422444, 5.352435623606041, 5.767605530718953, 5.43931748966375, 4.91127763191858, 4.753187457720429, 4.40743030110994, 4.651125902930886, 3.901118266085774, 3.823679539064557, 4.326629110301525, 4.859894712766007, 4.434079652031258, 4.7794791807730945, -0.15937471886476828, -0.5184211035569604, -0.06640778978666617, -3.058855138719082, -3.126918688416481, -3.078410007059574, 3.903712958097458, 4.113978419452906, 4.217253394424915, 6.309324994683266, 6.479438476264477, 6.777003452181816, 3.126106662054852, 3.0258615960677417, 2.586744641264275, 0.9972676833470615, 1.4378550102313312, 1.5363028285404, 0.5763780822356495, 0.6178063278396877, 0.7052131121357235, -2.228167538841575, -2.211506103475898, -2.6254885246356423, 5.713147354622677, 5.728327353795365, 5.696025026341275, -6.839937172830105, -6.388038160279393, -7.070696070790291, -0.8572942242026329, -0.8896417766809464, -1.3308434039354324, 6.562780299534396, 6.112392534812287, 5.867795487244919, -105.56246576209864, -106.16343145569166, -115.59785594542822, 1.3473127856850624, 1.0741559863090515, 1.3875711411237717, 1.7797004083792274, 1.4085987607637946, 1.2964251289764945, 1.5414419670899662, 1.7191155155499729, 2.17244393130143, 7.957618878417023, 7.751198483010128, 6.98287572463353, 3.367872253060341, 2.9227814227342606, 2.582073897123337, 8.199867879350975, 8.101762806375817, 7.548677225907639, 2.873251522580773, 3.1696127826968734, 2.636391977469117, 2.79736194262901, 2.900513256589562, 2.1888764152924125, 3.645602496961743, 3.568678977588803, 3.5973517174521987, 3.5959505538145606, 4.0636642898122375, 3.6039509127537315, -20.622909980515644, -20.9034901658694, -20.508901419738933, 2.3122147669394764, 2.894065791120127, 2.6362265472610744, 13.894697703421116, 13.972820840775967, 13.673378802835941, 6.069201648235321, 6.044877886772156, 6.074650853872299, 7.69725765784581, 7.71860997875531, 7.696007599433258, 2.948095577458531, 2.851856167117745, 2.9219369615117614, 0.25323720276355743, 0.329907551407814, 0.136084645986557, 1.8618794555465286, 1.6638886580864494, 1.004380250970513, -0.21023045976957633, -0.1321568687756951, -0.27372535069784476, 3.6040483216444557, 3.2327268073956077, 3.1492323229710166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15027428958602404, "mean_inference_ms": 0.6472227265785786, "mean_action_processing_ms": 0.0958021421719086, "mean_env_wait_ms": 0.7926266137001124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 268800, "timesteps_this_iter": 0, "agent_timesteps_total": 806400, "timers": {"sample_time_ms": 9561.549, "sample_throughput": 502.011, "load_time_ms": 0.303, "load_throughput": 15866229.963, "learn_time_ms": 1163.705, "learn_throughput": 4124.758, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.011865234375000002, "cur_lr": 0.0005, "total_loss": 7.307238340377808, "policy_loss": -0.0031996866616990083, "vf_loss": 7.4109673500061035, "vf_explained_var": -1.0, "kl": 0.007657543406858885, "entropy": 10.06198787689209, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 268800, "num_agent_steps_sampled": 806400, "num_steps_trained": 268800, "num_agent_steps_trained": 806400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1818, "training_iteration": 56, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-51-24", "timestamp": 1706147484, "time_this_iter_s": 9.068371295928955, "time_total_s": 526.2843029499054, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C22280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 526.2843029499054, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 6.93076923076923, "ram_util_percent": 45.43846153846153}}
{"episode_reward_max": 41.540897347033024, "episode_reward_min": -341.9638682687655, "episode_reward_mean": -4.504628149775102, "episode_len_mean": 293.8, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -120.83757704496384}, "policy_reward_max": {"shared_policy": 13.972820840775967}, "policy_reward_mean": {"shared_policy": -1.5015427165917015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.9732541814446307, 10.393550761044011, 12.561175890266867, 15.004015125334249, 8.774994678795323, 1.6094672605395317, -1.6934773772955083, -14.697246663272395, 4.2651223391294195, 18.42061327956617, 19.026544004678726, 6.885739371180534, 8.21039727330205, 14.999705318361507, -4.953575149178533, 20.66078714281319, -341.9638682687655, -7.304719910025611, 7.118035543709993, 2.938057237770394, 11.221795655786991, 3.11174613237381, 1.424612369388342, 5.798730798065634, -0.6155903860926912, 7.483153685927363, 16.242784537374945, 9.973843201994868, -2.2874724194407747, -1.5597596541047238, -13.574728488922133, 9.84831974655387, -18.763155691325665, 5.152978140860782, 19.85446020914239, 1.7883230671286299, 9.122148882597656, 22.45302795618771, 12.78139413520691, 17.360370874404907, 0.2043523956090212, 2.833588525652857, -10.138470724225058, 4.674623746424899, -0.3811205103993558, 16.17061127722262, 16.118200652301283, 13.811743661761255, 12.051426915451856, 14.07345354557036, -0.7442036122083948, -9.264183834195137, 12.234944771975279, 19.56576692312956, 8.738712899386869, 3.9714255221187926, 1.8993975222110606, -7.065162166953115, 17.137499734759317, -20.29867140389979, -3.0777794048190117, 18.5429683215916, -327.3237531632185, 3.8090399131178856, 4.484724298119517, 5.433001413941369, 22.69169308606068, 8.872727572917938, 23.85030791163443, 8.679256282746763, 7.886751614510985, 10.811633192002745, 11.26356575638053, -62.03530156612398, 7.842507105320678, 41.540897347033024, 18.188730388879776, 23.11187523603438, 8.721888706088038, 0.7192294001579285, 4.530148364603491, -0.6161126792431162, 9.98600745201108, 2.3240394741296484, 8.747134987264872, 15.820998791605206, 3.1163453236222267, 3.5125980097800493, -3.5236289203167104, -17.31303814798595, 4.173407413065419, -31.80848066136241, -1.1482644081115723, -305.23426131904125, 2.330861739814253, 5.584139497950659, -0.5156552381813526, 7.056607952341437, 10.006225366145372, 1.8546579778194285], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 102, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 24, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [1.5317373697956356, 1.2049279709656986, 1.2365888406832966, 3.3225144048531803, 3.636698273320988, 3.434338082869843, 4.453337910274655, 4.185098270575196, 3.9227397094170158, 5.210335207482174, 5.028395046790436, 4.765284871061638, 2.8047446509202274, 2.930567746361092, 3.039682281514004, 0.5413335785269737, 0.6014407649636269, 0.4666929170489311, -0.5433700072268692, -0.7492725203434674, -0.4008348497251717, -5.054106811682388, -4.699702846507236, -4.943437005082771, 1.468266720573098, 1.5539236615101402, 1.2429319570461814, 5.559013620018959, 6.308363251388073, 6.553236408159137, 6.4772787019610405, 6.107923209667206, 6.44134209305048, 2.1931268870830536, 2.209447830915451, 2.4831646531820297, 2.7603660101691787, 2.7955081636706893, 2.654523099462182, 4.9257558857401165, 5.296471015860632, 4.777478416760758, -1.5734041904409821, -1.406310838957637, -1.9738601197799142, 6.624551450212792, 7.053641227384404, 6.982594465215996, -111.14671117067337, -120.83757704496384, -109.9795800531283, -1.8229203919569699, -3.003945897022888, -2.477853621045753, 2.516078214161098, 2.102986253798008, 2.4989710757508874, 0.7098026325305256, 1.3333297062975618, 0.8949248989423069, 3.555471032857895, 3.986163057386875, 3.680161565542221, 1.1373087540268898, 1.1510100737214088, 0.8234273046255112, 0.37881602346897125, 0.23769651353359222, 0.8080998323857784, 1.8691226045290534, 2.087803589800984, 1.8418046037355964, -0.40887417395910575, -0.1303664793570931, -0.07634973277649237, 2.450785304109246, 2.515487002829701, 2.5168813789884155, 5.132279003659875, 5.433085987965256, 5.677419545749814, 3.3570991555849616, 3.342147293190152, 3.274596753219754, -0.5247809266050751, -1.3957955588897164, -0.3668959339459832, -0.6438204447428433, -0.6127120355765072, -0.30322717378537334, -4.613252545396492, -4.372393826643631, -4.589082116882011, 3.1924320409695213, 3.6333543087045257, 3.0225333968798225, -6.3085112273693085, -5.964545078575611, -6.490099385380745, 1.609234799941376, 2.078276732315615, 1.4654666086037906, 6.289693052570016, 7.046060728064418, 6.518706428507954, 0.78429193298021, 0.6501330907146041, 0.3538980434338157, 2.98185824106136, 2.8172373274962013, 3.323053314040095, 7.685518709321812, 7.667694275577858, 7.0998149712880405, 4.488730086634547, 4.216950731972844, 4.0757133165995185, 5.958572082221508, 5.866333223879337, 5.535465568304062, 0.32680189050734043, -0.30761781334877014, 0.1851683184504509, 1.010461422304303, 1.1514385516444747, 0.6716885517040794, -3.1796946401397435, -3.825757915774986, -3.133018168310329, 1.5766260301073345, 1.7744970781107696, 1.323500638206795, -0.11192561189334072, -0.4535485903422085, 0.18435369183619343, 5.386959714194134, 5.431215939422444, 5.352435623606041, 5.767605530718953, 5.43931748966375, 4.91127763191858, 4.753187457720429, 4.40743030110994, 4.651125902930886, 3.901118266085774, 3.823679539064557, 4.326629110301525, 4.859894712766007, 4.434079652031258, 4.7794791807730945, -0.15937471886476828, -0.5184211035569604, -0.06640778978666617, -3.058855138719082, -3.126918688416481, -3.078410007059574, 3.903712958097458, 4.113978419452906, 4.217253394424915, 6.309324994683266, 6.479438476264477, 6.777003452181816, 3.126106662054852, 3.0258615960677417, 2.586744641264275, 0.9972676833470615, 1.4378550102313312, 1.5363028285404, 0.5763780822356495, 0.6178063278396877, 0.7052131121357235, -2.228167538841575, -2.211506103475898, -2.6254885246356423, 5.713147354622677, 5.728327353795365, 5.696025026341275, -6.839937172830105, -6.388038160279393, -7.070696070790291, -0.8572942242026329, -0.8896417766809464, -1.3308434039354324, 6.562780299534396, 6.112392534812287, 5.867795487244919, -105.56246576209864, -106.16343145569166, -115.59785594542822, 1.3473127856850624, 1.0741559863090515, 1.3875711411237717, 1.7797004083792274, 1.4085987607637946, 1.2964251289764945, 1.5414419670899662, 1.7191155155499729, 2.17244393130143, 7.957618878417023, 7.751198483010128, 6.98287572463353, 3.367872253060341, 2.9227814227342606, 2.582073897123337, 8.199867879350975, 8.101762806375817, 7.548677225907639, 2.873251522580773, 3.1696127826968734, 2.636391977469117, 2.79736194262901, 2.900513256589562, 2.1888764152924125, 3.645602496961743, 3.568678977588803, 3.5973517174521987, 3.5959505538145606, 4.0636642898122375, 3.6039509127537315, -20.622909980515644, -20.9034901658694, -20.508901419738933, 2.3122147669394764, 2.894065791120127, 2.6362265472610744, 13.894697703421116, 13.972820840775967, 13.673378802835941, 6.069201648235321, 6.044877886772156, 6.074650853872299, 7.69725765784581, 7.71860997875531, 7.696007599433258, 2.948095577458531, 2.851856167117745, 2.9219369615117614, 0.25323720276355743, 0.329907551407814, 0.136084645986557, 1.8618794555465286, 1.6638886580864494, 1.004380250970513, -0.21023045976957633, -0.1321568687756951, -0.27372535069784476, 3.6040483216444557, 3.2327268073956077, 3.1492323229710166, 0.6341310168305938, 0.7175441409150665, 0.9723643163839881, 2.994233176112175, 2.6839824318885803, 3.0689193792641163, 5.051957617203385, 5.469456954548747, 5.299584219853074, 1.1465481519699097, 0.8990177735686302, 1.0707793980836868, 0.940831869840622, 0.8640674948692322, 1.7076986450701952, -1.1670693705479351, -1.0485666940609661, -1.307992855707809, -5.593025224904224, -5.810332621137306, -5.9096803019444195, 1.513412361343697, 1.3604402442773136, 1.2995548074444088, -10.341041523963213, -10.475033901631832, -10.992405235767365, -0.704704150557518, -0.12973152101039886, -0.3138287365436554, -100.63390071690083, -102.23746332526207, -102.36289727687836, 0.6868962372342651, 0.8508295367161338, 0.7931359658638542, 1.880293612678841, 1.5452795227368625, 2.1585663625349554, -0.08378877490758896, -0.5096891820430756, 0.0778227187693119, 2.668001538142562, 2.2065150812268257, 2.1820913329720497, 3.4604461416602135, 3.5285913310945034, 3.0171878933906555, 0.5208109070857319, 0.8119790007670673, 0.5218680699666294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14996524571659575, "mean_inference_ms": 0.6466811231719796, "mean_action_processing_ms": 0.09573888256426105, "mean_env_wait_ms": 0.7928142231191248, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 273600, "timesteps_this_iter": 0, "agent_timesteps_total": 820800, "timers": {"sample_time_ms": 9585.315, "sample_throughput": 500.766, "load_time_ms": 0.303, "load_throughput": 15866229.963, "learn_time_ms": 1162.498, "learn_throughput": 4129.04, "update_time_ms": 1.599}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.011865234375000002, "cur_lr": 0.0005, "total_loss": 40.33005619049072, "policy_loss": -0.0019050129333563204, "vf_loss": 40.434776306152344, "vf_explained_var": 0.052550993859767914, "kl": 0.023302093497516278, "entropy": 10.309083104133606, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 273600, "num_agent_steps_sampled": 820800, "num_steps_trained": 273600, "num_agent_steps_trained": 820800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1835, "training_iteration": 57, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-51-33", "timestamp": 1706147493, "time_this_iter_s": 9.503114938735962, "time_total_s": 535.7874178886414, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C229D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 535.7874178886414, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 7.184615384615384, "ram_util_percent": 45.88461538461539}}
{"episode_reward_max": 41.540897347033024, "episode_reward_min": -327.3237531632185, "episode_reward_mean": -7.704660727001042, "episode_len_mean": 293.02, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -115.59785594542822}, "policy_reward_max": {"shared_policy": 13.972820840775967}, "policy_reward_mean": {"shared_policy": -2.5682202423336804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.304719910025611, 7.118035543709993, 2.938057237770394, 11.221795655786991, 3.11174613237381, 1.424612369388342, 5.798730798065634, -0.6155903860926912, 7.483153685927363, 16.242784537374945, 9.973843201994868, -2.2874724194407747, -1.5597596541047238, -13.574728488922133, 9.84831974655387, -18.763155691325665, 5.152978140860782, 19.85446020914239, 1.7883230671286299, 9.122148882597656, 22.45302795618771, 12.78139413520691, 17.360370874404907, 0.2043523956090212, 2.833588525652857, -10.138470724225058, 4.674623746424899, -0.3811205103993558, 16.17061127722262, 16.118200652301283, 13.811743661761255, 12.051426915451856, 14.07345354557036, -0.7442036122083948, -9.264183834195137, 12.234944771975279, 19.56576692312956, 8.738712899386869, 3.9714255221187926, 1.8993975222110606, -7.065162166953115, 17.137499734759317, -20.29867140389979, -3.0777794048190117, 18.5429683215916, -327.3237531632185, 3.8090399131178856, 4.484724298119517, 5.433001413941369, 22.69169308606068, 8.872727572917938, 23.85030791163443, 8.679256282746763, 7.886751614510985, 10.811633192002745, 11.26356575638053, -62.03530156612398, 7.842507105320678, 41.540897347033024, 18.188730388879776, 23.11187523603438, 8.721888706088038, 0.7192294001579285, 4.530148364603491, -0.6161126792431162, 9.98600745201108, 2.3240394741296484, 8.747134987264872, 15.820998791605206, 3.1163453236222267, 3.5125980097800493, -3.5236289203167104, -17.31303814798595, 4.173407413065419, -31.80848066136241, -1.1482644081115723, -305.23426131904125, 2.330861739814253, 5.584139497950659, -0.5156552381813526, 7.056607952341437, 10.006225366145372, 1.8546579778194285, -313.3916246369481, 19.652498602867126, 16.456358551979037, 5.114291861653328, 4.796163050457807, 3.7432735580950975, 4.08421058952807, 0.36924336478112707, -1.8446825817227506, 26.940908685326562, -319.4891974441707, 2.368355721235247, 17.384407736361, 1.6328955367207243, 0.3652196228504181, -19.643498755991487, 12.935117982327924], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 24, 300, 300, 300, 300, 300, 300, 217, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-1.8229203919569699, -3.003945897022888, -2.477853621045753, 2.516078214161098, 2.102986253798008, 2.4989710757508874, 0.7098026325305256, 1.3333297062975618, 0.8949248989423069, 3.555471032857895, 3.986163057386875, 3.680161565542221, 1.1373087540268898, 1.1510100737214088, 0.8234273046255112, 0.37881602346897125, 0.23769651353359222, 0.8080998323857784, 1.8691226045290534, 2.087803589800984, 1.8418046037355964, -0.40887417395910575, -0.1303664793570931, -0.07634973277649237, 2.450785304109246, 2.515487002829701, 2.5168813789884155, 5.132279003659875, 5.433085987965256, 5.677419545749814, 3.3570991555849616, 3.342147293190152, 3.274596753219754, -0.5247809266050751, -1.3957955588897164, -0.3668959339459832, -0.6438204447428433, -0.6127120355765072, -0.30322717378537334, -4.613252545396492, -4.372393826643631, -4.589082116882011, 3.1924320409695213, 3.6333543087045257, 3.0225333968798225, -6.3085112273693085, -5.964545078575611, -6.490099385380745, 1.609234799941376, 2.078276732315615, 1.4654666086037906, 6.289693052570016, 7.046060728064418, 6.518706428507954, 0.78429193298021, 0.6501330907146041, 0.3538980434338157, 2.98185824106136, 2.8172373274962013, 3.323053314040095, 7.685518709321812, 7.667694275577858, 7.0998149712880405, 4.488730086634547, 4.216950731972844, 4.0757133165995185, 5.958572082221508, 5.866333223879337, 5.535465568304062, 0.32680189050734043, -0.30761781334877014, 0.1851683184504509, 1.010461422304303, 1.1514385516444747, 0.6716885517040794, -3.1796946401397435, -3.825757915774986, -3.133018168310329, 1.5766260301073345, 1.7744970781107696, 1.323500638206795, -0.11192561189334072, -0.4535485903422085, 0.18435369183619343, 5.386959714194134, 5.431215939422444, 5.352435623606041, 5.767605530718953, 5.43931748966375, 4.91127763191858, 4.753187457720429, 4.40743030110994, 4.651125902930886, 3.901118266085774, 3.823679539064557, 4.326629110301525, 4.859894712766007, 4.434079652031258, 4.7794791807730945, -0.15937471886476828, -0.5184211035569604, -0.06640778978666617, -3.058855138719082, -3.126918688416481, -3.078410007059574, 3.903712958097458, 4.113978419452906, 4.217253394424915, 6.309324994683266, 6.479438476264477, 6.777003452181816, 3.126106662054852, 3.0258615960677417, 2.586744641264275, 0.9972676833470615, 1.4378550102313312, 1.5363028285404, 0.5763780822356495, 0.6178063278396877, 0.7052131121357235, -2.228167538841575, -2.211506103475898, -2.6254885246356423, 5.713147354622677, 5.728327353795365, 5.696025026341275, -6.839937172830105, -6.388038160279393, -7.070696070790291, -0.8572942242026329, -0.8896417766809464, -1.3308434039354324, 6.562780299534396, 6.112392534812287, 5.867795487244919, -105.56246576209864, -106.16343145569166, -115.59785594542822, 1.3473127856850624, 1.0741559863090515, 1.3875711411237717, 1.7797004083792274, 1.4085987607637946, 1.2964251289764945, 1.5414419670899662, 1.7191155155499729, 2.17244393130143, 7.957618878417023, 7.751198483010128, 6.98287572463353, 3.367872253060341, 2.9227814227342606, 2.582073897123337, 8.199867879350975, 8.101762806375817, 7.548677225907639, 2.873251522580773, 3.1696127826968734, 2.636391977469117, 2.79736194262901, 2.900513256589562, 2.1888764152924125, 3.645602496961743, 3.568678977588803, 3.5973517174521987, 3.5959505538145606, 4.0636642898122375, 3.6039509127537315, -20.622909980515644, -20.9034901658694, -20.508901419738933, 2.3122147669394764, 2.894065791120127, 2.6362265472610744, 13.894697703421116, 13.972820840775967, 13.673378802835941, 6.069201648235321, 6.044877886772156, 6.074650853872299, 7.69725765784581, 7.71860997875531, 7.696007599433258, 2.948095577458531, 2.851856167117745, 2.9219369615117614, 0.25323720276355743, 0.329907551407814, 0.136084645986557, 1.8618794555465286, 1.6638886580864494, 1.004380250970513, -0.21023045976957633, -0.1321568687756951, -0.27372535069784476, 3.6040483216444557, 3.2327268073956077, 3.1492323229710166, 0.6341310168305938, 0.7175441409150665, 0.9723643163839881, 2.994233176112175, 2.6839824318885803, 3.0689193792641163, 5.051957617203385, 5.469456954548747, 5.299584219853074, 1.1465481519699097, 0.8990177735686302, 1.0707793980836868, 0.940831869840622, 0.8640674948692322, 1.7076986450701952, -1.1670693705479351, -1.0485666940609661, -1.307992855707809, -5.593025224904224, -5.810332621137306, -5.9096803019444195, 1.513412361343697, 1.3604402442773136, 1.2995548074444088, -10.341041523963213, -10.475033901631832, -10.992405235767365, -0.704704150557518, -0.12973152101039886, -0.3138287365436554, -100.63390071690083, -102.23746332526207, -102.36289727687836, 0.6868962372342651, 0.8508295367161338, 0.7931359658638542, 1.880293612678841, 1.5452795227368625, 2.1585663625349554, -0.08378877490758896, -0.5096891820430756, 0.0778227187693119, 2.668001538142562, 2.2065150812268257, 2.1820913329720497, 3.4604461416602135, 3.5285913310945034, 3.0171878933906555, 0.5208109070857319, 0.8119790007670673, 0.5218680699666294, -100.64646373937528, -101.56509063641231, -111.18007026116054, 6.7714796885848045, 6.599098883569241, 6.281920030713081, 5.395966062943131, 5.620551111797482, 5.439841377238423, 1.7147534936666489, 1.5277647450566292, 1.87177362293005, 1.9168475276480024, 1.207980299989373, 1.6713352228204315, 1.1617171168327332, 1.6655313093215227, 0.9160251319408417, 1.5144943719108852, 1.5691822295387539, 1.0005339880784305, -0.06188152233760036, 0.33312153195340954, 0.09800335516531788, -0.4478375116984097, -0.3782696897784916, -1.0185753802458493, 9.032568593819931, 8.878121001025036, 9.030219090481594, -102.32510461534063, -103.65577788154285, -113.50831494728725, 0.7747078041235511, 0.7225992629925315, 0.8710486541191642, 6.062614555160195, 6.2099177862207, 5.111875394980103, 0.44055399547019647, 0.5400309438506667, 0.6523105973998611, 0.14995840191841125, -0.2541686147451401, 0.4694298356771469, -6.575727594395488, -6.63987556596598, -6.427895595630019, 4.355475050707653, 4.186532949407891, 4.39310998221238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14964949290749163, "mean_inference_ms": 0.6461780674134099, "mean_action_processing_ms": 0.09568033409541261, "mean_env_wait_ms": 0.7929727914113552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 278400, "timesteps_this_iter": 0, "agent_timesteps_total": 835200, "timers": {"sample_time_ms": 9581.617, "sample_throughput": 500.959, "load_time_ms": 0.303, "load_throughput": 15866229.963, "learn_time_ms": 1161.998, "learn_throughput": 4130.815, "update_time_ms": 1.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 76.6569299697876, "policy_loss": -0.0014629568335415843, "vf_loss": 76.7619457244873, "vf_explained_var": -0.08065718412399292, "kl": 0.014268437971664187, "entropy": 10.380649447441101, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 278400, "num_agent_steps_sampled": 835200, "num_steps_trained": 278400, "num_agent_steps_trained": 835200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1852, "training_iteration": 58, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-51-42", "timestamp": 1706147502, "time_this_iter_s": 9.091976165771484, "time_total_s": 544.8793940544128, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C223A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 544.8793940544128, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 4.9692307692307685, "ram_util_percent": 46.0}}
{"episode_reward_max": 41.540897347033024, "episode_reward_min": -327.3237531632185, "episode_reward_mean": -6.659214763162902, "episode_len_mean": 293.02, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -115.59785594542822}, "policy_reward_max": {"shared_policy": 13.972820840775967}, "policy_reward_mean": {"shared_policy": -2.219738254387635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.152978140860782, 19.85446020914239, 1.7883230671286299, 9.122148882597656, 22.45302795618771, 12.78139413520691, 17.360370874404907, 0.2043523956090212, 2.833588525652857, -10.138470724225058, 4.674623746424899, -0.3811205103993558, 16.17061127722262, 16.118200652301283, 13.811743661761255, 12.051426915451856, 14.07345354557036, -0.7442036122083948, -9.264183834195137, 12.234944771975279, 19.56576692312956, 8.738712899386869, 3.9714255221187926, 1.8993975222110606, -7.065162166953115, 17.137499734759317, -20.29867140389979, -3.0777794048190117, 18.5429683215916, -327.3237531632185, 3.8090399131178856, 4.484724298119517, 5.433001413941369, 22.69169308606068, 8.872727572917938, 23.85030791163443, 8.679256282746763, 7.886751614510985, 10.811633192002745, 11.26356575638053, -62.03530156612398, 7.842507105320678, 41.540897347033024, 18.188730388879776, 23.11187523603438, 8.721888706088038, 0.7192294001579285, 4.530148364603491, -0.6161126792431162, 9.98600745201108, 2.3240394741296484, 8.747134987264872, 15.820998791605206, 3.1163453236222267, 3.5125980097800493, -3.5236289203167104, -17.31303814798595, 4.173407413065419, -31.80848066136241, -1.1482644081115723, -305.23426131904125, 2.330861739814253, 5.584139497950659, -0.5156552381813526, 7.056607952341437, 10.006225366145372, 1.8546579778194285, -313.3916246369481, 19.652498602867126, 16.456358551979037, 5.114291861653328, 4.796163050457807, 3.7432735580950975, 4.08421058952807, 0.36924336478112707, -1.8446825817227506, 26.940908685326562, -319.4891974441707, 2.368355721235247, 17.384407736361, 1.6328955367207243, 0.3652196228504181, -19.643498755991487, 12.935117982327924, 9.789717674255371, -20.68449506908658, 8.909316007047863, 5.474356397986398, 13.692964464426012, 9.51229557767509, 16.672884523868547, 13.099088091403246, -11.17419696599248, -8.036683470010786, 19.80755864083767, 15.209260374307618, 26.72392223402855, 17.396871186792836, 15.39408764988184, 3.8133014254271984], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 24, 300, 300, 300, 300, 300, 300, 217, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [1.609234799941376, 2.078276732315615, 1.4654666086037906, 6.289693052570016, 7.046060728064418, 6.518706428507954, 0.78429193298021, 0.6501330907146041, 0.3538980434338157, 2.98185824106136, 2.8172373274962013, 3.323053314040095, 7.685518709321812, 7.667694275577858, 7.0998149712880405, 4.488730086634547, 4.216950731972844, 4.0757133165995185, 5.958572082221508, 5.866333223879337, 5.535465568304062, 0.32680189050734043, -0.30761781334877014, 0.1851683184504509, 1.010461422304303, 1.1514385516444747, 0.6716885517040794, -3.1796946401397435, -3.825757915774986, -3.133018168310329, 1.5766260301073345, 1.7744970781107696, 1.323500638206795, -0.11192561189334072, -0.4535485903422085, 0.18435369183619343, 5.386959714194134, 5.431215939422444, 5.352435623606041, 5.767605530718953, 5.43931748966375, 4.91127763191858, 4.753187457720429, 4.40743030110994, 4.651125902930886, 3.901118266085774, 3.823679539064557, 4.326629110301525, 4.859894712766007, 4.434079652031258, 4.7794791807730945, -0.15937471886476828, -0.5184211035569604, -0.06640778978666617, -3.058855138719082, -3.126918688416481, -3.078410007059574, 3.903712958097458, 4.113978419452906, 4.217253394424915, 6.309324994683266, 6.479438476264477, 6.777003452181816, 3.126106662054852, 3.0258615960677417, 2.586744641264275, 0.9972676833470615, 1.4378550102313312, 1.5363028285404, 0.5763780822356495, 0.6178063278396877, 0.7052131121357235, -2.228167538841575, -2.211506103475898, -2.6254885246356423, 5.713147354622677, 5.728327353795365, 5.696025026341275, -6.839937172830105, -6.388038160279393, -7.070696070790291, -0.8572942242026329, -0.8896417766809464, -1.3308434039354324, 6.562780299534396, 6.112392534812287, 5.867795487244919, -105.56246576209864, -106.16343145569166, -115.59785594542822, 1.3473127856850624, 1.0741559863090515, 1.3875711411237717, 1.7797004083792274, 1.4085987607637946, 1.2964251289764945, 1.5414419670899662, 1.7191155155499729, 2.17244393130143, 7.957618878417023, 7.751198483010128, 6.98287572463353, 3.367872253060341, 2.9227814227342606, 2.582073897123337, 8.199867879350975, 8.101762806375817, 7.548677225907639, 2.873251522580773, 3.1696127826968734, 2.636391977469117, 2.79736194262901, 2.900513256589562, 2.1888764152924125, 3.645602496961743, 3.568678977588803, 3.5973517174521987, 3.5959505538145606, 4.0636642898122375, 3.6039509127537315, -20.622909980515644, -20.9034901658694, -20.508901419738933, 2.3122147669394764, 2.894065791120127, 2.6362265472610744, 13.894697703421116, 13.972820840775967, 13.673378802835941, 6.069201648235321, 6.044877886772156, 6.074650853872299, 7.69725765784581, 7.71860997875531, 7.696007599433258, 2.948095577458531, 2.851856167117745, 2.9219369615117614, 0.25323720276355743, 0.329907551407814, 0.136084645986557, 1.8618794555465286, 1.6638886580864494, 1.004380250970513, -0.21023045976957633, -0.1321568687756951, -0.27372535069784476, 3.6040483216444557, 3.2327268073956077, 3.1492323229710166, 0.6341310168305938, 0.7175441409150665, 0.9723643163839881, 2.994233176112175, 2.6839824318885803, 3.0689193792641163, 5.051957617203385, 5.469456954548747, 5.299584219853074, 1.1465481519699097, 0.8990177735686302, 1.0707793980836868, 0.940831869840622, 0.8640674948692322, 1.7076986450701952, -1.1670693705479351, -1.0485666940609661, -1.307992855707809, -5.593025224904224, -5.810332621137306, -5.9096803019444195, 1.513412361343697, 1.3604402442773136, 1.2995548074444088, -10.341041523963213, -10.475033901631832, -10.992405235767365, -0.704704150557518, -0.12973152101039886, -0.3138287365436554, -100.63390071690083, -102.23746332526207, -102.36289727687836, 0.6868962372342651, 0.8508295367161338, 0.7931359658638542, 1.880293612678841, 1.5452795227368625, 2.1585663625349554, -0.08378877490758896, -0.5096891820430756, 0.0778227187693119, 2.668001538142562, 2.2065150812268257, 2.1820913329720497, 3.4604461416602135, 3.5285913310945034, 3.0171878933906555, 0.5208109070857319, 0.8119790007670673, 0.5218680699666294, -100.64646373937528, -101.56509063641231, -111.18007026116054, 6.7714796885848045, 6.599098883569241, 6.281920030713081, 5.395966062943131, 5.620551111797482, 5.439841377238423, 1.7147534936666489, 1.5277647450566292, 1.87177362293005, 1.9168475276480024, 1.207980299989373, 1.6713352228204315, 1.1617171168327332, 1.6655313093215227, 0.9160251319408417, 1.5144943719108852, 1.5691822295387539, 1.0005339880784305, -0.06188152233760036, 0.33312153195340954, 0.09800335516531788, -0.4478375116984097, -0.3782696897784916, -1.0185753802458493, 9.032568593819931, 8.878121001025036, 9.030219090481594, -102.32510461534063, -103.65577788154285, -113.50831494728725, 0.7747078041235511, 0.7225992629925315, 0.8710486541191642, 6.062614555160195, 6.2099177862207, 5.111875394980103, 0.44055399547019647, 0.5400309438506667, 0.6523105973998611, 0.14995840191841125, -0.2541686147451401, 0.4694298356771469, -6.575727594395488, -6.63987556596598, -6.427895595630019, 4.355475050707653, 4.186532949407891, 4.39310998221238, 3.0252492278814316, 3.223580703139305, 3.5408877432346344, -6.89436221619448, -7.087680419286102, -6.702452433605998, 3.0194984624783103, 3.1921613651017253, 2.6976561794678275, 1.9568509807189258, 1.8474662502606662, 1.6700391670068058, 4.345693315068871, 4.778614925841481, 4.56865622351566, 3.203803879519299, 3.0156637554367336, 3.2928279427190574, 5.11709739764531, 5.8455768351753505, 5.710210291047886, 4.602153468877077, 4.429165869951248, 4.067768752574921, -3.6349338640769417, -3.9355396082004006, -3.603723493715137, -2.6740335201223786, -2.7663690497477944, -2.596280900140613, 6.55949179828167, 6.852073565125465, 6.395993277430534, 4.988063653310135, 5.166929704447583, 5.0542670165499, 8.889171103636414, 8.996807126949221, 8.837944003442914, 5.922104840477303, 5.890223917861775, 5.584542428453759, 5.058885984122753, 5.1913070902228355, 5.143894575536251, 1.5449363701045513, 1.483736276626587, 0.7846287786960602]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14933578933971078, "mean_inference_ms": 0.6457139662062936, "mean_action_processing_ms": 0.09564854258075549, "mean_env_wait_ms": 0.7931089184108692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 283200, "timesteps_this_iter": 0, "agent_timesteps_total": 849600, "timers": {"sample_time_ms": 9570.322, "sample_throughput": 501.55, "load_time_ms": 0.303, "load_throughput": 15866229.963, "learn_time_ms": 1155.599, "learn_throughput": 4153.69, "update_time_ms": 1.599}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 8.493072748184204, "policy_loss": -0.003396272361343211, "vf_loss": 8.60306692123413, "vf_explained_var": -1.0, "kl": 0.006585725765081501, "entropy": 10.671523332595825, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 283200, "num_agent_steps_sampled": 849600, "num_steps_trained": 283200, "num_agent_steps_trained": 849600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1868, "training_iteration": 59, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-51-51", "timestamp": 1706147511, "time_this_iter_s": 8.998645782470703, "time_total_s": 553.8780398368835, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 553.8780398368835, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 5.584615384615384, "ram_util_percent": 45.9153846153846}}
{"episode_reward_max": 41.540897347033024, "episode_reward_min": -349.41957998275757, "episode_reward_mean": -10.197990787216703, "episode_len_mean": 290.92, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -123.2469337284565}, "policy_reward_max": {"shared_policy": 13.972820840775967}, "policy_reward_mean": {"shared_policy": -3.39933026240557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.7442036122083948, -9.264183834195137, 12.234944771975279, 19.56576692312956, 8.738712899386869, 3.9714255221187926, 1.8993975222110606, -7.065162166953115, 17.137499734759317, -20.29867140389979, -3.0777794048190117, 18.5429683215916, -327.3237531632185, 3.8090399131178856, 4.484724298119517, 5.433001413941369, 22.69169308606068, 8.872727572917938, 23.85030791163443, 8.679256282746763, 7.886751614510985, 10.811633192002745, 11.26356575638053, -62.03530156612398, 7.842507105320678, 41.540897347033024, 18.188730388879776, 23.11187523603438, 8.721888706088038, 0.7192294001579285, 4.530148364603491, -0.6161126792431162, 9.98600745201108, 2.3240394741296484, 8.747134987264872, 15.820998791605206, 3.1163453236222267, 3.5125980097800493, -3.5236289203167104, -17.31303814798595, 4.173407413065419, -31.80848066136241, -1.1482644081115723, -305.23426131904125, 2.330861739814253, 5.584139497950659, -0.5156552381813526, 7.056607952341437, 10.006225366145372, 1.8546579778194285, -313.3916246369481, 19.652498602867126, 16.456358551979037, 5.114291861653328, 4.796163050457807, 3.7432735580950975, 4.08421058952807, 0.36924336478112707, -1.8446825817227506, 26.940908685326562, -319.4891974441707, 2.368355721235247, 17.384407736361, 1.6328955367207243, 0.3652196228504181, -19.643498755991487, 12.935117982327924, 9.789717674255371, -20.68449506908658, 8.909316007047863, 5.474356397986398, 13.692964464426012, 9.51229557767509, 16.672884523868547, 13.099088091403246, -11.17419696599248, -8.036683470010786, 19.80755864083767, 15.209260374307618, 26.72392223402855, 17.396871186792836, 15.39408764988184, 3.8133014254271984, -6.650284945964813, 21.686779066920252, -5.613769207149758, 6.585107695311294, 10.105835005640984, 10.38585451245308, 12.00135597959158, 7.327810183167443, -7.384354881942272, 4.565610215067835, -349.41957998275757, 16.732788994908304, 14.223809257149668, 26.01065630093214, 9.912337198853464, 3.421372167766066, 30.16218278557062], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 24, 300, 300, 300, 300, 300, 300, 217, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-0.15937471886476828, -0.5184211035569604, -0.06640778978666617, -3.058855138719082, -3.126918688416481, -3.078410007059574, 3.903712958097458, 4.113978419452906, 4.217253394424915, 6.309324994683266, 6.479438476264477, 6.777003452181816, 3.126106662054852, 3.0258615960677417, 2.586744641264275, 0.9972676833470615, 1.4378550102313312, 1.5363028285404, 0.5763780822356495, 0.6178063278396877, 0.7052131121357235, -2.228167538841575, -2.211506103475898, -2.6254885246356423, 5.713147354622677, 5.728327353795365, 5.696025026341275, -6.839937172830105, -6.388038160279393, -7.070696070790291, -0.8572942242026329, -0.8896417766809464, -1.3308434039354324, 6.562780299534396, 6.112392534812287, 5.867795487244919, -105.56246576209864, -106.16343145569166, -115.59785594542822, 1.3473127856850624, 1.0741559863090515, 1.3875711411237717, 1.7797004083792274, 1.4085987607637946, 1.2964251289764945, 1.5414419670899662, 1.7191155155499729, 2.17244393130143, 7.957618878417023, 7.751198483010128, 6.98287572463353, 3.367872253060341, 2.9227814227342606, 2.582073897123337, 8.199867879350975, 8.101762806375817, 7.548677225907639, 2.873251522580773, 3.1696127826968734, 2.636391977469117, 2.79736194262901, 2.900513256589562, 2.1888764152924125, 3.645602496961743, 3.568678977588803, 3.5973517174521987, 3.5959505538145606, 4.0636642898122375, 3.6039509127537315, -20.622909980515644, -20.9034901658694, -20.508901419738933, 2.3122147669394764, 2.894065791120127, 2.6362265472610744, 13.894697703421116, 13.972820840775967, 13.673378802835941, 6.069201648235321, 6.044877886772156, 6.074650853872299, 7.69725765784581, 7.71860997875531, 7.696007599433258, 2.948095577458531, 2.851856167117745, 2.9219369615117614, 0.25323720276355743, 0.329907551407814, 0.136084645986557, 1.8618794555465286, 1.6638886580864494, 1.004380250970513, -0.21023045976957633, -0.1321568687756951, -0.27372535069784476, 3.6040483216444557, 3.2327268073956077, 3.1492323229710166, 0.6341310168305938, 0.7175441409150665, 0.9723643163839881, 2.994233176112175, 2.6839824318885803, 3.0689193792641163, 5.051957617203385, 5.469456954548747, 5.299584219853074, 1.1465481519699097, 0.8990177735686302, 1.0707793980836868, 0.940831869840622, 0.8640674948692322, 1.7076986450701952, -1.1670693705479351, -1.0485666940609661, -1.307992855707809, -5.593025224904224, -5.810332621137306, -5.9096803019444195, 1.513412361343697, 1.3604402442773136, 1.2995548074444088, -10.341041523963213, -10.475033901631832, -10.992405235767365, -0.704704150557518, -0.12973152101039886, -0.3138287365436554, -100.63390071690083, -102.23746332526207, -102.36289727687836, 0.6868962372342651, 0.8508295367161338, 0.7931359658638542, 1.880293612678841, 1.5452795227368625, 2.1585663625349554, -0.08378877490758896, -0.5096891820430756, 0.0778227187693119, 2.668001538142562, 2.2065150812268257, 2.1820913329720497, 3.4604461416602135, 3.5285913310945034, 3.0171878933906555, 0.5208109070857319, 0.8119790007670673, 0.5218680699666294, -100.64646373937528, -101.56509063641231, -111.18007026116054, 6.7714796885848045, 6.599098883569241, 6.281920030713081, 5.395966062943131, 5.620551111797482, 5.439841377238423, 1.7147534936666489, 1.5277647450566292, 1.87177362293005, 1.9168475276480024, 1.207980299989373, 1.6713352228204315, 1.1617171168327332, 1.6655313093215227, 0.9160251319408417, 1.5144943719108852, 1.5691822295387539, 1.0005339880784305, -0.06188152233760036, 0.33312153195340954, 0.09800335516531788, -0.4478375116984097, -0.3782696897784916, -1.0185753802458493, 9.032568593819931, 8.878121001025036, 9.030219090481594, -102.32510461534063, -103.65577788154285, -113.50831494728725, 0.7747078041235511, 0.7225992629925315, 0.8710486541191642, 6.062614555160195, 6.2099177862207, 5.111875394980103, 0.44055399547019647, 0.5400309438506667, 0.6523105973998611, 0.14995840191841125, -0.2541686147451401, 0.4694298356771469, -6.575727594395488, -6.63987556596598, -6.427895595630019, 4.355475050707653, 4.186532949407891, 4.39310998221238, 3.0252492278814316, 3.223580703139305, 3.5408877432346344, -6.89436221619448, -7.087680419286102, -6.702452433605998, 3.0194984624783103, 3.1921613651017253, 2.6976561794678275, 1.9568509807189258, 1.8474662502606662, 1.6700391670068058, 4.345693315068871, 4.778614925841481, 4.56865622351566, 3.203803879519299, 3.0156637554367336, 3.2928279427190574, 5.11709739764531, 5.8455768351753505, 5.710210291047886, 4.602153468877077, 4.429165869951248, 4.067768752574921, -3.6349338640769417, -3.9355396082004006, -3.603723493715137, -2.6740335201223786, -2.7663690497477944, -2.596280900140613, 6.55949179828167, 6.852073565125465, 6.395993277430534, 4.988063653310135, 5.166929704447583, 5.0542670165499, 8.889171103636414, 8.996807126949221, 8.837944003442914, 5.922104840477303, 5.890223917861775, 5.584542428453759, 5.058885984122753, 5.1913070902228355, 5.143894575536251, 1.5449363701045513, 1.483736276626587, 0.7846287786960602, -1.9218676313757896, -1.7901915088295937, -2.93822580575943, 7.194290953377873, 6.988041299084813, 7.504446814457566, -1.7123553554217068, -1.6650239216784684, -2.236389930049583, 2.202447866400078, 2.474913419534758, 1.9077464093764576, 3.324291542172432, 3.3906996846199036, 3.390843778848648, 3.4661060720682144, 3.4930382072925568, 3.426710233092308, 3.792795600990445, 4.015781010190636, 4.192779368410498, 2.36501347025235, 2.5280495335658344, 2.4347471793492588, -2.247389443218708, -2.7222363650798798, -2.4147290736436844, 1.5838352094093864, 1.3636312137047355, 1.6181437919537132, -113.45532795786858, -123.2469337284565, -112.7173182964325, 5.595314035813004, 5.30164738992849, 5.83582756916681, 4.817608277002961, 4.601421038309724, 4.804779941836983, 8.645102741817624, 8.857651023815066, 8.50790253529945, 3.1524840692678993, 3.4473488802711074, 3.3125042493144576, 1.2858666206399505, 1.0035289923349922, 1.1319765547911231, 10.019676461815834, 10.046393796801567, 10.09611252695322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14901791749511792, "mean_inference_ms": 0.6452132336543613, "mean_action_processing_ms": 0.09560854275101287, "mean_env_wait_ms": 0.7932905967069768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"sample_time_ms": 9559.366, "sample_throughput": 502.125, "load_time_ms": 0.203, "load_throughput": 23691055.778, "learn_time_ms": 1156.899, "learn_throughput": 4149.023, "update_time_ms": 1.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 109.33403205871582, "policy_loss": -0.002048737110291972, "vf_loss": 109.44286823272705, "vf_explained_var": 0.002552509307861328, "kl": 0.007967930425413812, "entropy": 10.693098068237305, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 864000, "num_steps_trained": 288000, "num_agent_steps_trained": 864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1885, "training_iteration": 60, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-52-00", "timestamp": 1706147520, "time_this_iter_s": 9.005371570587158, "time_total_s": 562.8834114074707, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 562.8834114074707, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 7.453846153846153, "ram_util_percent": 45.892307692307696}}
{"episode_reward_max": 41.540897347033024, "episode_reward_min": -349.41957998275757, "episode_reward_mean": -5.719020607498253, "episode_len_mean": 292.38, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -123.2469337284565}, "policy_reward_max": {"shared_policy": 13.972820840775967}, "policy_reward_mean": {"shared_policy": -1.9063402024994185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.69169308606068, 8.872727572917938, 23.85030791163443, 8.679256282746763, 7.886751614510985, 10.811633192002745, 11.26356575638053, -62.03530156612398, 7.842507105320678, 41.540897347033024, 18.188730388879776, 23.11187523603438, 8.721888706088038, 0.7192294001579285, 4.530148364603491, -0.6161126792431162, 9.98600745201108, 2.3240394741296484, 8.747134987264872, 15.820998791605206, 3.1163453236222267, 3.5125980097800493, -3.5236289203167104, -17.31303814798595, 4.173407413065419, -31.80848066136241, -1.1482644081115723, -305.23426131904125, 2.330861739814253, 5.584139497950659, -0.5156552381813526, 7.056607952341437, 10.006225366145372, 1.8546579778194285, -313.3916246369481, 19.652498602867126, 16.456358551979037, 5.114291861653328, 4.796163050457807, 3.7432735580950975, 4.08421058952807, 0.36924336478112707, -1.8446825817227506, 26.940908685326562, -319.4891974441707, 2.368355721235247, 17.384407736361, 1.6328955367207243, 0.3652196228504181, -19.643498755991487, 12.935117982327924, 9.789717674255371, -20.68449506908658, 8.909316007047863, 5.474356397986398, 13.692964464426012, 9.51229557767509, 16.672884523868547, 13.099088091403246, -11.17419696599248, -8.036683470010786, 19.80755864083767, 15.209260374307618, 26.72392223402855, 17.396871186792836, 15.39408764988184, 3.8133014254271984, -6.650284945964813, 21.686779066920252, -5.613769207149758, 6.585107695311294, 10.105835005640984, 10.38585451245308, 12.00135597959158, 7.327810183167443, -7.384354881942272, 4.565610215067835, -349.41957998275757, 16.732788994908304, 14.223809257149668, 26.01065630093214, 9.912337198853464, 3.421372167766066, 30.16218278557062, 9.192336924374075, 19.55197690613565, 10.624088905751691, 4.600481332279742, 24.06375038996339, 30.097839891910525, 19.304464608430834, 3.3469879869371653, 8.555694542825208, 12.14152143150568, 0.08403091132640839, 14.189276503631831, -5.184490822255626, 9.149511802941547, 29.16854653134942, -12.94527214020492], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 24, 300, 300, 300, 300, 300, 300, 217, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [7.957618878417023, 7.751198483010128, 6.98287572463353, 3.367872253060341, 2.9227814227342606, 2.582073897123337, 8.199867879350975, 8.101762806375817, 7.548677225907639, 2.873251522580773, 3.1696127826968734, 2.636391977469117, 2.79736194262901, 2.900513256589562, 2.1888764152924125, 3.645602496961743, 3.568678977588803, 3.5973517174521987, 3.5959505538145606, 4.0636642898122375, 3.6039509127537315, -20.622909980515644, -20.9034901658694, -20.508901419738933, 2.3122147669394764, 2.894065791120127, 2.6362265472610744, 13.894697703421116, 13.972820840775967, 13.673378802835941, 6.069201648235321, 6.044877886772156, 6.074650853872299, 7.69725765784581, 7.71860997875531, 7.696007599433258, 2.948095577458531, 2.851856167117745, 2.9219369615117614, 0.25323720276355743, 0.329907551407814, 0.136084645986557, 1.8618794555465286, 1.6638886580864494, 1.004380250970513, -0.21023045976957633, -0.1321568687756951, -0.27372535069784476, 3.6040483216444557, 3.2327268073956077, 3.1492323229710166, 0.6341310168305938, 0.7175441409150665, 0.9723643163839881, 2.994233176112175, 2.6839824318885803, 3.0689193792641163, 5.051957617203385, 5.469456954548747, 5.299584219853074, 1.1465481519699097, 0.8990177735686302, 1.0707793980836868, 0.940831869840622, 0.8640674948692322, 1.7076986450701952, -1.1670693705479351, -1.0485666940609661, -1.307992855707809, -5.593025224904224, -5.810332621137306, -5.9096803019444195, 1.513412361343697, 1.3604402442773136, 1.2995548074444088, -10.341041523963213, -10.475033901631832, -10.992405235767365, -0.704704150557518, -0.12973152101039886, -0.3138287365436554, -100.63390071690083, -102.23746332526207, -102.36289727687836, 0.6868962372342651, 0.8508295367161338, 0.7931359658638542, 1.880293612678841, 1.5452795227368625, 2.1585663625349554, -0.08378877490758896, -0.5096891820430756, 0.0778227187693119, 2.668001538142562, 2.2065150812268257, 2.1820913329720497, 3.4604461416602135, 3.5285913310945034, 3.0171878933906555, 0.5208109070857319, 0.8119790007670673, 0.5218680699666294, -100.64646373937528, -101.56509063641231, -111.18007026116054, 6.7714796885848045, 6.599098883569241, 6.281920030713081, 5.395966062943131, 5.620551111797482, 5.439841377238423, 1.7147534936666489, 1.5277647450566292, 1.87177362293005, 1.9168475276480024, 1.207980299989373, 1.6713352228204315, 1.1617171168327332, 1.6655313093215227, 0.9160251319408417, 1.5144943719108852, 1.5691822295387539, 1.0005339880784305, -0.06188152233760036, 0.33312153195340954, 0.09800335516531788, -0.4478375116984097, -0.3782696897784916, -1.0185753802458493, 9.032568593819931, 8.878121001025036, 9.030219090481594, -102.32510461534063, -103.65577788154285, -113.50831494728725, 0.7747078041235511, 0.7225992629925315, 0.8710486541191642, 6.062614555160195, 6.2099177862207, 5.111875394980103, 0.44055399547019647, 0.5400309438506667, 0.6523105973998611, 0.14995840191841125, -0.2541686147451401, 0.4694298356771469, -6.575727594395488, -6.63987556596598, -6.427895595630019, 4.355475050707653, 4.186532949407891, 4.39310998221238, 3.0252492278814316, 3.223580703139305, 3.5408877432346344, -6.89436221619448, -7.087680419286102, -6.702452433605998, 3.0194984624783103, 3.1921613651017253, 2.6976561794678275, 1.9568509807189258, 1.8474662502606662, 1.6700391670068058, 4.345693315068871, 4.778614925841481, 4.56865622351566, 3.203803879519299, 3.0156637554367336, 3.2928279427190574, 5.11709739764531, 5.8455768351753505, 5.710210291047886, 4.602153468877077, 4.429165869951248, 4.067768752574921, -3.6349338640769417, -3.9355396082004006, -3.603723493715137, -2.6740335201223786, -2.7663690497477944, -2.596280900140613, 6.55949179828167, 6.852073565125465, 6.395993277430534, 4.988063653310135, 5.166929704447583, 5.0542670165499, 8.889171103636414, 8.996807126949221, 8.837944003442914, 5.922104840477303, 5.890223917861775, 5.584542428453759, 5.058885984122753, 5.1913070902228355, 5.143894575536251, 1.5449363701045513, 1.483736276626587, 0.7846287786960602, -1.9218676313757896, -1.7901915088295937, -2.93822580575943, 7.194290953377873, 6.988041299084813, 7.504446814457566, -1.7123553554217068, -1.6650239216784684, -2.236389930049583, 2.202447866400078, 2.474913419534758, 1.9077464093764576, 3.324291542172432, 3.3906996846199036, 3.390843778848648, 3.4661060720682144, 3.4930382072925568, 3.426710233092308, 3.792795600990445, 4.015781010190636, 4.192779368410498, 2.36501347025235, 2.5280495335658344, 2.4347471793492588, -2.247389443218708, -2.7222363650798798, -2.4147290736436844, 1.5838352094093864, 1.3636312137047355, 1.6181437919537132, -113.45532795786858, -123.2469337284565, -112.7173182964325, 5.595314035813004, 5.30164738992849, 5.83582756916681, 4.817608277002961, 4.601421038309724, 4.804779941836983, 8.645102741817624, 8.857651023815066, 8.50790253529945, 3.1524840692678993, 3.4473488802711074, 3.3125042493144576, 1.2858666206399505, 1.0035289923349922, 1.1319765547911231, 10.019676461815834, 10.046393796801567, 10.09611252695322, 3.159980828563363, 3.1098475853601997, 2.9225085104505126, 6.212794090310723, 6.831431564564497, 6.50775125126043, 3.37378268440564, 3.285293777783707, 3.965012443562344, 1.2165047079324722, 1.8093475783243775, 1.574629046022892, 8.022097043693066, 8.241541843861341, 7.800111502408981, 9.889472047487885, 10.13992506513992, 10.06844277928272, 6.59697166333595, 6.496822225550801, 6.210670719544083, 0.7656115591526031, 1.415650436654687, 1.1657259911298752, 2.8058678482969555, 2.996015196045235, 2.7538114984830173, 4.255448408424854, 3.833071157336235, 4.053001865744591, 0.09842657297849655, 0.14517062157392502, -0.15956628322601318, 4.606104743977383, 4.505192590256527, 5.077979169397921, -1.6543278197447506, -1.4531938458482472, -2.076969156662628, 3.003601764639214, 3.0392769326766285, 3.106633105625704, 9.93902250379324, 9.976011749356985, 9.253512278199196, -3.8415278370181767, -4.217900360624, -4.885843942562744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14874758329808924, "mean_inference_ms": 0.6448085494609272, "mean_action_processing_ms": 0.09555890775139413, "mean_env_wait_ms": 0.7934845621793072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 292800, "timesteps_this_iter": 0, "agent_timesteps_total": 878400, "timers": {"sample_time_ms": 9122.536, "sample_throughput": 526.169, "load_time_ms": 0.203, "load_throughput": 23691055.778, "learn_time_ms": 1156.093, "learn_throughput": 4151.914, "update_time_ms": 1.605}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 6.702279031276703, "policy_loss": -0.0037910302088131065, "vf_loss": 6.812662243843079, "vf_explained_var": -1.0, "kl": 0.006147390660820816, "entropy": 10.670146465301514, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 292800, "num_agent_steps_sampled": 878400, "num_steps_trained": 292800, "num_agent_steps_trained": 878400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1901, "training_iteration": 61, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-52-10", "timestamp": 1706147530, "time_this_iter_s": 9.113620519638062, "time_total_s": 571.9970319271088, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C119D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 571.9970319271088, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 6.292307692307692, "ram_util_percent": 45.85384615384615}}
{"episode_reward_max": 34.035517944023, "episode_reward_min": -349.41957998275757, "episode_reward_mean": -5.1705064120332205, "episode_len_mean": 292.38, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -123.2469337284565}, "policy_reward_max": {"shared_policy": 11.702713611846164}, "policy_reward_mean": {"shared_policy": -1.723502137344408}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.98600745201108, 2.3240394741296484, 8.747134987264872, 15.820998791605206, 3.1163453236222267, 3.5125980097800493, -3.5236289203167104, -17.31303814798595, 4.173407413065419, -31.80848066136241, -1.1482644081115723, -305.23426131904125, 2.330861739814253, 5.584139497950659, -0.5156552381813526, 7.056607952341437, 10.006225366145372, 1.8546579778194285, -313.3916246369481, 19.652498602867126, 16.456358551979037, 5.114291861653328, 4.796163050457807, 3.7432735580950975, 4.08421058952807, 0.36924336478112707, -1.8446825817227506, 26.940908685326562, -319.4891974441707, 2.368355721235247, 17.384407736361, 1.6328955367207243, 0.3652196228504181, -19.643498755991487, 12.935117982327924, 9.789717674255371, -20.68449506908658, 8.909316007047863, 5.474356397986398, 13.692964464426012, 9.51229557767509, 16.672884523868547, 13.099088091403246, -11.17419696599248, -8.036683470010786, 19.80755864083767, 15.209260374307618, 26.72392223402855, 17.396871186792836, 15.39408764988184, 3.8133014254271984, -6.650284945964813, 21.686779066920252, -5.613769207149758, 6.585107695311294, 10.105835005640984, 10.38585451245308, 12.00135597959158, 7.327810183167443, -7.384354881942272, 4.565610215067835, -349.41957998275757, 16.732788994908304, 14.223809257149668, 26.01065630093214, 9.912337198853464, 3.421372167766066, 30.16218278557062, 9.192336924374075, 19.55197690613565, 10.624088905751691, 4.600481332279742, 24.06375038996339, 30.097839891910525, 19.304464608430834, 3.3469879869371653, 8.555694542825208, 12.14152143150568, 0.08403091132640839, 14.189276503631831, -5.184490822255626, 9.149511802941547, 29.16854653134942, -12.94527214020492, 34.035517944023, -6.996685281395941, 21.135933972895145, 16.73592108860612, 16.254192374646635, 17.477243287488804, 24.420478671789155, 20.953042156994314, 0.1599166281521036, -24.536700392141967, 2.5417635366320326, 20.194456063210964, -9.774654969573035, 13.698174113407703, 14.386723038485798, 30.22589503228663], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 24, 300, 300, 300, 300, 300, 300, 217, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.6040483216444557, 3.2327268073956077, 3.1492323229710166, 0.6341310168305938, 0.7175441409150665, 0.9723643163839881, 2.994233176112175, 2.6839824318885803, 3.0689193792641163, 5.051957617203385, 5.469456954548747, 5.299584219853074, 1.1465481519699097, 0.8990177735686302, 1.0707793980836868, 0.940831869840622, 0.8640674948692322, 1.7076986450701952, -1.1670693705479351, -1.0485666940609661, -1.307992855707809, -5.593025224904224, -5.810332621137306, -5.9096803019444195, 1.513412361343697, 1.3604402442773136, 1.2995548074444088, -10.341041523963213, -10.475033901631832, -10.992405235767365, -0.704704150557518, -0.12973152101039886, -0.3138287365436554, -100.63390071690083, -102.23746332526207, -102.36289727687836, 0.6868962372342651, 0.8508295367161338, 0.7931359658638542, 1.880293612678841, 1.5452795227368625, 2.1585663625349554, -0.08378877490758896, -0.5096891820430756, 0.0778227187693119, 2.668001538142562, 2.2065150812268257, 2.1820913329720497, 3.4604461416602135, 3.5285913310945034, 3.0171878933906555, 0.5208109070857319, 0.8119790007670673, 0.5218680699666294, -100.64646373937528, -101.56509063641231, -111.18007026116054, 6.7714796885848045, 6.599098883569241, 6.281920030713081, 5.395966062943131, 5.620551111797482, 5.439841377238423, 1.7147534936666489, 1.5277647450566292, 1.87177362293005, 1.9168475276480024, 1.207980299989373, 1.6713352228204315, 1.1617171168327332, 1.6655313093215227, 0.9160251319408417, 1.5144943719108852, 1.5691822295387539, 1.0005339880784305, -0.06188152233760036, 0.33312153195340954, 0.09800335516531788, -0.4478375116984097, -0.3782696897784916, -1.0185753802458493, 9.032568593819931, 8.878121001025036, 9.030219090481594, -102.32510461534063, -103.65577788154285, -113.50831494728725, 0.7747078041235511, 0.7225992629925315, 0.8710486541191642, 6.062614555160195, 6.2099177862207, 5.111875394980103, 0.44055399547019647, 0.5400309438506667, 0.6523105973998611, 0.14995840191841125, -0.2541686147451401, 0.4694298356771469, -6.575727594395488, -6.63987556596598, -6.427895595630019, 4.355475050707653, 4.186532949407891, 4.39310998221238, 3.0252492278814316, 3.223580703139305, 3.5408877432346344, -6.89436221619448, -7.087680419286102, -6.702452433605998, 3.0194984624783103, 3.1921613651017253, 2.6976561794678275, 1.9568509807189258, 1.8474662502606662, 1.6700391670068058, 4.345693315068871, 4.778614925841481, 4.56865622351566, 3.203803879519299, 3.0156637554367336, 3.2928279427190574, 5.11709739764531, 5.8455768351753505, 5.710210291047886, 4.602153468877077, 4.429165869951248, 4.067768752574921, -3.6349338640769417, -3.9355396082004006, -3.603723493715137, -2.6740335201223786, -2.7663690497477944, -2.596280900140613, 6.55949179828167, 6.852073565125465, 6.395993277430534, 4.988063653310135, 5.166929704447583, 5.0542670165499, 8.889171103636414, 8.996807126949221, 8.837944003442914, 5.922104840477303, 5.890223917861775, 5.584542428453759, 5.058885984122753, 5.1913070902228355, 5.143894575536251, 1.5449363701045513, 1.483736276626587, 0.7846287786960602, -1.9218676313757896, -1.7901915088295937, -2.93822580575943, 7.194290953377873, 6.988041299084813, 7.504446814457566, -1.7123553554217068, -1.6650239216784684, -2.236389930049583, 2.202447866400078, 2.474913419534758, 1.9077464093764576, 3.324291542172432, 3.3906996846199036, 3.390843778848648, 3.4661060720682144, 3.4930382072925568, 3.426710233092308, 3.792795600990445, 4.015781010190636, 4.192779368410498, 2.36501347025235, 2.5280495335658344, 2.4347471793492588, -2.247389443218708, -2.7222363650798798, -2.4147290736436844, 1.5838352094093864, 1.3636312137047355, 1.6181437919537132, -113.45532795786858, -123.2469337284565, -112.7173182964325, 5.595314035813004, 5.30164738992849, 5.83582756916681, 4.817608277002961, 4.601421038309724, 4.804779941836983, 8.645102741817624, 8.857651023815066, 8.50790253529945, 3.1524840692678993, 3.4473488802711074, 3.3125042493144576, 1.2858666206399505, 1.0035289923349922, 1.1319765547911231, 10.019676461815834, 10.046393796801567, 10.09611252695322, 3.159980828563363, 3.1098475853601997, 2.9225085104505126, 6.212794090310723, 6.831431564564497, 6.50775125126043, 3.37378268440564, 3.285293777783707, 3.965012443562344, 1.2165047079324722, 1.8093475783243775, 1.574629046022892, 8.022097043693066, 8.241541843861341, 7.800111502408981, 9.889472047487885, 10.13992506513992, 10.06844277928272, 6.59697166333595, 6.496822225550801, 6.210670719544083, 0.7656115591526031, 1.415650436654687, 1.1657259911298752, 2.8058678482969555, 2.996015196045235, 2.7538114984830173, 4.255448408424854, 3.833071157336235, 4.053001865744591, 0.09842657297849655, 0.14517062157392502, -0.15956628322601318, 4.606104743977383, 4.505192590256527, 5.077979169397921, -1.6543278197447506, -1.4531938458482472, -2.076969156662628, 3.003601764639214, 3.0392769326766285, 3.106633105625704, 9.93902250379324, 9.976011749356985, 9.253512278199196, -3.8415278370181767, -4.217900360624, -4.885843942562744, 11.146830198665455, 11.18597413351138, 11.702713611846164, -2.16004200776419, -2.3230842550595696, -2.513559018572181, 7.215947277843952, 7.215013161301613, 6.70497353374958, 5.781034614890814, 5.3919664323329926, 5.562920041382313, 5.624275880555302, 5.288619178036839, 5.341297316054494, 5.558854197462395, 5.803086911638573, 6.115302178387836, 8.180999492605523, 8.300021102031067, 7.939458077152565, 6.799116949240357, 7.00264613578716, 7.151279071966798, 0.24323615307608293, -0.025900704165309207, -0.05741882075867011, -8.281529193123191, -8.157546335210412, -8.097624863808363, 0.9742833475271766, 1.113827841977269, 0.45365234712758706, 6.692911624908447, 7.047282211482525, 6.454262226819992, -2.969856838385269, -3.440406153599426, -3.3643919775883404, 4.57311403254667, 4.7895223392794435, 4.335537741581589, 4.652927428483963, 4.726607393473387, 5.007188216528448, 9.919218887885407, 10.188436900575951, 10.118239243825272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1485043061222559, "mean_inference_ms": 0.6444250657087222, "mean_action_processing_ms": 0.09547819245035828, "mean_env_wait_ms": 0.7936817252560806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 297600, "timesteps_this_iter": 0, "agent_timesteps_total": 892800, "timers": {"sample_time_ms": 9109.275, "sample_throughput": 526.935, "load_time_ms": 0.203, "load_throughput": 23691055.778, "learn_time_ms": 1156.692, "learn_throughput": 4149.766, "update_time_ms": 1.606}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 6.448536992073059, "policy_loss": -0.0020346448199698997, "vf_loss": 6.5582703948020935, "vf_explained_var": -1.0, "kl": 0.0070411836787146655, "entropy": 10.782393097877502, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 297600, "num_agent_steps_sampled": 892800, "num_steps_trained": 297600, "num_agent_steps_trained": 892800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1917, "training_iteration": 62, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-52-19", "timestamp": 1706147539, "time_this_iter_s": 9.024136781692505, "time_total_s": 581.0211687088013, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100053F3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 581.0211687088013, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 6.441666666666666, "ram_util_percent": 45.80833333333334}}
{"episode_reward_max": 34.035517944023, "episode_reward_min": -349.41957998275757, "episode_reward_mean": -0.5877805746023044, "episode_len_mean": 295.14, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -123.2469337284565}, "policy_reward_max": {"shared_policy": 11.702713611846164}, "policy_reward_mean": {"shared_policy": -0.19592685820076933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.006225366145372, 1.8546579778194285, -313.3916246369481, 19.652498602867126, 16.456358551979037, 5.114291861653328, 4.796163050457807, 3.7432735580950975, 4.08421058952807, 0.36924336478112707, -1.8446825817227506, 26.940908685326562, -319.4891974441707, 2.368355721235247, 17.384407736361, 1.6328955367207243, 0.3652196228504181, -19.643498755991487, 12.935117982327924, 9.789717674255371, -20.68449506908658, 8.909316007047863, 5.474356397986398, 13.692964464426012, 9.51229557767509, 16.672884523868547, 13.099088091403246, -11.17419696599248, -8.036683470010786, 19.80755864083767, 15.209260374307618, 26.72392223402855, 17.396871186792836, 15.39408764988184, 3.8133014254271984, -6.650284945964813, 21.686779066920252, -5.613769207149758, 6.585107695311294, 10.105835005640984, 10.38585451245308, 12.00135597959158, 7.327810183167443, -7.384354881942272, 4.565610215067835, -349.41957998275757, 16.732788994908304, 14.223809257149668, 26.01065630093214, 9.912337198853464, 3.421372167766066, 30.16218278557062, 9.192336924374075, 19.55197690613565, 10.624088905751691, 4.600481332279742, 24.06375038996339, 30.097839891910525, 19.304464608430834, 3.3469879869371653, 8.555694542825208, 12.14152143150568, 0.08403091132640839, 14.189276503631831, -5.184490822255626, 9.149511802941547, 29.16854653134942, -12.94527214020492, 34.035517944023, -6.996685281395941, 21.135933972895145, 16.73592108860612, 16.254192374646635, 17.477243287488804, 24.420478671789155, 20.953042156994314, 0.1599166281521036, -24.536700392141967, 2.5417635366320326, 20.194456063210964, -9.774654969573035, 13.698174113407703, 14.386723038485798, 30.22589503228663, 13.141797278076396, 29.908371120691285, -8.624893084168448, -13.512263540178552, 0.835683040320859, 24.39665630087255, 9.50384208746253, 3.3046204745769217, 25.59113689512013, 10.2250354886055, 6.1502924412488795, 10.822191417217255, 9.279898649547249, 30.987751892767818, -1.1372040919959687, 10.508479319512844], "episode_lengths": [300, 300, 217, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.4604461416602135, 3.5285913310945034, 3.0171878933906555, 0.5208109070857319, 0.8119790007670673, 0.5218680699666294, -100.64646373937528, -101.56509063641231, -111.18007026116054, 6.7714796885848045, 6.599098883569241, 6.281920030713081, 5.395966062943131, 5.620551111797482, 5.439841377238423, 1.7147534936666489, 1.5277647450566292, 1.87177362293005, 1.9168475276480024, 1.207980299989373, 1.6713352228204315, 1.1617171168327332, 1.6655313093215227, 0.9160251319408417, 1.5144943719108852, 1.5691822295387539, 1.0005339880784305, -0.06188152233760036, 0.33312153195340954, 0.09800335516531788, -0.4478375116984097, -0.3782696897784916, -1.0185753802458493, 9.032568593819931, 8.878121001025036, 9.030219090481594, -102.32510461534063, -103.65577788154285, -113.50831494728725, 0.7747078041235511, 0.7225992629925315, 0.8710486541191642, 6.062614555160195, 6.2099177862207, 5.111875394980103, 0.44055399547019647, 0.5400309438506667, 0.6523105973998611, 0.14995840191841125, -0.2541686147451401, 0.4694298356771469, -6.575727594395488, -6.63987556596598, -6.427895595630019, 4.355475050707653, 4.186532949407891, 4.39310998221238, 3.0252492278814316, 3.223580703139305, 3.5408877432346344, -6.89436221619448, -7.087680419286102, -6.702452433605998, 3.0194984624783103, 3.1921613651017253, 2.6976561794678275, 1.9568509807189258, 1.8474662502606662, 1.6700391670068058, 4.345693315068871, 4.778614925841481, 4.56865622351566, 3.203803879519299, 3.0156637554367336, 3.2928279427190574, 5.11709739764531, 5.8455768351753505, 5.710210291047886, 4.602153468877077, 4.429165869951248, 4.067768752574921, -3.6349338640769417, -3.9355396082004006, -3.603723493715137, -2.6740335201223786, -2.7663690497477944, -2.596280900140613, 6.55949179828167, 6.852073565125465, 6.395993277430534, 4.988063653310135, 5.166929704447583, 5.0542670165499, 8.889171103636414, 8.996807126949221, 8.837944003442914, 5.922104840477303, 5.890223917861775, 5.584542428453759, 5.058885984122753, 5.1913070902228355, 5.143894575536251, 1.5449363701045513, 1.483736276626587, 0.7846287786960602, -1.9218676313757896, -1.7901915088295937, -2.93822580575943, 7.194290953377873, 6.988041299084813, 7.504446814457566, -1.7123553554217068, -1.6650239216784684, -2.236389930049583, 2.202447866400078, 2.474913419534758, 1.9077464093764576, 3.324291542172432, 3.3906996846199036, 3.390843778848648, 3.4661060720682144, 3.4930382072925568, 3.426710233092308, 3.792795600990445, 4.015781010190636, 4.192779368410498, 2.36501347025235, 2.5280495335658344, 2.4347471793492588, -2.247389443218708, -2.7222363650798798, -2.4147290736436844, 1.5838352094093864, 1.3636312137047355, 1.6181437919537132, -113.45532795786858, -123.2469337284565, -112.7173182964325, 5.595314035813004, 5.30164738992849, 5.83582756916681, 4.817608277002961, 4.601421038309724, 4.804779941836983, 8.645102741817624, 8.857651023815066, 8.50790253529945, 3.1524840692678993, 3.4473488802711074, 3.3125042493144576, 1.2858666206399505, 1.0035289923349922, 1.1319765547911231, 10.019676461815834, 10.046393796801567, 10.09611252695322, 3.159980828563363, 3.1098475853601997, 2.9225085104505126, 6.212794090310723, 6.831431564564497, 6.50775125126043, 3.37378268440564, 3.285293777783707, 3.965012443562344, 1.2165047079324722, 1.8093475783243775, 1.574629046022892, 8.022097043693066, 8.241541843861341, 7.800111502408981, 9.889472047487885, 10.13992506513992, 10.06844277928272, 6.59697166333595, 6.496822225550801, 6.210670719544083, 0.7656115591526031, 1.415650436654687, 1.1657259911298752, 2.8058678482969555, 2.996015196045235, 2.7538114984830173, 4.255448408424854, 3.833071157336235, 4.053001865744591, 0.09842657297849655, 0.14517062157392502, -0.15956628322601318, 4.606104743977383, 4.505192590256527, 5.077979169397921, -1.6543278197447506, -1.4531938458482472, -2.076969156662628, 3.003601764639214, 3.0392769326766285, 3.106633105625704, 9.93902250379324, 9.976011749356985, 9.253512278199196, -3.8415278370181767, -4.217900360624, -4.885843942562744, 11.146830198665455, 11.18597413351138, 11.702713611846164, -2.16004200776419, -2.3230842550595696, -2.513559018572181, 7.215947277843952, 7.215013161301613, 6.70497353374958, 5.781034614890814, 5.3919664323329926, 5.562920041382313, 5.624275880555302, 5.288619178036839, 5.341297316054494, 5.558854197462395, 5.803086911638573, 6.115302178387836, 8.180999492605523, 8.300021102031067, 7.939458077152565, 6.799116949240357, 7.00264613578716, 7.151279071966798, 0.24323615307608293, -0.025900704165309207, -0.05741882075867011, -8.281529193123191, -8.157546335210412, -8.097624863808363, 0.9742833475271766, 1.113827841977269, 0.45365234712758706, 6.692911624908447, 7.047282211482525, 6.454262226819992, -2.969856838385269, -3.440406153599426, -3.3643919775883404, 4.57311403254667, 4.7895223392794435, 4.335537741581589, 4.652927428483963, 4.726607393473387, 5.007188216528448, 9.919218887885407, 10.188436900575951, 10.118239243825272, 4.523371749867991, 4.151486804087952, 4.466938724120453, 10.053474095960453, 10.035730240245655, 9.819166784485176, -3.00402530531089, -2.8356852481762616, -2.785182530681297, -4.376949534441039, -4.414715000117823, -4.72059900561969, 0.276325528820351, 0.30020180841286503, 0.259155703087643, 8.053575237592057, 7.913416554530457, 8.429664508750037, 3.3318770856906923, 3.043539812167481, 3.128425189604357, 1.2616264993945663, 1.443894820908696, 0.5990991542736595, 8.700658482809857, 8.516695862015084, 8.37378255029519, 3.614243410527706, 3.4504815861582756, 3.1603104919195175, 2.444562633832291, 1.8053510983784946, 1.900378709038094, 3.6916292309761047, 3.436857521533966, 3.693704664707184, 2.975783497095108, 3.2899099425412714, 3.0142052099108696, 9.752304176489503, 10.547225488970668, 10.688222227307648, -0.44262757400672115, -0.45443447182576335, -0.24014204616348422, 3.5056785717606544, 3.4727562069892883, 3.5300445407629013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1482570212213259, "mean_inference_ms": 0.6439242761919196, "mean_action_processing_ms": 0.09539121132998449, "mean_env_wait_ms": 0.7937769060834522, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 302400, "timesteps_this_iter": 0, "agent_timesteps_total": 907200, "timers": {"sample_time_ms": 9109.272, "sample_throughput": 526.936, "load_time_ms": 0.303, "load_throughput": 15863729.572, "learn_time_ms": 1156.185, "learn_throughput": 4151.584, "update_time_ms": 1.605}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 6.232276141643524, "policy_loss": -0.002792105339402884, "vf_loss": 6.343229115009308, "vf_explained_var": -1.0, "kl": 0.01107384779611836, "entropy": 10.835813879966736, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 302400, "num_agent_steps_sampled": 907200, "num_steps_trained": 302400, "num_agent_steps_trained": 907200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1933, "training_iteration": 63, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-52-28", "timestamp": 1706147548, "time_this_iter_s": 8.998722791671753, "time_total_s": 590.019891500473, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 590.019891500473, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 6.407692307692309, "ram_util_percent": 45.79230769230769}}
{"episode_reward_max": 34.035517944023, "episode_reward_min": -349.41957998275757, "episode_reward_mean": 6.686016938113377, "episode_len_mean": 297.9, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -123.2469337284565}, "policy_reward_max": {"shared_policy": 11.702713611846164}, "policy_reward_mean": {"shared_policy": 2.2286723127044583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3652196228504181, -19.643498755991487, 12.935117982327924, 9.789717674255371, -20.68449506908658, 8.909316007047863, 5.474356397986398, 13.692964464426012, 9.51229557767509, 16.672884523868547, 13.099088091403246, -11.17419696599248, -8.036683470010786, 19.80755864083767, 15.209260374307618, 26.72392223402855, 17.396871186792836, 15.39408764988184, 3.8133014254271984, -6.650284945964813, 21.686779066920252, -5.613769207149758, 6.585107695311294, 10.105835005640984, 10.38585451245308, 12.00135597959158, 7.327810183167443, -7.384354881942272, 4.565610215067835, -349.41957998275757, 16.732788994908304, 14.223809257149668, 26.01065630093214, 9.912337198853464, 3.421372167766066, 30.16218278557062, 9.192336924374075, 19.55197690613565, 10.624088905751691, 4.600481332279742, 24.06375038996339, 30.097839891910525, 19.304464608430834, 3.3469879869371653, 8.555694542825208, 12.14152143150568, 0.08403091132640839, 14.189276503631831, -5.184490822255626, 9.149511802941547, 29.16854653134942, -12.94527214020492, 34.035517944023, -6.996685281395941, 21.135933972895145, 16.73592108860612, 16.254192374646635, 17.477243287488804, 24.420478671789155, 20.953042156994314, 0.1599166281521036, -24.536700392141967, 2.5417635366320326, 20.194456063210964, -9.774654969573035, 13.698174113407703, 14.386723038485798, 30.22589503228663, 13.141797278076396, 29.908371120691285, -8.624893084168448, -13.512263540178552, 0.835683040320859, 24.39665630087255, 9.50384208746253, 3.3046204745769217, 25.59113689512013, 10.2250354886055, 6.1502924412488795, 10.822191417217255, 9.279898649547249, 30.987751892767818, -1.1372040919959687, 10.508479319512844, 6.105904422700405, 13.252658128738375, 7.209773957729325, 16.584410917013855, -0.9423694340512299, 28.000839967280626, 13.03208745270966, 10.578832190483794, -0.674810454249382, 19.660194758325787, 10.119409892708063, 2.987994507886441, 18.442015243694172, 23.656215187162132, 21.518293335102484, 17.526287138462067], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [0.14995840191841125, -0.2541686147451401, 0.4694298356771469, -6.575727594395488, -6.63987556596598, -6.427895595630019, 4.355475050707653, 4.186532949407891, 4.39310998221238, 3.0252492278814316, 3.223580703139305, 3.5408877432346344, -6.89436221619448, -7.087680419286102, -6.702452433605998, 3.0194984624783103, 3.1921613651017253, 2.6976561794678275, 1.9568509807189258, 1.8474662502606662, 1.6700391670068058, 4.345693315068871, 4.778614925841481, 4.56865622351566, 3.203803879519299, 3.0156637554367336, 3.2928279427190574, 5.11709739764531, 5.8455768351753505, 5.710210291047886, 4.602153468877077, 4.429165869951248, 4.067768752574921, -3.6349338640769417, -3.9355396082004006, -3.603723493715137, -2.6740335201223786, -2.7663690497477944, -2.596280900140613, 6.55949179828167, 6.852073565125465, 6.395993277430534, 4.988063653310135, 5.166929704447583, 5.0542670165499, 8.889171103636414, 8.996807126949221, 8.837944003442914, 5.922104840477303, 5.890223917861775, 5.584542428453759, 5.058885984122753, 5.1913070902228355, 5.143894575536251, 1.5449363701045513, 1.483736276626587, 0.7846287786960602, -1.9218676313757896, -1.7901915088295937, -2.93822580575943, 7.194290953377873, 6.988041299084813, 7.504446814457566, -1.7123553554217068, -1.6650239216784684, -2.236389930049583, 2.202447866400078, 2.474913419534758, 1.9077464093764576, 3.324291542172432, 3.3906996846199036, 3.390843778848648, 3.4661060720682144, 3.4930382072925568, 3.426710233092308, 3.792795600990445, 4.015781010190636, 4.192779368410498, 2.36501347025235, 2.5280495335658344, 2.4347471793492588, -2.247389443218708, -2.7222363650798798, -2.4147290736436844, 1.5838352094093864, 1.3636312137047355, 1.6181437919537132, -113.45532795786858, -123.2469337284565, -112.7173182964325, 5.595314035813004, 5.30164738992849, 5.83582756916681, 4.817608277002961, 4.601421038309724, 4.804779941836983, 8.645102741817624, 8.857651023815066, 8.50790253529945, 3.1524840692678993, 3.4473488802711074, 3.3125042493144576, 1.2858666206399505, 1.0035289923349922, 1.1319765547911231, 10.019676461815834, 10.046393796801567, 10.09611252695322, 3.159980828563363, 3.1098475853601997, 2.9225085104505126, 6.212794090310723, 6.831431564564497, 6.50775125126043, 3.37378268440564, 3.285293777783707, 3.965012443562344, 1.2165047079324722, 1.8093475783243775, 1.574629046022892, 8.022097043693066, 8.241541843861341, 7.800111502408981, 9.889472047487885, 10.13992506513992, 10.06844277928272, 6.59697166333595, 6.496822225550801, 6.210670719544083, 0.7656115591526031, 1.415650436654687, 1.1657259911298752, 2.8058678482969555, 2.996015196045235, 2.7538114984830173, 4.255448408424854, 3.833071157336235, 4.053001865744591, 0.09842657297849655, 0.14517062157392502, -0.15956628322601318, 4.606104743977383, 4.505192590256527, 5.077979169397921, -1.6543278197447506, -1.4531938458482472, -2.076969156662628, 3.003601764639214, 3.0392769326766285, 3.106633105625704, 9.93902250379324, 9.976011749356985, 9.253512278199196, -3.8415278370181767, -4.217900360624, -4.885843942562744, 11.146830198665455, 11.18597413351138, 11.702713611846164, -2.16004200776419, -2.3230842550595696, -2.513559018572181, 7.215947277843952, 7.215013161301613, 6.70497353374958, 5.781034614890814, 5.3919664323329926, 5.562920041382313, 5.624275880555302, 5.288619178036839, 5.341297316054494, 5.558854197462395, 5.803086911638573, 6.115302178387836, 8.180999492605523, 8.300021102031067, 7.939458077152565, 6.799116949240357, 7.00264613578716, 7.151279071966798, 0.24323615307608293, -0.025900704165309207, -0.05741882075867011, -8.281529193123191, -8.157546335210412, -8.097624863808363, 0.9742833475271766, 1.113827841977269, 0.45365234712758706, 6.692911624908447, 7.047282211482525, 6.454262226819992, -2.969856838385269, -3.440406153599426, -3.3643919775883404, 4.57311403254667, 4.7895223392794435, 4.335537741581589, 4.652927428483963, 4.726607393473387, 5.007188216528448, 9.919218887885407, 10.188436900575951, 10.118239243825272, 4.523371749867991, 4.151486804087952, 4.466938724120453, 10.053474095960453, 10.035730240245655, 9.819166784485176, -3.00402530531089, -2.8356852481762616, -2.785182530681297, -4.376949534441039, -4.414715000117823, -4.72059900561969, 0.276325528820351, 0.30020180841286503, 0.259155703087643, 8.053575237592057, 7.913416554530457, 8.429664508750037, 3.3318770856906923, 3.043539812167481, 3.128425189604357, 1.2616264993945663, 1.443894820908696, 0.5990991542736595, 8.700658482809857, 8.516695862015084, 8.37378255029519, 3.614243410527706, 3.4504815861582756, 3.1603104919195175, 2.444562633832291, 1.8053510983784946, 1.900378709038094, 3.6916292309761047, 3.436857521533966, 3.693704664707184, 2.975783497095108, 3.2899099425412714, 3.0142052099108696, 9.752304176489503, 10.547225488970668, 10.688222227307648, -0.44262757400672115, -0.45443447182576335, -0.24014204616348422, 3.5056785717606544, 3.4727562069892883, 3.5300445407629013, 1.8307307958602905, 2.0467829555273056, 2.228390671312809, 4.522045897940785, 4.725937070945889, 4.0046751598517005, 2.140696098407105, 2.660446812709168, 2.4086310466130527, 5.147968495885522, 5.702190327147633, 5.7342520939807, -0.4770946751038281, -0.09518116867791093, -0.37009359026949085, 9.45445979014039, 9.34080757200718, 9.205572605133057, 4.467863400777176, 4.228719991942242, 4.335504059990242, 3.62291957934697, 4.18893927459915, 2.7669733365376743, -0.23445384204387665, 0.04937908053398132, -0.4897356927394867, 6.749283901105315, 6.587993117670209, 6.322917739550263, 3.4985173232853413, 3.3521669656038284, 3.2687256038188934, 0.8842076758543556, 0.7447273681561057, 1.3590594638759796, 6.04389228423436, 5.875138570864991, 6.522984388594821, 7.925029634187609, 7.961435350279004, 7.769750202695519, 7.407518130106226, 7.0811681573589595, 7.029607047637299, 5.949251167476177, 5.797688625752926, 5.779347345232964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14803988458324105, "mean_inference_ms": 0.6434153284182778, "mean_action_processing_ms": 0.0953119403907912, "mean_env_wait_ms": 0.7938681937586496, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 307200, "timesteps_this_iter": 0, "agent_timesteps_total": 921600, "timers": {"sample_time_ms": 9123.87, "sample_throughput": 526.093, "load_time_ms": 0.2, "load_throughput": 24018920.544, "learn_time_ms": 1154.187, "learn_throughput": 4158.772, "update_time_ms": 1.607}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 4.525447905063629, "policy_loss": -0.002682966089204375, "vf_loss": 4.636960685253143, "vf_explained_var": -1.0, "kl": 0.005708135941000709, "entropy": 10.893141269683838, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 307200, "num_agent_steps_sampled": 921600, "num_steps_trained": 307200, "num_agent_steps_trained": 921600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1949, "training_iteration": 64, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-52-37", "timestamp": 1706147557, "time_this_iter_s": 9.131754159927368, "time_total_s": 599.1516456604004, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 599.1516456604004, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 8.73076923076923, "ram_util_percent": 45.8}}
{"episode_reward_max": 34.035517944023, "episode_reward_min": -349.41957998275757, "episode_reward_mean": 8.20843473222142, "episode_len_mean": 297.9, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -123.2469337284565}, "policy_reward_max": {"shared_policy": 11.702713611846164}, "policy_reward_mean": {"shared_policy": 2.7361449107404723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.396871186792836, 15.39408764988184, 3.8133014254271984, -6.650284945964813, 21.686779066920252, -5.613769207149758, 6.585107695311294, 10.105835005640984, 10.38585451245308, 12.00135597959158, 7.327810183167443, -7.384354881942272, 4.565610215067835, -349.41957998275757, 16.732788994908304, 14.223809257149668, 26.01065630093214, 9.912337198853464, 3.421372167766066, 30.16218278557062, 9.192336924374075, 19.55197690613565, 10.624088905751691, 4.600481332279742, 24.06375038996339, 30.097839891910525, 19.304464608430834, 3.3469879869371653, 8.555694542825208, 12.14152143150568, 0.08403091132640839, 14.189276503631831, -5.184490822255626, 9.149511802941547, 29.16854653134942, -12.94527214020492, 34.035517944023, -6.996685281395941, 21.135933972895145, 16.73592108860612, 16.254192374646635, 17.477243287488804, 24.420478671789155, 20.953042156994314, 0.1599166281521036, -24.536700392141967, 2.5417635366320326, 20.194456063210964, -9.774654969573035, 13.698174113407703, 14.386723038485798, 30.22589503228663, 13.141797278076396, 29.908371120691285, -8.624893084168448, -13.512263540178552, 0.835683040320859, 24.39665630087255, 9.50384208746253, 3.3046204745769217, 25.59113689512013, 10.2250354886055, 6.1502924412488795, 10.822191417217255, 9.279898649547249, 30.987751892767818, -1.1372040919959687, 10.508479319512844, 6.105904422700405, 13.252658128738375, 7.209773957729325, 16.584410917013855, -0.9423694340512299, 28.000839967280626, 13.03208745270966, 10.578832190483794, -0.674810454249382, 19.660194758325787, 10.119409892708063, 2.987994507886441, 18.442015243694172, 23.656215187162132, 21.518293335102484, 17.526287138462067, 25.405767989868764, 14.178443871438503, 6.775450257584453, 16.486025121062966, 19.956494688987732, 20.98852647840974, 17.657441101968274, 21.68198695778844, 23.862272452563047, 4.293914809823036, -10.351202219724684, 3.4141009412705614, 21.57104152068493, 12.831524828448892, 23.214098908007145, 22.92871903255582], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.922104840477303, 5.890223917861775, 5.584542428453759, 5.058885984122753, 5.1913070902228355, 5.143894575536251, 1.5449363701045513, 1.483736276626587, 0.7846287786960602, -1.9218676313757896, -1.7901915088295937, -2.93822580575943, 7.194290953377873, 6.988041299084813, 7.504446814457566, -1.7123553554217068, -1.6650239216784684, -2.236389930049583, 2.202447866400078, 2.474913419534758, 1.9077464093764576, 3.324291542172432, 3.3906996846199036, 3.390843778848648, 3.4661060720682144, 3.4930382072925568, 3.426710233092308, 3.792795600990445, 4.015781010190636, 4.192779368410498, 2.36501347025235, 2.5280495335658344, 2.4347471793492588, -2.247389443218708, -2.7222363650798798, -2.4147290736436844, 1.5838352094093864, 1.3636312137047355, 1.6181437919537132, -113.45532795786858, -123.2469337284565, -112.7173182964325, 5.595314035813004, 5.30164738992849, 5.83582756916681, 4.817608277002961, 4.601421038309724, 4.804779941836983, 8.645102741817624, 8.857651023815066, 8.50790253529945, 3.1524840692678993, 3.4473488802711074, 3.3125042493144576, 1.2858666206399505, 1.0035289923349922, 1.1319765547911231, 10.019676461815834, 10.046393796801567, 10.09611252695322, 3.159980828563363, 3.1098475853601997, 2.9225085104505126, 6.212794090310723, 6.831431564564497, 6.50775125126043, 3.37378268440564, 3.285293777783707, 3.965012443562344, 1.2165047079324722, 1.8093475783243775, 1.574629046022892, 8.022097043693066, 8.241541843861341, 7.800111502408981, 9.889472047487885, 10.13992506513992, 10.06844277928272, 6.59697166333595, 6.496822225550801, 6.210670719544083, 0.7656115591526031, 1.415650436654687, 1.1657259911298752, 2.8058678482969555, 2.996015196045235, 2.7538114984830173, 4.255448408424854, 3.833071157336235, 4.053001865744591, 0.09842657297849655, 0.14517062157392502, -0.15956628322601318, 4.606104743977383, 4.505192590256527, 5.077979169397921, -1.6543278197447506, -1.4531938458482472, -2.076969156662628, 3.003601764639214, 3.0392769326766285, 3.106633105625704, 9.93902250379324, 9.976011749356985, 9.253512278199196, -3.8415278370181767, -4.217900360624, -4.885843942562744, 11.146830198665455, 11.18597413351138, 11.702713611846164, -2.16004200776419, -2.3230842550595696, -2.513559018572181, 7.215947277843952, 7.215013161301613, 6.70497353374958, 5.781034614890814, 5.3919664323329926, 5.562920041382313, 5.624275880555302, 5.288619178036839, 5.341297316054494, 5.558854197462395, 5.803086911638573, 6.115302178387836, 8.180999492605523, 8.300021102031067, 7.939458077152565, 6.799116949240357, 7.00264613578716, 7.151279071966798, 0.24323615307608293, -0.025900704165309207, -0.05741882075867011, -8.281529193123191, -8.157546335210412, -8.097624863808363, 0.9742833475271766, 1.113827841977269, 0.45365234712758706, 6.692911624908447, 7.047282211482525, 6.454262226819992, -2.969856838385269, -3.440406153599426, -3.3643919775883404, 4.57311403254667, 4.7895223392794435, 4.335537741581589, 4.652927428483963, 4.726607393473387, 5.007188216528448, 9.919218887885407, 10.188436900575951, 10.118239243825272, 4.523371749867991, 4.151486804087952, 4.466938724120453, 10.053474095960453, 10.035730240245655, 9.819166784485176, -3.00402530531089, -2.8356852481762616, -2.785182530681297, -4.376949534441039, -4.414715000117823, -4.72059900561969, 0.276325528820351, 0.30020180841286503, 0.259155703087643, 8.053575237592057, 7.913416554530457, 8.429664508750037, 3.3318770856906923, 3.043539812167481, 3.128425189604357, 1.2616264993945663, 1.443894820908696, 0.5990991542736595, 8.700658482809857, 8.516695862015084, 8.37378255029519, 3.614243410527706, 3.4504815861582756, 3.1603104919195175, 2.444562633832291, 1.8053510983784946, 1.900378709038094, 3.6916292309761047, 3.436857521533966, 3.693704664707184, 2.975783497095108, 3.2899099425412714, 3.0142052099108696, 9.752304176489503, 10.547225488970668, 10.688222227307648, -0.44262757400672115, -0.45443447182576335, -0.24014204616348422, 3.5056785717606544, 3.4727562069892883, 3.5300445407629013, 1.8307307958602905, 2.0467829555273056, 2.228390671312809, 4.522045897940785, 4.725937070945889, 4.0046751598517005, 2.140696098407105, 2.660446812709168, 2.4086310466130527, 5.147968495885522, 5.702190327147633, 5.7342520939807, -0.4770946751038281, -0.09518116867791093, -0.37009359026949085, 9.45445979014039, 9.34080757200718, 9.205572605133057, 4.467863400777176, 4.228719991942242, 4.335504059990242, 3.62291957934697, 4.18893927459915, 2.7669733365376743, -0.23445384204387665, 0.04937908053398132, -0.4897356927394867, 6.749283901105315, 6.587993117670209, 6.322917739550263, 3.4985173232853413, 3.3521669656038284, 3.2687256038188934, 0.8842076758543556, 0.7447273681561057, 1.3590594638759796, 6.04389228423436, 5.875138570864991, 6.522984388594821, 7.925029634187609, 7.961435350279004, 7.769750202695519, 7.407518130106226, 7.0811681573589595, 7.029607047637299, 5.949251167476177, 5.797688625752926, 5.779347345232964, 8.653686214238405, 7.8945522010326385, 8.85752957459772, 4.552352249622345, 4.9927898570895195, 4.633301764726639, 2.174304850399494, 2.092031143605709, 2.5091142635792494, 5.217793355385453, 5.5988985995451515, 5.669333166132361, 6.671934030950069, 6.743748426437378, 6.540812231600285, 7.193809444705636, 7.015301878253609, 6.779415155450494, 5.924592470129326, 5.769767691691712, 5.963080940147236, 7.477625752488763, 7.07227527598539, 7.132085929314286, 7.371407240629196, 8.144689850509167, 8.346175361424685, 1.726691871881485, 1.3795894384384155, 1.1876334995031357, -3.347690065701812, -3.630276059110969, -3.3732360949119027, 1.1730880203346317, 1.0961422796050613, 1.1448706413308685, 7.573130747924239, 7.210103313128144, 6.787807459632546, 4.824552888050675, 3.9055212289094925, 4.101450711488724, 7.706624761223793, 7.768032111227512, 7.7394420355558395, 7.400998428463936, 7.720138311386108, 7.807582292705774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14782928462990377, "mean_inference_ms": 0.6429265728167839, "mean_action_processing_ms": 0.09524081647773099, "mean_env_wait_ms": 0.7939609648397692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"sample_time_ms": 9127.496, "sample_throughput": 525.884, "load_time_ms": 0.2, "load_throughput": 24018920.544, "learn_time_ms": 1154.786, "learn_throughput": 4156.614, "update_time_ms": 1.608}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 4.953023731708527, "policy_loss": -0.002570717507947462, "vf_loss": 5.064318656921387, "vf_explained_var": -0.8970495909452438, "kl": 0.009013974369787467, "entropy": 10.888465404510498, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 936000, "num_steps_trained": 312000, "num_agent_steps_trained": 936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1965, "training_iteration": 65, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-52-46", "timestamp": 1706147566, "time_this_iter_s": 9.044309139251709, "time_total_s": 608.1959547996521, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F91F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 608.1959547996521, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 9.623076923076923, "ram_util_percent": 45.80769230769231}}
{"episode_reward_max": 34.035517944023, "episode_reward_min": -24.536700392141967, "episode_reward_mean": 12.51289193097537, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -8.281529193123191}, "policy_reward_max": {"shared_policy": 11.702713611846164}, "policy_reward_mean": {"shared_policy": 4.17096397699179}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.01065630093214, 9.912337198853464, 3.421372167766066, 30.16218278557062, 9.192336924374075, 19.55197690613565, 10.624088905751691, 4.600481332279742, 24.06375038996339, 30.097839891910525, 19.304464608430834, 3.3469879869371653, 8.555694542825208, 12.14152143150568, 0.08403091132640839, 14.189276503631831, -5.184490822255626, 9.149511802941547, 29.16854653134942, -12.94527214020492, 34.035517944023, -6.996685281395941, 21.135933972895145, 16.73592108860612, 16.254192374646635, 17.477243287488804, 24.420478671789155, 20.953042156994314, 0.1599166281521036, -24.536700392141967, 2.5417635366320326, 20.194456063210964, -9.774654969573035, 13.698174113407703, 14.386723038485798, 30.22589503228663, 13.141797278076396, 29.908371120691285, -8.624893084168448, -13.512263540178552, 0.835683040320859, 24.39665630087255, 9.50384208746253, 3.3046204745769217, 25.59113689512013, 10.2250354886055, 6.1502924412488795, 10.822191417217255, 9.279898649547249, 30.987751892767818, -1.1372040919959687, 10.508479319512844, 6.105904422700405, 13.252658128738375, 7.209773957729325, 16.584410917013855, -0.9423694340512299, 28.000839967280626, 13.03208745270966, 10.578832190483794, -0.674810454249382, 19.660194758325787, 10.119409892708063, 2.987994507886441, 18.442015243694172, 23.656215187162132, 21.518293335102484, 17.526287138462067, 25.405767989868764, 14.178443871438503, 6.775450257584453, 16.486025121062966, 19.956494688987732, 20.98852647840974, 17.657441101968274, 21.68198695778844, 23.862272452563047, 4.293914809823036, -10.351202219724684, 3.4141009412705614, 21.57104152068493, 12.831524828448892, 23.214098908007145, 22.92871903255582, -13.836185358464732, -1.1451168619096563, 0.6290337666869021, 12.084132071584463, 32.96783988922833, 15.786571800708757, 25.014008697122335, 23.921184666454792, 28.376256056129904, 6.015567772090435, 10.547389132902012, 8.238638833165155, 7.238474577665301, 21.246227426454396, 7.063058122992516, 17.44986143708229], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [8.645102741817624, 8.857651023815066, 8.50790253529945, 3.1524840692678993, 3.4473488802711074, 3.3125042493144576, 1.2858666206399505, 1.0035289923349922, 1.1319765547911231, 10.019676461815834, 10.046393796801567, 10.09611252695322, 3.159980828563363, 3.1098475853601997, 2.9225085104505126, 6.212794090310723, 6.831431564564497, 6.50775125126043, 3.37378268440564, 3.285293777783707, 3.965012443562344, 1.2165047079324722, 1.8093475783243775, 1.574629046022892, 8.022097043693066, 8.241541843861341, 7.800111502408981, 9.889472047487885, 10.13992506513992, 10.06844277928272, 6.59697166333595, 6.496822225550801, 6.210670719544083, 0.7656115591526031, 1.415650436654687, 1.1657259911298752, 2.8058678482969555, 2.996015196045235, 2.7538114984830173, 4.255448408424854, 3.833071157336235, 4.053001865744591, 0.09842657297849655, 0.14517062157392502, -0.15956628322601318, 4.606104743977383, 4.505192590256527, 5.077979169397921, -1.6543278197447506, -1.4531938458482472, -2.076969156662628, 3.003601764639214, 3.0392769326766285, 3.106633105625704, 9.93902250379324, 9.976011749356985, 9.253512278199196, -3.8415278370181767, -4.217900360624, -4.885843942562744, 11.146830198665455, 11.18597413351138, 11.702713611846164, -2.16004200776419, -2.3230842550595696, -2.513559018572181, 7.215947277843952, 7.215013161301613, 6.70497353374958, 5.781034614890814, 5.3919664323329926, 5.562920041382313, 5.624275880555302, 5.288619178036839, 5.341297316054494, 5.558854197462395, 5.803086911638573, 6.115302178387836, 8.180999492605523, 8.300021102031067, 7.939458077152565, 6.799116949240357, 7.00264613578716, 7.151279071966798, 0.24323615307608293, -0.025900704165309207, -0.05741882075867011, -8.281529193123191, -8.157546335210412, -8.097624863808363, 0.9742833475271766, 1.113827841977269, 0.45365234712758706, 6.692911624908447, 7.047282211482525, 6.454262226819992, -2.969856838385269, -3.440406153599426, -3.3643919775883404, 4.57311403254667, 4.7895223392794435, 4.335537741581589, 4.652927428483963, 4.726607393473387, 5.007188216528448, 9.919218887885407, 10.188436900575951, 10.118239243825272, 4.523371749867991, 4.151486804087952, 4.466938724120453, 10.053474095960453, 10.035730240245655, 9.819166784485176, -3.00402530531089, -2.8356852481762616, -2.785182530681297, -4.376949534441039, -4.414715000117823, -4.72059900561969, 0.276325528820351, 0.30020180841286503, 0.259155703087643, 8.053575237592057, 7.913416554530457, 8.429664508750037, 3.3318770856906923, 3.043539812167481, 3.128425189604357, 1.2616264993945663, 1.443894820908696, 0.5990991542736595, 8.700658482809857, 8.516695862015084, 8.37378255029519, 3.614243410527706, 3.4504815861582756, 3.1603104919195175, 2.444562633832291, 1.8053510983784946, 1.900378709038094, 3.6916292309761047, 3.436857521533966, 3.693704664707184, 2.975783497095108, 3.2899099425412714, 3.0142052099108696, 9.752304176489503, 10.547225488970668, 10.688222227307648, -0.44262757400672115, -0.45443447182576335, -0.24014204616348422, 3.5056785717606544, 3.4727562069892883, 3.5300445407629013, 1.8307307958602905, 2.0467829555273056, 2.228390671312809, 4.522045897940785, 4.725937070945889, 4.0046751598517005, 2.140696098407105, 2.660446812709168, 2.4086310466130527, 5.147968495885522, 5.702190327147633, 5.7342520939807, -0.4770946751038281, -0.09518116867791093, -0.37009359026949085, 9.45445979014039, 9.34080757200718, 9.205572605133057, 4.467863400777176, 4.228719991942242, 4.335504059990242, 3.62291957934697, 4.18893927459915, 2.7669733365376743, -0.23445384204387665, 0.04937908053398132, -0.4897356927394867, 6.749283901105315, 6.587993117670209, 6.322917739550263, 3.4985173232853413, 3.3521669656038284, 3.2687256038188934, 0.8842076758543556, 0.7447273681561057, 1.3590594638759796, 6.04389228423436, 5.875138570864991, 6.522984388594821, 7.925029634187609, 7.961435350279004, 7.769750202695519, 7.407518130106226, 7.0811681573589595, 7.029607047637299, 5.949251167476177, 5.797688625752926, 5.779347345232964, 8.653686214238405, 7.8945522010326385, 8.85752957459772, 4.552352249622345, 4.9927898570895195, 4.633301764726639, 2.174304850399494, 2.092031143605709, 2.5091142635792494, 5.217793355385453, 5.5988985995451515, 5.669333166132361, 6.671934030950069, 6.743748426437378, 6.540812231600285, 7.193809444705636, 7.015301878253609, 6.779415155450494, 5.924592470129326, 5.769767691691712, 5.963080940147236, 7.477625752488763, 7.07227527598539, 7.132085929314286, 7.371407240629196, 8.144689850509167, 8.346175361424685, 1.726691871881485, 1.3795894384384155, 1.1876334995031357, -3.347690065701812, -3.630276059110969, -3.3732360949119027, 1.1730880203346317, 1.0961422796050613, 1.1448706413308685, 7.573130747924239, 7.210103313128144, 6.787807459632546, 4.824552888050675, 3.9055212289094925, 4.101450711488724, 7.706624761223793, 7.768032111227512, 7.7394420355558395, 7.400998428463936, 7.720138311386108, 7.807582292705774, -4.623980181912586, -4.649620908002063, -4.562584268550083, -0.5747653444608147, -0.03791977589330031, -0.5324317415555413, 0.17211178441841923, 0.06236499299605214, 0.39455698927243077, 3.9393787309527397, 4.129052706062794, 4.01570063456893, 10.94844002773364, 11.0292081584533, 10.99019170304139, 5.125125472744301, 5.5814958115418705, 5.079950516422585, 8.449768971651793, 8.004616692662239, 8.559623032808304, 8.170826502144337, 8.08904829621315, 7.661309868097305, 9.3448259482781, 9.47234524289766, 9.559084864954144, 2.3588741421699524, 2.346384696662426, 1.3103089332580566, 3.348581944902733, 3.333212067683533, 3.8655951203157457, 2.4398421396811756, 2.8909452905257496, 2.9078514029582294, 2.5715571443239753, 2.4070449719826286, 2.2598724613586967, 6.884170236686856, 7.098349841932446, 7.263707347835094, 1.971880480647087, 2.489223539829254, 2.6019541025161743, 5.896149590611458, 5.711988300085068, 5.841723546385765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14762649820781562, "mean_inference_ms": 0.6425165919767696, "mean_action_processing_ms": 0.09515813981290602, "mean_env_wait_ms": 0.7940971391262621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 316800, "timesteps_this_iter": 0, "agent_timesteps_total": 950400, "timers": {"sample_time_ms": 9144.574, "sample_throughput": 524.901, "load_time_ms": 0.1, "load_throughput": 48014927.737, "learn_time_ms": 1151.192, "learn_throughput": 4169.592, "update_time_ms": 1.608}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 4.597776651382446, "policy_loss": -0.00282383399653352, "vf_loss": 4.7095627784729, "vf_explained_var": -1.0, "kl": 0.005772770193341413, "entropy": 10.906487226486206, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 316800, "num_agent_steps_sampled": 950400, "num_steps_trained": 316800, "num_agent_steps_trained": 950400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1981, "training_iteration": 66, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-52-55", "timestamp": 1706147575, "time_this_iter_s": 9.195773601531982, "time_total_s": 617.3917284011841, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF50D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 617.3917284011841, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 7.153846153846152, "ram_util_percent": 45.86923076923077}}
{"episode_reward_max": 34.035517944023, "episode_reward_min": -299.95705984532833, "episode_reward_mean": 9.62667653977906, "episode_len_mean": 299.8, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -106.55472832421462}, "policy_reward_max": {"shared_policy": 11.702713611846164}, "policy_reward_mean": {"shared_policy": 3.208892179926353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.184490822255626, 9.149511802941547, 29.16854653134942, -12.94527214020492, 34.035517944023, -6.996685281395941, 21.135933972895145, 16.73592108860612, 16.254192374646635, 17.477243287488804, 24.420478671789155, 20.953042156994314, 0.1599166281521036, -24.536700392141967, 2.5417635366320326, 20.194456063210964, -9.774654969573035, 13.698174113407703, 14.386723038485798, 30.22589503228663, 13.141797278076396, 29.908371120691285, -8.624893084168448, -13.512263540178552, 0.835683040320859, 24.39665630087255, 9.50384208746253, 3.3046204745769217, 25.59113689512013, 10.2250354886055, 6.1502924412488795, 10.822191417217255, 9.279898649547249, 30.987751892767818, -1.1372040919959687, 10.508479319512844, 6.105904422700405, 13.252658128738375, 7.209773957729325, 16.584410917013855, -0.9423694340512299, 28.000839967280626, 13.03208745270966, 10.578832190483794, -0.674810454249382, 19.660194758325787, 10.119409892708063, 2.987994507886441, 18.442015243694172, 23.656215187162132, 21.518293335102484, 17.526287138462067, 25.405767989868764, 14.178443871438503, 6.775450257584453, 16.486025121062966, 19.956494688987732, 20.98852647840974, 17.657441101968274, 21.68198695778844, 23.862272452563047, 4.293914809823036, -10.351202219724684, 3.4141009412705614, 21.57104152068493, 12.831524828448892, 23.214098908007145, 22.92871903255582, -13.836185358464732, -1.1451168619096563, 0.6290337666869021, 12.084132071584463, 32.96783988922833, 15.786571800708757, 25.014008697122335, 23.921184666454792, 28.376256056129904, 6.015567772090435, 10.547389132902012, 8.238638833165155, 7.238474577665301, 21.246227426454396, 7.063058122992516, 17.44986143708229, 13.180399216711521, -19.600462220609202, 10.576587542891488, 31.903916478157043, 20.357878156006336, 14.235201343894005, 1.4643954141065478, 31.567243317142115, -299.95705984532833, 13.373718794435234, 17.025089774280758, 31.79964147252028, 5.905566256493302, 24.919248767197118, 18.57352294027804, 21.312572260387213], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-1.6543278197447506, -1.4531938458482472, -2.076969156662628, 3.003601764639214, 3.0392769326766285, 3.106633105625704, 9.93902250379324, 9.976011749356985, 9.253512278199196, -3.8415278370181767, -4.217900360624, -4.885843942562744, 11.146830198665455, 11.18597413351138, 11.702713611846164, -2.16004200776419, -2.3230842550595696, -2.513559018572181, 7.215947277843952, 7.215013161301613, 6.70497353374958, 5.781034614890814, 5.3919664323329926, 5.562920041382313, 5.624275880555302, 5.288619178036839, 5.341297316054494, 5.558854197462395, 5.803086911638573, 6.115302178387836, 8.180999492605523, 8.300021102031067, 7.939458077152565, 6.799116949240357, 7.00264613578716, 7.151279071966798, 0.24323615307608293, -0.025900704165309207, -0.05741882075867011, -8.281529193123191, -8.157546335210412, -8.097624863808363, 0.9742833475271766, 1.113827841977269, 0.45365234712758706, 6.692911624908447, 7.047282211482525, 6.454262226819992, -2.969856838385269, -3.440406153599426, -3.3643919775883404, 4.57311403254667, 4.7895223392794435, 4.335537741581589, 4.652927428483963, 4.726607393473387, 5.007188216528448, 9.919218887885407, 10.188436900575951, 10.118239243825272, 4.523371749867991, 4.151486804087952, 4.466938724120453, 10.053474095960453, 10.035730240245655, 9.819166784485176, -3.00402530531089, -2.8356852481762616, -2.785182530681297, -4.376949534441039, -4.414715000117823, -4.72059900561969, 0.276325528820351, 0.30020180841286503, 0.259155703087643, 8.053575237592057, 7.913416554530457, 8.429664508750037, 3.3318770856906923, 3.043539812167481, 3.128425189604357, 1.2616264993945663, 1.443894820908696, 0.5990991542736595, 8.700658482809857, 8.516695862015084, 8.37378255029519, 3.614243410527706, 3.4504815861582756, 3.1603104919195175, 2.444562633832291, 1.8053510983784946, 1.900378709038094, 3.6916292309761047, 3.436857521533966, 3.693704664707184, 2.975783497095108, 3.2899099425412714, 3.0142052099108696, 9.752304176489503, 10.547225488970668, 10.688222227307648, -0.44262757400672115, -0.45443447182576335, -0.24014204616348422, 3.5056785717606544, 3.4727562069892883, 3.5300445407629013, 1.8307307958602905, 2.0467829555273056, 2.228390671312809, 4.522045897940785, 4.725937070945889, 4.0046751598517005, 2.140696098407105, 2.660446812709168, 2.4086310466130527, 5.147968495885522, 5.702190327147633, 5.7342520939807, -0.4770946751038281, -0.09518116867791093, -0.37009359026949085, 9.45445979014039, 9.34080757200718, 9.205572605133057, 4.467863400777176, 4.228719991942242, 4.335504059990242, 3.62291957934697, 4.18893927459915, 2.7669733365376743, -0.23445384204387665, 0.04937908053398132, -0.4897356927394867, 6.749283901105315, 6.587993117670209, 6.322917739550263, 3.4985173232853413, 3.3521669656038284, 3.2687256038188934, 0.8842076758543556, 0.7447273681561057, 1.3590594638759796, 6.04389228423436, 5.875138570864991, 6.522984388594821, 7.925029634187609, 7.961435350279004, 7.769750202695519, 7.407518130106226, 7.0811681573589595, 7.029607047637299, 5.949251167476177, 5.797688625752926, 5.779347345232964, 8.653686214238405, 7.8945522010326385, 8.85752957459772, 4.552352249622345, 4.9927898570895195, 4.633301764726639, 2.174304850399494, 2.092031143605709, 2.5091142635792494, 5.217793355385453, 5.5988985995451515, 5.669333166132361, 6.671934030950069, 6.743748426437378, 6.540812231600285, 7.193809444705636, 7.015301878253609, 6.779415155450494, 5.924592470129326, 5.769767691691712, 5.963080940147236, 7.477625752488763, 7.07227527598539, 7.132085929314286, 7.371407240629196, 8.144689850509167, 8.346175361424685, 1.726691871881485, 1.3795894384384155, 1.1876334995031357, -3.347690065701812, -3.630276059110969, -3.3732360949119027, 1.1730880203346317, 1.0961422796050613, 1.1448706413308685, 7.573130747924239, 7.210103313128144, 6.787807459632546, 4.824552888050675, 3.9055212289094925, 4.101450711488724, 7.706624761223793, 7.768032111227512, 7.7394420355558395, 7.400998428463936, 7.720138311386108, 7.807582292705774, -4.623980181912586, -4.649620908002063, -4.562584268550083, -0.5747653444608147, -0.03791977589330031, -0.5324317415555413, 0.17211178441841923, 0.06236499299605214, 0.39455698927243077, 3.9393787309527397, 4.129052706062794, 4.01570063456893, 10.94844002773364, 11.0292081584533, 10.99019170304139, 5.125125472744301, 5.5814958115418705, 5.079950516422585, 8.449768971651793, 8.004616692662239, 8.559623032808304, 8.170826502144337, 8.08904829621315, 7.661309868097305, 9.3448259482781, 9.47234524289766, 9.559084864954144, 2.3588741421699524, 2.346384696662426, 1.3103089332580566, 3.348581944902733, 3.333212067683533, 3.8655951203157457, 2.4398421396811756, 2.8909452905257496, 2.9078514029582294, 2.5715571443239753, 2.4070449719826286, 2.2598724613586967, 6.884170236686856, 7.098349841932446, 7.263707347835094, 1.971880480647087, 2.489223539829254, 2.6019541025161743, 5.896149590611458, 5.711988300085068, 5.841723546385765, 4.3264792412519455, 4.775597892701626, 4.07832208275795, -6.5721088449160305, -6.70161595443885, -6.326737421254322, 3.2923288395007404, 3.479693730672196, 3.804564972718552, 10.648450091481209, 10.51608531177044, 10.739381074905396, 6.5723481476306915, 6.831202812492847, 6.954327195882797, 4.85712605714798, 4.364182457327843, 5.013892829418182, 0.5009354799985886, 0.09321139752864838, 0.8702485365793109, 10.241796066363648, 10.75960842830439, 10.565838822474078, -96.38100961844127, -97.02132190267245, -106.55472832421462, 4.686261183271796, 4.5860641549030845, 4.101393456260354, 5.959904214988143, 5.244617129365594, 5.820568429927022, 10.478992479542882, 10.240731815497071, 11.079917177480326, 2.187169859806687, 2.1847825261453693, 1.5336138705412452, 8.090057020386055, 8.379025777180985, 8.450165969630078, 6.333812524875, 6.265001346667603, 5.974709068735436, 6.951910744110734, 7.5949333307022755, 6.765728185574204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14741314419516693, "mean_inference_ms": 0.642104706928405, "mean_action_processing_ms": 0.09508485789519469, "mean_env_wait_ms": 0.7942206858027668, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 321600, "timesteps_this_iter": 0, "agent_timesteps_total": 964800, "timers": {"sample_time_ms": 9099.102, "sample_throughput": 527.525, "load_time_ms": 0.2, "load_throughput": 23993158.384, "learn_time_ms": 1148.405, "learn_throughput": 4179.709, "update_time_ms": 1.608}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 121.82454490661621, "policy_loss": -0.001892068332397523, "vf_loss": 121.93526935577393, "vf_explained_var": -0.028166189789772034, "kl": 0.012352079880709719, "entropy": 10.905391097068787, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 321600, "num_agent_steps_sampled": 964800, "num_steps_trained": 321600, "num_agent_steps_trained": 964800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1997, "training_iteration": 67, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-53-04", "timestamp": 1706147584, "time_this_iter_s": 9.058032512664795, "time_total_s": 626.4497609138489, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 626.4497609138489, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 45.861538461538466}}
{"episode_reward_max": 32.96783988922833, "episode_reward_min": -299.95705984532833, "episode_reward_mean": 10.09834702028928, "episode_len_mean": 299.8, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -106.55472832421462}, "policy_reward_max": {"shared_policy": 11.079917177480326}, "policy_reward_mean": {"shared_policy": 3.3661156734297597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.774654969573035, 13.698174113407703, 14.386723038485798, 30.22589503228663, 13.141797278076396, 29.908371120691285, -8.624893084168448, -13.512263540178552, 0.835683040320859, 24.39665630087255, 9.50384208746253, 3.3046204745769217, 25.59113689512013, 10.2250354886055, 6.1502924412488795, 10.822191417217255, 9.279898649547249, 30.987751892767818, -1.1372040919959687, 10.508479319512844, 6.105904422700405, 13.252658128738375, 7.209773957729325, 16.584410917013855, -0.9423694340512299, 28.000839967280626, 13.03208745270966, 10.578832190483794, -0.674810454249382, 19.660194758325787, 10.119409892708063, 2.987994507886441, 18.442015243694172, 23.656215187162132, 21.518293335102484, 17.526287138462067, 25.405767989868764, 14.178443871438503, 6.775450257584453, 16.486025121062966, 19.956494688987732, 20.98852647840974, 17.657441101968274, 21.68198695778844, 23.862272452563047, 4.293914809823036, -10.351202219724684, 3.4141009412705614, 21.57104152068493, 12.831524828448892, 23.214098908007145, 22.92871903255582, -13.836185358464732, -1.1451168619096563, 0.6290337666869021, 12.084132071584463, 32.96783988922833, 15.786571800708757, 25.014008697122335, 23.921184666454792, 28.376256056129904, 6.015567772090435, 10.547389132902012, 8.238638833165155, 7.238474577665301, 21.246227426454396, 7.063058122992516, 17.44986143708229, 13.180399216711521, -19.600462220609202, 10.576587542891488, 31.903916478157043, 20.357878156006336, 14.235201343894005, 1.4643954141065478, 31.567243317142115, -299.95705984532833, 13.373718794435234, 17.025089774280758, 31.79964147252028, 5.905566256493302, 24.919248767197118, 18.57352294027804, 21.312572260387213, -3.8710271753371046, 17.614478310570107, 7.528615400195093, 16.035233311355114, 14.264260552823515, 10.365727134980261, 18.137392625212655, 25.26192761212586, -16.541149728000192, 16.464146593585596, 14.355080220848293, 18.168733093887553, 17.72680668532847, 27.21227221190928, 5.161462832242222, 21.84646379202603], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-2.969856838385269, -3.440406153599426, -3.3643919775883404, 4.57311403254667, 4.7895223392794435, 4.335537741581589, 4.652927428483963, 4.726607393473387, 5.007188216528448, 9.919218887885407, 10.188436900575951, 10.118239243825272, 4.523371749867991, 4.151486804087952, 4.466938724120453, 10.053474095960453, 10.035730240245655, 9.819166784485176, -3.00402530531089, -2.8356852481762616, -2.785182530681297, -4.376949534441039, -4.414715000117823, -4.72059900561969, 0.276325528820351, 0.30020180841286503, 0.259155703087643, 8.053575237592057, 7.913416554530457, 8.429664508750037, 3.3318770856906923, 3.043539812167481, 3.128425189604357, 1.2616264993945663, 1.443894820908696, 0.5990991542736595, 8.700658482809857, 8.516695862015084, 8.37378255029519, 3.614243410527706, 3.4504815861582756, 3.1603104919195175, 2.444562633832291, 1.8053510983784946, 1.900378709038094, 3.6916292309761047, 3.436857521533966, 3.693704664707184, 2.975783497095108, 3.2899099425412714, 3.0142052099108696, 9.752304176489503, 10.547225488970668, 10.688222227307648, -0.44262757400672115, -0.45443447182576335, -0.24014204616348422, 3.5056785717606544, 3.4727562069892883, 3.5300445407629013, 1.8307307958602905, 2.0467829555273056, 2.228390671312809, 4.522045897940785, 4.725937070945889, 4.0046751598517005, 2.140696098407105, 2.660446812709168, 2.4086310466130527, 5.147968495885522, 5.702190327147633, 5.7342520939807, -0.4770946751038281, -0.09518116867791093, -0.37009359026949085, 9.45445979014039, 9.34080757200718, 9.205572605133057, 4.467863400777176, 4.228719991942242, 4.335504059990242, 3.62291957934697, 4.18893927459915, 2.7669733365376743, -0.23445384204387665, 0.04937908053398132, -0.4897356927394867, 6.749283901105315, 6.587993117670209, 6.322917739550263, 3.4985173232853413, 3.3521669656038284, 3.2687256038188934, 0.8842076758543556, 0.7447273681561057, 1.3590594638759796, 6.04389228423436, 5.875138570864991, 6.522984388594821, 7.925029634187609, 7.961435350279004, 7.769750202695519, 7.407518130106226, 7.0811681573589595, 7.029607047637299, 5.949251167476177, 5.797688625752926, 5.779347345232964, 8.653686214238405, 7.8945522010326385, 8.85752957459772, 4.552352249622345, 4.9927898570895195, 4.633301764726639, 2.174304850399494, 2.092031143605709, 2.5091142635792494, 5.217793355385453, 5.5988985995451515, 5.669333166132361, 6.671934030950069, 6.743748426437378, 6.540812231600285, 7.193809444705636, 7.015301878253609, 6.779415155450494, 5.924592470129326, 5.769767691691712, 5.963080940147236, 7.477625752488763, 7.07227527598539, 7.132085929314286, 7.371407240629196, 8.144689850509167, 8.346175361424685, 1.726691871881485, 1.3795894384384155, 1.1876334995031357, -3.347690065701812, -3.630276059110969, -3.3732360949119027, 1.1730880203346317, 1.0961422796050613, 1.1448706413308685, 7.573130747924239, 7.210103313128144, 6.787807459632546, 4.824552888050675, 3.9055212289094925, 4.101450711488724, 7.706624761223793, 7.768032111227512, 7.7394420355558395, 7.400998428463936, 7.720138311386108, 7.807582292705774, -4.623980181912586, -4.649620908002063, -4.562584268550083, -0.5747653444608147, -0.03791977589330031, -0.5324317415555413, 0.17211178441841923, 0.06236499299605214, 0.39455698927243077, 3.9393787309527397, 4.129052706062794, 4.01570063456893, 10.94844002773364, 11.0292081584533, 10.99019170304139, 5.125125472744301, 5.5814958115418705, 5.079950516422585, 8.449768971651793, 8.004616692662239, 8.559623032808304, 8.170826502144337, 8.08904829621315, 7.661309868097305, 9.3448259482781, 9.47234524289766, 9.559084864954144, 2.3588741421699524, 2.346384696662426, 1.3103089332580566, 3.348581944902733, 3.333212067683533, 3.8655951203157457, 2.4398421396811756, 2.8909452905257496, 2.9078514029582294, 2.5715571443239753, 2.4070449719826286, 2.2598724613586967, 6.884170236686856, 7.098349841932446, 7.263707347835094, 1.971880480647087, 2.489223539829254, 2.6019541025161743, 5.896149590611458, 5.711988300085068, 5.841723546385765, 4.3264792412519455, 4.775597892701626, 4.07832208275795, -6.5721088449160305, -6.70161595443885, -6.326737421254322, 3.2923288395007404, 3.479693730672196, 3.804564972718552, 10.648450091481209, 10.51608531177044, 10.739381074905396, 6.5723481476306915, 6.831202812492847, 6.954327195882797, 4.85712605714798, 4.364182457327843, 5.013892829418182, 0.5009354799985886, 0.09321139752864838, 0.8702485365793109, 10.241796066363648, 10.75960842830439, 10.565838822474078, -96.38100961844127, -97.02132190267245, -106.55472832421462, 4.686261183271796, 4.5860641549030845, 4.101393456260354, 5.959904214988143, 5.244617129365594, 5.820568429927022, 10.478992479542882, 10.240731815497071, 11.079917177480326, 2.187169859806687, 2.1847825261453693, 1.5336138705412452, 8.090057020386055, 8.379025777180985, 8.450165969630078, 6.333812524875, 6.265001346667603, 5.974709068735436, 6.951910744110734, 7.5949333307022755, 6.765728185574204, -0.9980560404559071, -1.2200054650505479, -1.6529656698306496, 5.770526019235447, 5.8298385639985355, 6.014113727336124, 2.40270250538984, 2.3180917004744117, 2.8078211943308418, 5.4928263910114765, 5.540671933442354, 5.001734986901283, 4.744404884676129, 4.77203659216562, 4.7478190759817664, 3.712346979416907, 3.3426165878772736, 3.310763567686081, 6.151637410124138, 6.1799939473470005, 5.8057612677415165, 8.770288599034146, 8.222550635536507, 8.269088377555207, -5.408809085687011, -5.578631808360427, -5.553708833952754, 6.117192461465791, 5.057100897034005, 5.2898532350858005, 5.089743516097457, 4.341760675112397, 4.92357602963844, 6.07682093729575, 5.927467008431748, 6.1644451481600555, 5.765175615747765, 6.125821118553475, 5.83580995102723, 8.669916068514183, 9.125143003960446, 9.41721313943465, 1.791540736953408, 1.1248522798220222, 2.245069815466792, 7.488681723674134, 6.956747447450951, 7.401034620900944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1471915359111956, "mean_inference_ms": 0.6416925562936815, "mean_action_processing_ms": 0.09503652115009462, "mean_env_wait_ms": 0.7943319445251933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 326400, "timesteps_this_iter": 0, "agent_timesteps_total": 979200, "timers": {"sample_time_ms": 9087.978, "sample_throughput": 528.17, "load_time_ms": 0.3, "load_throughput": 15998616.656, "learn_time_ms": 1148.804, "learn_throughput": 4178.259, "update_time_ms": 1.709}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 3.494485020637512, "policy_loss": -0.0036224417021730737, "vf_loss": 3.607888638973236, "vf_explained_var": -0.488738015294075, "kl": 0.008446510139092025, "entropy": 10.993152379989624, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 326400, "num_agent_steps_sampled": 979200, "num_steps_trained": 326400, "num_agent_steps_trained": 979200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2013, "training_iteration": 68, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-53-13", "timestamp": 1706147593, "time_this_iter_s": 9.015878438949585, "time_total_s": 635.4656393527985, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004ECEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 635.4656393527985, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 45.900000000000006}}
{"episode_reward_max": 32.96783988922833, "episode_reward_min": -299.95705984532833, "episode_reward_mean": 11.016797688723587, "episode_len_mean": 299.8, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -106.55472832421462}, "policy_reward_max": {"shared_policy": 11.079917177480326}, "policy_reward_mean": {"shared_policy": 3.6722658962411945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.279898649547249, 30.987751892767818, -1.1372040919959687, 10.508479319512844, 6.105904422700405, 13.252658128738375, 7.209773957729325, 16.584410917013855, -0.9423694340512299, 28.000839967280626, 13.03208745270966, 10.578832190483794, -0.674810454249382, 19.660194758325787, 10.119409892708063, 2.987994507886441, 18.442015243694172, 23.656215187162132, 21.518293335102484, 17.526287138462067, 25.405767989868764, 14.178443871438503, 6.775450257584453, 16.486025121062966, 19.956494688987732, 20.98852647840974, 17.657441101968274, 21.68198695778844, 23.862272452563047, 4.293914809823036, -10.351202219724684, 3.4141009412705614, 21.57104152068493, 12.831524828448892, 23.214098908007145, 22.92871903255582, -13.836185358464732, -1.1451168619096563, 0.6290337666869021, 12.084132071584463, 32.96783988922833, 15.786571800708757, 25.014008697122335, 23.921184666454792, 28.376256056129904, 6.015567772090435, 10.547389132902012, 8.238638833165155, 7.238474577665301, 21.246227426454396, 7.063058122992516, 17.44986143708229, 13.180399216711521, -19.600462220609202, 10.576587542891488, 31.903916478157043, 20.357878156006336, 14.235201343894005, 1.4643954141065478, 31.567243317142115, -299.95705984532833, 13.373718794435234, 17.025089774280758, 31.79964147252028, 5.905566256493302, 24.919248767197118, 18.57352294027804, 21.312572260387213, -3.8710271753371046, 17.614478310570107, 7.528615400195093, 16.035233311355114, 14.264260552823515, 10.365727134980261, 18.137392625212655, 25.26192761212586, -16.541149728000192, 16.464146593585596, 14.355080220848293, 18.168733093887553, 17.72680668532847, 27.21227221190928, 5.161462832242222, 21.84646379202603, 10.909944776445627, 21.644283765926943, 16.277536493726075, 25.81892186403273, 5.65192397311327, -10.01736300811173, 23.276149198412867, 28.51425849646327, 28.114186890044934, 21.539669275283785, 19.27912003081289, 16.208137951791258, 16.03752334695308, 15.10244307108222, 11.637832172214956, 2.129105679690838], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.975783497095108, 3.2899099425412714, 3.0142052099108696, 9.752304176489503, 10.547225488970668, 10.688222227307648, -0.44262757400672115, -0.45443447182576335, -0.24014204616348422, 3.5056785717606544, 3.4727562069892883, 3.5300445407629013, 1.8307307958602905, 2.0467829555273056, 2.228390671312809, 4.522045897940785, 4.725937070945889, 4.0046751598517005, 2.140696098407105, 2.660446812709168, 2.4086310466130527, 5.147968495885522, 5.702190327147633, 5.7342520939807, -0.4770946751038281, -0.09518116867791093, -0.37009359026949085, 9.45445979014039, 9.34080757200718, 9.205572605133057, 4.467863400777176, 4.228719991942242, 4.335504059990242, 3.62291957934697, 4.18893927459915, 2.7669733365376743, -0.23445384204387665, 0.04937908053398132, -0.4897356927394867, 6.749283901105315, 6.587993117670209, 6.322917739550263, 3.4985173232853413, 3.3521669656038284, 3.2687256038188934, 0.8842076758543556, 0.7447273681561057, 1.3590594638759796, 6.04389228423436, 5.875138570864991, 6.522984388594821, 7.925029634187609, 7.961435350279004, 7.769750202695519, 7.407518130106226, 7.0811681573589595, 7.029607047637299, 5.949251167476177, 5.797688625752926, 5.779347345232964, 8.653686214238405, 7.8945522010326385, 8.85752957459772, 4.552352249622345, 4.9927898570895195, 4.633301764726639, 2.174304850399494, 2.092031143605709, 2.5091142635792494, 5.217793355385453, 5.5988985995451515, 5.669333166132361, 6.671934030950069, 6.743748426437378, 6.540812231600285, 7.193809444705636, 7.015301878253609, 6.779415155450494, 5.924592470129326, 5.769767691691712, 5.963080940147236, 7.477625752488763, 7.07227527598539, 7.132085929314286, 7.371407240629196, 8.144689850509167, 8.346175361424685, 1.726691871881485, 1.3795894384384155, 1.1876334995031357, -3.347690065701812, -3.630276059110969, -3.3732360949119027, 1.1730880203346317, 1.0961422796050613, 1.1448706413308685, 7.573130747924239, 7.210103313128144, 6.787807459632546, 4.824552888050675, 3.9055212289094925, 4.101450711488724, 7.706624761223793, 7.768032111227512, 7.7394420355558395, 7.400998428463936, 7.720138311386108, 7.807582292705774, -4.623980181912586, -4.649620908002063, -4.562584268550083, -0.5747653444608147, -0.03791977589330031, -0.5324317415555413, 0.17211178441841923, 0.06236499299605214, 0.39455698927243077, 3.9393787309527397, 4.129052706062794, 4.01570063456893, 10.94844002773364, 11.0292081584533, 10.99019170304139, 5.125125472744301, 5.5814958115418705, 5.079950516422585, 8.449768971651793, 8.004616692662239, 8.559623032808304, 8.170826502144337, 8.08904829621315, 7.661309868097305, 9.3448259482781, 9.47234524289766, 9.559084864954144, 2.3588741421699524, 2.346384696662426, 1.3103089332580566, 3.348581944902733, 3.333212067683533, 3.8655951203157457, 2.4398421396811756, 2.8909452905257496, 2.9078514029582294, 2.5715571443239753, 2.4070449719826286, 2.2598724613586967, 6.884170236686856, 7.098349841932446, 7.263707347835094, 1.971880480647087, 2.489223539829254, 2.6019541025161743, 5.896149590611458, 5.711988300085068, 5.841723546385765, 4.3264792412519455, 4.775597892701626, 4.07832208275795, -6.5721088449160305, -6.70161595443885, -6.326737421254322, 3.2923288395007404, 3.479693730672196, 3.804564972718552, 10.648450091481209, 10.51608531177044, 10.739381074905396, 6.5723481476306915, 6.831202812492847, 6.954327195882797, 4.85712605714798, 4.364182457327843, 5.013892829418182, 0.5009354799985886, 0.09321139752864838, 0.8702485365793109, 10.241796066363648, 10.75960842830439, 10.565838822474078, -96.38100961844127, -97.02132190267245, -106.55472832421462, 4.686261183271796, 4.5860641549030845, 4.101393456260354, 5.959904214988143, 5.244617129365594, 5.820568429927022, 10.478992479542882, 10.240731815497071, 11.079917177480326, 2.187169859806687, 2.1847825261453693, 1.5336138705412452, 8.090057020386055, 8.379025777180985, 8.450165969630078, 6.333812524875, 6.265001346667603, 5.974709068735436, 6.951910744110734, 7.5949333307022755, 6.765728185574204, -0.9980560404559071, -1.2200054650505479, -1.6529656698306496, 5.770526019235447, 5.8298385639985355, 6.014113727336124, 2.40270250538984, 2.3180917004744117, 2.8078211943308418, 5.4928263910114765, 5.540671933442354, 5.001734986901283, 4.744404884676129, 4.77203659216562, 4.7478190759817664, 3.712346979416907, 3.3426165878772736, 3.310763567686081, 6.151637410124138, 6.1799939473470005, 5.8057612677415165, 8.770288599034146, 8.222550635536507, 8.269088377555207, -5.408809085687011, -5.578631808360427, -5.553708833952754, 6.117192461465791, 5.057100897034005, 5.2898532350858005, 5.089743516097457, 4.341760675112397, 4.92357602963844, 6.07682093729575, 5.927467008431748, 6.1644451481600555, 5.765175615747765, 6.125821118553475, 5.83580995102723, 8.669916068514183, 9.125143003960446, 9.41721313943465, 1.791540736953408, 1.1248522798220222, 2.245069815466792, 7.488681723674134, 6.956747447450951, 7.401034620900944, 3.766794230788946, 3.5594972297549248, 3.5836533159017563, 7.487417592977479, 7.188228492935494, 6.96863768001397, 5.473514832556248, 4.8957545310258865, 5.9082671301439404, 8.620305345704153, 8.709922978033617, 8.48869354029496, 2.2658983791867797, 2.3880942525962894, 0.9979313413302009, -3.388465272883579, -3.2899708139399735, -3.338926921288177, 7.812423388163239, 7.619420344630868, 7.84430546561876, 9.549820835391671, 9.323264996210725, 9.641172664860875, 9.931973081945515, 9.0177934517463, 9.16442035635312, 7.259418646494538, 7.343978191415459, 6.936272437373788, 6.2945060531298225, 6.632612427386135, 6.352001550296933, 5.549828412632138, 5.4301570753256385, 5.2281524638334815, 5.515980255169168, 5.174129982789353, 5.347413108994559, 5.320170580719903, 4.6809971084197315, 5.101275381942585, 3.856062884132058, 3.9666173184911315, 3.815151969591767, 0.7173486724495888, 0.6517192646861076, 0.7600377425551414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.146969793662946, "mean_inference_ms": 0.6413066439534538, "mean_action_processing_ms": 0.09500594244798197, "mean_env_wait_ms": 0.7944500108702948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 331200, "timesteps_this_iter": 0, "agent_timesteps_total": 993600, "timers": {"sample_time_ms": 9095.016, "sample_throughput": 527.762, "load_time_ms": 0.3, "load_throughput": 15998616.656, "learn_time_ms": 1148.616, "learn_throughput": 4178.944, "update_time_ms": 1.709}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 4.302819132804871, "policy_loss": -0.0015412911599398393, "vf_loss": 4.4148619174957275, "vf_explained_var": -0.3779369294643402, "kl": 0.009399597183856585, "entropy": 11.06690514087677, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 331200, "num_agent_steps_sampled": 993600, "num_steps_trained": 331200, "num_agent_steps_trained": 993600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2029, "training_iteration": 69, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-53-22", "timestamp": 1706147602, "time_this_iter_s": 9.05749797821045, "time_total_s": 644.5231373310089, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 644.5231373310089, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 6.083333333333335, "ram_util_percent": 45.9}}
{"episode_reward_max": 37.335009686648846, "episode_reward_min": -299.95705984532833, "episode_reward_mean": 12.227095297802284, "episode_len_mean": 299.8, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -106.55472832421462}, "policy_reward_max": {"shared_policy": 12.64238752424717}, "policy_reward_mean": {"shared_policy": 4.075698432600761}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.442015243694172, 23.656215187162132, 21.518293335102484, 17.526287138462067, 25.405767989868764, 14.178443871438503, 6.775450257584453, 16.486025121062966, 19.956494688987732, 20.98852647840974, 17.657441101968274, 21.68198695778844, 23.862272452563047, 4.293914809823036, -10.351202219724684, 3.4141009412705614, 21.57104152068493, 12.831524828448892, 23.214098908007145, 22.92871903255582, -13.836185358464732, -1.1451168619096563, 0.6290337666869021, 12.084132071584463, 32.96783988922833, 15.786571800708757, 25.014008697122335, 23.921184666454792, 28.376256056129904, 6.015567772090435, 10.547389132902012, 8.238638833165155, 7.238474577665301, 21.246227426454396, 7.063058122992516, 17.44986143708229, 13.180399216711521, -19.600462220609202, 10.576587542891488, 31.903916478157043, 20.357878156006336, 14.235201343894005, 1.4643954141065478, 31.567243317142115, -299.95705984532833, 13.373718794435234, 17.025089774280758, 31.79964147252028, 5.905566256493302, 24.919248767197118, 18.57352294027804, 21.312572260387213, -3.8710271753371046, 17.614478310570107, 7.528615400195093, 16.035233311355114, 14.264260552823515, 10.365727134980261, 18.137392625212655, 25.26192761212586, -16.541149728000192, 16.464146593585596, 14.355080220848293, 18.168733093887553, 17.72680668532847, 27.21227221190928, 5.161462832242222, 21.84646379202603, 10.909944776445627, 21.644283765926943, 16.277536493726075, 25.81892186403273, 5.65192397311327, -10.01736300811173, 23.276149198412867, 28.51425849646327, 28.114186890044934, 21.539669275283785, 19.27912003081289, 16.208137951791258, 16.03752334695308, 15.10244307108222, 11.637832172214956, 2.129105679690838, 11.448861539363833, 13.889388620853396, 21.986771658062935, 25.912022516131373, 26.582105033099623, 20.510601546615334, 23.642691273242207, -3.632876887917547, 1.849751964211464, 27.654217876493917, 20.962502591311903, 7.623387448489666, 24.130003206431837, 37.335009686648846, 25.05891743209213, 11.630257479846463], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [6.04389228423436, 5.875138570864991, 6.522984388594821, 7.925029634187609, 7.961435350279004, 7.769750202695519, 7.407518130106226, 7.0811681573589595, 7.029607047637299, 5.949251167476177, 5.797688625752926, 5.779347345232964, 8.653686214238405, 7.8945522010326385, 8.85752957459772, 4.552352249622345, 4.9927898570895195, 4.633301764726639, 2.174304850399494, 2.092031143605709, 2.5091142635792494, 5.217793355385453, 5.5988985995451515, 5.669333166132361, 6.671934030950069, 6.743748426437378, 6.540812231600285, 7.193809444705636, 7.015301878253609, 6.779415155450494, 5.924592470129326, 5.769767691691712, 5.963080940147236, 7.477625752488763, 7.07227527598539, 7.132085929314286, 7.371407240629196, 8.144689850509167, 8.346175361424685, 1.726691871881485, 1.3795894384384155, 1.1876334995031357, -3.347690065701812, -3.630276059110969, -3.3732360949119027, 1.1730880203346317, 1.0961422796050613, 1.1448706413308685, 7.573130747924239, 7.210103313128144, 6.787807459632546, 4.824552888050675, 3.9055212289094925, 4.101450711488724, 7.706624761223793, 7.768032111227512, 7.7394420355558395, 7.400998428463936, 7.720138311386108, 7.807582292705774, -4.623980181912586, -4.649620908002063, -4.562584268550083, -0.5747653444608147, -0.03791977589330031, -0.5324317415555413, 0.17211178441841923, 0.06236499299605214, 0.39455698927243077, 3.9393787309527397, 4.129052706062794, 4.01570063456893, 10.94844002773364, 11.0292081584533, 10.99019170304139, 5.125125472744301, 5.5814958115418705, 5.079950516422585, 8.449768971651793, 8.004616692662239, 8.559623032808304, 8.170826502144337, 8.08904829621315, 7.661309868097305, 9.3448259482781, 9.47234524289766, 9.559084864954144, 2.3588741421699524, 2.346384696662426, 1.3103089332580566, 3.348581944902733, 3.333212067683533, 3.8655951203157457, 2.4398421396811756, 2.8909452905257496, 2.9078514029582294, 2.5715571443239753, 2.4070449719826286, 2.2598724613586967, 6.884170236686856, 7.098349841932446, 7.263707347835094, 1.971880480647087, 2.489223539829254, 2.6019541025161743, 5.896149590611458, 5.711988300085068, 5.841723546385765, 4.3264792412519455, 4.775597892701626, 4.07832208275795, -6.5721088449160305, -6.70161595443885, -6.326737421254322, 3.2923288395007404, 3.479693730672196, 3.804564972718552, 10.648450091481209, 10.51608531177044, 10.739381074905396, 6.5723481476306915, 6.831202812492847, 6.954327195882797, 4.85712605714798, 4.364182457327843, 5.013892829418182, 0.5009354799985886, 0.09321139752864838, 0.8702485365793109, 10.241796066363648, 10.75960842830439, 10.565838822474078, -96.38100961844127, -97.02132190267245, -106.55472832421462, 4.686261183271796, 4.5860641549030845, 4.101393456260354, 5.959904214988143, 5.244617129365594, 5.820568429927022, 10.478992479542882, 10.240731815497071, 11.079917177480326, 2.187169859806687, 2.1847825261453693, 1.5336138705412452, 8.090057020386055, 8.379025777180985, 8.450165969630078, 6.333812524875, 6.265001346667603, 5.974709068735436, 6.951910744110734, 7.5949333307022755, 6.765728185574204, -0.9980560404559071, -1.2200054650505479, -1.6529656698306496, 5.770526019235447, 5.8298385639985355, 6.014113727336124, 2.40270250538984, 2.3180917004744117, 2.8078211943308418, 5.4928263910114765, 5.540671933442354, 5.001734986901283, 4.744404884676129, 4.77203659216562, 4.7478190759817664, 3.712346979416907, 3.3426165878772736, 3.310763567686081, 6.151637410124138, 6.1799939473470005, 5.8057612677415165, 8.770288599034146, 8.222550635536507, 8.269088377555207, -5.408809085687011, -5.578631808360427, -5.553708833952754, 6.117192461465791, 5.057100897034005, 5.2898532350858005, 5.089743516097457, 4.341760675112397, 4.92357602963844, 6.07682093729575, 5.927467008431748, 6.1644451481600555, 5.765175615747765, 6.125821118553475, 5.83580995102723, 8.669916068514183, 9.125143003960446, 9.41721313943465, 1.791540736953408, 1.1248522798220222, 2.245069815466792, 7.488681723674134, 6.956747447450951, 7.401034620900944, 3.766794230788946, 3.5594972297549248, 3.5836533159017563, 7.487417592977479, 7.188228492935494, 6.96863768001397, 5.473514832556248, 4.8957545310258865, 5.9082671301439404, 8.620305345704153, 8.709922978033617, 8.48869354029496, 2.2658983791867797, 2.3880942525962894, 0.9979313413302009, -3.388465272883579, -3.2899708139399735, -3.338926921288177, 7.812423388163239, 7.619420344630868, 7.84430546561876, 9.549820835391671, 9.323264996210725, 9.641172664860875, 9.931973081945515, 9.0177934517463, 9.16442035635312, 7.259418646494538, 7.343978191415459, 6.936272437373788, 6.2945060531298225, 6.632612427386135, 6.352001550296933, 5.549828412632138, 5.4301570753256385, 5.2281524638334815, 5.515980255169168, 5.174129982789353, 5.347413108994559, 5.320170580719903, 4.6809971084197315, 5.101275381942585, 3.856062884132058, 3.9666173184911315, 3.815151969591767, 0.7173486724495888, 0.6517192646861076, 0.7600377425551414, 3.6959292093912666, 3.798990520338208, 3.953941809634358, 4.694187278548867, 4.642619016269833, 4.552582326034695, 7.152001455426216, 7.662302672863007, 7.172467529773712, 8.63754595319429, 8.840575690070779, 8.433900872866303, 8.699770862857491, 9.39311760912338, 8.489216561118752, 6.979973873744399, 6.729624810318143, 6.801002862552792, 7.8966303641597335, 7.481116811434418, 8.264944097648055, -1.037910436590522, -1.6873131742080147, -0.9076532771190102, 0.5031196549534798, 0.8991723656654358, 0.44745994359254837, 9.066096787651375, 9.561978114147976, 9.026142974694565, 7.239851022760064, 7.137327122191579, 6.585324446360261, 2.7565144449472427, 2.6485725566744804, 2.218300446867943, 8.13140885780254, 7.97924259553352, 8.019351753095776, 12.64238752424717, 12.582323290407658, 12.110298871994019, 8.35550031810999, 8.641741133295, 8.061675980687141, 4.078595725198582, 3.598406141002968, 3.953255613644913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1467614787941146, "mean_inference_ms": 0.6410575887629412, "mean_action_processing_ms": 0.09498186304835038, "mean_env_wait_ms": 0.7946758136992003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"sample_time_ms": 9158.49, "sample_throughput": 524.104, "load_time_ms": 0.3, "load_throughput": 15998616.656, "learn_time_ms": 1150.115, "learn_throughput": 4173.494, "update_time_ms": 1.71}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 3.5869468450546265, "policy_loss": -0.0019526853716848036, "vf_loss": 3.700540781021118, "vf_explained_var": -0.4170656055212021, "kl": 0.008064015564799172, "entropy": 11.17849063873291, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 1008000, "num_steps_trained": 336000, "num_agent_steps_trained": 1008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2045, "training_iteration": 70, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-53-32", "timestamp": 1706147612, "time_this_iter_s": 9.651960611343384, "time_total_s": 654.1750979423523, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021063262EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 654.1750979423523, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 7.707142857142857, "ram_util_percent": 46.04285714285714}}
{"episode_reward_max": 44.39571115374565, "episode_reward_min": -299.95705984532833, "episode_reward_mean": 13.046245689767806, "episode_len_mean": 299.8, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -106.55472832421462}, "policy_reward_max": {"shared_policy": 15.166241735219955}, "policy_reward_mean": {"shared_policy": 4.348748563255935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.57104152068493, 12.831524828448892, 23.214098908007145, 22.92871903255582, -13.836185358464732, -1.1451168619096563, 0.6290337666869021, 12.084132071584463, 32.96783988922833, 15.786571800708757, 25.014008697122335, 23.921184666454792, 28.376256056129904, 6.015567772090435, 10.547389132902012, 8.238638833165155, 7.238474577665301, 21.246227426454396, 7.063058122992516, 17.44986143708229, 13.180399216711521, -19.600462220609202, 10.576587542891488, 31.903916478157043, 20.357878156006336, 14.235201343894005, 1.4643954141065478, 31.567243317142115, -299.95705984532833, 13.373718794435234, 17.025089774280758, 31.79964147252028, 5.905566256493302, 24.919248767197118, 18.57352294027804, 21.312572260387213, -3.8710271753371046, 17.614478310570107, 7.528615400195093, 16.035233311355114, 14.264260552823515, 10.365727134980261, 18.137392625212655, 25.26192761212586, -16.541149728000192, 16.464146593585596, 14.355080220848293, 18.168733093887553, 17.72680668532847, 27.21227221190928, 5.161462832242222, 21.84646379202603, 10.909944776445627, 21.644283765926943, 16.277536493726075, 25.81892186403273, 5.65192397311327, -10.01736300811173, 23.276149198412867, 28.51425849646327, 28.114186890044934, 21.539669275283785, 19.27912003081289, 16.208137951791258, 16.03752334695308, 15.10244307108222, 11.637832172214956, 2.129105679690838, 11.448861539363833, 13.889388620853396, 21.986771658062935, 25.912022516131373, 26.582105033099623, 20.510601546615334, 23.642691273242207, -3.632876887917547, 1.849751964211464, 27.654217876493917, 20.962502591311903, 7.623387448489666, 24.130003206431837, 37.335009686648846, 25.05891743209213, 11.630257479846463, -4.928136594593539, 11.756356261670561, 25.476081432774635, 20.93270565615967, 1.1350008994340612, 18.367734356783302, 41.26562660373746, 25.867414109408855, 19.878826700150967, 44.39571115374565, 43.8565204143524, 29.332182242535055, 15.204367056488962, 20.15997560694811, 1.3686026185750961, 13.338104033842683], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [7.573130747924239, 7.210103313128144, 6.787807459632546, 4.824552888050675, 3.9055212289094925, 4.101450711488724, 7.706624761223793, 7.768032111227512, 7.7394420355558395, 7.400998428463936, 7.720138311386108, 7.807582292705774, -4.623980181912586, -4.649620908002063, -4.562584268550083, -0.5747653444608147, -0.03791977589330031, -0.5324317415555413, 0.17211178441841923, 0.06236499299605214, 0.39455698927243077, 3.9393787309527397, 4.129052706062794, 4.01570063456893, 10.94844002773364, 11.0292081584533, 10.99019170304139, 5.125125472744301, 5.5814958115418705, 5.079950516422585, 8.449768971651793, 8.004616692662239, 8.559623032808304, 8.170826502144337, 8.08904829621315, 7.661309868097305, 9.3448259482781, 9.47234524289766, 9.559084864954144, 2.3588741421699524, 2.346384696662426, 1.3103089332580566, 3.348581944902733, 3.333212067683533, 3.8655951203157457, 2.4398421396811756, 2.8909452905257496, 2.9078514029582294, 2.5715571443239753, 2.4070449719826286, 2.2598724613586967, 6.884170236686856, 7.098349841932446, 7.263707347835094, 1.971880480647087, 2.489223539829254, 2.6019541025161743, 5.896149590611458, 5.711988300085068, 5.841723546385765, 4.3264792412519455, 4.775597892701626, 4.07832208275795, -6.5721088449160305, -6.70161595443885, -6.326737421254322, 3.2923288395007404, 3.479693730672196, 3.804564972718552, 10.648450091481209, 10.51608531177044, 10.739381074905396, 6.5723481476306915, 6.831202812492847, 6.954327195882797, 4.85712605714798, 4.364182457327843, 5.013892829418182, 0.5009354799985886, 0.09321139752864838, 0.8702485365793109, 10.241796066363648, 10.75960842830439, 10.565838822474078, -96.38100961844127, -97.02132190267245, -106.55472832421462, 4.686261183271796, 4.5860641549030845, 4.101393456260354, 5.959904214988143, 5.244617129365594, 5.820568429927022, 10.478992479542882, 10.240731815497071, 11.079917177480326, 2.187169859806687, 2.1847825261453693, 1.5336138705412452, 8.090057020386055, 8.379025777180985, 8.450165969630078, 6.333812524875, 6.265001346667603, 5.974709068735436, 6.951910744110734, 7.5949333307022755, 6.765728185574204, -0.9980560404559071, -1.2200054650505479, -1.6529656698306496, 5.770526019235447, 5.8298385639985355, 6.014113727336124, 2.40270250538984, 2.3180917004744117, 2.8078211943308418, 5.4928263910114765, 5.540671933442354, 5.001734986901283, 4.744404884676129, 4.77203659216562, 4.7478190759817664, 3.712346979416907, 3.3426165878772736, 3.310763567686081, 6.151637410124138, 6.1799939473470005, 5.8057612677415165, 8.770288599034146, 8.222550635536507, 8.269088377555207, -5.408809085687011, -5.578631808360427, -5.553708833952754, 6.117192461465791, 5.057100897034005, 5.2898532350858005, 5.089743516097457, 4.341760675112397, 4.92357602963844, 6.07682093729575, 5.927467008431748, 6.1644451481600555, 5.765175615747765, 6.125821118553475, 5.83580995102723, 8.669916068514183, 9.125143003960446, 9.41721313943465, 1.791540736953408, 1.1248522798220222, 2.245069815466792, 7.488681723674134, 6.956747447450951, 7.401034620900944, 3.766794230788946, 3.5594972297549248, 3.5836533159017563, 7.487417592977479, 7.188228492935494, 6.96863768001397, 5.473514832556248, 4.8957545310258865, 5.9082671301439404, 8.620305345704153, 8.709922978033617, 8.48869354029496, 2.2658983791867797, 2.3880942525962894, 0.9979313413302009, -3.388465272883579, -3.2899708139399735, -3.338926921288177, 7.812423388163239, 7.619420344630868, 7.84430546561876, 9.549820835391671, 9.323264996210725, 9.641172664860875, 9.931973081945515, 9.0177934517463, 9.16442035635312, 7.259418646494538, 7.343978191415459, 6.936272437373788, 6.2945060531298225, 6.632612427386135, 6.352001550296933, 5.549828412632138, 5.4301570753256385, 5.2281524638334815, 5.515980255169168, 5.174129982789353, 5.347413108994559, 5.320170580719903, 4.6809971084197315, 5.101275381942585, 3.856062884132058, 3.9666173184911315, 3.815151969591767, 0.7173486724495888, 0.6517192646861076, 0.7600377425551414, 3.6959292093912666, 3.798990520338208, 3.953941809634358, 4.694187278548867, 4.642619016269833, 4.552582326034695, 7.152001455426216, 7.662302672863007, 7.172467529773712, 8.63754595319429, 8.840575690070779, 8.433900872866303, 8.699770862857491, 9.39311760912338, 8.489216561118752, 6.979973873744399, 6.729624810318143, 6.801002862552792, 7.8966303641597335, 7.481116811434418, 8.264944097648055, -1.037910436590522, -1.6873131742080147, -0.9076532771190102, 0.5031196549534798, 0.8991723656654358, 0.44745994359254837, 9.066096787651375, 9.561978114147976, 9.026142974694565, 7.239851022760064, 7.137327122191579, 6.585324446360261, 2.7565144449472427, 2.6485725566744804, 2.218300446867943, 8.13140885780254, 7.97924259553352, 8.019351753095776, 12.64238752424717, 12.582323290407658, 12.110298871994019, 8.35550031810999, 8.641741133295, 8.061675980687141, 4.078595725198582, 3.598406141002968, 3.953255613644913, -1.4835409248868672, -1.4686348090569226, -1.9759608606497494, 4.196486024806887, 3.3820701191822593, 4.177800117681414, 8.547147548447043, 8.27068345497051, 8.658250429357082, 6.7218974232673645, 6.865867525339127, 7.344940707553178, 0.443165133396775, 0.15318570534387277, 0.5386500606934135, 6.332933067965001, 6.2785287468383615, 5.756272541979939, 13.732753311594323, 13.542916057010487, 13.98995723513265, 8.208655282855034, 8.742275010794401, 8.91648381575942, 6.539962589740753, 6.641096547245979, 6.697767563164234, 14.841818273067474, 14.387651145458221, 15.166241735219955, 14.814838302632168, 14.69589939465125, 14.345782717068985, 9.97931232303381, 10.039404622279108, 9.313465297222137, 5.308137255410344, 4.706498811642319, 5.189730989436299, 6.995244926462561, 6.5627028296391074, 6.60202785084644, 0.7060833871364594, 0.3347744643688202, 0.3277447670698166, 4.637444427236915, 4.706338558346033, 3.994321048259735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14657707886970317, "mean_inference_ms": 0.640916135691713, "mean_action_processing_ms": 0.09492378460409373, "mean_env_wait_ms": 0.794979240425166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 340800, "timesteps_this_iter": 0, "agent_timesteps_total": 1022400, "timers": {"sample_time_ms": 9189.733, "sample_throughput": 522.322, "load_time_ms": 0.399, "load_throughput": 12024523.204, "learn_time_ms": 1150.42, "learn_throughput": 4172.388, "update_time_ms": 1.704}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 4.124889940023422, "policy_loss": -0.003261385707303166, "vf_loss": 4.240432322025299, "vf_explained_var": -0.38412614166736603, "kl": 0.009066340368067949, "entropy": 11.244224548339844, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340800, "num_agent_steps_sampled": 1022400, "num_steps_trained": 340800, "num_agent_steps_trained": 1022400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2061, "training_iteration": 71, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-53-41", "timestamp": 1706147621, "time_this_iter_s": 9.420084238052368, "time_total_s": 663.5951821804047, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 663.5951821804047, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 6.515384615384615, "ram_util_percent": 46.11538461538463}}
{"episode_reward_max": 44.39571115374565, "episode_reward_min": -299.95705984532833, "episode_reward_mean": 12.415562603163695, "episode_len_mean": 299.8, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -106.55472832421462}, "policy_reward_max": {"shared_policy": 15.166241735219955}, "policy_reward_mean": {"shared_policy": 4.13852086772123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.238474577665301, 21.246227426454396, 7.063058122992516, 17.44986143708229, 13.180399216711521, -19.600462220609202, 10.576587542891488, 31.903916478157043, 20.357878156006336, 14.235201343894005, 1.4643954141065478, 31.567243317142115, -299.95705984532833, 13.373718794435234, 17.025089774280758, 31.79964147252028, 5.905566256493302, 24.919248767197118, 18.57352294027804, 21.312572260387213, -3.8710271753371046, 17.614478310570107, 7.528615400195093, 16.035233311355114, 14.264260552823515, 10.365727134980261, 18.137392625212655, 25.26192761212586, -16.541149728000192, 16.464146593585596, 14.355080220848293, 18.168733093887553, 17.72680668532847, 27.21227221190928, 5.161462832242222, 21.84646379202603, 10.909944776445627, 21.644283765926943, 16.277536493726075, 25.81892186403273, 5.65192397311327, -10.01736300811173, 23.276149198412867, 28.51425849646327, 28.114186890044934, 21.539669275283785, 19.27912003081289, 16.208137951791258, 16.03752334695308, 15.10244307108222, 11.637832172214956, 2.129105679690838, 11.448861539363833, 13.889388620853396, 21.986771658062935, 25.912022516131373, 26.582105033099623, 20.510601546615334, 23.642691273242207, -3.632876887917547, 1.849751964211464, 27.654217876493917, 20.962502591311903, 7.623387448489666, 24.130003206431837, 37.335009686648846, 25.05891743209213, 11.630257479846463, -4.928136594593539, 11.756356261670561, 25.476081432774635, 20.93270565615967, 1.1350008994340612, 18.367734356783302, 41.26562660373746, 25.867414109408855, 19.878826700150967, 44.39571115374565, 43.8565204143524, 29.332182242535055, 15.204367056488962, 20.15997560694811, 1.3686026185750961, 13.338104033842683, 9.468749045627163, 14.449170836247475, 22.621114075183854, -28.10496076196435, 28.751006692647906, 11.955953538417816, 13.124667517840834, 6.351419672369943, 14.338396470993743, 10.880168377421768, 19.438850516453385, -9.768386213923819, 11.608006216585636, 29.78370175510642, 6.319929208606467, 4.858609147369833], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.5715571443239753, 2.4070449719826286, 2.2598724613586967, 6.884170236686856, 7.098349841932446, 7.263707347835094, 1.971880480647087, 2.489223539829254, 2.6019541025161743, 5.896149590611458, 5.711988300085068, 5.841723546385765, 4.3264792412519455, 4.775597892701626, 4.07832208275795, -6.5721088449160305, -6.70161595443885, -6.326737421254322, 3.2923288395007404, 3.479693730672196, 3.804564972718552, 10.648450091481209, 10.51608531177044, 10.739381074905396, 6.5723481476306915, 6.831202812492847, 6.954327195882797, 4.85712605714798, 4.364182457327843, 5.013892829418182, 0.5009354799985886, 0.09321139752864838, 0.8702485365793109, 10.241796066363648, 10.75960842830439, 10.565838822474078, -96.38100961844127, -97.02132190267245, -106.55472832421462, 4.686261183271796, 4.5860641549030845, 4.101393456260354, 5.959904214988143, 5.244617129365594, 5.820568429927022, 10.478992479542882, 10.240731815497071, 11.079917177480326, 2.187169859806687, 2.1847825261453693, 1.5336138705412452, 8.090057020386055, 8.379025777180985, 8.450165969630078, 6.333812524875, 6.265001346667603, 5.974709068735436, 6.951910744110734, 7.5949333307022755, 6.765728185574204, -0.9980560404559071, -1.2200054650505479, -1.6529656698306496, 5.770526019235447, 5.8298385639985355, 6.014113727336124, 2.40270250538984, 2.3180917004744117, 2.8078211943308418, 5.4928263910114765, 5.540671933442354, 5.001734986901283, 4.744404884676129, 4.77203659216562, 4.7478190759817664, 3.712346979416907, 3.3426165878772736, 3.310763567686081, 6.151637410124138, 6.1799939473470005, 5.8057612677415165, 8.770288599034146, 8.222550635536507, 8.269088377555207, -5.408809085687011, -5.578631808360427, -5.553708833952754, 6.117192461465791, 5.057100897034005, 5.2898532350858005, 5.089743516097457, 4.341760675112397, 4.92357602963844, 6.07682093729575, 5.927467008431748, 6.1644451481600555, 5.765175615747765, 6.125821118553475, 5.83580995102723, 8.669916068514183, 9.125143003960446, 9.41721313943465, 1.791540736953408, 1.1248522798220222, 2.245069815466792, 7.488681723674134, 6.956747447450951, 7.401034620900944, 3.766794230788946, 3.5594972297549248, 3.5836533159017563, 7.487417592977479, 7.188228492935494, 6.96863768001397, 5.473514832556248, 4.8957545310258865, 5.9082671301439404, 8.620305345704153, 8.709922978033617, 8.48869354029496, 2.2658983791867797, 2.3880942525962894, 0.9979313413302009, -3.388465272883579, -3.2899708139399735, -3.338926921288177, 7.812423388163239, 7.619420344630868, 7.84430546561876, 9.549820835391671, 9.323264996210725, 9.641172664860875, 9.931973081945515, 9.0177934517463, 9.16442035635312, 7.259418646494538, 7.343978191415459, 6.936272437373788, 6.2945060531298225, 6.632612427386135, 6.352001550296933, 5.549828412632138, 5.4301570753256385, 5.2281524638334815, 5.515980255169168, 5.174129982789353, 5.347413108994559, 5.320170580719903, 4.6809971084197315, 5.101275381942585, 3.856062884132058, 3.9666173184911315, 3.815151969591767, 0.7173486724495888, 0.6517192646861076, 0.7600377425551414, 3.6959292093912666, 3.798990520338208, 3.953941809634358, 4.694187278548867, 4.642619016269833, 4.552582326034695, 7.152001455426216, 7.662302672863007, 7.172467529773712, 8.63754595319429, 8.840575690070779, 8.433900872866303, 8.699770862857491, 9.39311760912338, 8.489216561118752, 6.979973873744399, 6.729624810318143, 6.801002862552792, 7.8966303641597335, 7.481116811434418, 8.264944097648055, -1.037910436590522, -1.6873131742080147, -0.9076532771190102, 0.5031196549534798, 0.8991723656654358, 0.44745994359254837, 9.066096787651375, 9.561978114147976, 9.026142974694565, 7.239851022760064, 7.137327122191579, 6.585324446360261, 2.7565144449472427, 2.6485725566744804, 2.218300446867943, 8.13140885780254, 7.97924259553352, 8.019351753095776, 12.64238752424717, 12.582323290407658, 12.110298871994019, 8.35550031810999, 8.641741133295, 8.061675980687141, 4.078595725198582, 3.598406141002968, 3.953255613644913, -1.4835409248868672, -1.4686348090569226, -1.9759608606497494, 4.196486024806887, 3.3820701191822593, 4.177800117681414, 8.547147548447043, 8.27068345497051, 8.658250429357082, 6.7218974232673645, 6.865867525339127, 7.344940707553178, 0.443165133396775, 0.15318570534387277, 0.5386500606934135, 6.332933067965001, 6.2785287468383615, 5.756272541979939, 13.732753311594323, 13.542916057010487, 13.98995723513265, 8.208655282855034, 8.742275010794401, 8.91648381575942, 6.539962589740753, 6.641096547245979, 6.697767563164234, 14.841818273067474, 14.387651145458221, 15.166241735219955, 14.814838302632168, 14.69589939465125, 14.345782717068985, 9.97931232303381, 10.039404622279108, 9.313465297222137, 5.308137255410344, 4.706498811642319, 5.189730989436299, 6.995244926462561, 6.5627028296391074, 6.60202785084644, 0.7060833871364594, 0.3347744643688202, 0.3277447670698166, 4.637444427236915, 4.706338558346033, 3.994321048259735, 3.0532155061761443, 2.918701159457356, 3.4968323799936627, 4.996832362065703, 5.253605059968919, 4.198733414212853, 7.807537717123822, 7.2067753126223835, 7.606801045437649, -9.070189443727344, -9.620121603210777, -9.41464971502623, 9.656604307393224, 9.750343675414712, 9.34405870983997, 3.988858312368393, 4.384731724858284, 3.582363501191139, 4.301688248912484, 4.30066770563522, 4.52231156329313, 2.0264680509765896, 2.1836221975584778, 2.1413294238348755, 4.9173327473302635, 4.727867630620793, 4.693196093042687, 3.7808861487234537, 3.4700144777695243, 3.62926775092879, 6.8277854565531015, 6.365006193518639, 6.246058866381645, -2.803552263920821, -3.1299661050240246, -3.834867844978973, 3.937191382050514, 3.9295325949788094, 3.7412822395563126, 9.910706880191952, 10.105883518854768, 9.7671113560597, 2.686293931057051, 2.2198543002208027, 1.4137809773286136, 1.783690157035977, 1.8772683689991538, 1.1976506213347022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14638480603539272, "mean_inference_ms": 0.6407410138072777, "mean_action_processing_ms": 0.09486489132242039, "mean_env_wait_ms": 0.795291123792511, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 345600, "timesteps_this_iter": 0, "agent_timesteps_total": 1036800, "timers": {"sample_time_ms": 9194.756, "sample_throughput": 522.037, "load_time_ms": 0.399, "load_throughput": 12024523.204, "learn_time_ms": 1152.922, "learn_throughput": 4163.336, "update_time_ms": 1.703}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 3.5432425141334534, "policy_loss": -0.002415909473529654, "vf_loss": 3.659514367580414, "vf_explained_var": -0.470876544713974, "kl": 0.012150399910813287, "entropy": 11.407209753990173, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 345600, "num_agent_steps_sampled": 1036800, "num_steps_trained": 345600, "num_agent_steps_trained": 1036800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2077, "training_iteration": 72, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-53-51", "timestamp": 1706147631, "time_this_iter_s": 9.096827507019043, "time_total_s": 672.6920096874237, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C115E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 672.6920096874237, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 10.330769230769231, "ram_util_percent": 46.0}}
{"episode_reward_max": 44.39571115374565, "episode_reward_min": -28.10496076196435, "episode_reward_mean": 15.617422646933393, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -9.620121603210777}, "policy_reward_max": {"shared_policy": 15.166241735219955}, "policy_reward_mean": {"shared_policy": 5.205807548977798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.905566256493302, 24.919248767197118, 18.57352294027804, 21.312572260387213, -3.8710271753371046, 17.614478310570107, 7.528615400195093, 16.035233311355114, 14.264260552823515, 10.365727134980261, 18.137392625212655, 25.26192761212586, -16.541149728000192, 16.464146593585596, 14.355080220848293, 18.168733093887553, 17.72680668532847, 27.21227221190928, 5.161462832242222, 21.84646379202603, 10.909944776445627, 21.644283765926943, 16.277536493726075, 25.81892186403273, 5.65192397311327, -10.01736300811173, 23.276149198412867, 28.51425849646327, 28.114186890044934, 21.539669275283785, 19.27912003081289, 16.208137951791258, 16.03752334695308, 15.10244307108222, 11.637832172214956, 2.129105679690838, 11.448861539363833, 13.889388620853396, 21.986771658062935, 25.912022516131373, 26.582105033099623, 20.510601546615334, 23.642691273242207, -3.632876887917547, 1.849751964211464, 27.654217876493917, 20.962502591311903, 7.623387448489666, 24.130003206431837, 37.335009686648846, 25.05891743209213, 11.630257479846463, -4.928136594593539, 11.756356261670561, 25.476081432774635, 20.93270565615967, 1.1350008994340612, 18.367734356783302, 41.26562660373746, 25.867414109408855, 19.878826700150967, 44.39571115374565, 43.8565204143524, 29.332182242535055, 15.204367056488962, 20.15997560694811, 1.3686026185750961, 13.338104033842683, 9.468749045627163, 14.449170836247475, 22.621114075183854, -28.10496076196435, 28.751006692647906, 11.955953538417816, 13.124667517840834, 6.351419672369943, 14.338396470993743, 10.880168377421768, 19.438850516453385, -9.768386213923819, 11.608006216585636, 29.78370175510642, 6.319929208606467, 4.858609147369833, 32.97085355594754, 21.824560701847048, 7.986180916428552, 15.752721199998604, 18.465698607265935, 0.4568788930773451, 26.487517589703202, 17.95986064895986, 2.9520110078155852, 6.087948784232125, -0.052473776042475606, 12.150447584688663, 12.523267209529862, 37.833937532268465, 17.89262717962265, 7.818137750029564], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.187169859806687, 2.1847825261453693, 1.5336138705412452, 8.090057020386055, 8.379025777180985, 8.450165969630078, 6.333812524875, 6.265001346667603, 5.974709068735436, 6.951910744110734, 7.5949333307022755, 6.765728185574204, -0.9980560404559071, -1.2200054650505479, -1.6529656698306496, 5.770526019235447, 5.8298385639985355, 6.014113727336124, 2.40270250538984, 2.3180917004744117, 2.8078211943308418, 5.4928263910114765, 5.540671933442354, 5.001734986901283, 4.744404884676129, 4.77203659216562, 4.7478190759817664, 3.712346979416907, 3.3426165878772736, 3.310763567686081, 6.151637410124138, 6.1799939473470005, 5.8057612677415165, 8.770288599034146, 8.222550635536507, 8.269088377555207, -5.408809085687011, -5.578631808360427, -5.553708833952754, 6.117192461465791, 5.057100897034005, 5.2898532350858005, 5.089743516097457, 4.341760675112397, 4.92357602963844, 6.07682093729575, 5.927467008431748, 6.1644451481600555, 5.765175615747765, 6.125821118553475, 5.83580995102723, 8.669916068514183, 9.125143003960446, 9.41721313943465, 1.791540736953408, 1.1248522798220222, 2.245069815466792, 7.488681723674134, 6.956747447450951, 7.401034620900944, 3.766794230788946, 3.5594972297549248, 3.5836533159017563, 7.487417592977479, 7.188228492935494, 6.96863768001397, 5.473514832556248, 4.8957545310258865, 5.9082671301439404, 8.620305345704153, 8.709922978033617, 8.48869354029496, 2.2658983791867797, 2.3880942525962894, 0.9979313413302009, -3.388465272883579, -3.2899708139399735, -3.338926921288177, 7.812423388163239, 7.619420344630868, 7.84430546561876, 9.549820835391671, 9.323264996210725, 9.641172664860875, 9.931973081945515, 9.0177934517463, 9.16442035635312, 7.259418646494538, 7.343978191415459, 6.936272437373788, 6.2945060531298225, 6.632612427386135, 6.352001550296933, 5.549828412632138, 5.4301570753256385, 5.2281524638334815, 5.515980255169168, 5.174129982789353, 5.347413108994559, 5.320170580719903, 4.6809971084197315, 5.101275381942585, 3.856062884132058, 3.9666173184911315, 3.815151969591767, 0.7173486724495888, 0.6517192646861076, 0.7600377425551414, 3.6959292093912666, 3.798990520338208, 3.953941809634358, 4.694187278548867, 4.642619016269833, 4.552582326034695, 7.152001455426216, 7.662302672863007, 7.172467529773712, 8.63754595319429, 8.840575690070779, 8.433900872866303, 8.699770862857491, 9.39311760912338, 8.489216561118752, 6.979973873744399, 6.729624810318143, 6.801002862552792, 7.8966303641597335, 7.481116811434418, 8.264944097648055, -1.037910436590522, -1.6873131742080147, -0.9076532771190102, 0.5031196549534798, 0.8991723656654358, 0.44745994359254837, 9.066096787651375, 9.561978114147976, 9.026142974694565, 7.239851022760064, 7.137327122191579, 6.585324446360261, 2.7565144449472427, 2.6485725566744804, 2.218300446867943, 8.13140885780254, 7.97924259553352, 8.019351753095776, 12.64238752424717, 12.582323290407658, 12.110298871994019, 8.35550031810999, 8.641741133295, 8.061675980687141, 4.078595725198582, 3.598406141002968, 3.953255613644913, -1.4835409248868672, -1.4686348090569226, -1.9759608606497494, 4.196486024806887, 3.3820701191822593, 4.177800117681414, 8.547147548447043, 8.27068345497051, 8.658250429357082, 6.7218974232673645, 6.865867525339127, 7.344940707553178, 0.443165133396775, 0.15318570534387277, 0.5386500606934135, 6.332933067965001, 6.2785287468383615, 5.756272541979939, 13.732753311594323, 13.542916057010487, 13.98995723513265, 8.208655282855034, 8.742275010794401, 8.91648381575942, 6.539962589740753, 6.641096547245979, 6.697767563164234, 14.841818273067474, 14.387651145458221, 15.166241735219955, 14.814838302632168, 14.69589939465125, 14.345782717068985, 9.97931232303381, 10.039404622279108, 9.313465297222137, 5.308137255410344, 4.706498811642319, 5.189730989436299, 6.995244926462561, 6.5627028296391074, 6.60202785084644, 0.7060833871364594, 0.3347744643688202, 0.3277447670698166, 4.637444427236915, 4.706338558346033, 3.994321048259735, 3.0532155061761443, 2.918701159457356, 3.4968323799936627, 4.996832362065703, 5.253605059968919, 4.198733414212853, 7.807537717123822, 7.2067753126223835, 7.606801045437649, -9.070189443727344, -9.620121603210777, -9.41464971502623, 9.656604307393224, 9.750343675414712, 9.34405870983997, 3.988858312368393, 4.384731724858284, 3.582363501191139, 4.301688248912484, 4.30066770563522, 4.52231156329313, 2.0264680509765896, 2.1836221975584778, 2.1413294238348755, 4.9173327473302635, 4.727867630620793, 4.693196093042687, 3.7808861487234537, 3.4700144777695243, 3.62926775092879, 6.8277854565531015, 6.365006193518639, 6.246058866381645, -2.803552263920821, -3.1299661050240246, -3.834867844978973, 3.937191382050514, 3.9295325949788094, 3.7412822395563126, 9.910706880191952, 10.105883518854768, 9.7671113560597, 2.686293931057051, 2.2198543002208027, 1.4137809773286136, 1.783690157035977, 1.8772683689991538, 1.1976506213347022, 10.940279692411423, 10.837760224938393, 11.192813638597727, 7.262245173255593, 7.282646464804799, 7.279669063786656, 2.710004692276314, 2.457968985040978, 2.81820723911126, 4.766096810499818, 5.563199556355045, 5.423424833143741, 6.229502727588013, 6.206517053147152, 6.02967882653077, 0.26753904173770593, 0.1831282476584022, 0.006211603681236966, 8.712654039263725, 9.04497773386538, 8.729885816574097, 6.30799377088745, 5.67056607206662, 5.981300806005791, 0.9116945241888317, 1.1778001127143654, 0.8625163709123882, 1.9550484021504673, 2.028499280412987, 2.104401101668671, 0.09535927077133977, 0.021065098543957106, -0.16889814535777248, 4.047423735260963, 3.945256158709526, 4.157767690718174, 3.794630472858742, 4.308535238107041, 4.42010149856408, 12.65297632664442, 12.87471869494766, 12.306242510676384, 6.111155606806278, 6.167235903441906, 5.614235669374466, 2.680812418460846, 2.1669045239686966, 2.9704208076000214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14618670427621028, "mean_inference_ms": 0.6405491309983005, "mean_action_processing_ms": 0.09480053560339721, "mean_env_wait_ms": 0.795611134857932, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 350400, "timesteps_this_iter": 0, "agent_timesteps_total": 1051200, "timers": {"sample_time_ms": 9196.81, "sample_throughput": 521.92, "load_time_ms": 0.299, "load_throughput": 16041959.522, "learn_time_ms": 1155.822, "learn_throughput": 4152.887, "update_time_ms": 1.802}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 2.5110836923122406, "policy_loss": -0.0028310650762756184, "vf_loss": 2.6277385354042053, "vf_explained_var": -0.48669499158859253, "kl": 0.007942510565108488, "entropy": 11.396516561508179, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 350400, "num_agent_steps_sampled": 1051200, "num_steps_trained": 350400, "num_agent_steps_trained": 1051200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2093, "training_iteration": 73, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-54-00", "timestamp": 1706147640, "time_this_iter_s": 9.045297861099243, "time_total_s": 681.737307548523, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210630AA790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 681.737307548523, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 6.276923076923077, "ram_util_percent": 46.00769230769231}}
{"episode_reward_max": 57.22045457456261, "episode_reward_min": -293.6706917732954, "episode_reward_mean": 13.655727395776761, "episode_len_mean": 298.07, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -104.58387392262618}, "policy_reward_max": {"shared_policy": 19.251941707916558}, "policy_reward_mean": {"shared_policy": 4.551909131925586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.21227221190928, 5.161462832242222, 21.84646379202603, 10.909944776445627, 21.644283765926943, 16.277536493726075, 25.81892186403273, 5.65192397311327, -10.01736300811173, 23.276149198412867, 28.51425849646327, 28.114186890044934, 21.539669275283785, 19.27912003081289, 16.208137951791258, 16.03752334695308, 15.10244307108222, 11.637832172214956, 2.129105679690838, 11.448861539363833, 13.889388620853396, 21.986771658062935, 25.912022516131373, 26.582105033099623, 20.510601546615334, 23.642691273242207, -3.632876887917547, 1.849751964211464, 27.654217876493917, 20.962502591311903, 7.623387448489666, 24.130003206431837, 37.335009686648846, 25.05891743209213, 11.630257479846463, -4.928136594593539, 11.756356261670561, 25.476081432774635, 20.93270565615967, 1.1350008994340612, 18.367734356783302, 41.26562660373746, 25.867414109408855, 19.878826700150967, 44.39571115374565, 43.8565204143524, 29.332182242535055, 15.204367056488962, 20.15997560694811, 1.3686026185750961, 13.338104033842683, 9.468749045627163, 14.449170836247475, 22.621114075183854, -28.10496076196435, 28.751006692647906, 11.955953538417816, 13.124667517840834, 6.351419672369943, 14.338396470993743, 10.880168377421768, 19.438850516453385, -9.768386213923819, 11.608006216585636, 29.78370175510642, 6.319929208606467, 4.858609147369833, 32.97085355594754, 21.824560701847048, 7.986180916428552, 15.752721199998604, 18.465698607265935, 0.4568788930773451, 26.487517589703202, 17.95986064895986, 2.9520110078155852, 6.087948784232125, -0.052473776042475606, 12.150447584688663, 12.523267209529862, 37.833937532268465, 17.89262717962265, 7.818137750029564, 4.263589534908533, 6.107849968597279, -293.6706917732954, 57.22045457456261, 42.93169916150508, 15.396855236962438, 6.898678313940749, 0.004798233509063721, 5.2185999080538465, 25.506895039230585, 8.050885416567297, 11.867648266255827, 44.02904502488671, 22.2917457818985, 17.912894878536463, 37.70517696626483, 18.315485213883193], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [8.669916068514183, 9.125143003960446, 9.41721313943465, 1.791540736953408, 1.1248522798220222, 2.245069815466792, 7.488681723674134, 6.956747447450951, 7.401034620900944, 3.766794230788946, 3.5594972297549248, 3.5836533159017563, 7.487417592977479, 7.188228492935494, 6.96863768001397, 5.473514832556248, 4.8957545310258865, 5.9082671301439404, 8.620305345704153, 8.709922978033617, 8.48869354029496, 2.2658983791867797, 2.3880942525962894, 0.9979313413302009, -3.388465272883579, -3.2899708139399735, -3.338926921288177, 7.812423388163239, 7.619420344630868, 7.84430546561876, 9.549820835391671, 9.323264996210725, 9.641172664860875, 9.931973081945515, 9.0177934517463, 9.16442035635312, 7.259418646494538, 7.343978191415459, 6.936272437373788, 6.2945060531298225, 6.632612427386135, 6.352001550296933, 5.549828412632138, 5.4301570753256385, 5.2281524638334815, 5.515980255169168, 5.174129982789353, 5.347413108994559, 5.320170580719903, 4.6809971084197315, 5.101275381942585, 3.856062884132058, 3.9666173184911315, 3.815151969591767, 0.7173486724495888, 0.6517192646861076, 0.7600377425551414, 3.6959292093912666, 3.798990520338208, 3.953941809634358, 4.694187278548867, 4.642619016269833, 4.552582326034695, 7.152001455426216, 7.662302672863007, 7.172467529773712, 8.63754595319429, 8.840575690070779, 8.433900872866303, 8.699770862857491, 9.39311760912338, 8.489216561118752, 6.979973873744399, 6.729624810318143, 6.801002862552792, 7.8966303641597335, 7.481116811434418, 8.264944097648055, -1.037910436590522, -1.6873131742080147, -0.9076532771190102, 0.5031196549534798, 0.8991723656654358, 0.44745994359254837, 9.066096787651375, 9.561978114147976, 9.026142974694565, 7.239851022760064, 7.137327122191579, 6.585324446360261, 2.7565144449472427, 2.6485725566744804, 2.218300446867943, 8.13140885780254, 7.97924259553352, 8.019351753095776, 12.64238752424717, 12.582323290407658, 12.110298871994019, 8.35550031810999, 8.641741133295, 8.061675980687141, 4.078595725198582, 3.598406141002968, 3.953255613644913, -1.4835409248868672, -1.4686348090569226, -1.9759608606497494, 4.196486024806887, 3.3820701191822593, 4.177800117681414, 8.547147548447043, 8.27068345497051, 8.658250429357082, 6.7218974232673645, 6.865867525339127, 7.344940707553178, 0.443165133396775, 0.15318570534387277, 0.5386500606934135, 6.332933067965001, 6.2785287468383615, 5.756272541979939, 13.732753311594323, 13.542916057010487, 13.98995723513265, 8.208655282855034, 8.742275010794401, 8.91648381575942, 6.539962589740753, 6.641096547245979, 6.697767563164234, 14.841818273067474, 14.387651145458221, 15.166241735219955, 14.814838302632168, 14.69589939465125, 14.345782717068985, 9.97931232303381, 10.039404622279108, 9.313465297222137, 5.308137255410344, 4.706498811642319, 5.189730989436299, 6.995244926462561, 6.5627028296391074, 6.60202785084644, 0.7060833871364594, 0.3347744643688202, 0.3277447670698166, 4.637444427236915, 4.706338558346033, 3.994321048259735, 3.0532155061761443, 2.918701159457356, 3.4968323799936627, 4.996832362065703, 5.253605059968919, 4.198733414212853, 7.807537717123822, 7.2067753126223835, 7.606801045437649, -9.070189443727344, -9.620121603210777, -9.41464971502623, 9.656604307393224, 9.750343675414712, 9.34405870983997, 3.988858312368393, 4.384731724858284, 3.582363501191139, 4.301688248912484, 4.30066770563522, 4.52231156329313, 2.0264680509765896, 2.1836221975584778, 2.1413294238348755, 4.9173327473302635, 4.727867630620793, 4.693196093042687, 3.7808861487234537, 3.4700144777695243, 3.62926775092879, 6.8277854565531015, 6.365006193518639, 6.246058866381645, -2.803552263920821, -3.1299661050240246, -3.834867844978973, 3.937191382050514, 3.9295325949788094, 3.7412822395563126, 9.910706880191952, 10.105883518854768, 9.7671113560597, 2.686293931057051, 2.2198543002208027, 1.4137809773286136, 1.783690157035977, 1.8772683689991538, 1.1976506213347022, 10.940279692411423, 10.837760224938393, 11.192813638597727, 7.262245173255593, 7.282646464804799, 7.279669063786656, 2.710004692276314, 2.457968985040978, 2.81820723911126, 4.766096810499818, 5.563199556355045, 5.423424833143741, 6.229502727588013, 6.206517053147152, 6.02967882653077, 0.26753904173770593, 0.1831282476584022, 0.006211603681236966, 8.712654039263725, 9.04497773386538, 8.729885816574097, 6.30799377088745, 5.67056607206662, 5.981300806005791, 0.9116945241888317, 1.1778001127143654, 0.8625163709123882, 1.9550484021504673, 2.028499280412987, 2.104401101668671, 0.09535927077133977, 0.021065098543957106, -0.16889814535777248, 4.047423735260963, 3.945256158709526, 4.157767690718174, 3.794630472858742, 4.308535238107041, 4.42010149856408, 12.65297632664442, 12.87471869494766, 12.306242510676384, 6.111155606806278, 6.167235903441906, 5.614235669374466, 2.680812418460846, 2.1669045239686966, 2.9704208076000214, 1.5693770051002502, 0.9108964800834656, 1.7833160497248173, 2.224225919072822, 1.8906185080607685, 1.9930055414636882, -94.97636112074058, -104.58387392262618, -94.11045672992866, 19.004968237131834, 19.251941707916558, 18.963544629514217, 13.880164643128708, 14.429697209348276, 14.621837309028095, 5.0705970376729965, 5.154290140606463, 5.171968058682978, 2.07281895478566, 2.3885557850201877, 2.4373035741349014, 0.16175483167171478, -0.08867751061916351, -0.06827908754348755, 1.8249005402127807, 1.9084779123465125, 1.4852214554945533, 8.800918821245432, 8.335248276591301, 8.370727941393852, 2.357131178180367, 2.7081941912571494, 2.9855600471297805, 4.034525322417409, 3.92909603069225, 3.9040269131461685, 14.528309424718216, 14.885562016939119, 14.615173583229378, 7.4692955911159515, 7.38825998455286, 7.434190206229687, 6.020884141325951, 6.465072054415941, 5.426938682794571, 11.881419544418648, 12.854752385367945, 12.969005036478237, 6.163946910450846, 5.9072126249472205, 6.244325678485126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14598555972364707, "mean_inference_ms": 0.6403894961338328, "mean_action_processing_ms": 0.09471484762637374, "mean_env_wait_ms": 0.7959653044720568, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 355200, "timesteps_this_iter": 0, "agent_timesteps_total": 1065600, "timers": {"sample_time_ms": 9196.227, "sample_throughput": 521.953, "load_time_ms": 0.299, "load_throughput": 16041959.522, "learn_time_ms": 1156.415, "learn_throughput": 4150.759, "update_time_ms": 1.703}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0177978515625, "cur_lr": 0.0005, "total_loss": 100.44127655029297, "policy_loss": -0.001240133648073627, "vf_loss": 100.557373046875, "vf_explained_var": -0.011194348335266113, "kl": 0.02012187681982363, "entropy": 11.521654844284058, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 355200, "num_agent_steps_sampled": 1065600, "num_steps_trained": 355200, "num_agent_steps_trained": 1065600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2110, "training_iteration": 74, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-54-09", "timestamp": 1706147649, "time_this_iter_s": 9.102854251861572, "time_total_s": 690.8401618003845, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C5E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 690.8401618003845, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 5.13846153846154, "ram_util_percent": 45.99230769230769}}
{"episode_reward_max": 57.22045457456261, "episode_reward_min": -293.6706917732954, "episode_reward_mean": 14.869574832024213, "episode_len_mean": 298.07, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.58387392262618}, "policy_reward_max": {"shared_policy": 19.251941707916558}, "policy_reward_mean": {"shared_policy": 4.956524944008072}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.10244307108222, 11.637832172214956, 2.129105679690838, 11.448861539363833, 13.889388620853396, 21.986771658062935, 25.912022516131373, 26.582105033099623, 20.510601546615334, 23.642691273242207, -3.632876887917547, 1.849751964211464, 27.654217876493917, 20.962502591311903, 7.623387448489666, 24.130003206431837, 37.335009686648846, 25.05891743209213, 11.630257479846463, -4.928136594593539, 11.756356261670561, 25.476081432774635, 20.93270565615967, 1.1350008994340612, 18.367734356783302, 41.26562660373746, 25.867414109408855, 19.878826700150967, 44.39571115374565, 43.8565204143524, 29.332182242535055, 15.204367056488962, 20.15997560694811, 1.3686026185750961, 13.338104033842683, 9.468749045627163, 14.449170836247475, 22.621114075183854, -28.10496076196435, 28.751006692647906, 11.955953538417816, 13.124667517840834, 6.351419672369943, 14.338396470993743, 10.880168377421768, 19.438850516453385, -9.768386213923819, 11.608006216585636, 29.78370175510642, 6.319929208606467, 4.858609147369833, 32.97085355594754, 21.824560701847048, 7.986180916428552, 15.752721199998604, 18.465698607265935, 0.4568788930773451, 26.487517589703202, 17.95986064895986, 2.9520110078155852, 6.087948784232125, -0.052473776042475606, 12.150447584688663, 12.523267209529862, 37.833937532268465, 17.89262717962265, 7.818137750029564, 4.263589534908533, 6.107849968597279, -293.6706917732954, 57.22045457456261, 42.93169916150508, 15.396855236962438, 6.898678313940749, 0.004798233509063721, 5.2185999080538465, 25.506895039230585, 8.050885416567297, 11.867648266255827, 44.02904502488671, 22.2917457818985, 17.912894878536463, 37.70517696626483, 18.315485213883193, 28.653912737965555, 29.452353321015806, 17.689066782593727, 36.6380350217223, 16.028150871396065, 19.855220545083256, 48.0021595293656, 22.18103821109979, 8.429347589611993, 25.000760182738276, 35.63009651750326, 19.601245611906023, 30.8021187521517, 23.945862978696795, 17.059863448143005, 19.890003414824605], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.320170580719903, 4.6809971084197315, 5.101275381942585, 3.856062884132058, 3.9666173184911315, 3.815151969591767, 0.7173486724495888, 0.6517192646861076, 0.7600377425551414, 3.6959292093912666, 3.798990520338208, 3.953941809634358, 4.694187278548867, 4.642619016269833, 4.552582326034695, 7.152001455426216, 7.662302672863007, 7.172467529773712, 8.63754595319429, 8.840575690070779, 8.433900872866303, 8.699770862857491, 9.39311760912338, 8.489216561118752, 6.979973873744399, 6.729624810318143, 6.801002862552792, 7.8966303641597335, 7.481116811434418, 8.264944097648055, -1.037910436590522, -1.6873131742080147, -0.9076532771190102, 0.5031196549534798, 0.8991723656654358, 0.44745994359254837, 9.066096787651375, 9.561978114147976, 9.026142974694565, 7.239851022760064, 7.137327122191579, 6.585324446360261, 2.7565144449472427, 2.6485725566744804, 2.218300446867943, 8.13140885780254, 7.97924259553352, 8.019351753095776, 12.64238752424717, 12.582323290407658, 12.110298871994019, 8.35550031810999, 8.641741133295, 8.061675980687141, 4.078595725198582, 3.598406141002968, 3.953255613644913, -1.4835409248868672, -1.4686348090569226, -1.9759608606497494, 4.196486024806887, 3.3820701191822593, 4.177800117681414, 8.547147548447043, 8.27068345497051, 8.658250429357082, 6.7218974232673645, 6.865867525339127, 7.344940707553178, 0.443165133396775, 0.15318570534387277, 0.5386500606934135, 6.332933067965001, 6.2785287468383615, 5.756272541979939, 13.732753311594323, 13.542916057010487, 13.98995723513265, 8.208655282855034, 8.742275010794401, 8.91648381575942, 6.539962589740753, 6.641096547245979, 6.697767563164234, 14.841818273067474, 14.387651145458221, 15.166241735219955, 14.814838302632168, 14.69589939465125, 14.345782717068985, 9.97931232303381, 10.039404622279108, 9.313465297222137, 5.308137255410344, 4.706498811642319, 5.189730989436299, 6.995244926462561, 6.5627028296391074, 6.60202785084644, 0.7060833871364594, 0.3347744643688202, 0.3277447670698166, 4.637444427236915, 4.706338558346033, 3.994321048259735, 3.0532155061761443, 2.918701159457356, 3.4968323799936627, 4.996832362065703, 5.253605059968919, 4.198733414212853, 7.807537717123822, 7.2067753126223835, 7.606801045437649, -9.070189443727344, -9.620121603210777, -9.41464971502623, 9.656604307393224, 9.750343675414712, 9.34405870983997, 3.988858312368393, 4.384731724858284, 3.582363501191139, 4.301688248912484, 4.30066770563522, 4.52231156329313, 2.0264680509765896, 2.1836221975584778, 2.1413294238348755, 4.9173327473302635, 4.727867630620793, 4.693196093042687, 3.7808861487234537, 3.4700144777695243, 3.62926775092879, 6.8277854565531015, 6.365006193518639, 6.246058866381645, -2.803552263920821, -3.1299661050240246, -3.834867844978973, 3.937191382050514, 3.9295325949788094, 3.7412822395563126, 9.910706880191952, 10.105883518854768, 9.7671113560597, 2.686293931057051, 2.2198543002208027, 1.4137809773286136, 1.783690157035977, 1.8772683689991538, 1.1976506213347022, 10.940279692411423, 10.837760224938393, 11.192813638597727, 7.262245173255593, 7.282646464804799, 7.279669063786656, 2.710004692276314, 2.457968985040978, 2.81820723911126, 4.766096810499818, 5.563199556355045, 5.423424833143741, 6.229502727588013, 6.206517053147152, 6.02967882653077, 0.26753904173770593, 0.1831282476584022, 0.006211603681236966, 8.712654039263725, 9.04497773386538, 8.729885816574097, 6.30799377088745, 5.67056607206662, 5.981300806005791, 0.9116945241888317, 1.1778001127143654, 0.8625163709123882, 1.9550484021504673, 2.028499280412987, 2.104401101668671, 0.09535927077133977, 0.021065098543957106, -0.16889814535777248, 4.047423735260963, 3.945256158709526, 4.157767690718174, 3.794630472858742, 4.308535238107041, 4.42010149856408, 12.65297632664442, 12.87471869494766, 12.306242510676384, 6.111155606806278, 6.167235903441906, 5.614235669374466, 2.680812418460846, 2.1669045239686966, 2.9704208076000214, 1.5693770051002502, 0.9108964800834656, 1.7833160497248173, 2.224225919072822, 1.8906185080607685, 1.9930055414636882, -94.97636112074058, -104.58387392262618, -94.11045672992866, 19.004968237131834, 19.251941707916558, 18.963544629514217, 13.880164643128708, 14.429697209348276, 14.621837309028095, 5.0705970376729965, 5.154290140606463, 5.171968058682978, 2.07281895478566, 2.3885557850201877, 2.4373035741349014, 0.16175483167171478, -0.08867751061916351, -0.06827908754348755, 1.8249005402127807, 1.9084779123465125, 1.4852214554945533, 8.800918821245432, 8.335248276591301, 8.370727941393852, 2.357131178180367, 2.7081941912571494, 2.9855600471297805, 4.034525322417409, 3.92909603069225, 3.9040269131461685, 14.528309424718216, 14.885562016939119, 14.615173583229378, 7.4692955911159515, 7.38825998455286, 7.434190206229687, 6.020884141325951, 6.465072054415941, 5.426938682794571, 11.881419544418648, 12.854752385367945, 12.969005036478237, 6.163946910450846, 5.9072126249472205, 6.244325678485126, 9.583830612401158, 9.921150880555302, 9.148931245009095, 9.3747781018416, 10.029303933183343, 10.048271285990864, 5.760686829686165, 6.158595889806747, 5.769784063100815, 12.191270885368183, 12.116652612884835, 12.330111523469284, 5.607044234871864, 5.163802340626717, 5.257304295897484, 7.0280693608025615, 6.3421057114998405, 6.485045472780854, 16.21967400237918, 16.315984514541924, 15.466501012444496, 7.3932123159368786, 7.15245485057433, 7.635371044588581, 2.9470746268828663, 3.1395937552054676, 2.342679207523659, 8.296745332578809, 8.452227289477975, 8.251787560681493, 12.07105227559805, 11.78038527071476, 11.778658971190453, 6.904557252923638, 6.832819486657769, 5.863868872324616, 10.441769967476517, 9.729633192221314, 10.630715592453868, 7.971282387773186, 8.081669295827538, 7.89291129509607, 5.862516418099403, 5.9182373732328415, 5.2791096568107605, 6.592530321329832, 6.807846298441291, 6.489626795053482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1457950340722258, "mean_inference_ms": 0.6402991132074205, "mean_action_processing_ms": 0.09462418946869672, "mean_env_wait_ms": 0.7963462325076799, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 9216.202, "sample_throughput": 520.822, "load_time_ms": 0.299, "load_throughput": 16041959.522, "learn_time_ms": 1163.24, "learn_throughput": 4126.405, "update_time_ms": 1.802}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.026696777343750002, "cur_lr": 0.0005, "total_loss": 3.817999482154846, "policy_loss": -0.004166947266591503, "vf_loss": 3.936488449573517, "vf_explained_var": -0.37188610434532166, "kl": 0.0057698989767907315, "entropy": 11.447627305984497, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 360000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2126, "training_iteration": 75, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-54-18", "timestamp": 1706147658, "time_this_iter_s": 9.306324481964111, "time_total_s": 700.1464862823486, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 700.1464862823486, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 5.9692307692307685, "ram_util_percent": 46.04615384615385}}
{"episode_reward_max": 57.22045457456261, "episode_reward_min": -293.6706917732954, "episode_reward_mean": 16.35571567100559, "episode_len_mean": 298.07, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.58387392262618}, "policy_reward_max": {"shared_policy": 19.251941707916558}, "policy_reward_mean": {"shared_policy": 5.45190522366853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.335009686648846, 25.05891743209213, 11.630257479846463, -4.928136594593539, 11.756356261670561, 25.476081432774635, 20.93270565615967, 1.1350008994340612, 18.367734356783302, 41.26562660373746, 25.867414109408855, 19.878826700150967, 44.39571115374565, 43.8565204143524, 29.332182242535055, 15.204367056488962, 20.15997560694811, 1.3686026185750961, 13.338104033842683, 9.468749045627163, 14.449170836247475, 22.621114075183854, -28.10496076196435, 28.751006692647906, 11.955953538417816, 13.124667517840834, 6.351419672369943, 14.338396470993743, 10.880168377421768, 19.438850516453385, -9.768386213923819, 11.608006216585636, 29.78370175510642, 6.319929208606467, 4.858609147369833, 32.97085355594754, 21.824560701847048, 7.986180916428552, 15.752721199998604, 18.465698607265935, 0.4568788930773451, 26.487517589703202, 17.95986064895986, 2.9520110078155852, 6.087948784232125, -0.052473776042475606, 12.150447584688663, 12.523267209529862, 37.833937532268465, 17.89262717962265, 7.818137750029564, 4.263589534908533, 6.107849968597279, -293.6706917732954, 57.22045457456261, 42.93169916150508, 15.396855236962438, 6.898678313940749, 0.004798233509063721, 5.2185999080538465, 25.506895039230585, 8.050885416567297, 11.867648266255827, 44.02904502488671, 22.2917457818985, 17.912894878536463, 37.70517696626483, 18.315485213883193, 28.653912737965555, 29.452353321015806, 17.689066782593727, 36.6380350217223, 16.028150871396065, 19.855220545083256, 48.0021595293656, 22.18103821109979, 8.429347589611993, 25.000760182738276, 35.63009651750326, 19.601245611906023, 30.8021187521517, 23.945862978696795, 17.059863448143005, 19.890003414824605, 23.256802294403286, 29.948200606740983, 27.794639706145944, 34.80444546416399, 18.988765381276608, 40.88490998372434, 35.282303419779055, 18.54074512794611, 18.27921006269753, 15.133304923772812, 29.233520545065375, 27.282723754644394, 14.107208326458931, 17.504319056868553, 23.30341968638821, 25.698374867439256], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [12.64238752424717, 12.582323290407658, 12.110298871994019, 8.35550031810999, 8.641741133295, 8.061675980687141, 4.078595725198582, 3.598406141002968, 3.953255613644913, -1.4835409248868672, -1.4686348090569226, -1.9759608606497494, 4.196486024806887, 3.3820701191822593, 4.177800117681414, 8.547147548447043, 8.27068345497051, 8.658250429357082, 6.7218974232673645, 6.865867525339127, 7.344940707553178, 0.443165133396775, 0.15318570534387277, 0.5386500606934135, 6.332933067965001, 6.2785287468383615, 5.756272541979939, 13.732753311594323, 13.542916057010487, 13.98995723513265, 8.208655282855034, 8.742275010794401, 8.91648381575942, 6.539962589740753, 6.641096547245979, 6.697767563164234, 14.841818273067474, 14.387651145458221, 15.166241735219955, 14.814838302632168, 14.69589939465125, 14.345782717068985, 9.97931232303381, 10.039404622279108, 9.313465297222137, 5.308137255410344, 4.706498811642319, 5.189730989436299, 6.995244926462561, 6.5627028296391074, 6.60202785084644, 0.7060833871364594, 0.3347744643688202, 0.3277447670698166, 4.637444427236915, 4.706338558346033, 3.994321048259735, 3.0532155061761443, 2.918701159457356, 3.4968323799936627, 4.996832362065703, 5.253605059968919, 4.198733414212853, 7.807537717123822, 7.2067753126223835, 7.606801045437649, -9.070189443727344, -9.620121603210777, -9.41464971502623, 9.656604307393224, 9.750343675414712, 9.34405870983997, 3.988858312368393, 4.384731724858284, 3.582363501191139, 4.301688248912484, 4.30066770563522, 4.52231156329313, 2.0264680509765896, 2.1836221975584778, 2.1413294238348755, 4.9173327473302635, 4.727867630620793, 4.693196093042687, 3.7808861487234537, 3.4700144777695243, 3.62926775092879, 6.8277854565531015, 6.365006193518639, 6.246058866381645, -2.803552263920821, -3.1299661050240246, -3.834867844978973, 3.937191382050514, 3.9295325949788094, 3.7412822395563126, 9.910706880191952, 10.105883518854768, 9.7671113560597, 2.686293931057051, 2.2198543002208027, 1.4137809773286136, 1.783690157035977, 1.8772683689991538, 1.1976506213347022, 10.940279692411423, 10.837760224938393, 11.192813638597727, 7.262245173255593, 7.282646464804799, 7.279669063786656, 2.710004692276314, 2.457968985040978, 2.81820723911126, 4.766096810499818, 5.563199556355045, 5.423424833143741, 6.229502727588013, 6.206517053147152, 6.02967882653077, 0.26753904173770593, 0.1831282476584022, 0.006211603681236966, 8.712654039263725, 9.04497773386538, 8.729885816574097, 6.30799377088745, 5.67056607206662, 5.981300806005791, 0.9116945241888317, 1.1778001127143654, 0.8625163709123882, 1.9550484021504673, 2.028499280412987, 2.104401101668671, 0.09535927077133977, 0.021065098543957106, -0.16889814535777248, 4.047423735260963, 3.945256158709526, 4.157767690718174, 3.794630472858742, 4.308535238107041, 4.42010149856408, 12.65297632664442, 12.87471869494766, 12.306242510676384, 6.111155606806278, 6.167235903441906, 5.614235669374466, 2.680812418460846, 2.1669045239686966, 2.9704208076000214, 1.5693770051002502, 0.9108964800834656, 1.7833160497248173, 2.224225919072822, 1.8906185080607685, 1.9930055414636882, -94.97636112074058, -104.58387392262618, -94.11045672992866, 19.004968237131834, 19.251941707916558, 18.963544629514217, 13.880164643128708, 14.429697209348276, 14.621837309028095, 5.0705970376729965, 5.154290140606463, 5.171968058682978, 2.07281895478566, 2.3885557850201877, 2.4373035741349014, 0.16175483167171478, -0.08867751061916351, -0.06827908754348755, 1.8249005402127807, 1.9084779123465125, 1.4852214554945533, 8.800918821245432, 8.335248276591301, 8.370727941393852, 2.357131178180367, 2.7081941912571494, 2.9855600471297805, 4.034525322417409, 3.92909603069225, 3.9040269131461685, 14.528309424718216, 14.885562016939119, 14.615173583229378, 7.4692955911159515, 7.38825998455286, 7.434190206229687, 6.020884141325951, 6.465072054415941, 5.426938682794571, 11.881419544418648, 12.854752385367945, 12.969005036478237, 6.163946910450846, 5.9072126249472205, 6.244325678485126, 9.583830612401158, 9.921150880555302, 9.148931245009095, 9.3747781018416, 10.029303933183343, 10.048271285990864, 5.760686829686165, 6.158595889806747, 5.769784063100815, 12.191270885368183, 12.116652612884835, 12.330111523469284, 5.607044234871864, 5.163802340626717, 5.257304295897484, 7.0280693608025615, 6.3421057114998405, 6.485045472780854, 16.21967400237918, 16.315984514541924, 15.466501012444496, 7.3932123159368786, 7.15245485057433, 7.635371044588581, 2.9470746268828663, 3.1395937552054676, 2.342679207523659, 8.296745332578809, 8.452227289477975, 8.251787560681493, 12.07105227559805, 11.78038527071476, 11.778658971190453, 6.904557252923638, 6.832819486657769, 5.863868872324616, 10.441769967476517, 9.729633192221314, 10.630715592453868, 7.971282387773186, 8.081669295827538, 7.89291129509607, 5.862516418099403, 5.9182373732328415, 5.2791096568107605, 6.592530321329832, 6.807846298441291, 6.489626795053482, 7.546254190305859, 7.780937756101281, 7.929610347996146, 9.61150827507177, 10.063121436784655, 10.273570894884557, 9.269520382086426, 9.668995598486305, 8.856123725573212, 11.552536765734345, 11.853889002154261, 11.398019696275384, 6.17678801715374, 6.3610644936561584, 6.450912870466709, 13.566054267187909, 13.52285937716563, 13.795996339370802, 12.01825516379904, 11.56156724691391, 11.702481009066105, 6.0043685610095565, 6.079913573960454, 6.4564629929761, 5.511597365140915, 6.382895156741142, 6.384717540815473, 5.077037684619427, 5.319146238267422, 4.737121000885963, 9.583262066046387, 10.135766911009938, 9.51449156800905, 9.115663334727287, 9.234224870800972, 8.932835549116135, 4.621700644493103, 4.465941488742828, 5.019566193223, 5.968087561428547, 5.611062109470367, 5.925169385969639, 7.728102651735142, 8.320906390280769, 7.2544106443722995, 8.779893537362412, 8.534623627861336, 8.383857702215508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14562355507783398, "mean_inference_ms": 0.640225915426953, "mean_action_processing_ms": 0.09453517809916391, "mean_env_wait_ms": 0.7967245654434939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 364800, "timesteps_this_iter": 0, "agent_timesteps_total": 1094400, "timers": {"sample_time_ms": 9267.773, "sample_throughput": 517.924, "load_time_ms": 0.299, "load_throughput": 16041959.522, "learn_time_ms": 1164.429, "learn_throughput": 4122.193, "update_time_ms": 1.801}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.026696777343750002, "cur_lr": 0.0005, "total_loss": 3.7275370061397552, "policy_loss": -0.002605265068850837, "vf_loss": 3.8454016745090485, "vf_explained_var": -0.3440534621477127, "kl": 0.007365058903884595, "entropy": 11.545621633529663, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 364800, "num_agent_steps_sampled": 1094400, "num_steps_trained": 364800, "num_agent_steps_trained": 1094400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2142, "training_iteration": 76, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-54-28", "timestamp": 1706147668, "time_this_iter_s": 9.653487205505371, "time_total_s": 709.799973487854, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050CA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 709.799973487854, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 10.392857142857144, "ram_util_percent": 46.25714285714285}}
{"episode_reward_max": 57.22045457456261, "episode_reward_min": -293.6706917732954, "episode_reward_mean": 14.175761578861554, "episode_len_mean": 297.39, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.58387392262618}, "policy_reward_max": {"shared_policy": 19.251941707916558}, "policy_reward_mean": {"shared_policy": 4.7252538596205165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.15997560694811, 1.3686026185750961, 13.338104033842683, 9.468749045627163, 14.449170836247475, 22.621114075183854, -28.10496076196435, 28.751006692647906, 11.955953538417816, 13.124667517840834, 6.351419672369943, 14.338396470993743, 10.880168377421768, 19.438850516453385, -9.768386213923819, 11.608006216585636, 29.78370175510642, 6.319929208606467, 4.858609147369833, 32.97085355594754, 21.824560701847048, 7.986180916428552, 15.752721199998604, 18.465698607265935, 0.4568788930773451, 26.487517589703202, 17.95986064895986, 2.9520110078155852, 6.087948784232125, -0.052473776042475606, 12.150447584688663, 12.523267209529862, 37.833937532268465, 17.89262717962265, 7.818137750029564, 4.263589534908533, 6.107849968597279, -293.6706917732954, 57.22045457456261, 42.93169916150508, 15.396855236962438, 6.898678313940749, 0.004798233509063721, 5.2185999080538465, 25.506895039230585, 8.050885416567297, 11.867648266255827, 44.02904502488671, 22.2917457818985, 17.912894878536463, 37.70517696626483, 18.315485213883193, 28.653912737965555, 29.452353321015806, 17.689066782593727, 36.6380350217223, 16.028150871396065, 19.855220545083256, 48.0021595293656, 22.18103821109979, 8.429347589611993, 25.000760182738276, 35.63009651750326, 19.601245611906023, 30.8021187521517, 23.945862978696795, 17.059863448143005, 19.890003414824605, 23.256802294403286, 29.948200606740983, 27.794639706145944, 34.80444546416399, 18.988765381276608, 40.88490998372434, 35.282303419779055, 18.54074512794611, 18.27921006269753, 15.133304923772812, 29.233520545065375, 27.282723754644394, 14.107208326458931, 17.504319056868553, 23.30341968638821, 25.698374867439256, 21.704870726913185, 10.09319997951387, 30.01902599260211, 29.687961637973757, 37.49941463023424, 14.835450432030484, 33.7400179784745, 30.698206000030012, 35.171988526359186, 32.06741128489375, -273.7396206058329, 39.750634018331766, 41.788216365501256, 31.118391083204173, 17.34768114238976, 16.78631648421286], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 232, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [6.995244926462561, 6.5627028296391074, 6.60202785084644, 0.7060833871364594, 0.3347744643688202, 0.3277447670698166, 4.637444427236915, 4.706338558346033, 3.994321048259735, 3.0532155061761443, 2.918701159457356, 3.4968323799936627, 4.996832362065703, 5.253605059968919, 4.198733414212853, 7.807537717123822, 7.2067753126223835, 7.606801045437649, -9.070189443727344, -9.620121603210777, -9.41464971502623, 9.656604307393224, 9.750343675414712, 9.34405870983997, 3.988858312368393, 4.384731724858284, 3.582363501191139, 4.301688248912484, 4.30066770563522, 4.52231156329313, 2.0264680509765896, 2.1836221975584778, 2.1413294238348755, 4.9173327473302635, 4.727867630620793, 4.693196093042687, 3.7808861487234537, 3.4700144777695243, 3.62926775092879, 6.8277854565531015, 6.365006193518639, 6.246058866381645, -2.803552263920821, -3.1299661050240246, -3.834867844978973, 3.937191382050514, 3.9295325949788094, 3.7412822395563126, 9.910706880191952, 10.105883518854768, 9.7671113560597, 2.686293931057051, 2.2198543002208027, 1.4137809773286136, 1.783690157035977, 1.8772683689991538, 1.1976506213347022, 10.940279692411423, 10.837760224938393, 11.192813638597727, 7.262245173255593, 7.282646464804799, 7.279669063786656, 2.710004692276314, 2.457968985040978, 2.81820723911126, 4.766096810499818, 5.563199556355045, 5.423424833143741, 6.229502727588013, 6.206517053147152, 6.02967882653077, 0.26753904173770593, 0.1831282476584022, 0.006211603681236966, 8.712654039263725, 9.04497773386538, 8.729885816574097, 6.30799377088745, 5.67056607206662, 5.981300806005791, 0.9116945241888317, 1.1778001127143654, 0.8625163709123882, 1.9550484021504673, 2.028499280412987, 2.104401101668671, 0.09535927077133977, 0.021065098543957106, -0.16889814535777248, 4.047423735260963, 3.945256158709526, 4.157767690718174, 3.794630472858742, 4.308535238107041, 4.42010149856408, 12.65297632664442, 12.87471869494766, 12.306242510676384, 6.111155606806278, 6.167235903441906, 5.614235669374466, 2.680812418460846, 2.1669045239686966, 2.9704208076000214, 1.5693770051002502, 0.9108964800834656, 1.7833160497248173, 2.224225919072822, 1.8906185080607685, 1.9930055414636882, -94.97636112074058, -104.58387392262618, -94.11045672992866, 19.004968237131834, 19.251941707916558, 18.963544629514217, 13.880164643128708, 14.429697209348276, 14.621837309028095, 5.0705970376729965, 5.154290140606463, 5.171968058682978, 2.07281895478566, 2.3885557850201877, 2.4373035741349014, 0.16175483167171478, -0.08867751061916351, -0.06827908754348755, 1.8249005402127807, 1.9084779123465125, 1.4852214554945533, 8.800918821245432, 8.335248276591301, 8.370727941393852, 2.357131178180367, 2.7081941912571494, 2.9855600471297805, 4.034525322417409, 3.92909603069225, 3.9040269131461685, 14.528309424718216, 14.885562016939119, 14.615173583229378, 7.4692955911159515, 7.38825998455286, 7.434190206229687, 6.020884141325951, 6.465072054415941, 5.426938682794571, 11.881419544418648, 12.854752385367945, 12.969005036478237, 6.163946910450846, 5.9072126249472205, 6.244325678485126, 9.583830612401158, 9.921150880555302, 9.148931245009095, 9.3747781018416, 10.029303933183343, 10.048271285990864, 5.760686829686165, 6.158595889806747, 5.769784063100815, 12.191270885368183, 12.116652612884835, 12.330111523469284, 5.607044234871864, 5.163802340626717, 5.257304295897484, 7.0280693608025615, 6.3421057114998405, 6.485045472780854, 16.21967400237918, 16.315984514541924, 15.466501012444496, 7.3932123159368786, 7.15245485057433, 7.635371044588581, 2.9470746268828663, 3.1395937552054676, 2.342679207523659, 8.296745332578809, 8.452227289477975, 8.251787560681493, 12.07105227559805, 11.78038527071476, 11.778658971190453, 6.904557252923638, 6.832819486657769, 5.863868872324616, 10.441769967476517, 9.729633192221314, 10.630715592453868, 7.971282387773186, 8.081669295827538, 7.89291129509607, 5.862516418099403, 5.9182373732328415, 5.2791096568107605, 6.592530321329832, 6.807846298441291, 6.489626795053482, 7.546254190305859, 7.780937756101281, 7.929610347996146, 9.61150827507177, 10.063121436784655, 10.273570894884557, 9.269520382086426, 9.668995598486305, 8.856123725573212, 11.552536765734345, 11.853889002154261, 11.398019696275384, 6.17678801715374, 6.3610644936561584, 6.450912870466709, 13.566054267187909, 13.52285937716563, 13.795996339370802, 12.01825516379904, 11.56156724691391, 11.702481009066105, 6.0043685610095565, 6.079913573960454, 6.4564629929761, 5.511597365140915, 6.382895156741142, 6.384717540815473, 5.077037684619427, 5.319146238267422, 4.737121000885963, 9.583262066046387, 10.135766911009938, 9.51449156800905, 9.115663334727287, 9.234224870800972, 8.932835549116135, 4.621700644493103, 4.465941488742828, 5.019566193223, 5.968087561428547, 5.611062109470367, 5.925169385969639, 7.728102651735142, 8.320906390280769, 7.2544106443722995, 8.779893537362412, 8.534623627861336, 8.383857702215508, 7.4596058713893, 7.565738740066678, 6.679526115457207, 3.715685815860823, 3.2752294888098987, 3.1022846748431476, 9.943974919617176, 9.993668727576733, 10.081382345408201, 9.849112356702477, 10.094885329405457, 9.743963951865823, 12.634037302806973, 12.543023077771068, 12.3223542496562, 4.654229819774628, 4.809953063726425, 5.371267548529431, 11.597163250669837, 10.992654740810394, 11.150199986994267, 10.083200591305882, 10.454941088954598, 10.160064319769532, 11.6832346667846, 11.628453043599919, 11.860300815974668, 10.53906899690628, 10.69872648268938, 10.82961580529809, -88.40870398283005, -98.16138233244419, -87.16953429055866, 13.432772189378738, 13.783752296119928, 12.5341095328331, 13.498132983843476, 14.264130145932228, 14.025953235725552, 10.490081250046686, 10.037535359462098, 10.59077447369539, 5.784224716325596, 5.5959377040465625, 5.967518722017601, 5.614376788338021, 5.75759222110112, 5.41434747477372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1454499707288429, "mean_inference_ms": 0.6401219854241755, "mean_action_processing_ms": 0.09448424616551965, "mean_env_wait_ms": 0.7970796593873354, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 369600, "timesteps_this_iter": 0, "agent_timesteps_total": 1108800, "timers": {"sample_time_ms": 9309.781, "sample_throughput": 515.587, "load_time_ms": 0.299, "load_throughput": 16047074.127, "learn_time_ms": 1166.629, "learn_throughput": 4114.418, "update_time_ms": 1.702}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.026696777343750002, "cur_lr": 0.0005, "total_loss": 59.34941864013672, "policy_loss": -0.0015934801752801875, "vf_loss": 59.468101501464844, "vf_explained_var": -0.02342332899570465, "kl": 0.02349289326237442, "entropy": 11.772016525268555, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 369600, "num_agent_steps_sampled": 1108800, "num_steps_trained": 369600, "num_agent_steps_trained": 1108800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2158, "training_iteration": 77, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-54-37", "timestamp": 1706147677, "time_this_iter_s": 9.483076810836792, "time_total_s": 719.2830502986908, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 719.2830502986908, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 6.561538461538461, "ram_util_percent": 46.19230769230769}}
{"episode_reward_max": 57.22045457456261, "episode_reward_min": -293.6706917732954, "episode_reward_mean": 16.959236446746207, "episode_len_mean": 297.39, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.58387392262618}, "policy_reward_max": {"shared_policy": 19.251941707916558}, "policy_reward_mean": {"shared_policy": 5.653078815582068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.78370175510642, 6.319929208606467, 4.858609147369833, 32.97085355594754, 21.824560701847048, 7.986180916428552, 15.752721199998604, 18.465698607265935, 0.4568788930773451, 26.487517589703202, 17.95986064895986, 2.9520110078155852, 6.087948784232125, -0.052473776042475606, 12.150447584688663, 12.523267209529862, 37.833937532268465, 17.89262717962265, 7.818137750029564, 4.263589534908533, 6.107849968597279, -293.6706917732954, 57.22045457456261, 42.93169916150508, 15.396855236962438, 6.898678313940749, 0.004798233509063721, 5.2185999080538465, 25.506895039230585, 8.050885416567297, 11.867648266255827, 44.02904502488671, 22.2917457818985, 17.912894878536463, 37.70517696626483, 18.315485213883193, 28.653912737965555, 29.452353321015806, 17.689066782593727, 36.6380350217223, 16.028150871396065, 19.855220545083256, 48.0021595293656, 22.18103821109979, 8.429347589611993, 25.000760182738276, 35.63009651750326, 19.601245611906023, 30.8021187521517, 23.945862978696795, 17.059863448143005, 19.890003414824605, 23.256802294403286, 29.948200606740983, 27.794639706145944, 34.80444546416399, 18.988765381276608, 40.88490998372434, 35.282303419779055, 18.54074512794611, 18.27921006269753, 15.133304923772812, 29.233520545065375, 27.282723754644394, 14.107208326458931, 17.504319056868553, 23.30341968638821, 25.698374867439256, 21.704870726913185, 10.09319997951387, 30.01902599260211, 29.687961637973757, 37.49941463023424, 14.835450432030484, 33.7400179784745, 30.698206000030012, 35.171988526359186, 32.06741128489375, -273.7396206058329, 39.750634018331766, 41.788216365501256, 31.118391083204173, 17.34768114238976, 16.78631648421286, 30.022977389395237, 26.379917452111826, 45.95650555047905, 9.160963077098117, 20.41099911183116, 47.18705866485833, 10.743762876838431, 21.28406200557947, 36.845430780202136, 15.173816233873353, 27.644496899098158, 25.717725280672283, 28.043356819078298, 36.69890213012694, 17.91483627632259, 39.143514484167085], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 232, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [9.910706880191952, 10.105883518854768, 9.7671113560597, 2.686293931057051, 2.2198543002208027, 1.4137809773286136, 1.783690157035977, 1.8772683689991538, 1.1976506213347022, 10.940279692411423, 10.837760224938393, 11.192813638597727, 7.262245173255593, 7.282646464804799, 7.279669063786656, 2.710004692276314, 2.457968985040978, 2.81820723911126, 4.766096810499818, 5.563199556355045, 5.423424833143741, 6.229502727588013, 6.206517053147152, 6.02967882653077, 0.26753904173770593, 0.1831282476584022, 0.006211603681236966, 8.712654039263725, 9.04497773386538, 8.729885816574097, 6.30799377088745, 5.67056607206662, 5.981300806005791, 0.9116945241888317, 1.1778001127143654, 0.8625163709123882, 1.9550484021504673, 2.028499280412987, 2.104401101668671, 0.09535927077133977, 0.021065098543957106, -0.16889814535777248, 4.047423735260963, 3.945256158709526, 4.157767690718174, 3.794630472858742, 4.308535238107041, 4.42010149856408, 12.65297632664442, 12.87471869494766, 12.306242510676384, 6.111155606806278, 6.167235903441906, 5.614235669374466, 2.680812418460846, 2.1669045239686966, 2.9704208076000214, 1.5693770051002502, 0.9108964800834656, 1.7833160497248173, 2.224225919072822, 1.8906185080607685, 1.9930055414636882, -94.97636112074058, -104.58387392262618, -94.11045672992866, 19.004968237131834, 19.251941707916558, 18.963544629514217, 13.880164643128708, 14.429697209348276, 14.621837309028095, 5.0705970376729965, 5.154290140606463, 5.171968058682978, 2.07281895478566, 2.3885557850201877, 2.4373035741349014, 0.16175483167171478, -0.08867751061916351, -0.06827908754348755, 1.8249005402127807, 1.9084779123465125, 1.4852214554945533, 8.800918821245432, 8.335248276591301, 8.370727941393852, 2.357131178180367, 2.7081941912571494, 2.9855600471297805, 4.034525322417409, 3.92909603069225, 3.9040269131461685, 14.528309424718216, 14.885562016939119, 14.615173583229378, 7.4692955911159515, 7.38825998455286, 7.434190206229687, 6.020884141325951, 6.465072054415941, 5.426938682794571, 11.881419544418648, 12.854752385367945, 12.969005036478237, 6.163946910450846, 5.9072126249472205, 6.244325678485126, 9.583830612401158, 9.921150880555302, 9.148931245009095, 9.3747781018416, 10.029303933183343, 10.048271285990864, 5.760686829686165, 6.158595889806747, 5.769784063100815, 12.191270885368183, 12.116652612884835, 12.330111523469284, 5.607044234871864, 5.163802340626717, 5.257304295897484, 7.0280693608025615, 6.3421057114998405, 6.485045472780854, 16.21967400237918, 16.315984514541924, 15.466501012444496, 7.3932123159368786, 7.15245485057433, 7.635371044588581, 2.9470746268828663, 3.1395937552054676, 2.342679207523659, 8.296745332578809, 8.452227289477975, 8.251787560681493, 12.07105227559805, 11.78038527071476, 11.778658971190453, 6.904557252923638, 6.832819486657769, 5.863868872324616, 10.441769967476517, 9.729633192221314, 10.630715592453868, 7.971282387773186, 8.081669295827538, 7.89291129509607, 5.862516418099403, 5.9182373732328415, 5.2791096568107605, 6.592530321329832, 6.807846298441291, 6.489626795053482, 7.546254190305859, 7.780937756101281, 7.929610347996146, 9.61150827507177, 10.063121436784655, 10.273570894884557, 9.269520382086426, 9.668995598486305, 8.856123725573212, 11.552536765734345, 11.853889002154261, 11.398019696275384, 6.17678801715374, 6.3610644936561584, 6.450912870466709, 13.566054267187909, 13.52285937716563, 13.795996339370802, 12.01825516379904, 11.56156724691391, 11.702481009066105, 6.0043685610095565, 6.079913573960454, 6.4564629929761, 5.511597365140915, 6.382895156741142, 6.384717540815473, 5.077037684619427, 5.319146238267422, 4.737121000885963, 9.583262066046387, 10.135766911009938, 9.51449156800905, 9.115663334727287, 9.234224870800972, 8.932835549116135, 4.621700644493103, 4.465941488742828, 5.019566193223, 5.968087561428547, 5.611062109470367, 5.925169385969639, 7.728102651735142, 8.320906390280769, 7.2544106443722995, 8.779893537362412, 8.534623627861336, 8.383857702215508, 7.4596058713893, 7.565738740066678, 6.679526115457207, 3.715685815860823, 3.2752294888098987, 3.1022846748431476, 9.943974919617176, 9.993668727576733, 10.081382345408201, 9.849112356702477, 10.094885329405457, 9.743963951865823, 12.634037302806973, 12.543023077771068, 12.3223542496562, 4.654229819774628, 4.809953063726425, 5.371267548529431, 11.597163250669837, 10.992654740810394, 11.150199986994267, 10.083200591305882, 10.454941088954598, 10.160064319769532, 11.6832346667846, 11.628453043599919, 11.860300815974668, 10.53906899690628, 10.69872648268938, 10.82961580529809, -88.40870398283005, -98.16138233244419, -87.16953429055866, 13.432772189378738, 13.783752296119928, 12.5341095328331, 13.498132983843476, 14.264130145932228, 14.025953235725552, 10.490081250046686, 10.037535359462098, 10.59077447369539, 5.784224716325596, 5.5959377040465625, 5.967518722017601, 5.614376788338021, 5.75759222110112, 5.41434747477372, 10.037962205708027, 10.035928644239902, 9.949086539447308, 9.211442887162164, 9.019227286179856, 8.149247278769806, 15.659725359117147, 15.328287549316883, 14.968492642045021, 3.3197991189857277, 2.896143068869904, 2.9450208892424854, 6.899575049678475, 6.7494106466571395, 6.762013415495545, 16.037425336738423, 15.265248765548066, 15.884384562571839, 3.747307219852999, 3.6994555120666774, 3.297000144918755, 7.2522190771996975, 7.078304495662451, 6.953538432717323, 12.193390426536396, 12.243872841199234, 12.408167512466505, 5.337188684691981, 5.238920481254652, 4.59770706792672, 9.247010841965675, 9.566186394542456, 8.831299662590027, 8.681614166746527, 8.341850238541753, 8.694260875384003, 9.746275805557758, 9.148052493731171, 9.149028519789368, 12.335631397863224, 12.051118796070412, 12.312151936193303, 5.685398702820137, 6.402144723882273, 5.827292849620179, 12.868382607897118, 13.382999350627259, 12.892132525642708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1453273943849274, "mean_inference_ms": 0.6402607346368246, "mean_action_processing_ms": 0.09446015816736068, "mean_env_wait_ms": 0.7975630127321571, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 374400, "timesteps_this_iter": 0, "agent_timesteps_total": 1123200, "timers": {"sample_time_ms": 9429.48, "sample_throughput": 509.042, "load_time_ms": 0.199, "load_throughput": 24102309.589, "learn_time_ms": 1174.139, "learn_throughput": 4088.104, "update_time_ms": 1.599}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 3.6496140360832214, "policy_loss": -0.002902673905288644, "vf_loss": 3.769437164068222, "vf_explained_var": -0.3101854622364044, "kl": 0.008055580023287557, "entropy": 11.724300026893616, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 374400, "num_agent_steps_sampled": 1123200, "num_steps_trained": 374400, "num_agent_steps_trained": 1123200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2174, "training_iteration": 78, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-54-48", "timestamp": 1706147688, "time_this_iter_s": 10.264583587646484, "time_total_s": 729.5476338863373, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 729.5476338863373, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 9.34, "ram_util_percent": 46.25333333333333}}
{"episode_reward_max": 57.22045457456261, "episode_reward_min": -307.95605878997594, "episode_reward_mean": 15.441484797593722, "episode_len_mean": 295.56, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -109.90937646230063}, "policy_reward_max": {"shared_policy": 19.251941707916558}, "policy_reward_mean": {"shared_policy": 5.147161599197905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.833937532268465, 17.89262717962265, 7.818137750029564, 4.263589534908533, 6.107849968597279, -293.6706917732954, 57.22045457456261, 42.93169916150508, 15.396855236962438, 6.898678313940749, 0.004798233509063721, 5.2185999080538465, 25.506895039230585, 8.050885416567297, 11.867648266255827, 44.02904502488671, 22.2917457818985, 17.912894878536463, 37.70517696626483, 18.315485213883193, 28.653912737965555, 29.452353321015806, 17.689066782593727, 36.6380350217223, 16.028150871396065, 19.855220545083256, 48.0021595293656, 22.18103821109979, 8.429347589611993, 25.000760182738276, 35.63009651750326, 19.601245611906023, 30.8021187521517, 23.945862978696795, 17.059863448143005, 19.890003414824605, 23.256802294403286, 29.948200606740983, 27.794639706145944, 34.80444546416399, 18.988765381276608, 40.88490998372434, 35.282303419779055, 18.54074512794611, 18.27921006269753, 15.133304923772812, 29.233520545065375, 27.282723754644394, 14.107208326458931, 17.504319056868553, 23.30341968638821, 25.698374867439256, 21.704870726913185, 10.09319997951387, 30.01902599260211, 29.687961637973757, 37.49941463023424, 14.835450432030484, 33.7400179784745, 30.698206000030012, 35.171988526359186, 32.06741128489375, -273.7396206058329, 39.750634018331766, 41.788216365501256, 31.118391083204173, 17.34768114238976, 16.78631648421286, 30.022977389395237, 26.379917452111826, 45.95650555047905, 9.160963077098117, 20.41099911183116, 47.18705866485833, 10.743762876838431, 21.28406200557947, 36.845430780202136, 15.173816233873353, 27.644496899098158, 25.717725280672283, 28.043356819078298, 36.69890213012694, 17.91483627632259, 39.143514484167085, 23.978940189117566, 20.21514080837366, -307.95605878997594, 27.407313331961618, 22.98533770442009, 37.16539783496407, 31.46997611969708, 24.093798931688042, 7.756990302354097, 41.4540227372199, 19.33763331919907, 34.8305481672287, 15.349037617444978, 18.36219207942483, 10.734055545181008, 37.56822222098708], "episode_lengths": [300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 232, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 117, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [12.65297632664442, 12.87471869494766, 12.306242510676384, 6.111155606806278, 6.167235903441906, 5.614235669374466, 2.680812418460846, 2.1669045239686966, 2.9704208076000214, 1.5693770051002502, 0.9108964800834656, 1.7833160497248173, 2.224225919072822, 1.8906185080607685, 1.9930055414636882, -94.97636112074058, -104.58387392262618, -94.11045672992866, 19.004968237131834, 19.251941707916558, 18.963544629514217, 13.880164643128708, 14.429697209348276, 14.621837309028095, 5.0705970376729965, 5.154290140606463, 5.171968058682978, 2.07281895478566, 2.3885557850201877, 2.4373035741349014, 0.16175483167171478, -0.08867751061916351, -0.06827908754348755, 1.8249005402127807, 1.9084779123465125, 1.4852214554945533, 8.800918821245432, 8.335248276591301, 8.370727941393852, 2.357131178180367, 2.7081941912571494, 2.9855600471297805, 4.034525322417409, 3.92909603069225, 3.9040269131461685, 14.528309424718216, 14.885562016939119, 14.615173583229378, 7.4692955911159515, 7.38825998455286, 7.434190206229687, 6.020884141325951, 6.465072054415941, 5.426938682794571, 11.881419544418648, 12.854752385367945, 12.969005036478237, 6.163946910450846, 5.9072126249472205, 6.244325678485126, 9.583830612401158, 9.921150880555302, 9.148931245009095, 9.3747781018416, 10.029303933183343, 10.048271285990864, 5.760686829686165, 6.158595889806747, 5.769784063100815, 12.191270885368183, 12.116652612884835, 12.330111523469284, 5.607044234871864, 5.163802340626717, 5.257304295897484, 7.0280693608025615, 6.3421057114998405, 6.485045472780854, 16.21967400237918, 16.315984514541924, 15.466501012444496, 7.3932123159368786, 7.15245485057433, 7.635371044588581, 2.9470746268828663, 3.1395937552054676, 2.342679207523659, 8.296745332578809, 8.452227289477975, 8.251787560681493, 12.07105227559805, 11.78038527071476, 11.778658971190453, 6.904557252923638, 6.832819486657769, 5.863868872324616, 10.441769967476517, 9.729633192221314, 10.630715592453868, 7.971282387773186, 8.081669295827538, 7.89291129509607, 5.862516418099403, 5.9182373732328415, 5.2791096568107605, 6.592530321329832, 6.807846298441291, 6.489626795053482, 7.546254190305859, 7.780937756101281, 7.929610347996146, 9.61150827507177, 10.063121436784655, 10.273570894884557, 9.269520382086426, 9.668995598486305, 8.856123725573212, 11.552536765734345, 11.853889002154261, 11.398019696275384, 6.17678801715374, 6.3610644936561584, 6.450912870466709, 13.566054267187909, 13.52285937716563, 13.795996339370802, 12.01825516379904, 11.56156724691391, 11.702481009066105, 6.0043685610095565, 6.079913573960454, 6.4564629929761, 5.511597365140915, 6.382895156741142, 6.384717540815473, 5.077037684619427, 5.319146238267422, 4.737121000885963, 9.583262066046387, 10.135766911009938, 9.51449156800905, 9.115663334727287, 9.234224870800972, 8.932835549116135, 4.621700644493103, 4.465941488742828, 5.019566193223, 5.968087561428547, 5.611062109470367, 5.925169385969639, 7.728102651735142, 8.320906390280769, 7.2544106443722995, 8.779893537362412, 8.534623627861336, 8.383857702215508, 7.4596058713893, 7.565738740066678, 6.679526115457207, 3.715685815860823, 3.2752294888098987, 3.1022846748431476, 9.943974919617176, 9.993668727576733, 10.081382345408201, 9.849112356702477, 10.094885329405457, 9.743963951865823, 12.634037302806973, 12.543023077771068, 12.3223542496562, 4.654229819774628, 4.809953063726425, 5.371267548529431, 11.597163250669837, 10.992654740810394, 11.150199986994267, 10.083200591305882, 10.454941088954598, 10.160064319769532, 11.6832346667846, 11.628453043599919, 11.860300815974668, 10.53906899690628, 10.69872648268938, 10.82961580529809, -88.40870398283005, -98.16138233244419, -87.16953429055866, 13.432772189378738, 13.783752296119928, 12.5341095328331, 13.498132983843476, 14.264130145932228, 14.025953235725552, 10.490081250046686, 10.037535359462098, 10.59077447369539, 5.784224716325596, 5.5959377040465625, 5.967518722017601, 5.614376788338021, 5.75759222110112, 5.41434747477372, 10.037962205708027, 10.035928644239902, 9.949086539447308, 9.211442887162164, 9.019227286179856, 8.149247278769806, 15.659725359117147, 15.328287549316883, 14.968492642045021, 3.3197991189857277, 2.896143068869904, 2.9450208892424854, 6.899575049678475, 6.7494106466571395, 6.762013415495545, 16.037425336738423, 15.265248765548066, 15.884384562571839, 3.747307219852999, 3.6994555120666774, 3.297000144918755, 7.2522190771996975, 7.078304495662451, 6.953538432717323, 12.193390426536396, 12.243872841199234, 12.408167512466505, 5.337188684691981, 5.238920481254652, 4.59770706792672, 9.247010841965675, 9.566186394542456, 8.831299662590027, 8.681614166746527, 8.341850238541753, 8.694260875384003, 9.746275805557758, 9.148052493731171, 9.149028519789368, 12.335631397863224, 12.051118796070412, 12.312151936193303, 5.685398702820137, 6.402144723882273, 5.827292849620179, 12.868382607897118, 13.382999350627259, 12.892132525642708, 7.894347235560417, 7.856588810682297, 8.228004142874852, 6.779739181200654, 7.077741115043551, 6.357660512129456, -98.46537973949066, -99.58130258818468, -109.90937646230063, 9.251715270181492, 9.040904035170868, 9.114694026609257, 7.796275191009045, 7.368866562843323, 7.820195950567722, 12.138606290022523, 12.568389562579483, 12.458401982362062, 10.475736421843365, 10.442610954244927, 10.551628743608788, 8.162399093310029, 7.748903195063264, 8.18249664331475, 2.6816063299775124, 2.9021522514522076, 2.1732317209243774, 13.841818523282797, 13.847960511843354, 13.76424370209375, 6.644655873378113, 6.516816241045788, 6.17616120477517, 11.568271890282631, 11.658494174480438, 11.60378210246563, 5.0739575078089985, 5.152527679999665, 5.122552429636315, 6.156018803517014, 6.510654817024857, 5.695518458882958, 3.8590492835889165, 3.908191152537853, 2.966815109054238, 12.230598762631416, 12.855546366423368, 12.482077091932297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14522519564134112, "mean_inference_ms": 0.6405442756799657, "mean_action_processing_ms": 0.09446399430341128, "mean_env_wait_ms": 0.7981132266789536, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 379200, "timesteps_this_iter": 0, "agent_timesteps_total": 1137600, "timers": {"sample_time_ms": 9494.613, "sample_throughput": 505.55, "load_time_ms": 0.199, "load_throughput": 24102309.589, "learn_time_ms": 1177.432, "learn_throughput": 4076.667, "update_time_ms": 1.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 76.39738178253174, "policy_loss": -0.0013771101877986247, "vf_loss": 76.5168104171753, "vf_explained_var": -0.020900651812553406, "kl": 0.017841127410144056, "entropy": 11.876962900161743, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 379200, "num_agent_steps_sampled": 1137600, "num_steps_trained": 379200, "num_agent_steps_trained": 1137600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2190, "training_iteration": 79, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-54-57", "timestamp": 1706147697, "time_this_iter_s": 9.66929841041565, "time_total_s": 739.2169322967529, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF55E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 739.2169322967529, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 46.16153846153846}}
{"episode_reward_max": 48.0021595293656, "episode_reward_min": -307.95605878997594, "episode_reward_mean": 19.352208940066035, "episode_len_mean": 297.49, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -109.90937646230063}, "policy_reward_max": {"shared_policy": 16.315984514541924}, "policy_reward_mean": {"shared_policy": 6.450736313355344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.2917457818985, 17.912894878536463, 37.70517696626483, 18.315485213883193, 28.653912737965555, 29.452353321015806, 17.689066782593727, 36.6380350217223, 16.028150871396065, 19.855220545083256, 48.0021595293656, 22.18103821109979, 8.429347589611993, 25.000760182738276, 35.63009651750326, 19.601245611906023, 30.8021187521517, 23.945862978696795, 17.059863448143005, 19.890003414824605, 23.256802294403286, 29.948200606740983, 27.794639706145944, 34.80444546416399, 18.988765381276608, 40.88490998372434, 35.282303419779055, 18.54074512794611, 18.27921006269753, 15.133304923772812, 29.233520545065375, 27.282723754644394, 14.107208326458931, 17.504319056868553, 23.30341968638821, 25.698374867439256, 21.704870726913185, 10.09319997951387, 30.01902599260211, 29.687961637973757, 37.49941463023424, 14.835450432030484, 33.7400179784745, 30.698206000030012, 35.171988526359186, 32.06741128489375, -273.7396206058329, 39.750634018331766, 41.788216365501256, 31.118391083204173, 17.34768114238976, 16.78631648421286, 30.022977389395237, 26.379917452111826, 45.95650555047905, 9.160963077098117, 20.41099911183116, 47.18705866485833, 10.743762876838431, 21.28406200557947, 36.845430780202136, 15.173816233873353, 27.644496899098158, 25.717725280672283, 28.043356819078298, 36.69890213012694, 17.91483627632259, 39.143514484167085, 23.978940189117566, 20.21514080837366, -307.95605878997594, 27.407313331961618, 22.98533770442009, 37.16539783496407, 31.46997611969708, 24.093798931688042, 7.756990302354097, 41.4540227372199, 19.33763331919907, 34.8305481672287, 15.349037617444978, 18.36219207942483, 10.734055545181008, 37.56822222098708, 43.444288501515985, 33.84853318333623, 16.82604505866763, 26.14206223934886, 19.571543611586065, 26.258080512285233, 19.754542075097532, 4.903508804738493, 35.51952613517642, 36.35153309535232, 20.155495550483465, 19.005460985004902, 22.63633724302052, 19.73270422965288, 17.785341646522255, 26.508420743048163], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 232, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 117, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [7.4692955911159515, 7.38825998455286, 7.434190206229687, 6.020884141325951, 6.465072054415941, 5.426938682794571, 11.881419544418648, 12.854752385367945, 12.969005036478237, 6.163946910450846, 5.9072126249472205, 6.244325678485126, 9.583830612401158, 9.921150880555302, 9.148931245009095, 9.3747781018416, 10.029303933183343, 10.048271285990864, 5.760686829686165, 6.158595889806747, 5.769784063100815, 12.191270885368183, 12.116652612884835, 12.330111523469284, 5.607044234871864, 5.163802340626717, 5.257304295897484, 7.0280693608025615, 6.3421057114998405, 6.485045472780854, 16.21967400237918, 16.315984514541924, 15.466501012444496, 7.3932123159368786, 7.15245485057433, 7.635371044588581, 2.9470746268828663, 3.1395937552054676, 2.342679207523659, 8.296745332578809, 8.452227289477975, 8.251787560681493, 12.07105227559805, 11.78038527071476, 11.778658971190453, 6.904557252923638, 6.832819486657769, 5.863868872324616, 10.441769967476517, 9.729633192221314, 10.630715592453868, 7.971282387773186, 8.081669295827538, 7.89291129509607, 5.862516418099403, 5.9182373732328415, 5.2791096568107605, 6.592530321329832, 6.807846298441291, 6.489626795053482, 7.546254190305859, 7.780937756101281, 7.929610347996146, 9.61150827507177, 10.063121436784655, 10.273570894884557, 9.269520382086426, 9.668995598486305, 8.856123725573212, 11.552536765734345, 11.853889002154261, 11.398019696275384, 6.17678801715374, 6.3610644936561584, 6.450912870466709, 13.566054267187909, 13.52285937716563, 13.795996339370802, 12.01825516379904, 11.56156724691391, 11.702481009066105, 6.0043685610095565, 6.079913573960454, 6.4564629929761, 5.511597365140915, 6.382895156741142, 6.384717540815473, 5.077037684619427, 5.319146238267422, 4.737121000885963, 9.583262066046387, 10.135766911009938, 9.51449156800905, 9.115663334727287, 9.234224870800972, 8.932835549116135, 4.621700644493103, 4.465941488742828, 5.019566193223, 5.968087561428547, 5.611062109470367, 5.925169385969639, 7.728102651735142, 8.320906390280769, 7.2544106443722995, 8.779893537362412, 8.534623627861336, 8.383857702215508, 7.4596058713893, 7.565738740066678, 6.679526115457207, 3.715685815860823, 3.2752294888098987, 3.1022846748431476, 9.943974919617176, 9.993668727576733, 10.081382345408201, 9.849112356702477, 10.094885329405457, 9.743963951865823, 12.634037302806973, 12.543023077771068, 12.3223542496562, 4.654229819774628, 4.809953063726425, 5.371267548529431, 11.597163250669837, 10.992654740810394, 11.150199986994267, 10.083200591305882, 10.454941088954598, 10.160064319769532, 11.6832346667846, 11.628453043599919, 11.860300815974668, 10.53906899690628, 10.69872648268938, 10.82961580529809, -88.40870398283005, -98.16138233244419, -87.16953429055866, 13.432772189378738, 13.783752296119928, 12.5341095328331, 13.498132983843476, 14.264130145932228, 14.025953235725552, 10.490081250046686, 10.037535359462098, 10.59077447369539, 5.784224716325596, 5.5959377040465625, 5.967518722017601, 5.614376788338021, 5.75759222110112, 5.41434747477372, 10.037962205708027, 10.035928644239902, 9.949086539447308, 9.211442887162164, 9.019227286179856, 8.149247278769806, 15.659725359117147, 15.328287549316883, 14.968492642045021, 3.3197991189857277, 2.896143068869904, 2.9450208892424854, 6.899575049678475, 6.7494106466571395, 6.762013415495545, 16.037425336738423, 15.265248765548066, 15.884384562571839, 3.747307219852999, 3.6994555120666774, 3.297000144918755, 7.2522190771996975, 7.078304495662451, 6.953538432717323, 12.193390426536396, 12.243872841199234, 12.408167512466505, 5.337188684691981, 5.238920481254652, 4.59770706792672, 9.247010841965675, 9.566186394542456, 8.831299662590027, 8.681614166746527, 8.341850238541753, 8.694260875384003, 9.746275805557758, 9.148052493731171, 9.149028519789368, 12.335631397863224, 12.051118796070412, 12.312151936193303, 5.685398702820137, 6.402144723882273, 5.827292849620179, 12.868382607897118, 13.382999350627259, 12.892132525642708, 7.894347235560417, 7.856588810682297, 8.228004142874852, 6.779739181200654, 7.077741115043551, 6.357660512129456, -98.46537973949066, -99.58130258818468, -109.90937646230063, 9.251715270181492, 9.040904035170868, 9.114694026609257, 7.796275191009045, 7.368866562843323, 7.820195950567722, 12.138606290022523, 12.568389562579483, 12.458401982362062, 10.475736421843365, 10.442610954244927, 10.551628743608788, 8.162399093310029, 7.748903195063264, 8.18249664331475, 2.6816063299775124, 2.9021522514522076, 2.1732317209243774, 13.841818523282797, 13.847960511843354, 13.76424370209375, 6.644655873378113, 6.516816241045788, 6.17616120477517, 11.568271890282631, 11.658494174480438, 11.60378210246563, 5.0739575078089985, 5.152527679999665, 5.122552429636315, 6.156018803517014, 6.510654817024857, 5.695518458882958, 3.8590492835889165, 3.908191152537853, 2.966815109054238, 12.230598762631416, 12.855546366423368, 12.482077091932297, 14.380143821239471, 14.416110046207905, 14.648034634068608, 11.076578448216111, 11.083561057845742, 11.688393677274377, 5.7179513300458495, 5.616297955314309, 5.491795773307473, 8.950337740282208, 8.729882473746926, 8.461842025319726, 6.710675934950501, 6.498308124641568, 6.362559551993996, 8.685945242643356, 8.580302640795708, 8.991832628846169, 6.872827137509972, 6.1128008613983695, 6.768914076189191, 1.2390543172756736, 2.0886006976167266, 1.575853789846093, 11.84008277952671, 11.571018919348717, 12.108424436300993, 11.678569967548043, 12.696119447859616, 11.976843679944665, 6.629499040544033, 7.024160224944353, 6.501836284995079, 5.961371183395386, 6.597575403749943, 6.446514397859573, 7.30202381809552, 7.832280596097306, 7.502032828827694, 6.4789696633815765, 6.470067635178566, 6.783666931092739, 5.8344855035344665, 5.910450114558131, 6.040406028429658, 9.167012634376675, 8.624776105086, 8.716632003585488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14513251747001601, "mean_inference_ms": 0.6408237230135796, "mean_action_processing_ms": 0.09448481956631335, "mean_env_wait_ms": 0.798650087978007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"sample_time_ms": 9444.99, "sample_throughput": 508.206, "load_time_ms": 0.199, "load_throughput": 24102309.589, "learn_time_ms": 1177.732, "learn_throughput": 4075.63, "update_time_ms": 1.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.676582157611847, "policy_loss": -0.004251670355960302, "vf_loss": 2.7980097234249115, "vf_explained_var": -0.36081913113594055, "kl": 0.007045433965766995, "entropy": 11.745804190635681, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 384000, "num_agent_steps_trained": 1152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2206, "training_iteration": 80, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-55-06", "timestamp": 1706147706, "time_this_iter_s": 9.130865335464478, "time_total_s": 748.3477976322174, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021063335670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 748.3477976322174, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 7.269230769230768, "ram_util_percent": 46.0846153846154}}
{"episode_reward_max": 47.18705866485833, "episode_reward_min": -307.95605878997594, "episode_reward_mean": 14.859980511610036, "episode_len_mean": 295.33, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -109.90937646230063}, "policy_reward_max": {"shared_policy": 16.037425336738423}, "policy_reward_mean": {"shared_policy": 4.9533268372033445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.945862978696795, 17.059863448143005, 19.890003414824605, 23.256802294403286, 29.948200606740983, 27.794639706145944, 34.80444546416399, 18.988765381276608, 40.88490998372434, 35.282303419779055, 18.54074512794611, 18.27921006269753, 15.133304923772812, 29.233520545065375, 27.282723754644394, 14.107208326458931, 17.504319056868553, 23.30341968638821, 25.698374867439256, 21.704870726913185, 10.09319997951387, 30.01902599260211, 29.687961637973757, 37.49941463023424, 14.835450432030484, 33.7400179784745, 30.698206000030012, 35.171988526359186, 32.06741128489375, -273.7396206058329, 39.750634018331766, 41.788216365501256, 31.118391083204173, 17.34768114238976, 16.78631648421286, 30.022977389395237, 26.379917452111826, 45.95650555047905, 9.160963077098117, 20.41099911183116, 47.18705866485833, 10.743762876838431, 21.28406200557947, 36.845430780202136, 15.173816233873353, 27.644496899098158, 25.717725280672283, 28.043356819078298, 36.69890213012694, 17.91483627632259, 39.143514484167085, 23.978940189117566, 20.21514080837366, -307.95605878997594, 27.407313331961618, 22.98533770442009, 37.16539783496407, 31.46997611969708, 24.093798931688042, 7.756990302354097, 41.4540227372199, 19.33763331919907, 34.8305481672287, 15.349037617444978, 18.36219207942483, 10.734055545181008, 37.56822222098708, 43.444288501515985, 33.84853318333623, 16.82604505866763, 26.14206223934886, 19.571543611586065, 26.258080512285233, 19.754542075097532, 4.903508804738493, 35.51952613517642, 36.35153309535232, 20.155495550483465, 19.005460985004902, 22.63633724302052, 19.73270422965288, 17.785341646522255, 26.508420743048163, 13.290205240249634, 18.738332321867333, -3.554652500897646, -277.77774830907583, 13.180754214525223, 17.42166131734848, 30.092164639383526, 3.719433741644025, 7.697233080863953, 20.57903596200046, 35.09426806867123, 19.828752294182763, 10.748692080378504, 9.572671012021587, 19.458699710667105, 27.30535335838792, 19.57110943691802], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 232, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 117, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 84, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [7.971282387773186, 8.081669295827538, 7.89291129509607, 5.862516418099403, 5.9182373732328415, 5.2791096568107605, 6.592530321329832, 6.807846298441291, 6.489626795053482, 7.546254190305859, 7.780937756101281, 7.929610347996146, 9.61150827507177, 10.063121436784655, 10.273570894884557, 9.269520382086426, 9.668995598486305, 8.856123725573212, 11.552536765734345, 11.853889002154261, 11.398019696275384, 6.17678801715374, 6.3610644936561584, 6.450912870466709, 13.566054267187909, 13.52285937716563, 13.795996339370802, 12.01825516379904, 11.56156724691391, 11.702481009066105, 6.0043685610095565, 6.079913573960454, 6.4564629929761, 5.511597365140915, 6.382895156741142, 6.384717540815473, 5.077037684619427, 5.319146238267422, 4.737121000885963, 9.583262066046387, 10.135766911009938, 9.51449156800905, 9.115663334727287, 9.234224870800972, 8.932835549116135, 4.621700644493103, 4.465941488742828, 5.019566193223, 5.968087561428547, 5.611062109470367, 5.925169385969639, 7.728102651735142, 8.320906390280769, 7.2544106443722995, 8.779893537362412, 8.534623627861336, 8.383857702215508, 7.4596058713893, 7.565738740066678, 6.679526115457207, 3.715685815860823, 3.2752294888098987, 3.1022846748431476, 9.943974919617176, 9.993668727576733, 10.081382345408201, 9.849112356702477, 10.094885329405457, 9.743963951865823, 12.634037302806973, 12.543023077771068, 12.3223542496562, 4.654229819774628, 4.809953063726425, 5.371267548529431, 11.597163250669837, 10.992654740810394, 11.150199986994267, 10.083200591305882, 10.454941088954598, 10.160064319769532, 11.6832346667846, 11.628453043599919, 11.860300815974668, 10.53906899690628, 10.69872648268938, 10.82961580529809, -88.40870398283005, -98.16138233244419, -87.16953429055866, 13.432772189378738, 13.783752296119928, 12.5341095328331, 13.498132983843476, 14.264130145932228, 14.025953235725552, 10.490081250046686, 10.037535359462098, 10.59077447369539, 5.784224716325596, 5.5959377040465625, 5.967518722017601, 5.614376788338021, 5.75759222110112, 5.41434747477372, 10.037962205708027, 10.035928644239902, 9.949086539447308, 9.211442887162164, 9.019227286179856, 8.149247278769806, 15.659725359117147, 15.328287549316883, 14.968492642045021, 3.3197991189857277, 2.896143068869904, 2.9450208892424854, 6.899575049678475, 6.7494106466571395, 6.762013415495545, 16.037425336738423, 15.265248765548066, 15.884384562571839, 3.747307219852999, 3.6994555120666774, 3.297000144918755, 7.2522190771996975, 7.078304495662451, 6.953538432717323, 12.193390426536396, 12.243872841199234, 12.408167512466505, 5.337188684691981, 5.238920481254652, 4.59770706792672, 9.247010841965675, 9.566186394542456, 8.831299662590027, 8.681614166746527, 8.341850238541753, 8.694260875384003, 9.746275805557758, 9.148052493731171, 9.149028519789368, 12.335631397863224, 12.051118796070412, 12.312151936193303, 5.685398702820137, 6.402144723882273, 5.827292849620179, 12.868382607897118, 13.382999350627259, 12.892132525642708, 7.894347235560417, 7.856588810682297, 8.228004142874852, 6.779739181200654, 7.077741115043551, 6.357660512129456, -98.46537973949066, -99.58130258818468, -109.90937646230063, 9.251715270181492, 9.040904035170868, 9.114694026609257, 7.796275191009045, 7.368866562843323, 7.820195950567722, 12.138606290022523, 12.568389562579483, 12.458401982362062, 10.475736421843365, 10.442610954244927, 10.551628743608788, 8.162399093310029, 7.748903195063264, 8.18249664331475, 2.6816063299775124, 2.9021522514522076, 2.1732317209243774, 13.841818523282797, 13.847960511843354, 13.76424370209375, 6.644655873378113, 6.516816241045788, 6.17616120477517, 11.568271890282631, 11.658494174480438, 11.60378210246563, 5.0739575078089985, 5.152527679999665, 5.122552429636315, 6.156018803517014, 6.510654817024857, 5.695518458882958, 3.8590492835889165, 3.908191152537853, 2.966815109054238, 12.230598762631416, 12.855546366423368, 12.482077091932297, 14.380143821239471, 14.416110046207905, 14.648034634068608, 11.076578448216111, 11.083561057845742, 11.688393677274377, 5.7179513300458495, 5.616297955314309, 5.491795773307473, 8.950337740282208, 8.729882473746926, 8.461842025319726, 6.710675934950501, 6.498308124641568, 6.362559551993996, 8.685945242643356, 8.580302640795708, 8.991832628846169, 6.872827137509972, 6.1128008613983695, 6.768914076189191, 1.2390543172756736, 2.0886006976167266, 1.575853789846093, 11.84008277952671, 11.571018919348717, 12.108424436300993, 11.678569967548043, 12.696119447859616, 11.976843679944665, 6.629499040544033, 7.024160224944353, 6.501836284995079, 5.961371183395386, 6.597575403749943, 6.446514397859573, 7.30202381809552, 7.832280596097306, 7.502032828827694, 6.4789696633815765, 6.470067635178566, 6.783666931092739, 5.8344855035344665, 5.910450114558131, 6.040406028429658, 9.167012634376675, 8.624776105086, 8.716632003585488, 4.478593200445175, 4.356459259986877, 4.455152779817581, 6.261543226738766, 6.043265690406159, 6.433523404722408, -1.1227743700146675, -1.4392122626304626, -0.9926658682525158, -89.52014183501403, -99.35428602496783, -88.90332044909398, 4.2663799822330475, 4.430447056889534, 4.483927175402641, 6.084153577685356, 5.877437070012093, 5.4600706696510315, 10.146362001697213, 10.31429639334479, 9.631506244341523, 1.5998702589422464, 1.002940684556961, 1.1166227981448174, 2.696754239499569, 2.5721832886338234, 2.4282955527305603, 6.953601992378623, 6.595172087351472, 7.030261882270366, 11.811088636517525, 11.722894698381424, 11.560284733772278, 6.391820912559822, 6.695566964646176, 6.741364416976765, 3.722505668799073, 3.366995180646569, 3.659191230932862, 3.652114173707858, 2.5750502099593433, 3.3455066283543857, 6.29677193860212, 6.447474422554166, 6.714453349510819, 9.11775844792524, 8.998403164247662, 9.189191746215016, 6.415196592609078, 6.704119744865835, 6.451793099443108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14506032681277625, "mean_inference_ms": 0.6411450740594776, "mean_action_processing_ms": 0.09451212189355221, "mean_env_wait_ms": 0.7992354664347743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 388800, "timesteps_this_iter": 0, "agent_timesteps_total": 1166400, "timers": {"sample_time_ms": 9442.655, "sample_throughput": 508.332, "load_time_ms": 0.1, "load_throughput": 48003479.256, "learn_time_ms": 1181.322, "learn_throughput": 4063.246, "update_time_ms": 1.398}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 84.72911930084229, "policy_loss": -0.0028223890978713584, "vf_loss": 84.84922790527344, "vf_explained_var": -0.0013831257820129395, "kl": 0.010503798570507903, "entropy": 11.770585775375366, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 388800, "num_agent_steps_sampled": 1166400, "num_steps_trained": 388800, "num_agent_steps_trained": 1166400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2223, "training_iteration": 81, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-55-16", "timestamp": 1706147716, "time_this_iter_s": 9.422892332077026, "time_total_s": 757.7706899642944, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D4E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 757.7706899642944, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 10.45, "ram_util_percent": 46.092857142857156}}
{"episode_reward_max": 59.40511480160055, "episode_reward_min": -307.95605878997594, "episode_reward_mean": 15.035367788041464, "episode_len_mean": 295.33, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -109.90937646230063}, "policy_reward_max": {"shared_policy": 20.081460979456693}, "policy_reward_mean": {"shared_policy": 5.011789262680487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.504319056868553, 23.30341968638821, 25.698374867439256, 21.704870726913185, 10.09319997951387, 30.01902599260211, 29.687961637973757, 37.49941463023424, 14.835450432030484, 33.7400179784745, 30.698206000030012, 35.171988526359186, 32.06741128489375, -273.7396206058329, 39.750634018331766, 41.788216365501256, 31.118391083204173, 17.34768114238976, 16.78631648421286, 30.022977389395237, 26.379917452111826, 45.95650555047905, 9.160963077098117, 20.41099911183116, 47.18705866485833, 10.743762876838431, 21.28406200557947, 36.845430780202136, 15.173816233873353, 27.644496899098158, 25.717725280672283, 28.043356819078298, 36.69890213012694, 17.91483627632259, 39.143514484167085, 23.978940189117566, 20.21514080837366, -307.95605878997594, 27.407313331961618, 22.98533770442009, 37.16539783496407, 31.46997611969708, 24.093798931688042, 7.756990302354097, 41.4540227372199, 19.33763331919907, 34.8305481672287, 15.349037617444978, 18.36219207942483, 10.734055545181008, 37.56822222098708, 43.444288501515985, 33.84853318333623, 16.82604505866763, 26.14206223934886, 19.571543611586065, 26.258080512285233, 19.754542075097532, 4.903508804738493, 35.51952613517642, 36.35153309535232, 20.155495550483465, 19.005460985004902, 22.63633724302052, 19.73270422965288, 17.785341646522255, 26.508420743048163, 13.290205240249634, 18.738332321867333, -3.554652500897646, -277.77774830907583, 13.180754214525223, 17.42166131734848, 30.092164639383526, 3.719433741644025, 7.697233080863953, 20.57903596200046, 35.09426806867123, 19.828752294182763, 10.748692080378504, 9.572671012021587, 19.458699710667105, 27.30535335838792, 19.57110943691802, 23.720172852277727, 14.04170521721241, 16.644277967512608, 27.75583638250825, 30.32693625241518, 17.536863736808286, 4.651994675397873, 30.022095665335627, 22.35818057507275, 20.42881195247172, 59.40511480160055, 33.82706101238726, 13.369100198149653, 26.39653268060644, 30.465694606129517, 41.02085850574075], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 232, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 117, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 84, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.968087561428547, 5.611062109470367, 5.925169385969639, 7.728102651735142, 8.320906390280769, 7.2544106443722995, 8.779893537362412, 8.534623627861336, 8.383857702215508, 7.4596058713893, 7.565738740066678, 6.679526115457207, 3.715685815860823, 3.2752294888098987, 3.1022846748431476, 9.943974919617176, 9.993668727576733, 10.081382345408201, 9.849112356702477, 10.094885329405457, 9.743963951865823, 12.634037302806973, 12.543023077771068, 12.3223542496562, 4.654229819774628, 4.809953063726425, 5.371267548529431, 11.597163250669837, 10.992654740810394, 11.150199986994267, 10.083200591305882, 10.454941088954598, 10.160064319769532, 11.6832346667846, 11.628453043599919, 11.860300815974668, 10.53906899690628, 10.69872648268938, 10.82961580529809, -88.40870398283005, -98.16138233244419, -87.16953429055866, 13.432772189378738, 13.783752296119928, 12.5341095328331, 13.498132983843476, 14.264130145932228, 14.025953235725552, 10.490081250046686, 10.037535359462098, 10.59077447369539, 5.784224716325596, 5.5959377040465625, 5.967518722017601, 5.614376788338021, 5.75759222110112, 5.41434747477372, 10.037962205708027, 10.035928644239902, 9.949086539447308, 9.211442887162164, 9.019227286179856, 8.149247278769806, 15.659725359117147, 15.328287549316883, 14.968492642045021, 3.3197991189857277, 2.896143068869904, 2.9450208892424854, 6.899575049678475, 6.7494106466571395, 6.762013415495545, 16.037425336738423, 15.265248765548066, 15.884384562571839, 3.747307219852999, 3.6994555120666774, 3.297000144918755, 7.2522190771996975, 7.078304495662451, 6.953538432717323, 12.193390426536396, 12.243872841199234, 12.408167512466505, 5.337188684691981, 5.238920481254652, 4.59770706792672, 9.247010841965675, 9.566186394542456, 8.831299662590027, 8.681614166746527, 8.341850238541753, 8.694260875384003, 9.746275805557758, 9.148052493731171, 9.149028519789368, 12.335631397863224, 12.051118796070412, 12.312151936193303, 5.685398702820137, 6.402144723882273, 5.827292849620179, 12.868382607897118, 13.382999350627259, 12.892132525642708, 7.894347235560417, 7.856588810682297, 8.228004142874852, 6.779739181200654, 7.077741115043551, 6.357660512129456, -98.46537973949066, -99.58130258818468, -109.90937646230063, 9.251715270181492, 9.040904035170868, 9.114694026609257, 7.796275191009045, 7.368866562843323, 7.820195950567722, 12.138606290022523, 12.568389562579483, 12.458401982362062, 10.475736421843365, 10.442610954244927, 10.551628743608788, 8.162399093310029, 7.748903195063264, 8.18249664331475, 2.6816063299775124, 2.9021522514522076, 2.1732317209243774, 13.841818523282797, 13.847960511843354, 13.76424370209375, 6.644655873378113, 6.516816241045788, 6.17616120477517, 11.568271890282631, 11.658494174480438, 11.60378210246563, 5.0739575078089985, 5.152527679999665, 5.122552429636315, 6.156018803517014, 6.510654817024857, 5.695518458882958, 3.8590492835889165, 3.908191152537853, 2.966815109054238, 12.230598762631416, 12.855546366423368, 12.482077091932297, 14.380143821239471, 14.416110046207905, 14.648034634068608, 11.076578448216111, 11.083561057845742, 11.688393677274377, 5.7179513300458495, 5.616297955314309, 5.491795773307473, 8.950337740282208, 8.729882473746926, 8.461842025319726, 6.710675934950501, 6.498308124641568, 6.362559551993996, 8.685945242643356, 8.580302640795708, 8.991832628846169, 6.872827137509972, 6.1128008613983695, 6.768914076189191, 1.2390543172756736, 2.0886006976167266, 1.575853789846093, 11.84008277952671, 11.571018919348717, 12.108424436300993, 11.678569967548043, 12.696119447859616, 11.976843679944665, 6.629499040544033, 7.024160224944353, 6.501836284995079, 5.961371183395386, 6.597575403749943, 6.446514397859573, 7.30202381809552, 7.832280596097306, 7.502032828827694, 6.4789696633815765, 6.470067635178566, 6.783666931092739, 5.8344855035344665, 5.910450114558131, 6.040406028429658, 9.167012634376675, 8.624776105086, 8.716632003585488, 4.478593200445175, 4.356459259986877, 4.455152779817581, 6.261543226738766, 6.043265690406159, 6.433523404722408, -1.1227743700146675, -1.4392122626304626, -0.9926658682525158, -89.52014183501403, -99.35428602496783, -88.90332044909398, 4.2663799822330475, 4.430447056889534, 4.483927175402641, 6.084153577685356, 5.877437070012093, 5.4600706696510315, 10.146362001697213, 10.31429639334479, 9.631506244341523, 1.5998702589422464, 1.002940684556961, 1.1166227981448174, 2.696754239499569, 2.5721832886338234, 2.4282955527305603, 6.953601992378623, 6.595172087351472, 7.030261882270366, 11.811088636517525, 11.722894698381424, 11.560284733772278, 6.391820912559822, 6.695566964646176, 6.741364416976765, 3.722505668799073, 3.366995180646569, 3.659191230932862, 3.652114173707858, 2.5750502099593433, 3.3455066283543857, 6.29677193860212, 6.447474422554166, 6.714453349510819, 9.11775844792524, 8.998403164247662, 9.189191746215016, 6.415196592609078, 6.704119744865835, 6.451793099443108, 7.898282403747231, 8.052804763118417, 7.76908568541208, 4.330024282137543, 4.861611510316521, 4.850069424758345, 5.535629063844681, 5.753338009119034, 5.355310894548893, 9.370148623983056, 9.191096643606812, 9.194591114918381, 10.52358178049326, 9.940004512667656, 9.863349959254265, 5.904793073733643, 5.6623078559835704, 5.969762807091072, 1.6245955750346184, 1.7584720775485039, 1.2689270228147507, 10.16810108597079, 10.31488203133145, 9.539112548033387, 7.599593472977475, 7.24413614471753, 7.514450957377747, 6.847071190675095, 6.576499556501702, 7.005241205294922, 19.876428032914788, 19.447225789229066, 20.081460979456693, 11.408244238545493, 11.544557788719729, 10.87425898512204, 4.427344250182301, 4.606017070511967, 4.335738877455384, 9.134834907871351, 9.143289380862058, 8.118408391873032, 10.134423573190958, 10.210463032572676, 10.120808000365884, 14.08893778113027, 13.637935650845364, 13.293985073765114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14499004486418163, "mean_inference_ms": 0.6413617263558946, "mean_action_processing_ms": 0.0945380063127817, "mean_env_wait_ms": 0.7997029567834468, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 393600, "timesteps_this_iter": 0, "agent_timesteps_total": 1180800, "timers": {"sample_time_ms": 9457.923, "sample_throughput": 507.511, "load_time_ms": 0.1, "load_throughput": 48003479.256, "learn_time_ms": 1179.614, "learn_throughput": 4069.129, "update_time_ms": 1.298}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 3.1020738780498505, "policy_loss": -0.0034099800359561616, "vf_loss": 3.2243009507656097, "vf_explained_var": -0.23288805782794952, "kl": 0.006917178572704977, "entropy": 11.90941035747528, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 393600, "num_agent_steps_sampled": 1180800, "num_steps_trained": 393600, "num_agent_steps_trained": 1180800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2239, "training_iteration": 82, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-55-25", "timestamp": 1706147725, "time_this_iter_s": 9.19438648223877, "time_total_s": 766.9650764465332, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D4E1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 766.9650764465332, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 7.846153846153848, "ram_util_percent": 46.10769230769232}}
{"episode_reward_max": 59.40511480160055, "episode_reward_min": -307.95605878997594, "episode_reward_mean": 16.73951260432134, "episode_len_mean": 296.01, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -109.90937646230063}, "policy_reward_max": {"shared_policy": 20.081460979456693}, "policy_reward_mean": {"shared_policy": 5.579837534773779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.118391083204173, 17.34768114238976, 16.78631648421286, 30.022977389395237, 26.379917452111826, 45.95650555047905, 9.160963077098117, 20.41099911183116, 47.18705866485833, 10.743762876838431, 21.28406200557947, 36.845430780202136, 15.173816233873353, 27.644496899098158, 25.717725280672283, 28.043356819078298, 36.69890213012694, 17.91483627632259, 39.143514484167085, 23.978940189117566, 20.21514080837366, -307.95605878997594, 27.407313331961618, 22.98533770442009, 37.16539783496407, 31.46997611969708, 24.093798931688042, 7.756990302354097, 41.4540227372199, 19.33763331919907, 34.8305481672287, 15.349037617444978, 18.36219207942483, 10.734055545181008, 37.56822222098708, 43.444288501515985, 33.84853318333623, 16.82604505866763, 26.14206223934886, 19.571543611586065, 26.258080512285233, 19.754542075097532, 4.903508804738493, 35.51952613517642, 36.35153309535232, 20.155495550483465, 19.005460985004902, 22.63633724302052, 19.73270422965288, 17.785341646522255, 26.508420743048163, 13.290205240249634, 18.738332321867333, -3.554652500897646, -277.77774830907583, 13.180754214525223, 17.42166131734848, 30.092164639383526, 3.719433741644025, 7.697233080863953, 20.57903596200046, 35.09426806867123, 19.828752294182763, 10.748692080378504, 9.572671012021587, 19.458699710667105, 27.30535335838792, 19.57110943691802, 23.720172852277727, 14.04170521721241, 16.644277967512608, 27.75583638250825, 30.32693625241518, 17.536863736808286, 4.651994675397873, 30.022095665335627, 22.35818057507275, 20.42881195247172, 59.40511480160055, 33.82706101238726, 13.369100198149653, 26.39653268060644, 30.465694606129517, 41.02085850574075, 27.557105882093282, 27.300869379192577, 29.697675969451637, 9.49428385309875, 16.599207411054508, 18.732294785790145, 15.473075438290806, 16.294858127832413, 15.975967741571338, 15.392443068325491, 38.03506234474479, 24.99536598473786, 6.596931155771017, 20.35872646793723, 23.83945479115937, 13.894049804657683], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 117, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 84, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [10.490081250046686, 10.037535359462098, 10.59077447369539, 5.784224716325596, 5.5959377040465625, 5.967518722017601, 5.614376788338021, 5.75759222110112, 5.41434747477372, 10.037962205708027, 10.035928644239902, 9.949086539447308, 9.211442887162164, 9.019227286179856, 8.149247278769806, 15.659725359117147, 15.328287549316883, 14.968492642045021, 3.3197991189857277, 2.896143068869904, 2.9450208892424854, 6.899575049678475, 6.7494106466571395, 6.762013415495545, 16.037425336738423, 15.265248765548066, 15.884384562571839, 3.747307219852999, 3.6994555120666774, 3.297000144918755, 7.2522190771996975, 7.078304495662451, 6.953538432717323, 12.193390426536396, 12.243872841199234, 12.408167512466505, 5.337188684691981, 5.238920481254652, 4.59770706792672, 9.247010841965675, 9.566186394542456, 8.831299662590027, 8.681614166746527, 8.341850238541753, 8.694260875384003, 9.746275805557758, 9.148052493731171, 9.149028519789368, 12.335631397863224, 12.051118796070412, 12.312151936193303, 5.685398702820137, 6.402144723882273, 5.827292849620179, 12.868382607897118, 13.382999350627259, 12.892132525642708, 7.894347235560417, 7.856588810682297, 8.228004142874852, 6.779739181200654, 7.077741115043551, 6.357660512129456, -98.46537973949066, -99.58130258818468, -109.90937646230063, 9.251715270181492, 9.040904035170868, 9.114694026609257, 7.796275191009045, 7.368866562843323, 7.820195950567722, 12.138606290022523, 12.568389562579483, 12.458401982362062, 10.475736421843365, 10.442610954244927, 10.551628743608788, 8.162399093310029, 7.748903195063264, 8.18249664331475, 2.6816063299775124, 2.9021522514522076, 2.1732317209243774, 13.841818523282797, 13.847960511843354, 13.76424370209375, 6.644655873378113, 6.516816241045788, 6.17616120477517, 11.568271890282631, 11.658494174480438, 11.60378210246563, 5.0739575078089985, 5.152527679999665, 5.122552429636315, 6.156018803517014, 6.510654817024857, 5.695518458882958, 3.8590492835889165, 3.908191152537853, 2.966815109054238, 12.230598762631416, 12.855546366423368, 12.482077091932297, 14.380143821239471, 14.416110046207905, 14.648034634068608, 11.076578448216111, 11.083561057845742, 11.688393677274377, 5.7179513300458495, 5.616297955314309, 5.491795773307473, 8.950337740282208, 8.729882473746926, 8.461842025319726, 6.710675934950501, 6.498308124641568, 6.362559551993996, 8.685945242643356, 8.580302640795708, 8.991832628846169, 6.872827137509972, 6.1128008613983695, 6.768914076189191, 1.2390543172756736, 2.0886006976167266, 1.575853789846093, 11.84008277952671, 11.571018919348717, 12.108424436300993, 11.678569967548043, 12.696119447859616, 11.976843679944665, 6.629499040544033, 7.024160224944353, 6.501836284995079, 5.961371183395386, 6.597575403749943, 6.446514397859573, 7.30202381809552, 7.832280596097306, 7.502032828827694, 6.4789696633815765, 6.470067635178566, 6.783666931092739, 5.8344855035344665, 5.910450114558131, 6.040406028429658, 9.167012634376675, 8.624776105086, 8.716632003585488, 4.478593200445175, 4.356459259986877, 4.455152779817581, 6.261543226738766, 6.043265690406159, 6.433523404722408, -1.1227743700146675, -1.4392122626304626, -0.9926658682525158, -89.52014183501403, -99.35428602496783, -88.90332044909398, 4.2663799822330475, 4.430447056889534, 4.483927175402641, 6.084153577685356, 5.877437070012093, 5.4600706696510315, 10.146362001697213, 10.31429639334479, 9.631506244341523, 1.5998702589422464, 1.002940684556961, 1.1166227981448174, 2.696754239499569, 2.5721832886338234, 2.4282955527305603, 6.953601992378623, 6.595172087351472, 7.030261882270366, 11.811088636517525, 11.722894698381424, 11.560284733772278, 6.391820912559822, 6.695566964646176, 6.741364416976765, 3.722505668799073, 3.366995180646569, 3.659191230932862, 3.652114173707858, 2.5750502099593433, 3.3455066283543857, 6.29677193860212, 6.447474422554166, 6.714453349510819, 9.11775844792524, 8.998403164247662, 9.189191746215016, 6.415196592609078, 6.704119744865835, 6.451793099443108, 7.898282403747231, 8.052804763118417, 7.76908568541208, 4.330024282137543, 4.861611510316521, 4.850069424758345, 5.535629063844681, 5.753338009119034, 5.355310894548893, 9.370148623983056, 9.191096643606812, 9.194591114918381, 10.52358178049326, 9.940004512667656, 9.863349959254265, 5.904793073733643, 5.6623078559835704, 5.969762807091072, 1.6245955750346184, 1.7584720775485039, 1.2689270228147507, 10.16810108597079, 10.31488203133145, 9.539112548033387, 7.599593472977475, 7.24413614471753, 7.514450957377747, 6.847071190675095, 6.576499556501702, 7.005241205294922, 19.876428032914788, 19.447225789229066, 20.081460979456693, 11.408244238545493, 11.544557788719729, 10.87425898512204, 4.427344250182301, 4.606017070511967, 4.335738877455384, 9.134834907871351, 9.143289380862058, 8.118408391873032, 10.134423573190958, 10.210463032572676, 10.120808000365884, 14.08893778113027, 13.637935650845364, 13.293985073765114, 9.279625308389456, 9.177595409254224, 9.099885164449603, 9.055750501652554, 9.38317984466751, 8.861939032872513, 9.90246410916248, 10.272537334511668, 9.52267452577749, 3.3093104641884565, 3.0938141644001007, 3.091159224510193, 5.486348525931433, 5.372526881595448, 5.740332003527627, 6.41603075619787, 6.100531846284866, 6.215732183307409, 5.339719070742518, 4.865135620037705, 5.268220747510583, 5.4100506529212, 5.336410231888294, 5.548397243022919, 5.368753040830285, 5.672432051661104, 4.934782649079949, 4.852898920575768, 5.477381440500409, 5.062162707249314, 12.447111596663788, 12.529073422153786, 13.058877325927213, 7.883889844020203, 8.875071985026196, 8.23640415569146, 2.3365226052701473, 2.0179975256323814, 2.2424110248684883, 7.347450967878103, 6.8853065967559814, 6.125968903303146, 7.83107727766037, 7.757884785532951, 8.250492727966048, 4.89538825427492, 4.65906449904044, 4.339597051342324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14492943502297673, "mean_inference_ms": 0.641526723016881, "mean_action_processing_ms": 0.09455048527547374, "mean_env_wait_ms": 0.800133897648316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 398400, "timesteps_this_iter": 0, "agent_timesteps_total": 1195200, "timers": {"sample_time_ms": 9486.39, "sample_throughput": 505.988, "load_time_ms": 0.1, "load_throughput": 48003479.256, "learn_time_ms": 1177.449, "learn_throughput": 4076.61, "update_time_ms": 1.2}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.2595490217208862, "policy_loss": -0.002360484939417762, "vf_loss": 2.3815530836582184, "vf_explained_var": -0.2859165817499161, "kl": 0.009418823086977281, "entropy": 12.002084970474243, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 398400, "num_agent_steps_sampled": 1195200, "num_steps_trained": 398400, "num_agent_steps_trained": 1195200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2255, "training_iteration": 83, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-55-35", "timestamp": 1706147735, "time_this_iter_s": 9.298798084259033, "time_total_s": 776.2638745307922, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210005281F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 776.2638745307922, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 8.646153846153846, "ram_util_percent": 46.153846153846146}}
{"episode_reward_max": 59.40511480160055, "episode_reward_min": -307.95605878997594, "episode_reward_mean": 16.45111620966751, "episode_len_mean": 296.01, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -109.90937646230063}, "policy_reward_max": {"shared_policy": 20.081460979456693}, "policy_reward_mean": {"shared_policy": 5.483705403222503}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.69890213012694, 17.91483627632259, 39.143514484167085, 23.978940189117566, 20.21514080837366, -307.95605878997594, 27.407313331961618, 22.98533770442009, 37.16539783496407, 31.46997611969708, 24.093798931688042, 7.756990302354097, 41.4540227372199, 19.33763331919907, 34.8305481672287, 15.349037617444978, 18.36219207942483, 10.734055545181008, 37.56822222098708, 43.444288501515985, 33.84853318333623, 16.82604505866763, 26.14206223934886, 19.571543611586065, 26.258080512285233, 19.754542075097532, 4.903508804738493, 35.51952613517642, 36.35153309535232, 20.155495550483465, 19.005460985004902, 22.63633724302052, 19.73270422965288, 17.785341646522255, 26.508420743048163, 13.290205240249634, 18.738332321867333, -3.554652500897646, -277.77774830907583, 13.180754214525223, 17.42166131734848, 30.092164639383526, 3.719433741644025, 7.697233080863953, 20.57903596200046, 35.09426806867123, 19.828752294182763, 10.748692080378504, 9.572671012021587, 19.458699710667105, 27.30535335838792, 19.57110943691802, 23.720172852277727, 14.04170521721241, 16.644277967512608, 27.75583638250825, 30.32693625241518, 17.536863736808286, 4.651994675397873, 30.022095665335627, 22.35818057507275, 20.42881195247172, 59.40511480160055, 33.82706101238726, 13.369100198149653, 26.39653268060644, 30.465694606129517, 41.02085850574075, 27.557105882093282, 27.300869379192577, 29.697675969451637, 9.49428385309875, 16.599207411054508, 18.732294785790145, 15.473075438290806, 16.294858127832413, 15.975967741571338, 15.392443068325491, 38.03506234474479, 24.99536598473786, 6.596931155771017, 20.35872646793723, 23.83945479115937, 13.894049804657683, 28.578626499744132, 9.961609467864022, 36.179097547894315, 27.21537818387148, 18.99198791012168, 15.347158774733543, 15.011552251875386, 17.357257146388264, 13.869706582277999, 32.417381729930625, 29.592132527381153, 22.70222694799304, 28.786015205085263, 29.41754410788417, 34.318095937371226, 21.23805056512353], "episode_lengths": [300, 300, 300, 300, 300, 117, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 84, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [12.335631397863224, 12.051118796070412, 12.312151936193303, 5.685398702820137, 6.402144723882273, 5.827292849620179, 12.868382607897118, 13.382999350627259, 12.892132525642708, 7.894347235560417, 7.856588810682297, 8.228004142874852, 6.779739181200654, 7.077741115043551, 6.357660512129456, -98.46537973949066, -99.58130258818468, -109.90937646230063, 9.251715270181492, 9.040904035170868, 9.114694026609257, 7.796275191009045, 7.368866562843323, 7.820195950567722, 12.138606290022523, 12.568389562579483, 12.458401982362062, 10.475736421843365, 10.442610954244927, 10.551628743608788, 8.162399093310029, 7.748903195063264, 8.18249664331475, 2.6816063299775124, 2.9021522514522076, 2.1732317209243774, 13.841818523282797, 13.847960511843354, 13.76424370209375, 6.644655873378113, 6.516816241045788, 6.17616120477517, 11.568271890282631, 11.658494174480438, 11.60378210246563, 5.0739575078089985, 5.152527679999665, 5.122552429636315, 6.156018803517014, 6.510654817024857, 5.695518458882958, 3.8590492835889165, 3.908191152537853, 2.966815109054238, 12.230598762631416, 12.855546366423368, 12.482077091932297, 14.380143821239471, 14.416110046207905, 14.648034634068608, 11.076578448216111, 11.083561057845742, 11.688393677274377, 5.7179513300458495, 5.616297955314309, 5.491795773307473, 8.950337740282208, 8.729882473746926, 8.461842025319726, 6.710675934950501, 6.498308124641568, 6.362559551993996, 8.685945242643356, 8.580302640795708, 8.991832628846169, 6.872827137509972, 6.1128008613983695, 6.768914076189191, 1.2390543172756736, 2.0886006976167266, 1.575853789846093, 11.84008277952671, 11.571018919348717, 12.108424436300993, 11.678569967548043, 12.696119447859616, 11.976843679944665, 6.629499040544033, 7.024160224944353, 6.501836284995079, 5.961371183395386, 6.597575403749943, 6.446514397859573, 7.30202381809552, 7.832280596097306, 7.502032828827694, 6.4789696633815765, 6.470067635178566, 6.783666931092739, 5.8344855035344665, 5.910450114558131, 6.040406028429658, 9.167012634376675, 8.624776105086, 8.716632003585488, 4.478593200445175, 4.356459259986877, 4.455152779817581, 6.261543226738766, 6.043265690406159, 6.433523404722408, -1.1227743700146675, -1.4392122626304626, -0.9926658682525158, -89.52014183501403, -99.35428602496783, -88.90332044909398, 4.2663799822330475, 4.430447056889534, 4.483927175402641, 6.084153577685356, 5.877437070012093, 5.4600706696510315, 10.146362001697213, 10.31429639334479, 9.631506244341523, 1.5998702589422464, 1.002940684556961, 1.1166227981448174, 2.696754239499569, 2.5721832886338234, 2.4282955527305603, 6.953601992378623, 6.595172087351472, 7.030261882270366, 11.811088636517525, 11.722894698381424, 11.560284733772278, 6.391820912559822, 6.695566964646176, 6.741364416976765, 3.722505668799073, 3.366995180646569, 3.659191230932862, 3.652114173707858, 2.5750502099593433, 3.3455066283543857, 6.29677193860212, 6.447474422554166, 6.714453349510819, 9.11775844792524, 8.998403164247662, 9.189191746215016, 6.415196592609078, 6.704119744865835, 6.451793099443108, 7.898282403747231, 8.052804763118417, 7.76908568541208, 4.330024282137543, 4.861611510316521, 4.850069424758345, 5.535629063844681, 5.753338009119034, 5.355310894548893, 9.370148623983056, 9.191096643606812, 9.194591114918381, 10.52358178049326, 9.940004512667656, 9.863349959254265, 5.904793073733643, 5.6623078559835704, 5.969762807091072, 1.6245955750346184, 1.7584720775485039, 1.2689270228147507, 10.16810108597079, 10.31488203133145, 9.539112548033387, 7.599593472977475, 7.24413614471753, 7.514450957377747, 6.847071190675095, 6.576499556501702, 7.005241205294922, 19.876428032914788, 19.447225789229066, 20.081460979456693, 11.408244238545493, 11.544557788719729, 10.87425898512204, 4.427344250182301, 4.606017070511967, 4.335738877455384, 9.134834907871351, 9.143289380862058, 8.118408391873032, 10.134423573190958, 10.210463032572676, 10.120808000365884, 14.08893778113027, 13.637935650845364, 13.293985073765114, 9.279625308389456, 9.177595409254224, 9.099885164449603, 9.055750501652554, 9.38317984466751, 8.861939032872513, 9.90246410916248, 10.272537334511668, 9.52267452577749, 3.3093104641884565, 3.0938141644001007, 3.091159224510193, 5.486348525931433, 5.372526881595448, 5.740332003527627, 6.41603075619787, 6.100531846284866, 6.215732183307409, 5.339719070742518, 4.865135620037705, 5.268220747510583, 5.4100506529212, 5.336410231888294, 5.548397243022919, 5.368753040830285, 5.672432051661104, 4.934782649079949, 4.852898920575768, 5.477381440500409, 5.062162707249314, 12.447111596663788, 12.529073422153786, 13.058877325927213, 7.883889844020203, 8.875071985026196, 8.23640415569146, 2.3365226052701473, 2.0179975256323814, 2.2424110248684883, 7.347450967878103, 6.8853065967559814, 6.125968903303146, 7.83107727766037, 7.757884785532951, 8.250492727966048, 4.89538825427492, 4.65906449904044, 4.339597051342324, 9.174189984798431, 9.786352747352794, 9.618083767592907, 3.3336509143312725, 3.508430508275822, 3.119528045256928, 12.061949933568627, 11.778218934933335, 12.338928679392353, 9.11694276208678, 9.136894951264054, 8.961540470520646, 6.362564079463482, 6.178208366036415, 6.451215464621782, 5.055842839181423, 5.137178294360638, 5.1541376411914825, 5.185796660681561, 4.733654861648873, 5.092100729544953, 5.765290504942328, 5.931296313802392, 5.660670327643544, 4.833519646277026, 4.501062986751393, 4.535123949249581, 11.076431990911559, 10.556725551684693, 10.784224187334374, 9.610888416568429, 10.168111919114978, 9.813132191697747, 7.684611588716507, 7.1579908430576324, 7.859624516218901, 9.66196410109599, 9.591906403501824, 9.53214470048745, 9.736669450998306, 10.129708867520094, 9.551165789365768, 11.687721277276665, 11.05887923638025, 11.57149542371431, 7.066605920592934, 6.830952773491532, 7.340491871039063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14487486512723063, "mean_inference_ms": 0.641636302857817, "mean_action_processing_ms": 0.09456187315928916, "mean_env_wait_ms": 0.8005103774562482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 403200, "timesteps_this_iter": 0, "agent_timesteps_total": 1209600, "timers": {"sample_time_ms": 9559.716, "sample_throughput": 502.107, "load_time_ms": 0.1, "load_throughput": 48003479.256, "learn_time_ms": 1188.671, "learn_throughput": 4038.124, "update_time_ms": 1.199}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.3747699558734894, "policy_loss": -0.0024625617897254815, "vf_loss": 2.4984471797943115, "vf_explained_var": -0.25525930523872375, "kl": 0.006762188510128675, "entropy": 12.14854907989502, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 403200, "num_agent_steps_sampled": 1209600, "num_steps_trained": 403200, "num_agent_steps_trained": 1209600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2271, "training_iteration": 84, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-55-45", "timestamp": 1706147745, "time_this_iter_s": 9.96897029876709, "time_total_s": 786.2328448295593, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1CD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 786.2328448295593, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 9.014285714285714, "ram_util_percent": 46.300000000000004}}
{"episode_reward_max": 59.40511480160055, "episode_reward_min": -304.42736122757196, "episode_reward_mean": 16.011372364560945, "episode_len_mean": 295.11, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -104.00132338205974}, "policy_reward_max": {"shared_policy": 20.081460979456693}, "policy_reward_mean": {"shared_policy": 5.337124121520313}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.734055545181008, 37.56822222098708, 43.444288501515985, 33.84853318333623, 16.82604505866763, 26.14206223934886, 19.571543611586065, 26.258080512285233, 19.754542075097532, 4.903508804738493, 35.51952613517642, 36.35153309535232, 20.155495550483465, 19.005460985004902, 22.63633724302052, 19.73270422965288, 17.785341646522255, 26.508420743048163, 13.290205240249634, 18.738332321867333, -3.554652500897646, -277.77774830907583, 13.180754214525223, 17.42166131734848, 30.092164639383526, 3.719433741644025, 7.697233080863953, 20.57903596200046, 35.09426806867123, 19.828752294182763, 10.748692080378504, 9.572671012021587, 19.458699710667105, 27.30535335838792, 19.57110943691802, 23.720172852277727, 14.04170521721241, 16.644277967512608, 27.75583638250825, 30.32693625241518, 17.536863736808286, 4.651994675397873, 30.022095665335627, 22.35818057507275, 20.42881195247172, 59.40511480160055, 33.82706101238726, 13.369100198149653, 26.39653268060644, 30.465694606129517, 41.02085850574075, 27.557105882093282, 27.300869379192577, 29.697675969451637, 9.49428385309875, 16.599207411054508, 18.732294785790145, 15.473075438290806, 16.294858127832413, 15.975967741571338, 15.392443068325491, 38.03506234474479, 24.99536598473786, 6.596931155771017, 20.35872646793723, 23.83945479115937, 13.894049804657683, 28.578626499744132, 9.961609467864022, 36.179097547894315, 27.21537818387148, 18.99198791012168, 15.347158774733543, 15.011552251875386, 17.357257146388264, 13.869706582277999, 32.417381729930625, 29.592132527381153, 22.70222694799304, 28.786015205085263, 29.41754410788417, 34.318095937371226, 21.23805056512353, 22.794058280065627, -304.42736122757196, 38.46035711420697, 22.189106383360894, 20.463262201286824, 23.976612826809287, 24.863045725971446, 16.365440107881994, 25.875572435557814, 12.059768582694204, 24.98701298236847, 32.5684187300503, 34.858819320797906, 21.018218968063564, 21.50968816131352, 20.24850070476532, 8.422617435455294], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 84, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.8590492835889165, 3.908191152537853, 2.966815109054238, 12.230598762631416, 12.855546366423368, 12.482077091932297, 14.380143821239471, 14.416110046207905, 14.648034634068608, 11.076578448216111, 11.083561057845742, 11.688393677274377, 5.7179513300458495, 5.616297955314309, 5.491795773307473, 8.950337740282208, 8.729882473746926, 8.461842025319726, 6.710675934950501, 6.498308124641568, 6.362559551993996, 8.685945242643356, 8.580302640795708, 8.991832628846169, 6.872827137509972, 6.1128008613983695, 6.768914076189191, 1.2390543172756736, 2.0886006976167266, 1.575853789846093, 11.84008277952671, 11.571018919348717, 12.108424436300993, 11.678569967548043, 12.696119447859616, 11.976843679944665, 6.629499040544033, 7.024160224944353, 6.501836284995079, 5.961371183395386, 6.597575403749943, 6.446514397859573, 7.30202381809552, 7.832280596097306, 7.502032828827694, 6.4789696633815765, 6.470067635178566, 6.783666931092739, 5.8344855035344665, 5.910450114558131, 6.040406028429658, 9.167012634376675, 8.624776105086, 8.716632003585488, 4.478593200445175, 4.356459259986877, 4.455152779817581, 6.261543226738766, 6.043265690406159, 6.433523404722408, -1.1227743700146675, -1.4392122626304626, -0.9926658682525158, -89.52014183501403, -99.35428602496783, -88.90332044909398, 4.2663799822330475, 4.430447056889534, 4.483927175402641, 6.084153577685356, 5.877437070012093, 5.4600706696510315, 10.146362001697213, 10.31429639334479, 9.631506244341523, 1.5998702589422464, 1.002940684556961, 1.1166227981448174, 2.696754239499569, 2.5721832886338234, 2.4282955527305603, 6.953601992378623, 6.595172087351472, 7.030261882270366, 11.811088636517525, 11.722894698381424, 11.560284733772278, 6.391820912559822, 6.695566964646176, 6.741364416976765, 3.722505668799073, 3.366995180646569, 3.659191230932862, 3.652114173707858, 2.5750502099593433, 3.3455066283543857, 6.29677193860212, 6.447474422554166, 6.714453349510819, 9.11775844792524, 8.998403164247662, 9.189191746215016, 6.415196592609078, 6.704119744865835, 6.451793099443108, 7.898282403747231, 8.052804763118417, 7.76908568541208, 4.330024282137543, 4.861611510316521, 4.850069424758345, 5.535629063844681, 5.753338009119034, 5.355310894548893, 9.370148623983056, 9.191096643606812, 9.194591114918381, 10.52358178049326, 9.940004512667656, 9.863349959254265, 5.904793073733643, 5.6623078559835704, 5.969762807091072, 1.6245955750346184, 1.7584720775485039, 1.2689270228147507, 10.16810108597079, 10.31488203133145, 9.539112548033387, 7.599593472977475, 7.24413614471753, 7.514450957377747, 6.847071190675095, 6.576499556501702, 7.005241205294922, 19.876428032914788, 19.447225789229066, 20.081460979456693, 11.408244238545493, 11.544557788719729, 10.87425898512204, 4.427344250182301, 4.606017070511967, 4.335738877455384, 9.134834907871351, 9.143289380862058, 8.118408391873032, 10.134423573190958, 10.210463032572676, 10.120808000365884, 14.08893778113027, 13.637935650845364, 13.293985073765114, 9.279625308389456, 9.177595409254224, 9.099885164449603, 9.055750501652554, 9.38317984466751, 8.861939032872513, 9.90246410916248, 10.272537334511668, 9.52267452577749, 3.3093104641884565, 3.0938141644001007, 3.091159224510193, 5.486348525931433, 5.372526881595448, 5.740332003527627, 6.41603075619787, 6.100531846284866, 6.215732183307409, 5.339719070742518, 4.865135620037705, 5.268220747510583, 5.4100506529212, 5.336410231888294, 5.548397243022919, 5.368753040830285, 5.672432051661104, 4.934782649079949, 4.852898920575768, 5.477381440500409, 5.062162707249314, 12.447111596663788, 12.529073422153786, 13.058877325927213, 7.883889844020203, 8.875071985026196, 8.23640415569146, 2.3365226052701473, 2.0179975256323814, 2.2424110248684883, 7.347450967878103, 6.8853065967559814, 6.125968903303146, 7.83107727766037, 7.757884785532951, 8.250492727966048, 4.89538825427492, 4.65906449904044, 4.339597051342324, 9.174189984798431, 9.786352747352794, 9.618083767592907, 3.3336509143312725, 3.508430508275822, 3.119528045256928, 12.061949933568627, 11.778218934933335, 12.338928679392353, 9.11694276208678, 9.136894951264054, 8.961540470520646, 6.362564079463482, 6.178208366036415, 6.451215464621782, 5.055842839181423, 5.137178294360638, 5.1541376411914825, 5.185796660681561, 4.733654861648873, 5.092100729544953, 5.765290504942328, 5.931296313802392, 5.660670327643544, 4.833519646277026, 4.501062986751393, 4.535123949249581, 11.076431990911559, 10.556725551684693, 10.784224187334374, 9.610888416568429, 10.168111919114978, 9.813132191697747, 7.684611588716507, 7.1579908430576324, 7.859624516218901, 9.66196410109599, 9.591906403501824, 9.53214470048745, 9.736669450998306, 10.129708867520094, 9.551165789365768, 11.687721277276665, 11.05887923638025, 11.57149542371431, 7.066605920592934, 6.830952773491532, 7.340491871039063, 8.028867211813719, 7.451697433988244, 7.313493634263665, -104.00132338205974, -100.18506860981385, -100.24096923569839, 12.449069033066422, 13.065801354280353, 12.945486726860196, 7.211357409755379, 7.123520428935677, 7.854228544669837, 6.635083983341843, 7.088812369542808, 6.739365848402173, 7.839457243680954, 8.144992338493466, 7.992163244634867, 8.170838383336857, 8.449174491067723, 8.243032851566866, 5.502187917629868, 4.969292963544518, 5.893959226707608, 8.662593806783349, 8.91113634655872, 8.301842282215745, 3.739038581649453, 4.381887485894055, 3.9388425151506965, 8.320377312600613, 8.453200750052929, 8.213434919714928, 10.129538784424454, 11.263592746729643, 11.1752871988962, 11.328098972638443, 11.725170736511544, 11.805549611647919, 6.689203764001519, 7.19776042799154, 7.131254776070506, 7.3860691798229965, 6.7818586279948505, 7.341760353495673, 7.152194827795029, 6.248762384057045, 6.847543492913246, 2.7985828022162025, 2.809088716904313, 2.8149459163347785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14483337041095104, "mean_inference_ms": 0.6416949455759918, "mean_action_processing_ms": 0.09457244419569463, "mean_env_wait_ms": 0.8008528755976773, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 1224000, "timers": {"sample_time_ms": 9602.829, "sample_throughput": 499.853, "load_time_ms": 0.1, "load_throughput": 48003479.256, "learn_time_ms": 1187.847, "learn_throughput": 4040.926, "update_time_ms": 1.099}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 47.22732734680176, "policy_loss": -0.004780174585757857, "vf_loss": 47.354222774505615, "vf_explained_var": 0.00010940432548522949, "kl": 0.011466909607501444, "entropy": 12.257379055023193, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 1224000, "num_steps_trained": 408000, "num_agent_steps_trained": 1224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2288, "training_iteration": 85, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-55-54", "timestamp": 1706147754, "time_this_iter_s": 9.61282992362976, "time_total_s": 795.8456747531891, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000537C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 795.8456747531891, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 8.5, "ram_util_percent": 46.51428571428572}}
{"episode_reward_max": 59.40511480160055, "episode_reward_min": -304.42736122757196, "episode_reward_mean": 16.26693943334218, "episode_len_mean": 295.11, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.00132338205974}, "policy_reward_max": {"shared_policy": 20.081460979456693}, "policy_reward_mean": {"shared_policy": 5.422313144447393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.785341646522255, 26.508420743048163, 13.290205240249634, 18.738332321867333, -3.554652500897646, -277.77774830907583, 13.180754214525223, 17.42166131734848, 30.092164639383526, 3.719433741644025, 7.697233080863953, 20.57903596200046, 35.09426806867123, 19.828752294182763, 10.748692080378504, 9.572671012021587, 19.458699710667105, 27.30535335838792, 19.57110943691802, 23.720172852277727, 14.04170521721241, 16.644277967512608, 27.75583638250825, 30.32693625241518, 17.536863736808286, 4.651994675397873, 30.022095665335627, 22.35818057507275, 20.42881195247172, 59.40511480160055, 33.82706101238726, 13.369100198149653, 26.39653268060644, 30.465694606129517, 41.02085850574075, 27.557105882093282, 27.300869379192577, 29.697675969451637, 9.49428385309875, 16.599207411054508, 18.732294785790145, 15.473075438290806, 16.294858127832413, 15.975967741571338, 15.392443068325491, 38.03506234474479, 24.99536598473786, 6.596931155771017, 20.35872646793723, 23.83945479115937, 13.894049804657683, 28.578626499744132, 9.961609467864022, 36.179097547894315, 27.21537818387148, 18.99198791012168, 15.347158774733543, 15.011552251875386, 17.357257146388264, 13.869706582277999, 32.417381729930625, 29.592132527381153, 22.70222694799304, 28.786015205085263, 29.41754410788417, 34.318095937371226, 21.23805056512353, 22.794058280065627, -304.42736122757196, 38.46035711420697, 22.189106383360894, 20.463262201286824, 23.976612826809287, 24.863045725971446, 16.365440107881994, 25.875572435557814, 12.059768582694204, 24.98701298236847, 32.5684187300503, 34.858819320797906, 21.018218968063564, 21.50968816131352, 20.24850070476532, 8.422617435455294, 32.427266577258706, 37.3077681660652, 33.337072169408174, 21.291504770517335, 24.172596185235278, 30.616642821580157, 19.339601028710575, 30.504609167575822, 26.942065900191665, 7.834387499839053, 25.010388471186147, 33.04158625006673, 29.615319207310662, 23.069474268704624, 15.66035791393368, 27.83800547197461], "episode_lengths": [300, 300, 300, 300, 300, 84, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.8344855035344665, 5.910450114558131, 6.040406028429658, 9.167012634376675, 8.624776105086, 8.716632003585488, 4.478593200445175, 4.356459259986877, 4.455152779817581, 6.261543226738766, 6.043265690406159, 6.433523404722408, -1.1227743700146675, -1.4392122626304626, -0.9926658682525158, -89.52014183501403, -99.35428602496783, -88.90332044909398, 4.2663799822330475, 4.430447056889534, 4.483927175402641, 6.084153577685356, 5.877437070012093, 5.4600706696510315, 10.146362001697213, 10.31429639334479, 9.631506244341523, 1.5998702589422464, 1.002940684556961, 1.1166227981448174, 2.696754239499569, 2.5721832886338234, 2.4282955527305603, 6.953601992378623, 6.595172087351472, 7.030261882270366, 11.811088636517525, 11.722894698381424, 11.560284733772278, 6.391820912559822, 6.695566964646176, 6.741364416976765, 3.722505668799073, 3.366995180646569, 3.659191230932862, 3.652114173707858, 2.5750502099593433, 3.3455066283543857, 6.29677193860212, 6.447474422554166, 6.714453349510819, 9.11775844792524, 8.998403164247662, 9.189191746215016, 6.415196592609078, 6.704119744865835, 6.451793099443108, 7.898282403747231, 8.052804763118417, 7.76908568541208, 4.330024282137543, 4.861611510316521, 4.850069424758345, 5.535629063844681, 5.753338009119034, 5.355310894548893, 9.370148623983056, 9.191096643606812, 9.194591114918381, 10.52358178049326, 9.940004512667656, 9.863349959254265, 5.904793073733643, 5.6623078559835704, 5.969762807091072, 1.6245955750346184, 1.7584720775485039, 1.2689270228147507, 10.16810108597079, 10.31488203133145, 9.539112548033387, 7.599593472977475, 7.24413614471753, 7.514450957377747, 6.847071190675095, 6.576499556501702, 7.005241205294922, 19.876428032914788, 19.447225789229066, 20.081460979456693, 11.408244238545493, 11.544557788719729, 10.87425898512204, 4.427344250182301, 4.606017070511967, 4.335738877455384, 9.134834907871351, 9.143289380862058, 8.118408391873032, 10.134423573190958, 10.210463032572676, 10.120808000365884, 14.08893778113027, 13.637935650845364, 13.293985073765114, 9.279625308389456, 9.177595409254224, 9.099885164449603, 9.055750501652554, 9.38317984466751, 8.861939032872513, 9.90246410916248, 10.272537334511668, 9.52267452577749, 3.3093104641884565, 3.0938141644001007, 3.091159224510193, 5.486348525931433, 5.372526881595448, 5.740332003527627, 6.41603075619787, 6.100531846284866, 6.215732183307409, 5.339719070742518, 4.865135620037705, 5.268220747510583, 5.4100506529212, 5.336410231888294, 5.548397243022919, 5.368753040830285, 5.672432051661104, 4.934782649079949, 4.852898920575768, 5.477381440500409, 5.062162707249314, 12.447111596663788, 12.529073422153786, 13.058877325927213, 7.883889844020203, 8.875071985026196, 8.23640415569146, 2.3365226052701473, 2.0179975256323814, 2.2424110248684883, 7.347450967878103, 6.8853065967559814, 6.125968903303146, 7.83107727766037, 7.757884785532951, 8.250492727966048, 4.89538825427492, 4.65906449904044, 4.339597051342324, 9.174189984798431, 9.786352747352794, 9.618083767592907, 3.3336509143312725, 3.508430508275822, 3.119528045256928, 12.061949933568627, 11.778218934933335, 12.338928679392353, 9.11694276208678, 9.136894951264054, 8.961540470520646, 6.362564079463482, 6.178208366036415, 6.451215464621782, 5.055842839181423, 5.137178294360638, 5.1541376411914825, 5.185796660681561, 4.733654861648873, 5.092100729544953, 5.765290504942328, 5.931296313802392, 5.660670327643544, 4.833519646277026, 4.501062986751393, 4.535123949249581, 11.076431990911559, 10.556725551684693, 10.784224187334374, 9.610888416568429, 10.168111919114978, 9.813132191697747, 7.684611588716507, 7.1579908430576324, 7.859624516218901, 9.66196410109599, 9.591906403501824, 9.53214470048745, 9.736669450998306, 10.129708867520094, 9.551165789365768, 11.687721277276665, 11.05887923638025, 11.57149542371431, 7.066605920592934, 6.830952773491532, 7.340491871039063, 8.028867211813719, 7.451697433988244, 7.313493634263665, -104.00132338205974, -100.18506860981385, -100.24096923569839, 12.449069033066422, 13.065801354280353, 12.945486726860196, 7.211357409755379, 7.123520428935677, 7.854228544669837, 6.635083983341843, 7.088812369542808, 6.739365848402173, 7.839457243680954, 8.144992338493466, 7.992163244634867, 8.170838383336857, 8.449174491067723, 8.243032851566866, 5.502187917629868, 4.969292963544518, 5.893959226707608, 8.662593806783349, 8.91113634655872, 8.301842282215745, 3.739038581649453, 4.381887485894055, 3.9388425151506965, 8.320377312600613, 8.453200750052929, 8.213434919714928, 10.129538784424454, 11.263592746729643, 11.1752871988962, 11.328098972638443, 11.725170736511544, 11.805549611647919, 6.689203764001519, 7.19776042799154, 7.131254776070506, 7.3860691798229965, 6.7818586279948505, 7.341760353495673, 7.152194827795029, 6.248762384057045, 6.847543492913246, 2.7985828022162025, 2.809088716904313, 2.8149459163347785, 11.527058998122811, 10.653945863246918, 10.246261715888977, 12.294543435176209, 12.306823929150895, 12.706400801738098, 11.439713642622024, 10.920687506596238, 10.976671020189912, 7.281343517204121, 7.397573245068386, 6.612588008244828, 7.73057075838247, 8.074645871917397, 8.367379554935411, 10.592800983538226, 9.967393120129898, 10.056448717912033, 6.832501827428729, 6.22907496492067, 6.278024236361176, 10.216922526558236, 10.011780699094132, 10.275905941923455, 9.184231063351035, 9.055873103439808, 8.701961733400822, 2.6028797974189075, 2.3837757309277805, 2.8477319714923652, 8.483758219828204, 8.36868955319126, 8.157940698166684, 11.03322062889734, 10.463212842742593, 11.545152778426797, 9.772706573208168, 9.765457158287361, 10.077155475815132, 7.748305636147649, 7.434564443926007, 7.886604188630969, 5.147282784183815, 4.984045480688408, 5.5290296490614566, 9.520938102155924, 9.082734011113644, 9.234333358705044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14481885459385446, "mean_inference_ms": 0.6417998183769117, "mean_action_processing_ms": 0.0945904128814152, "mean_env_wait_ms": 0.8012130474338099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 412800, "timesteps_this_iter": 0, "agent_timesteps_total": 1238400, "timers": {"sample_time_ms": 9590.088, "sample_throughput": 500.517, "load_time_ms": 0.1, "load_throughput": 48003479.256, "learn_time_ms": 1186.959, "learn_throughput": 4043.949, "update_time_ms": 1.1}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.109433203935623, "policy_loss": -0.002322118836584508, "vf_loss": 2.2347285449504852, "vf_explained_var": -0.19126708805561066, "kl": 0.005413994484212077, "entropy": 12.318996906280518, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 412800, "num_agent_steps_sampled": 1238400, "num_steps_trained": 412800, "num_agent_steps_trained": 1238400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2304, "training_iteration": 86, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-56-04", "timestamp": 1706147764, "time_this_iter_s": 9.527133703231812, "time_total_s": 805.3728084564209, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1C430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 805.3728084564209, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 8.023076923076925, "ram_util_percent": 46.44615384615385}}
{"episode_reward_max": 59.40511480160055, "episode_reward_min": -304.42736122757196, "episode_reward_mean": 20.711570085342377, "episode_len_mean": 297.27, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.00132338205974}, "policy_reward_max": {"shared_policy": 20.081460979456693}, "policy_reward_mean": {"shared_policy": 6.903856695114125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.458699710667105, 27.30535335838792, 19.57110943691802, 23.720172852277727, 14.04170521721241, 16.644277967512608, 27.75583638250825, 30.32693625241518, 17.536863736808286, 4.651994675397873, 30.022095665335627, 22.35818057507275, 20.42881195247172, 59.40511480160055, 33.82706101238726, 13.369100198149653, 26.39653268060644, 30.465694606129517, 41.02085850574075, 27.557105882093282, 27.300869379192577, 29.697675969451637, 9.49428385309875, 16.599207411054508, 18.732294785790145, 15.473075438290806, 16.294858127832413, 15.975967741571338, 15.392443068325491, 38.03506234474479, 24.99536598473786, 6.596931155771017, 20.35872646793723, 23.83945479115937, 13.894049804657683, 28.578626499744132, 9.961609467864022, 36.179097547894315, 27.21537818387148, 18.99198791012168, 15.347158774733543, 15.011552251875386, 17.357257146388264, 13.869706582277999, 32.417381729930625, 29.592132527381153, 22.70222694799304, 28.786015205085263, 29.41754410788417, 34.318095937371226, 21.23805056512353, 22.794058280065627, -304.42736122757196, 38.46035711420697, 22.189106383360894, 20.463262201286824, 23.976612826809287, 24.863045725971446, 16.365440107881994, 25.875572435557814, 12.059768582694204, 24.98701298236847, 32.5684187300503, 34.858819320797906, 21.018218968063564, 21.50968816131352, 20.24850070476532, 8.422617435455294, 32.427266577258706, 37.3077681660652, 33.337072169408174, 21.291504770517335, 24.172596185235278, 30.616642821580157, 19.339601028710575, 30.504609167575822, 26.942065900191665, 7.834387499839053, 25.010388471186147, 33.04158625006673, 29.615319207310662, 23.069474268704624, 15.66035791393368, 27.83800547197461, 8.030562264844747, 31.541129155550138, 9.522520557045908, 27.022943571209908, 23.70713634742421, 40.345242910087094, 19.3705907706171, 32.67172693088649, 20.625362591352314, 31.715937325730906, 14.162746967747808, 24.956841129809604, 34.681449458003016, 25.574136137962313, 42.340860068798065, 21.118444565683603], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [6.29677193860212, 6.447474422554166, 6.714453349510819, 9.11775844792524, 8.998403164247662, 9.189191746215016, 6.415196592609078, 6.704119744865835, 6.451793099443108, 7.898282403747231, 8.052804763118417, 7.76908568541208, 4.330024282137543, 4.861611510316521, 4.850069424758345, 5.535629063844681, 5.753338009119034, 5.355310894548893, 9.370148623983056, 9.191096643606812, 9.194591114918381, 10.52358178049326, 9.940004512667656, 9.863349959254265, 5.904793073733643, 5.6623078559835704, 5.969762807091072, 1.6245955750346184, 1.7584720775485039, 1.2689270228147507, 10.16810108597079, 10.31488203133145, 9.539112548033387, 7.599593472977475, 7.24413614471753, 7.514450957377747, 6.847071190675095, 6.576499556501702, 7.005241205294922, 19.876428032914788, 19.447225789229066, 20.081460979456693, 11.408244238545493, 11.544557788719729, 10.87425898512204, 4.427344250182301, 4.606017070511967, 4.335738877455384, 9.134834907871351, 9.143289380862058, 8.118408391873032, 10.134423573190958, 10.210463032572676, 10.120808000365884, 14.08893778113027, 13.637935650845364, 13.293985073765114, 9.279625308389456, 9.177595409254224, 9.099885164449603, 9.055750501652554, 9.38317984466751, 8.861939032872513, 9.90246410916248, 10.272537334511668, 9.52267452577749, 3.3093104641884565, 3.0938141644001007, 3.091159224510193, 5.486348525931433, 5.372526881595448, 5.740332003527627, 6.41603075619787, 6.100531846284866, 6.215732183307409, 5.339719070742518, 4.865135620037705, 5.268220747510583, 5.4100506529212, 5.336410231888294, 5.548397243022919, 5.368753040830285, 5.672432051661104, 4.934782649079949, 4.852898920575768, 5.477381440500409, 5.062162707249314, 12.447111596663788, 12.529073422153786, 13.058877325927213, 7.883889844020203, 8.875071985026196, 8.23640415569146, 2.3365226052701473, 2.0179975256323814, 2.2424110248684883, 7.347450967878103, 6.8853065967559814, 6.125968903303146, 7.83107727766037, 7.757884785532951, 8.250492727966048, 4.89538825427492, 4.65906449904044, 4.339597051342324, 9.174189984798431, 9.786352747352794, 9.618083767592907, 3.3336509143312725, 3.508430508275822, 3.119528045256928, 12.061949933568627, 11.778218934933335, 12.338928679392353, 9.11694276208678, 9.136894951264054, 8.961540470520646, 6.362564079463482, 6.178208366036415, 6.451215464621782, 5.055842839181423, 5.137178294360638, 5.1541376411914825, 5.185796660681561, 4.733654861648873, 5.092100729544953, 5.765290504942328, 5.931296313802392, 5.660670327643544, 4.833519646277026, 4.501062986751393, 4.535123949249581, 11.076431990911559, 10.556725551684693, 10.784224187334374, 9.610888416568429, 10.168111919114978, 9.813132191697747, 7.684611588716507, 7.1579908430576324, 7.859624516218901, 9.66196410109599, 9.591906403501824, 9.53214470048745, 9.736669450998306, 10.129708867520094, 9.551165789365768, 11.687721277276665, 11.05887923638025, 11.57149542371431, 7.066605920592934, 6.830952773491532, 7.340491871039063, 8.028867211813719, 7.451697433988244, 7.313493634263665, -104.00132338205974, -100.18506860981385, -100.24096923569839, 12.449069033066422, 13.065801354280353, 12.945486726860196, 7.211357409755379, 7.123520428935677, 7.854228544669837, 6.635083983341843, 7.088812369542808, 6.739365848402173, 7.839457243680954, 8.144992338493466, 7.992163244634867, 8.170838383336857, 8.449174491067723, 8.243032851566866, 5.502187917629868, 4.969292963544518, 5.893959226707608, 8.662593806783349, 8.91113634655872, 8.301842282215745, 3.739038581649453, 4.381887485894055, 3.9388425151506965, 8.320377312600613, 8.453200750052929, 8.213434919714928, 10.129538784424454, 11.263592746729643, 11.1752871988962, 11.328098972638443, 11.725170736511544, 11.805549611647919, 6.689203764001519, 7.19776042799154, 7.131254776070506, 7.3860691798229965, 6.7818586279948505, 7.341760353495673, 7.152194827795029, 6.248762384057045, 6.847543492913246, 2.7985828022162025, 2.809088716904313, 2.8149459163347785, 11.527058998122811, 10.653945863246918, 10.246261715888977, 12.294543435176209, 12.306823929150895, 12.706400801738098, 11.439713642622024, 10.920687506596238, 10.976671020189912, 7.281343517204121, 7.397573245068386, 6.612588008244828, 7.73057075838247, 8.074645871917397, 8.367379554935411, 10.592800983538226, 9.967393120129898, 10.056448717912033, 6.832501827428729, 6.22907496492067, 6.278024236361176, 10.216922526558236, 10.011780699094132, 10.275905941923455, 9.184231063351035, 9.055873103439808, 8.701961733400822, 2.6028797974189075, 2.3837757309277805, 2.8477319714923652, 8.483758219828204, 8.36868955319126, 8.157940698166684, 11.03322062889734, 10.463212842742593, 11.545152778426797, 9.772706573208168, 9.765457158287361, 10.077155475815132, 7.748305636147649, 7.434564443926007, 7.886604188630969, 5.147282784183815, 4.984045480688408, 5.5290296490614566, 9.520938102155924, 9.082734011113644, 9.234333358705044, 2.7001745949188773, 2.9935576251397435, 2.336830044786126, 10.789625692957387, 10.118572329481438, 10.632931133111313, 3.178267637888581, 3.2920237729946678, 3.0522291461626594, 9.022295214235783, 8.900135084986687, 9.100513271987438, 8.013459533608199, 7.960522983844072, 7.73315382997194, 13.545561840136841, 13.84408153345187, 12.955599536498383, 6.486980355034262, 6.630518369997532, 6.253092045585305, 10.783854340513543, 11.045605809738234, 10.842266780634716, 7.137572245206684, 7.070380583405495, 6.417409762740135, 10.327522551019982, 10.721620145564273, 10.66679462914665, 4.505442142486572, 4.866282580420375, 4.79102224484086, 8.475790717949465, 8.246429045995072, 8.234621365865067, 11.549599381784589, 11.530506337682397, 11.60134373853603, 8.588324929277093, 8.327230582634598, 8.658580626050622, 14.327651634812355, 13.91969509422779, 14.09351333975792, 7.033439591526985, 7.170807454735041, 6.9141975194215775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14480366329344863, "mean_inference_ms": 0.6418755570687763, "mean_action_processing_ms": 0.09461096624105485, "mean_env_wait_ms": 0.8015270658884532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 417600, "timesteps_this_iter": 0, "agent_timesteps_total": 1252800, "timers": {"sample_time_ms": 9563.63, "sample_throughput": 501.901, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1184.357, "learn_throughput": 4052.831, "update_time_ms": 1.101}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 1.8027292788028717, "policy_loss": -0.00197328532632024, "vf_loss": 1.92779940366745, "vf_explained_var": -0.19197800755500793, "kl": 0.005546720291119149, "entropy": 12.33189058303833, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 417600, "num_agent_steps_sampled": 1252800, "num_steps_trained": 417600, "num_agent_steps_trained": 1252800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2320, "training_iteration": 87, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-56-13", "timestamp": 1706147773, "time_this_iter_s": 9.203508615493774, "time_total_s": 814.5763170719147, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100164AAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 814.5763170719147, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 7.707692307692308, "ram_util_percent": 46.46923076923076}}
{"episode_reward_max": 53.09558502584693, "episode_reward_min": -304.42736122757196, "episode_reward_mean": 21.618251869284414, "episode_len_mean": 297.27, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.00132338205974}, "policy_reward_max": {"shared_policy": 17.825075491021067}, "policy_reward_mean": {"shared_policy": 7.206083956428139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.39653268060644, 30.465694606129517, 41.02085850574075, 27.557105882093282, 27.300869379192577, 29.697675969451637, 9.49428385309875, 16.599207411054508, 18.732294785790145, 15.473075438290806, 16.294858127832413, 15.975967741571338, 15.392443068325491, 38.03506234474479, 24.99536598473786, 6.596931155771017, 20.35872646793723, 23.83945479115937, 13.894049804657683, 28.578626499744132, 9.961609467864022, 36.179097547894315, 27.21537818387148, 18.99198791012168, 15.347158774733543, 15.011552251875386, 17.357257146388264, 13.869706582277999, 32.417381729930625, 29.592132527381153, 22.70222694799304, 28.786015205085263, 29.41754410788417, 34.318095937371226, 21.23805056512353, 22.794058280065627, -304.42736122757196, 38.46035711420697, 22.189106383360894, 20.463262201286824, 23.976612826809287, 24.863045725971446, 16.365440107881994, 25.875572435557814, 12.059768582694204, 24.98701298236847, 32.5684187300503, 34.858819320797906, 21.018218968063564, 21.50968816131352, 20.24850070476532, 8.422617435455294, 32.427266577258706, 37.3077681660652, 33.337072169408174, 21.291504770517335, 24.172596185235278, 30.616642821580157, 19.339601028710575, 30.504609167575822, 26.942065900191665, 7.834387499839053, 25.010388471186147, 33.04158625006673, 29.615319207310662, 23.069474268704624, 15.66035791393368, 27.83800547197461, 8.030562264844747, 31.541129155550138, 9.522520557045908, 27.022943571209908, 23.70713634742421, 40.345242910087094, 19.3705907706171, 32.67172693088649, 20.625362591352314, 31.715937325730906, 14.162746967747808, 24.956841129809604, 34.681449458003016, 25.574136137962313, 42.340860068798065, 21.118444565683603, 22.32365954667327, 21.922218437073752, 21.137448020279408, 22.031371850520372, 53.09558502584693, 6.102537833154173, 19.750376574695082, 40.08017893135546, 40.02999112010002, 25.01399178802967, 38.672092340886564, 31.51231498271227, 29.176122819539145, 22.70192544162272, 29.172562398016424, 48.369115078821764], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [9.134834907871351, 9.143289380862058, 8.118408391873032, 10.134423573190958, 10.210463032572676, 10.120808000365884, 14.08893778113027, 13.637935650845364, 13.293985073765114, 9.279625308389456, 9.177595409254224, 9.099885164449603, 9.055750501652554, 9.38317984466751, 8.861939032872513, 9.90246410916248, 10.272537334511668, 9.52267452577749, 3.3093104641884565, 3.0938141644001007, 3.091159224510193, 5.486348525931433, 5.372526881595448, 5.740332003527627, 6.41603075619787, 6.100531846284866, 6.215732183307409, 5.339719070742518, 4.865135620037705, 5.268220747510583, 5.4100506529212, 5.336410231888294, 5.548397243022919, 5.368753040830285, 5.672432051661104, 4.934782649079949, 4.852898920575768, 5.477381440500409, 5.062162707249314, 12.447111596663788, 12.529073422153786, 13.058877325927213, 7.883889844020203, 8.875071985026196, 8.23640415569146, 2.3365226052701473, 2.0179975256323814, 2.2424110248684883, 7.347450967878103, 6.8853065967559814, 6.125968903303146, 7.83107727766037, 7.757884785532951, 8.250492727966048, 4.89538825427492, 4.65906449904044, 4.339597051342324, 9.174189984798431, 9.786352747352794, 9.618083767592907, 3.3336509143312725, 3.508430508275822, 3.119528045256928, 12.061949933568627, 11.778218934933335, 12.338928679392353, 9.11694276208678, 9.136894951264054, 8.961540470520646, 6.362564079463482, 6.178208366036415, 6.451215464621782, 5.055842839181423, 5.137178294360638, 5.1541376411914825, 5.185796660681561, 4.733654861648873, 5.092100729544953, 5.765290504942328, 5.931296313802392, 5.660670327643544, 4.833519646277026, 4.501062986751393, 4.535123949249581, 11.076431990911559, 10.556725551684693, 10.784224187334374, 9.610888416568429, 10.168111919114978, 9.813132191697747, 7.684611588716507, 7.1579908430576324, 7.859624516218901, 9.66196410109599, 9.591906403501824, 9.53214470048745, 9.736669450998306, 10.129708867520094, 9.551165789365768, 11.687721277276665, 11.05887923638025, 11.57149542371431, 7.066605920592934, 6.830952773491532, 7.340491871039063, 8.028867211813719, 7.451697433988244, 7.313493634263665, -104.00132338205974, -100.18506860981385, -100.24096923569839, 12.449069033066422, 13.065801354280353, 12.945486726860196, 7.211357409755379, 7.123520428935677, 7.854228544669837, 6.635083983341843, 7.088812369542808, 6.739365848402173, 7.839457243680954, 8.144992338493466, 7.992163244634867, 8.170838383336857, 8.449174491067723, 8.243032851566866, 5.502187917629868, 4.969292963544518, 5.893959226707608, 8.662593806783349, 8.91113634655872, 8.301842282215745, 3.739038581649453, 4.381887485894055, 3.9388425151506965, 8.320377312600613, 8.453200750052929, 8.213434919714928, 10.129538784424454, 11.263592746729643, 11.1752871988962, 11.328098972638443, 11.725170736511544, 11.805549611647919, 6.689203764001519, 7.19776042799154, 7.131254776070506, 7.3860691798229965, 6.7818586279948505, 7.341760353495673, 7.152194827795029, 6.248762384057045, 6.847543492913246, 2.7985828022162025, 2.809088716904313, 2.8149459163347785, 11.527058998122811, 10.653945863246918, 10.246261715888977, 12.294543435176209, 12.306823929150895, 12.706400801738098, 11.439713642622024, 10.920687506596238, 10.976671020189912, 7.281343517204121, 7.397573245068386, 6.612588008244828, 7.73057075838247, 8.074645871917397, 8.367379554935411, 10.592800983538226, 9.967393120129898, 10.056448717912033, 6.832501827428729, 6.22907496492067, 6.278024236361176, 10.216922526558236, 10.011780699094132, 10.275905941923455, 9.184231063351035, 9.055873103439808, 8.701961733400822, 2.6028797974189075, 2.3837757309277805, 2.8477319714923652, 8.483758219828204, 8.36868955319126, 8.157940698166684, 11.03322062889734, 10.463212842742593, 11.545152778426797, 9.772706573208168, 9.765457158287361, 10.077155475815132, 7.748305636147649, 7.434564443926007, 7.886604188630969, 5.147282784183815, 4.984045480688408, 5.5290296490614566, 9.520938102155924, 9.082734011113644, 9.234333358705044, 2.7001745949188773, 2.9935576251397435, 2.336830044786126, 10.789625692957387, 10.118572329481438, 10.632931133111313, 3.178267637888581, 3.2920237729946678, 3.0522291461626594, 9.022295214235783, 8.900135084986687, 9.100513271987438, 8.013459533608199, 7.960522983844072, 7.73315382997194, 13.545561840136841, 13.84408153345187, 12.955599536498383, 6.486980355034262, 6.630518369997532, 6.253092045585305, 10.783854340513543, 11.045605809738234, 10.842266780634716, 7.137572245206684, 7.070380583405495, 6.417409762740135, 10.327522551019982, 10.721620145564273, 10.66679462914665, 4.505442142486572, 4.866282580420375, 4.79102224484086, 8.475790717949465, 8.246429045995072, 8.234621365865067, 11.549599381784589, 11.530506337682397, 11.60134373853603, 8.588324929277093, 8.327230582634598, 8.658580626050622, 14.327651634812355, 13.91969509422779, 14.09351333975792, 7.033439591526985, 7.170807454735041, 6.9141975194215775, 7.425525306413562, 7.577240436027438, 7.32089380423227, 7.80440595257096, 6.942875891923904, 7.174936592578888, 6.891948603093624, 6.873297341167927, 7.372202076017857, 7.61048373952508, 7.142315685749054, 7.278572425246239, 17.446152875820786, 17.824356659005076, 17.825075491021067, 1.7082391629616325, 2.0878412152329986, 2.306457454959542, 6.432026738921792, 6.482098589340836, 6.836251246432454, 13.636851308246449, 12.851567675669983, 13.59175994743903, 13.542070984840393, 13.443300649523735, 13.044619485735893, 8.163594022393227, 8.802091047167778, 8.048306718468666, 12.751659567157418, 13.007547783354909, 12.912884990374238, 10.401850283145905, 10.467575170099735, 10.642889529466629, 9.976727692720786, 9.998521374383316, 9.200873752435044, 7.468865325053528, 7.579137605925396, 7.653922510643795, 9.679131085673959, 10.021780642370373, 9.471650669972092, 15.63628715773423, 16.31326801454027, 16.419559906547263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14482179932005554, "mean_inference_ms": 0.6420492958002587, "mean_action_processing_ms": 0.09462457311797977, "mean_env_wait_ms": 0.8019063244322152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 422400, "timesteps_this_iter": 0, "agent_timesteps_total": 1267200, "timers": {"sample_time_ms": 9515.736, "sample_throughput": 504.428, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1182.326, "learn_throughput": 4059.794, "update_time_ms": 1.202}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.645118147134781, "policy_loss": -0.002038535142524389, "vf_loss": 2.7719612419605255, "vf_explained_var": -0.17852994799613953, "kl": 0.005598870164352499, "entropy": 12.502880930900574, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 422400, "num_agent_steps_sampled": 1267200, "num_steps_trained": 422400, "num_agent_steps_trained": 1267200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2336, "training_iteration": 88, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-56-23", "timestamp": 1706147783, "time_this_iter_s": 9.793282508850098, "time_total_s": 824.3695995807648, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C22700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 824.3695995807648, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 7.1, "ram_util_percent": 46.464285714285715}}
{"episode_reward_max": 56.074169881641865, "episode_reward_min": -304.42736122757196, "episode_reward_mean": 22.998133900657404, "episode_len_mean": 297.27, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.00132338205974}, "policy_reward_max": {"shared_policy": 18.732524137943983}, "policy_reward_mean": {"shared_policy": 7.666044633552465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.35872646793723, 23.83945479115937, 13.894049804657683, 28.578626499744132, 9.961609467864022, 36.179097547894315, 27.21537818387148, 18.99198791012168, 15.347158774733543, 15.011552251875386, 17.357257146388264, 13.869706582277999, 32.417381729930625, 29.592132527381153, 22.70222694799304, 28.786015205085263, 29.41754410788417, 34.318095937371226, 21.23805056512353, 22.794058280065627, -304.42736122757196, 38.46035711420697, 22.189106383360894, 20.463262201286824, 23.976612826809287, 24.863045725971446, 16.365440107881994, 25.875572435557814, 12.059768582694204, 24.98701298236847, 32.5684187300503, 34.858819320797906, 21.018218968063564, 21.50968816131352, 20.24850070476532, 8.422617435455294, 32.427266577258706, 37.3077681660652, 33.337072169408174, 21.291504770517335, 24.172596185235278, 30.616642821580157, 19.339601028710575, 30.504609167575822, 26.942065900191665, 7.834387499839053, 25.010388471186147, 33.04158625006673, 29.615319207310662, 23.069474268704624, 15.66035791393368, 27.83800547197461, 8.030562264844747, 31.541129155550138, 9.522520557045908, 27.022943571209908, 23.70713634742421, 40.345242910087094, 19.3705907706171, 32.67172693088649, 20.625362591352314, 31.715937325730906, 14.162746967747808, 24.956841129809604, 34.681449458003016, 25.574136137962313, 42.340860068798065, 21.118444565683603, 22.32365954667327, 21.922218437073752, 21.137448020279408, 22.031371850520372, 53.09558502584693, 6.102537833154173, 19.750376574695082, 40.08017893135546, 40.02999112010002, 25.01399178802967, 38.672092340886564, 31.51231498271227, 29.176122819539145, 22.70192544162272, 29.172562398016424, 48.369115078821764, 30.449961351230712, 36.65723256394266, 14.622798938304157, 27.90326791815457, 30.909689910709858, 56.074169881641865, 50.24269745498894, 38.860791452228995, 14.19167202385141, 27.632857337594004, 10.336730193346739, 23.698795719072194, 33.92323571909219, 32.64682365208864, 36.257872968621086, 33.60783298686147], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [7.347450967878103, 6.8853065967559814, 6.125968903303146, 7.83107727766037, 7.757884785532951, 8.250492727966048, 4.89538825427492, 4.65906449904044, 4.339597051342324, 9.174189984798431, 9.786352747352794, 9.618083767592907, 3.3336509143312725, 3.508430508275822, 3.119528045256928, 12.061949933568627, 11.778218934933335, 12.338928679392353, 9.11694276208678, 9.136894951264054, 8.961540470520646, 6.362564079463482, 6.178208366036415, 6.451215464621782, 5.055842839181423, 5.137178294360638, 5.1541376411914825, 5.185796660681561, 4.733654861648873, 5.092100729544953, 5.765290504942328, 5.931296313802392, 5.660670327643544, 4.833519646277026, 4.501062986751393, 4.535123949249581, 11.076431990911559, 10.556725551684693, 10.784224187334374, 9.610888416568429, 10.168111919114978, 9.813132191697747, 7.684611588716507, 7.1579908430576324, 7.859624516218901, 9.66196410109599, 9.591906403501824, 9.53214470048745, 9.736669450998306, 10.129708867520094, 9.551165789365768, 11.687721277276665, 11.05887923638025, 11.57149542371431, 7.066605920592934, 6.830952773491532, 7.340491871039063, 8.028867211813719, 7.451697433988244, 7.313493634263665, -104.00132338205974, -100.18506860981385, -100.24096923569839, 12.449069033066422, 13.065801354280353, 12.945486726860196, 7.211357409755379, 7.123520428935677, 7.854228544669837, 6.635083983341843, 7.088812369542808, 6.739365848402173, 7.839457243680954, 8.144992338493466, 7.992163244634867, 8.170838383336857, 8.449174491067723, 8.243032851566866, 5.502187917629868, 4.969292963544518, 5.893959226707608, 8.662593806783349, 8.91113634655872, 8.301842282215745, 3.739038581649453, 4.381887485894055, 3.9388425151506965, 8.320377312600613, 8.453200750052929, 8.213434919714928, 10.129538784424454, 11.263592746729643, 11.1752871988962, 11.328098972638443, 11.725170736511544, 11.805549611647919, 6.689203764001519, 7.19776042799154, 7.131254776070506, 7.3860691798229965, 6.7818586279948505, 7.341760353495673, 7.152194827795029, 6.248762384057045, 6.847543492913246, 2.7985828022162025, 2.809088716904313, 2.8149459163347785, 11.527058998122811, 10.653945863246918, 10.246261715888977, 12.294543435176209, 12.306823929150895, 12.706400801738098, 11.439713642622024, 10.920687506596238, 10.976671020189912, 7.281343517204121, 7.397573245068386, 6.612588008244828, 7.73057075838247, 8.074645871917397, 8.367379554935411, 10.592800983538226, 9.967393120129898, 10.056448717912033, 6.832501827428729, 6.22907496492067, 6.278024236361176, 10.216922526558236, 10.011780699094132, 10.275905941923455, 9.184231063351035, 9.055873103439808, 8.701961733400822, 2.6028797974189075, 2.3837757309277805, 2.8477319714923652, 8.483758219828204, 8.36868955319126, 8.157940698166684, 11.03322062889734, 10.463212842742593, 11.545152778426797, 9.772706573208168, 9.765457158287361, 10.077155475815132, 7.748305636147649, 7.434564443926007, 7.886604188630969, 5.147282784183815, 4.984045480688408, 5.5290296490614566, 9.520938102155924, 9.082734011113644, 9.234333358705044, 2.7001745949188773, 2.9935576251397435, 2.336830044786126, 10.789625692957387, 10.118572329481438, 10.632931133111313, 3.178267637888581, 3.2920237729946678, 3.0522291461626594, 9.022295214235783, 8.900135084986687, 9.100513271987438, 8.013459533608199, 7.960522983844072, 7.73315382997194, 13.545561840136841, 13.84408153345187, 12.955599536498383, 6.486980355034262, 6.630518369997532, 6.253092045585305, 10.783854340513543, 11.045605809738234, 10.842266780634716, 7.137572245206684, 7.070380583405495, 6.417409762740135, 10.327522551019982, 10.721620145564273, 10.66679462914665, 4.505442142486572, 4.866282580420375, 4.79102224484086, 8.475790717949465, 8.246429045995072, 8.234621365865067, 11.549599381784589, 11.530506337682397, 11.60134373853603, 8.588324929277093, 8.327230582634598, 8.658580626050622, 14.327651634812355, 13.91969509422779, 14.09351333975792, 7.033439591526985, 7.170807454735041, 6.9141975194215775, 7.425525306413562, 7.577240436027438, 7.32089380423227, 7.80440595257096, 6.942875891923904, 7.174936592578888, 6.891948603093624, 6.873297341167927, 7.372202076017857, 7.61048373952508, 7.142315685749054, 7.278572425246239, 17.446152875820786, 17.824356659005076, 17.825075491021067, 1.7082391629616325, 2.0878412152329986, 2.306457454959542, 6.432026738921792, 6.482098589340836, 6.836251246432454, 13.636851308246449, 12.851567675669983, 13.59175994743903, 13.542070984840393, 13.443300649523735, 13.044619485735893, 8.163594022393227, 8.802091047167778, 8.048306718468666, 12.751659567157418, 13.007547783354909, 12.912884990374238, 10.401850283145905, 10.467575170099735, 10.642889529466629, 9.976727692720786, 9.998521374383316, 9.200873752435044, 7.468865325053528, 7.579137605925396, 7.653922510643795, 9.679131085673959, 10.021780642370373, 9.471650669972092, 15.63628715773423, 16.31326801454027, 16.419559906547263, 10.133603392789752, 10.275370330239326, 10.040987628201634, 12.383805369337395, 12.4053680760165, 11.86805911858876, 5.144343576083571, 5.125845851997525, 4.352609510223061, 8.808471659819276, 9.171299288670212, 9.92349696966508, 10.276785351336002, 10.339570760726929, 10.293333798646927, 18.732524137943983, 18.674950428307056, 18.666695315390825, 15.96540494759877, 17.138693322738007, 17.138599184652165, 12.791052142779023, 12.99528511116901, 13.07445419828096, 4.705166627963379, 4.892713585713253, 4.593791810174778, 9.432601730028779, 9.1559142867724, 9.044341320792824, 3.446543723344803, 3.775993775576353, 3.114192694425583, 7.831333960096032, 7.771208855013043, 8.09625290396312, 11.278877392411232, 11.019053481519222, 11.625304845161736, 10.982110008597374, 10.529162988066673, 11.135550655424595, 12.03941098600626, 12.50190778792603, 11.716554194688797, 10.99227873980999, 11.191531963646412, 11.424022283405066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14484327459760607, "mean_inference_ms": 0.6423340945099787, "mean_action_processing_ms": 0.09463551637946256, "mean_env_wait_ms": 0.8023362075353063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 427200, "timesteps_this_iter": 0, "agent_timesteps_total": 1281600, "timers": {"sample_time_ms": 9521.56, "sample_throughput": 504.119, "load_time_ms": 0.099, "load_throughput": 48454053.43, "learn_time_ms": 1179.42, "learn_throughput": 4069.795, "update_time_ms": 1.303}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.44857594370842, "policy_loss": -0.002517210380303503, "vf_loss": 2.5766198933124542, "vf_explained_var": -0.1761934757232666, "kl": 0.006752230634554752, "entropy": 12.579719424247742, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 427200, "num_agent_steps_sampled": 1281600, "num_steps_trained": 427200, "num_agent_steps_trained": 1281600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2352, "training_iteration": 89, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-56-33", "timestamp": 1706147793, "time_this_iter_s": 9.72053575515747, "time_total_s": 834.0901353359222, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100164AEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 834.0901353359222, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 4.992857142857143, "ram_util_percent": 47.02142857142859}}
{"episode_reward_max": 56.074169881641865, "episode_reward_min": -304.42736122757196, "episode_reward_mean": 24.20170278277422, "episode_len_mean": 297.27, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.00132338205974}, "policy_reward_max": {"shared_policy": 18.732524137943983}, "policy_reward_mean": {"shared_policy": 8.067234260924737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.41754410788417, 34.318095937371226, 21.23805056512353, 22.794058280065627, -304.42736122757196, 38.46035711420697, 22.189106383360894, 20.463262201286824, 23.976612826809287, 24.863045725971446, 16.365440107881994, 25.875572435557814, 12.059768582694204, 24.98701298236847, 32.5684187300503, 34.858819320797906, 21.018218968063564, 21.50968816131352, 20.24850070476532, 8.422617435455294, 32.427266577258706, 37.3077681660652, 33.337072169408174, 21.291504770517335, 24.172596185235278, 30.616642821580157, 19.339601028710575, 30.504609167575822, 26.942065900191665, 7.834387499839053, 25.010388471186147, 33.04158625006673, 29.615319207310662, 23.069474268704624, 15.66035791393368, 27.83800547197461, 8.030562264844747, 31.541129155550138, 9.522520557045908, 27.022943571209908, 23.70713634742421, 40.345242910087094, 19.3705907706171, 32.67172693088649, 20.625362591352314, 31.715937325730906, 14.162746967747808, 24.956841129809604, 34.681449458003016, 25.574136137962313, 42.340860068798065, 21.118444565683603, 22.32365954667327, 21.922218437073752, 21.137448020279408, 22.031371850520372, 53.09558502584693, 6.102537833154173, 19.750376574695082, 40.08017893135546, 40.02999112010002, 25.01399178802967, 38.672092340886564, 31.51231498271227, 29.176122819539145, 22.70192544162272, 29.172562398016424, 48.369115078821764, 30.449961351230712, 36.65723256394266, 14.622798938304157, 27.90326791815457, 30.909689910709858, 56.074169881641865, 50.24269745498894, 38.860791452228995, 14.19167202385141, 27.632857337594004, 10.336730193346739, 23.698795719072194, 33.92323571909219, 32.64682365208864, 36.257872968621086, 33.60783298686147, 32.71330496855079, 15.431797489523888, 28.989641271531568, 19.844626600388438, 37.60181951336561, 31.988874346017823, 26.560474521946162, 41.0764269158244, 15.941747073084102, 34.50571016315368, 21.795859873294816, 32.61052168160677, 31.683711722493143, 36.259511046111584, 34.34606924280523, 33.109153620898695], "episode_lengths": [300, 300, 300, 300, 27, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [9.736669450998306, 10.129708867520094, 9.551165789365768, 11.687721277276665, 11.05887923638025, 11.57149542371431, 7.066605920592934, 6.830952773491532, 7.340491871039063, 8.028867211813719, 7.451697433988244, 7.313493634263665, -104.00132338205974, -100.18506860981385, -100.24096923569839, 12.449069033066422, 13.065801354280353, 12.945486726860196, 7.211357409755379, 7.123520428935677, 7.854228544669837, 6.635083983341843, 7.088812369542808, 6.739365848402173, 7.839457243680954, 8.144992338493466, 7.992163244634867, 8.170838383336857, 8.449174491067723, 8.243032851566866, 5.502187917629868, 4.969292963544518, 5.893959226707608, 8.662593806783349, 8.91113634655872, 8.301842282215745, 3.739038581649453, 4.381887485894055, 3.9388425151506965, 8.320377312600613, 8.453200750052929, 8.213434919714928, 10.129538784424454, 11.263592746729643, 11.1752871988962, 11.328098972638443, 11.725170736511544, 11.805549611647919, 6.689203764001519, 7.19776042799154, 7.131254776070506, 7.3860691798229965, 6.7818586279948505, 7.341760353495673, 7.152194827795029, 6.248762384057045, 6.847543492913246, 2.7985828022162025, 2.809088716904313, 2.8149459163347785, 11.527058998122811, 10.653945863246918, 10.246261715888977, 12.294543435176209, 12.306823929150895, 12.706400801738098, 11.439713642622024, 10.920687506596238, 10.976671020189912, 7.281343517204121, 7.397573245068386, 6.612588008244828, 7.73057075838247, 8.074645871917397, 8.367379554935411, 10.592800983538226, 9.967393120129898, 10.056448717912033, 6.832501827428729, 6.22907496492067, 6.278024236361176, 10.216922526558236, 10.011780699094132, 10.275905941923455, 9.184231063351035, 9.055873103439808, 8.701961733400822, 2.6028797974189075, 2.3837757309277805, 2.8477319714923652, 8.483758219828204, 8.36868955319126, 8.157940698166684, 11.03322062889734, 10.463212842742593, 11.545152778426797, 9.772706573208168, 9.765457158287361, 10.077155475815132, 7.748305636147649, 7.434564443926007, 7.886604188630969, 5.147282784183815, 4.984045480688408, 5.5290296490614566, 9.520938102155924, 9.082734011113644, 9.234333358705044, 2.7001745949188773, 2.9935576251397435, 2.336830044786126, 10.789625692957387, 10.118572329481438, 10.632931133111313, 3.178267637888581, 3.2920237729946678, 3.0522291461626594, 9.022295214235783, 8.900135084986687, 9.100513271987438, 8.013459533608199, 7.960522983844072, 7.73315382997194, 13.545561840136841, 13.84408153345187, 12.955599536498383, 6.486980355034262, 6.630518369997532, 6.253092045585305, 10.783854340513543, 11.045605809738234, 10.842266780634716, 7.137572245206684, 7.070380583405495, 6.417409762740135, 10.327522551019982, 10.721620145564273, 10.66679462914665, 4.505442142486572, 4.866282580420375, 4.79102224484086, 8.475790717949465, 8.246429045995072, 8.234621365865067, 11.549599381784589, 11.530506337682397, 11.60134373853603, 8.588324929277093, 8.327230582634598, 8.658580626050622, 14.327651634812355, 13.91969509422779, 14.09351333975792, 7.033439591526985, 7.170807454735041, 6.9141975194215775, 7.425525306413562, 7.577240436027438, 7.32089380423227, 7.80440595257096, 6.942875891923904, 7.174936592578888, 6.891948603093624, 6.873297341167927, 7.372202076017857, 7.61048373952508, 7.142315685749054, 7.278572425246239, 17.446152875820786, 17.824356659005076, 17.825075491021067, 1.7082391629616325, 2.0878412152329986, 2.306457454959542, 6.432026738921792, 6.482098589340836, 6.836251246432454, 13.636851308246449, 12.851567675669983, 13.59175994743903, 13.542070984840393, 13.443300649523735, 13.044619485735893, 8.163594022393227, 8.802091047167778, 8.048306718468666, 12.751659567157418, 13.007547783354909, 12.912884990374238, 10.401850283145905, 10.467575170099735, 10.642889529466629, 9.976727692720786, 9.998521374383316, 9.200873752435044, 7.468865325053528, 7.579137605925396, 7.653922510643795, 9.679131085673959, 10.021780642370373, 9.471650669972092, 15.63628715773423, 16.31326801454027, 16.419559906547263, 10.133603392789752, 10.275370330239326, 10.040987628201634, 12.383805369337395, 12.4053680760165, 11.86805911858876, 5.144343576083571, 5.125845851997525, 4.352609510223061, 8.808471659819276, 9.171299288670212, 9.92349696966508, 10.276785351336002, 10.339570760726929, 10.293333798646927, 18.732524137943983, 18.674950428307056, 18.666695315390825, 15.96540494759877, 17.138693322738007, 17.138599184652165, 12.791052142779023, 12.99528511116901, 13.07445419828096, 4.705166627963379, 4.892713585713253, 4.593791810174778, 9.432601730028779, 9.1559142867724, 9.044341320792824, 3.446543723344803, 3.775993775576353, 3.114192694425583, 7.831333960096032, 7.771208855013043, 8.09625290396312, 11.278877392411232, 11.019053481519222, 11.625304845161736, 10.982110008597374, 10.529162988066673, 11.135550655424595, 12.03941098600626, 12.50190778792603, 11.716554194688797, 10.99227873980999, 11.191531963646412, 11.424022283405066, 10.919737485547856, 10.497773741682366, 11.295793741320566, 5.045845963060856, 5.324735462665558, 5.061216063797474, 9.779621330400303, 9.339765985806778, 9.870253955324486, 6.981971247587353, 5.976354256272316, 6.8863010965287685, 12.714506344248846, 12.026559611161545, 12.86075355795522, 11.03628198554118, 10.732343820234135, 10.220248540242508, 8.95175515115261, 9.316034830641001, 8.29268454015255, 13.714619738360241, 13.65590901424487, 13.705898163219288, 5.194888611634568, 5.710163482775286, 5.036694978674248, 11.712891030746192, 11.241430635253579, 11.551388497153908, 7.10547239085038, 7.277915221949414, 7.412472260495022, 10.636127203702927, 11.1200395449996, 10.854354932904243, 9.98851505915323, 10.858810151616723, 10.836386511723191, 12.06235034018755, 12.279866501688957, 11.917294204235077, 11.532278159012392, 11.288745929797486, 11.52504515399535, 11.173759984473378, 10.865650127331406, 11.069743509093911]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14485040145845038, "mean_inference_ms": 0.6425757343783064, "mean_action_processing_ms": 0.09463760100816188, "mean_env_wait_ms": 0.8027140943264491, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 1296000, "timers": {"sample_time_ms": 9556.465, "sample_throughput": 502.278, "load_time_ms": 0.099, "load_throughput": 48454053.43, "learn_time_ms": 1177.313, "learn_throughput": 4077.081, "update_time_ms": 1.303}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.4206485748291016, "policy_loss": -0.00375321797767858, "vf_loss": 2.550012856721878, "vf_explained_var": -0.17581743001937866, "kl": 0.008187313171331652, "entropy": 12.593888401985168, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 1296000, "num_steps_trained": 432000, "num_agent_steps_trained": 1296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2368, "training_iteration": 90, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-56-42", "timestamp": 1706147802, "time_this_iter_s": 9.485973834991455, "time_total_s": 843.5761091709137, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C22AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 843.5761091709137, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 6.3307692307692305, "ram_util_percent": 46.85384615384616}}
{"episode_reward_max": 56.074169881641865, "episode_reward_min": 6.102537833154173, "episode_reward_mean": 28.10033625680137, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 1.7082391629616325}, "policy_reward_max": {"shared_policy": 18.732524137943983}, "policy_reward_mean": {"shared_policy": 9.366778752267122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.018218968063564, 21.50968816131352, 20.24850070476532, 8.422617435455294, 32.427266577258706, 37.3077681660652, 33.337072169408174, 21.291504770517335, 24.172596185235278, 30.616642821580157, 19.339601028710575, 30.504609167575822, 26.942065900191665, 7.834387499839053, 25.010388471186147, 33.04158625006673, 29.615319207310662, 23.069474268704624, 15.66035791393368, 27.83800547197461, 8.030562264844747, 31.541129155550138, 9.522520557045908, 27.022943571209908, 23.70713634742421, 40.345242910087094, 19.3705907706171, 32.67172693088649, 20.625362591352314, 31.715937325730906, 14.162746967747808, 24.956841129809604, 34.681449458003016, 25.574136137962313, 42.340860068798065, 21.118444565683603, 22.32365954667327, 21.922218437073752, 21.137448020279408, 22.031371850520372, 53.09558502584693, 6.102537833154173, 19.750376574695082, 40.08017893135546, 40.02999112010002, 25.01399178802967, 38.672092340886564, 31.51231498271227, 29.176122819539145, 22.70192544162272, 29.172562398016424, 48.369115078821764, 30.449961351230712, 36.65723256394266, 14.622798938304157, 27.90326791815457, 30.909689910709858, 56.074169881641865, 50.24269745498894, 38.860791452228995, 14.19167202385141, 27.632857337594004, 10.336730193346739, 23.698795719072194, 33.92323571909219, 32.64682365208864, 36.257872968621086, 33.60783298686147, 32.71330496855079, 15.431797489523888, 28.989641271531568, 19.844626600388438, 37.60181951336561, 31.988874346017823, 26.560474521946162, 41.0764269158244, 15.941747073084102, 34.50571016315368, 21.795859873294816, 32.61052168160677, 31.683711722493143, 36.259511046111584, 34.34606924280523, 33.109153620898695, 23.89220393076539, 35.00649082846937, 40.56291166692971, 25.35518817603588, 27.180525916628525, 29.754950357601032, 12.461589463986428, 26.458169884979725, 22.59694902598855, 47.61571890860793, 33.0870022076997, 28.512135876342626, 25.257355511188507, 32.698105316609144, 33.99598192446865, 25.435872480273247], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [6.689203764001519, 7.19776042799154, 7.131254776070506, 7.3860691798229965, 6.7818586279948505, 7.341760353495673, 7.152194827795029, 6.248762384057045, 6.847543492913246, 2.7985828022162025, 2.809088716904313, 2.8149459163347785, 11.527058998122811, 10.653945863246918, 10.246261715888977, 12.294543435176209, 12.306823929150895, 12.706400801738098, 11.439713642622024, 10.920687506596238, 10.976671020189912, 7.281343517204121, 7.397573245068386, 6.612588008244828, 7.73057075838247, 8.074645871917397, 8.367379554935411, 10.592800983538226, 9.967393120129898, 10.056448717912033, 6.832501827428729, 6.22907496492067, 6.278024236361176, 10.216922526558236, 10.011780699094132, 10.275905941923455, 9.184231063351035, 9.055873103439808, 8.701961733400822, 2.6028797974189075, 2.3837757309277805, 2.8477319714923652, 8.483758219828204, 8.36868955319126, 8.157940698166684, 11.03322062889734, 10.463212842742593, 11.545152778426797, 9.772706573208168, 9.765457158287361, 10.077155475815132, 7.748305636147649, 7.434564443926007, 7.886604188630969, 5.147282784183815, 4.984045480688408, 5.5290296490614566, 9.520938102155924, 9.082734011113644, 9.234333358705044, 2.7001745949188773, 2.9935576251397435, 2.336830044786126, 10.789625692957387, 10.118572329481438, 10.632931133111313, 3.178267637888581, 3.2920237729946678, 3.0522291461626594, 9.022295214235783, 8.900135084986687, 9.100513271987438, 8.013459533608199, 7.960522983844072, 7.73315382997194, 13.545561840136841, 13.84408153345187, 12.955599536498383, 6.486980355034262, 6.630518369997532, 6.253092045585305, 10.783854340513543, 11.045605809738234, 10.842266780634716, 7.137572245206684, 7.070380583405495, 6.417409762740135, 10.327522551019982, 10.721620145564273, 10.66679462914665, 4.505442142486572, 4.866282580420375, 4.79102224484086, 8.475790717949465, 8.246429045995072, 8.234621365865067, 11.549599381784589, 11.530506337682397, 11.60134373853603, 8.588324929277093, 8.327230582634598, 8.658580626050622, 14.327651634812355, 13.91969509422779, 14.09351333975792, 7.033439591526985, 7.170807454735041, 6.9141975194215775, 7.425525306413562, 7.577240436027438, 7.32089380423227, 7.80440595257096, 6.942875891923904, 7.174936592578888, 6.891948603093624, 6.873297341167927, 7.372202076017857, 7.61048373952508, 7.142315685749054, 7.278572425246239, 17.446152875820786, 17.824356659005076, 17.825075491021067, 1.7082391629616325, 2.0878412152329986, 2.306457454959542, 6.432026738921792, 6.482098589340836, 6.836251246432454, 13.636851308246449, 12.851567675669983, 13.59175994743903, 13.542070984840393, 13.443300649523735, 13.044619485735893, 8.163594022393227, 8.802091047167778, 8.048306718468666, 12.751659567157418, 13.007547783354909, 12.912884990374238, 10.401850283145905, 10.467575170099735, 10.642889529466629, 9.976727692720786, 9.998521374383316, 9.200873752435044, 7.468865325053528, 7.579137605925396, 7.653922510643795, 9.679131085673959, 10.021780642370373, 9.471650669972092, 15.63628715773423, 16.31326801454027, 16.419559906547263, 10.133603392789752, 10.275370330239326, 10.040987628201634, 12.383805369337395, 12.4053680760165, 11.86805911858876, 5.144343576083571, 5.125845851997525, 4.352609510223061, 8.808471659819276, 9.171299288670212, 9.92349696966508, 10.276785351336002, 10.339570760726929, 10.293333798646927, 18.732524137943983, 18.674950428307056, 18.666695315390825, 15.96540494759877, 17.138693322738007, 17.138599184652165, 12.791052142779023, 12.99528511116901, 13.07445419828096, 4.705166627963379, 4.892713585713253, 4.593791810174778, 9.432601730028779, 9.1559142867724, 9.044341320792824, 3.446543723344803, 3.775993775576353, 3.114192694425583, 7.831333960096032, 7.771208855013043, 8.09625290396312, 11.278877392411232, 11.019053481519222, 11.625304845161736, 10.982110008597374, 10.529162988066673, 11.135550655424595, 12.03941098600626, 12.50190778792603, 11.716554194688797, 10.99227873980999, 11.191531963646412, 11.424022283405066, 10.919737485547856, 10.497773741682366, 11.295793741320566, 5.045845963060856, 5.324735462665558, 5.061216063797474, 9.779621330400303, 9.339765985806778, 9.870253955324486, 6.981971247587353, 5.976354256272316, 6.8863010965287685, 12.714506344248846, 12.026559611161545, 12.86075355795522, 11.03628198554118, 10.732343820234135, 10.220248540242508, 8.95175515115261, 9.316034830641001, 8.29268454015255, 13.714619738360241, 13.65590901424487, 13.705898163219288, 5.194888611634568, 5.710163482775286, 5.036694978674248, 11.712891030746192, 11.241430635253579, 11.551388497153908, 7.10547239085038, 7.277915221949414, 7.412472260495022, 10.636127203702927, 11.1200395449996, 10.854354932904243, 9.98851505915323, 10.858810151616723, 10.836386511723191, 12.06235034018755, 12.279866501688957, 11.917294204235077, 11.532278159012392, 11.288745929797486, 11.52504515399535, 11.173759984473378, 10.865650127331406, 11.069743509093911, 8.28653759881854, 7.646874725818634, 7.958791606128216, 12.246789750332624, 11.112158368031174, 11.647542710105569, 13.554875676830605, 13.6300487195452, 13.377987270553902, 8.263033404946327, 8.494474273175001, 8.597680497914553, 8.948039089639977, 9.045571548243359, 9.18691527874519, 9.854389702280358, 10.204775373761848, 9.695785281558827, 4.425617701994867, 4.196827671180159, 3.839144090811402, 8.918296419084072, 9.105827197432518, 8.434046268463135, 7.6205282236138885, 7.669082837800175, 7.3073379645744865, 15.927458042899758, 15.821666019658238, 15.866594846049935, 10.96579448133707, 10.686800450086594, 11.434407276276033, 9.447786706189305, 9.333980205158383, 9.730368964994938, 8.411323755979538, 8.253691598773003, 8.592340156435966, 11.260343536734581, 10.26413169503212, 11.173630084842443, 11.493212047964334, 10.887203633785248, 11.61556624271907, 8.351043485105038, 8.49301515519619, 8.59181383997202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1448412171590447, "mean_inference_ms": 0.6427780682996511, "mean_action_processing_ms": 0.09462577918951316, "mean_env_wait_ms": 0.8030690351235436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 436800, "timesteps_this_iter": 0, "agent_timesteps_total": 1310400, "timers": {"sample_time_ms": 9554.198, "sample_throughput": 502.397, "load_time_ms": 0.099, "load_throughput": 48454053.43, "learn_time_ms": 1175.219, "learn_throughput": 4084.344, "update_time_ms": 1.403}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.7097457945346832, "policy_loss": -0.002590179185499447, "vf_loss": 2.8387660086154938, "vf_explained_var": -0.14266081154346466, "kl": 0.006611754594018953, "entropy": 12.66947603225708, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 436800, "num_agent_steps_sampled": 1310400, "num_steps_trained": 436800, "num_agent_steps_trained": 1310400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2384, "training_iteration": 91, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-56-51", "timestamp": 1706147811, "time_this_iter_s": 9.40586233139038, "time_total_s": 852.9819715023041, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F4F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 852.9819715023041, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 10.392857142857142, "ram_util_percent": 46.707142857142856}}
{"episode_reward_max": 56.074169881641865, "episode_reward_min": 6.102537833154173, "episode_reward_mean": 29.36656162721686, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 1.7082391629616325}, "policy_reward_max": {"shared_policy": 18.732524137943983}, "policy_reward_mean": {"shared_policy": 9.788853875738953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.615319207310662, 23.069474268704624, 15.66035791393368, 27.83800547197461, 8.030562264844747, 31.541129155550138, 9.522520557045908, 27.022943571209908, 23.70713634742421, 40.345242910087094, 19.3705907706171, 32.67172693088649, 20.625362591352314, 31.715937325730906, 14.162746967747808, 24.956841129809604, 34.681449458003016, 25.574136137962313, 42.340860068798065, 21.118444565683603, 22.32365954667327, 21.922218437073752, 21.137448020279408, 22.031371850520372, 53.09558502584693, 6.102537833154173, 19.750376574695082, 40.08017893135546, 40.02999112010002, 25.01399178802967, 38.672092340886564, 31.51231498271227, 29.176122819539145, 22.70192544162272, 29.172562398016424, 48.369115078821764, 30.449961351230712, 36.65723256394266, 14.622798938304157, 27.90326791815457, 30.909689910709858, 56.074169881641865, 50.24269745498894, 38.860791452228995, 14.19167202385141, 27.632857337594004, 10.336730193346739, 23.698795719072194, 33.92323571909219, 32.64682365208864, 36.257872968621086, 33.60783298686147, 32.71330496855079, 15.431797489523888, 28.989641271531568, 19.844626600388438, 37.60181951336561, 31.988874346017823, 26.560474521946162, 41.0764269158244, 15.941747073084102, 34.50571016315368, 21.795859873294816, 32.61052168160677, 31.683711722493143, 36.259511046111584, 34.34606924280523, 33.109153620898695, 23.89220393076539, 35.00649082846937, 40.56291166692971, 25.35518817603588, 27.180525916628525, 29.754950357601032, 12.461589463986428, 26.458169884979725, 22.59694902598855, 47.61571890860793, 33.0870022076997, 28.512135876342626, 25.257355511188507, 32.698105316609144, 33.99598192446865, 25.435872480273247, 34.40195643529296, 34.60834744665769, 30.56232332251963, 48.31358760967849, 31.458330273628206, 32.73152504488823, 27.35224698483944, 45.172501131892176, 34.52658889442681, 37.456948310602456, 26.43998308479786, 11.067454210249707, 32.66702057514338, 38.95993611216545, 31.57409842684865, 22.354203455150127], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [9.772706573208168, 9.765457158287361, 10.077155475815132, 7.748305636147649, 7.434564443926007, 7.886604188630969, 5.147282784183815, 4.984045480688408, 5.5290296490614566, 9.520938102155924, 9.082734011113644, 9.234333358705044, 2.7001745949188773, 2.9935576251397435, 2.336830044786126, 10.789625692957387, 10.118572329481438, 10.632931133111313, 3.178267637888581, 3.2920237729946678, 3.0522291461626594, 9.022295214235783, 8.900135084986687, 9.100513271987438, 8.013459533608199, 7.960522983844072, 7.73315382997194, 13.545561840136841, 13.84408153345187, 12.955599536498383, 6.486980355034262, 6.630518369997532, 6.253092045585305, 10.783854340513543, 11.045605809738234, 10.842266780634716, 7.137572245206684, 7.070380583405495, 6.417409762740135, 10.327522551019982, 10.721620145564273, 10.66679462914665, 4.505442142486572, 4.866282580420375, 4.79102224484086, 8.475790717949465, 8.246429045995072, 8.234621365865067, 11.549599381784589, 11.530506337682397, 11.60134373853603, 8.588324929277093, 8.327230582634598, 8.658580626050622, 14.327651634812355, 13.91969509422779, 14.09351333975792, 7.033439591526985, 7.170807454735041, 6.9141975194215775, 7.425525306413562, 7.577240436027438, 7.32089380423227, 7.80440595257096, 6.942875891923904, 7.174936592578888, 6.891948603093624, 6.873297341167927, 7.372202076017857, 7.61048373952508, 7.142315685749054, 7.278572425246239, 17.446152875820786, 17.824356659005076, 17.825075491021067, 1.7082391629616325, 2.0878412152329986, 2.306457454959542, 6.432026738921792, 6.482098589340836, 6.836251246432454, 13.636851308246449, 12.851567675669983, 13.59175994743903, 13.542070984840393, 13.443300649523735, 13.044619485735893, 8.163594022393227, 8.802091047167778, 8.048306718468666, 12.751659567157418, 13.007547783354909, 12.912884990374238, 10.401850283145905, 10.467575170099735, 10.642889529466629, 9.976727692720786, 9.998521374383316, 9.200873752435044, 7.468865325053528, 7.579137605925396, 7.653922510643795, 9.679131085673959, 10.021780642370373, 9.471650669972092, 15.63628715773423, 16.31326801454027, 16.419559906547263, 10.133603392789752, 10.275370330239326, 10.040987628201634, 12.383805369337395, 12.4053680760165, 11.86805911858876, 5.144343576083571, 5.125845851997525, 4.352609510223061, 8.808471659819276, 9.171299288670212, 9.92349696966508, 10.276785351336002, 10.339570760726929, 10.293333798646927, 18.732524137943983, 18.674950428307056, 18.666695315390825, 15.96540494759877, 17.138693322738007, 17.138599184652165, 12.791052142779023, 12.99528511116901, 13.07445419828096, 4.705166627963379, 4.892713585713253, 4.593791810174778, 9.432601730028779, 9.1559142867724, 9.044341320792824, 3.446543723344803, 3.775993775576353, 3.114192694425583, 7.831333960096032, 7.771208855013043, 8.09625290396312, 11.278877392411232, 11.019053481519222, 11.625304845161736, 10.982110008597374, 10.529162988066673, 11.135550655424595, 12.03941098600626, 12.50190778792603, 11.716554194688797, 10.99227873980999, 11.191531963646412, 11.424022283405066, 10.919737485547856, 10.497773741682366, 11.295793741320566, 5.045845963060856, 5.324735462665558, 5.061216063797474, 9.779621330400303, 9.339765985806778, 9.870253955324486, 6.981971247587353, 5.976354256272316, 6.8863010965287685, 12.714506344248846, 12.026559611161545, 12.86075355795522, 11.03628198554118, 10.732343820234135, 10.220248540242508, 8.95175515115261, 9.316034830641001, 8.29268454015255, 13.714619738360241, 13.65590901424487, 13.705898163219288, 5.194888611634568, 5.710163482775286, 5.036694978674248, 11.712891030746192, 11.241430635253579, 11.551388497153908, 7.10547239085038, 7.277915221949414, 7.412472260495022, 10.636127203702927, 11.1200395449996, 10.854354932904243, 9.98851505915323, 10.858810151616723, 10.836386511723191, 12.06235034018755, 12.279866501688957, 11.917294204235077, 11.532278159012392, 11.288745929797486, 11.52504515399535, 11.173759984473378, 10.865650127331406, 11.069743509093911, 8.28653759881854, 7.646874725818634, 7.958791606128216, 12.246789750332624, 11.112158368031174, 11.647542710105569, 13.554875676830605, 13.6300487195452, 13.377987270553902, 8.263033404946327, 8.494474273175001, 8.597680497914553, 8.948039089639977, 9.045571548243359, 9.18691527874519, 9.854389702280358, 10.204775373761848, 9.695785281558827, 4.425617701994867, 4.196827671180159, 3.839144090811402, 8.918296419084072, 9.105827197432518, 8.434046268463135, 7.6205282236138885, 7.669082837800175, 7.3073379645744865, 15.927458042899758, 15.821666019658238, 15.866594846049935, 10.96579448133707, 10.686800450086594, 11.434407276276033, 9.447786706189305, 9.333980205158383, 9.730368964994938, 8.411323755979538, 8.253691598773003, 8.592340156435966, 11.260343536734581, 10.26413169503212, 11.173630084842443, 11.493212047964334, 10.887203633785248, 11.61556624271907, 8.351043485105038, 8.49301515519619, 8.59181383997202, 11.464322324842215, 11.568703822791576, 11.368930287659168, 11.614759091908724, 11.671811582210154, 11.321776772538811, 9.741278837124497, 10.488594990844518, 10.332449494550616, 16.26424627502759, 16.458461323132113, 15.590880011518792, 10.61186187217632, 10.138795341054589, 10.707673060397298, 10.898067927608878, 10.869097406665475, 10.964359710613877, 9.21534601226449, 8.93988174945116, 9.197019223123789, 15.155339861909539, 15.245759959022195, 14.771401310960442, 11.635822695990399, 11.723884125550583, 11.166882072885826, 12.440273385494947, 12.596776120830327, 12.419898804277182, 8.468348801136017, 8.980283502489328, 8.991350781172514, 3.796490965411067, 3.8686643100809306, 3.4022989347577095, 10.629963909586266, 10.805970167120293, 11.231086498436824, 13.277169957756996, 13.33287899196148, 12.349887162446976, 10.497319672256708, 10.448786906898022, 10.62799184769392, 7.340379863977432, 7.582876369357109, 7.430947221815586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14482652388276443, "mean_inference_ms": 0.6429541977625264, "mean_action_processing_ms": 0.09461412801902018, "mean_env_wait_ms": 0.8034060601200332, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 441600, "timesteps_this_iter": 0, "agent_timesteps_total": 1324800, "timers": {"sample_time_ms": 9573.822, "sample_throughput": 501.367, "load_time_ms": 0.099, "load_throughput": 48454053.43, "learn_time_ms": 1179.327, "learn_throughput": 4070.119, "update_time_ms": 1.403}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.439920723438263, "policy_loss": -0.0026813118261796165, "vf_loss": 2.5674859285354614, "vf_explained_var": -0.13641633093357086, "kl": 0.00828954967448641, "entropy": 12.521583080291748, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 441600, "num_agent_steps_sampled": 1324800, "num_steps_trained": 441600, "num_agent_steps_trained": 1324800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2400, "training_iteration": 92, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-57-01", "timestamp": 1706147821, "time_this_iter_s": 9.456145524978638, "time_total_s": 862.4381170272827, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210630AA790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 862.4381170272827, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 10.061538461538463, "ram_util_percent": 46.70769230769231}}
{"episode_reward_max": 56.074169881641865, "episode_reward_min": 6.102537833154173, "episode_reward_mean": 30.25073582813725, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 1.7082391629616325}, "policy_reward_max": {"shared_policy": 18.732524137943983}, "policy_reward_mean": {"shared_policy": 10.083578609379083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.681449458003016, 25.574136137962313, 42.340860068798065, 21.118444565683603, 22.32365954667327, 21.922218437073752, 21.137448020279408, 22.031371850520372, 53.09558502584693, 6.102537833154173, 19.750376574695082, 40.08017893135546, 40.02999112010002, 25.01399178802967, 38.672092340886564, 31.51231498271227, 29.176122819539145, 22.70192544162272, 29.172562398016424, 48.369115078821764, 30.449961351230712, 36.65723256394266, 14.622798938304157, 27.90326791815457, 30.909689910709858, 56.074169881641865, 50.24269745498894, 38.860791452228995, 14.19167202385141, 27.632857337594004, 10.336730193346739, 23.698795719072194, 33.92323571909219, 32.64682365208864, 36.257872968621086, 33.60783298686147, 32.71330496855079, 15.431797489523888, 28.989641271531568, 19.844626600388438, 37.60181951336561, 31.988874346017823, 26.560474521946162, 41.0764269158244, 15.941747073084102, 34.50571016315368, 21.795859873294816, 32.61052168160677, 31.683711722493143, 36.259511046111584, 34.34606924280523, 33.109153620898695, 23.89220393076539, 35.00649082846937, 40.56291166692971, 25.35518817603588, 27.180525916628525, 29.754950357601032, 12.461589463986428, 26.458169884979725, 22.59694902598855, 47.61571890860793, 33.0870022076997, 28.512135876342626, 25.257355511188507, 32.698105316609144, 33.99598192446865, 25.435872480273247, 34.40195643529296, 34.60834744665769, 30.56232332251963, 48.31358760967849, 31.458330273628206, 32.73152504488823, 27.35224698483944, 45.172501131892176, 34.52658889442681, 37.456948310602456, 26.43998308479786, 11.067454210249707, 32.66702057514338, 38.95993611216545, 31.57409842684865, 22.354203455150127, 25.261401668190956, 33.140974782407284, 18.40659486502406, 20.864036235958338, 37.22140333708376, 20.283529613167048, 51.93441530317068, 19.818963635712848, 23.470988359302282, 25.036931682378025, 31.52219451824203, 31.76128808036445, 37.64398919045925, 40.3369105309248, 28.65779898315668, 22.91189669072628], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.549599381784589, 11.530506337682397, 11.60134373853603, 8.588324929277093, 8.327230582634598, 8.658580626050622, 14.327651634812355, 13.91969509422779, 14.09351333975792, 7.033439591526985, 7.170807454735041, 6.9141975194215775, 7.425525306413562, 7.577240436027438, 7.32089380423227, 7.80440595257096, 6.942875891923904, 7.174936592578888, 6.891948603093624, 6.873297341167927, 7.372202076017857, 7.61048373952508, 7.142315685749054, 7.278572425246239, 17.446152875820786, 17.824356659005076, 17.825075491021067, 1.7082391629616325, 2.0878412152329986, 2.306457454959542, 6.432026738921792, 6.482098589340836, 6.836251246432454, 13.636851308246449, 12.851567675669983, 13.59175994743903, 13.542070984840393, 13.443300649523735, 13.044619485735893, 8.163594022393227, 8.802091047167778, 8.048306718468666, 12.751659567157418, 13.007547783354909, 12.912884990374238, 10.401850283145905, 10.467575170099735, 10.642889529466629, 9.976727692720786, 9.998521374383316, 9.200873752435044, 7.468865325053528, 7.579137605925396, 7.653922510643795, 9.679131085673959, 10.021780642370373, 9.471650669972092, 15.63628715773423, 16.31326801454027, 16.419559906547263, 10.133603392789752, 10.275370330239326, 10.040987628201634, 12.383805369337395, 12.4053680760165, 11.86805911858876, 5.144343576083571, 5.125845851997525, 4.352609510223061, 8.808471659819276, 9.171299288670212, 9.92349696966508, 10.276785351336002, 10.339570760726929, 10.293333798646927, 18.732524137943983, 18.674950428307056, 18.666695315390825, 15.96540494759877, 17.138693322738007, 17.138599184652165, 12.791052142779023, 12.99528511116901, 13.07445419828096, 4.705166627963379, 4.892713585713253, 4.593791810174778, 9.432601730028779, 9.1559142867724, 9.044341320792824, 3.446543723344803, 3.775993775576353, 3.114192694425583, 7.831333960096032, 7.771208855013043, 8.09625290396312, 11.278877392411232, 11.019053481519222, 11.625304845161736, 10.982110008597374, 10.529162988066673, 11.135550655424595, 12.03941098600626, 12.50190778792603, 11.716554194688797, 10.99227873980999, 11.191531963646412, 11.424022283405066, 10.919737485547856, 10.497773741682366, 11.295793741320566, 5.045845963060856, 5.324735462665558, 5.061216063797474, 9.779621330400303, 9.339765985806778, 9.870253955324486, 6.981971247587353, 5.976354256272316, 6.8863010965287685, 12.714506344248846, 12.026559611161545, 12.86075355795522, 11.03628198554118, 10.732343820234135, 10.220248540242508, 8.95175515115261, 9.316034830641001, 8.29268454015255, 13.714619738360241, 13.65590901424487, 13.705898163219288, 5.194888611634568, 5.710163482775286, 5.036694978674248, 11.712891030746192, 11.241430635253579, 11.551388497153908, 7.10547239085038, 7.277915221949414, 7.412472260495022, 10.636127203702927, 11.1200395449996, 10.854354932904243, 9.98851505915323, 10.858810151616723, 10.836386511723191, 12.06235034018755, 12.279866501688957, 11.917294204235077, 11.532278159012392, 11.288745929797486, 11.52504515399535, 11.173759984473378, 10.865650127331406, 11.069743509093911, 8.28653759881854, 7.646874725818634, 7.958791606128216, 12.246789750332624, 11.112158368031174, 11.647542710105569, 13.554875676830605, 13.6300487195452, 13.377987270553902, 8.263033404946327, 8.494474273175001, 8.597680497914553, 8.948039089639977, 9.045571548243359, 9.18691527874519, 9.854389702280358, 10.204775373761848, 9.695785281558827, 4.425617701994867, 4.196827671180159, 3.839144090811402, 8.918296419084072, 9.105827197432518, 8.434046268463135, 7.6205282236138885, 7.669082837800175, 7.3073379645744865, 15.927458042899758, 15.821666019658238, 15.866594846049935, 10.96579448133707, 10.686800450086594, 11.434407276276033, 9.447786706189305, 9.333980205158383, 9.730368964994938, 8.411323755979538, 8.253691598773003, 8.592340156435966, 11.260343536734581, 10.26413169503212, 11.173630084842443, 11.493212047964334, 10.887203633785248, 11.61556624271907, 8.351043485105038, 8.49301515519619, 8.59181383997202, 11.464322324842215, 11.568703822791576, 11.368930287659168, 11.614759091908724, 11.671811582210154, 11.321776772538811, 9.741278837124497, 10.488594990844518, 10.332449494550616, 16.26424627502759, 16.458461323132113, 15.590880011518792, 10.61186187217632, 10.138795341054589, 10.707673060397298, 10.898067927608878, 10.869097406665475, 10.964359710613877, 9.21534601226449, 8.93988174945116, 9.197019223123789, 15.155339861909539, 15.245759959022195, 14.771401310960442, 11.635822695990399, 11.723884125550583, 11.166882072885826, 12.440273385494947, 12.596776120830327, 12.419898804277182, 8.468348801136017, 8.980283502489328, 8.991350781172514, 3.796490965411067, 3.8686643100809306, 3.4022989347577095, 10.629963909586266, 10.805970167120293, 11.231086498436824, 13.277169957756996, 13.33287899196148, 12.349887162446976, 10.497319672256708, 10.448786906898022, 10.62799184769392, 7.340379863977432, 7.582876369357109, 7.430947221815586, 8.586756464093924, 8.683637145906687, 7.991008058190346, 11.25538444519043, 11.04882138222456, 10.836768954992294, 6.212401496867329, 6.198371420303971, 5.995821947852761, 6.981024451553822, 6.638478755950928, 7.2445330284535885, 12.52541995793581, 11.865495100617409, 12.830488278530538, 6.7608330100774765, 6.929645899683237, 6.593050703406334, 17.33162497356534, 17.32085221633315, 17.28193811327219, 6.449393426378563, 6.63320431609948, 6.7363658932348045, 7.82990625500679, 7.6415489464998245, 7.999533157795668, 8.313715207080037, 8.430931149671466, 8.292285325626523, 10.514185663312674, 10.734283956233412, 10.273724898695946, 11.214094632615641, 10.406960775454834, 10.140232672293976, 12.337413683533669, 12.657626822590828, 12.648948684334755, 13.546889588236809, 13.390656501054764, 13.399364441633224, 9.510783649981022, 9.589911088347435, 9.557104244828224, 7.821665059775114, 7.786783564835787, 7.303448066115379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14480977739785722, "mean_inference_ms": 0.6431157222784277, "mean_action_processing_ms": 0.09460504459059665, "mean_env_wait_ms": 0.8037384438507925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 446400, "timesteps_this_iter": 0, "agent_timesteps_total": 1339200, "timers": {"sample_time_ms": 9569.647, "sample_throughput": 501.586, "load_time_ms": 0.099, "load_throughput": 48454053.43, "learn_time_ms": 1181.791, "learn_throughput": 4061.632, "update_time_ms": 1.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.6368265450000763, "policy_loss": -0.0012552621419955612, "vf_loss": 2.76357564330101, "vf_explained_var": -0.13328604400157928, "kl": 0.007640428928539323, "entropy": 12.579983353614807, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 446400, "num_agent_steps_sampled": 1339200, "num_steps_trained": 446400, "num_agent_steps_trained": 1339200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2416, "training_iteration": 93, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-57-10", "timestamp": 1706147830, "time_this_iter_s": 9.270138263702393, "time_total_s": 871.7082552909851, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 871.7082552909851, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 8.161538461538461, "ram_util_percent": 46.7}}
{"episode_reward_max": 56.074169881641865, "episode_reward_min": 10.336730193346739, "episode_reward_mean": 30.550587367384278, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 3.114192694425583}, "policy_reward_max": {"shared_policy": 18.732524137943983}, "policy_reward_mean": {"shared_policy": 10.183529122461424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.176122819539145, 22.70192544162272, 29.172562398016424, 48.369115078821764, 30.449961351230712, 36.65723256394266, 14.622798938304157, 27.90326791815457, 30.909689910709858, 56.074169881641865, 50.24269745498894, 38.860791452228995, 14.19167202385141, 27.632857337594004, 10.336730193346739, 23.698795719072194, 33.92323571909219, 32.64682365208864, 36.257872968621086, 33.60783298686147, 32.71330496855079, 15.431797489523888, 28.989641271531568, 19.844626600388438, 37.60181951336561, 31.988874346017823, 26.560474521946162, 41.0764269158244, 15.941747073084102, 34.50571016315368, 21.795859873294816, 32.61052168160677, 31.683711722493143, 36.259511046111584, 34.34606924280523, 33.109153620898695, 23.89220393076539, 35.00649082846937, 40.56291166692971, 25.35518817603588, 27.180525916628525, 29.754950357601032, 12.461589463986428, 26.458169884979725, 22.59694902598855, 47.61571890860793, 33.0870022076997, 28.512135876342626, 25.257355511188507, 32.698105316609144, 33.99598192446865, 25.435872480273247, 34.40195643529296, 34.60834744665769, 30.56232332251963, 48.31358760967849, 31.458330273628206, 32.73152504488823, 27.35224698483944, 45.172501131892176, 34.52658889442681, 37.456948310602456, 26.43998308479786, 11.067454210249707, 32.66702057514338, 38.95993611216545, 31.57409842684865, 22.354203455150127, 25.261401668190956, 33.140974782407284, 18.40659486502406, 20.864036235958338, 37.22140333708376, 20.283529613167048, 51.93441530317068, 19.818963635712848, 23.470988359302282, 25.036931682378025, 31.52219451824203, 31.76128808036445, 37.64398919045925, 40.3369105309248, 28.65779898315668, 22.91189669072628, 23.913521096110344, 17.790551431477056, 22.624209225177765, 27.693292581941932, 42.459609754383536, 31.96909529529509, 13.283311255276175, 26.168040156364427, 40.99241616949436, 24.812067571096094, 43.3353513869224, 54.62364958226678, 27.0246935877949, 37.123641785234184, 35.62330010571165, 25.935059621930094], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [9.976727692720786, 9.998521374383316, 9.200873752435044, 7.468865325053528, 7.579137605925396, 7.653922510643795, 9.679131085673959, 10.021780642370373, 9.471650669972092, 15.63628715773423, 16.31326801454027, 16.419559906547263, 10.133603392789752, 10.275370330239326, 10.040987628201634, 12.383805369337395, 12.4053680760165, 11.86805911858876, 5.144343576083571, 5.125845851997525, 4.352609510223061, 8.808471659819276, 9.171299288670212, 9.92349696966508, 10.276785351336002, 10.339570760726929, 10.293333798646927, 18.732524137943983, 18.674950428307056, 18.666695315390825, 15.96540494759877, 17.138693322738007, 17.138599184652165, 12.791052142779023, 12.99528511116901, 13.07445419828096, 4.705166627963379, 4.892713585713253, 4.593791810174778, 9.432601730028779, 9.1559142867724, 9.044341320792824, 3.446543723344803, 3.775993775576353, 3.114192694425583, 7.831333960096032, 7.771208855013043, 8.09625290396312, 11.278877392411232, 11.019053481519222, 11.625304845161736, 10.982110008597374, 10.529162988066673, 11.135550655424595, 12.03941098600626, 12.50190778792603, 11.716554194688797, 10.99227873980999, 11.191531963646412, 11.424022283405066, 10.919737485547856, 10.497773741682366, 11.295793741320566, 5.045845963060856, 5.324735462665558, 5.061216063797474, 9.779621330400303, 9.339765985806778, 9.870253955324486, 6.981971247587353, 5.976354256272316, 6.8863010965287685, 12.714506344248846, 12.026559611161545, 12.86075355795522, 11.03628198554118, 10.732343820234135, 10.220248540242508, 8.95175515115261, 9.316034830641001, 8.29268454015255, 13.714619738360241, 13.65590901424487, 13.705898163219288, 5.194888611634568, 5.710163482775286, 5.036694978674248, 11.712891030746192, 11.241430635253579, 11.551388497153908, 7.10547239085038, 7.277915221949414, 7.412472260495022, 10.636127203702927, 11.1200395449996, 10.854354932904243, 9.98851505915323, 10.858810151616723, 10.836386511723191, 12.06235034018755, 12.279866501688957, 11.917294204235077, 11.532278159012392, 11.288745929797486, 11.52504515399535, 11.173759984473378, 10.865650127331406, 11.069743509093911, 8.28653759881854, 7.646874725818634, 7.958791606128216, 12.246789750332624, 11.112158368031174, 11.647542710105569, 13.554875676830605, 13.6300487195452, 13.377987270553902, 8.263033404946327, 8.494474273175001, 8.597680497914553, 8.948039089639977, 9.045571548243359, 9.18691527874519, 9.854389702280358, 10.204775373761848, 9.695785281558827, 4.425617701994867, 4.196827671180159, 3.839144090811402, 8.918296419084072, 9.105827197432518, 8.434046268463135, 7.6205282236138885, 7.669082837800175, 7.3073379645744865, 15.927458042899758, 15.821666019658238, 15.866594846049935, 10.96579448133707, 10.686800450086594, 11.434407276276033, 9.447786706189305, 9.333980205158383, 9.730368964994938, 8.411323755979538, 8.253691598773003, 8.592340156435966, 11.260343536734581, 10.26413169503212, 11.173630084842443, 11.493212047964334, 10.887203633785248, 11.61556624271907, 8.351043485105038, 8.49301515519619, 8.59181383997202, 11.464322324842215, 11.568703822791576, 11.368930287659168, 11.614759091908724, 11.671811582210154, 11.321776772538811, 9.741278837124497, 10.488594990844518, 10.332449494550616, 16.26424627502759, 16.458461323132113, 15.590880011518792, 10.61186187217632, 10.138795341054589, 10.707673060397298, 10.898067927608878, 10.869097406665475, 10.964359710613877, 9.21534601226449, 8.93988174945116, 9.197019223123789, 15.155339861909539, 15.245759959022195, 14.771401310960442, 11.635822695990399, 11.723884125550583, 11.166882072885826, 12.440273385494947, 12.596776120830327, 12.419898804277182, 8.468348801136017, 8.980283502489328, 8.991350781172514, 3.796490965411067, 3.8686643100809306, 3.4022989347577095, 10.629963909586266, 10.805970167120293, 11.231086498436824, 13.277169957756996, 13.33287899196148, 12.349887162446976, 10.497319672256708, 10.448786906898022, 10.62799184769392, 7.340379863977432, 7.582876369357109, 7.430947221815586, 8.586756464093924, 8.683637145906687, 7.991008058190346, 11.25538444519043, 11.04882138222456, 10.836768954992294, 6.212401496867329, 6.198371420303971, 5.995821947852761, 6.981024451553822, 6.638478755950928, 7.2445330284535885, 12.52541995793581, 11.865495100617409, 12.830488278530538, 6.7608330100774765, 6.929645899683237, 6.593050703406334, 17.33162497356534, 17.32085221633315, 17.28193811327219, 6.449393426378563, 6.63320431609948, 6.7363658932348045, 7.82990625500679, 7.6415489464998245, 7.999533157795668, 8.313715207080037, 8.430931149671466, 8.292285325626523, 10.514185663312674, 10.734283956233412, 10.273724898695946, 11.214094632615641, 10.406960775454834, 10.140232672293976, 12.337413683533669, 12.657626822590828, 12.648948684334755, 13.546889588236809, 13.390656501054764, 13.399364441633224, 9.510783649981022, 9.589911088347435, 9.557104244828224, 7.821665059775114, 7.786783564835787, 7.303448066115379, 8.188375309109688, 7.450205683708191, 8.274940103292465, 5.799901095529393, 5.818455313642815, 6.172195022304848, 7.5390296801924706, 7.464895583689213, 7.6202839612960815, 9.418374464381486, 8.85781841725111, 9.417099700309336, 14.603815707067639, 13.80334913233915, 14.052444914976746, 10.607256847123296, 10.515443156162888, 10.846395292008907, 4.353253858784825, 4.611144455770642, 4.318912940720708, 8.860479210813835, 8.256987770398453, 9.050573175152138, 13.781084641969443, 13.43513127664724, 13.776200250877679, 8.55887902310738, 8.034831563631684, 8.21835698435703, 14.452507508297757, 14.258775313695267, 14.624068564929374, 18.242786991099507, 18.389643299082906, 17.991219292084367, 8.849688574671745, 9.426750058308244, 8.748254954814911, 12.353724795083195, 12.18384142468372, 12.586075565467269, 11.932512352863938, 11.410360092918069, 12.280427659929643, 8.285859594742448, 9.05004612604776, 8.599153901139886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14477490038190624, "mean_inference_ms": 0.6432301564445314, "mean_action_processing_ms": 0.09460313429624664, "mean_env_wait_ms": 0.8040215361290194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 451200, "timesteps_this_iter": 0, "agent_timesteps_total": 1353600, "timers": {"sample_time_ms": 9518.804, "sample_throughput": 504.265, "load_time_ms": 0.199, "load_throughput": 24113856.989, "learn_time_ms": 1172.477, "learn_throughput": 4093.898, "update_time_ms": 1.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.360008627176285, "policy_loss": -0.0016814936623591667, "vf_loss": 2.4878548979759216, "vf_explained_var": -0.12856796383857727, "kl": 0.010421726619939998, "entropy": 12.658201098442078, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 451200, "num_agent_steps_sampled": 1353600, "num_steps_trained": 451200, "num_agent_steps_trained": 1353600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2432, "training_iteration": 94, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-57-20", "timestamp": 1706147840, "time_this_iter_s": 9.347262144088745, "time_total_s": 881.0555174350739, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 881.0555174350739, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 7.6000000000000005, "ram_util_percent": 46.67692307692308}}
{"episode_reward_max": 54.62364958226678, "episode_reward_min": 0.028848405927419662, "episode_reward_mean": 30.208939907161685, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -0.26371046900749207}, "policy_reward_max": {"shared_policy": 18.389643299082906}, "policy_reward_mean": {"shared_policy": 10.06964663572056}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.92323571909219, 32.64682365208864, 36.257872968621086, 33.60783298686147, 32.71330496855079, 15.431797489523888, 28.989641271531568, 19.844626600388438, 37.60181951336561, 31.988874346017823, 26.560474521946162, 41.0764269158244, 15.941747073084102, 34.50571016315368, 21.795859873294816, 32.61052168160677, 31.683711722493143, 36.259511046111584, 34.34606924280523, 33.109153620898695, 23.89220393076539, 35.00649082846937, 40.56291166692971, 25.35518817603588, 27.180525916628525, 29.754950357601032, 12.461589463986428, 26.458169884979725, 22.59694902598855, 47.61571890860793, 33.0870022076997, 28.512135876342626, 25.257355511188507, 32.698105316609144, 33.99598192446865, 25.435872480273247, 34.40195643529296, 34.60834744665769, 30.56232332251963, 48.31358760967849, 31.458330273628206, 32.73152504488823, 27.35224698483944, 45.172501131892176, 34.52658889442681, 37.456948310602456, 26.43998308479786, 11.067454210249707, 32.66702057514338, 38.95993611216545, 31.57409842684865, 22.354203455150127, 25.261401668190956, 33.140974782407284, 18.40659486502406, 20.864036235958338, 37.22140333708376, 20.283529613167048, 51.93441530317068, 19.818963635712848, 23.470988359302282, 25.036931682378025, 31.52219451824203, 31.76128808036445, 37.64398919045925, 40.3369105309248, 28.65779898315668, 22.91189669072628, 23.913521096110344, 17.790551431477056, 22.624209225177765, 27.693292581941932, 42.459609754383536, 31.96909529529509, 13.283311255276175, 26.168040156364427, 40.99241616949436, 24.812067571096094, 43.3353513869224, 54.62364958226678, 27.0246935877949, 37.123641785234184, 35.62330010571165, 25.935059621930094, 37.60096348822114, 29.377832892816485, 47.393397783860564, 18.501831471919985, 0.028848405927419662, 37.92899657040833, 25.242081607691915, 34.49615717213598, 14.513182434253395, 31.57387469522655, 14.584363438189001, 28.368496711424086, 51.74117383360861, 16.110894793644547, 31.918505655601592, 37.45504350587723], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.278877392411232, 11.019053481519222, 11.625304845161736, 10.982110008597374, 10.529162988066673, 11.135550655424595, 12.03941098600626, 12.50190778792603, 11.716554194688797, 10.99227873980999, 11.191531963646412, 11.424022283405066, 10.919737485547856, 10.497773741682366, 11.295793741320566, 5.045845963060856, 5.324735462665558, 5.061216063797474, 9.779621330400303, 9.339765985806778, 9.870253955324486, 6.981971247587353, 5.976354256272316, 6.8863010965287685, 12.714506344248846, 12.026559611161545, 12.86075355795522, 11.03628198554118, 10.732343820234135, 10.220248540242508, 8.95175515115261, 9.316034830641001, 8.29268454015255, 13.714619738360241, 13.65590901424487, 13.705898163219288, 5.194888611634568, 5.710163482775286, 5.036694978674248, 11.712891030746192, 11.241430635253579, 11.551388497153908, 7.10547239085038, 7.277915221949414, 7.412472260495022, 10.636127203702927, 11.1200395449996, 10.854354932904243, 9.98851505915323, 10.858810151616723, 10.836386511723191, 12.06235034018755, 12.279866501688957, 11.917294204235077, 11.532278159012392, 11.288745929797486, 11.52504515399535, 11.173759984473378, 10.865650127331406, 11.069743509093911, 8.28653759881854, 7.646874725818634, 7.958791606128216, 12.246789750332624, 11.112158368031174, 11.647542710105569, 13.554875676830605, 13.6300487195452, 13.377987270553902, 8.263033404946327, 8.494474273175001, 8.597680497914553, 8.948039089639977, 9.045571548243359, 9.18691527874519, 9.854389702280358, 10.204775373761848, 9.695785281558827, 4.425617701994867, 4.196827671180159, 3.839144090811402, 8.918296419084072, 9.105827197432518, 8.434046268463135, 7.6205282236138885, 7.669082837800175, 7.3073379645744865, 15.927458042899758, 15.821666019658238, 15.866594846049935, 10.96579448133707, 10.686800450086594, 11.434407276276033, 9.447786706189305, 9.333980205158383, 9.730368964994938, 8.411323755979538, 8.253691598773003, 8.592340156435966, 11.260343536734581, 10.26413169503212, 11.173630084842443, 11.493212047964334, 10.887203633785248, 11.61556624271907, 8.351043485105038, 8.49301515519619, 8.59181383997202, 11.464322324842215, 11.568703822791576, 11.368930287659168, 11.614759091908724, 11.671811582210154, 11.321776772538811, 9.741278837124497, 10.488594990844518, 10.332449494550616, 16.26424627502759, 16.458461323132113, 15.590880011518792, 10.61186187217632, 10.138795341054589, 10.707673060397298, 10.898067927608878, 10.869097406665475, 10.964359710613877, 9.21534601226449, 8.93988174945116, 9.197019223123789, 15.155339861909539, 15.245759959022195, 14.771401310960442, 11.635822695990399, 11.723884125550583, 11.166882072885826, 12.440273385494947, 12.596776120830327, 12.419898804277182, 8.468348801136017, 8.980283502489328, 8.991350781172514, 3.796490965411067, 3.8686643100809306, 3.4022989347577095, 10.629963909586266, 10.805970167120293, 11.231086498436824, 13.277169957756996, 13.33287899196148, 12.349887162446976, 10.497319672256708, 10.448786906898022, 10.62799184769392, 7.340379863977432, 7.582876369357109, 7.430947221815586, 8.586756464093924, 8.683637145906687, 7.991008058190346, 11.25538444519043, 11.04882138222456, 10.836768954992294, 6.212401496867329, 6.198371420303971, 5.995821947852761, 6.981024451553822, 6.638478755950928, 7.2445330284535885, 12.52541995793581, 11.865495100617409, 12.830488278530538, 6.7608330100774765, 6.929645899683237, 6.593050703406334, 17.33162497356534, 17.32085221633315, 17.28193811327219, 6.449393426378563, 6.63320431609948, 6.7363658932348045, 7.82990625500679, 7.6415489464998245, 7.999533157795668, 8.313715207080037, 8.430931149671466, 8.292285325626523, 10.514185663312674, 10.734283956233412, 10.273724898695946, 11.214094632615641, 10.406960775454834, 10.140232672293976, 12.337413683533669, 12.657626822590828, 12.648948684334755, 13.546889588236809, 13.390656501054764, 13.399364441633224, 9.510783649981022, 9.589911088347435, 9.557104244828224, 7.821665059775114, 7.786783564835787, 7.303448066115379, 8.188375309109688, 7.450205683708191, 8.274940103292465, 5.799901095529393, 5.818455313642815, 6.172195022304848, 7.5390296801924706, 7.464895583689213, 7.6202839612960815, 9.418374464381486, 8.85781841725111, 9.417099700309336, 14.603815707067639, 13.80334913233915, 14.052444914976746, 10.607256847123296, 10.515443156162888, 10.846395292008907, 4.353253858784825, 4.611144455770642, 4.318912940720708, 8.860479210813835, 8.256987770398453, 9.050573175152138, 13.781084641969443, 13.43513127664724, 13.776200250877679, 8.55887902310738, 8.034831563631684, 8.21835698435703, 14.452507508297757, 14.258775313695267, 14.624068564929374, 18.242786991099507, 18.389643299082906, 17.991219292084367, 8.849688574671745, 9.426750058308244, 8.748254954814911, 12.353724795083195, 12.18384142468372, 12.586075565467269, 11.932512352863938, 11.410360092918069, 12.280427659929643, 8.285859594742448, 9.05004612604776, 8.599153901139886, 12.529612208406121, 12.730793828765542, 12.340557451049477, 9.25454821685949, 10.155898006788135, 9.96738666916886, 15.794449601322412, 15.888634020462632, 15.71031416207552, 6.116724694768578, 6.374375979105622, 6.010730798045785, 0.24010954424738884, 0.05244933068752289, -0.26371046900749207, 12.626140353580311, 12.533469547828034, 12.769386668999985, 8.711009142609925, 7.889810661474854, 8.641261803607136, 11.802279988924653, 10.555075446764619, 12.138801736446709, 5.150905161164701, 4.4192555248737335, 4.94302174821496, 10.743199421092868, 10.283857092261314, 10.546818181872368, 5.042348230878503, 4.629342208305985, 4.9126729990045135, 9.603449019661639, 9.496365681290627, 9.26868201047182, 17.553215389450386, 16.99969469507535, 17.18826374908288, 5.3694952595978975, 5.3731707241386175, 5.368228809908032, 10.725472300002963, 10.73369260939458, 10.459340746204049, 12.79440467307964, 13.084401740382106, 11.576237092415482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1447224200540942, "mean_inference_ms": 0.6432599508588561, "mean_action_processing_ms": 0.09462240844391996, "mean_env_wait_ms": 0.8042417524555592, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 1368000, "timers": {"sample_time_ms": 9487.887, "sample_throughput": 505.908, "load_time_ms": 0.299, "load_throughput": 16054752.153, "learn_time_ms": 1166.681, "learn_throughput": 4114.236, "update_time_ms": 1.604}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 2.590166985988617, "policy_loss": -0.001901601342251702, "vf_loss": 2.718284636735916, "vf_explained_var": -0.11386875808238983, "kl": 0.007590620924136801, "entropy": 12.651994228363037, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 1368000, "num_steps_trained": 456000, "num_agent_steps_trained": 1368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2448, "training_iteration": 95, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-57-29", "timestamp": 1706147849, "time_this_iter_s": 9.344186544418335, "time_total_s": 890.3997039794922, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 890.3997039794922, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 9.7, "ram_util_percent": 46.621428571428574}}
{"episode_reward_max": 64.14441918022928, "episode_reward_min": 0.028848405927419662, "episode_reward_mean": 31.38529348614421, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -0.26371046900749207}, "policy_reward_max": {"shared_policy": 21.692166809613497}, "policy_reward_mean": {"shared_policy": 10.461764495381404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.683711722493143, 36.259511046111584, 34.34606924280523, 33.109153620898695, 23.89220393076539, 35.00649082846937, 40.56291166692971, 25.35518817603588, 27.180525916628525, 29.754950357601032, 12.461589463986428, 26.458169884979725, 22.59694902598855, 47.61571890860793, 33.0870022076997, 28.512135876342626, 25.257355511188507, 32.698105316609144, 33.99598192446865, 25.435872480273247, 34.40195643529296, 34.60834744665769, 30.56232332251963, 48.31358760967849, 31.458330273628206, 32.73152504488823, 27.35224698483944, 45.172501131892176, 34.52658889442681, 37.456948310602456, 26.43998308479786, 11.067454210249707, 32.66702057514338, 38.95993611216545, 31.57409842684865, 22.354203455150127, 25.261401668190956, 33.140974782407284, 18.40659486502406, 20.864036235958338, 37.22140333708376, 20.283529613167048, 51.93441530317068, 19.818963635712848, 23.470988359302282, 25.036931682378025, 31.52219451824203, 31.76128808036445, 37.64398919045925, 40.3369105309248, 28.65779898315668, 22.91189669072628, 23.913521096110344, 17.790551431477056, 22.624209225177765, 27.693292581941932, 42.459609754383536, 31.96909529529509, 13.283311255276175, 26.168040156364427, 40.99241616949436, 24.812067571096094, 43.3353513869224, 54.62364958226678, 27.0246935877949, 37.123641785234184, 35.62330010571165, 25.935059621930094, 37.60096348822114, 29.377832892816485, 47.393397783860564, 18.501831471919985, 0.028848405927419662, 37.92899657040833, 25.242081607691915, 34.49615717213598, 14.513182434253395, 31.57387469522655, 14.584363438189001, 28.368496711424086, 51.74117383360861, 16.110894793644547, 31.918505655601592, 37.45504350587723, 31.1696461215615, 39.56063376367091, 31.773304849863024, 28.564535178244086, 21.760434504365534, 32.52468408085406, 55.92191774398087, 38.92124620825052, 41.371816960629076, 15.250444833189235, 29.42410604050383, 64.14441918022928, 30.26384411146863, 48.51197186112404, 37.789669841527925, 46.179252363741384], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [9.98851505915323, 10.858810151616723, 10.836386511723191, 12.06235034018755, 12.279866501688957, 11.917294204235077, 11.532278159012392, 11.288745929797486, 11.52504515399535, 11.173759984473378, 10.865650127331406, 11.069743509093911, 8.28653759881854, 7.646874725818634, 7.958791606128216, 12.246789750332624, 11.112158368031174, 11.647542710105569, 13.554875676830605, 13.6300487195452, 13.377987270553902, 8.263033404946327, 8.494474273175001, 8.597680497914553, 8.948039089639977, 9.045571548243359, 9.18691527874519, 9.854389702280358, 10.204775373761848, 9.695785281558827, 4.425617701994867, 4.196827671180159, 3.839144090811402, 8.918296419084072, 9.105827197432518, 8.434046268463135, 7.6205282236138885, 7.669082837800175, 7.3073379645744865, 15.927458042899758, 15.821666019658238, 15.866594846049935, 10.96579448133707, 10.686800450086594, 11.434407276276033, 9.447786706189305, 9.333980205158383, 9.730368964994938, 8.411323755979538, 8.253691598773003, 8.592340156435966, 11.260343536734581, 10.26413169503212, 11.173630084842443, 11.493212047964334, 10.887203633785248, 11.61556624271907, 8.351043485105038, 8.49301515519619, 8.59181383997202, 11.464322324842215, 11.568703822791576, 11.368930287659168, 11.614759091908724, 11.671811582210154, 11.321776772538811, 9.741278837124497, 10.488594990844518, 10.332449494550616, 16.26424627502759, 16.458461323132113, 15.590880011518792, 10.61186187217632, 10.138795341054589, 10.707673060397298, 10.898067927608878, 10.869097406665475, 10.964359710613877, 9.21534601226449, 8.93988174945116, 9.197019223123789, 15.155339861909539, 15.245759959022195, 14.771401310960442, 11.635822695990399, 11.723884125550583, 11.166882072885826, 12.440273385494947, 12.596776120830327, 12.419898804277182, 8.468348801136017, 8.980283502489328, 8.991350781172514, 3.796490965411067, 3.8686643100809306, 3.4022989347577095, 10.629963909586266, 10.805970167120293, 11.231086498436824, 13.277169957756996, 13.33287899196148, 12.349887162446976, 10.497319672256708, 10.448786906898022, 10.62799184769392, 7.340379863977432, 7.582876369357109, 7.430947221815586, 8.586756464093924, 8.683637145906687, 7.991008058190346, 11.25538444519043, 11.04882138222456, 10.836768954992294, 6.212401496867329, 6.198371420303971, 5.995821947852761, 6.981024451553822, 6.638478755950928, 7.2445330284535885, 12.52541995793581, 11.865495100617409, 12.830488278530538, 6.7608330100774765, 6.929645899683237, 6.593050703406334, 17.33162497356534, 17.32085221633315, 17.28193811327219, 6.449393426378563, 6.63320431609948, 6.7363658932348045, 7.82990625500679, 7.6415489464998245, 7.999533157795668, 8.313715207080037, 8.430931149671466, 8.292285325626523, 10.514185663312674, 10.734283956233412, 10.273724898695946, 11.214094632615641, 10.406960775454834, 10.140232672293976, 12.337413683533669, 12.657626822590828, 12.648948684334755, 13.546889588236809, 13.390656501054764, 13.399364441633224, 9.510783649981022, 9.589911088347435, 9.557104244828224, 7.821665059775114, 7.786783564835787, 7.303448066115379, 8.188375309109688, 7.450205683708191, 8.274940103292465, 5.799901095529393, 5.818455313642815, 6.172195022304848, 7.5390296801924706, 7.464895583689213, 7.6202839612960815, 9.418374464381486, 8.85781841725111, 9.417099700309336, 14.603815707067639, 13.80334913233915, 14.052444914976746, 10.607256847123296, 10.515443156162888, 10.846395292008907, 4.353253858784825, 4.611144455770642, 4.318912940720708, 8.860479210813835, 8.256987770398453, 9.050573175152138, 13.781084641969443, 13.43513127664724, 13.776200250877679, 8.55887902310738, 8.034831563631684, 8.21835698435703, 14.452507508297757, 14.258775313695267, 14.624068564929374, 18.242786991099507, 18.389643299082906, 17.991219292084367, 8.849688574671745, 9.426750058308244, 8.748254954814911, 12.353724795083195, 12.18384142468372, 12.586075565467269, 11.932512352863938, 11.410360092918069, 12.280427659929643, 8.285859594742448, 9.05004612604776, 8.599153901139886, 12.529612208406121, 12.730793828765542, 12.340557451049477, 9.25454821685949, 10.155898006788135, 9.96738666916886, 15.794449601322412, 15.888634020462632, 15.71031416207552, 6.116724694768578, 6.374375979105622, 6.010730798045785, 0.24010954424738884, 0.05244933068752289, -0.26371046900749207, 12.626140353580311, 12.533469547828034, 12.769386668999985, 8.711009142609925, 7.889810661474854, 8.641261803607136, 11.802279988924653, 10.555075446764619, 12.138801736446709, 5.150905161164701, 4.4192555248737335, 4.94302174821496, 10.743199421092868, 10.283857092261314, 10.546818181872368, 5.042348230878503, 4.629342208305985, 4.9126729990045135, 9.603449019661639, 9.496365681290627, 9.26868201047182, 17.553215389450386, 16.99969469507535, 17.18826374908288, 5.3694952595978975, 5.3731707241386175, 5.368228809908032, 10.725472300002963, 10.73369260939458, 10.459340746204049, 12.79440467307964, 13.084401740382106, 11.576237092415482, 10.362102116147668, 9.868668417135865, 10.938875588277966, 13.141293800746396, 13.221309851234153, 13.198030111690358, 10.274544874827058, 10.62003995726505, 10.878720017770917, 9.825000720719487, 9.416203568379075, 9.323330889145524, 7.419865132387102, 7.261969221134976, 7.078600150843457, 10.97553881816566, 10.827173236757517, 10.721972025930882, 18.66931016867359, 18.64257178579767, 18.61003578950961, 12.862007722258568, 13.382234491407871, 12.677003994584084, 13.99200893798843, 13.370124265551567, 14.009683757089078, 5.088621412714318, 5.255333573867873, 4.906489846607045, 9.478407263755798, 9.909279573708773, 10.036419203039259, 21.579661207894475, 20.872591162721307, 21.692166809613497, 10.41697473575671, 10.665967679427311, 9.180901696284607, 16.005502104759216, 16.072239711880684, 16.43423004448414, 12.673029844959572, 12.583271247645214, 12.533368748923138, 15.19366780420144, 15.437704270084694, 15.54788028945525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1446643331633848, "mean_inference_ms": 0.6432411995250065, "mean_action_processing_ms": 0.09464369657320472, "mean_env_wait_ms": 0.8044253597421556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 460800, "timesteps_this_iter": 0, "agent_timesteps_total": 1382400, "timers": {"sample_time_ms": 9461.767, "sample_throughput": 507.305, "load_time_ms": 0.299, "load_throughput": 16054752.153, "learn_time_ms": 1167.912, "learn_throughput": 4109.9, "update_time_ms": 1.503}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 3.91059747338295, "policy_loss": 0.0007246206931691979, "vf_loss": 4.036266475915909, "vf_explained_var": -0.08129556477069855, "kl": 0.010868942190546326, "entropy": 12.682894468307495, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460800, "num_agent_steps_sampled": 1382400, "num_steps_trained": 460800, "num_agent_steps_trained": 1382400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2464, "training_iteration": 96, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-57-38", "timestamp": 1706147858, "time_this_iter_s": 9.336914777755737, "time_total_s": 899.7366187572479, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C21040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 899.7366187572479, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 7.5307692307692315, "ram_util_percent": 46.653846153846146}}
{"episode_reward_max": 64.14441918022928, "episode_reward_min": -292.2874367199838, "episode_reward_mean": 28.77763491253222, "episode_len_mean": 298.39, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -104.38457298278809}, "policy_reward_max": {"shared_policy": 21.692166809613497}, "policy_reward_mean": {"shared_policy": 9.592544970844072}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.698105316609144, 33.99598192446865, 25.435872480273247, 34.40195643529296, 34.60834744665769, 30.56232332251963, 48.31358760967849, 31.458330273628206, 32.73152504488823, 27.35224698483944, 45.172501131892176, 34.52658889442681, 37.456948310602456, 26.43998308479786, 11.067454210249707, 32.66702057514338, 38.95993611216545, 31.57409842684865, 22.354203455150127, 25.261401668190956, 33.140974782407284, 18.40659486502406, 20.864036235958338, 37.22140333708376, 20.283529613167048, 51.93441530317068, 19.818963635712848, 23.470988359302282, 25.036931682378025, 31.52219451824203, 31.76128808036445, 37.64398919045925, 40.3369105309248, 28.65779898315668, 22.91189669072628, 23.913521096110344, 17.790551431477056, 22.624209225177765, 27.693292581941932, 42.459609754383536, 31.96909529529509, 13.283311255276175, 26.168040156364427, 40.99241616949436, 24.812067571096094, 43.3353513869224, 54.62364958226678, 27.0246935877949, 37.123641785234184, 35.62330010571165, 25.935059621930094, 37.60096348822114, 29.377832892816485, 47.393397783860564, 18.501831471919985, 0.028848405927419662, 37.92899657040833, 25.242081607691915, 34.49615717213598, 14.513182434253395, 31.57387469522655, 14.584363438189001, 28.368496711424086, 51.74117383360861, 16.110894793644547, 31.918505655601592, 37.45504350587723, 31.1696461215615, 39.56063376367091, 31.773304849863024, 28.564535178244086, 21.760434504365534, 32.52468408085406, 55.92191774398087, 38.92124620825052, 41.371816960629076, 15.250444833189235, 29.42410604050383, 64.14441918022928, 30.26384411146863, 48.51197186112404, 37.789669841527925, 46.179252363741384, 33.5387892536819, 26.85471085086462, -292.2874367199838, 38.77503496222195, 21.641446420922875, 32.634796332567916, 40.09115066938102, 30.396669939160347, 25.5820150254294, 25.60073889791964, 44.499384462833376, 47.12469582259655, 34.37015413492915, 35.7083779107779, 37.62985521461813, 33.10635210573673, 37.10704474267547], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.260343536734581, 10.26413169503212, 11.173630084842443, 11.493212047964334, 10.887203633785248, 11.61556624271907, 8.351043485105038, 8.49301515519619, 8.59181383997202, 11.464322324842215, 11.568703822791576, 11.368930287659168, 11.614759091908724, 11.671811582210154, 11.321776772538811, 9.741278837124497, 10.488594990844518, 10.332449494550616, 16.26424627502759, 16.458461323132113, 15.590880011518792, 10.61186187217632, 10.138795341054589, 10.707673060397298, 10.898067927608878, 10.869097406665475, 10.964359710613877, 9.21534601226449, 8.93988174945116, 9.197019223123789, 15.155339861909539, 15.245759959022195, 14.771401310960442, 11.635822695990399, 11.723884125550583, 11.166882072885826, 12.440273385494947, 12.596776120830327, 12.419898804277182, 8.468348801136017, 8.980283502489328, 8.991350781172514, 3.796490965411067, 3.8686643100809306, 3.4022989347577095, 10.629963909586266, 10.805970167120293, 11.231086498436824, 13.277169957756996, 13.33287899196148, 12.349887162446976, 10.497319672256708, 10.448786906898022, 10.62799184769392, 7.340379863977432, 7.582876369357109, 7.430947221815586, 8.586756464093924, 8.683637145906687, 7.991008058190346, 11.25538444519043, 11.04882138222456, 10.836768954992294, 6.212401496867329, 6.198371420303971, 5.995821947852761, 6.981024451553822, 6.638478755950928, 7.2445330284535885, 12.52541995793581, 11.865495100617409, 12.830488278530538, 6.7608330100774765, 6.929645899683237, 6.593050703406334, 17.33162497356534, 17.32085221633315, 17.28193811327219, 6.449393426378563, 6.63320431609948, 6.7363658932348045, 7.82990625500679, 7.6415489464998245, 7.999533157795668, 8.313715207080037, 8.430931149671466, 8.292285325626523, 10.514185663312674, 10.734283956233412, 10.273724898695946, 11.214094632615641, 10.406960775454834, 10.140232672293976, 12.337413683533669, 12.657626822590828, 12.648948684334755, 13.546889588236809, 13.390656501054764, 13.399364441633224, 9.510783649981022, 9.589911088347435, 9.557104244828224, 7.821665059775114, 7.786783564835787, 7.303448066115379, 8.188375309109688, 7.450205683708191, 8.274940103292465, 5.799901095529393, 5.818455313642815, 6.172195022304848, 7.5390296801924706, 7.464895583689213, 7.6202839612960815, 9.418374464381486, 8.85781841725111, 9.417099700309336, 14.603815707067639, 13.80334913233915, 14.052444914976746, 10.607256847123296, 10.515443156162888, 10.846395292008907, 4.353253858784825, 4.611144455770642, 4.318912940720708, 8.860479210813835, 8.256987770398453, 9.050573175152138, 13.781084641969443, 13.43513127664724, 13.776200250877679, 8.55887902310738, 8.034831563631684, 8.21835698435703, 14.452507508297757, 14.258775313695267, 14.624068564929374, 18.242786991099507, 18.389643299082906, 17.991219292084367, 8.849688574671745, 9.426750058308244, 8.748254954814911, 12.353724795083195, 12.18384142468372, 12.586075565467269, 11.932512352863938, 11.410360092918069, 12.280427659929643, 8.285859594742448, 9.05004612604776, 8.599153901139886, 12.529612208406121, 12.730793828765542, 12.340557451049477, 9.25454821685949, 10.155898006788135, 9.96738666916886, 15.794449601322412, 15.888634020462632, 15.71031416207552, 6.116724694768578, 6.374375979105622, 6.010730798045785, 0.24010954424738884, 0.05244933068752289, -0.26371046900749207, 12.626140353580311, 12.533469547828034, 12.769386668999985, 8.711009142609925, 7.889810661474854, 8.641261803607136, 11.802279988924653, 10.555075446764619, 12.138801736446709, 5.150905161164701, 4.4192555248737335, 4.94302174821496, 10.743199421092868, 10.283857092261314, 10.546818181872368, 5.042348230878503, 4.629342208305985, 4.9126729990045135, 9.603449019661639, 9.496365681290627, 9.26868201047182, 17.553215389450386, 16.99969469507535, 17.18826374908288, 5.3694952595978975, 5.3731707241386175, 5.368228809908032, 10.725472300002963, 10.73369260939458, 10.459340746204049, 12.79440467307964, 13.084401740382106, 11.576237092415482, 10.362102116147668, 9.868668417135865, 10.938875588277966, 13.141293800746396, 13.221309851234153, 13.198030111690358, 10.274544874827058, 10.62003995726505, 10.878720017770917, 9.825000720719487, 9.416203568379075, 9.323330889145524, 7.419865132387102, 7.261969221134976, 7.078600150843457, 10.97553881816566, 10.827173236757517, 10.721972025930882, 18.66931016867359, 18.64257178579767, 18.61003578950961, 12.862007722258568, 13.382234491407871, 12.677003994584084, 13.99200893798843, 13.370124265551567, 14.009683757089078, 5.088621412714318, 5.255333573867873, 4.906489846607045, 9.478407263755798, 9.909279573708773, 10.036419203039259, 21.579661207894475, 20.872591162721307, 21.692166809613497, 10.41697473575671, 10.665967679427311, 9.180901696284607, 16.005502104759216, 16.072239711880684, 16.43423004448414, 12.673029844959572, 12.583271247645214, 12.533368748923138, 15.19366780420144, 15.437704270084694, 15.54788028945525, 11.162165232002735, 11.0371288433671, 11.339495178312063, 8.640374253193528, 9.02536333600679, 9.188973261664302, -94.3270990550518, -104.38457298278809, -93.57576468214393, 12.073434869448334, 13.493111700440437, 13.20848839233318, 7.41761820204556, 7.021322891116142, 7.202505327761173, 10.754921933015183, 11.168324680378035, 10.711549719174698, 13.303313955664635, 13.485213370993733, 13.302623342722654, 9.97025691717863, 9.993971481919289, 10.432441540062428, 8.188370714584977, 8.653738821546227, 8.739905489298195, 8.68867704023917, 8.124161486824349, 8.787900370856121, 14.97408642123142, 14.638476173082978, 14.886821868518979, 15.866229251027107, 15.7911696434021, 15.467296928167343, 11.568376059333474, 11.104909266034753, 11.696868809560925, 12.638301306093723, 11.734653214613587, 11.335423390070588, 12.99808273868014, 12.078944494326905, 12.552827981611088, 11.101572915911674, 10.921166718006134, 11.083612471818924, 12.07173305998245, 12.459990852201969, 12.575320830491052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14461032267741664, "mean_inference_ms": 0.6431921453320989, "mean_action_processing_ms": 0.09465766858845771, "mean_env_wait_ms": 0.8045793399490475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 465600, "timesteps_this_iter": 0, "agent_timesteps_total": 1396800, "timers": {"sample_time_ms": 9470.025, "sample_throughput": 506.862, "load_time_ms": 0.299, "load_throughput": 16054752.153, "learn_time_ms": 1169.299, "learn_throughput": 4105.022, "update_time_ms": 1.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 110.83685970306396, "policy_loss": -0.0032547701993543843, "vf_loss": 110.96611309051514, "vf_explained_var": -0.007263273000717163, "kl": 0.010675043871863443, "entropy": 12.642496705055237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 465600, "num_agent_steps_sampled": 1396800, "num_steps_trained": 465600, "num_agent_steps_trained": 1396800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2481, "training_iteration": 97, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-57-48", "timestamp": 1706147868, "time_this_iter_s": 9.285097599029541, "time_total_s": 909.0217163562775, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F4F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 909.0217163562775, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 7.115384615384615, "ram_util_percent": 46.65384615384615}}
{"episode_reward_max": 67.69702899456024, "episode_reward_min": -292.2874367199838, "episode_reward_mean": 30.87926655178743, "episode_len_mean": 298.39, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.38457298278809}, "policy_reward_max": {"shared_policy": 22.673043482005596}, "policy_reward_mean": {"shared_policy": 10.29308885059581}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.95993611216545, 31.57409842684865, 22.354203455150127, 25.261401668190956, 33.140974782407284, 18.40659486502406, 20.864036235958338, 37.22140333708376, 20.283529613167048, 51.93441530317068, 19.818963635712848, 23.470988359302282, 25.036931682378025, 31.52219451824203, 31.76128808036445, 37.64398919045925, 40.3369105309248, 28.65779898315668, 22.91189669072628, 23.913521096110344, 17.790551431477056, 22.624209225177765, 27.693292581941932, 42.459609754383536, 31.96909529529509, 13.283311255276175, 26.168040156364427, 40.99241616949436, 24.812067571096094, 43.3353513869224, 54.62364958226678, 27.0246935877949, 37.123641785234184, 35.62330010571165, 25.935059621930094, 37.60096348822114, 29.377832892816485, 47.393397783860564, 18.501831471919985, 0.028848405927419662, 37.92899657040833, 25.242081607691915, 34.49615717213598, 14.513182434253395, 31.57387469522655, 14.584363438189001, 28.368496711424086, 51.74117383360861, 16.110894793644547, 31.918505655601592, 37.45504350587723, 31.1696461215615, 39.56063376367091, 31.773304849863024, 28.564535178244086, 21.760434504365534, 32.52468408085406, 55.92191774398087, 38.92124620825052, 41.371816960629076, 15.250444833189235, 29.42410604050383, 64.14441918022928, 30.26384411146863, 48.51197186112404, 37.789669841527925, 46.179252363741384, 33.5387892536819, 26.85471085086462, -292.2874367199838, 38.77503496222195, 21.641446420922875, 32.634796332567916, 40.09115066938102, 30.396669939160347, 25.5820150254294, 25.60073889791964, 44.499384462833376, 47.12469582259655, 34.37015413492915, 35.7083779107779, 37.62985521461813, 33.10635210573673, 37.10704474267547, 60.82004811987281, 60.342586062848554, 67.69702899456024, 21.86740255728364, 45.71942289173603, 54.92372185364363, 34.99389400333163, 64.81083755940196, 45.69139496237038, 43.6146302446723, 25.09867260046302, 57.69097714498636, 55.32692296244204, 20.81837528944014, 36.05263213859868, 33.58338958583769], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.277169957756996, 13.33287899196148, 12.349887162446976, 10.497319672256708, 10.448786906898022, 10.62799184769392, 7.340379863977432, 7.582876369357109, 7.430947221815586, 8.586756464093924, 8.683637145906687, 7.991008058190346, 11.25538444519043, 11.04882138222456, 10.836768954992294, 6.212401496867329, 6.198371420303971, 5.995821947852761, 6.981024451553822, 6.638478755950928, 7.2445330284535885, 12.52541995793581, 11.865495100617409, 12.830488278530538, 6.7608330100774765, 6.929645899683237, 6.593050703406334, 17.33162497356534, 17.32085221633315, 17.28193811327219, 6.449393426378563, 6.63320431609948, 6.7363658932348045, 7.82990625500679, 7.6415489464998245, 7.999533157795668, 8.313715207080037, 8.430931149671466, 8.292285325626523, 10.514185663312674, 10.734283956233412, 10.273724898695946, 11.214094632615641, 10.406960775454834, 10.140232672293976, 12.337413683533669, 12.657626822590828, 12.648948684334755, 13.546889588236809, 13.390656501054764, 13.399364441633224, 9.510783649981022, 9.589911088347435, 9.557104244828224, 7.821665059775114, 7.786783564835787, 7.303448066115379, 8.188375309109688, 7.450205683708191, 8.274940103292465, 5.799901095529393, 5.818455313642815, 6.172195022304848, 7.5390296801924706, 7.464895583689213, 7.6202839612960815, 9.418374464381486, 8.85781841725111, 9.417099700309336, 14.603815707067639, 13.80334913233915, 14.052444914976746, 10.607256847123296, 10.515443156162888, 10.846395292008907, 4.353253858784825, 4.611144455770642, 4.318912940720708, 8.860479210813835, 8.256987770398453, 9.050573175152138, 13.781084641969443, 13.43513127664724, 13.776200250877679, 8.55887902310738, 8.034831563631684, 8.21835698435703, 14.452507508297757, 14.258775313695267, 14.624068564929374, 18.242786991099507, 18.389643299082906, 17.991219292084367, 8.849688574671745, 9.426750058308244, 8.748254954814911, 12.353724795083195, 12.18384142468372, 12.586075565467269, 11.932512352863938, 11.410360092918069, 12.280427659929643, 8.285859594742448, 9.05004612604776, 8.599153901139886, 12.529612208406121, 12.730793828765542, 12.340557451049477, 9.25454821685949, 10.155898006788135, 9.96738666916886, 15.794449601322412, 15.888634020462632, 15.71031416207552, 6.116724694768578, 6.374375979105622, 6.010730798045785, 0.24010954424738884, 0.05244933068752289, -0.26371046900749207, 12.626140353580311, 12.533469547828034, 12.769386668999985, 8.711009142609925, 7.889810661474854, 8.641261803607136, 11.802279988924653, 10.555075446764619, 12.138801736446709, 5.150905161164701, 4.4192555248737335, 4.94302174821496, 10.743199421092868, 10.283857092261314, 10.546818181872368, 5.042348230878503, 4.629342208305985, 4.9126729990045135, 9.603449019661639, 9.496365681290627, 9.26868201047182, 17.553215389450386, 16.99969469507535, 17.18826374908288, 5.3694952595978975, 5.3731707241386175, 5.368228809908032, 10.725472300002963, 10.73369260939458, 10.459340746204049, 12.79440467307964, 13.084401740382106, 11.576237092415482, 10.362102116147668, 9.868668417135865, 10.938875588277966, 13.141293800746396, 13.221309851234153, 13.198030111690358, 10.274544874827058, 10.62003995726505, 10.878720017770917, 9.825000720719487, 9.416203568379075, 9.323330889145524, 7.419865132387102, 7.261969221134976, 7.078600150843457, 10.97553881816566, 10.827173236757517, 10.721972025930882, 18.66931016867359, 18.64257178579767, 18.61003578950961, 12.862007722258568, 13.382234491407871, 12.677003994584084, 13.99200893798843, 13.370124265551567, 14.009683757089078, 5.088621412714318, 5.255333573867873, 4.906489846607045, 9.478407263755798, 9.909279573708773, 10.036419203039259, 21.579661207894475, 20.872591162721307, 21.692166809613497, 10.41697473575671, 10.665967679427311, 9.180901696284607, 16.005502104759216, 16.072239711880684, 16.43423004448414, 12.673029844959572, 12.583271247645214, 12.533368748923138, 15.19366780420144, 15.437704270084694, 15.54788028945525, 11.162165232002735, 11.0371288433671, 11.339495178312063, 8.640374253193528, 9.02536333600679, 9.188973261664302, -94.3270990550518, -104.38457298278809, -93.57576468214393, 12.073434869448334, 13.493111700440437, 13.20848839233318, 7.41761820204556, 7.021322891116142, 7.202505327761173, 10.754921933015183, 11.168324680378035, 10.711549719174698, 13.303313955664635, 13.485213370993733, 13.302623342722654, 9.97025691717863, 9.993971481919289, 10.432441540062428, 8.188370714584977, 8.653738821546227, 8.739905489298195, 8.68867704023917, 8.124161486824349, 8.787900370856121, 14.97408642123142, 14.638476173082978, 14.886821868518979, 15.866229251027107, 15.7911696434021, 15.467296928167343, 11.568376059333474, 11.104909266034753, 11.696868809560925, 12.638301306093723, 11.734653214613587, 11.335423390070588, 12.99808273868014, 12.078944494326905, 12.552827981611088, 11.101572915911674, 10.921166718006134, 11.083612471818924, 12.07173305998245, 12.459990852201969, 12.575320830491052, 20.132219053804874, 20.268002681434155, 20.41982638463378, 20.191318822403744, 20.08698636790116, 20.064280872543648, 22.6655832529068, 22.673043482005596, 22.358402259647846, 7.278437852859497, 7.256367016583681, 7.332597687840462, 15.345326825976372, 15.025647670030594, 15.348448395729065, 18.28834520156184, 18.393962192038686, 18.241414460043103, 11.239662448565156, 11.785418669382722, 11.968812885383755, 21.330257224539906, 21.623576673368603, 21.85700366149345, 15.567650207628802, 15.444208839287356, 14.679535915454224, 14.591650500893593, 14.736156783998013, 14.286822959780693, 8.206161399682358, 8.757751993214086, 8.134759207566574, 19.264607320229203, 18.92502729098001, 19.501342533777148, 18.527667202055454, 18.728689761832356, 18.07056599855423, 7.060124990840748, 6.694481452306107, 7.063768846293286, 11.885991791884095, 12.293026576905191, 11.873613769809396, 11.126081502685935, 11.183800945679337, 11.273507137472421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14455938614381433, "mean_inference_ms": 0.6431365505968876, "mean_action_processing_ms": 0.09467183143510169, "mean_env_wait_ms": 0.8046566195613218, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 470400, "timesteps_this_iter": 0, "agent_timesteps_total": 1411200, "timers": {"sample_time_ms": 9417.636, "sample_throughput": 509.682, "load_time_ms": 0.299, "load_throughput": 16054752.153, "learn_time_ms": 1164.022, "learn_throughput": 4123.634, "update_time_ms": 1.402}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 5.015189230442047, "policy_loss": -0.0023004019433088274, "vf_loss": 5.143301784992218, "vf_explained_var": -0.06282006204128265, "kl": 0.00627585410268848, "entropy": 12.606367349624634, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 470400, "num_agent_steps_sampled": 1411200, "num_steps_trained": 470400, "num_agent_steps_trained": 1411200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2497, "training_iteration": 98, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-57-57", "timestamp": 1706147877, "time_this_iter_s": 9.202224254608154, "time_total_s": 918.2239406108856, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632F9CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 918.2239406108856, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 5.515384615384615, "ram_util_percent": 46.66153846153847}}
{"episode_reward_max": 81.94636020436883, "episode_reward_min": -292.2874367199838, "episode_reward_mean": 33.95259086747682, "episode_len_mean": 298.39, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.38457298278809}, "policy_reward_max": {"shared_policy": 27.70285015180707}, "policy_reward_mean": {"shared_policy": 11.317530289158938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.3369105309248, 28.65779898315668, 22.91189669072628, 23.913521096110344, 17.790551431477056, 22.624209225177765, 27.693292581941932, 42.459609754383536, 31.96909529529509, 13.283311255276175, 26.168040156364427, 40.99241616949436, 24.812067571096094, 43.3353513869224, 54.62364958226678, 27.0246935877949, 37.123641785234184, 35.62330010571165, 25.935059621930094, 37.60096348822114, 29.377832892816485, 47.393397783860564, 18.501831471919985, 0.028848405927419662, 37.92899657040833, 25.242081607691915, 34.49615717213598, 14.513182434253395, 31.57387469522655, 14.584363438189001, 28.368496711424086, 51.74117383360861, 16.110894793644547, 31.918505655601592, 37.45504350587723, 31.1696461215615, 39.56063376367091, 31.773304849863024, 28.564535178244086, 21.760434504365534, 32.52468408085406, 55.92191774398087, 38.92124620825052, 41.371816960629076, 15.250444833189235, 29.42410604050383, 64.14441918022928, 30.26384411146863, 48.51197186112404, 37.789669841527925, 46.179252363741384, 33.5387892536819, 26.85471085086462, -292.2874367199838, 38.77503496222195, 21.641446420922875, 32.634796332567916, 40.09115066938102, 30.396669939160347, 25.5820150254294, 25.60073889791964, 44.499384462833376, 47.12469582259655, 34.37015413492915, 35.7083779107779, 37.62985521461813, 33.10635210573673, 37.10704474267547, 60.82004811987281, 60.342586062848554, 67.69702899456024, 21.86740255728364, 45.71942289173603, 54.92372185364363, 34.99389400333163, 64.81083755940196, 45.69139496237038, 43.6146302446723, 25.09867260046302, 57.69097714498636, 55.32692296244204, 20.81837528944014, 36.05263213859868, 33.58338958583769, 40.07083296868947, 63.510233016218976, 52.914746465627076, 41.75416091457008, 31.61806369619444, 58.09240475110707, 24.533439188497113, 48.805726161226616, 81.94636020436883, 22.355034969747052, 49.16952896880683, 44.352295793592916, 44.800992933800444, 49.717685857787714, 59.01125021278858, 63.93462473154065], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.546889588236809, 13.390656501054764, 13.399364441633224, 9.510783649981022, 9.589911088347435, 9.557104244828224, 7.821665059775114, 7.786783564835787, 7.303448066115379, 8.188375309109688, 7.450205683708191, 8.274940103292465, 5.799901095529393, 5.818455313642815, 6.172195022304848, 7.5390296801924706, 7.464895583689213, 7.6202839612960815, 9.418374464381486, 8.85781841725111, 9.417099700309336, 14.603815707067639, 13.80334913233915, 14.052444914976746, 10.607256847123296, 10.515443156162888, 10.846395292008907, 4.353253858784825, 4.611144455770642, 4.318912940720708, 8.860479210813835, 8.256987770398453, 9.050573175152138, 13.781084641969443, 13.43513127664724, 13.776200250877679, 8.55887902310738, 8.034831563631684, 8.21835698435703, 14.452507508297757, 14.258775313695267, 14.624068564929374, 18.242786991099507, 18.389643299082906, 17.991219292084367, 8.849688574671745, 9.426750058308244, 8.748254954814911, 12.353724795083195, 12.18384142468372, 12.586075565467269, 11.932512352863938, 11.410360092918069, 12.280427659929643, 8.285859594742448, 9.05004612604776, 8.599153901139886, 12.529612208406121, 12.730793828765542, 12.340557451049477, 9.25454821685949, 10.155898006788135, 9.96738666916886, 15.794449601322412, 15.888634020462632, 15.71031416207552, 6.116724694768578, 6.374375979105622, 6.010730798045785, 0.24010954424738884, 0.05244933068752289, -0.26371046900749207, 12.626140353580311, 12.533469547828034, 12.769386668999985, 8.711009142609925, 7.889810661474854, 8.641261803607136, 11.802279988924653, 10.555075446764619, 12.138801736446709, 5.150905161164701, 4.4192555248737335, 4.94302174821496, 10.743199421092868, 10.283857092261314, 10.546818181872368, 5.042348230878503, 4.629342208305985, 4.9126729990045135, 9.603449019661639, 9.496365681290627, 9.26868201047182, 17.553215389450386, 16.99969469507535, 17.18826374908288, 5.3694952595978975, 5.3731707241386175, 5.368228809908032, 10.725472300002963, 10.73369260939458, 10.459340746204049, 12.79440467307964, 13.084401740382106, 11.576237092415482, 10.362102116147668, 9.868668417135865, 10.938875588277966, 13.141293800746396, 13.221309851234153, 13.198030111690358, 10.274544874827058, 10.62003995726505, 10.878720017770917, 9.825000720719487, 9.416203568379075, 9.323330889145524, 7.419865132387102, 7.261969221134976, 7.078600150843457, 10.97553881816566, 10.827173236757517, 10.721972025930882, 18.66931016867359, 18.64257178579767, 18.61003578950961, 12.862007722258568, 13.382234491407871, 12.677003994584084, 13.99200893798843, 13.370124265551567, 14.009683757089078, 5.088621412714318, 5.255333573867873, 4.906489846607045, 9.478407263755798, 9.909279573708773, 10.036419203039259, 21.579661207894475, 20.872591162721307, 21.692166809613497, 10.41697473575671, 10.665967679427311, 9.180901696284607, 16.005502104759216, 16.072239711880684, 16.43423004448414, 12.673029844959572, 12.583271247645214, 12.533368748923138, 15.19366780420144, 15.437704270084694, 15.54788028945525, 11.162165232002735, 11.0371288433671, 11.339495178312063, 8.640374253193528, 9.02536333600679, 9.188973261664302, -94.3270990550518, -104.38457298278809, -93.57576468214393, 12.073434869448334, 13.493111700440437, 13.20848839233318, 7.41761820204556, 7.021322891116142, 7.202505327761173, 10.754921933015183, 11.168324680378035, 10.711549719174698, 13.303313955664635, 13.485213370993733, 13.302623342722654, 9.97025691717863, 9.993971481919289, 10.432441540062428, 8.188370714584977, 8.653738821546227, 8.739905489298195, 8.68867704023917, 8.124161486824349, 8.787900370856121, 14.97408642123142, 14.638476173082978, 14.886821868518979, 15.866229251027107, 15.7911696434021, 15.467296928167343, 11.568376059333474, 11.104909266034753, 11.696868809560925, 12.638301306093723, 11.734653214613587, 11.335423390070588, 12.99808273868014, 12.078944494326905, 12.552827981611088, 11.101572915911674, 10.921166718006134, 11.083612471818924, 12.07173305998245, 12.459990852201969, 12.575320830491052, 20.132219053804874, 20.268002681434155, 20.41982638463378, 20.191318822403744, 20.08698636790116, 20.064280872543648, 22.6655832529068, 22.673043482005596, 22.358402259647846, 7.278437852859497, 7.256367016583681, 7.332597687840462, 15.345326825976372, 15.025647670030594, 15.348448395729065, 18.28834520156184, 18.393962192038686, 18.241414460043103, 11.239662448565156, 11.785418669382722, 11.968812885383755, 21.330257224539906, 21.623576673368603, 21.85700366149345, 15.567650207628802, 15.444208839287356, 14.679535915454224, 14.591650500893593, 14.736156783998013, 14.286822959780693, 8.206161399682358, 8.757751993214086, 8.134759207566574, 19.264607320229203, 18.92502729098001, 19.501342533777148, 18.527667202055454, 18.728689761832356, 18.07056599855423, 7.060124990840748, 6.694481452306107, 7.063768846293286, 11.885991791884095, 12.293026576905191, 11.873613769809396, 11.126081502685935, 11.183800945679337, 11.273507137472421, 13.096901195744664, 13.558509390490741, 13.415422382454068, 21.122406116997198, 21.2060114404497, 21.18181545877208, 17.70581327813366, 17.792655031351984, 17.41627815614143, 13.640761350591973, 14.183100343992308, 13.930299219985798, 10.254248887300491, 10.813900880981237, 10.549913927912712, 19.577209793652088, 19.243666792909295, 19.271528164545686, 7.961728433767945, 8.369120249447093, 8.202590505282075, 16.093106394012764, 16.143469524880246, 16.569150242333606, 27.70285015180707, 26.923557475209236, 27.319952577352524, 7.039143835504845, 7.659236287077263, 7.656654847164944, 16.571877246276316, 16.502560329933956, 16.095091392596558, 14.957919177909687, 14.574114737411335, 14.820261878271893, 15.306599220028147, 14.981774903833866, 14.51261880993843, 16.17143279810746, 16.85923889217277, 16.687014167507485, 19.306112676858902, 20.012394785881042, 19.692742750048637, 21.16401446859041, 21.515149566034466, 21.255460696915776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14451160906249963, "mean_inference_ms": 0.6431505683160593, "mean_action_processing_ms": 0.0946915246442791, "mean_env_wait_ms": 0.8047174449796044, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 475200, "timesteps_this_iter": 0, "agent_timesteps_total": 1425600, "timers": {"sample_time_ms": 9385.801, "sample_throughput": 511.411, "load_time_ms": 0.2, "load_throughput": 24010327.013, "learn_time_ms": 1165.328, "learn_throughput": 4119.013, "update_time_ms": 1.302}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 5.302448213100433, "policy_loss": -0.003298854514464933, "vf_loss": 5.4308056235313416, "vf_explained_var": -0.04344309866428375, "kl": 0.00938754850370097, "entropy": 12.543469667434692, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 475200, "num_agent_steps_sampled": 1425600, "num_steps_trained": 475200, "num_agent_steps_trained": 1425600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2513, "training_iteration": 99, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-58-06", "timestamp": 1706147886, "time_this_iter_s": 9.464629411697388, "time_total_s": 927.688570022583, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 927.688570022583, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 6.592857142857142, "ram_util_percent": 46.69285714285714}}
{"episode_reward_max": 81.94636020436883, "episode_reward_min": -292.2874367199838, "episode_reward_mean": 36.93386950752028, "episode_len_mean": 298.39, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.38457298278809}, "policy_reward_max": {"shared_policy": 27.70285015180707}, "policy_reward_mean": {"shared_policy": 12.311289835840089}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.123641785234184, 35.62330010571165, 25.935059621930094, 37.60096348822114, 29.377832892816485, 47.393397783860564, 18.501831471919985, 0.028848405927419662, 37.92899657040833, 25.242081607691915, 34.49615717213598, 14.513182434253395, 31.57387469522655, 14.584363438189001, 28.368496711424086, 51.74117383360861, 16.110894793644547, 31.918505655601592, 37.45504350587723, 31.1696461215615, 39.56063376367091, 31.773304849863024, 28.564535178244086, 21.760434504365534, 32.52468408085406, 55.92191774398087, 38.92124620825052, 41.371816960629076, 15.250444833189235, 29.42410604050383, 64.14441918022928, 30.26384411146863, 48.51197186112404, 37.789669841527925, 46.179252363741384, 33.5387892536819, 26.85471085086462, -292.2874367199838, 38.77503496222195, 21.641446420922875, 32.634796332567916, 40.09115066938102, 30.396669939160347, 25.5820150254294, 25.60073889791964, 44.499384462833376, 47.12469582259655, 34.37015413492915, 35.7083779107779, 37.62985521461813, 33.10635210573673, 37.10704474267547, 60.82004811987281, 60.342586062848554, 67.69702899456024, 21.86740255728364, 45.71942289173603, 54.92372185364363, 34.99389400333163, 64.81083755940196, 45.69139496237038, 43.6146302446723, 25.09867260046302, 57.69097714498636, 55.32692296244204, 20.81837528944014, 36.05263213859868, 33.58338958583769, 40.07083296868947, 63.510233016218976, 52.914746465627076, 41.75416091457008, 31.61806369619444, 58.09240475110707, 24.533439188497113, 48.805726161226616, 81.94636020436883, 22.355034969747052, 49.16952896880683, 44.352295793592916, 44.800992933800444, 49.717685857787714, 59.01125021278858, 63.93462473154065, 51.04930801549925, 28.024659123970167, 61.47002496942878, 51.884787529706955, 80.36604285985231, 44.680664815008626, 47.04489925503731, 60.71964986622332, 42.785701893270016, 67.33156779746058, 26.123785845702486, 48.562223158776746, 39.62985561601815, 30.654828504659235, 38.77298829704522, 67.62329175509512], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [12.353724795083195, 12.18384142468372, 12.586075565467269, 11.932512352863938, 11.410360092918069, 12.280427659929643, 8.285859594742448, 9.05004612604776, 8.599153901139886, 12.529612208406121, 12.730793828765542, 12.340557451049477, 9.25454821685949, 10.155898006788135, 9.96738666916886, 15.794449601322412, 15.888634020462632, 15.71031416207552, 6.116724694768578, 6.374375979105622, 6.010730798045785, 0.24010954424738884, 0.05244933068752289, -0.26371046900749207, 12.626140353580311, 12.533469547828034, 12.769386668999985, 8.711009142609925, 7.889810661474854, 8.641261803607136, 11.802279988924653, 10.555075446764619, 12.138801736446709, 5.150905161164701, 4.4192555248737335, 4.94302174821496, 10.743199421092868, 10.283857092261314, 10.546818181872368, 5.042348230878503, 4.629342208305985, 4.9126729990045135, 9.603449019661639, 9.496365681290627, 9.26868201047182, 17.553215389450386, 16.99969469507535, 17.18826374908288, 5.3694952595978975, 5.3731707241386175, 5.368228809908032, 10.725472300002963, 10.73369260939458, 10.459340746204049, 12.79440467307964, 13.084401740382106, 11.576237092415482, 10.362102116147668, 9.868668417135865, 10.938875588277966, 13.141293800746396, 13.221309851234153, 13.198030111690358, 10.274544874827058, 10.62003995726505, 10.878720017770917, 9.825000720719487, 9.416203568379075, 9.323330889145524, 7.419865132387102, 7.261969221134976, 7.078600150843457, 10.97553881816566, 10.827173236757517, 10.721972025930882, 18.66931016867359, 18.64257178579767, 18.61003578950961, 12.862007722258568, 13.382234491407871, 12.677003994584084, 13.99200893798843, 13.370124265551567, 14.009683757089078, 5.088621412714318, 5.255333573867873, 4.906489846607045, 9.478407263755798, 9.909279573708773, 10.036419203039259, 21.579661207894475, 20.872591162721307, 21.692166809613497, 10.41697473575671, 10.665967679427311, 9.180901696284607, 16.005502104759216, 16.072239711880684, 16.43423004448414, 12.673029844959572, 12.583271247645214, 12.533368748923138, 15.19366780420144, 15.437704270084694, 15.54788028945525, 11.162165232002735, 11.0371288433671, 11.339495178312063, 8.640374253193528, 9.02536333600679, 9.188973261664302, -94.3270990550518, -104.38457298278809, -93.57576468214393, 12.073434869448334, 13.493111700440437, 13.20848839233318, 7.41761820204556, 7.021322891116142, 7.202505327761173, 10.754921933015183, 11.168324680378035, 10.711549719174698, 13.303313955664635, 13.485213370993733, 13.302623342722654, 9.97025691717863, 9.993971481919289, 10.432441540062428, 8.188370714584977, 8.653738821546227, 8.739905489298195, 8.68867704023917, 8.124161486824349, 8.787900370856121, 14.97408642123142, 14.638476173082978, 14.886821868518979, 15.866229251027107, 15.7911696434021, 15.467296928167343, 11.568376059333474, 11.104909266034753, 11.696868809560925, 12.638301306093723, 11.734653214613587, 11.335423390070588, 12.99808273868014, 12.078944494326905, 12.552827981611088, 11.101572915911674, 10.921166718006134, 11.083612471818924, 12.07173305998245, 12.459990852201969, 12.575320830491052, 20.132219053804874, 20.268002681434155, 20.41982638463378, 20.191318822403744, 20.08698636790116, 20.064280872543648, 22.6655832529068, 22.673043482005596, 22.358402259647846, 7.278437852859497, 7.256367016583681, 7.332597687840462, 15.345326825976372, 15.025647670030594, 15.348448395729065, 18.28834520156184, 18.393962192038686, 18.241414460043103, 11.239662448565156, 11.785418669382722, 11.968812885383755, 21.330257224539906, 21.623576673368603, 21.85700366149345, 15.567650207628802, 15.444208839287356, 14.679535915454224, 14.591650500893593, 14.736156783998013, 14.286822959780693, 8.206161399682358, 8.757751993214086, 8.134759207566574, 19.264607320229203, 18.92502729098001, 19.501342533777148, 18.527667202055454, 18.728689761832356, 18.07056599855423, 7.060124990840748, 6.694481452306107, 7.063768846293286, 11.885991791884095, 12.293026576905191, 11.873613769809396, 11.126081502685935, 11.183800945679337, 11.273507137472421, 13.096901195744664, 13.558509390490741, 13.415422382454068, 21.122406116997198, 21.2060114404497, 21.18181545877208, 17.70581327813366, 17.792655031351984, 17.41627815614143, 13.640761350591973, 14.183100343992308, 13.930299219985798, 10.254248887300491, 10.813900880981237, 10.549913927912712, 19.577209793652088, 19.243666792909295, 19.271528164545686, 7.961728433767945, 8.369120249447093, 8.202590505282075, 16.093106394012764, 16.143469524880246, 16.569150242333606, 27.70285015180707, 26.923557475209236, 27.319952577352524, 7.039143835504845, 7.659236287077263, 7.656654847164944, 16.571877246276316, 16.502560329933956, 16.095091392596558, 14.957919177909687, 14.574114737411335, 14.820261878271893, 15.306599220028147, 14.981774903833866, 14.51261880993843, 16.17143279810746, 16.85923889217277, 16.687014167507485, 19.306112676858902, 20.012394785881042, 19.692742750048637, 21.16401446859041, 21.515149566034466, 21.255460696915776, 16.994179387887314, 17.102745488130793, 16.952383139481142, 9.010875354210526, 9.533342879653588, 9.480440890106053, 20.46809569373727, 20.61124859750271, 20.3906806781888, 17.563700433820486, 17.60999547317624, 16.711091622710228, 26.437511086463928, 26.94523797929287, 26.983293794095516, 14.713018355270222, 14.974494451036051, 14.993152008702353, 15.837610132992268, 15.732868269085884, 15.474420852959156, 20.44869990398486, 20.46982006480296, 19.8011298974355, 14.308180756866932, 14.654416054487228, 13.823105081915855, 22.29662275065978, 22.737128340600364, 22.297816706200436, 8.10267614821592, 8.949357296029717, 9.071752401456848, 15.935042349000767, 16.323953454693154, 16.303227355082825, 13.072630646328122, 13.532023229325802, 13.025201740364224, 10.267169136554003, 10.284432173706591, 10.103227194398642, 13.13213725139697, 12.38369271655877, 13.257158329089478, 22.58774816803634, 22.459287744015455, 22.576255843043327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14445685529558205, "mean_inference_ms": 0.6431515975217192, "mean_action_processing_ms": 0.09470412374602664, "mean_env_wait_ms": 0.8047416168214389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 9350.753, "sample_throughput": 513.328, "load_time_ms": 0.2, "load_throughput": 24010327.013, "learn_time_ms": 1166.726, "learn_throughput": 4114.077, "update_time_ms": 1.302}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 6.048194110393524, "policy_loss": -0.001823421218270782, "vf_loss": 6.174975156784058, "vf_explained_var": -0.0437941700220108, "kl": 0.006009369215581628, "entropy": 12.519814491271973, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 480000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 66.77896975167094, "episode_reward_min": 38.855378055013716, "episode_reward_mean": 51.69445089955697, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 12.755827382206917}, "policy_reward_max": {"shared_policy": 22.45605537233253}, "policy_reward_mean": {"shared_policy": 17.231483633185654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.98605483770369, 39.03925969830016, 42.83353305421767, 48.131974160671234, 38.855378055013716, 49.23644391039849, 65.3816396128386, 41.377407875843346, 60.32384803891182, 66.77896975167094], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.47955887516339, 21.80546951045592, 21.701026452084378, 12.934647969901562, 12.80288340896368, 13.301728319434915, 14.098597007493169, 14.403955337281019, 14.33098070944348, 16.189106829464436, 15.815705448389053, 16.127161882817745, 12.793065458536148, 12.755827382206917, 13.306485214270651, 16.79876656671209, 15.972219164172799, 16.465458179513604, 21.37306265036264, 21.926166540632636, 22.08241042184332, 13.71449913829565, 13.949803453870118, 13.713105283677578, 20.15995268523693, 20.507872000336647, 19.65602335333824, 21.925995801885918, 22.45605537233253, 22.396918577452496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1337486255121123, "mean_inference_ms": 0.6496233039976974, "mean_action_processing_ms": 0.08971187863508666, "mean_env_wait_ms": 0.8035395979486484, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 2529, "training_iteration": 100, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-58-21", "timestamp": 1706147901, "time_this_iter_s": 14.325782299041748, "time_total_s": 942.0143523216248, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000466F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 942.0143523216248, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 6.69, "ram_util_percent": 46.83}}
{"episode_reward_max": 81.94636020436883, "episode_reward_min": -292.2874367199838, "episode_reward_mean": 40.40765195257902, "episode_len_mean": 298.39, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.38457298278809}, "policy_reward_max": {"shared_policy": 27.70285015180707}, "policy_reward_mean": {"shared_policy": 13.46921731752634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.110894793644547, 31.918505655601592, 37.45504350587723, 31.1696461215615, 39.56063376367091, 31.773304849863024, 28.564535178244086, 21.760434504365534, 32.52468408085406, 55.92191774398087, 38.92124620825052, 41.371816960629076, 15.250444833189235, 29.42410604050383, 64.14441918022928, 30.26384411146863, 48.51197186112404, 37.789669841527925, 46.179252363741384, 33.5387892536819, 26.85471085086462, -292.2874367199838, 38.77503496222195, 21.641446420922875, 32.634796332567916, 40.09115066938102, 30.396669939160347, 25.5820150254294, 25.60073889791964, 44.499384462833376, 47.12469582259655, 34.37015413492915, 35.7083779107779, 37.62985521461813, 33.10635210573673, 37.10704474267547, 60.82004811987281, 60.342586062848554, 67.69702899456024, 21.86740255728364, 45.71942289173603, 54.92372185364363, 34.99389400333163, 64.81083755940196, 45.69139496237038, 43.6146302446723, 25.09867260046302, 57.69097714498636, 55.32692296244204, 20.81837528944014, 36.05263213859868, 33.58338958583769, 40.07083296868947, 63.510233016218976, 52.914746465627076, 41.75416091457008, 31.61806369619444, 58.09240475110707, 24.533439188497113, 48.805726161226616, 81.94636020436883, 22.355034969747052, 49.16952896880683, 44.352295793592916, 44.800992933800444, 49.717685857787714, 59.01125021278858, 63.93462473154065, 51.04930801549925, 28.024659123970167, 61.47002496942878, 51.884787529706955, 80.36604285985231, 44.680664815008626, 47.04489925503731, 60.71964986622332, 42.785701893270016, 67.33156779746058, 26.123785845702486, 48.562223158776746, 39.62985561601815, 30.654828504659235, 38.77298829704522, 67.62329175509512, 45.48934329301119, 38.971479224041076, 67.04011528752743, 44.407492836005986, 39.02031454443929, 67.94035629183053, 45.51392062206287, 35.60152449458836, 57.5731248743832, 56.280137687921524, 76.68410401046276, 27.233200289308996, 72.86620339751244, 47.44654831616205, 60.1103415545076, 35.23323980066925], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.3694952595978975, 5.3731707241386175, 5.368228809908032, 10.725472300002963, 10.73369260939458, 10.459340746204049, 12.79440467307964, 13.084401740382106, 11.576237092415482, 10.362102116147668, 9.868668417135865, 10.938875588277966, 13.141293800746396, 13.221309851234153, 13.198030111690358, 10.274544874827058, 10.62003995726505, 10.878720017770917, 9.825000720719487, 9.416203568379075, 9.323330889145524, 7.419865132387102, 7.261969221134976, 7.078600150843457, 10.97553881816566, 10.827173236757517, 10.721972025930882, 18.66931016867359, 18.64257178579767, 18.61003578950961, 12.862007722258568, 13.382234491407871, 12.677003994584084, 13.99200893798843, 13.370124265551567, 14.009683757089078, 5.088621412714318, 5.255333573867873, 4.906489846607045, 9.478407263755798, 9.909279573708773, 10.036419203039259, 21.579661207894475, 20.872591162721307, 21.692166809613497, 10.41697473575671, 10.665967679427311, 9.180901696284607, 16.005502104759216, 16.072239711880684, 16.43423004448414, 12.673029844959572, 12.583271247645214, 12.533368748923138, 15.19366780420144, 15.437704270084694, 15.54788028945525, 11.162165232002735, 11.0371288433671, 11.339495178312063, 8.640374253193528, 9.02536333600679, 9.188973261664302, -94.3270990550518, -104.38457298278809, -93.57576468214393, 12.073434869448334, 13.493111700440437, 13.20848839233318, 7.41761820204556, 7.021322891116142, 7.202505327761173, 10.754921933015183, 11.168324680378035, 10.711549719174698, 13.303313955664635, 13.485213370993733, 13.302623342722654, 9.97025691717863, 9.993971481919289, 10.432441540062428, 8.188370714584977, 8.653738821546227, 8.739905489298195, 8.68867704023917, 8.124161486824349, 8.787900370856121, 14.97408642123142, 14.638476173082978, 14.886821868518979, 15.866229251027107, 15.7911696434021, 15.467296928167343, 11.568376059333474, 11.104909266034753, 11.696868809560925, 12.638301306093723, 11.734653214613587, 11.335423390070588, 12.99808273868014, 12.078944494326905, 12.552827981611088, 11.101572915911674, 10.921166718006134, 11.083612471818924, 12.07173305998245, 12.459990852201969, 12.575320830491052, 20.132219053804874, 20.268002681434155, 20.41982638463378, 20.191318822403744, 20.08698636790116, 20.064280872543648, 22.6655832529068, 22.673043482005596, 22.358402259647846, 7.278437852859497, 7.256367016583681, 7.332597687840462, 15.345326825976372, 15.025647670030594, 15.348448395729065, 18.28834520156184, 18.393962192038686, 18.241414460043103, 11.239662448565156, 11.785418669382722, 11.968812885383755, 21.330257224539906, 21.623576673368603, 21.85700366149345, 15.567650207628802, 15.444208839287356, 14.679535915454224, 14.591650500893593, 14.736156783998013, 14.286822959780693, 8.206161399682358, 8.757751993214086, 8.134759207566574, 19.264607320229203, 18.92502729098001, 19.501342533777148, 18.527667202055454, 18.728689761832356, 18.07056599855423, 7.060124990840748, 6.694481452306107, 7.063768846293286, 11.885991791884095, 12.293026576905191, 11.873613769809396, 11.126081502685935, 11.183800945679337, 11.273507137472421, 13.096901195744664, 13.558509390490741, 13.415422382454068, 21.122406116997198, 21.2060114404497, 21.18181545877208, 17.70581327813366, 17.792655031351984, 17.41627815614143, 13.640761350591973, 14.183100343992308, 13.930299219985798, 10.254248887300491, 10.813900880981237, 10.549913927912712, 19.577209793652088, 19.243666792909295, 19.271528164545686, 7.961728433767945, 8.369120249447093, 8.202590505282075, 16.093106394012764, 16.143469524880246, 16.569150242333606, 27.70285015180707, 26.923557475209236, 27.319952577352524, 7.039143835504845, 7.659236287077263, 7.656654847164944, 16.571877246276316, 16.502560329933956, 16.095091392596558, 14.957919177909687, 14.574114737411335, 14.820261878271893, 15.306599220028147, 14.981774903833866, 14.51261880993843, 16.17143279810746, 16.85923889217277, 16.687014167507485, 19.306112676858902, 20.012394785881042, 19.692742750048637, 21.16401446859041, 21.515149566034466, 21.255460696915776, 16.994179387887314, 17.102745488130793, 16.952383139481142, 9.010875354210526, 9.533342879653588, 9.480440890106053, 20.46809569373727, 20.61124859750271, 20.3906806781888, 17.563700433820486, 17.60999547317624, 16.711091622710228, 26.437511086463928, 26.94523797929287, 26.983293794095516, 14.713018355270222, 14.974494451036051, 14.993152008702353, 15.837610132992268, 15.732868269085884, 15.474420852959156, 20.44869990398486, 20.46982006480296, 19.8011298974355, 14.308180756866932, 14.654416054487228, 13.823105081915855, 22.29662275065978, 22.737128340600364, 22.297816706200436, 8.10267614821592, 8.949357296029717, 9.071752401456848, 15.935042349000767, 16.323953454693154, 16.303227355082825, 13.072630646328122, 13.532023229325802, 13.025201740364224, 10.267169136554003, 10.284432173706591, 10.103227194398642, 13.13213725139697, 12.38369271655877, 13.257158329089478, 22.58774816803634, 22.459287744015455, 22.576255843043327, 15.136576890945435, 15.417601577937603, 14.935164824128151, 12.710133398572594, 13.12245779313767, 13.138888032330811, 22.514262742673353, 22.160097075005368, 22.365755469848708, 14.877371740527451, 14.718606904149055, 14.81151419132948, 13.151834207276494, 13.13306477914253, 12.735415558020264, 22.687985626359776, 22.77611057211955, 22.4762600933512, 15.564440706861205, 15.227848567068577, 14.721631348133087, 11.938336612035826, 11.637387228508786, 12.02580065404375, 19.240665794660643, 19.099265602727726, 19.233193476994828, 18.571862906217575, 19.13995410501957, 18.56832067668438, 25.395146816968918, 25.50293079018593, 25.786026403307915, 9.076479385296494, 9.093308235208184, 9.063412668804318, 24.330608405172825, 24.499423809349537, 24.036171182990074, 15.971154040579364, 15.505728306869656, 15.96966596871303, 19.93681117643912, 20.127636741225913, 20.045893636842564, 11.898279630579054, 11.498273134231567, 11.836687035858631]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14442375779862995, "mean_inference_ms": 0.6432255161820527, "mean_action_processing_ms": 0.09470588970786686, "mean_env_wait_ms": 0.8047677799160806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 484800, "timesteps_this_iter": 0, "agent_timesteps_total": 1454400, "timers": {"sample_time_ms": 9893.283, "sample_throughput": 485.178, "load_time_ms": 0.2, "load_throughput": 24010327.013, "learn_time_ms": 1167.626, "learn_throughput": 4110.906, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 3.9759743213653564, "policy_loss": -2.986861590104084e-05, "vf_loss": 4.101893216371536, "vf_explained_var": -0.05509936809539795, "kl": 0.005495827048556253, "entropy": 12.610914826393127, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 484800, "num_agent_steps_sampled": 1454400, "num_steps_trained": 484800, "num_agent_steps_trained": 1454400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2545, "training_iteration": 101, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-58-30", "timestamp": 1706147910, "time_this_iter_s": 9.628909587860107, "time_total_s": 951.6432619094849, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000466B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 951.6432619094849, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 7.1230769230769235, "ram_util_percent": 46.83846153846153}}
{"episode_reward_max": 82.33644511178136, "episode_reward_min": -292.2874367199838, "episode_reward_mean": 43.46870142271974, "episode_len_mean": 298.39, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.38457298278809}, "policy_reward_max": {"shared_policy": 27.70285015180707}, "policy_reward_mean": {"shared_policy": 14.489567140906578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.51197186112404, 37.789669841527925, 46.179252363741384, 33.5387892536819, 26.85471085086462, -292.2874367199838, 38.77503496222195, 21.641446420922875, 32.634796332567916, 40.09115066938102, 30.396669939160347, 25.5820150254294, 25.60073889791964, 44.499384462833376, 47.12469582259655, 34.37015413492915, 35.7083779107779, 37.62985521461813, 33.10635210573673, 37.10704474267547, 60.82004811987281, 60.342586062848554, 67.69702899456024, 21.86740255728364, 45.71942289173603, 54.92372185364363, 34.99389400333163, 64.81083755940196, 45.69139496237038, 43.6146302446723, 25.09867260046302, 57.69097714498636, 55.32692296244204, 20.81837528944014, 36.05263213859868, 33.58338958583769, 40.07083296868947, 63.510233016218976, 52.914746465627076, 41.75416091457008, 31.61806369619444, 58.09240475110707, 24.533439188497113, 48.805726161226616, 81.94636020436883, 22.355034969747052, 49.16952896880683, 44.352295793592916, 44.800992933800444, 49.717685857787714, 59.01125021278858, 63.93462473154065, 51.04930801549925, 28.024659123970167, 61.47002496942878, 51.884787529706955, 80.36604285985231, 44.680664815008626, 47.04489925503731, 60.71964986622332, 42.785701893270016, 67.33156779746058, 26.123785845702486, 48.562223158776746, 39.62985561601815, 30.654828504659235, 38.77298829704522, 67.62329175509512, 45.48934329301119, 38.971479224041076, 67.04011528752743, 44.407492836005986, 39.02031454443929, 67.94035629183053, 45.51392062206287, 35.60152449458836, 57.5731248743832, 56.280137687921524, 76.68410401046276, 27.233200289308996, 72.86620339751244, 47.44654831616205, 60.1103415545076, 35.23323980066925, 52.47531633637844, 53.16836287913608, 82.33644511178136, 56.824303127825246, 47.5567416343838, 33.86690823733805, 64.70171719044444, 43.94161939620972, 37.789134475402534, 46.20021166093646, 62.34747396782038, 47.1110073197633, 68.3348875660449, 63.30687584041149, 49.677265010774136, 42.602154791355105], "episode_lengths": [300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.005502104759216, 16.072239711880684, 16.43423004448414, 12.673029844959572, 12.583271247645214, 12.533368748923138, 15.19366780420144, 15.437704270084694, 15.54788028945525, 11.162165232002735, 11.0371288433671, 11.339495178312063, 8.640374253193528, 9.02536333600679, 9.188973261664302, -94.3270990550518, -104.38457298278809, -93.57576468214393, 12.073434869448334, 13.493111700440437, 13.20848839233318, 7.41761820204556, 7.021322891116142, 7.202505327761173, 10.754921933015183, 11.168324680378035, 10.711549719174698, 13.303313955664635, 13.485213370993733, 13.302623342722654, 9.97025691717863, 9.993971481919289, 10.432441540062428, 8.188370714584977, 8.653738821546227, 8.739905489298195, 8.68867704023917, 8.124161486824349, 8.787900370856121, 14.97408642123142, 14.638476173082978, 14.886821868518979, 15.866229251027107, 15.7911696434021, 15.467296928167343, 11.568376059333474, 11.104909266034753, 11.696868809560925, 12.638301306093723, 11.734653214613587, 11.335423390070588, 12.99808273868014, 12.078944494326905, 12.552827981611088, 11.101572915911674, 10.921166718006134, 11.083612471818924, 12.07173305998245, 12.459990852201969, 12.575320830491052, 20.132219053804874, 20.268002681434155, 20.41982638463378, 20.191318822403744, 20.08698636790116, 20.064280872543648, 22.6655832529068, 22.673043482005596, 22.358402259647846, 7.278437852859497, 7.256367016583681, 7.332597687840462, 15.345326825976372, 15.025647670030594, 15.348448395729065, 18.28834520156184, 18.393962192038686, 18.241414460043103, 11.239662448565156, 11.785418669382722, 11.968812885383755, 21.330257224539906, 21.623576673368603, 21.85700366149345, 15.567650207628802, 15.444208839287356, 14.679535915454224, 14.591650500893593, 14.736156783998013, 14.286822959780693, 8.206161399682358, 8.757751993214086, 8.134759207566574, 19.264607320229203, 18.92502729098001, 19.501342533777148, 18.527667202055454, 18.728689761832356, 18.07056599855423, 7.060124990840748, 6.694481452306107, 7.063768846293286, 11.885991791884095, 12.293026576905191, 11.873613769809396, 11.126081502685935, 11.183800945679337, 11.273507137472421, 13.096901195744664, 13.558509390490741, 13.415422382454068, 21.122406116997198, 21.2060114404497, 21.18181545877208, 17.70581327813366, 17.792655031351984, 17.41627815614143, 13.640761350591973, 14.183100343992308, 13.930299219985798, 10.254248887300491, 10.813900880981237, 10.549913927912712, 19.577209793652088, 19.243666792909295, 19.271528164545686, 7.961728433767945, 8.369120249447093, 8.202590505282075, 16.093106394012764, 16.143469524880246, 16.569150242333606, 27.70285015180707, 26.923557475209236, 27.319952577352524, 7.039143835504845, 7.659236287077263, 7.656654847164944, 16.571877246276316, 16.502560329933956, 16.095091392596558, 14.957919177909687, 14.574114737411335, 14.820261878271893, 15.306599220028147, 14.981774903833866, 14.51261880993843, 16.17143279810746, 16.85923889217277, 16.687014167507485, 19.306112676858902, 20.012394785881042, 19.692742750048637, 21.16401446859041, 21.515149566034466, 21.255460696915776, 16.994179387887314, 17.102745488130793, 16.952383139481142, 9.010875354210526, 9.533342879653588, 9.480440890106053, 20.46809569373727, 20.61124859750271, 20.3906806781888, 17.563700433820486, 17.60999547317624, 16.711091622710228, 26.437511086463928, 26.94523797929287, 26.983293794095516, 14.713018355270222, 14.974494451036051, 14.993152008702353, 15.837610132992268, 15.732868269085884, 15.474420852959156, 20.44869990398486, 20.46982006480296, 19.8011298974355, 14.308180756866932, 14.654416054487228, 13.823105081915855, 22.29662275065978, 22.737128340600364, 22.297816706200436, 8.10267614821592, 8.949357296029717, 9.071752401456848, 15.935042349000767, 16.323953454693154, 16.303227355082825, 13.072630646328122, 13.532023229325802, 13.025201740364224, 10.267169136554003, 10.284432173706591, 10.103227194398642, 13.13213725139697, 12.38369271655877, 13.257158329089478, 22.58774816803634, 22.459287744015455, 22.576255843043327, 15.136576890945435, 15.417601577937603, 14.935164824128151, 12.710133398572594, 13.12245779313767, 13.138888032330811, 22.514262742673353, 22.160097075005368, 22.365755469848708, 14.877371740527451, 14.718606904149055, 14.81151419132948, 13.151834207276494, 13.13306477914253, 12.735415558020264, 22.687985626359776, 22.77611057211955, 22.4762600933512, 15.564440706861205, 15.227848567068577, 14.721631348133087, 11.938336612035826, 11.637387228508786, 12.02580065404375, 19.240665794660643, 19.099265602727726, 19.233193476994828, 18.571862906217575, 19.13995410501957, 18.56832067668438, 25.395146816968918, 25.50293079018593, 25.786026403307915, 9.076479385296494, 9.093308235208184, 9.063412668804318, 24.330608405172825, 24.499423809349537, 24.036171182990074, 15.971154040579364, 15.505728306869656, 15.96966596871303, 19.93681117643912, 20.127636741225913, 20.045893636842564, 11.898279630579054, 11.498273134231567, 11.836687035858631, 17.319923033316925, 17.367698428531483, 17.787694874530033, 17.58766213307777, 17.795629873503145, 17.785070872555167, 27.449268523603678, 27.297036305069923, 27.590140283107758, 18.813287903865174, 18.911736020197466, 19.099279203762606, 15.820014469325542, 15.745027970522642, 15.991699194535613, 11.51102827986081, 10.849922915299729, 11.505957042177513, 21.627584295968205, 21.18378051618734, 21.890352378288895, 14.675476029515266, 14.539792090654373, 14.726351276040077, 12.398390889167786, 12.775764300487936, 12.614979285746813, 15.449968771388129, 15.5404149548461, 15.209827934702233, 20.802782500783593, 20.963614402959735, 20.58107706407705, 15.570344664156437, 15.777269480749965, 15.763393174856901, 22.880268993477017, 23.127262566859514, 22.327356005708367, 20.936349684993417, 21.404457631792553, 20.966068523625523, 16.387536868453026, 16.662466272711754, 16.627261869609356, 14.238844784597546, 14.132184880475194, 14.231125126282365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14441309300088048, "mean_inference_ms": 0.6434112638384315, "mean_action_processing_ms": 0.09471453220692622, "mean_env_wait_ms": 0.8048121514039067, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 489600, "timesteps_this_iter": 0, "agent_timesteps_total": 1468800, "timers": {"sample_time_ms": 9935.568, "sample_throughput": 483.113, "load_time_ms": 0.2, "load_throughput": 24010327.013, "learn_time_ms": 1170.626, "learn_throughput": 4100.369, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 4.026704668998718, "policy_loss": -0.0007248207565539178, "vf_loss": 4.15386700630188, "vf_explained_var": -0.0371200293302536, "kl": 0.006581006077008437, "entropy": 12.670096397399902, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 489600, "num_agent_steps_sampled": 1468800, "num_steps_trained": 489600, "num_agent_steps_trained": 1468800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2561, "training_iteration": 102, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-58-40", "timestamp": 1706147920, "time_this_iter_s": 9.88961935043335, "time_total_s": 961.5328812599182, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632B39D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 961.5328812599182, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 9.68, "ram_util_percent": 46.93333333333333}}
{"episode_reward_max": 86.6091468334198, "episode_reward_min": 15.707020630128653, "episode_reward_mean": 50.059682001320176, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.113128776351601}, "policy_reward_max": {"shared_policy": 29.077352836728096}, "policy_reward_mean": {"shared_policy": 16.686560667106722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.7083779107779, 37.62985521461813, 33.10635210573673, 37.10704474267547, 60.82004811987281, 60.342586062848554, 67.69702899456024, 21.86740255728364, 45.71942289173603, 54.92372185364363, 34.99389400333163, 64.81083755940196, 45.69139496237038, 43.6146302446723, 25.09867260046302, 57.69097714498636, 55.32692296244204, 20.81837528944014, 36.05263213859868, 33.58338958583769, 40.07083296868947, 63.510233016218976, 52.914746465627076, 41.75416091457008, 31.61806369619444, 58.09240475110707, 24.533439188497113, 48.805726161226616, 81.94636020436883, 22.355034969747052, 49.16952896880683, 44.352295793592916, 44.800992933800444, 49.717685857787714, 59.01125021278858, 63.93462473154065, 51.04930801549925, 28.024659123970167, 61.47002496942878, 51.884787529706955, 80.36604285985231, 44.680664815008626, 47.04489925503731, 60.71964986622332, 42.785701893270016, 67.33156779746058, 26.123785845702486, 48.562223158776746, 39.62985561601815, 30.654828504659235, 38.77298829704522, 67.62329175509512, 45.48934329301119, 38.971479224041076, 67.04011528752743, 44.407492836005986, 39.02031454443929, 67.94035629183053, 45.51392062206287, 35.60152449458836, 57.5731248743832, 56.280137687921524, 76.68410401046276, 27.233200289308996, 72.86620339751244, 47.44654831616205, 60.1103415545076, 35.23323980066925, 52.47531633637844, 53.16836287913608, 82.33644511178136, 56.824303127825246, 47.5567416343838, 33.86690823733805, 64.70171719044444, 43.94161939620972, 37.789134475402534, 46.20021166093646, 62.34747396782038, 47.1110073197633, 68.3348875660449, 63.30687584041149, 49.677265010774136, 42.602154791355105, 55.19360847026107, 65.93957106769085, 65.42622569575906, 63.964365813881145, 15.707020630128653, 53.36153166368601, 48.057158720213906, 43.30546609312296, 69.9480846552178, 50.08921214938164, 73.61652546189725, 86.6091468334198, 50.37309791520238, 55.683282751589985, 43.349992960691424, 59.77681109681724], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [12.638301306093723, 11.734653214613587, 11.335423390070588, 12.99808273868014, 12.078944494326905, 12.552827981611088, 11.101572915911674, 10.921166718006134, 11.083612471818924, 12.07173305998245, 12.459990852201969, 12.575320830491052, 20.132219053804874, 20.268002681434155, 20.41982638463378, 20.191318822403744, 20.08698636790116, 20.064280872543648, 22.6655832529068, 22.673043482005596, 22.358402259647846, 7.278437852859497, 7.256367016583681, 7.332597687840462, 15.345326825976372, 15.025647670030594, 15.348448395729065, 18.28834520156184, 18.393962192038686, 18.241414460043103, 11.239662448565156, 11.785418669382722, 11.968812885383755, 21.330257224539906, 21.623576673368603, 21.85700366149345, 15.567650207628802, 15.444208839287356, 14.679535915454224, 14.591650500893593, 14.736156783998013, 14.286822959780693, 8.206161399682358, 8.757751993214086, 8.134759207566574, 19.264607320229203, 18.92502729098001, 19.501342533777148, 18.527667202055454, 18.728689761832356, 18.07056599855423, 7.060124990840748, 6.694481452306107, 7.063768846293286, 11.885991791884095, 12.293026576905191, 11.873613769809396, 11.126081502685935, 11.183800945679337, 11.273507137472421, 13.096901195744664, 13.558509390490741, 13.415422382454068, 21.122406116997198, 21.2060114404497, 21.18181545877208, 17.70581327813366, 17.792655031351984, 17.41627815614143, 13.640761350591973, 14.183100343992308, 13.930299219985798, 10.254248887300491, 10.813900880981237, 10.549913927912712, 19.577209793652088, 19.243666792909295, 19.271528164545686, 7.961728433767945, 8.369120249447093, 8.202590505282075, 16.093106394012764, 16.143469524880246, 16.569150242333606, 27.70285015180707, 26.923557475209236, 27.319952577352524, 7.039143835504845, 7.659236287077263, 7.656654847164944, 16.571877246276316, 16.502560329933956, 16.095091392596558, 14.957919177909687, 14.574114737411335, 14.820261878271893, 15.306599220028147, 14.981774903833866, 14.51261880993843, 16.17143279810746, 16.85923889217277, 16.687014167507485, 19.306112676858902, 20.012394785881042, 19.692742750048637, 21.16401446859041, 21.515149566034466, 21.255460696915776, 16.994179387887314, 17.102745488130793, 16.952383139481142, 9.010875354210526, 9.533342879653588, 9.480440890106053, 20.46809569373727, 20.61124859750271, 20.3906806781888, 17.563700433820486, 17.60999547317624, 16.711091622710228, 26.437511086463928, 26.94523797929287, 26.983293794095516, 14.713018355270222, 14.974494451036051, 14.993152008702353, 15.837610132992268, 15.732868269085884, 15.474420852959156, 20.44869990398486, 20.46982006480296, 19.8011298974355, 14.308180756866932, 14.654416054487228, 13.823105081915855, 22.29662275065978, 22.737128340600364, 22.297816706200436, 8.10267614821592, 8.949357296029717, 9.071752401456848, 15.935042349000767, 16.323953454693154, 16.303227355082825, 13.072630646328122, 13.532023229325802, 13.025201740364224, 10.267169136554003, 10.284432173706591, 10.103227194398642, 13.13213725139697, 12.38369271655877, 13.257158329089478, 22.58774816803634, 22.459287744015455, 22.576255843043327, 15.136576890945435, 15.417601577937603, 14.935164824128151, 12.710133398572594, 13.12245779313767, 13.138888032330811, 22.514262742673353, 22.160097075005368, 22.365755469848708, 14.877371740527451, 14.718606904149055, 14.81151419132948, 13.151834207276494, 13.13306477914253, 12.735415558020264, 22.687985626359776, 22.77611057211955, 22.4762600933512, 15.564440706861205, 15.227848567068577, 14.721631348133087, 11.938336612035826, 11.637387228508786, 12.02580065404375, 19.240665794660643, 19.099265602727726, 19.233193476994828, 18.571862906217575, 19.13995410501957, 18.56832067668438, 25.395146816968918, 25.50293079018593, 25.786026403307915, 9.076479385296494, 9.093308235208184, 9.063412668804318, 24.330608405172825, 24.499423809349537, 24.036171182990074, 15.971154040579364, 15.505728306869656, 15.96966596871303, 19.93681117643912, 20.127636741225913, 20.045893636842564, 11.898279630579054, 11.498273134231567, 11.836687035858631, 17.319923033316925, 17.367698428531483, 17.787694874530033, 17.58766213307777, 17.795629873503145, 17.785070872555167, 27.449268523603678, 27.297036305069923, 27.590140283107758, 18.813287903865174, 18.911736020197466, 19.099279203762606, 15.820014469325542, 15.745027970522642, 15.991699194535613, 11.51102827986081, 10.849922915299729, 11.505957042177513, 21.627584295968205, 21.18378051618734, 21.890352378288895, 14.675476029515266, 14.539792090654373, 14.726351276040077, 12.398390889167786, 12.775764300487936, 12.614979285746813, 15.449968771388129, 15.5404149548461, 15.209827934702233, 20.802782500783593, 20.963614402959735, 20.58107706407705, 15.570344664156437, 15.777269480749965, 15.763393174856901, 22.880268993477017, 23.127262566859514, 22.327356005708367, 20.936349684993417, 21.404457631792553, 20.966068523625523, 16.387536868453026, 16.662466272711754, 16.627261869609356, 14.238844784597546, 14.132184880475194, 14.231125126282365, 18.224361474315316, 18.42261905844012, 18.546627937505633, 22.04893833398819, 21.640294551849365, 22.250338181853294, 21.73721420764923, 22.029188249260187, 21.65982323884964, 21.364758548637226, 21.115791847308472, 21.483815417935446, 5.113128776351601, 5.202659404526145, 5.391232449250907, 17.472982729474694, 18.044910139093787, 17.843638795117528, 15.71930046131213, 16.034364280601338, 16.303493978300438, 14.439051564782858, 14.475134130567312, 14.391280397772789, 23.538228122207016, 23.270101847747952, 23.13975468526283, 16.300824463367462, 16.84415816515684, 16.944229520857334, 24.406635642051697, 24.45719386637211, 24.75269595347345, 28.793652310967445, 28.73814168572426, 29.077352836728096, 16.886321298778057, 17.10997373983264, 16.376802876591682, 18.57814625153938, 18.439304309586674, 18.66583219046393, 14.263595948616654, 14.463992650310189, 14.62240436176458, 19.73749128480752, 19.961841342349842, 20.07747846965988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14440212188670326, "mean_inference_ms": 0.6436445089172069, "mean_action_processing_ms": 0.09473873841459973, "mean_env_wait_ms": 0.8048497016122499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 494400, "timesteps_this_iter": 0, "agent_timesteps_total": 1483200, "timers": {"sample_time_ms": 9961.968, "sample_throughput": 481.833, "load_time_ms": 0.2, "load_throughput": 24010327.013, "learn_time_ms": 1167.927, "learn_throughput": 4109.845, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 4.547573506832123, "policy_loss": 0.0012881803105604939, "vf_loss": 4.669960856437683, "vf_explained_var": -0.03398321568965912, "kl": 0.011741859198202542, "entropy": 12.4145747423172, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 494400, "num_agent_steps_sampled": 1483200, "num_steps_trained": 494400, "num_agent_steps_trained": 1483200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2577, "training_iteration": 103, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-58-50", "timestamp": 1706147930, "time_this_iter_s": 9.445998907089233, "time_total_s": 970.9788801670074, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000537430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 970.9788801670074, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 6.661538461538461, "ram_util_percent": 47.58461538461539}}
{"episode_reward_max": 86.6091468334198, "episode_reward_min": 15.707020630128653, "episode_reward_mean": 51.519545931946475, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.113128776351601}, "policy_reward_max": {"shared_policy": 29.077352836728096}, "policy_reward_mean": {"shared_policy": 17.17318197731549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.32692296244204, 20.81837528944014, 36.05263213859868, 33.58338958583769, 40.07083296868947, 63.510233016218976, 52.914746465627076, 41.75416091457008, 31.61806369619444, 58.09240475110707, 24.533439188497113, 48.805726161226616, 81.94636020436883, 22.355034969747052, 49.16952896880683, 44.352295793592916, 44.800992933800444, 49.717685857787714, 59.01125021278858, 63.93462473154065, 51.04930801549925, 28.024659123970167, 61.47002496942878, 51.884787529706955, 80.36604285985231, 44.680664815008626, 47.04489925503731, 60.71964986622332, 42.785701893270016, 67.33156779746058, 26.123785845702486, 48.562223158776746, 39.62985561601815, 30.654828504659235, 38.77298829704522, 67.62329175509512, 45.48934329301119, 38.971479224041076, 67.04011528752743, 44.407492836005986, 39.02031454443929, 67.94035629183053, 45.51392062206287, 35.60152449458836, 57.5731248743832, 56.280137687921524, 76.68410401046276, 27.233200289308996, 72.86620339751244, 47.44654831616205, 60.1103415545076, 35.23323980066925, 52.47531633637844, 53.16836287913608, 82.33644511178136, 56.824303127825246, 47.5567416343838, 33.86690823733805, 64.70171719044444, 43.94161939620972, 37.789134475402534, 46.20021166093646, 62.34747396782038, 47.1110073197633, 68.3348875660449, 63.30687584041149, 49.677265010774136, 42.602154791355105, 55.19360847026107, 65.93957106769085, 65.42622569575906, 63.964365813881145, 15.707020630128653, 53.36153166368601, 48.057158720213906, 43.30546609312296, 69.9480846552178, 50.08921214938164, 73.61652546189725, 86.6091468334198, 50.37309791520238, 55.683282751589985, 43.349992960691424, 59.77681109681724, 51.816167782992125, 68.98185319453475, 39.84677074477075, 41.48171552922574, 68.01772692799565, 51.26234951615332, 59.52206823136656, 44.08672861009835, 54.981078117154524, 64.95519192609936, 57.89197426475582, 31.194620974361882, 45.03630317747593, 59.88575284322724, 66.58494771830736, 67.26339047309008], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.527667202055454, 18.728689761832356, 18.07056599855423, 7.060124990840748, 6.694481452306107, 7.063768846293286, 11.885991791884095, 12.293026576905191, 11.873613769809396, 11.126081502685935, 11.183800945679337, 11.273507137472421, 13.096901195744664, 13.558509390490741, 13.415422382454068, 21.122406116997198, 21.2060114404497, 21.18181545877208, 17.70581327813366, 17.792655031351984, 17.41627815614143, 13.640761350591973, 14.183100343992308, 13.930299219985798, 10.254248887300491, 10.813900880981237, 10.549913927912712, 19.577209793652088, 19.243666792909295, 19.271528164545686, 7.961728433767945, 8.369120249447093, 8.202590505282075, 16.093106394012764, 16.143469524880246, 16.569150242333606, 27.70285015180707, 26.923557475209236, 27.319952577352524, 7.039143835504845, 7.659236287077263, 7.656654847164944, 16.571877246276316, 16.502560329933956, 16.095091392596558, 14.957919177909687, 14.574114737411335, 14.820261878271893, 15.306599220028147, 14.981774903833866, 14.51261880993843, 16.17143279810746, 16.85923889217277, 16.687014167507485, 19.306112676858902, 20.012394785881042, 19.692742750048637, 21.16401446859041, 21.515149566034466, 21.255460696915776, 16.994179387887314, 17.102745488130793, 16.952383139481142, 9.010875354210526, 9.533342879653588, 9.480440890106053, 20.46809569373727, 20.61124859750271, 20.3906806781888, 17.563700433820486, 17.60999547317624, 16.711091622710228, 26.437511086463928, 26.94523797929287, 26.983293794095516, 14.713018355270222, 14.974494451036051, 14.993152008702353, 15.837610132992268, 15.732868269085884, 15.474420852959156, 20.44869990398486, 20.46982006480296, 19.8011298974355, 14.308180756866932, 14.654416054487228, 13.823105081915855, 22.29662275065978, 22.737128340600364, 22.297816706200436, 8.10267614821592, 8.949357296029717, 9.071752401456848, 15.935042349000767, 16.323953454693154, 16.303227355082825, 13.072630646328122, 13.532023229325802, 13.025201740364224, 10.267169136554003, 10.284432173706591, 10.103227194398642, 13.13213725139697, 12.38369271655877, 13.257158329089478, 22.58774816803634, 22.459287744015455, 22.576255843043327, 15.136576890945435, 15.417601577937603, 14.935164824128151, 12.710133398572594, 13.12245779313767, 13.138888032330811, 22.514262742673353, 22.160097075005368, 22.365755469848708, 14.877371740527451, 14.718606904149055, 14.81151419132948, 13.151834207276494, 13.13306477914253, 12.735415558020264, 22.687985626359776, 22.77611057211955, 22.4762600933512, 15.564440706861205, 15.227848567068577, 14.721631348133087, 11.938336612035826, 11.637387228508786, 12.02580065404375, 19.240665794660643, 19.099265602727726, 19.233193476994828, 18.571862906217575, 19.13995410501957, 18.56832067668438, 25.395146816968918, 25.50293079018593, 25.786026403307915, 9.076479385296494, 9.093308235208184, 9.063412668804318, 24.330608405172825, 24.499423809349537, 24.036171182990074, 15.971154040579364, 15.505728306869656, 15.96966596871303, 19.93681117643912, 20.127636741225913, 20.045893636842564, 11.898279630579054, 11.498273134231567, 11.836687035858631, 17.319923033316925, 17.367698428531483, 17.787694874530033, 17.58766213307777, 17.795629873503145, 17.785070872555167, 27.449268523603678, 27.297036305069923, 27.590140283107758, 18.813287903865174, 18.911736020197466, 19.099279203762606, 15.820014469325542, 15.745027970522642, 15.991699194535613, 11.51102827986081, 10.849922915299729, 11.505957042177513, 21.627584295968205, 21.18378051618734, 21.890352378288895, 14.675476029515266, 14.539792090654373, 14.726351276040077, 12.398390889167786, 12.775764300487936, 12.614979285746813, 15.449968771388129, 15.5404149548461, 15.209827934702233, 20.802782500783593, 20.963614402959735, 20.58107706407705, 15.570344664156437, 15.777269480749965, 15.763393174856901, 22.880268993477017, 23.127262566859514, 22.327356005708367, 20.936349684993417, 21.404457631792553, 20.966068523625523, 16.387536868453026, 16.662466272711754, 16.627261869609356, 14.238844784597546, 14.132184880475194, 14.231125126282365, 18.224361474315316, 18.42261905844012, 18.546627937505633, 22.04893833398819, 21.640294551849365, 22.250338181853294, 21.73721420764923, 22.029188249260187, 21.65982323884964, 21.364758548637226, 21.115791847308472, 21.483815417935446, 5.113128776351601, 5.202659404526145, 5.391232449250907, 17.472982729474694, 18.044910139093787, 17.843638795117528, 15.71930046131213, 16.034364280601338, 16.303493978300438, 14.439051564782858, 14.475134130567312, 14.391280397772789, 23.538228122207016, 23.270101847747952, 23.13975468526283, 16.300824463367462, 16.84415816515684, 16.944229520857334, 24.406635642051697, 24.45719386637211, 24.75269595347345, 28.793652310967445, 28.73814168572426, 29.077352836728096, 16.886321298778057, 17.10997373983264, 16.376802876591682, 18.57814625153938, 18.439304309586674, 18.66583219046393, 14.263595948616654, 14.463992650310189, 14.62240436176458, 19.73749128480752, 19.961841342349842, 20.07747846965988, 17.32014635205269, 17.40145969763398, 17.094561733305454, 23.08130898574987, 23.004581453899533, 22.895962754885346, 13.33783285071452, 12.973431771000222, 13.53550612305601, 14.171984830560774, 13.892656440536172, 13.417074258128793, 22.29174172381559, 22.62542391071716, 23.100561293462903, 17.06040572126706, 17.08282097925742, 17.11912281562884, 19.886894976099327, 20.25443578169991, 19.380737473567322, 14.920300429066018, 14.328041856487587, 14.838386324544743, 18.11739808817704, 18.16850523402293, 18.695174794954553, 21.75198465026915, 21.814820318482816, 21.388386957347393, 19.362049569065363, 19.21691511819759, 19.313009577492863, 10.498841313024357, 10.229723398884133, 10.466056262453392, 15.080733187496662, 14.96531244367361, 14.990257546305656, 20.03553368872963, 20.030615346273407, 19.8196038082242, 22.20400944476326, 22.248967505370572, 22.13197076817353, 22.703935580017657, 22.18984520683685, 22.369609686235577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1443854551635981, "mean_inference_ms": 0.6439392929426272, "mean_action_processing_ms": 0.09477165709020881, "mean_env_wait_ms": 0.8049311180637807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 499200, "timesteps_this_iter": 0, "agent_timesteps_total": 1497600, "timers": {"sample_time_ms": 9983.233, "sample_throughput": 480.806, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1168.728, "learn_throughput": 4107.03, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 3.9455921351909637, "policy_loss": 0.004424781880419282, "vf_loss": 4.067894399166107, "vf_explained_var": -0.08014018833637238, "kl": 0.014535480062604578, "entropy": 12.730908989906311, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 499200, "num_agent_steps_sampled": 1497600, "num_steps_trained": 499200, "num_agent_steps_trained": 1497600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2593, "training_iteration": 104, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-58-59", "timestamp": 1706147939, "time_this_iter_s": 9.59192943572998, "time_total_s": 980.5708096027374, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 980.5708096027374, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 47.27857142857143}}
{"episode_reward_max": 86.6091468334198, "episode_reward_min": 15.707020630128653, "episode_reward_mean": 53.090686640329075, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.113128776351601}, "policy_reward_max": {"shared_policy": 29.077352836728096}, "policy_reward_mean": {"shared_policy": 17.696895546776354}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.800992933800444, 49.717685857787714, 59.01125021278858, 63.93462473154065, 51.04930801549925, 28.024659123970167, 61.47002496942878, 51.884787529706955, 80.36604285985231, 44.680664815008626, 47.04489925503731, 60.71964986622332, 42.785701893270016, 67.33156779746058, 26.123785845702486, 48.562223158776746, 39.62985561601815, 30.654828504659235, 38.77298829704522, 67.62329175509512, 45.48934329301119, 38.971479224041076, 67.04011528752743, 44.407492836005986, 39.02031454443929, 67.94035629183053, 45.51392062206287, 35.60152449458836, 57.5731248743832, 56.280137687921524, 76.68410401046276, 27.233200289308996, 72.86620339751244, 47.44654831616205, 60.1103415545076, 35.23323980066925, 52.47531633637844, 53.16836287913608, 82.33644511178136, 56.824303127825246, 47.5567416343838, 33.86690823733805, 64.70171719044444, 43.94161939620972, 37.789134475402534, 46.20021166093646, 62.34747396782038, 47.1110073197633, 68.3348875660449, 63.30687584041149, 49.677265010774136, 42.602154791355105, 55.19360847026107, 65.93957106769085, 65.42622569575906, 63.964365813881145, 15.707020630128653, 53.36153166368601, 48.057158720213906, 43.30546609312296, 69.9480846552178, 50.08921214938164, 73.61652546189725, 86.6091468334198, 50.37309791520238, 55.683282751589985, 43.349992960691424, 59.77681109681724, 51.816167782992125, 68.98185319453475, 39.84677074477075, 41.48171552922574, 68.01772692799565, 51.26234951615332, 59.52206823136656, 44.08672861009835, 54.981078117154524, 64.95519192609936, 57.89197426475582, 31.194620974361882, 45.03630317747593, 59.88575284322724, 66.58494771830736, 67.26339047309008, 40.62948411703108, 42.21060954779385, 77.79392258077857, 52.68546071089801, 52.61306227371095, 42.095916103571625, 71.4778356440365, 36.84921080758795, 46.0380783230066, 56.35369935631749, 47.86324884928763, 42.046339271590114, 61.53685340844093, 79.8648767612176, 71.72287671267985, 40.23674344527532], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.306599220028147, 14.981774903833866, 14.51261880993843, 16.17143279810746, 16.85923889217277, 16.687014167507485, 19.306112676858902, 20.012394785881042, 19.692742750048637, 21.16401446859041, 21.515149566034466, 21.255460696915776, 16.994179387887314, 17.102745488130793, 16.952383139481142, 9.010875354210526, 9.533342879653588, 9.480440890106053, 20.46809569373727, 20.61124859750271, 20.3906806781888, 17.563700433820486, 17.60999547317624, 16.711091622710228, 26.437511086463928, 26.94523797929287, 26.983293794095516, 14.713018355270222, 14.974494451036051, 14.993152008702353, 15.837610132992268, 15.732868269085884, 15.474420852959156, 20.44869990398486, 20.46982006480296, 19.8011298974355, 14.308180756866932, 14.654416054487228, 13.823105081915855, 22.29662275065978, 22.737128340600364, 22.297816706200436, 8.10267614821592, 8.949357296029717, 9.071752401456848, 15.935042349000767, 16.323953454693154, 16.303227355082825, 13.072630646328122, 13.532023229325802, 13.025201740364224, 10.267169136554003, 10.284432173706591, 10.103227194398642, 13.13213725139697, 12.38369271655877, 13.257158329089478, 22.58774816803634, 22.459287744015455, 22.576255843043327, 15.136576890945435, 15.417601577937603, 14.935164824128151, 12.710133398572594, 13.12245779313767, 13.138888032330811, 22.514262742673353, 22.160097075005368, 22.365755469848708, 14.877371740527451, 14.718606904149055, 14.81151419132948, 13.151834207276494, 13.13306477914253, 12.735415558020264, 22.687985626359776, 22.77611057211955, 22.4762600933512, 15.564440706861205, 15.227848567068577, 14.721631348133087, 11.938336612035826, 11.637387228508786, 12.02580065404375, 19.240665794660643, 19.099265602727726, 19.233193476994828, 18.571862906217575, 19.13995410501957, 18.56832067668438, 25.395146816968918, 25.50293079018593, 25.786026403307915, 9.076479385296494, 9.093308235208184, 9.063412668804318, 24.330608405172825, 24.499423809349537, 24.036171182990074, 15.971154040579364, 15.505728306869656, 15.96966596871303, 19.93681117643912, 20.127636741225913, 20.045893636842564, 11.898279630579054, 11.498273134231567, 11.836687035858631, 17.319923033316925, 17.367698428531483, 17.787694874530033, 17.58766213307777, 17.795629873503145, 17.785070872555167, 27.449268523603678, 27.297036305069923, 27.590140283107758, 18.813287903865174, 18.911736020197466, 19.099279203762606, 15.820014469325542, 15.745027970522642, 15.991699194535613, 11.51102827986081, 10.849922915299729, 11.505957042177513, 21.627584295968205, 21.18378051618734, 21.890352378288895, 14.675476029515266, 14.539792090654373, 14.726351276040077, 12.398390889167786, 12.775764300487936, 12.614979285746813, 15.449968771388129, 15.5404149548461, 15.209827934702233, 20.802782500783593, 20.963614402959735, 20.58107706407705, 15.570344664156437, 15.777269480749965, 15.763393174856901, 22.880268993477017, 23.127262566859514, 22.327356005708367, 20.936349684993417, 21.404457631792553, 20.966068523625523, 16.387536868453026, 16.662466272711754, 16.627261869609356, 14.238844784597546, 14.132184880475194, 14.231125126282365, 18.224361474315316, 18.42261905844012, 18.546627937505633, 22.04893833398819, 21.640294551849365, 22.250338181853294, 21.73721420764923, 22.029188249260187, 21.65982323884964, 21.364758548637226, 21.115791847308472, 21.483815417935446, 5.113128776351601, 5.202659404526145, 5.391232449250907, 17.472982729474694, 18.044910139093787, 17.843638795117528, 15.71930046131213, 16.034364280601338, 16.303493978300438, 14.439051564782858, 14.475134130567312, 14.391280397772789, 23.538228122207016, 23.270101847747952, 23.13975468526283, 16.300824463367462, 16.84415816515684, 16.944229520857334, 24.406635642051697, 24.45719386637211, 24.75269595347345, 28.793652310967445, 28.73814168572426, 29.077352836728096, 16.886321298778057, 17.10997373983264, 16.376802876591682, 18.57814625153938, 18.439304309586674, 18.66583219046393, 14.263595948616654, 14.463992650310189, 14.62240436176458, 19.73749128480752, 19.961841342349842, 20.07747846965988, 17.32014635205269, 17.40145969763398, 17.094561733305454, 23.08130898574987, 23.004581453899533, 22.895962754885346, 13.33783285071452, 12.973431771000222, 13.53550612305601, 14.171984830560774, 13.892656440536172, 13.417074258128793, 22.29174172381559, 22.62542391071716, 23.100561293462903, 17.06040572126706, 17.08282097925742, 17.11912281562884, 19.886894976099327, 20.25443578169991, 19.380737473567322, 14.920300429066018, 14.328041856487587, 14.838386324544743, 18.11739808817704, 18.16850523402293, 18.695174794954553, 21.75198465026915, 21.814820318482816, 21.388386957347393, 19.362049569065363, 19.21691511819759, 19.313009577492863, 10.498841313024357, 10.229723398884133, 10.466056262453392, 15.080733187496662, 14.96531244367361, 14.990257546305656, 20.03553368872963, 20.030615346273407, 19.8196038082242, 22.20400944476326, 22.248967505370572, 22.13197076817353, 22.703935580017657, 22.18984520683685, 22.369609686235577, 13.600676377614334, 13.704594617088631, 13.324213122328118, 13.82763861616452, 14.200852391620472, 14.182118540008858, 26.04283783833185, 25.607053528229386, 26.144031214217335, 17.46378284941116, 17.852142584199697, 17.369535277287156, 17.741825484981135, 17.540548888345555, 17.330687900384262, 13.672635356585175, 13.954983527461678, 14.468297219524771, 23.692717018226773, 23.93085239144662, 23.85426623436311, 12.388869417831302, 12.499335336964577, 11.961006052792072, 15.359499687949807, 15.235072607795388, 15.443506027261407, 19.05370136598745, 18.8191684881846, 18.48082950214544, 15.700069949030876, 16.355694526806474, 15.80748437345028, 14.04345402866602, 14.351114830002189, 13.651770412921906, 19.905422066648796, 20.931695911412433, 20.699735430379704, 26.556874986737967, 26.484442956745625, 26.82355881773401, 24.385007975002125, 23.83603586008151, 23.501832877596215, 13.280891391138226, 13.38747503856817, 13.568377015568927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14436698407067006, "mean_inference_ms": 0.6442183027223638, "mean_action_processing_ms": 0.09479684913201254, "mean_env_wait_ms": 0.8050194839741969, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 504000, "timesteps_this_iter": 0, "agent_timesteps_total": 1512000, "timers": {"sample_time_ms": 9983.767, "sample_throughput": 480.78, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1175.915, "learn_throughput": 4081.926, "update_time_ms": 1.399}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 5.148130893707275, "policy_loss": 0.00029299226660645106, "vf_loss": 5.273607134819031, "vf_explained_var": -0.055068567395210266, "kl": 0.010119403072292338, "entropy": 12.617439270019531, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 504000, "num_agent_steps_sampled": 1512000, "num_steps_trained": 504000, "num_agent_steps_trained": 1512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2609, "training_iteration": 105, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-59-09", "timestamp": 1706147949, "time_this_iter_s": 9.413115501403809, "time_total_s": 989.9839251041412, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1C9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 989.9839251041412, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 9.123076923076924, "ram_util_percent": 47.13846153846154}}
{"episode_reward_max": 86.6091468334198, "episode_reward_min": 15.707020630128653, "episode_reward_mean": 54.27146719260432, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.113128776351601}, "policy_reward_max": {"shared_policy": 29.077352836728096}, "policy_reward_mean": {"shared_policy": 18.090489064201435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.62985561601815, 30.654828504659235, 38.77298829704522, 67.62329175509512, 45.48934329301119, 38.971479224041076, 67.04011528752743, 44.407492836005986, 39.02031454443929, 67.94035629183053, 45.51392062206287, 35.60152449458836, 57.5731248743832, 56.280137687921524, 76.68410401046276, 27.233200289308996, 72.86620339751244, 47.44654831616205, 60.1103415545076, 35.23323980066925, 52.47531633637844, 53.16836287913608, 82.33644511178136, 56.824303127825246, 47.5567416343838, 33.86690823733805, 64.70171719044444, 43.94161939620972, 37.789134475402534, 46.20021166093646, 62.34747396782038, 47.1110073197633, 68.3348875660449, 63.30687584041149, 49.677265010774136, 42.602154791355105, 55.19360847026107, 65.93957106769085, 65.42622569575906, 63.964365813881145, 15.707020630128653, 53.36153166368601, 48.057158720213906, 43.30546609312296, 69.9480846552178, 50.08921214938164, 73.61652546189725, 86.6091468334198, 50.37309791520238, 55.683282751589985, 43.349992960691424, 59.77681109681724, 51.816167782992125, 68.98185319453475, 39.84677074477075, 41.48171552922574, 68.01772692799565, 51.26234951615332, 59.52206823136656, 44.08672861009835, 54.981078117154524, 64.95519192609936, 57.89197426475582, 31.194620974361882, 45.03630317747593, 59.88575284322724, 66.58494771830736, 67.26339047309008, 40.62948411703108, 42.21060954779385, 77.79392258077857, 52.68546071089801, 52.61306227371095, 42.095916103571625, 71.4778356440365, 36.84921080758795, 46.0380783230066, 56.35369935631749, 47.86324884928763, 42.046339271590114, 61.53685340844093, 79.8648767612176, 71.72287671267985, 40.23674344527532, 59.58403914794323, 36.84064975939691, 64.87437658756969, 52.357010658830404, 59.96143681742251, 71.87351480126378, 74.60516313090918, 54.87210135976781, 47.43119165860115, 54.78375633619723, 62.21248609200117, 58.41718634031713, 66.55659500136971, 76.151986323297, 53.91046118363738, 51.15396889485416], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.072630646328122, 13.532023229325802, 13.025201740364224, 10.267169136554003, 10.284432173706591, 10.103227194398642, 13.13213725139697, 12.38369271655877, 13.257158329089478, 22.58774816803634, 22.459287744015455, 22.576255843043327, 15.136576890945435, 15.417601577937603, 14.935164824128151, 12.710133398572594, 13.12245779313767, 13.138888032330811, 22.514262742673353, 22.160097075005368, 22.365755469848708, 14.877371740527451, 14.718606904149055, 14.81151419132948, 13.151834207276494, 13.13306477914253, 12.735415558020264, 22.687985626359776, 22.77611057211955, 22.4762600933512, 15.564440706861205, 15.227848567068577, 14.721631348133087, 11.938336612035826, 11.637387228508786, 12.02580065404375, 19.240665794660643, 19.099265602727726, 19.233193476994828, 18.571862906217575, 19.13995410501957, 18.56832067668438, 25.395146816968918, 25.50293079018593, 25.786026403307915, 9.076479385296494, 9.093308235208184, 9.063412668804318, 24.330608405172825, 24.499423809349537, 24.036171182990074, 15.971154040579364, 15.505728306869656, 15.96966596871303, 19.93681117643912, 20.127636741225913, 20.045893636842564, 11.898279630579054, 11.498273134231567, 11.836687035858631, 17.319923033316925, 17.367698428531483, 17.787694874530033, 17.58766213307777, 17.795629873503145, 17.785070872555167, 27.449268523603678, 27.297036305069923, 27.590140283107758, 18.813287903865174, 18.911736020197466, 19.099279203762606, 15.820014469325542, 15.745027970522642, 15.991699194535613, 11.51102827986081, 10.849922915299729, 11.505957042177513, 21.627584295968205, 21.18378051618734, 21.890352378288895, 14.675476029515266, 14.539792090654373, 14.726351276040077, 12.398390889167786, 12.775764300487936, 12.614979285746813, 15.449968771388129, 15.5404149548461, 15.209827934702233, 20.802782500783593, 20.963614402959735, 20.58107706407705, 15.570344664156437, 15.777269480749965, 15.763393174856901, 22.880268993477017, 23.127262566859514, 22.327356005708367, 20.936349684993417, 21.404457631792553, 20.966068523625523, 16.387536868453026, 16.662466272711754, 16.627261869609356, 14.238844784597546, 14.132184880475194, 14.231125126282365, 18.224361474315316, 18.42261905844012, 18.546627937505633, 22.04893833398819, 21.640294551849365, 22.250338181853294, 21.73721420764923, 22.029188249260187, 21.65982323884964, 21.364758548637226, 21.115791847308472, 21.483815417935446, 5.113128776351601, 5.202659404526145, 5.391232449250907, 17.472982729474694, 18.044910139093787, 17.843638795117528, 15.71930046131213, 16.034364280601338, 16.303493978300438, 14.439051564782858, 14.475134130567312, 14.391280397772789, 23.538228122207016, 23.270101847747952, 23.13975468526283, 16.300824463367462, 16.84415816515684, 16.944229520857334, 24.406635642051697, 24.45719386637211, 24.75269595347345, 28.793652310967445, 28.73814168572426, 29.077352836728096, 16.886321298778057, 17.10997373983264, 16.376802876591682, 18.57814625153938, 18.439304309586674, 18.66583219046393, 14.263595948616654, 14.463992650310189, 14.62240436176458, 19.73749128480752, 19.961841342349842, 20.07747846965988, 17.32014635205269, 17.40145969763398, 17.094561733305454, 23.08130898574987, 23.004581453899533, 22.895962754885346, 13.33783285071452, 12.973431771000222, 13.53550612305601, 14.171984830560774, 13.892656440536172, 13.417074258128793, 22.29174172381559, 22.62542391071716, 23.100561293462903, 17.06040572126706, 17.08282097925742, 17.11912281562884, 19.886894976099327, 20.25443578169991, 19.380737473567322, 14.920300429066018, 14.328041856487587, 14.838386324544743, 18.11739808817704, 18.16850523402293, 18.695174794954553, 21.75198465026915, 21.814820318482816, 21.388386957347393, 19.362049569065363, 19.21691511819759, 19.313009577492863, 10.498841313024357, 10.229723398884133, 10.466056262453392, 15.080733187496662, 14.96531244367361, 14.990257546305656, 20.03553368872963, 20.030615346273407, 19.8196038082242, 22.20400944476326, 22.248967505370572, 22.13197076817353, 22.703935580017657, 22.18984520683685, 22.369609686235577, 13.600676377614334, 13.704594617088631, 13.324213122328118, 13.82763861616452, 14.200852391620472, 14.182118540008858, 26.04283783833185, 25.607053528229386, 26.144031214217335, 17.46378284941116, 17.852142584199697, 17.369535277287156, 17.741825484981135, 17.540548888345555, 17.330687900384262, 13.672635356585175, 13.954983527461678, 14.468297219524771, 23.692717018226773, 23.93085239144662, 23.85426623436311, 12.388869417831302, 12.499335336964577, 11.961006052792072, 15.359499687949807, 15.235072607795388, 15.443506027261407, 19.05370136598745, 18.8191684881846, 18.48082950214544, 15.700069949030876, 16.355694526806474, 15.80748437345028, 14.04345402866602, 14.351114830002189, 13.651770412921906, 19.905422066648796, 20.931695911412433, 20.699735430379704, 26.556874986737967, 26.484442956745625, 26.82355881773401, 24.385007975002125, 23.83603586008151, 23.501832877596215, 13.280891391138226, 13.38747503856817, 13.568377015568927, 19.83136216054359, 19.940905569742114, 19.811771417657525, 12.154885530471802, 12.488018264994025, 12.197745963931084, 21.46714363495508, 21.90584674725929, 21.501386205355317, 17.637156162410975, 17.155933648347855, 17.563920848071575, 19.640529990196228, 20.196625055745244, 20.124281771481037, 24.014294768373162, 23.772009859482438, 24.08721017340818, 24.756187970439584, 25.020145444820315, 24.828829715649277, 18.0674185330669, 18.425951422580198, 18.378731404120714, 16.002748231713966, 15.764395040770367, 15.664048386116818, 18.162192734579236, 18.24728564793864, 18.374277953679353, 21.019526599595935, 20.63675173620382, 20.556207756201417, 19.328838855028152, 19.494018897414207, 19.59432858787477, 22.080576486885548, 22.240318778902292, 22.235699735581875, 25.552025790015847, 25.276510434846074, 25.323450098435075, 17.821378529071808, 18.371015813201666, 17.718066841363907, 17.40302971440056, 16.93819699684778, 16.81274218360582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1443426501354739, "mean_inference_ms": 0.6445006046962862, "mean_action_processing_ms": 0.09482848954266014, "mean_env_wait_ms": 0.8051127679196824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 508800, "timesteps_this_iter": 0, "agent_timesteps_total": 1526400, "timers": {"sample_time_ms": 9982.815, "sample_throughput": 480.826, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1185.78, "learn_throughput": 4047.97, "update_time_ms": 1.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 4.4752039313316345, "policy_loss": 0.00242263442967261, "vf_loss": 4.597979784011841, "vf_explained_var": -0.05729350447654724, "kl": 0.011740321759258501, "entropy": 12.566848635673523, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 508800, "num_agent_steps_sampled": 1526400, "num_steps_trained": 508800, "num_agent_steps_trained": 1526400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2625, "training_iteration": 106, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-59-18", "timestamp": 1706147958, "time_this_iter_s": 9.359038829803467, "time_total_s": 999.3429639339447, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 999.3429639339447, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 7.561538461538461, "ram_util_percent": 47.10769230769232}}
{"episode_reward_max": 86.6091468334198, "episode_reward_min": 15.707020630128653, "episode_reward_mean": 55.16227670559368, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.113128776351601}, "policy_reward_max": {"shared_policy": 29.077352836728096}, "policy_reward_mean": {"shared_policy": 18.387425568531224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.86620339751244, 47.44654831616205, 60.1103415545076, 35.23323980066925, 52.47531633637844, 53.16836287913608, 82.33644511178136, 56.824303127825246, 47.5567416343838, 33.86690823733805, 64.70171719044444, 43.94161939620972, 37.789134475402534, 46.20021166093646, 62.34747396782038, 47.1110073197633, 68.3348875660449, 63.30687584041149, 49.677265010774136, 42.602154791355105, 55.19360847026107, 65.93957106769085, 65.42622569575906, 63.964365813881145, 15.707020630128653, 53.36153166368601, 48.057158720213906, 43.30546609312296, 69.9480846552178, 50.08921214938164, 73.61652546189725, 86.6091468334198, 50.37309791520238, 55.683282751589985, 43.349992960691424, 59.77681109681724, 51.816167782992125, 68.98185319453475, 39.84677074477075, 41.48171552922574, 68.01772692799565, 51.26234951615332, 59.52206823136656, 44.08672861009835, 54.981078117154524, 64.95519192609936, 57.89197426475582, 31.194620974361882, 45.03630317747593, 59.88575284322724, 66.58494771830736, 67.26339047309008, 40.62948411703108, 42.21060954779385, 77.79392258077857, 52.68546071089801, 52.61306227371095, 42.095916103571625, 71.4778356440365, 36.84921080758795, 46.0380783230066, 56.35369935631749, 47.86324884928763, 42.046339271590114, 61.53685340844093, 79.8648767612176, 71.72287671267985, 40.23674344527532, 59.58403914794323, 36.84064975939691, 64.87437658756969, 52.357010658830404, 59.96143681742251, 71.87351480126378, 74.60516313090918, 54.87210135976781, 47.43119165860115, 54.78375633619723, 62.21248609200117, 58.41718634031713, 66.55659500136971, 76.151986323297, 53.91046118363738, 51.15396889485416, 45.448451481759534, 36.24317888915539, 66.5519648659974, 65.39705542381853, 69.83534611202776, 59.282366868224926, 53.376237850636244, 59.22792641073464, 55.70563034713268, 40.647823149338336, 80.7673733178526, 36.895144727081046, 54.29742275585886, 59.85089574288574, 29.3262480664998, 54.66396291833368], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.330608405172825, 24.499423809349537, 24.036171182990074, 15.971154040579364, 15.505728306869656, 15.96966596871303, 19.93681117643912, 20.127636741225913, 20.045893636842564, 11.898279630579054, 11.498273134231567, 11.836687035858631, 17.319923033316925, 17.367698428531483, 17.787694874530033, 17.58766213307777, 17.795629873503145, 17.785070872555167, 27.449268523603678, 27.297036305069923, 27.590140283107758, 18.813287903865174, 18.911736020197466, 19.099279203762606, 15.820014469325542, 15.745027970522642, 15.991699194535613, 11.51102827986081, 10.849922915299729, 11.505957042177513, 21.627584295968205, 21.18378051618734, 21.890352378288895, 14.675476029515266, 14.539792090654373, 14.726351276040077, 12.398390889167786, 12.775764300487936, 12.614979285746813, 15.449968771388129, 15.5404149548461, 15.209827934702233, 20.802782500783593, 20.963614402959735, 20.58107706407705, 15.570344664156437, 15.777269480749965, 15.763393174856901, 22.880268993477017, 23.127262566859514, 22.327356005708367, 20.936349684993417, 21.404457631792553, 20.966068523625523, 16.387536868453026, 16.662466272711754, 16.627261869609356, 14.238844784597546, 14.132184880475194, 14.231125126282365, 18.224361474315316, 18.42261905844012, 18.546627937505633, 22.04893833398819, 21.640294551849365, 22.250338181853294, 21.73721420764923, 22.029188249260187, 21.65982323884964, 21.364758548637226, 21.115791847308472, 21.483815417935446, 5.113128776351601, 5.202659404526145, 5.391232449250907, 17.472982729474694, 18.044910139093787, 17.843638795117528, 15.71930046131213, 16.034364280601338, 16.303493978300438, 14.439051564782858, 14.475134130567312, 14.391280397772789, 23.538228122207016, 23.270101847747952, 23.13975468526283, 16.300824463367462, 16.84415816515684, 16.944229520857334, 24.406635642051697, 24.45719386637211, 24.75269595347345, 28.793652310967445, 28.73814168572426, 29.077352836728096, 16.886321298778057, 17.10997373983264, 16.376802876591682, 18.57814625153938, 18.439304309586674, 18.66583219046393, 14.263595948616654, 14.463992650310189, 14.62240436176458, 19.73749128480752, 19.961841342349842, 20.07747846965988, 17.32014635205269, 17.40145969763398, 17.094561733305454, 23.08130898574987, 23.004581453899533, 22.895962754885346, 13.33783285071452, 12.973431771000222, 13.53550612305601, 14.171984830560774, 13.892656440536172, 13.417074258128793, 22.29174172381559, 22.62542391071716, 23.100561293462903, 17.06040572126706, 17.08282097925742, 17.11912281562884, 19.886894976099327, 20.25443578169991, 19.380737473567322, 14.920300429066018, 14.328041856487587, 14.838386324544743, 18.11739808817704, 18.16850523402293, 18.695174794954553, 21.75198465026915, 21.814820318482816, 21.388386957347393, 19.362049569065363, 19.21691511819759, 19.313009577492863, 10.498841313024357, 10.229723398884133, 10.466056262453392, 15.080733187496662, 14.96531244367361, 14.990257546305656, 20.03553368872963, 20.030615346273407, 19.8196038082242, 22.20400944476326, 22.248967505370572, 22.13197076817353, 22.703935580017657, 22.18984520683685, 22.369609686235577, 13.600676377614334, 13.704594617088631, 13.324213122328118, 13.82763861616452, 14.200852391620472, 14.182118540008858, 26.04283783833185, 25.607053528229386, 26.144031214217335, 17.46378284941116, 17.852142584199697, 17.369535277287156, 17.741825484981135, 17.540548888345555, 17.330687900384262, 13.672635356585175, 13.954983527461678, 14.468297219524771, 23.692717018226773, 23.93085239144662, 23.85426623436311, 12.388869417831302, 12.499335336964577, 11.961006052792072, 15.359499687949807, 15.235072607795388, 15.443506027261407, 19.05370136598745, 18.8191684881846, 18.48082950214544, 15.700069949030876, 16.355694526806474, 15.80748437345028, 14.04345402866602, 14.351114830002189, 13.651770412921906, 19.905422066648796, 20.931695911412433, 20.699735430379704, 26.556874986737967, 26.484442956745625, 26.82355881773401, 24.385007975002125, 23.83603586008151, 23.501832877596215, 13.280891391138226, 13.38747503856817, 13.568377015568927, 19.83136216054359, 19.940905569742114, 19.811771417657525, 12.154885530471802, 12.488018264994025, 12.197745963931084, 21.46714363495508, 21.90584674725929, 21.501386205355317, 17.637156162410975, 17.155933648347855, 17.563920848071575, 19.640529990196228, 20.196625055745244, 20.124281771481037, 24.014294768373162, 23.772009859482438, 24.08721017340818, 24.756187970439584, 25.020145444820315, 24.828829715649277, 18.0674185330669, 18.425951422580198, 18.378731404120714, 16.002748231713966, 15.764395040770367, 15.664048386116818, 18.162192734579236, 18.24728564793864, 18.374277953679353, 21.019526599595935, 20.63675173620382, 20.556207756201417, 19.328838855028152, 19.494018897414207, 19.59432858787477, 22.080576486885548, 22.240318778902292, 22.235699735581875, 25.552025790015847, 25.276510434846074, 25.323450098435075, 17.821378529071808, 18.371015813201666, 17.718066841363907, 17.40302971440056, 16.93819699684778, 16.81274218360582, 15.168778409560517, 15.01744258900483, 15.262230483194188, 12.326562158763409, 11.74585984647274, 12.170756883919239, 22.282443240905792, 22.097452672819287, 22.172068952272326, 21.643902640789747, 21.869130777195096, 21.884022005833685, 23.132828444242477, 23.32018918171525, 23.382328486070037, 19.341895177960396, 19.890108097344637, 20.050363592919894, 17.93392264842987, 17.94988803192973, 17.492427170276642, 19.54948578526576, 19.71356001247962, 19.964880612989262, 18.7150274887681, 18.61887975782156, 18.371723100543022, 13.849327821905405, 13.414374279479176, 13.384121047953755, 27.137988168125347, 26.954012536754206, 26.67537261297305, 12.097379570206002, 12.634911523511008, 12.162853633364037, 18.2136204354465, 17.75645625591278, 18.32734606449958, 19.923172008867056, 19.886691516886145, 20.04103221713254, 10.168553662175924, 9.633973489205033, 9.523720915118844, 18.47781398675093, 18.039744327465684, 18.146404604117066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1443181864570191, "mean_inference_ms": 0.6447954501018285, "mean_action_processing_ms": 0.09486395777852766, "mean_env_wait_ms": 0.8052082900352935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 513600, "timesteps_this_iter": 0, "agent_timesteps_total": 1540800, "timers": {"sample_time_ms": 10024.409, "sample_throughput": 478.831, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1187.285, "learn_throughput": 4042.838, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 4.940603733062744, "policy_loss": -0.0001322067601914334, "vf_loss": 5.06578916311264, "vf_explained_var": -0.04942654073238373, "kl": 0.011512182856805171, "entropy": 12.551412582397461, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 513600, "num_agent_steps_sampled": 1540800, "num_steps_trained": 513600, "num_agent_steps_trained": 1540800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2641, "training_iteration": 107, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-59-28", "timestamp": 1706147968, "time_this_iter_s": 9.62259292602539, "time_total_s": 1008.9655568599701, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1CF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1008.9655568599701, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 6.385714285714286, "ram_util_percent": 47.27857142857142}}
{"episode_reward_max": 86.6091468334198, "episode_reward_min": 15.707020630128653, "episode_reward_mean": 55.97812621771619, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.113128776351601}, "policy_reward_max": {"shared_policy": 29.077352836728096}, "policy_reward_mean": {"shared_policy": 18.659375405905394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.3348875660449, 63.30687584041149, 49.677265010774136, 42.602154791355105, 55.19360847026107, 65.93957106769085, 65.42622569575906, 63.964365813881145, 15.707020630128653, 53.36153166368601, 48.057158720213906, 43.30546609312296, 69.9480846552178, 50.08921214938164, 73.61652546189725, 86.6091468334198, 50.37309791520238, 55.683282751589985, 43.349992960691424, 59.77681109681724, 51.816167782992125, 68.98185319453475, 39.84677074477075, 41.48171552922574, 68.01772692799565, 51.26234951615332, 59.52206823136656, 44.08672861009835, 54.981078117154524, 64.95519192609936, 57.89197426475582, 31.194620974361882, 45.03630317747593, 59.88575284322724, 66.58494771830736, 67.26339047309008, 40.62948411703108, 42.21060954779385, 77.79392258077857, 52.68546071089801, 52.61306227371095, 42.095916103571625, 71.4778356440365, 36.84921080758795, 46.0380783230066, 56.35369935631749, 47.86324884928763, 42.046339271590114, 61.53685340844093, 79.8648767612176, 71.72287671267985, 40.23674344527532, 59.58403914794323, 36.84064975939691, 64.87437658756969, 52.357010658830404, 59.96143681742251, 71.87351480126378, 74.60516313090918, 54.87210135976781, 47.43119165860115, 54.78375633619723, 62.21248609200117, 58.41718634031713, 66.55659500136971, 76.151986323297, 53.91046118363738, 51.15396889485416, 45.448451481759534, 36.24317888915539, 66.5519648659974, 65.39705542381853, 69.83534611202776, 59.282366868224926, 53.376237850636244, 59.22792641073464, 55.70563034713268, 40.647823149338336, 80.7673733178526, 36.895144727081046, 54.29742275585886, 59.85089574288574, 29.3262480664998, 54.66396291833368, 65.79652626439928, 66.01238769292829, 65.60084062814713, 50.32968393899499, 63.585904911160455, 55.1976204406528, 50.151417144341366, 76.80643445625901, 50.44003428891301, 48.67988098785281, 57.451040480285855, 66.77070362109224, 56.224639013409615, 54.35931946057826, 54.669934332370744, 43.4841579571366], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.880268993477017, 23.127262566859514, 22.327356005708367, 20.936349684993417, 21.404457631792553, 20.966068523625523, 16.387536868453026, 16.662466272711754, 16.627261869609356, 14.238844784597546, 14.132184880475194, 14.231125126282365, 18.224361474315316, 18.42261905844012, 18.546627937505633, 22.04893833398819, 21.640294551849365, 22.250338181853294, 21.73721420764923, 22.029188249260187, 21.65982323884964, 21.364758548637226, 21.115791847308472, 21.483815417935446, 5.113128776351601, 5.202659404526145, 5.391232449250907, 17.472982729474694, 18.044910139093787, 17.843638795117528, 15.71930046131213, 16.034364280601338, 16.303493978300438, 14.439051564782858, 14.475134130567312, 14.391280397772789, 23.538228122207016, 23.270101847747952, 23.13975468526283, 16.300824463367462, 16.84415816515684, 16.944229520857334, 24.406635642051697, 24.45719386637211, 24.75269595347345, 28.793652310967445, 28.73814168572426, 29.077352836728096, 16.886321298778057, 17.10997373983264, 16.376802876591682, 18.57814625153938, 18.439304309586674, 18.66583219046393, 14.263595948616654, 14.463992650310189, 14.62240436176458, 19.73749128480752, 19.961841342349842, 20.07747846965988, 17.32014635205269, 17.40145969763398, 17.094561733305454, 23.08130898574987, 23.004581453899533, 22.895962754885346, 13.33783285071452, 12.973431771000222, 13.53550612305601, 14.171984830560774, 13.892656440536172, 13.417074258128793, 22.29174172381559, 22.62542391071716, 23.100561293462903, 17.06040572126706, 17.08282097925742, 17.11912281562884, 19.886894976099327, 20.25443578169991, 19.380737473567322, 14.920300429066018, 14.328041856487587, 14.838386324544743, 18.11739808817704, 18.16850523402293, 18.695174794954553, 21.75198465026915, 21.814820318482816, 21.388386957347393, 19.362049569065363, 19.21691511819759, 19.313009577492863, 10.498841313024357, 10.229723398884133, 10.466056262453392, 15.080733187496662, 14.96531244367361, 14.990257546305656, 20.03553368872963, 20.030615346273407, 19.8196038082242, 22.20400944476326, 22.248967505370572, 22.13197076817353, 22.703935580017657, 22.18984520683685, 22.369609686235577, 13.600676377614334, 13.704594617088631, 13.324213122328118, 13.82763861616452, 14.200852391620472, 14.182118540008858, 26.04283783833185, 25.607053528229386, 26.144031214217335, 17.46378284941116, 17.852142584199697, 17.369535277287156, 17.741825484981135, 17.540548888345555, 17.330687900384262, 13.672635356585175, 13.954983527461678, 14.468297219524771, 23.692717018226773, 23.93085239144662, 23.85426623436311, 12.388869417831302, 12.499335336964577, 11.961006052792072, 15.359499687949807, 15.235072607795388, 15.443506027261407, 19.05370136598745, 18.8191684881846, 18.48082950214544, 15.700069949030876, 16.355694526806474, 15.80748437345028, 14.04345402866602, 14.351114830002189, 13.651770412921906, 19.905422066648796, 20.931695911412433, 20.699735430379704, 26.556874986737967, 26.484442956745625, 26.82355881773401, 24.385007975002125, 23.83603586008151, 23.501832877596215, 13.280891391138226, 13.38747503856817, 13.568377015568927, 19.83136216054359, 19.940905569742114, 19.811771417657525, 12.154885530471802, 12.488018264994025, 12.197745963931084, 21.46714363495508, 21.90584674725929, 21.501386205355317, 17.637156162410975, 17.155933648347855, 17.563920848071575, 19.640529990196228, 20.196625055745244, 20.124281771481037, 24.014294768373162, 23.772009859482438, 24.08721017340818, 24.756187970439584, 25.020145444820315, 24.828829715649277, 18.0674185330669, 18.425951422580198, 18.378731404120714, 16.002748231713966, 15.764395040770367, 15.664048386116818, 18.162192734579236, 18.24728564793864, 18.374277953679353, 21.019526599595935, 20.63675173620382, 20.556207756201417, 19.328838855028152, 19.494018897414207, 19.59432858787477, 22.080576486885548, 22.240318778902292, 22.235699735581875, 25.552025790015847, 25.276510434846074, 25.323450098435075, 17.821378529071808, 18.371015813201666, 17.718066841363907, 17.40302971440056, 16.93819699684778, 16.81274218360582, 15.168778409560517, 15.01744258900483, 15.262230483194188, 12.326562158763409, 11.74585984647274, 12.170756883919239, 22.282443240905792, 22.097452672819287, 22.172068952272326, 21.643902640789747, 21.869130777195096, 21.884022005833685, 23.132828444242477, 23.32018918171525, 23.382328486070037, 19.341895177960396, 19.890108097344637, 20.050363592919894, 17.93392264842987, 17.94988803192973, 17.492427170276642, 19.54948578526576, 19.71356001247962, 19.964880612989262, 18.7150274887681, 18.61887975782156, 18.371723100543022, 13.849327821905405, 13.414374279479176, 13.384121047953755, 27.137988168125347, 26.954012536754206, 26.67537261297305, 12.097379570206002, 12.634911523511008, 12.162853633364037, 18.2136204354465, 17.75645625591278, 18.32734606449958, 19.923172008867056, 19.886691516886145, 20.04103221713254, 10.168553662175924, 9.633973489205033, 9.523720915118844, 18.47781398675093, 18.039744327465684, 18.146404604117066, 21.98777826627095, 21.814886910219982, 21.993861087908343, 21.98702425012985, 21.681479478875787, 22.34388396392265, 22.031009517610073, 21.90916123241186, 21.66066987812519, 16.844651532669857, 16.612068248291806, 16.872964158033326, 21.313355838259056, 20.850269397099808, 21.42227967580159, 18.24991280088821, 18.27711062381664, 18.670597015947948, 16.94525536095412, 16.82892884189883, 16.377232941488415, 25.394788697361946, 25.738181430846453, 25.673464328050613, 16.88740875571966, 17.03653423115611, 16.51609130203724, 16.232788179069757, 16.26428511738777, 16.182807691395283, 19.013467783729226, 19.4345445173482, 19.003028179208428, 22.303099375062928, 22.322950093735315, 22.144654152293995, 18.77107372134924, 18.63866911828518, 18.814896173775196, 18.297668018378317, 17.759027488529682, 18.302623953670263, 17.957333539923027, 18.41895966728528, 18.293641125162438, 14.361827323834092, 14.545109967390687, 14.577220665911824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14427670730533554, "mean_inference_ms": 0.645006290942616, "mean_action_processing_ms": 0.0948852994065413, "mean_env_wait_ms": 0.805265414105442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 518400, "timesteps_this_iter": 0, "agent_timesteps_total": 1555200, "timers": {"sample_time_ms": 10037.505, "sample_throughput": 478.206, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1188.08, "learn_throughput": 4040.132, "update_time_ms": 1.599}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 4.370161712169647, "policy_loss": -0.00042933666089894906, "vf_loss": 4.494749486446381, "vf_explained_var": -0.05660957098007202, "kl": 0.00819227946352392, "entropy": 12.448650479316711, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 518400, "num_agent_steps_sampled": 1555200, "num_steps_trained": 518400, "num_agent_steps_trained": 1555200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2657, "training_iteration": 108, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-59-37", "timestamp": 1706147977, "time_this_iter_s": 9.323954105377197, "time_total_s": 1018.2895109653473, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1018.2895109653473, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 5.592307692307691, "ram_util_percent": 47.17692307692308}}
{"episode_reward_max": 84.31200050655751, "episode_reward_min": 29.3262480664998, "episode_reward_mean": 56.9287814918012, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.523720915118844}, "policy_reward_max": {"shared_policy": 28.24231942890522}, "policy_reward_mean": {"shared_policy": 18.97626049726706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.37309791520238, 55.683282751589985, 43.349992960691424, 59.77681109681724, 51.816167782992125, 68.98185319453475, 39.84677074477075, 41.48171552922574, 68.01772692799565, 51.26234951615332, 59.52206823136656, 44.08672861009835, 54.981078117154524, 64.95519192609936, 57.89197426475582, 31.194620974361882, 45.03630317747593, 59.88575284322724, 66.58494771830736, 67.26339047309008, 40.62948411703108, 42.21060954779385, 77.79392258077857, 52.68546071089801, 52.61306227371095, 42.095916103571625, 71.4778356440365, 36.84921080758795, 46.0380783230066, 56.35369935631749, 47.86324884928763, 42.046339271590114, 61.53685340844093, 79.8648767612176, 71.72287671267985, 40.23674344527532, 59.58403914794323, 36.84064975939691, 64.87437658756969, 52.357010658830404, 59.96143681742251, 71.87351480126378, 74.60516313090918, 54.87210135976781, 47.43119165860115, 54.78375633619723, 62.21248609200117, 58.41718634031713, 66.55659500136971, 76.151986323297, 53.91046118363738, 51.15396889485416, 45.448451481759534, 36.24317888915539, 66.5519648659974, 65.39705542381853, 69.83534611202776, 59.282366868224926, 53.376237850636244, 59.22792641073464, 55.70563034713268, 40.647823149338336, 80.7673733178526, 36.895144727081046, 54.29742275585886, 59.85089574288574, 29.3262480664998, 54.66396291833368, 65.79652626439928, 66.01238769292829, 65.60084062814713, 50.32968393899499, 63.585904911160455, 55.1976204406528, 50.151417144341366, 76.80643445625901, 50.44003428891301, 48.67988098785281, 57.451040480285855, 66.77070362109224, 56.224639013409615, 54.35931946057826, 54.669934332370744, 43.4841579571366, 62.018654413521276, 49.748301026411326, 50.096374643966556, 76.09596828371286, 37.011844975873814, 84.04888738319278, 75.72861972684039, 63.81310314196159, 49.581510953605175, 54.76769593730569, 84.31200050655751, 60.44596624374388, 65.77260540425777, 58.334714181721196, 78.87420005816965, 59.55418099090454], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.886321298778057, 17.10997373983264, 16.376802876591682, 18.57814625153938, 18.439304309586674, 18.66583219046393, 14.263595948616654, 14.463992650310189, 14.62240436176458, 19.73749128480752, 19.961841342349842, 20.07747846965988, 17.32014635205269, 17.40145969763398, 17.094561733305454, 23.08130898574987, 23.004581453899533, 22.895962754885346, 13.33783285071452, 12.973431771000222, 13.53550612305601, 14.171984830560774, 13.892656440536172, 13.417074258128793, 22.29174172381559, 22.62542391071716, 23.100561293462903, 17.06040572126706, 17.08282097925742, 17.11912281562884, 19.886894976099327, 20.25443578169991, 19.380737473567322, 14.920300429066018, 14.328041856487587, 14.838386324544743, 18.11739808817704, 18.16850523402293, 18.695174794954553, 21.75198465026915, 21.814820318482816, 21.388386957347393, 19.362049569065363, 19.21691511819759, 19.313009577492863, 10.498841313024357, 10.229723398884133, 10.466056262453392, 15.080733187496662, 14.96531244367361, 14.990257546305656, 20.03553368872963, 20.030615346273407, 19.8196038082242, 22.20400944476326, 22.248967505370572, 22.13197076817353, 22.703935580017657, 22.18984520683685, 22.369609686235577, 13.600676377614334, 13.704594617088631, 13.324213122328118, 13.82763861616452, 14.200852391620472, 14.182118540008858, 26.04283783833185, 25.607053528229386, 26.144031214217335, 17.46378284941116, 17.852142584199697, 17.369535277287156, 17.741825484981135, 17.540548888345555, 17.330687900384262, 13.672635356585175, 13.954983527461678, 14.468297219524771, 23.692717018226773, 23.93085239144662, 23.85426623436311, 12.388869417831302, 12.499335336964577, 11.961006052792072, 15.359499687949807, 15.235072607795388, 15.443506027261407, 19.05370136598745, 18.8191684881846, 18.48082950214544, 15.700069949030876, 16.355694526806474, 15.80748437345028, 14.04345402866602, 14.351114830002189, 13.651770412921906, 19.905422066648796, 20.931695911412433, 20.699735430379704, 26.556874986737967, 26.484442956745625, 26.82355881773401, 24.385007975002125, 23.83603586008151, 23.501832877596215, 13.280891391138226, 13.38747503856817, 13.568377015568927, 19.83136216054359, 19.940905569742114, 19.811771417657525, 12.154885530471802, 12.488018264994025, 12.197745963931084, 21.46714363495508, 21.90584674725929, 21.501386205355317, 17.637156162410975, 17.155933648347855, 17.563920848071575, 19.640529990196228, 20.196625055745244, 20.124281771481037, 24.014294768373162, 23.772009859482438, 24.08721017340818, 24.756187970439584, 25.020145444820315, 24.828829715649277, 18.0674185330669, 18.425951422580198, 18.378731404120714, 16.002748231713966, 15.764395040770367, 15.664048386116818, 18.162192734579236, 18.24728564793864, 18.374277953679353, 21.019526599595935, 20.63675173620382, 20.556207756201417, 19.328838855028152, 19.494018897414207, 19.59432858787477, 22.080576486885548, 22.240318778902292, 22.235699735581875, 25.552025790015847, 25.276510434846074, 25.323450098435075, 17.821378529071808, 18.371015813201666, 17.718066841363907, 17.40302971440056, 16.93819699684778, 16.81274218360582, 15.168778409560517, 15.01744258900483, 15.262230483194188, 12.326562158763409, 11.74585984647274, 12.170756883919239, 22.282443240905792, 22.097452672819287, 22.172068952272326, 21.643902640789747, 21.869130777195096, 21.884022005833685, 23.132828444242477, 23.32018918171525, 23.382328486070037, 19.341895177960396, 19.890108097344637, 20.050363592919894, 17.93392264842987, 17.94988803192973, 17.492427170276642, 19.54948578526576, 19.71356001247962, 19.964880612989262, 18.7150274887681, 18.61887975782156, 18.371723100543022, 13.849327821905405, 13.414374279479176, 13.384121047953755, 27.137988168125347, 26.954012536754206, 26.67537261297305, 12.097379570206002, 12.634911523511008, 12.162853633364037, 18.2136204354465, 17.75645625591278, 18.32734606449958, 19.923172008867056, 19.886691516886145, 20.04103221713254, 10.168553662175924, 9.633973489205033, 9.523720915118844, 18.47781398675093, 18.039744327465684, 18.146404604117066, 21.98777826627095, 21.814886910219982, 21.993861087908343, 21.98702425012985, 21.681479478875787, 22.34388396392265, 22.031009517610073, 21.90916123241186, 21.66066987812519, 16.844651532669857, 16.612068248291806, 16.872964158033326, 21.313355838259056, 20.850269397099808, 21.42227967580159, 18.24991280088821, 18.27711062381664, 18.670597015947948, 16.94525536095412, 16.82892884189883, 16.377232941488415, 25.394788697361946, 25.738181430846453, 25.673464328050613, 16.88740875571966, 17.03653423115611, 16.51609130203724, 16.232788179069757, 16.26428511738777, 16.182807691395283, 19.013467783729226, 19.4345445173482, 19.003028179208428, 22.303099375062928, 22.322950093735315, 22.144654152293995, 18.77107372134924, 18.63866911828518, 18.814896173775196, 18.297668018378317, 17.759027488529682, 18.302623953670263, 17.957333539923027, 18.41895966728528, 18.293641125162438, 14.361827323834092, 14.545109967390687, 14.577220665911824, 20.638097186883286, 20.711319518585995, 20.669237708051995, 16.430005008975655, 16.39886802683273, 16.91942799060294, 16.747868072241545, 16.74664264731109, 16.60186392441392, 25.435948584228754, 25.099894896149635, 25.560124803334475, 12.4285681558152, 12.16303864618142, 12.420238173877195, 27.97329281270504, 28.04280311614275, 28.032791454344988, 25.487874764793858, 25.02002317210038, 25.220721789946154, 21.033227028946072, 21.16916551689306, 21.61071059612246, 16.710217088460922, 16.664830274879932, 16.20646359026432, 18.437512818723917, 18.32967257499695, 18.000510543584824, 28.24231942890522, 27.836508137484387, 28.233172940167904, 20.55877036352952, 20.215984498461083, 19.67121138175328, 21.98710859939456, 21.797435723245144, 21.98806108161807, 19.592619751890496, 19.336643767853573, 19.405450661977127, 26.076496874292687, 26.386860075717166, 26.410843108159796, 19.737276578942925, 19.763911361495644, 20.05299305046597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14423680725473845, "mean_inference_ms": 0.6451316378882058, "mean_action_processing_ms": 0.09490659562114191, "mean_env_wait_ms": 0.8052565405617104, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 523200, "timesteps_this_iter": 0, "agent_timesteps_total": 1569600, "timers": {"sample_time_ms": 9998.86, "sample_throughput": 480.055, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1187.28, "learn_throughput": 4042.856, "update_time_ms": 1.599}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 5.0182244181633, "policy_loss": 0.0034325682053652773, "vf_loss": 5.13763689994812, "vf_explained_var": -0.059893250465393066, "kl": 0.015353399911084243, "entropy": 12.346017003059387, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 523200, "num_agent_steps_sampled": 1569600, "num_steps_trained": 523200, "num_agent_steps_trained": 1569600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2673, "training_iteration": 109, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-59-46", "timestamp": 1706147986, "time_this_iter_s": 9.067421197891235, "time_total_s": 1027.3569321632385, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1027.3569321632385, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 6.9923076923076914, "ram_util_percent": 47.184615384615384}}
{"episode_reward_max": 84.31200050655751, "episode_reward_min": 29.3262480664998, "episode_reward_mean": 59.55818957011361, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.523720915118844}, "policy_reward_max": {"shared_policy": 28.24231942890522}, "policy_reward_mean": {"shared_policy": 19.85272985670453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.03630317747593, 59.88575284322724, 66.58494771830736, 67.26339047309008, 40.62948411703108, 42.21060954779385, 77.79392258077857, 52.68546071089801, 52.61306227371095, 42.095916103571625, 71.4778356440365, 36.84921080758795, 46.0380783230066, 56.35369935631749, 47.86324884928763, 42.046339271590114, 61.53685340844093, 79.8648767612176, 71.72287671267985, 40.23674344527532, 59.58403914794323, 36.84064975939691, 64.87437658756969, 52.357010658830404, 59.96143681742251, 71.87351480126378, 74.60516313090918, 54.87210135976781, 47.43119165860115, 54.78375633619723, 62.21248609200117, 58.41718634031713, 66.55659500136971, 76.151986323297, 53.91046118363738, 51.15396889485416, 45.448451481759534, 36.24317888915539, 66.5519648659974, 65.39705542381853, 69.83534611202776, 59.282366868224926, 53.376237850636244, 59.22792641073464, 55.70563034713268, 40.647823149338336, 80.7673733178526, 36.895144727081046, 54.29742275585886, 59.85089574288574, 29.3262480664998, 54.66396291833368, 65.79652626439928, 66.01238769292829, 65.60084062814713, 50.32968393899499, 63.585904911160455, 55.1976204406528, 50.151417144341366, 76.80643445625901, 50.44003428891301, 48.67988098785281, 57.451040480285855, 66.77070362109224, 56.224639013409615, 54.35931946057826, 54.669934332370744, 43.4841579571366, 62.018654413521276, 49.748301026411326, 50.096374643966556, 76.09596828371286, 37.011844975873814, 84.04888738319278, 75.72861972684039, 63.81310314196159, 49.581510953605175, 54.76769593730569, 84.31200050655751, 60.44596624374388, 65.77260540425777, 58.334714181721196, 78.87420005816965, 59.55418099090454, 71.674605762586, 70.39593880623579, 70.9760922938585, 71.85144267976284, 77.0200263634324, 70.56463706307113, 62.81680738925934, 55.028695002198205, 82.40782770887016, 61.03015488386151, 70.87887767702338, 78.25480922195126, 69.08739838004111, 57.51454976387319, 67.66387542244044, 68.99649995658545], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.080733187496662, 14.96531244367361, 14.990257546305656, 20.03553368872963, 20.030615346273407, 19.8196038082242, 22.20400944476326, 22.248967505370572, 22.13197076817353, 22.703935580017657, 22.18984520683685, 22.369609686235577, 13.600676377614334, 13.704594617088631, 13.324213122328118, 13.82763861616452, 14.200852391620472, 14.182118540008858, 26.04283783833185, 25.607053528229386, 26.144031214217335, 17.46378284941116, 17.852142584199697, 17.369535277287156, 17.741825484981135, 17.540548888345555, 17.330687900384262, 13.672635356585175, 13.954983527461678, 14.468297219524771, 23.692717018226773, 23.93085239144662, 23.85426623436311, 12.388869417831302, 12.499335336964577, 11.961006052792072, 15.359499687949807, 15.235072607795388, 15.443506027261407, 19.05370136598745, 18.8191684881846, 18.48082950214544, 15.700069949030876, 16.355694526806474, 15.80748437345028, 14.04345402866602, 14.351114830002189, 13.651770412921906, 19.905422066648796, 20.931695911412433, 20.699735430379704, 26.556874986737967, 26.484442956745625, 26.82355881773401, 24.385007975002125, 23.83603586008151, 23.501832877596215, 13.280891391138226, 13.38747503856817, 13.568377015568927, 19.83136216054359, 19.940905569742114, 19.811771417657525, 12.154885530471802, 12.488018264994025, 12.197745963931084, 21.46714363495508, 21.90584674725929, 21.501386205355317, 17.637156162410975, 17.155933648347855, 17.563920848071575, 19.640529990196228, 20.196625055745244, 20.124281771481037, 24.014294768373162, 23.772009859482438, 24.08721017340818, 24.756187970439584, 25.020145444820315, 24.828829715649277, 18.0674185330669, 18.425951422580198, 18.378731404120714, 16.002748231713966, 15.764395040770367, 15.664048386116818, 18.162192734579236, 18.24728564793864, 18.374277953679353, 21.019526599595935, 20.63675173620382, 20.556207756201417, 19.328838855028152, 19.494018897414207, 19.59432858787477, 22.080576486885548, 22.240318778902292, 22.235699735581875, 25.552025790015847, 25.276510434846074, 25.323450098435075, 17.821378529071808, 18.371015813201666, 17.718066841363907, 17.40302971440056, 16.93819699684778, 16.81274218360582, 15.168778409560517, 15.01744258900483, 15.262230483194188, 12.326562158763409, 11.74585984647274, 12.170756883919239, 22.282443240905792, 22.097452672819287, 22.172068952272326, 21.643902640789747, 21.869130777195096, 21.884022005833685, 23.132828444242477, 23.32018918171525, 23.382328486070037, 19.341895177960396, 19.890108097344637, 20.050363592919894, 17.93392264842987, 17.94988803192973, 17.492427170276642, 19.54948578526576, 19.71356001247962, 19.964880612989262, 18.7150274887681, 18.61887975782156, 18.371723100543022, 13.849327821905405, 13.414374279479176, 13.384121047953755, 27.137988168125347, 26.954012536754206, 26.67537261297305, 12.097379570206002, 12.634911523511008, 12.162853633364037, 18.2136204354465, 17.75645625591278, 18.32734606449958, 19.923172008867056, 19.886691516886145, 20.04103221713254, 10.168553662175924, 9.633973489205033, 9.523720915118844, 18.47781398675093, 18.039744327465684, 18.146404604117066, 21.98777826627095, 21.814886910219982, 21.993861087908343, 21.98702425012985, 21.681479478875787, 22.34388396392265, 22.031009517610073, 21.90916123241186, 21.66066987812519, 16.844651532669857, 16.612068248291806, 16.872964158033326, 21.313355838259056, 20.850269397099808, 21.42227967580159, 18.24991280088821, 18.27711062381664, 18.670597015947948, 16.94525536095412, 16.82892884189883, 16.377232941488415, 25.394788697361946, 25.738181430846453, 25.673464328050613, 16.88740875571966, 17.03653423115611, 16.51609130203724, 16.232788179069757, 16.26428511738777, 16.182807691395283, 19.013467783729226, 19.4345445173482, 19.003028179208428, 22.303099375062928, 22.322950093735315, 22.144654152293995, 18.77107372134924, 18.63866911828518, 18.814896173775196, 18.297668018378317, 17.759027488529682, 18.302623953670263, 17.957333539923027, 18.41895966728528, 18.293641125162438, 14.361827323834092, 14.545109967390687, 14.577220665911824, 20.638097186883286, 20.711319518585995, 20.669237708051995, 16.430005008975655, 16.39886802683273, 16.91942799060294, 16.747868072241545, 16.74664264731109, 16.60186392441392, 25.435948584228754, 25.099894896149635, 25.560124803334475, 12.4285681558152, 12.16303864618142, 12.420238173877195, 27.97329281270504, 28.04280311614275, 28.032791454344988, 25.487874764793858, 25.02002317210038, 25.220721789946154, 21.033227028946072, 21.16916551689306, 21.61071059612246, 16.710217088460922, 16.664830274879932, 16.20646359026432, 18.437512818723917, 18.32967257499695, 18.000510543584824, 28.24231942890522, 27.836508137484387, 28.233172940167904, 20.55877036352952, 20.215984498461083, 19.67121138175328, 21.98710859939456, 21.797435723245144, 21.98806108161807, 19.592619751890496, 19.336643767853573, 19.405450661977127, 26.076496874292687, 26.386860075717166, 26.410843108159796, 19.737276578942925, 19.763911361495644, 20.05299305046597, 23.7924622297287, 24.115096686407924, 23.767046846449375, 23.522788539528847, 23.274921394884586, 23.598228871822357, 23.681793908278138, 23.70316958675781, 23.591128798822552, 24.17024563997984, 23.644044771790504, 24.037152267992496, 25.940919515987233, 25.57124625643094, 25.50786059101422, 23.815445890650153, 23.122759982943535, 23.626431189477444, 21.11008793860674, 21.21666856855154, 20.49005088210106, 18.58752928798397, 18.62960685168703, 17.811558862527207, 27.26826876898606, 27.58947682132323, 27.550082118560866, 20.20905330280462, 20.573922055462987, 20.247179525593907, 23.840066629151494, 23.550073976318032, 23.488737071553857, 26.361840636857465, 25.72928101817766, 26.16368756691614, 23.170179945727185, 23.15231457104285, 22.764903863271073, 18.911931763092667, 19.430972893411905, 19.17164510736862, 22.27177223811546, 22.591961628446967, 22.800141555878014, 22.880539176364735, 22.933876131971672, 23.182084648249045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14418699502028673, "mean_inference_ms": 0.6452040846941608, "mean_action_processing_ms": 0.09491222967319424, "mean_env_wait_ms": 0.8051864358399982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 528000, "timesteps_this_iter": 0, "agent_timesteps_total": 1584000, "timers": {"sample_time_ms": 9993.245, "sample_throughput": 480.324, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1189.689, "learn_throughput": 4034.669, "update_time_ms": 1.599}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 5.524850845336914, "policy_loss": 0.0011612316306290893, "vf_loss": 5.646300137042999, "vf_explained_var": -0.05643308162689209, "kl": 0.00920670872449669, "entropy": 12.297954440116882, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 528000, "num_agent_steps_sampled": 1584000, "num_steps_trained": 528000, "num_agent_steps_trained": 1584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2689, "training_iteration": 110, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_02-59-56", "timestamp": 1706147996, "time_this_iter_s": 9.118794918060303, "time_total_s": 1036.4757270812988, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632F9A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1036.4757270812988, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 7.130769230769231, "ram_util_percent": 47.16923076923077}}
{"episode_reward_max": 105.32289139926432, "episode_reward_min": 29.3262480664998, "episode_reward_mean": 61.675580503355306, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.523720915118844}, "policy_reward_max": {"shared_policy": 35.28691192468007}, "policy_reward_mean": {"shared_policy": 20.55852683445176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.53685340844093, 79.8648767612176, 71.72287671267985, 40.23674344527532, 59.58403914794323, 36.84064975939691, 64.87437658756969, 52.357010658830404, 59.96143681742251, 71.87351480126378, 74.60516313090918, 54.87210135976781, 47.43119165860115, 54.78375633619723, 62.21248609200117, 58.41718634031713, 66.55659500136971, 76.151986323297, 53.91046118363738, 51.15396889485416, 45.448451481759534, 36.24317888915539, 66.5519648659974, 65.39705542381853, 69.83534611202776, 59.282366868224926, 53.376237850636244, 59.22792641073464, 55.70563034713268, 40.647823149338336, 80.7673733178526, 36.895144727081046, 54.29742275585886, 59.85089574288574, 29.3262480664998, 54.66396291833368, 65.79652626439928, 66.01238769292829, 65.60084062814713, 50.32968393899499, 63.585904911160455, 55.1976204406528, 50.151417144341366, 76.80643445625901, 50.44003428891301, 48.67988098785281, 57.451040480285855, 66.77070362109224, 56.224639013409615, 54.35931946057826, 54.669934332370744, 43.4841579571366, 62.018654413521276, 49.748301026411326, 50.096374643966556, 76.09596828371286, 37.011844975873814, 84.04888738319278, 75.72861972684039, 63.81310314196159, 49.581510953605175, 54.76769593730569, 84.31200050655751, 60.44596624374388, 65.77260540425777, 58.334714181721196, 78.87420005816965, 59.55418099090454, 71.674605762586, 70.39593880623579, 70.9760922938585, 71.85144267976284, 77.0200263634324, 70.56463706307113, 62.81680738925934, 55.028695002198205, 82.40782770887016, 61.03015488386151, 70.87887767702338, 78.25480922195126, 69.08739838004111, 57.51454976387319, 67.66387542244044, 68.99649995658545, 57.13999458076432, 63.15577907115218, 56.829301226418465, 71.54122033715247, 83.06113827228545, 105.32289139926432, 63.52690376341343, 51.078541358932824, 61.37711729481815, 57.35751321353017, 48.61743443459271, 37.70650079660116, 86.18973964266476, 73.32783230766654, 63.812860518693896, 79.12158690392968], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.905422066648796, 20.931695911412433, 20.699735430379704, 26.556874986737967, 26.484442956745625, 26.82355881773401, 24.385007975002125, 23.83603586008151, 23.501832877596215, 13.280891391138226, 13.38747503856817, 13.568377015568927, 19.83136216054359, 19.940905569742114, 19.811771417657525, 12.154885530471802, 12.488018264994025, 12.197745963931084, 21.46714363495508, 21.90584674725929, 21.501386205355317, 17.637156162410975, 17.155933648347855, 17.563920848071575, 19.640529990196228, 20.196625055745244, 20.124281771481037, 24.014294768373162, 23.772009859482438, 24.08721017340818, 24.756187970439584, 25.020145444820315, 24.828829715649277, 18.0674185330669, 18.425951422580198, 18.378731404120714, 16.002748231713966, 15.764395040770367, 15.664048386116818, 18.162192734579236, 18.24728564793864, 18.374277953679353, 21.019526599595935, 20.63675173620382, 20.556207756201417, 19.328838855028152, 19.494018897414207, 19.59432858787477, 22.080576486885548, 22.240318778902292, 22.235699735581875, 25.552025790015847, 25.276510434846074, 25.323450098435075, 17.821378529071808, 18.371015813201666, 17.718066841363907, 17.40302971440056, 16.93819699684778, 16.81274218360582, 15.168778409560517, 15.01744258900483, 15.262230483194188, 12.326562158763409, 11.74585984647274, 12.170756883919239, 22.282443240905792, 22.097452672819287, 22.172068952272326, 21.643902640789747, 21.869130777195096, 21.884022005833685, 23.132828444242477, 23.32018918171525, 23.382328486070037, 19.341895177960396, 19.890108097344637, 20.050363592919894, 17.93392264842987, 17.94988803192973, 17.492427170276642, 19.54948578526576, 19.71356001247962, 19.964880612989262, 18.7150274887681, 18.61887975782156, 18.371723100543022, 13.849327821905405, 13.414374279479176, 13.384121047953755, 27.137988168125347, 26.954012536754206, 26.67537261297305, 12.097379570206002, 12.634911523511008, 12.162853633364037, 18.2136204354465, 17.75645625591278, 18.32734606449958, 19.923172008867056, 19.886691516886145, 20.04103221713254, 10.168553662175924, 9.633973489205033, 9.523720915118844, 18.47781398675093, 18.039744327465684, 18.146404604117066, 21.98777826627095, 21.814886910219982, 21.993861087908343, 21.98702425012985, 21.681479478875787, 22.34388396392265, 22.031009517610073, 21.90916123241186, 21.66066987812519, 16.844651532669857, 16.612068248291806, 16.872964158033326, 21.313355838259056, 20.850269397099808, 21.42227967580159, 18.24991280088821, 18.27711062381664, 18.670597015947948, 16.94525536095412, 16.82892884189883, 16.377232941488415, 25.394788697361946, 25.738181430846453, 25.673464328050613, 16.88740875571966, 17.03653423115611, 16.51609130203724, 16.232788179069757, 16.26428511738777, 16.182807691395283, 19.013467783729226, 19.4345445173482, 19.003028179208428, 22.303099375062928, 22.322950093735315, 22.144654152293995, 18.77107372134924, 18.63866911828518, 18.814896173775196, 18.297668018378317, 17.759027488529682, 18.302623953670263, 17.957333539923027, 18.41895966728528, 18.293641125162438, 14.361827323834092, 14.545109967390687, 14.577220665911824, 20.638097186883286, 20.711319518585995, 20.669237708051995, 16.430005008975655, 16.39886802683273, 16.91942799060294, 16.747868072241545, 16.74664264731109, 16.60186392441392, 25.435948584228754, 25.099894896149635, 25.560124803334475, 12.4285681558152, 12.16303864618142, 12.420238173877195, 27.97329281270504, 28.04280311614275, 28.032791454344988, 25.487874764793858, 25.02002317210038, 25.220721789946154, 21.033227028946072, 21.16916551689306, 21.61071059612246, 16.710217088460922, 16.664830274879932, 16.20646359026432, 18.437512818723917, 18.32967257499695, 18.000510543584824, 28.24231942890522, 27.836508137484387, 28.233172940167904, 20.55877036352952, 20.215984498461083, 19.67121138175328, 21.98710859939456, 21.797435723245144, 21.98806108161807, 19.592619751890496, 19.336643767853573, 19.405450661977127, 26.076496874292687, 26.386860075717166, 26.410843108159796, 19.737276578942925, 19.763911361495644, 20.05299305046597, 23.7924622297287, 24.115096686407924, 23.767046846449375, 23.522788539528847, 23.274921394884586, 23.598228871822357, 23.681793908278138, 23.70316958675781, 23.591128798822552, 24.17024563997984, 23.644044771790504, 24.037152267992496, 25.940919515987233, 25.57124625643094, 25.50786059101422, 23.815445890650153, 23.122759982943535, 23.626431189477444, 21.11008793860674, 21.21666856855154, 20.49005088210106, 18.58752928798397, 18.62960685168703, 17.811558862527207, 27.26826876898606, 27.58947682132323, 27.550082118560866, 20.20905330280462, 20.573922055462987, 20.247179525593907, 23.840066629151494, 23.550073976318032, 23.488737071553857, 26.361840636857465, 25.72928101817766, 26.16368756691614, 23.170179945727185, 23.15231457104285, 22.764903863271073, 18.911931763092667, 19.430972893411905, 19.17164510736862, 22.27177223811546, 22.591961628446967, 22.800141555878014, 22.880539176364735, 22.933876131971672, 23.182084648249045, 19.11362072825432, 18.645873725414276, 19.38050012709573, 21.018357108036668, 20.95612859229246, 21.181293370823056, 18.50337789952755, 19.30530499992892, 19.020618326961994, 23.949754634251192, 23.883627639462546, 23.70783806343873, 27.490726855893925, 27.782411963989333, 27.78799945240219, 34.90447224428256, 35.13150723030169, 35.28691192468007, 21.498712301254272, 21.1727537214756, 20.855437740683556, 16.993700283269078, 16.815792861084134, 17.269048214579612, 20.215478916962937, 20.69218999271591, 20.4694483851393, 18.81792827447255, 19.34063754913707, 19.198947389920548, 16.37859984238942, 16.50100464870532, 15.737829943497971, 12.302358893056706, 12.685707562913493, 12.718434340630964, 28.992097661520035, 28.506727846960217, 28.69091413418451, 24.64284360781312, 24.360360749065876, 24.324627950787544, 21.397638118515403, 20.88944439093271, 21.525778009245784, 26.20470496515432, 26.350207204620034, 26.566674734155328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14413639157948535, "mean_inference_ms": 0.6452356933579381, "mean_action_processing_ms": 0.09491563199688408, "mean_env_wait_ms": 0.8050807250817393, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 532800, "timesteps_this_iter": 0, "agent_timesteps_total": 1598400, "timers": {"sample_time_ms": 9428.853, "sample_throughput": 509.076, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1191.188, "learn_throughput": 4029.591, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 6.59272313117981, "policy_loss": 0.0003278602274723319, "vf_loss": 6.7176777720451355, "vf_explained_var": -0.08397229015827179, "kl": 0.006559218018207932, "entropy": 12.554532408714294, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 532800, "num_agent_steps_sampled": 1598400, "num_steps_trained": 532800, "num_agent_steps_trained": 1598400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2705, "training_iteration": 111, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-00-05", "timestamp": 1706148005, "time_this_iter_s": 9.174026012420654, "time_total_s": 1045.6497530937195, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1045.6497530937195, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 47.338461538461544}}
{"episode_reward_max": 105.32289139926432, "episode_reward_min": 29.3262480664998, "episode_reward_mean": 63.08674350111076, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.523720915118844}, "policy_reward_max": {"shared_policy": 35.28691192468007}, "policy_reward_mean": {"shared_policy": 21.02891450037025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.55659500136971, 76.151986323297, 53.91046118363738, 51.15396889485416, 45.448451481759534, 36.24317888915539, 66.5519648659974, 65.39705542381853, 69.83534611202776, 59.282366868224926, 53.376237850636244, 59.22792641073464, 55.70563034713268, 40.647823149338336, 80.7673733178526, 36.895144727081046, 54.29742275585886, 59.85089574288574, 29.3262480664998, 54.66396291833368, 65.79652626439928, 66.01238769292829, 65.60084062814713, 50.32968393899499, 63.585904911160455, 55.1976204406528, 50.151417144341366, 76.80643445625901, 50.44003428891301, 48.67988098785281, 57.451040480285855, 66.77070362109224, 56.224639013409615, 54.35931946057826, 54.669934332370744, 43.4841579571366, 62.018654413521276, 49.748301026411326, 50.096374643966556, 76.09596828371286, 37.011844975873814, 84.04888738319278, 75.72861972684039, 63.81310314196159, 49.581510953605175, 54.76769593730569, 84.31200050655751, 60.44596624374388, 65.77260540425777, 58.334714181721196, 78.87420005816965, 59.55418099090454, 71.674605762586, 70.39593880623579, 70.9760922938585, 71.85144267976284, 77.0200263634324, 70.56463706307113, 62.81680738925934, 55.028695002198205, 82.40782770887016, 61.03015488386151, 70.87887767702338, 78.25480922195126, 69.08739838004111, 57.51454976387319, 67.66387542244044, 68.99649995658545, 57.13999458076432, 63.15577907115218, 56.829301226418465, 71.54122033715247, 83.06113827228545, 105.32289139926432, 63.52690376341343, 51.078541358932824, 61.37711729481815, 57.35751321353017, 48.61743443459271, 37.70650079660116, 86.18973964266476, 73.32783230766654, 63.812860518693896, 79.12158690392968, 52.305641725659356, 57.13227568194267, 100.56297475099564, 75.67858668416739, 72.70038901269434, 62.6592083647847, 50.324886947870255, 60.209822898730636, 62.043784677982316, 77.10333067923781, 77.82389808632433, 77.32688768766819, 76.73837151005864, 67.28766947984693, 61.56305402517319, 60.82978058024307], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.080576486885548, 22.240318778902292, 22.235699735581875, 25.552025790015847, 25.276510434846074, 25.323450098435075, 17.821378529071808, 18.371015813201666, 17.718066841363907, 17.40302971440056, 16.93819699684778, 16.81274218360582, 15.168778409560517, 15.01744258900483, 15.262230483194188, 12.326562158763409, 11.74585984647274, 12.170756883919239, 22.282443240905792, 22.097452672819287, 22.172068952272326, 21.643902640789747, 21.869130777195096, 21.884022005833685, 23.132828444242477, 23.32018918171525, 23.382328486070037, 19.341895177960396, 19.890108097344637, 20.050363592919894, 17.93392264842987, 17.94988803192973, 17.492427170276642, 19.54948578526576, 19.71356001247962, 19.964880612989262, 18.7150274887681, 18.61887975782156, 18.371723100543022, 13.849327821905405, 13.414374279479176, 13.384121047953755, 27.137988168125347, 26.954012536754206, 26.67537261297305, 12.097379570206002, 12.634911523511008, 12.162853633364037, 18.2136204354465, 17.75645625591278, 18.32734606449958, 19.923172008867056, 19.886691516886145, 20.04103221713254, 10.168553662175924, 9.633973489205033, 9.523720915118844, 18.47781398675093, 18.039744327465684, 18.146404604117066, 21.98777826627095, 21.814886910219982, 21.993861087908343, 21.98702425012985, 21.681479478875787, 22.34388396392265, 22.031009517610073, 21.90916123241186, 21.66066987812519, 16.844651532669857, 16.612068248291806, 16.872964158033326, 21.313355838259056, 20.850269397099808, 21.42227967580159, 18.24991280088821, 18.27711062381664, 18.670597015947948, 16.94525536095412, 16.82892884189883, 16.377232941488415, 25.394788697361946, 25.738181430846453, 25.673464328050613, 16.88740875571966, 17.03653423115611, 16.51609130203724, 16.232788179069757, 16.26428511738777, 16.182807691395283, 19.013467783729226, 19.4345445173482, 19.003028179208428, 22.303099375062928, 22.322950093735315, 22.144654152293995, 18.77107372134924, 18.63866911828518, 18.814896173775196, 18.297668018378317, 17.759027488529682, 18.302623953670263, 17.957333539923027, 18.41895966728528, 18.293641125162438, 14.361827323834092, 14.545109967390687, 14.577220665911824, 20.638097186883286, 20.711319518585995, 20.669237708051995, 16.430005008975655, 16.39886802683273, 16.91942799060294, 16.747868072241545, 16.74664264731109, 16.60186392441392, 25.435948584228754, 25.099894896149635, 25.560124803334475, 12.4285681558152, 12.16303864618142, 12.420238173877195, 27.97329281270504, 28.04280311614275, 28.032791454344988, 25.487874764793858, 25.02002317210038, 25.220721789946154, 21.033227028946072, 21.16916551689306, 21.61071059612246, 16.710217088460922, 16.664830274879932, 16.20646359026432, 18.437512818723917, 18.32967257499695, 18.000510543584824, 28.24231942890522, 27.836508137484387, 28.233172940167904, 20.55877036352952, 20.215984498461083, 19.67121138175328, 21.98710859939456, 21.797435723245144, 21.98806108161807, 19.592619751890496, 19.336643767853573, 19.405450661977127, 26.076496874292687, 26.386860075717166, 26.410843108159796, 19.737276578942925, 19.763911361495644, 20.05299305046597, 23.7924622297287, 24.115096686407924, 23.767046846449375, 23.522788539528847, 23.274921394884586, 23.598228871822357, 23.681793908278138, 23.70316958675781, 23.591128798822552, 24.17024563997984, 23.644044771790504, 24.037152267992496, 25.940919515987233, 25.57124625643094, 25.50786059101422, 23.815445890650153, 23.122759982943535, 23.626431189477444, 21.11008793860674, 21.21666856855154, 20.49005088210106, 18.58752928798397, 18.62960685168703, 17.811558862527207, 27.26826876898606, 27.58947682132323, 27.550082118560866, 20.20905330280462, 20.573922055462987, 20.247179525593907, 23.840066629151494, 23.550073976318032, 23.488737071553857, 26.361840636857465, 25.72928101817766, 26.16368756691614, 23.170179945727185, 23.15231457104285, 22.764903863271073, 18.911931763092667, 19.430972893411905, 19.17164510736862, 22.27177223811546, 22.591961628446967, 22.800141555878014, 22.880539176364735, 22.933876131971672, 23.182084648249045, 19.11362072825432, 18.645873725414276, 19.38050012709573, 21.018357108036668, 20.95612859229246, 21.181293370823056, 18.50337789952755, 19.30530499992892, 19.020618326961994, 23.949754634251192, 23.883627639462546, 23.70783806343873, 27.490726855893925, 27.782411963989333, 27.78799945240219, 34.90447224428256, 35.13150723030169, 35.28691192468007, 21.498712301254272, 21.1727537214756, 20.855437740683556, 16.993700283269078, 16.815792861084134, 17.269048214579612, 20.215478916962937, 20.69218999271591, 20.4694483851393, 18.81792827447255, 19.34063754913707, 19.198947389920548, 16.37859984238942, 16.50100464870532, 15.737829943497971, 12.302358893056706, 12.685707562913493, 12.718434340630964, 28.992097661520035, 28.506727846960217, 28.69091413418451, 24.64284360781312, 24.360360749065876, 24.324627950787544, 21.397638118515403, 20.88944439093271, 21.525778009245784, 26.20470496515432, 26.350207204620034, 26.566674734155328, 17.428845723470047, 17.24318939944108, 17.63360660274823, 19.102456631759793, 19.39606454844275, 18.63375450174013, 33.56309700012207, 33.69618333131075, 33.30369441956282, 25.543423302471638, 25.559557273983955, 24.575606107711792, 24.218032752474144, 24.017271419366196, 24.465084840854004, 20.73040050764878, 20.961141933997467, 20.967665923138455, 16.764144234359264, 16.584016725420952, 16.97672598809004, 19.939394913613796, 19.923181295394897, 20.347246689721942, 20.697099854548767, 20.550160398085907, 20.79652442534764, 25.717229197422654, 25.628917465607316, 25.757184016207844, 26.102100325748324, 25.988094922155142, 25.733702838420868, 25.905146797498062, 25.910120982055858, 25.51161990811427, 25.696030400693417, 25.242712527513504, 25.79962858185172, 22.044166351358086, 22.584699454406888, 22.658803674081952, 20.536090582609177, 20.818042159080505, 20.208921283483505, 20.43727279213877, 20.018104786674172, 20.374403001430125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14408484423608692, "mean_inference_ms": 0.6452570999776482, "mean_action_processing_ms": 0.09490582401082434, "mean_env_wait_ms": 0.8049326893126376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 537600, "timesteps_this_iter": 0, "agent_timesteps_total": 1612800, "timers": {"sample_time_ms": 9351.921, "sample_throughput": 513.264, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1184.994, "learn_throughput": 4050.655, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 5.218618035316467, "policy_loss": 0.00011007684618460911, "vf_loss": 5.3434125781059265, "vf_explained_var": -0.04672129452228546, "kl": 0.009941803175152003, "entropy": 12.530279874801636, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 537600, "num_agent_steps_sampled": 1612800, "num_steps_trained": 537600, "num_agent_steps_trained": 1612800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2721, "training_iteration": 112, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-00-14", "timestamp": 1706148014, "time_this_iter_s": 9.054880142211914, "time_total_s": 1054.7046332359314, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000528820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1054.7046332359314, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 7.708333333333333, "ram_util_percent": 47.224999999999994}}
{"episode_reward_max": 105.32289139926432, "episode_reward_min": 29.3262480664998, "episode_reward_mean": 64.79131089527422, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.523720915118844}, "policy_reward_max": {"shared_policy": 35.28691192468007}, "policy_reward_mean": {"shared_policy": 21.597103631758067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.29742275585886, 59.85089574288574, 29.3262480664998, 54.66396291833368, 65.79652626439928, 66.01238769292829, 65.60084062814713, 50.32968393899499, 63.585904911160455, 55.1976204406528, 50.151417144341366, 76.80643445625901, 50.44003428891301, 48.67988098785281, 57.451040480285855, 66.77070362109224, 56.224639013409615, 54.35931946057826, 54.669934332370744, 43.4841579571366, 62.018654413521276, 49.748301026411326, 50.096374643966556, 76.09596828371286, 37.011844975873814, 84.04888738319278, 75.72861972684039, 63.81310314196159, 49.581510953605175, 54.76769593730569, 84.31200050655751, 60.44596624374388, 65.77260540425777, 58.334714181721196, 78.87420005816965, 59.55418099090454, 71.674605762586, 70.39593880623579, 70.9760922938585, 71.85144267976284, 77.0200263634324, 70.56463706307113, 62.81680738925934, 55.028695002198205, 82.40782770887016, 61.03015488386151, 70.87887767702338, 78.25480922195126, 69.08739838004111, 57.51454976387319, 67.66387542244044, 68.99649995658545, 57.13999458076432, 63.15577907115218, 56.829301226418465, 71.54122033715247, 83.06113827228545, 105.32289139926432, 63.52690376341343, 51.078541358932824, 61.37711729481815, 57.35751321353017, 48.61743443459271, 37.70650079660116, 86.18973964266476, 73.32783230766654, 63.812860518693896, 79.12158690392968, 52.305641725659356, 57.13227568194267, 100.56297475099564, 75.67858668416739, 72.70038901269434, 62.6592083647847, 50.324886947870255, 60.209822898730636, 62.043784677982316, 77.10333067923781, 77.82389808632433, 77.32688768766819, 76.73837151005864, 67.28766947984693, 61.56305402517319, 60.82978058024307, 52.61794844549148, 49.477582858409704, 48.357764048967496, 56.35438508540392, 52.66638041287658, 74.79356465674935, 66.25142978131771, 73.37644577026364, 86.2014438174665, 56.199066385626764, 61.80928018700794, 72.6777481473982, 74.8049277588725, 80.38358034379779, 85.42478363215922, 96.2119189314544], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.2136204354465, 17.75645625591278, 18.32734606449958, 19.923172008867056, 19.886691516886145, 20.04103221713254, 10.168553662175924, 9.633973489205033, 9.523720915118844, 18.47781398675093, 18.039744327465684, 18.146404604117066, 21.98777826627095, 21.814886910219982, 21.993861087908343, 21.98702425012985, 21.681479478875787, 22.34388396392265, 22.031009517610073, 21.90916123241186, 21.66066987812519, 16.844651532669857, 16.612068248291806, 16.872964158033326, 21.313355838259056, 20.850269397099808, 21.42227967580159, 18.24991280088821, 18.27711062381664, 18.670597015947948, 16.94525536095412, 16.82892884189883, 16.377232941488415, 25.394788697361946, 25.738181430846453, 25.673464328050613, 16.88740875571966, 17.03653423115611, 16.51609130203724, 16.232788179069757, 16.26428511738777, 16.182807691395283, 19.013467783729226, 19.4345445173482, 19.003028179208428, 22.303099375062928, 22.322950093735315, 22.144654152293995, 18.77107372134924, 18.63866911828518, 18.814896173775196, 18.297668018378317, 17.759027488529682, 18.302623953670263, 17.957333539923027, 18.41895966728528, 18.293641125162438, 14.361827323834092, 14.545109967390687, 14.577220665911824, 20.638097186883286, 20.711319518585995, 20.669237708051995, 16.430005008975655, 16.39886802683273, 16.91942799060294, 16.747868072241545, 16.74664264731109, 16.60186392441392, 25.435948584228754, 25.099894896149635, 25.560124803334475, 12.4285681558152, 12.16303864618142, 12.420238173877195, 27.97329281270504, 28.04280311614275, 28.032791454344988, 25.487874764793858, 25.02002317210038, 25.220721789946154, 21.033227028946072, 21.16916551689306, 21.61071059612246, 16.710217088460922, 16.664830274879932, 16.20646359026432, 18.437512818723917, 18.32967257499695, 18.000510543584824, 28.24231942890522, 27.836508137484387, 28.233172940167904, 20.55877036352952, 20.215984498461083, 19.67121138175328, 21.98710859939456, 21.797435723245144, 21.98806108161807, 19.592619751890496, 19.336643767853573, 19.405450661977127, 26.076496874292687, 26.386860075717166, 26.410843108159796, 19.737276578942925, 19.763911361495644, 20.05299305046597, 23.7924622297287, 24.115096686407924, 23.767046846449375, 23.522788539528847, 23.274921394884586, 23.598228871822357, 23.681793908278138, 23.70316958675781, 23.591128798822552, 24.17024563997984, 23.644044771790504, 24.037152267992496, 25.940919515987233, 25.57124625643094, 25.50786059101422, 23.815445890650153, 23.122759982943535, 23.626431189477444, 21.11008793860674, 21.21666856855154, 20.49005088210106, 18.58752928798397, 18.62960685168703, 17.811558862527207, 27.26826876898606, 27.58947682132323, 27.550082118560866, 20.20905330280462, 20.573922055462987, 20.247179525593907, 23.840066629151494, 23.550073976318032, 23.488737071553857, 26.361840636857465, 25.72928101817766, 26.16368756691614, 23.170179945727185, 23.15231457104285, 22.764903863271073, 18.911931763092667, 19.430972893411905, 19.17164510736862, 22.27177223811546, 22.591961628446967, 22.800141555878014, 22.880539176364735, 22.933876131971672, 23.182084648249045, 19.11362072825432, 18.645873725414276, 19.38050012709573, 21.018357108036668, 20.95612859229246, 21.181293370823056, 18.50337789952755, 19.30530499992892, 19.020618326961994, 23.949754634251192, 23.883627639462546, 23.70783806343873, 27.490726855893925, 27.782411963989333, 27.78799945240219, 34.90447224428256, 35.13150723030169, 35.28691192468007, 21.498712301254272, 21.1727537214756, 20.855437740683556, 16.993700283269078, 16.815792861084134, 17.269048214579612, 20.215478916962937, 20.69218999271591, 20.4694483851393, 18.81792827447255, 19.34063754913707, 19.198947389920548, 16.37859984238942, 16.50100464870532, 15.737829943497971, 12.302358893056706, 12.685707562913493, 12.718434340630964, 28.992097661520035, 28.506727846960217, 28.69091413418451, 24.64284360781312, 24.360360749065876, 24.324627950787544, 21.397638118515403, 20.88944439093271, 21.525778009245784, 26.20470496515432, 26.350207204620034, 26.566674734155328, 17.428845723470047, 17.24318939944108, 17.63360660274823, 19.102456631759793, 19.39606454844275, 18.63375450174013, 33.56309700012207, 33.69618333131075, 33.30369441956282, 25.543423302471638, 25.559557273983955, 24.575606107711792, 24.218032752474144, 24.017271419366196, 24.465084840854004, 20.73040050764878, 20.961141933997467, 20.967665923138455, 16.764144234359264, 16.584016725420952, 16.97672598809004, 19.939394913613796, 19.923181295394897, 20.347246689721942, 20.697099854548767, 20.550160398085907, 20.79652442534764, 25.717229197422654, 25.628917465607316, 25.757184016207844, 26.102100325748324, 25.988094922155142, 25.733702838420868, 25.905146797498062, 25.910120982055858, 25.51161990811427, 25.696030400693417, 25.242712527513504, 25.79962858185172, 22.044166351358086, 22.584699454406888, 22.658803674081952, 20.536090582609177, 20.818042159080505, 20.208921283483505, 20.43727279213877, 20.018104786674172, 20.374403001430125, 17.430275549491242, 17.617525948521987, 17.57014694747825, 16.43708724776903, 16.77265500665331, 16.267840603987366, 15.807518025239304, 16.160954439391688, 16.389291584336505, 18.625318467617035, 19.11545629054308, 18.613610327243805, 17.264166514078767, 17.884495260814816, 17.517718637982995, 24.766585779686764, 24.82715907444556, 25.19981980261703, 21.955712094902992, 22.143515527248383, 22.152202159166336, 24.584381418923527, 24.41442574063936, 24.377638610700757, 28.596028082072735, 28.906351748853922, 28.69906398653984, 18.59949209044376, 18.761670256654412, 18.837904038528592, 20.495839367310197, 20.653072671654314, 20.660368148043432, 24.079857158164174, 24.30907883370915, 24.28881215552488, 24.811222185691193, 24.705281188090638, 25.288424385090664, 26.516052735348538, 26.915439189722136, 26.952088418727115, 28.34637414415677, 28.720196818312004, 28.358212669690445, 31.90376466264327, 32.143579592307404, 32.16457467650373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14402966039147372, "mean_inference_ms": 0.6452455329521605, "mean_action_processing_ms": 0.09489816597920528, "mean_env_wait_ms": 0.8047669013571178, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 542400, "timesteps_this_iter": 0, "agent_timesteps_total": 1627200, "timers": {"sample_time_ms": 9330.19, "sample_throughput": 514.459, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1189.492, "learn_throughput": 4035.334, "update_time_ms": 1.434}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 6.664214551448822, "policy_loss": 0.002930247405057429, "vf_loss": 6.788395643234253, "vf_explained_var": -0.05055639147758484, "kl": 0.013313321164010048, "entropy": 12.764467597007751, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 542400, "num_agent_steps_sampled": 1627200, "num_steps_trained": 542400, "num_agent_steps_trained": 1627200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2737, "training_iteration": 113, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-00-23", "timestamp": 1706148023, "time_this_iter_s": 9.367276668548584, "time_total_s": 1064.07190990448, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021001617700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1064.07190990448, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 7.307142857142857, "ram_util_percent": 47.28571428571428}}
{"episode_reward_max": 105.32289139926432, "episode_reward_min": 37.011844975873814, "episode_reward_mean": 66.00182986885076, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.16303864618142}, "policy_reward_max": {"shared_policy": 35.28691192468007}, "policy_reward_mean": {"shared_policy": 22.000609956283583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.224639013409615, 54.35931946057826, 54.669934332370744, 43.4841579571366, 62.018654413521276, 49.748301026411326, 50.096374643966556, 76.09596828371286, 37.011844975873814, 84.04888738319278, 75.72861972684039, 63.81310314196159, 49.581510953605175, 54.76769593730569, 84.31200050655751, 60.44596624374388, 65.77260540425777, 58.334714181721196, 78.87420005816965, 59.55418099090454, 71.674605762586, 70.39593880623579, 70.9760922938585, 71.85144267976284, 77.0200263634324, 70.56463706307113, 62.81680738925934, 55.028695002198205, 82.40782770887016, 61.03015488386151, 70.87887767702338, 78.25480922195126, 69.08739838004111, 57.51454976387319, 67.66387542244044, 68.99649995658545, 57.13999458076432, 63.15577907115218, 56.829301226418465, 71.54122033715247, 83.06113827228545, 105.32289139926432, 63.52690376341343, 51.078541358932824, 61.37711729481815, 57.35751321353017, 48.61743443459271, 37.70650079660116, 86.18973964266476, 73.32783230766654, 63.812860518693896, 79.12158690392968, 52.305641725659356, 57.13227568194267, 100.56297475099564, 75.67858668416739, 72.70038901269434, 62.6592083647847, 50.324886947870255, 60.209822898730636, 62.043784677982316, 77.10333067923781, 77.82389808632433, 77.32688768766819, 76.73837151005864, 67.28766947984693, 61.56305402517319, 60.82978058024307, 52.61794844549148, 49.477582858409704, 48.357764048967496, 56.35438508540392, 52.66638041287658, 74.79356465674935, 66.25142978131771, 73.37644577026364, 86.2014438174665, 56.199066385626764, 61.80928018700794, 72.6777481473982, 74.8049277588725, 80.38358034379779, 85.42478363215922, 96.2119189314544, 78.40701127424836, 56.77415359765291, 68.4699886597227, 64.06399084627625, 67.39501736313105, 87.27266298234463, 69.9783313088119, 63.5710655748844, 55.97581332363187, 77.434422747232, 44.93246835470198, 63.87213081412483, 69.29176863282916, 61.66675516963005, 52.09180403128265, 54.81551701575515], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.77107372134924, 18.63866911828518, 18.814896173775196, 18.297668018378317, 17.759027488529682, 18.302623953670263, 17.957333539923027, 18.41895966728528, 18.293641125162438, 14.361827323834092, 14.545109967390687, 14.577220665911824, 20.638097186883286, 20.711319518585995, 20.669237708051995, 16.430005008975655, 16.39886802683273, 16.91942799060294, 16.747868072241545, 16.74664264731109, 16.60186392441392, 25.435948584228754, 25.099894896149635, 25.560124803334475, 12.4285681558152, 12.16303864618142, 12.420238173877195, 27.97329281270504, 28.04280311614275, 28.032791454344988, 25.487874764793858, 25.02002317210038, 25.220721789946154, 21.033227028946072, 21.16916551689306, 21.61071059612246, 16.710217088460922, 16.664830274879932, 16.20646359026432, 18.437512818723917, 18.32967257499695, 18.000510543584824, 28.24231942890522, 27.836508137484387, 28.233172940167904, 20.55877036352952, 20.215984498461083, 19.67121138175328, 21.98710859939456, 21.797435723245144, 21.98806108161807, 19.592619751890496, 19.336643767853573, 19.405450661977127, 26.076496874292687, 26.386860075717166, 26.410843108159796, 19.737276578942925, 19.763911361495644, 20.05299305046597, 23.7924622297287, 24.115096686407924, 23.767046846449375, 23.522788539528847, 23.274921394884586, 23.598228871822357, 23.681793908278138, 23.70316958675781, 23.591128798822552, 24.17024563997984, 23.644044771790504, 24.037152267992496, 25.940919515987233, 25.57124625643094, 25.50786059101422, 23.815445890650153, 23.122759982943535, 23.626431189477444, 21.11008793860674, 21.21666856855154, 20.49005088210106, 18.58752928798397, 18.62960685168703, 17.811558862527207, 27.26826876898606, 27.58947682132323, 27.550082118560866, 20.20905330280462, 20.573922055462987, 20.247179525593907, 23.840066629151494, 23.550073976318032, 23.488737071553857, 26.361840636857465, 25.72928101817766, 26.16368756691614, 23.170179945727185, 23.15231457104285, 22.764903863271073, 18.911931763092667, 19.430972893411905, 19.17164510736862, 22.27177223811546, 22.591961628446967, 22.800141555878014, 22.880539176364735, 22.933876131971672, 23.182084648249045, 19.11362072825432, 18.645873725414276, 19.38050012709573, 21.018357108036668, 20.95612859229246, 21.181293370823056, 18.50337789952755, 19.30530499992892, 19.020618326961994, 23.949754634251192, 23.883627639462546, 23.70783806343873, 27.490726855893925, 27.782411963989333, 27.78799945240219, 34.90447224428256, 35.13150723030169, 35.28691192468007, 21.498712301254272, 21.1727537214756, 20.855437740683556, 16.993700283269078, 16.815792861084134, 17.269048214579612, 20.215478916962937, 20.69218999271591, 20.4694483851393, 18.81792827447255, 19.34063754913707, 19.198947389920548, 16.37859984238942, 16.50100464870532, 15.737829943497971, 12.302358893056706, 12.685707562913493, 12.718434340630964, 28.992097661520035, 28.506727846960217, 28.69091413418451, 24.64284360781312, 24.360360749065876, 24.324627950787544, 21.397638118515403, 20.88944439093271, 21.525778009245784, 26.20470496515432, 26.350207204620034, 26.566674734155328, 17.428845723470047, 17.24318939944108, 17.63360660274823, 19.102456631759793, 19.39606454844275, 18.63375450174013, 33.56309700012207, 33.69618333131075, 33.30369441956282, 25.543423302471638, 25.559557273983955, 24.575606107711792, 24.218032752474144, 24.017271419366196, 24.465084840854004, 20.73040050764878, 20.961141933997467, 20.967665923138455, 16.764144234359264, 16.584016725420952, 16.97672598809004, 19.939394913613796, 19.923181295394897, 20.347246689721942, 20.697099854548767, 20.550160398085907, 20.79652442534764, 25.717229197422654, 25.628917465607316, 25.757184016207844, 26.102100325748324, 25.988094922155142, 25.733702838420868, 25.905146797498062, 25.910120982055858, 25.51161990811427, 25.696030400693417, 25.242712527513504, 25.79962858185172, 22.044166351358086, 22.584699454406888, 22.658803674081952, 20.536090582609177, 20.818042159080505, 20.208921283483505, 20.43727279213877, 20.018104786674172, 20.374403001430125, 17.430275549491242, 17.617525948521987, 17.57014694747825, 16.43708724776903, 16.77265500665331, 16.267840603987366, 15.807518025239304, 16.160954439391688, 16.389291584336505, 18.625318467617035, 19.11545629054308, 18.613610327243805, 17.264166514078767, 17.884495260814816, 17.517718637982995, 24.766585779686764, 24.82715907444556, 25.19981980261703, 21.955712094902992, 22.143515527248383, 22.152202159166336, 24.584381418923527, 24.41442574063936, 24.377638610700757, 28.596028082072735, 28.906351748853922, 28.69906398653984, 18.59949209044376, 18.761670256654412, 18.837904038528592, 20.495839367310197, 20.653072671654314, 20.660368148043432, 24.079857158164174, 24.30907883370915, 24.28881215552488, 24.811222185691193, 24.705281188090638, 25.288424385090664, 26.516052735348538, 26.915439189722136, 26.952088418727115, 28.34637414415677, 28.720196818312004, 28.358212669690445, 31.90376466264327, 32.143579592307404, 32.16457467650373, 26.445425618439913, 26.034109219908714, 25.927476435899734, 18.844431303441525, 18.943426609039307, 18.98629568517208, 23.186970617078856, 22.844115043679864, 22.438902998963982, 21.211802432934434, 21.184460068742425, 21.667728344599396, 22.807063706219196, 22.17764562368393, 22.41030803322792, 29.25286415219307, 29.205293089151382, 28.814505741000175, 23.496688539162278, 23.42360739596188, 23.058035373687744, 21.44961018239458, 21.209047624220446, 20.912407768269375, 18.372930762668446, 18.75567889710267, 18.847203663860753, 25.50038382907708, 25.69536619385083, 26.238672724304095, 14.854791713257626, 14.953501102825001, 15.124175538619355, 21.081579513847828, 21.30238650366664, 21.488164796610363, 23.006786095599324, 23.08010062823692, 23.204881908992917, 20.62224107980728, 20.585068754851818, 20.45944533497095, 17.04257011910279, 17.482548901190356, 17.566685010989502, 18.333756918708474, 17.978981430331856, 18.502778666714818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14396691852253649, "mean_inference_ms": 0.64524175020508, "mean_action_processing_ms": 0.09490530840067368, "mean_env_wait_ms": 0.8045978994499124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 547200, "timesteps_this_iter": 0, "agent_timesteps_total": 1641600, "timers": {"sample_time_ms": 9319.02, "sample_throughput": 515.076, "load_time_ms": 0.2, "load_throughput": 24001739.628, "learn_time_ms": 1190.497, "learn_throughput": 4031.928, "update_time_ms": 1.427}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 0.0005, "total_loss": 4.98505824804306, "policy_loss": 0.004796822633846398, "vf_loss": 5.1064624190330505, "vf_explained_var": -0.0905398577451706, "kl": 0.028945827740378172, "entropy": 12.736013293266296, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 547200, "num_agent_steps_sampled": 1641600, "num_steps_trained": 547200, "num_agent_steps_trained": 1641600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2753, "training_iteration": 114, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-00-33", "timestamp": 1706148033, "time_this_iter_s": 9.44778299331665, "time_total_s": 1073.5196928977966, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210005288B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1073.5196928977966, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 11.000000000000002, "ram_util_percent": 47.29230769230769}}
{"episode_reward_max": 105.32289139926432, "episode_reward_min": 37.70650079660116, "episode_reward_mean": 66.66052561184857, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.302358893056706}, "policy_reward_max": {"shared_policy": 35.28691192468007}, "policy_reward_mean": {"shared_policy": 22.220175203949516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.77260540425777, 58.334714181721196, 78.87420005816965, 59.55418099090454, 71.674605762586, 70.39593880623579, 70.9760922938585, 71.85144267976284, 77.0200263634324, 70.56463706307113, 62.81680738925934, 55.028695002198205, 82.40782770887016, 61.03015488386151, 70.87887767702338, 78.25480922195126, 69.08739838004111, 57.51454976387319, 67.66387542244044, 68.99649995658545, 57.13999458076432, 63.15577907115218, 56.829301226418465, 71.54122033715247, 83.06113827228545, 105.32289139926432, 63.52690376341343, 51.078541358932824, 61.37711729481815, 57.35751321353017, 48.61743443459271, 37.70650079660116, 86.18973964266476, 73.32783230766654, 63.812860518693896, 79.12158690392968, 52.305641725659356, 57.13227568194267, 100.56297475099564, 75.67858668416739, 72.70038901269434, 62.6592083647847, 50.324886947870255, 60.209822898730636, 62.043784677982316, 77.10333067923781, 77.82389808632433, 77.32688768766819, 76.73837151005864, 67.28766947984693, 61.56305402517319, 60.82978058024307, 52.61794844549148, 49.477582858409704, 48.357764048967496, 56.35438508540392, 52.66638041287658, 74.79356465674935, 66.25142978131771, 73.37644577026364, 86.2014438174665, 56.199066385626764, 61.80928018700794, 72.6777481473982, 74.8049277588725, 80.38358034379779, 85.42478363215922, 96.2119189314544, 78.40701127424836, 56.77415359765291, 68.4699886597227, 64.06399084627625, 67.39501736313105, 87.27266298234463, 69.9783313088119, 63.5710655748844, 55.97581332363187, 77.434422747232, 44.93246835470198, 63.87213081412483, 69.29176863282916, 61.66675516963005, 52.09180403128265, 54.81551701575515, 57.7128710746765, 60.79844898730515, 93.46048923395571, 59.33539726585148, 84.41564865037797, 53.83466415107249, 48.34179693553597, 48.609807211905704, 76.09052340500055, 65.64599772728978, 60.84502293821423, 60.32427961006759, 84.26986114215103, 50.93385862745343, 62.44874886050819, 55.20913647860286], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.98710859939456, 21.797435723245144, 21.98806108161807, 19.592619751890496, 19.336643767853573, 19.405450661977127, 26.076496874292687, 26.386860075717166, 26.410843108159796, 19.737276578942925, 19.763911361495644, 20.05299305046597, 23.7924622297287, 24.115096686407924, 23.767046846449375, 23.522788539528847, 23.274921394884586, 23.598228871822357, 23.681793908278138, 23.70316958675781, 23.591128798822552, 24.17024563997984, 23.644044771790504, 24.037152267992496, 25.940919515987233, 25.57124625643094, 25.50786059101422, 23.815445890650153, 23.122759982943535, 23.626431189477444, 21.11008793860674, 21.21666856855154, 20.49005088210106, 18.58752928798397, 18.62960685168703, 17.811558862527207, 27.26826876898606, 27.58947682132323, 27.550082118560866, 20.20905330280462, 20.573922055462987, 20.247179525593907, 23.840066629151494, 23.550073976318032, 23.488737071553857, 26.361840636857465, 25.72928101817766, 26.16368756691614, 23.170179945727185, 23.15231457104285, 22.764903863271073, 18.911931763092667, 19.430972893411905, 19.17164510736862, 22.27177223811546, 22.591961628446967, 22.800141555878014, 22.880539176364735, 22.933876131971672, 23.182084648249045, 19.11362072825432, 18.645873725414276, 19.38050012709573, 21.018357108036668, 20.95612859229246, 21.181293370823056, 18.50337789952755, 19.30530499992892, 19.020618326961994, 23.949754634251192, 23.883627639462546, 23.70783806343873, 27.490726855893925, 27.782411963989333, 27.78799945240219, 34.90447224428256, 35.13150723030169, 35.28691192468007, 21.498712301254272, 21.1727537214756, 20.855437740683556, 16.993700283269078, 16.815792861084134, 17.269048214579612, 20.215478916962937, 20.69218999271591, 20.4694483851393, 18.81792827447255, 19.34063754913707, 19.198947389920548, 16.37859984238942, 16.50100464870532, 15.737829943497971, 12.302358893056706, 12.685707562913493, 12.718434340630964, 28.992097661520035, 28.506727846960217, 28.69091413418451, 24.64284360781312, 24.360360749065876, 24.324627950787544, 21.397638118515403, 20.88944439093271, 21.525778009245784, 26.20470496515432, 26.350207204620034, 26.566674734155328, 17.428845723470047, 17.24318939944108, 17.63360660274823, 19.102456631759793, 19.39606454844275, 18.63375450174013, 33.56309700012207, 33.69618333131075, 33.30369441956282, 25.543423302471638, 25.559557273983955, 24.575606107711792, 24.218032752474144, 24.017271419366196, 24.465084840854004, 20.73040050764878, 20.961141933997467, 20.967665923138455, 16.764144234359264, 16.584016725420952, 16.97672598809004, 19.939394913613796, 19.923181295394897, 20.347246689721942, 20.697099854548767, 20.550160398085907, 20.79652442534764, 25.717229197422654, 25.628917465607316, 25.757184016207844, 26.102100325748324, 25.988094922155142, 25.733702838420868, 25.905146797498062, 25.910120982055858, 25.51161990811427, 25.696030400693417, 25.242712527513504, 25.79962858185172, 22.044166351358086, 22.584699454406888, 22.658803674081952, 20.536090582609177, 20.818042159080505, 20.208921283483505, 20.43727279213877, 20.018104786674172, 20.374403001430125, 17.430275549491242, 17.617525948521987, 17.57014694747825, 16.43708724776903, 16.77265500665331, 16.267840603987366, 15.807518025239304, 16.160954439391688, 16.389291584336505, 18.625318467617035, 19.11545629054308, 18.613610327243805, 17.264166514078767, 17.884495260814816, 17.517718637982995, 24.766585779686764, 24.82715907444556, 25.19981980261703, 21.955712094902992, 22.143515527248383, 22.152202159166336, 24.584381418923527, 24.41442574063936, 24.377638610700757, 28.596028082072735, 28.906351748853922, 28.69906398653984, 18.59949209044376, 18.761670256654412, 18.837904038528592, 20.495839367310197, 20.653072671654314, 20.660368148043432, 24.079857158164174, 24.30907883370915, 24.28881215552488, 24.811222185691193, 24.705281188090638, 25.288424385090664, 26.516052735348538, 26.915439189722136, 26.952088418727115, 28.34637414415677, 28.720196818312004, 28.358212669690445, 31.90376466264327, 32.143579592307404, 32.16457467650373, 26.445425618439913, 26.034109219908714, 25.927476435899734, 18.844431303441525, 18.943426609039307, 18.98629568517208, 23.186970617078856, 22.844115043679864, 22.438902998963982, 21.211802432934434, 21.184460068742425, 21.667728344599396, 22.807063706219196, 22.17764562368393, 22.41030803322792, 29.25286415219307, 29.205293089151382, 28.814505741000175, 23.496688539162278, 23.42360739596188, 23.058035373687744, 21.44961018239458, 21.209047624220446, 20.912407768269375, 18.372930762668446, 18.75567889710267, 18.847203663860753, 25.50038382907708, 25.69536619385083, 26.238672724304095, 14.854791713257626, 14.953501102825001, 15.124175538619355, 21.081579513847828, 21.30238650366664, 21.488164796610363, 23.006786095599324, 23.08010062823692, 23.204881908992917, 20.62224107980728, 20.585068754851818, 20.45944533497095, 17.04257011910279, 17.482548901190356, 17.566685010989502, 18.333756918708474, 17.978981430331856, 18.502778666714818, 19.614194711049393, 19.202533965309456, 18.89614239831765, 20.48525597651799, 19.930054952700928, 20.38313805808623, 31.29801552804807, 31.156310858825833, 31.00616284708181, 19.95876221855481, 19.721405384441212, 19.65522966285546, 27.890068632860974, 28.244315334906176, 28.281264682610825, 17.967083280285195, 18.12690821786721, 17.740672652920082, 16.051704719662666, 15.889053739607334, 16.401038476265967, 16.098511343200997, 16.365742435057953, 16.145553433646754, 25.832791741316512, 24.735444610317543, 25.522287053366497, 22.07721777198215, 21.896600936849907, 21.672179018457726, 20.302434708302215, 20.179033507903412, 20.3635547220086, 19.943549906214074, 20.11208364119132, 20.2686460626622, 27.737537937859685, 28.30745129256198, 28.224871911729366, 17.170590334882334, 16.64745361109574, 17.115814681475356, 20.74495022123058, 20.80742609625061, 20.896372543027, 18.18578768024841, 18.60650063926974, 18.416848159084708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14390059714968528, "mean_inference_ms": 0.6452499694801085, "mean_action_processing_ms": 0.09490275104725587, "mean_env_wait_ms": 0.8044241500708773, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 552000, "timesteps_this_iter": 0, "agent_timesteps_total": 1656000, "timers": {"sample_time_ms": 9293.751, "sample_throughput": 516.476, "load_time_ms": 0.2, "load_throughput": 24001739.628, "learn_time_ms": 1187.098, "learn_throughput": 4043.473, "update_time_ms": 1.427}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060067749023437506, "cur_lr": 0.0005, "total_loss": 6.1480796337127686, "policy_loss": 0.009631725079897374, "vf_loss": 6.264072239398956, "vf_explained_var": -0.06330768764019012, "kl": 0.04735114076188576, "entropy": 12.846843600273132, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 552000, "num_agent_steps_sampled": 1656000, "num_steps_trained": 552000, "num_agent_steps_trained": 1656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2769, "training_iteration": 115, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-00-42", "timestamp": 1706148042, "time_this_iter_s": 9.11835527420044, "time_total_s": 1082.638048171997, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021063471550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1082.638048171997, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 6.576923076923078, "ram_util_percent": 47.28461538461538}}
{"episode_reward_max": 105.32289139926432, "episode_reward_min": 37.70650079660116, "episode_reward_mean": 66.78804828536114, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.302358893056706}, "policy_reward_max": {"shared_policy": 35.28691192468007}, "policy_reward_mean": {"shared_policy": 22.262682761787044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.08739838004111, 57.51454976387319, 67.66387542244044, 68.99649995658545, 57.13999458076432, 63.15577907115218, 56.829301226418465, 71.54122033715247, 83.06113827228545, 105.32289139926432, 63.52690376341343, 51.078541358932824, 61.37711729481815, 57.35751321353017, 48.61743443459271, 37.70650079660116, 86.18973964266476, 73.32783230766654, 63.812860518693896, 79.12158690392968, 52.305641725659356, 57.13227568194267, 100.56297475099564, 75.67858668416739, 72.70038901269434, 62.6592083647847, 50.324886947870255, 60.209822898730636, 62.043784677982316, 77.10333067923781, 77.82389808632433, 77.32688768766819, 76.73837151005864, 67.28766947984693, 61.56305402517319, 60.82978058024307, 52.61794844549148, 49.477582858409704, 48.357764048967496, 56.35438508540392, 52.66638041287658, 74.79356465674935, 66.25142978131771, 73.37644577026364, 86.2014438174665, 56.199066385626764, 61.80928018700794, 72.6777481473982, 74.8049277588725, 80.38358034379779, 85.42478363215922, 96.2119189314544, 78.40701127424836, 56.77415359765291, 68.4699886597227, 64.06399084627625, 67.39501736313105, 87.27266298234463, 69.9783313088119, 63.5710655748844, 55.97581332363187, 77.434422747232, 44.93246835470198, 63.87213081412483, 69.29176863282916, 61.66675516963005, 52.09180403128265, 54.81551701575515, 57.7128710746765, 60.79844898730515, 93.46048923395571, 59.33539726585148, 84.41564865037797, 53.83466415107249, 48.34179693553597, 48.609807211905704, 76.09052340500055, 65.64599772728978, 60.84502293821423, 60.32427961006759, 84.26986114215103, 50.93385862745343, 62.44874886050819, 55.20913647860286, 69.46749453619121, 78.31476847082376, 65.62057641148566, 60.53491182997823, 80.19096230715512, 65.95137580111621, 82.40914777480063, 71.43923633464146, 62.72140297293663, 75.13538201525805, 56.910613431129605, 64.29778475873172, 85.59255632013081, 63.41788053140044, 67.97116287425158, 68.21262646839023], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.170179945727185, 23.15231457104285, 22.764903863271073, 18.911931763092667, 19.430972893411905, 19.17164510736862, 22.27177223811546, 22.591961628446967, 22.800141555878014, 22.880539176364735, 22.933876131971672, 23.182084648249045, 19.11362072825432, 18.645873725414276, 19.38050012709573, 21.018357108036668, 20.95612859229246, 21.181293370823056, 18.50337789952755, 19.30530499992892, 19.020618326961994, 23.949754634251192, 23.883627639462546, 23.70783806343873, 27.490726855893925, 27.782411963989333, 27.78799945240219, 34.90447224428256, 35.13150723030169, 35.28691192468007, 21.498712301254272, 21.1727537214756, 20.855437740683556, 16.993700283269078, 16.815792861084134, 17.269048214579612, 20.215478916962937, 20.69218999271591, 20.4694483851393, 18.81792827447255, 19.34063754913707, 19.198947389920548, 16.37859984238942, 16.50100464870532, 15.737829943497971, 12.302358893056706, 12.685707562913493, 12.718434340630964, 28.992097661520035, 28.506727846960217, 28.69091413418451, 24.64284360781312, 24.360360749065876, 24.324627950787544, 21.397638118515403, 20.88944439093271, 21.525778009245784, 26.20470496515432, 26.350207204620034, 26.566674734155328, 17.428845723470047, 17.24318939944108, 17.63360660274823, 19.102456631759793, 19.39606454844275, 18.63375450174013, 33.56309700012207, 33.69618333131075, 33.30369441956282, 25.543423302471638, 25.559557273983955, 24.575606107711792, 24.218032752474144, 24.017271419366196, 24.465084840854004, 20.73040050764878, 20.961141933997467, 20.967665923138455, 16.764144234359264, 16.584016725420952, 16.97672598809004, 19.939394913613796, 19.923181295394897, 20.347246689721942, 20.697099854548767, 20.550160398085907, 20.79652442534764, 25.717229197422654, 25.628917465607316, 25.757184016207844, 26.102100325748324, 25.988094922155142, 25.733702838420868, 25.905146797498062, 25.910120982055858, 25.51161990811427, 25.696030400693417, 25.242712527513504, 25.79962858185172, 22.044166351358086, 22.584699454406888, 22.658803674081952, 20.536090582609177, 20.818042159080505, 20.208921283483505, 20.43727279213877, 20.018104786674172, 20.374403001430125, 17.430275549491242, 17.617525948521987, 17.57014694747825, 16.43708724776903, 16.77265500665331, 16.267840603987366, 15.807518025239304, 16.160954439391688, 16.389291584336505, 18.625318467617035, 19.11545629054308, 18.613610327243805, 17.264166514078767, 17.884495260814816, 17.517718637982995, 24.766585779686764, 24.82715907444556, 25.19981980261703, 21.955712094902992, 22.143515527248383, 22.152202159166336, 24.584381418923527, 24.41442574063936, 24.377638610700757, 28.596028082072735, 28.906351748853922, 28.69906398653984, 18.59949209044376, 18.761670256654412, 18.837904038528592, 20.495839367310197, 20.653072671654314, 20.660368148043432, 24.079857158164174, 24.30907883370915, 24.28881215552488, 24.811222185691193, 24.705281188090638, 25.288424385090664, 26.516052735348538, 26.915439189722136, 26.952088418727115, 28.34637414415677, 28.720196818312004, 28.358212669690445, 31.90376466264327, 32.143579592307404, 32.16457467650373, 26.445425618439913, 26.034109219908714, 25.927476435899734, 18.844431303441525, 18.943426609039307, 18.98629568517208, 23.186970617078856, 22.844115043679864, 22.438902998963982, 21.211802432934434, 21.184460068742425, 21.667728344599396, 22.807063706219196, 22.17764562368393, 22.41030803322792, 29.25286415219307, 29.205293089151382, 28.814505741000175, 23.496688539162278, 23.42360739596188, 23.058035373687744, 21.44961018239458, 21.209047624220446, 20.912407768269375, 18.372930762668446, 18.75567889710267, 18.847203663860753, 25.50038382907708, 25.69536619385083, 26.238672724304095, 14.854791713257626, 14.953501102825001, 15.124175538619355, 21.081579513847828, 21.30238650366664, 21.488164796610363, 23.006786095599324, 23.08010062823692, 23.204881908992917, 20.62224107980728, 20.585068754851818, 20.45944533497095, 17.04257011910279, 17.482548901190356, 17.566685010989502, 18.333756918708474, 17.978981430331856, 18.502778666714818, 19.614194711049393, 19.202533965309456, 18.89614239831765, 20.48525597651799, 19.930054952700928, 20.38313805808623, 31.29801552804807, 31.156310858825833, 31.00616284708181, 19.95876221855481, 19.721405384441212, 19.65522966285546, 27.890068632860974, 28.244315334906176, 28.281264682610825, 17.967083280285195, 18.12690821786721, 17.740672652920082, 16.051704719662666, 15.889053739607334, 16.401038476265967, 16.098511343200997, 16.365742435057953, 16.145553433646754, 25.832791741316512, 24.735444610317543, 25.522287053366497, 22.07721777198215, 21.896600936849907, 21.672179018457726, 20.302434708302215, 20.179033507903412, 20.3635547220086, 19.943549906214074, 20.11208364119132, 20.2686460626622, 27.737537937859685, 28.30745129256198, 28.224871911729366, 17.170590334882334, 16.64745361109574, 17.115814681475356, 20.74495022123058, 20.80742609625061, 20.896372543027, 18.18578768024841, 18.60650063926974, 18.416848159084708, 22.955916707714394, 23.155703020592526, 23.35587480788429, 26.083665907382965, 26.208091124892235, 26.023011438548565, 21.88225059707959, 22.03385977943738, 21.70446603496869, 20.099884428083897, 20.23734972625971, 20.197677675634623, 26.728665386637047, 26.767770056923226, 26.694526863594845, 21.73816255231698, 22.38365889464815, 21.829554354151085, 27.47928041840592, 27.579297394181282, 27.350569962213427, 23.680605076253414, 24.007450184901245, 23.751181073486805, 20.879539012908936, 20.84815128147602, 20.993712678551674, 25.074778991440922, 25.10682641590634, 24.953776607910783, 18.826117120683193, 19.400733372662216, 18.683762937784195, 21.416073955595493, 21.531742235645652, 21.349968567490578, 28.4100602765878, 28.68426589419444, 28.498230149348572, 21.287416342645884, 21.203135170042515, 20.927329018712044, 22.564624617497117, 22.349999393026025, 23.056538863728434, 23.087759044021368, 22.332118421792984, 22.792749002575874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14383232332362714, "mean_inference_ms": 0.6452458583860394, "mean_action_processing_ms": 0.09490857000432229, "mean_env_wait_ms": 0.8042386366835609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 556800, "timesteps_this_iter": 0, "agent_timesteps_total": 1670400, "timers": {"sample_time_ms": 9265.983, "sample_throughput": 518.024, "load_time_ms": 0.1, "load_throughput": 47946318.647, "learn_time_ms": 1179.196, "learn_throughput": 4070.57, "update_time_ms": 1.33}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.5400407910346985, "policy_loss": 0.0048022233146467475, "vf_loss": 5.661981642246246, "vf_explained_var": -0.05337780714035034, "kl": 0.015441795665674517, "entropy": 12.81344723701477, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 556800, "num_agent_steps_sampled": 1670400, "num_steps_trained": 556800, "num_agent_steps_trained": 1670400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2785, "training_iteration": 116, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-00-51", "timestamp": 1706148051, "time_this_iter_s": 9.036060571670532, "time_total_s": 1091.6741087436676, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1091.6741087436676, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 6.5076923076923086, "ram_util_percent": 47.42307692307692}}
{"episode_reward_max": 100.56297475099564, "episode_reward_min": 44.93246835470198, "episode_reward_mean": 68.12550322491879, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.854791713257626}, "policy_reward_max": {"shared_policy": 33.69618333131075}, "policy_reward_mean": {"shared_policy": 22.708501074972926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.18973964266476, 73.32783230766654, 63.812860518693896, 79.12158690392968, 52.305641725659356, 57.13227568194267, 100.56297475099564, 75.67858668416739, 72.70038901269434, 62.6592083647847, 50.324886947870255, 60.209822898730636, 62.043784677982316, 77.10333067923781, 77.82389808632433, 77.32688768766819, 76.73837151005864, 67.28766947984693, 61.56305402517319, 60.82978058024307, 52.61794844549148, 49.477582858409704, 48.357764048967496, 56.35438508540392, 52.66638041287658, 74.79356465674935, 66.25142978131771, 73.37644577026364, 86.2014438174665, 56.199066385626764, 61.80928018700794, 72.6777481473982, 74.8049277588725, 80.38358034379779, 85.42478363215922, 96.2119189314544, 78.40701127424836, 56.77415359765291, 68.4699886597227, 64.06399084627625, 67.39501736313105, 87.27266298234463, 69.9783313088119, 63.5710655748844, 55.97581332363187, 77.434422747232, 44.93246835470198, 63.87213081412483, 69.29176863282916, 61.66675516963005, 52.09180403128265, 54.81551701575515, 57.7128710746765, 60.79844898730515, 93.46048923395571, 59.33539726585148, 84.41564865037797, 53.83466415107249, 48.34179693553597, 48.609807211905704, 76.09052340500055, 65.64599772728978, 60.84502293821423, 60.32427961006759, 84.26986114215103, 50.93385862745343, 62.44874886050819, 55.20913647860286, 69.46749453619121, 78.31476847082376, 65.62057641148566, 60.53491182997823, 80.19096230715512, 65.95137580111621, 82.40914777480063, 71.43923633464146, 62.72140297293663, 75.13538201525805, 56.910613431129605, 64.29778475873172, 85.59255632013081, 63.41788053140044, 67.97116287425158, 68.21262646839023, 73.70052419602868, 77.77944220788774, 51.315188798122094, 91.67125320434569, 92.69246085546911, 56.537311850930536, 84.21941316872834, 71.4566458016634, 51.121401519048945, 88.13800419049221, 58.12726297508924, 80.48680234514177, 84.69779659179036, 73.0899889115244, 72.17169728316364, 46.51695932820438], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.992097661520035, 28.506727846960217, 28.69091413418451, 24.64284360781312, 24.360360749065876, 24.324627950787544, 21.397638118515403, 20.88944439093271, 21.525778009245784, 26.20470496515432, 26.350207204620034, 26.566674734155328, 17.428845723470047, 17.24318939944108, 17.63360660274823, 19.102456631759793, 19.39606454844275, 18.63375450174013, 33.56309700012207, 33.69618333131075, 33.30369441956282, 25.543423302471638, 25.559557273983955, 24.575606107711792, 24.218032752474144, 24.017271419366196, 24.465084840854004, 20.73040050764878, 20.961141933997467, 20.967665923138455, 16.764144234359264, 16.584016725420952, 16.97672598809004, 19.939394913613796, 19.923181295394897, 20.347246689721942, 20.697099854548767, 20.550160398085907, 20.79652442534764, 25.717229197422654, 25.628917465607316, 25.757184016207844, 26.102100325748324, 25.988094922155142, 25.733702838420868, 25.905146797498062, 25.910120982055858, 25.51161990811427, 25.696030400693417, 25.242712527513504, 25.79962858185172, 22.044166351358086, 22.584699454406888, 22.658803674081952, 20.536090582609177, 20.818042159080505, 20.208921283483505, 20.43727279213877, 20.018104786674172, 20.374403001430125, 17.430275549491242, 17.617525948521987, 17.57014694747825, 16.43708724776903, 16.77265500665331, 16.267840603987366, 15.807518025239304, 16.160954439391688, 16.389291584336505, 18.625318467617035, 19.11545629054308, 18.613610327243805, 17.264166514078767, 17.884495260814816, 17.517718637982995, 24.766585779686764, 24.82715907444556, 25.19981980261703, 21.955712094902992, 22.143515527248383, 22.152202159166336, 24.584381418923527, 24.41442574063936, 24.377638610700757, 28.596028082072735, 28.906351748853922, 28.69906398653984, 18.59949209044376, 18.761670256654412, 18.837904038528592, 20.495839367310197, 20.653072671654314, 20.660368148043432, 24.079857158164174, 24.30907883370915, 24.28881215552488, 24.811222185691193, 24.705281188090638, 25.288424385090664, 26.516052735348538, 26.915439189722136, 26.952088418727115, 28.34637414415677, 28.720196818312004, 28.358212669690445, 31.90376466264327, 32.143579592307404, 32.16457467650373, 26.445425618439913, 26.034109219908714, 25.927476435899734, 18.844431303441525, 18.943426609039307, 18.98629568517208, 23.186970617078856, 22.844115043679864, 22.438902998963982, 21.211802432934434, 21.184460068742425, 21.667728344599396, 22.807063706219196, 22.17764562368393, 22.41030803322792, 29.25286415219307, 29.205293089151382, 28.814505741000175, 23.496688539162278, 23.42360739596188, 23.058035373687744, 21.44961018239458, 21.209047624220446, 20.912407768269375, 18.372930762668446, 18.75567889710267, 18.847203663860753, 25.50038382907708, 25.69536619385083, 26.238672724304095, 14.854791713257626, 14.953501102825001, 15.124175538619355, 21.081579513847828, 21.30238650366664, 21.488164796610363, 23.006786095599324, 23.08010062823692, 23.204881908992917, 20.62224107980728, 20.585068754851818, 20.45944533497095, 17.04257011910279, 17.482548901190356, 17.566685010989502, 18.333756918708474, 17.978981430331856, 18.502778666714818, 19.614194711049393, 19.202533965309456, 18.89614239831765, 20.48525597651799, 19.930054952700928, 20.38313805808623, 31.29801552804807, 31.156310858825833, 31.00616284708181, 19.95876221855481, 19.721405384441212, 19.65522966285546, 27.890068632860974, 28.244315334906176, 28.281264682610825, 17.967083280285195, 18.12690821786721, 17.740672652920082, 16.051704719662666, 15.889053739607334, 16.401038476265967, 16.098511343200997, 16.365742435057953, 16.145553433646754, 25.832791741316512, 24.735444610317543, 25.522287053366497, 22.07721777198215, 21.896600936849907, 21.672179018457726, 20.302434708302215, 20.179033507903412, 20.3635547220086, 19.943549906214074, 20.11208364119132, 20.2686460626622, 27.737537937859685, 28.30745129256198, 28.224871911729366, 17.170590334882334, 16.64745361109574, 17.115814681475356, 20.74495022123058, 20.80742609625061, 20.896372543027, 18.18578768024841, 18.60650063926974, 18.416848159084708, 22.955916707714394, 23.155703020592526, 23.35587480788429, 26.083665907382965, 26.208091124892235, 26.023011438548565, 21.88225059707959, 22.03385977943738, 21.70446603496869, 20.099884428083897, 20.23734972625971, 20.197677675634623, 26.728665386637047, 26.767770056923226, 26.694526863594845, 21.73816255231698, 22.38365889464815, 21.829554354151085, 27.47928041840592, 27.579297394181282, 27.350569962213427, 23.680605076253414, 24.007450184901245, 23.751181073486805, 20.879539012908936, 20.84815128147602, 20.993712678551674, 25.074778991440922, 25.10682641590634, 24.953776607910783, 18.826117120683193, 19.400733372662216, 18.683762937784195, 21.416073955595493, 21.531742235645652, 21.349968567490578, 28.4100602765878, 28.68426589419444, 28.498230149348572, 21.287416342645884, 21.203135170042515, 20.927329018712044, 22.564624617497117, 22.349999393026025, 23.056538863728434, 23.087759044021368, 22.332118421792984, 22.792749002575874, 24.480079325536877, 24.458851317564637, 24.761593552927167, 26.18000789421299, 25.79443724701801, 25.80499706665674, 16.52666153510411, 17.347909241293863, 17.44061802172412, 30.605428648491696, 30.684846100707844, 30.38097845514615, 31.09388652490452, 31.087218483444303, 30.511355847120285, 18.99815760696461, 18.841136055688054, 18.69801818827787, 28.27080689122279, 28.021826331814125, 27.926779945691422, 23.71043436229229, 23.894410952925682, 23.851800486445427, 17.14789014620085, 16.75143552323182, 17.222075849616274, 29.726542924065143, 29.757620948104886, 28.65384031832218, 19.30658611034353, 19.412529277925685, 19.40814758682002, 26.400881499052048, 27.132308507338166, 26.953612338751554, 28.138757857183606, 28.20726929853359, 28.35176943607317, 24.14369461437066, 24.201787089308098, 24.744507207845643, 23.807351263860852, 24.207349457467586, 24.1569965618352, 15.353171383341149, 15.423482996722058, 15.740304948141173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1437662039883506, "mean_inference_ms": 0.6452437095979632, "mean_action_processing_ms": 0.09491502030339115, "mean_env_wait_ms": 0.8040554523445445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 561600, "timesteps_this_iter": 0, "agent_timesteps_total": 1684800, "timers": {"sample_time_ms": 9213.213, "sample_throughput": 520.991, "load_time_ms": 0.2, "load_throughput": 23984583.274, "learn_time_ms": 1180.399, "learn_throughput": 4066.422, "update_time_ms": 1.329}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 8.085603713989258, "policy_loss": 0.0018986570293457739, "vf_loss": 8.213526368141174, "vf_explained_var": -0.04265192151069641, "kl": 0.011400270799783466, "entropy": 13.084803104400635, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 561600, "num_agent_steps_sampled": 1684800, "num_steps_trained": 561600, "num_agent_steps_trained": 1684800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2801, "training_iteration": 117, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-01-00", "timestamp": 1706148060, "time_this_iter_s": 9.18461012840271, "time_total_s": 1100.8587188720703, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055ECA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1100.8587188720703, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 9.584615384615384, "ram_util_percent": 46.94615384615384}}
{"episode_reward_max": 96.2119189314544, "episode_reward_min": 30.961684726178632, "episode_reward_mean": 67.21156414250581, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.934432839353875}, "policy_reward_max": {"shared_policy": 32.16457467650373}, "policy_reward_mean": {"shared_policy": 22.4038547141686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.73837151005864, 67.28766947984693, 61.56305402517319, 60.82978058024307, 52.61794844549148, 49.477582858409704, 48.357764048967496, 56.35438508540392, 52.66638041287658, 74.79356465674935, 66.25142978131771, 73.37644577026364, 86.2014438174665, 56.199066385626764, 61.80928018700794, 72.6777481473982, 74.8049277588725, 80.38358034379779, 85.42478363215922, 96.2119189314544, 78.40701127424836, 56.77415359765291, 68.4699886597227, 64.06399084627625, 67.39501736313105, 87.27266298234463, 69.9783313088119, 63.5710655748844, 55.97581332363187, 77.434422747232, 44.93246835470198, 63.87213081412483, 69.29176863282916, 61.66675516963005, 52.09180403128265, 54.81551701575515, 57.7128710746765, 60.79844898730515, 93.46048923395571, 59.33539726585148, 84.41564865037797, 53.83466415107249, 48.34179693553597, 48.609807211905704, 76.09052340500055, 65.64599772728978, 60.84502293821423, 60.32427961006759, 84.26986114215103, 50.93385862745343, 62.44874886050819, 55.20913647860286, 69.46749453619121, 78.31476847082376, 65.62057641148566, 60.53491182997823, 80.19096230715512, 65.95137580111621, 82.40914777480063, 71.43923633464146, 62.72140297293663, 75.13538201525805, 56.910613431129605, 64.29778475873172, 85.59255632013081, 63.41788053140044, 67.97116287425158, 68.21262646839023, 73.70052419602868, 77.77944220788774, 51.315188798122094, 91.67125320434569, 92.69246085546911, 56.537311850930536, 84.21941316872834, 71.4566458016634, 51.121401519048945, 88.13800419049221, 58.12726297508924, 80.48680234514177, 84.69779659179036, 73.0899889115244, 72.17169728316364, 46.51695932820438, 75.43097188323735, 81.74899762123822, 32.676770087331505, 71.19684063643214, 59.14856220176442, 30.961684726178632, 86.98456822242588, 51.82445769384502, 63.29230160731821, 69.53962858021256, 72.73378089815375, 60.228708393871756, 70.70960351172832, 63.37198020145297, 69.9747602418065, 77.10618182271718], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.696030400693417, 25.242712527513504, 25.79962858185172, 22.044166351358086, 22.584699454406888, 22.658803674081952, 20.536090582609177, 20.818042159080505, 20.208921283483505, 20.43727279213877, 20.018104786674172, 20.374403001430125, 17.430275549491242, 17.617525948521987, 17.57014694747825, 16.43708724776903, 16.77265500665331, 16.267840603987366, 15.807518025239304, 16.160954439391688, 16.389291584336505, 18.625318467617035, 19.11545629054308, 18.613610327243805, 17.264166514078767, 17.884495260814816, 17.517718637982995, 24.766585779686764, 24.82715907444556, 25.19981980261703, 21.955712094902992, 22.143515527248383, 22.152202159166336, 24.584381418923527, 24.41442574063936, 24.377638610700757, 28.596028082072735, 28.906351748853922, 28.69906398653984, 18.59949209044376, 18.761670256654412, 18.837904038528592, 20.495839367310197, 20.653072671654314, 20.660368148043432, 24.079857158164174, 24.30907883370915, 24.28881215552488, 24.811222185691193, 24.705281188090638, 25.288424385090664, 26.516052735348538, 26.915439189722136, 26.952088418727115, 28.34637414415677, 28.720196818312004, 28.358212669690445, 31.90376466264327, 32.143579592307404, 32.16457467650373, 26.445425618439913, 26.034109219908714, 25.927476435899734, 18.844431303441525, 18.943426609039307, 18.98629568517208, 23.186970617078856, 22.844115043679864, 22.438902998963982, 21.211802432934434, 21.184460068742425, 21.667728344599396, 22.807063706219196, 22.17764562368393, 22.41030803322792, 29.25286415219307, 29.205293089151382, 28.814505741000175, 23.496688539162278, 23.42360739596188, 23.058035373687744, 21.44961018239458, 21.209047624220446, 20.912407768269375, 18.372930762668446, 18.75567889710267, 18.847203663860753, 25.50038382907708, 25.69536619385083, 26.238672724304095, 14.854791713257626, 14.953501102825001, 15.124175538619355, 21.081579513847828, 21.30238650366664, 21.488164796610363, 23.006786095599324, 23.08010062823692, 23.204881908992917, 20.62224107980728, 20.585068754851818, 20.45944533497095, 17.04257011910279, 17.482548901190356, 17.566685010989502, 18.333756918708474, 17.978981430331856, 18.502778666714818, 19.614194711049393, 19.202533965309456, 18.89614239831765, 20.48525597651799, 19.930054952700928, 20.38313805808623, 31.29801552804807, 31.156310858825833, 31.00616284708181, 19.95876221855481, 19.721405384441212, 19.65522966285546, 27.890068632860974, 28.244315334906176, 28.281264682610825, 17.967083280285195, 18.12690821786721, 17.740672652920082, 16.051704719662666, 15.889053739607334, 16.401038476265967, 16.098511343200997, 16.365742435057953, 16.145553433646754, 25.832791741316512, 24.735444610317543, 25.522287053366497, 22.07721777198215, 21.896600936849907, 21.672179018457726, 20.302434708302215, 20.179033507903412, 20.3635547220086, 19.943549906214074, 20.11208364119132, 20.2686460626622, 27.737537937859685, 28.30745129256198, 28.224871911729366, 17.170590334882334, 16.64745361109574, 17.115814681475356, 20.74495022123058, 20.80742609625061, 20.896372543027, 18.18578768024841, 18.60650063926974, 18.416848159084708, 22.955916707714394, 23.155703020592526, 23.35587480788429, 26.083665907382965, 26.208091124892235, 26.023011438548565, 21.88225059707959, 22.03385977943738, 21.70446603496869, 20.099884428083897, 20.23734972625971, 20.197677675634623, 26.728665386637047, 26.767770056923226, 26.694526863594845, 21.73816255231698, 22.38365889464815, 21.829554354151085, 27.47928041840592, 27.579297394181282, 27.350569962213427, 23.680605076253414, 24.007450184901245, 23.751181073486805, 20.879539012908936, 20.84815128147602, 20.993712678551674, 25.074778991440922, 25.10682641590634, 24.953776607910783, 18.826117120683193, 19.400733372662216, 18.683762937784195, 21.416073955595493, 21.531742235645652, 21.349968567490578, 28.4100602765878, 28.68426589419444, 28.498230149348572, 21.287416342645884, 21.203135170042515, 20.927329018712044, 22.564624617497117, 22.349999393026025, 23.056538863728434, 23.087759044021368, 22.332118421792984, 22.792749002575874, 24.480079325536877, 24.458851317564637, 24.761593552927167, 26.18000789421299, 25.79443724701801, 25.80499706665674, 16.52666153510411, 17.347909241293863, 17.44061802172412, 30.605428648491696, 30.684846100707844, 30.38097845514615, 31.09388652490452, 31.087218483444303, 30.511355847120285, 18.99815760696461, 18.841136055688054, 18.69801818827787, 28.27080689122279, 28.021826331814125, 27.926779945691422, 23.71043436229229, 23.894410952925682, 23.851800486445427, 17.14789014620085, 16.75143552323182, 17.222075849616274, 29.726542924065143, 29.757620948104886, 28.65384031832218, 19.30658611034353, 19.412529277925685, 19.40814758682002, 26.400881499052048, 27.132308507338166, 26.953612338751554, 28.138757857183606, 28.20726929853359, 28.35176943607317, 24.14369461437066, 24.201787089308098, 24.744507207845643, 23.807351263860852, 24.207349457467586, 24.1569965618352, 15.353171383341149, 15.423482996722058, 15.740304948141173, 25.041026776035622, 25.468153101702526, 24.9217920054992, 26.912274365623787, 27.601332557698086, 27.235390697916344, 10.972264873484761, 11.076823918769747, 10.627681295076997, 23.57712749640146, 23.836820761362702, 23.78289237866798, 19.845534106095627, 19.01409625013669, 20.288931845532105, 10.25326184680064, 9.934432839353875, 10.773990040024117, 28.89588413387537, 29.20614658948034, 28.882537499070168, 17.541601860274866, 17.129796033104256, 17.153059800465897, 21.25593937405695, 21.045851548512772, 20.990510684748486, 23.100546496609837, 23.048003474871308, 23.39107860873142, 24.22602895895639, 24.327056708435208, 24.180695230762154, 20.144677909711987, 20.00815816471973, 20.075872319440037, 23.714296794186026, 23.741723745750875, 23.253582971791417, 21.310639068484306, 20.846410304307938, 21.214930828660727, 23.336120290060833, 23.321014647682503, 23.317625304063156, 25.800639202197388, 25.53559500475724, 25.769947615762547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14370030908710493, "mean_inference_ms": 0.6452517779591251, "mean_action_processing_ms": 0.09493145793440094, "mean_env_wait_ms": 0.803892100345444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 566400, "timesteps_this_iter": 0, "agent_timesteps_total": 1699200, "timers": {"sample_time_ms": 9200.659, "sample_throughput": 521.702, "load_time_ms": 0.2, "load_throughput": 23984583.274, "learn_time_ms": 1181.505, "learn_throughput": 4062.614, "update_time_ms": 1.429}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.927486419677734, "policy_loss": -0.0018345072671905882, "vf_loss": 6.060799062252045, "vf_explained_var": -0.045331329107284546, "kl": 0.007229384384266998, "entropy": 13.212966442108154, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 566400, "num_agent_steps_sampled": 1699200, "num_steps_trained": 566400, "num_agent_steps_trained": 1699200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2817, "training_iteration": 118, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-01-09", "timestamp": 1706148069, "time_this_iter_s": 9.201971769332886, "time_total_s": 1110.0606906414032, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1110.0606906414032, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 10.515384615384615, "ram_util_percent": 46.653846153846175}}
{"episode_reward_max": 96.2119189314544, "episode_reward_min": 18.399143010843517, "episode_reward_mean": 66.48353686783783, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.940221431354672}, "policy_reward_max": {"shared_policy": 32.16457467650373}, "policy_reward_mean": {"shared_policy": 22.161178955945935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.8049277588725, 80.38358034379779, 85.42478363215922, 96.2119189314544, 78.40701127424836, 56.77415359765291, 68.4699886597227, 64.06399084627625, 67.39501736313105, 87.27266298234463, 69.9783313088119, 63.5710655748844, 55.97581332363187, 77.434422747232, 44.93246835470198, 63.87213081412483, 69.29176863282916, 61.66675516963005, 52.09180403128265, 54.81551701575515, 57.7128710746765, 60.79844898730515, 93.46048923395571, 59.33539726585148, 84.41564865037797, 53.83466415107249, 48.34179693553597, 48.609807211905704, 76.09052340500055, 65.64599772728978, 60.84502293821423, 60.32427961006759, 84.26986114215103, 50.93385862745343, 62.44874886050819, 55.20913647860286, 69.46749453619121, 78.31476847082376, 65.62057641148566, 60.53491182997823, 80.19096230715512, 65.95137580111621, 82.40914777480063, 71.43923633464146, 62.72140297293663, 75.13538201525805, 56.910613431129605, 64.29778475873172, 85.59255632013081, 63.41788053140044, 67.97116287425158, 68.21262646839023, 73.70052419602868, 77.77944220788774, 51.315188798122094, 91.67125320434569, 92.69246085546911, 56.537311850930536, 84.21941316872834, 71.4566458016634, 51.121401519048945, 88.13800419049221, 58.12726297508924, 80.48680234514177, 84.69779659179036, 73.0899889115244, 72.17169728316364, 46.51695932820438, 75.43097188323735, 81.74899762123822, 32.676770087331505, 71.19684063643214, 59.14856220176442, 30.961684726178632, 86.98456822242588, 51.82445769384502, 63.29230160731821, 69.53962858021256, 72.73378089815375, 60.228708393871756, 70.70960351172832, 63.37198020145297, 69.9747602418065, 77.10618182271718, 67.33093975111842, 41.32033036090432, 79.49975490942597, 18.399143010843517, 51.91577473375946, 67.11538234353064, 91.14125788584352, 32.20965415984392, 65.02423075959085, 69.20853118784724, 54.12862648069856, 67.8792946115136, 56.39243516325948, 73.59103514347225, 65.77507404237986, 43.46772318147123], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.811222185691193, 24.705281188090638, 25.288424385090664, 26.516052735348538, 26.915439189722136, 26.952088418727115, 28.34637414415677, 28.720196818312004, 28.358212669690445, 31.90376466264327, 32.143579592307404, 32.16457467650373, 26.445425618439913, 26.034109219908714, 25.927476435899734, 18.844431303441525, 18.943426609039307, 18.98629568517208, 23.186970617078856, 22.844115043679864, 22.438902998963982, 21.211802432934434, 21.184460068742425, 21.667728344599396, 22.807063706219196, 22.17764562368393, 22.41030803322792, 29.25286415219307, 29.205293089151382, 28.814505741000175, 23.496688539162278, 23.42360739596188, 23.058035373687744, 21.44961018239458, 21.209047624220446, 20.912407768269375, 18.372930762668446, 18.75567889710267, 18.847203663860753, 25.50038382907708, 25.69536619385083, 26.238672724304095, 14.854791713257626, 14.953501102825001, 15.124175538619355, 21.081579513847828, 21.30238650366664, 21.488164796610363, 23.006786095599324, 23.08010062823692, 23.204881908992917, 20.62224107980728, 20.585068754851818, 20.45944533497095, 17.04257011910279, 17.482548901190356, 17.566685010989502, 18.333756918708474, 17.978981430331856, 18.502778666714818, 19.614194711049393, 19.202533965309456, 18.89614239831765, 20.48525597651799, 19.930054952700928, 20.38313805808623, 31.29801552804807, 31.156310858825833, 31.00616284708181, 19.95876221855481, 19.721405384441212, 19.65522966285546, 27.890068632860974, 28.244315334906176, 28.281264682610825, 17.967083280285195, 18.12690821786721, 17.740672652920082, 16.051704719662666, 15.889053739607334, 16.401038476265967, 16.098511343200997, 16.365742435057953, 16.145553433646754, 25.832791741316512, 24.735444610317543, 25.522287053366497, 22.07721777198215, 21.896600936849907, 21.672179018457726, 20.302434708302215, 20.179033507903412, 20.3635547220086, 19.943549906214074, 20.11208364119132, 20.2686460626622, 27.737537937859685, 28.30745129256198, 28.224871911729366, 17.170590334882334, 16.64745361109574, 17.115814681475356, 20.74495022123058, 20.80742609625061, 20.896372543027, 18.18578768024841, 18.60650063926974, 18.416848159084708, 22.955916707714394, 23.155703020592526, 23.35587480788429, 26.083665907382965, 26.208091124892235, 26.023011438548565, 21.88225059707959, 22.03385977943738, 21.70446603496869, 20.099884428083897, 20.23734972625971, 20.197677675634623, 26.728665386637047, 26.767770056923226, 26.694526863594845, 21.73816255231698, 22.38365889464815, 21.829554354151085, 27.47928041840592, 27.579297394181282, 27.350569962213427, 23.680605076253414, 24.007450184901245, 23.751181073486805, 20.879539012908936, 20.84815128147602, 20.993712678551674, 25.074778991440922, 25.10682641590634, 24.953776607910783, 18.826117120683193, 19.400733372662216, 18.683762937784195, 21.416073955595493, 21.531742235645652, 21.349968567490578, 28.4100602765878, 28.68426589419444, 28.498230149348572, 21.287416342645884, 21.203135170042515, 20.927329018712044, 22.564624617497117, 22.349999393026025, 23.056538863728434, 23.087759044021368, 22.332118421792984, 22.792749002575874, 24.480079325536877, 24.458851317564637, 24.761593552927167, 26.18000789421299, 25.79443724701801, 25.80499706665674, 16.52666153510411, 17.347909241293863, 17.44061802172412, 30.605428648491696, 30.684846100707844, 30.38097845514615, 31.09388652490452, 31.087218483444303, 30.511355847120285, 18.99815760696461, 18.841136055688054, 18.69801818827787, 28.27080689122279, 28.021826331814125, 27.926779945691422, 23.71043436229229, 23.894410952925682, 23.851800486445427, 17.14789014620085, 16.75143552323182, 17.222075849616274, 29.726542924065143, 29.757620948104886, 28.65384031832218, 19.30658611034353, 19.412529277925685, 19.40814758682002, 26.400881499052048, 27.132308507338166, 26.953612338751554, 28.138757857183606, 28.20726929853359, 28.35176943607317, 24.14369461437066, 24.201787089308098, 24.744507207845643, 23.807351263860852, 24.207349457467586, 24.1569965618352, 15.353171383341149, 15.423482996722058, 15.740304948141173, 25.041026776035622, 25.468153101702526, 24.9217920054992, 26.912274365623787, 27.601332557698086, 27.235390697916344, 10.972264873484761, 11.076823918769747, 10.627681295076997, 23.57712749640146, 23.836820761362702, 23.78289237866798, 19.845534106095627, 19.01409625013669, 20.288931845532105, 10.25326184680064, 9.934432839353875, 10.773990040024117, 28.89588413387537, 29.20614658948034, 28.882537499070168, 17.541601860274866, 17.129796033104256, 17.153059800465897, 21.25593937405695, 21.045851548512772, 20.990510684748486, 23.100546496609837, 23.048003474871308, 23.39107860873142, 24.22602895895639, 24.327056708435208, 24.180695230762154, 20.144677909711987, 20.00815816471973, 20.075872319440037, 23.714296794186026, 23.741723745750875, 23.253582971791417, 21.310639068484306, 20.846410304307938, 21.214930828660727, 23.336120290060833, 23.321014647682503, 23.317625304063156, 25.800639202197388, 25.53559500475724, 25.769947615762547, 22.441321909427643, 22.445798246189952, 22.443819595500827, 13.67047508557637, 13.528334399064377, 14.121520876263574, 26.63521556928754, 26.56159334629774, 26.302945993840694, 6.391068424253405, 5.940221431354672, 6.06785315523544, 17.534337983466685, 17.278229355812073, 17.103207394480705, 22.475819443662957, 22.253934038182095, 22.38562886168559, 30.171156346797943, 30.33444021642208, 30.63566132262349, 10.809570584446192, 10.958219800144434, 10.441863775253296, 21.74338302885492, 21.559654430796698, 21.72119329993923, 23.036970571925238, 23.046112434317664, 23.12544818160434, 18.041673230628163, 18.23484760026136, 17.852105649809033, 22.26592867573102, 22.625077803929642, 22.98828813185294, 18.918656828502805, 19.16763079414764, 18.306147540609032, 24.55911120865494, 24.50840190052986, 24.523522034287453, 21.71904730796814, 22.20824635773897, 21.847780376672745, 14.584261782467365, 14.900296254083514, 13.98316514492035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14363435867966542, "mean_inference_ms": 0.6452416875358827, "mean_action_processing_ms": 0.0949354930913148, "mean_env_wait_ms": 0.803701546056448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 571200, "timesteps_this_iter": 0, "agent_timesteps_total": 1713600, "timers": {"sample_time_ms": 9198.123, "sample_throughput": 521.846, "load_time_ms": 0.2, "load_throughput": 23984583.274, "learn_time_ms": 1182.505, "learn_throughput": 4059.179, "update_time_ms": 1.529}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.781986892223358, "policy_loss": -0.0009519957850433469, "vf_loss": 5.913870334625244, "vf_explained_var": -0.037722066044807434, "kl": 0.0066242509057376255, "entropy": 13.15283191204071, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 571200, "num_agent_steps_sampled": 1713600, "num_steps_trained": 571200, "num_agent_steps_trained": 1713600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2833, "training_iteration": 119, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-01-18", "timestamp": 1706148078, "time_this_iter_s": 9.041311502456665, "time_total_s": 1119.1020021438599, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1C820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1119.1020021438599, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 6.115384615384617, "ram_util_percent": 46.65384615384615}}
{"episode_reward_max": 97.98385266959667, "episode_reward_min": 17.896646558074266, "episode_reward_mean": 64.8957055212857, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.8792915691931995}, "policy_reward_max": {"shared_policy": 32.85228157043457}, "policy_reward_mean": {"shared_policy": 21.631901840428565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.29176863282916, 61.66675516963005, 52.09180403128265, 54.81551701575515, 57.7128710746765, 60.79844898730515, 93.46048923395571, 59.33539726585148, 84.41564865037797, 53.83466415107249, 48.34179693553597, 48.609807211905704, 76.09052340500055, 65.64599772728978, 60.84502293821423, 60.32427961006759, 84.26986114215103, 50.93385862745343, 62.44874886050819, 55.20913647860286, 69.46749453619121, 78.31476847082376, 65.62057641148566, 60.53491182997823, 80.19096230715512, 65.95137580111621, 82.40914777480063, 71.43923633464146, 62.72140297293663, 75.13538201525805, 56.910613431129605, 64.29778475873172, 85.59255632013081, 63.41788053140044, 67.97116287425158, 68.21262646839023, 73.70052419602868, 77.77944220788774, 51.315188798122094, 91.67125320434569, 92.69246085546911, 56.537311850930536, 84.21941316872834, 71.4566458016634, 51.121401519048945, 88.13800419049221, 58.12726297508924, 80.48680234514177, 84.69779659179036, 73.0899889115244, 72.17169728316364, 46.51695932820438, 75.43097188323735, 81.74899762123822, 32.676770087331505, 71.19684063643214, 59.14856220176442, 30.961684726178632, 86.98456822242588, 51.82445769384502, 63.29230160731821, 69.53962858021256, 72.73378089815375, 60.228708393871756, 70.70960351172832, 63.37198020145297, 69.9747602418065, 77.10618182271718, 67.33093975111842, 41.32033036090432, 79.49975490942597, 18.399143010843517, 51.91577473375946, 67.11538234353064, 91.14125788584352, 32.20965415984392, 65.02423075959085, 69.20853118784724, 54.12862648069856, 67.8792946115136, 56.39243516325948, 73.59103514347225, 65.77507404237986, 43.46772318147123, 57.438752812100546, 97.98385266959667, 74.25578465964642, 68.31946524512023, 66.87183946371076, 56.816611800342784, 85.58426968217827, 70.16783813014627, 38.46973601728678, 64.08028099685905, 55.75435610488054, 52.77275960892436, 69.87319488078354, 47.124028332531424, 52.77971589565277, 17.896646558074266], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.006786095599324, 23.08010062823692, 23.204881908992917, 20.62224107980728, 20.585068754851818, 20.45944533497095, 17.04257011910279, 17.482548901190356, 17.566685010989502, 18.333756918708474, 17.978981430331856, 18.502778666714818, 19.614194711049393, 19.202533965309456, 18.89614239831765, 20.48525597651799, 19.930054952700928, 20.38313805808623, 31.29801552804807, 31.156310858825833, 31.00616284708181, 19.95876221855481, 19.721405384441212, 19.65522966285546, 27.890068632860974, 28.244315334906176, 28.281264682610825, 17.967083280285195, 18.12690821786721, 17.740672652920082, 16.051704719662666, 15.889053739607334, 16.401038476265967, 16.098511343200997, 16.365742435057953, 16.145553433646754, 25.832791741316512, 24.735444610317543, 25.522287053366497, 22.07721777198215, 21.896600936849907, 21.672179018457726, 20.302434708302215, 20.179033507903412, 20.3635547220086, 19.943549906214074, 20.11208364119132, 20.2686460626622, 27.737537937859685, 28.30745129256198, 28.224871911729366, 17.170590334882334, 16.64745361109574, 17.115814681475356, 20.74495022123058, 20.80742609625061, 20.896372543027, 18.18578768024841, 18.60650063926974, 18.416848159084708, 22.955916707714394, 23.155703020592526, 23.35587480788429, 26.083665907382965, 26.208091124892235, 26.023011438548565, 21.88225059707959, 22.03385977943738, 21.70446603496869, 20.099884428083897, 20.23734972625971, 20.197677675634623, 26.728665386637047, 26.767770056923226, 26.694526863594845, 21.73816255231698, 22.38365889464815, 21.829554354151085, 27.47928041840592, 27.579297394181282, 27.350569962213427, 23.680605076253414, 24.007450184901245, 23.751181073486805, 20.879539012908936, 20.84815128147602, 20.993712678551674, 25.074778991440922, 25.10682641590634, 24.953776607910783, 18.826117120683193, 19.400733372662216, 18.683762937784195, 21.416073955595493, 21.531742235645652, 21.349968567490578, 28.4100602765878, 28.68426589419444, 28.498230149348572, 21.287416342645884, 21.203135170042515, 20.927329018712044, 22.564624617497117, 22.349999393026025, 23.056538863728434, 23.087759044021368, 22.332118421792984, 22.792749002575874, 24.480079325536877, 24.458851317564637, 24.761593552927167, 26.18000789421299, 25.79443724701801, 25.80499706665674, 16.52666153510411, 17.347909241293863, 17.44061802172412, 30.605428648491696, 30.684846100707844, 30.38097845514615, 31.09388652490452, 31.087218483444303, 30.511355847120285, 18.99815760696461, 18.841136055688054, 18.69801818827787, 28.27080689122279, 28.021826331814125, 27.926779945691422, 23.71043436229229, 23.894410952925682, 23.851800486445427, 17.14789014620085, 16.75143552323182, 17.222075849616274, 29.726542924065143, 29.757620948104886, 28.65384031832218, 19.30658611034353, 19.412529277925685, 19.40814758682002, 26.400881499052048, 27.132308507338166, 26.953612338751554, 28.138757857183606, 28.20726929853359, 28.35176943607317, 24.14369461437066, 24.201787089308098, 24.744507207845643, 23.807351263860852, 24.207349457467586, 24.1569965618352, 15.353171383341149, 15.423482996722058, 15.740304948141173, 25.041026776035622, 25.468153101702526, 24.9217920054992, 26.912274365623787, 27.601332557698086, 27.235390697916344, 10.972264873484761, 11.076823918769747, 10.627681295076997, 23.57712749640146, 23.836820761362702, 23.78289237866798, 19.845534106095627, 19.01409625013669, 20.288931845532105, 10.25326184680064, 9.934432839353875, 10.773990040024117, 28.89588413387537, 29.20614658948034, 28.882537499070168, 17.541601860274866, 17.129796033104256, 17.153059800465897, 21.25593937405695, 21.045851548512772, 20.990510684748486, 23.100546496609837, 23.048003474871308, 23.39107860873142, 24.22602895895639, 24.327056708435208, 24.180695230762154, 20.144677909711987, 20.00815816471973, 20.075872319440037, 23.714296794186026, 23.741723745750875, 23.253582971791417, 21.310639068484306, 20.846410304307938, 21.214930828660727, 23.336120290060833, 23.321014647682503, 23.317625304063156, 25.800639202197388, 25.53559500475724, 25.769947615762547, 22.441321909427643, 22.445798246189952, 22.443819595500827, 13.67047508557637, 13.528334399064377, 14.121520876263574, 26.63521556928754, 26.56159334629774, 26.302945993840694, 6.391068424253405, 5.940221431354672, 6.06785315523544, 17.534337983466685, 17.278229355812073, 17.103207394480705, 22.475819443662957, 22.253934038182095, 22.38562886168559, 30.171156346797943, 30.33444021642208, 30.63566132262349, 10.809570584446192, 10.958219800144434, 10.441863775253296, 21.74338302885492, 21.559654430796698, 21.72119329993923, 23.036970571925238, 23.046112434317664, 23.12544818160434, 18.041673230628163, 18.23484760026136, 17.852105649809033, 22.26592867573102, 22.625077803929642, 22.98828813185294, 18.918656828502805, 19.16763079414764, 18.306147540609032, 24.55911120865494, 24.50840190052986, 24.523522034287453, 21.71904730796814, 22.20824635773897, 21.847780376672745, 14.584261782467365, 14.900296254083514, 13.98316514492035, 19.24421841596873, 19.142642742643744, 19.05189165348807, 32.58832951635122, 32.85228157043457, 32.54324158281088, 24.646130094925553, 24.705095293621213, 24.904559271099657, 22.97067394386977, 22.728635989129543, 22.620155312120914, 22.20311279098192, 22.42400812606016, 22.24471854666868, 18.915711631377533, 18.969587878634528, 18.931312290330723, 28.21944633126259, 28.378707259893417, 28.986116091022268, 23.428717087954283, 23.180290684103966, 23.558830358088017, 13.17630860954523, 12.621655985713005, 12.671771422028542, 21.424859358618647, 21.081705416242272, 21.573716221998126, 18.4716827298204, 18.476969028512627, 18.805704346547515, 17.292151289681584, 17.86190242196122, 17.618705897281558, 23.55289177348216, 23.241264720757798, 23.079038386543587, 15.425692106286675, 15.919288637737424, 15.779047588507325, 17.731779396533966, 17.372592642903328, 17.675343856215477, 6.118548914867759, 5.8792915691931995, 5.898806074013308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14357882831828672, "mean_inference_ms": 0.6452048872374216, "mean_action_processing_ms": 0.09492707754973473, "mean_env_wait_ms": 0.8034959278290031, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 576000, "timesteps_this_iter": 0, "agent_timesteps_total": 1728000, "timers": {"sample_time_ms": 9213.442, "sample_throughput": 520.978, "load_time_ms": 0.2, "load_throughput": 23984583.274, "learn_time_ms": 1181.607, "learn_throughput": 4062.265, "update_time_ms": 1.529}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.825518786907196, "policy_loss": -0.0023300472428107177, "vf_loss": 5.95891946554184, "vf_explained_var": -0.018729180097579956, "kl": 0.006634350633399375, "entropy": 13.166845202445984, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 576000, "num_agent_steps_sampled": 1728000, "num_steps_trained": 576000, "num_agent_steps_trained": 1728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2849, "training_iteration": 120, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-01-28", "timestamp": 1706148088, "time_this_iter_s": 9.251301765441895, "time_total_s": 1128.3533039093018, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1C790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1128.3533039093018, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 6.615384615384615, "ram_util_percent": 46.66153846153846}}
{"episode_reward_max": 97.98385266959667, "episode_reward_min": 17.896646558074266, "episode_reward_mean": 64.99360627745459, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.8792915691931995}, "policy_reward_max": {"shared_policy": 32.85228157043457}, "policy_reward_mean": {"shared_policy": 21.664535425818187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.26986114215103, 50.93385862745343, 62.44874886050819, 55.20913647860286, 69.46749453619121, 78.31476847082376, 65.62057641148566, 60.53491182997823, 80.19096230715512, 65.95137580111621, 82.40914777480063, 71.43923633464146, 62.72140297293663, 75.13538201525805, 56.910613431129605, 64.29778475873172, 85.59255632013081, 63.41788053140044, 67.97116287425158, 68.21262646839023, 73.70052419602868, 77.77944220788774, 51.315188798122094, 91.67125320434569, 92.69246085546911, 56.537311850930536, 84.21941316872834, 71.4566458016634, 51.121401519048945, 88.13800419049221, 58.12726297508924, 80.48680234514177, 84.69779659179036, 73.0899889115244, 72.17169728316364, 46.51695932820438, 75.43097188323735, 81.74899762123822, 32.676770087331505, 71.19684063643214, 59.14856220176442, 30.961684726178632, 86.98456822242588, 51.82445769384502, 63.29230160731821, 69.53962858021256, 72.73378089815375, 60.228708393871756, 70.70960351172832, 63.37198020145297, 69.9747602418065, 77.10618182271718, 67.33093975111842, 41.32033036090432, 79.49975490942597, 18.399143010843517, 51.91577473375946, 67.11538234353064, 91.14125788584352, 32.20965415984392, 65.02423075959085, 69.20853118784724, 54.12862648069856, 67.8792946115136, 56.39243516325948, 73.59103514347225, 65.77507404237986, 43.46772318147123, 57.438752812100546, 97.98385266959667, 74.25578465964642, 68.31946524512023, 66.87183946371076, 56.816611800342784, 85.58426968217827, 70.16783813014627, 38.46973601728678, 64.08028099685905, 55.75435610488054, 52.77275960892436, 69.87319488078354, 47.124028332531424, 52.77971589565277, 17.896646558074266, 50.94554705545305, 71.80476288497447, 66.17001951858398, 55.679083049297304, 56.8284858323168, 58.20137176825665, 74.98242267291059, 76.29578563943502, 53.143907587975264, 79.53411485627292, 61.67743534594773, 58.45754598826167, 56.02399127557871, 74.24337452650067, 66.37637536667714, 56.70664428919551], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.737537937859685, 28.30745129256198, 28.224871911729366, 17.170590334882334, 16.64745361109574, 17.115814681475356, 20.74495022123058, 20.80742609625061, 20.896372543027, 18.18578768024841, 18.60650063926974, 18.416848159084708, 22.955916707714394, 23.155703020592526, 23.35587480788429, 26.083665907382965, 26.208091124892235, 26.023011438548565, 21.88225059707959, 22.03385977943738, 21.70446603496869, 20.099884428083897, 20.23734972625971, 20.197677675634623, 26.728665386637047, 26.767770056923226, 26.694526863594845, 21.73816255231698, 22.38365889464815, 21.829554354151085, 27.47928041840592, 27.579297394181282, 27.350569962213427, 23.680605076253414, 24.007450184901245, 23.751181073486805, 20.879539012908936, 20.84815128147602, 20.993712678551674, 25.074778991440922, 25.10682641590634, 24.953776607910783, 18.826117120683193, 19.400733372662216, 18.683762937784195, 21.416073955595493, 21.531742235645652, 21.349968567490578, 28.4100602765878, 28.68426589419444, 28.498230149348572, 21.287416342645884, 21.203135170042515, 20.927329018712044, 22.564624617497117, 22.349999393026025, 23.056538863728434, 23.087759044021368, 22.332118421792984, 22.792749002575874, 24.480079325536877, 24.458851317564637, 24.761593552927167, 26.18000789421299, 25.79443724701801, 25.80499706665674, 16.52666153510411, 17.347909241293863, 17.44061802172412, 30.605428648491696, 30.684846100707844, 30.38097845514615, 31.09388652490452, 31.087218483444303, 30.511355847120285, 18.99815760696461, 18.841136055688054, 18.69801818827787, 28.27080689122279, 28.021826331814125, 27.926779945691422, 23.71043436229229, 23.894410952925682, 23.851800486445427, 17.14789014620085, 16.75143552323182, 17.222075849616274, 29.726542924065143, 29.757620948104886, 28.65384031832218, 19.30658611034353, 19.412529277925685, 19.40814758682002, 26.400881499052048, 27.132308507338166, 26.953612338751554, 28.138757857183606, 28.20726929853359, 28.35176943607317, 24.14369461437066, 24.201787089308098, 24.744507207845643, 23.807351263860852, 24.207349457467586, 24.1569965618352, 15.353171383341149, 15.423482996722058, 15.740304948141173, 25.041026776035622, 25.468153101702526, 24.9217920054992, 26.912274365623787, 27.601332557698086, 27.235390697916344, 10.972264873484761, 11.076823918769747, 10.627681295076997, 23.57712749640146, 23.836820761362702, 23.78289237866798, 19.845534106095627, 19.01409625013669, 20.288931845532105, 10.25326184680064, 9.934432839353875, 10.773990040024117, 28.89588413387537, 29.20614658948034, 28.882537499070168, 17.541601860274866, 17.129796033104256, 17.153059800465897, 21.25593937405695, 21.045851548512772, 20.990510684748486, 23.100546496609837, 23.048003474871308, 23.39107860873142, 24.22602895895639, 24.327056708435208, 24.180695230762154, 20.144677909711987, 20.00815816471973, 20.075872319440037, 23.714296794186026, 23.741723745750875, 23.253582971791417, 21.310639068484306, 20.846410304307938, 21.214930828660727, 23.336120290060833, 23.321014647682503, 23.317625304063156, 25.800639202197388, 25.53559500475724, 25.769947615762547, 22.441321909427643, 22.445798246189952, 22.443819595500827, 13.67047508557637, 13.528334399064377, 14.121520876263574, 26.63521556928754, 26.56159334629774, 26.302945993840694, 6.391068424253405, 5.940221431354672, 6.06785315523544, 17.534337983466685, 17.278229355812073, 17.103207394480705, 22.475819443662957, 22.253934038182095, 22.38562886168559, 30.171156346797943, 30.33444021642208, 30.63566132262349, 10.809570584446192, 10.958219800144434, 10.441863775253296, 21.74338302885492, 21.559654430796698, 21.72119329993923, 23.036970571925238, 23.046112434317664, 23.12544818160434, 18.041673230628163, 18.23484760026136, 17.852105649809033, 22.26592867573102, 22.625077803929642, 22.98828813185294, 18.918656828502805, 19.16763079414764, 18.306147540609032, 24.55911120865494, 24.50840190052986, 24.523522034287453, 21.71904730796814, 22.20824635773897, 21.847780376672745, 14.584261782467365, 14.900296254083514, 13.98316514492035, 19.24421841596873, 19.142642742643744, 19.05189165348807, 32.58832951635122, 32.85228157043457, 32.54324158281088, 24.646130094925553, 24.705095293621213, 24.904559271099657, 22.97067394386977, 22.728635989129543, 22.620155312120914, 22.20311279098192, 22.42400812606016, 22.24471854666868, 18.915711631377533, 18.969587878634528, 18.931312290330723, 28.21944633126259, 28.378707259893417, 28.986116091022268, 23.428717087954283, 23.180290684103966, 23.558830358088017, 13.17630860954523, 12.621655985713005, 12.671771422028542, 21.424859358618647, 21.081705416242272, 21.573716221998126, 18.4716827298204, 18.476969028512627, 18.805704346547515, 17.292151289681584, 17.86190242196122, 17.618705897281558, 23.55289177348216, 23.241264720757798, 23.079038386543587, 15.425692106286675, 15.919288637737424, 15.779047588507325, 17.731779396533966, 17.372592642903328, 17.675343856215477, 6.118548914867759, 5.8792915691931995, 5.898806074013308, 17.043740538259343, 17.129734077801302, 16.772072439392403, 23.93779843797286, 23.946358298261956, 23.92060614873965, 22.08653341109553, 22.075238591680915, 22.00824751580754, 18.687813887993485, 18.452577004830033, 18.538692156473786, 18.986100282520056, 19.149319116724655, 18.69306643307209, 19.429870393127203, 19.574547884752974, 19.196953490376472, 25.281967516445235, 24.94698370496431, 24.753471451501042, 25.332031602660805, 25.263001451889664, 25.700752584884555, 17.54284379631281, 17.960904274135828, 17.640159517526627, 26.33565381666024, 26.804333352794245, 26.394127686818436, 20.24572080870469, 20.73795279425879, 20.69376174298425, 19.50149981180826, 19.598710181812436, 19.357335994640977, 18.49364678064981, 18.77444716791311, 18.755897327015788, 24.830771418909222, 24.688082220653683, 24.724520886937768, 21.919414843122155, 22.4110927129083, 22.045867810646683, 19.006603351483733, 18.798719505468995, 18.90132143224278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14352203906664557, "mean_inference_ms": 0.6451378122553888, "mean_action_processing_ms": 0.09491844093930644, "mean_env_wait_ms": 0.8032829001208595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 580800, "timesteps_this_iter": 0, "agent_timesteps_total": 1742400, "timers": {"sample_time_ms": 9199.76, "sample_throughput": 521.753, "load_time_ms": 0.2, "load_throughput": 23984583.274, "learn_time_ms": 1178.726, "learn_throughput": 4072.193, "update_time_ms": 1.429}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.536955118179321, "policy_loss": -0.0013916310965821355, "vf_loss": 5.670706748962402, "vf_explained_var": -0.033661916851997375, "kl": 0.008103788306624553, "entropy": 13.309008479118347, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580800, "num_agent_steps_sampled": 1742400, "num_steps_trained": 580800, "num_agent_steps_trained": 1742400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2865, "training_iteration": 121, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-01-37", "timestamp": 1706148097, "time_this_iter_s": 9.011540412902832, "time_total_s": 1137.3648443222046, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1137.3648443222046, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 8.708333333333332, "ram_util_percent": 46.708333333333336}}
{"episode_reward_max": 97.98385266959667, "episode_reward_min": 17.896646558074266, "episode_reward_mean": 64.554259874053, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.8792915691931995}, "policy_reward_max": {"shared_policy": 32.85228157043457}, "policy_reward_mean": {"shared_policy": 21.51808662468433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.59255632013081, 63.41788053140044, 67.97116287425158, 68.21262646839023, 73.70052419602868, 77.77944220788774, 51.315188798122094, 91.67125320434569, 92.69246085546911, 56.537311850930536, 84.21941316872834, 71.4566458016634, 51.121401519048945, 88.13800419049221, 58.12726297508924, 80.48680234514177, 84.69779659179036, 73.0899889115244, 72.17169728316364, 46.51695932820438, 75.43097188323735, 81.74899762123822, 32.676770087331505, 71.19684063643214, 59.14856220176442, 30.961684726178632, 86.98456822242588, 51.82445769384502, 63.29230160731821, 69.53962858021256, 72.73378089815375, 60.228708393871756, 70.70960351172832, 63.37198020145297, 69.9747602418065, 77.10618182271718, 67.33093975111842, 41.32033036090432, 79.49975490942597, 18.399143010843517, 51.91577473375946, 67.11538234353064, 91.14125788584352, 32.20965415984392, 65.02423075959085, 69.20853118784724, 54.12862648069856, 67.8792946115136, 56.39243516325948, 73.59103514347225, 65.77507404237986, 43.46772318147123, 57.438752812100546, 97.98385266959667, 74.25578465964642, 68.31946524512023, 66.87183946371076, 56.816611800342784, 85.58426968217827, 70.16783813014627, 38.46973601728678, 64.08028099685905, 55.75435610488054, 52.77275960892436, 69.87319488078354, 47.124028332531424, 52.77971589565277, 17.896646558074266, 50.94554705545305, 71.80476288497447, 66.17001951858398, 55.679083049297304, 56.8284858323168, 58.20137176825665, 74.98242267291059, 76.29578563943502, 53.143907587975264, 79.53411485627292, 61.67743534594773, 58.45754598826167, 56.02399127557871, 74.24337452650067, 66.37637536667714, 56.70664428919551, 85.30226849392056, 55.627959329634876, 76.2836742289364, 31.851898677647114, 78.955411484465, 68.26151774823666, 75.68843189533797, 58.14023581892252, 82.67207789793608, 76.55117016565052, 59.55451122298835, 39.763061955571175, 77.44446229189634, 55.527542632073164, 67.37137113045898, 52.92502643913029], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.4100602765878, 28.68426589419444, 28.498230149348572, 21.287416342645884, 21.203135170042515, 20.927329018712044, 22.564624617497117, 22.349999393026025, 23.056538863728434, 23.087759044021368, 22.332118421792984, 22.792749002575874, 24.480079325536877, 24.458851317564637, 24.761593552927167, 26.18000789421299, 25.79443724701801, 25.80499706665674, 16.52666153510411, 17.347909241293863, 17.44061802172412, 30.605428648491696, 30.684846100707844, 30.38097845514615, 31.09388652490452, 31.087218483444303, 30.511355847120285, 18.99815760696461, 18.841136055688054, 18.69801818827787, 28.27080689122279, 28.021826331814125, 27.926779945691422, 23.71043436229229, 23.894410952925682, 23.851800486445427, 17.14789014620085, 16.75143552323182, 17.222075849616274, 29.726542924065143, 29.757620948104886, 28.65384031832218, 19.30658611034353, 19.412529277925685, 19.40814758682002, 26.400881499052048, 27.132308507338166, 26.953612338751554, 28.138757857183606, 28.20726929853359, 28.35176943607317, 24.14369461437066, 24.201787089308098, 24.744507207845643, 23.807351263860852, 24.207349457467586, 24.1569965618352, 15.353171383341149, 15.423482996722058, 15.740304948141173, 25.041026776035622, 25.468153101702526, 24.9217920054992, 26.912274365623787, 27.601332557698086, 27.235390697916344, 10.972264873484761, 11.076823918769747, 10.627681295076997, 23.57712749640146, 23.836820761362702, 23.78289237866798, 19.845534106095627, 19.01409625013669, 20.288931845532105, 10.25326184680064, 9.934432839353875, 10.773990040024117, 28.89588413387537, 29.20614658948034, 28.882537499070168, 17.541601860274866, 17.129796033104256, 17.153059800465897, 21.25593937405695, 21.045851548512772, 20.990510684748486, 23.100546496609837, 23.048003474871308, 23.39107860873142, 24.22602895895639, 24.327056708435208, 24.180695230762154, 20.144677909711987, 20.00815816471973, 20.075872319440037, 23.714296794186026, 23.741723745750875, 23.253582971791417, 21.310639068484306, 20.846410304307938, 21.214930828660727, 23.336120290060833, 23.321014647682503, 23.317625304063156, 25.800639202197388, 25.53559500475724, 25.769947615762547, 22.441321909427643, 22.445798246189952, 22.443819595500827, 13.67047508557637, 13.528334399064377, 14.121520876263574, 26.63521556928754, 26.56159334629774, 26.302945993840694, 6.391068424253405, 5.940221431354672, 6.06785315523544, 17.534337983466685, 17.278229355812073, 17.103207394480705, 22.475819443662957, 22.253934038182095, 22.38562886168559, 30.171156346797943, 30.33444021642208, 30.63566132262349, 10.809570584446192, 10.958219800144434, 10.441863775253296, 21.74338302885492, 21.559654430796698, 21.72119329993923, 23.036970571925238, 23.046112434317664, 23.12544818160434, 18.041673230628163, 18.23484760026136, 17.852105649809033, 22.26592867573102, 22.625077803929642, 22.98828813185294, 18.918656828502805, 19.16763079414764, 18.306147540609032, 24.55911120865494, 24.50840190052986, 24.523522034287453, 21.71904730796814, 22.20824635773897, 21.847780376672745, 14.584261782467365, 14.900296254083514, 13.98316514492035, 19.24421841596873, 19.142642742643744, 19.05189165348807, 32.58832951635122, 32.85228157043457, 32.54324158281088, 24.646130094925553, 24.705095293621213, 24.904559271099657, 22.97067394386977, 22.728635989129543, 22.620155312120914, 22.20311279098192, 22.42400812606016, 22.24471854666868, 18.915711631377533, 18.969587878634528, 18.931312290330723, 28.21944633126259, 28.378707259893417, 28.986116091022268, 23.428717087954283, 23.180290684103966, 23.558830358088017, 13.17630860954523, 12.621655985713005, 12.671771422028542, 21.424859358618647, 21.081705416242272, 21.573716221998126, 18.4716827298204, 18.476969028512627, 18.805704346547515, 17.292151289681584, 17.86190242196122, 17.618705897281558, 23.55289177348216, 23.241264720757798, 23.079038386543587, 15.425692106286675, 15.919288637737424, 15.779047588507325, 17.731779396533966, 17.372592642903328, 17.675343856215477, 6.118548914867759, 5.8792915691931995, 5.898806074013308, 17.043740538259343, 17.129734077801302, 16.772072439392403, 23.93779843797286, 23.946358298261956, 23.92060614873965, 22.08653341109553, 22.075238591680915, 22.00824751580754, 18.687813887993485, 18.452577004830033, 18.538692156473786, 18.986100282520056, 19.149319116724655, 18.69306643307209, 19.429870393127203, 19.574547884752974, 19.196953490376472, 25.281967516445235, 24.94698370496431, 24.753471451501042, 25.332031602660805, 25.263001451889664, 25.700752584884555, 17.54284379631281, 17.960904274135828, 17.640159517526627, 26.33565381666024, 26.804333352794245, 26.394127686818436, 20.24572080870469, 20.73795279425879, 20.69376174298425, 19.50149981180826, 19.598710181812436, 19.357335994640977, 18.49364678064981, 18.77444716791311, 18.755897327015788, 24.830771418909222, 24.688082220653683, 24.724520886937768, 21.919414843122155, 22.4110927129083, 22.045867810646683, 19.006603351483733, 18.798719505468995, 18.90132143224278, 28.559736225754023, 28.23139176517725, 28.511140502989292, 18.708232993880898, 18.65234617019692, 18.267380165557057, 25.41005816558996, 25.192371646563203, 25.681244416783244, 10.816746938973665, 10.300483338534832, 10.734668400138617, 26.645416406914592, 26.491873286664486, 25.818121790885925, 22.818606190383434, 22.634053967893124, 22.8088575899601, 25.05508459607759, 25.39066898605475, 25.24267831320563, 18.774579495191574, 19.66211048141122, 19.703545842319727, 27.618555201838404, 27.409791777531296, 27.643730918566376, 25.252604747811944, 25.76836690089354, 25.530198516945035, 19.846646775801972, 19.94009719168146, 19.76776725550492, 13.516571655869484, 13.299369871616364, 12.947120428085327, 25.78487493097782, 25.873241312801838, 25.786346048116684, 18.441759772598743, 18.631060268729925, 18.454722590744495, 21.819666291276604, 22.64723018060127, 22.90447465858111, 17.64034731437762, 17.681086865564183, 17.60359225918849]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14346646591868867, "mean_inference_ms": 0.6450577765556541, "mean_action_processing_ms": 0.09490972431594086, "mean_env_wait_ms": 0.8030680177291242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 585600, "timesteps_this_iter": 0, "agent_timesteps_total": 1756800, "timers": {"sample_time_ms": 9187.065, "sample_throughput": 522.474, "load_time_ms": 0.2, "load_throughput": 23984583.274, "learn_time_ms": 1178.22, "learn_throughput": 4073.942, "update_time_ms": 1.43}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.03878378868103, "policy_loss": 0.0008134123291045903, "vf_loss": 6.168062627315521, "vf_explained_var": -0.018606022000312805, "kl": 0.010672811709961814, "entropy": 13.105379343032837, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 585600, "num_agent_steps_sampled": 1756800, "num_steps_trained": 585600, "num_agent_steps_trained": 1756800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2881, "training_iteration": 122, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-01-46", "timestamp": 1706148106, "time_this_iter_s": 8.951524019241333, "time_total_s": 1146.316368341446, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004ECC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1146.316368341446, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 10.73846153846154, "ram_util_percent": 46.7}}
{"episode_reward_max": 97.98385266959667, "episode_reward_min": 17.896646558074266, "episode_reward_mean": 63.9442779452817, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.8792915691931995}, "policy_reward_max": {"shared_policy": 32.85228157043457}, "policy_reward_mean": {"shared_policy": 21.314759315093895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.69779659179036, 73.0899889115244, 72.17169728316364, 46.51695932820438, 75.43097188323735, 81.74899762123822, 32.676770087331505, 71.19684063643214, 59.14856220176442, 30.961684726178632, 86.98456822242588, 51.82445769384502, 63.29230160731821, 69.53962858021256, 72.73378089815375, 60.228708393871756, 70.70960351172832, 63.37198020145297, 69.9747602418065, 77.10618182271718, 67.33093975111842, 41.32033036090432, 79.49975490942597, 18.399143010843517, 51.91577473375946, 67.11538234353064, 91.14125788584352, 32.20965415984392, 65.02423075959085, 69.20853118784724, 54.12862648069856, 67.8792946115136, 56.39243516325948, 73.59103514347225, 65.77507404237986, 43.46772318147123, 57.438752812100546, 97.98385266959667, 74.25578465964642, 68.31946524512023, 66.87183946371076, 56.816611800342784, 85.58426968217827, 70.16783813014627, 38.46973601728678, 64.08028099685905, 55.75435610488054, 52.77275960892436, 69.87319488078354, 47.124028332531424, 52.77971589565277, 17.896646558074266, 50.94554705545305, 71.80476288497447, 66.17001951858398, 55.679083049297304, 56.8284858323168, 58.20137176825665, 74.98242267291059, 76.29578563943502, 53.143907587975264, 79.53411485627292, 61.67743534594773, 58.45754598826167, 56.02399127557871, 74.24337452650067, 66.37637536667714, 56.70664428919551, 85.30226849392056, 55.627959329634876, 76.2836742289364, 31.851898677647114, 78.955411484465, 68.26151774823666, 75.68843189533797, 58.14023581892252, 82.67207789793608, 76.55117016565052, 59.55451122298835, 39.763061955571175, 77.44446229189634, 55.527542632073164, 67.37137113045898, 52.92502643913029, 65.93723702430725, 72.24016111344098, 76.06561045348643, 67.4023503065109, 66.35233052074908, 50.29927936010061, 74.00116662681103, 90.01794366538523, 47.682854218408465, 78.13667185604572, 64.69377477467057, 66.47710437327623, 91.07491714507339, 67.13208781927823, 62.66468666121361, 61.26356851123272], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.138757857183606, 28.20726929853359, 28.35176943607317, 24.14369461437066, 24.201787089308098, 24.744507207845643, 23.807351263860852, 24.207349457467586, 24.1569965618352, 15.353171383341149, 15.423482996722058, 15.740304948141173, 25.041026776035622, 25.468153101702526, 24.9217920054992, 26.912274365623787, 27.601332557698086, 27.235390697916344, 10.972264873484761, 11.076823918769747, 10.627681295076997, 23.57712749640146, 23.836820761362702, 23.78289237866798, 19.845534106095627, 19.01409625013669, 20.288931845532105, 10.25326184680064, 9.934432839353875, 10.773990040024117, 28.89588413387537, 29.20614658948034, 28.882537499070168, 17.541601860274866, 17.129796033104256, 17.153059800465897, 21.25593937405695, 21.045851548512772, 20.990510684748486, 23.100546496609837, 23.048003474871308, 23.39107860873142, 24.22602895895639, 24.327056708435208, 24.180695230762154, 20.144677909711987, 20.00815816471973, 20.075872319440037, 23.714296794186026, 23.741723745750875, 23.253582971791417, 21.310639068484306, 20.846410304307938, 21.214930828660727, 23.336120290060833, 23.321014647682503, 23.317625304063156, 25.800639202197388, 25.53559500475724, 25.769947615762547, 22.441321909427643, 22.445798246189952, 22.443819595500827, 13.67047508557637, 13.528334399064377, 14.121520876263574, 26.63521556928754, 26.56159334629774, 26.302945993840694, 6.391068424253405, 5.940221431354672, 6.06785315523544, 17.534337983466685, 17.278229355812073, 17.103207394480705, 22.475819443662957, 22.253934038182095, 22.38562886168559, 30.171156346797943, 30.33444021642208, 30.63566132262349, 10.809570584446192, 10.958219800144434, 10.441863775253296, 21.74338302885492, 21.559654430796698, 21.72119329993923, 23.036970571925238, 23.046112434317664, 23.12544818160434, 18.041673230628163, 18.23484760026136, 17.852105649809033, 22.26592867573102, 22.625077803929642, 22.98828813185294, 18.918656828502805, 19.16763079414764, 18.306147540609032, 24.55911120865494, 24.50840190052986, 24.523522034287453, 21.71904730796814, 22.20824635773897, 21.847780376672745, 14.584261782467365, 14.900296254083514, 13.98316514492035, 19.24421841596873, 19.142642742643744, 19.05189165348807, 32.58832951635122, 32.85228157043457, 32.54324158281088, 24.646130094925553, 24.705095293621213, 24.904559271099657, 22.97067394386977, 22.728635989129543, 22.620155312120914, 22.20311279098192, 22.42400812606016, 22.24471854666868, 18.915711631377533, 18.969587878634528, 18.931312290330723, 28.21944633126259, 28.378707259893417, 28.986116091022268, 23.428717087954283, 23.180290684103966, 23.558830358088017, 13.17630860954523, 12.621655985713005, 12.671771422028542, 21.424859358618647, 21.081705416242272, 21.573716221998126, 18.4716827298204, 18.476969028512627, 18.805704346547515, 17.292151289681584, 17.86190242196122, 17.618705897281558, 23.55289177348216, 23.241264720757798, 23.079038386543587, 15.425692106286675, 15.919288637737424, 15.779047588507325, 17.731779396533966, 17.372592642903328, 17.675343856215477, 6.118548914867759, 5.8792915691931995, 5.898806074013308, 17.043740538259343, 17.129734077801302, 16.772072439392403, 23.93779843797286, 23.946358298261956, 23.92060614873965, 22.08653341109553, 22.075238591680915, 22.00824751580754, 18.687813887993485, 18.452577004830033, 18.538692156473786, 18.986100282520056, 19.149319116724655, 18.69306643307209, 19.429870393127203, 19.574547884752974, 19.196953490376472, 25.281967516445235, 24.94698370496431, 24.753471451501042, 25.332031602660805, 25.263001451889664, 25.700752584884555, 17.54284379631281, 17.960904274135828, 17.640159517526627, 26.33565381666024, 26.804333352794245, 26.394127686818436, 20.24572080870469, 20.73795279425879, 20.69376174298425, 19.50149981180826, 19.598710181812436, 19.357335994640977, 18.49364678064981, 18.77444716791311, 18.755897327015788, 24.830771418909222, 24.688082220653683, 24.724520886937768, 21.919414843122155, 22.4110927129083, 22.045867810646683, 19.006603351483733, 18.798719505468995, 18.90132143224278, 28.559736225754023, 28.23139176517725, 28.511140502989292, 18.708232993880898, 18.65234617019692, 18.267380165557057, 25.41005816558996, 25.192371646563203, 25.681244416783244, 10.816746938973665, 10.300483338534832, 10.734668400138617, 26.645416406914592, 26.491873286664486, 25.818121790885925, 22.818606190383434, 22.634053967893124, 22.8088575899601, 25.05508459607759, 25.39066898605475, 25.24267831320563, 18.774579495191574, 19.66211048141122, 19.703545842319727, 27.618555201838404, 27.409791777531296, 27.643730918566376, 25.252604747811944, 25.76836690089354, 25.530198516945035, 19.846646775801972, 19.94009719168146, 19.76776725550492, 13.516571655869484, 13.299369871616364, 12.947120428085327, 25.78487493097782, 25.873241312801838, 25.786346048116684, 18.441759772598743, 18.631060268729925, 18.454722590744495, 21.819666291276604, 22.64723018060127, 22.90447465858111, 17.64034731437762, 17.681086865564183, 17.60359225918849, 22.0564873367548, 22.056997552514076, 21.823752135038376, 24.27272507299979, 23.851735343535736, 24.11570069690545, 25.74263822038968, 25.248590891559914, 25.074381341536835, 22.2397835801045, 22.500023717681557, 22.66254300872484, 22.274590761711195, 22.090032168974474, 21.98770759006341, 16.48257766415675, 16.94175170299907, 16.874949992944792, 24.484418988227844, 24.85103080421686, 24.66571683436632, 29.93452699979146, 29.828874488671616, 30.254542176922158, 16.15967725776136, 15.927237220108509, 15.595939740538597, 25.764358565211296, 26.28079053014517, 26.09152276068926, 21.50511663655439, 21.523275601367146, 21.665382536749036, 22.01396019011736, 22.203395169228315, 22.25974901393056, 30.279807205001504, 30.457564274470002, 30.33754566560188, 22.277650852998093, 22.44455563028653, 22.409881335993603, 20.705377067128808, 21.116985677431018, 20.842323916653783, 20.175402005513504, 20.644256434713796, 20.44391007100542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1434183944384463, "mean_inference_ms": 0.64496710748776, "mean_action_processing_ms": 0.09489141882268214, "mean_env_wait_ms": 0.8028230576922908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 590400, "timesteps_this_iter": 0, "agent_timesteps_total": 1771200, "timers": {"sample_time_ms": 9150.578, "sample_throughput": 524.557, "load_time_ms": 0.299, "load_throughput": 16039403.442, "learn_time_ms": 1175.314, "learn_throughput": 4084.015, "update_time_ms": 1.396}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.751368343830109, "policy_loss": 0.004217868449890805, "vf_loss": 5.879226446151733, "vf_explained_var": -0.01920086145401001, "kl": 0.015468358295197188, "entropy": 13.346961617469788, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 590400, "num_agent_steps_sampled": 1771200, "num_steps_trained": 590400, "num_agent_steps_trained": 1771200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2897, "training_iteration": 123, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-01-55", "timestamp": 1706148115, "time_this_iter_s": 8.94761037826538, "time_total_s": 1155.2639787197113, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F4DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1155.2639787197113, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 6.823076923076924, "ram_util_percent": 46.75384615384615}}
{"episode_reward_max": 97.98385266959667, "episode_reward_min": 17.896646558074266, "episode_reward_mean": 64.38383930735732, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.8792915691931995}, "policy_reward_max": {"shared_policy": 32.85228157043457}, "policy_reward_mean": {"shared_policy": 21.461279769119102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.70960351172832, 63.37198020145297, 69.9747602418065, 77.10618182271718, 67.33093975111842, 41.32033036090432, 79.49975490942597, 18.399143010843517, 51.91577473375946, 67.11538234353064, 91.14125788584352, 32.20965415984392, 65.02423075959085, 69.20853118784724, 54.12862648069856, 67.8792946115136, 56.39243516325948, 73.59103514347225, 65.77507404237986, 43.46772318147123, 57.438752812100546, 97.98385266959667, 74.25578465964642, 68.31946524512023, 66.87183946371076, 56.816611800342784, 85.58426968217827, 70.16783813014627, 38.46973601728678, 64.08028099685905, 55.75435610488054, 52.77275960892436, 69.87319488078354, 47.124028332531424, 52.77971589565277, 17.896646558074266, 50.94554705545305, 71.80476288497447, 66.17001951858398, 55.679083049297304, 56.8284858323168, 58.20137176825665, 74.98242267291059, 76.29578563943502, 53.143907587975264, 79.53411485627292, 61.67743534594773, 58.45754598826167, 56.02399127557871, 74.24337452650067, 66.37637536667714, 56.70664428919551, 85.30226849392056, 55.627959329634876, 76.2836742289364, 31.851898677647114, 78.955411484465, 68.26151774823666, 75.68843189533797, 58.14023581892252, 82.67207789793608, 76.55117016565052, 59.55451122298835, 39.763061955571175, 77.44446229189634, 55.527542632073164, 67.37137113045898, 52.92502643913029, 65.93723702430725, 72.24016111344098, 76.06561045348643, 67.4023503065109, 66.35233052074908, 50.29927936010061, 74.00116662681103, 90.01794366538523, 47.682854218408465, 78.13667185604572, 64.69377477467057, 66.47710437327623, 91.07491714507339, 67.13208781927823, 62.66468666121361, 61.26356851123272, 81.72381499409674, 66.7436634339392, 76.5726616308093, 48.92304256092757, 60.59432171168736, 75.81907621398568, 75.76026954269035, 79.87035019695759, 57.15712278336285, 71.19327104836701, 67.08874265849589, 59.26837765425441, 84.60848216526207, 66.07654940430075, 53.018250320106716, 51.78185455501078], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.714296794186026, 23.741723745750875, 23.253582971791417, 21.310639068484306, 20.846410304307938, 21.214930828660727, 23.336120290060833, 23.321014647682503, 23.317625304063156, 25.800639202197388, 25.53559500475724, 25.769947615762547, 22.441321909427643, 22.445798246189952, 22.443819595500827, 13.67047508557637, 13.528334399064377, 14.121520876263574, 26.63521556928754, 26.56159334629774, 26.302945993840694, 6.391068424253405, 5.940221431354672, 6.06785315523544, 17.534337983466685, 17.278229355812073, 17.103207394480705, 22.475819443662957, 22.253934038182095, 22.38562886168559, 30.171156346797943, 30.33444021642208, 30.63566132262349, 10.809570584446192, 10.958219800144434, 10.441863775253296, 21.74338302885492, 21.559654430796698, 21.72119329993923, 23.036970571925238, 23.046112434317664, 23.12544818160434, 18.041673230628163, 18.23484760026136, 17.852105649809033, 22.26592867573102, 22.625077803929642, 22.98828813185294, 18.918656828502805, 19.16763079414764, 18.306147540609032, 24.55911120865494, 24.50840190052986, 24.523522034287453, 21.71904730796814, 22.20824635773897, 21.847780376672745, 14.584261782467365, 14.900296254083514, 13.98316514492035, 19.24421841596873, 19.142642742643744, 19.05189165348807, 32.58832951635122, 32.85228157043457, 32.54324158281088, 24.646130094925553, 24.705095293621213, 24.904559271099657, 22.97067394386977, 22.728635989129543, 22.620155312120914, 22.20311279098192, 22.42400812606016, 22.24471854666868, 18.915711631377533, 18.969587878634528, 18.931312290330723, 28.21944633126259, 28.378707259893417, 28.986116091022268, 23.428717087954283, 23.180290684103966, 23.558830358088017, 13.17630860954523, 12.621655985713005, 12.671771422028542, 21.424859358618647, 21.081705416242272, 21.573716221998126, 18.4716827298204, 18.476969028512627, 18.805704346547515, 17.292151289681584, 17.86190242196122, 17.618705897281558, 23.55289177348216, 23.241264720757798, 23.079038386543587, 15.425692106286675, 15.919288637737424, 15.779047588507325, 17.731779396533966, 17.372592642903328, 17.675343856215477, 6.118548914867759, 5.8792915691931995, 5.898806074013308, 17.043740538259343, 17.129734077801302, 16.772072439392403, 23.93779843797286, 23.946358298261956, 23.92060614873965, 22.08653341109553, 22.075238591680915, 22.00824751580754, 18.687813887993485, 18.452577004830033, 18.538692156473786, 18.986100282520056, 19.149319116724655, 18.69306643307209, 19.429870393127203, 19.574547884752974, 19.196953490376472, 25.281967516445235, 24.94698370496431, 24.753471451501042, 25.332031602660805, 25.263001451889664, 25.700752584884555, 17.54284379631281, 17.960904274135828, 17.640159517526627, 26.33565381666024, 26.804333352794245, 26.394127686818436, 20.24572080870469, 20.73795279425879, 20.69376174298425, 19.50149981180826, 19.598710181812436, 19.357335994640977, 18.49364678064981, 18.77444716791311, 18.755897327015788, 24.830771418909222, 24.688082220653683, 24.724520886937768, 21.919414843122155, 22.4110927129083, 22.045867810646683, 19.006603351483733, 18.798719505468995, 18.90132143224278, 28.559736225754023, 28.23139176517725, 28.511140502989292, 18.708232993880898, 18.65234617019692, 18.267380165557057, 25.41005816558996, 25.192371646563203, 25.681244416783244, 10.816746938973665, 10.300483338534832, 10.734668400138617, 26.645416406914592, 26.491873286664486, 25.818121790885925, 22.818606190383434, 22.634053967893124, 22.8088575899601, 25.05508459607759, 25.39066898605475, 25.24267831320563, 18.774579495191574, 19.66211048141122, 19.703545842319727, 27.618555201838404, 27.409791777531296, 27.643730918566376, 25.252604747811944, 25.76836690089354, 25.530198516945035, 19.846646775801972, 19.94009719168146, 19.76776725550492, 13.516571655869484, 13.299369871616364, 12.947120428085327, 25.78487493097782, 25.873241312801838, 25.786346048116684, 18.441759772598743, 18.631060268729925, 18.454722590744495, 21.819666291276604, 22.64723018060127, 22.90447465858111, 17.64034731437762, 17.681086865564183, 17.60359225918849, 22.0564873367548, 22.056997552514076, 21.823752135038376, 24.27272507299979, 23.851735343535736, 24.11570069690545, 25.74263822038968, 25.248590891559914, 25.074381341536835, 22.2397835801045, 22.500023717681557, 22.66254300872484, 22.274590761711195, 22.090032168974474, 21.98770759006341, 16.48257766415675, 16.94175170299907, 16.874949992944792, 24.484418988227844, 24.85103080421686, 24.66571683436632, 29.93452699979146, 29.828874488671616, 30.254542176922158, 16.15967725776136, 15.927237220108509, 15.595939740538597, 25.764358565211296, 26.28079053014517, 26.09152276068926, 21.50511663655439, 21.523275601367146, 21.665382536749036, 22.01396019011736, 22.203395169228315, 22.25974901393056, 30.279807205001504, 30.457564274470002, 30.33754566560188, 22.277650852998093, 22.44455563028653, 22.409881335993603, 20.705377067128808, 21.116985677431018, 20.842323916653783, 20.175402005513504, 20.644256434713796, 20.44391007100542, 27.22220045079787, 27.316891220708683, 27.184723322590187, 22.444495656838015, 22.025340427954987, 22.273827349146202, 25.16981513798237, 25.52181662619114, 25.8810298666358, 16.421443186700344, 16.71148497145623, 15.790114402770996, 20.527802083718896, 20.056697775920227, 20.009821852048233, 25.409874325618148, 25.015836969017982, 25.39336491934955, 25.186744583149746, 25.490845764831946, 25.08267919470866, 26.653688445687294, 26.34491068124771, 26.871751070022583, 19.046062880506113, 19.044653510053948, 19.06640639280279, 23.897980598111943, 23.98173775275548, 23.31355269749959, 22.41302530964215, 22.08859961231549, 22.587117736538247, 19.809976688275725, 19.918793162951857, 19.539607803026826, 27.887350673476845, 28.137458654741437, 28.583672837043792, 22.303384539671242, 22.089953135699034, 21.683211728930473, 17.561108260105044, 17.68938412393132, 17.767757936070353, 17.310939592619732, 17.210502823193863, 17.260412139197186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14337638710681191, "mean_inference_ms": 0.6448554732012461, "mean_action_processing_ms": 0.09487134312488055, "mean_env_wait_ms": 0.8025402363259109, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 595200, "timesteps_this_iter": 0, "agent_timesteps_total": 1785600, "timers": {"sample_time_ms": 9102.278, "sample_throughput": 527.341, "load_time_ms": 0.199, "load_throughput": 24102309.589, "learn_time_ms": 1174.408, "learn_throughput": 4087.164, "update_time_ms": 1.402}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.19539350271225, "policy_loss": 0.00017745450604711444, "vf_loss": 5.327089905738831, "vf_explained_var": -0.008671998977661133, "kl": 0.006241128110713183, "entropy": 13.243613123893738, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 595200, "num_agent_steps_sampled": 1785600, "num_steps_trained": 595200, "num_agent_steps_trained": 1785600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2913, "training_iteration": 124, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-02-04", "timestamp": 1706148124, "time_this_iter_s": 8.983651399612427, "time_total_s": 1164.2476301193237, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632F9CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1164.2476301193237, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 6.7250000000000005, "ram_util_percent": 46.68333333333334}}
{"episode_reward_max": 99.974724881351, "episode_reward_min": 17.896646558074266, "episode_reward_mean": 65.13740194717398, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 5.8792915691931995}, "policy_reward_max": {"shared_policy": 33.53635387122631}, "policy_reward_mean": {"shared_policy": 21.712467315724655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.39243516325948, 73.59103514347225, 65.77507404237986, 43.46772318147123, 57.438752812100546, 97.98385266959667, 74.25578465964642, 68.31946524512023, 66.87183946371076, 56.816611800342784, 85.58426968217827, 70.16783813014627, 38.46973601728678, 64.08028099685905, 55.75435610488054, 52.77275960892436, 69.87319488078354, 47.124028332531424, 52.77971589565277, 17.896646558074266, 50.94554705545305, 71.80476288497447, 66.17001951858398, 55.679083049297304, 56.8284858323168, 58.20137176825665, 74.98242267291059, 76.29578563943502, 53.143907587975264, 79.53411485627292, 61.67743534594773, 58.45754598826167, 56.02399127557871, 74.24337452650067, 66.37637536667714, 56.70664428919551, 85.30226849392056, 55.627959329634876, 76.2836742289364, 31.851898677647114, 78.955411484465, 68.26151774823666, 75.68843189533797, 58.14023581892252, 82.67207789793608, 76.55117016565052, 59.55451122298835, 39.763061955571175, 77.44446229189634, 55.527542632073164, 67.37137113045898, 52.92502643913029, 65.93723702430725, 72.24016111344098, 76.06561045348643, 67.4023503065109, 66.35233052074908, 50.29927936010061, 74.00116662681103, 90.01794366538523, 47.682854218408465, 78.13667185604572, 64.69377477467057, 66.47710437327623, 91.07491714507339, 67.13208781927823, 62.66468666121361, 61.26356851123272, 81.72381499409674, 66.7436634339392, 76.5726616308093, 48.92304256092757, 60.59432171168736, 75.81907621398568, 75.76026954269035, 79.87035019695759, 57.15712278336285, 71.19327104836701, 67.08874265849589, 59.26837765425441, 84.60848216526207, 66.07654940430075, 53.018250320106716, 51.78185455501078, 65.63732171803713, 66.27430569194254, 40.91918382793662, 73.6807633321732, 73.21972979232669, 55.952084109187126, 69.24479959160088, 49.13403334841129, 80.80003486666828, 99.974724881351, 76.95507368072866, 49.97062538191675, 53.643630891106994, 83.84109737724063, 69.2999385073781, 53.14436295628548], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.918656828502805, 19.16763079414764, 18.306147540609032, 24.55911120865494, 24.50840190052986, 24.523522034287453, 21.71904730796814, 22.20824635773897, 21.847780376672745, 14.584261782467365, 14.900296254083514, 13.98316514492035, 19.24421841596873, 19.142642742643744, 19.05189165348807, 32.58832951635122, 32.85228157043457, 32.54324158281088, 24.646130094925553, 24.705095293621213, 24.904559271099657, 22.97067394386977, 22.728635989129543, 22.620155312120914, 22.20311279098192, 22.42400812606016, 22.24471854666868, 18.915711631377533, 18.969587878634528, 18.931312290330723, 28.21944633126259, 28.378707259893417, 28.986116091022268, 23.428717087954283, 23.180290684103966, 23.558830358088017, 13.17630860954523, 12.621655985713005, 12.671771422028542, 21.424859358618647, 21.081705416242272, 21.573716221998126, 18.4716827298204, 18.476969028512627, 18.805704346547515, 17.292151289681584, 17.86190242196122, 17.618705897281558, 23.55289177348216, 23.241264720757798, 23.079038386543587, 15.425692106286675, 15.919288637737424, 15.779047588507325, 17.731779396533966, 17.372592642903328, 17.675343856215477, 6.118548914867759, 5.8792915691931995, 5.898806074013308, 17.043740538259343, 17.129734077801302, 16.772072439392403, 23.93779843797286, 23.946358298261956, 23.92060614873965, 22.08653341109553, 22.075238591680915, 22.00824751580754, 18.687813887993485, 18.452577004830033, 18.538692156473786, 18.986100282520056, 19.149319116724655, 18.69306643307209, 19.429870393127203, 19.574547884752974, 19.196953490376472, 25.281967516445235, 24.94698370496431, 24.753471451501042, 25.332031602660805, 25.263001451889664, 25.700752584884555, 17.54284379631281, 17.960904274135828, 17.640159517526627, 26.33565381666024, 26.804333352794245, 26.394127686818436, 20.24572080870469, 20.73795279425879, 20.69376174298425, 19.50149981180826, 19.598710181812436, 19.357335994640977, 18.49364678064981, 18.77444716791311, 18.755897327015788, 24.830771418909222, 24.688082220653683, 24.724520886937768, 21.919414843122155, 22.4110927129083, 22.045867810646683, 19.006603351483733, 18.798719505468995, 18.90132143224278, 28.559736225754023, 28.23139176517725, 28.511140502989292, 18.708232993880898, 18.65234617019692, 18.267380165557057, 25.41005816558996, 25.192371646563203, 25.681244416783244, 10.816746938973665, 10.300483338534832, 10.734668400138617, 26.645416406914592, 26.491873286664486, 25.818121790885925, 22.818606190383434, 22.634053967893124, 22.8088575899601, 25.05508459607759, 25.39066898605475, 25.24267831320563, 18.774579495191574, 19.66211048141122, 19.703545842319727, 27.618555201838404, 27.409791777531296, 27.643730918566376, 25.252604747811944, 25.76836690089354, 25.530198516945035, 19.846646775801972, 19.94009719168146, 19.76776725550492, 13.516571655869484, 13.299369871616364, 12.947120428085327, 25.78487493097782, 25.873241312801838, 25.786346048116684, 18.441759772598743, 18.631060268729925, 18.454722590744495, 21.819666291276604, 22.64723018060127, 22.90447465858111, 17.64034731437762, 17.681086865564183, 17.60359225918849, 22.0564873367548, 22.056997552514076, 21.823752135038376, 24.27272507299979, 23.851735343535736, 24.11570069690545, 25.74263822038968, 25.248590891559914, 25.074381341536835, 22.2397835801045, 22.500023717681557, 22.66254300872484, 22.274590761711195, 22.090032168974474, 21.98770759006341, 16.48257766415675, 16.94175170299907, 16.874949992944792, 24.484418988227844, 24.85103080421686, 24.66571683436632, 29.93452699979146, 29.828874488671616, 30.254542176922158, 16.15967725776136, 15.927237220108509, 15.595939740538597, 25.764358565211296, 26.28079053014517, 26.09152276068926, 21.50511663655439, 21.523275601367146, 21.665382536749036, 22.01396019011736, 22.203395169228315, 22.25974901393056, 30.279807205001504, 30.457564274470002, 30.33754566560188, 22.277650852998093, 22.44455563028653, 22.409881335993603, 20.705377067128808, 21.116985677431018, 20.842323916653783, 20.175402005513504, 20.644256434713796, 20.44391007100542, 27.22220045079787, 27.316891220708683, 27.184723322590187, 22.444495656838015, 22.025340427954987, 22.273827349146202, 25.16981513798237, 25.52181662619114, 25.8810298666358, 16.421443186700344, 16.71148497145623, 15.790114402770996, 20.527802083718896, 20.056697775920227, 20.009821852048233, 25.409874325618148, 25.015836969017982, 25.39336491934955, 25.186744583149746, 25.490845764831946, 25.08267919470866, 26.653688445687294, 26.34491068124771, 26.871751070022583, 19.046062880506113, 19.044653510053948, 19.06640639280279, 23.897980598111943, 23.98173775275548, 23.31355269749959, 22.41302530964215, 22.08859961231549, 22.587117736538247, 19.809976688275725, 19.918793162951857, 19.539607803026826, 27.887350673476845, 28.137458654741437, 28.583672837043792, 22.303384539671242, 22.089953135699034, 21.683211728930473, 17.561108260105044, 17.68938412393132, 17.767757936070353, 17.310939592619732, 17.210502823193863, 17.260412139197186, 21.98612768948078, 21.85076278448105, 21.8004312440753, 21.903206857542187, 22.31317847284177, 22.057920361558587, 13.414572800199181, 13.541549320022256, 13.963061707715184, 24.94681964131692, 24.53207544485727, 24.20186824599901, 24.104974195361137, 24.684910085052252, 24.4298455119133, 18.758869167417288, 18.79515640065074, 18.3980585411191, 22.96283886333306, 23.442263049383953, 22.839697678883866, 16.262973772982747, 16.541349350164325, 16.329710225264222, 26.776228066533804, 27.020817831158638, 27.002988968975842, 33.53635387122631, 33.19839307665825, 33.239977933466434, 25.765480933090046, 25.519679648180798, 25.669913099457816, 16.813761686285332, 16.365456153949097, 16.791407541682318, 17.567122573653847, 18.21214240944633, 17.864365908006818, 27.932910355428845, 27.997329379121453, 27.91085764269033, 23.069707185029984, 23.13108305633068, 23.099148266017437, 17.553339257836342, 17.83085185289383, 17.760171845555305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14332401109966175, "mean_inference_ms": 0.6447357032143108, "mean_action_processing_ms": 0.09485446222933691, "mean_env_wait_ms": 0.8022491300215104, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 1800000, "timers": {"sample_time_ms": 9088.235, "sample_throughput": 528.155, "load_time_ms": 0.199, "load_throughput": 24102309.589, "learn_time_ms": 1173.514, "learn_throughput": 4090.28, "update_time_ms": 1.402}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.921797811985016, "policy_loss": 0.001984427433861957, "vf_loss": 6.051769018173218, "vf_explained_var": -0.012687698006629944, "kl": 0.015498962544526089, "entropy": 13.335213303565979, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 1800000, "num_steps_trained": 600000, "num_agent_steps_trained": 1800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2929, "training_iteration": 125, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-02-13", "timestamp": 1706148133, "time_this_iter_s": 8.974310398101807, "time_total_s": 1173.2219405174255, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1C430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1173.2219405174255, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 7.6230769230769235, "ram_util_percent": 46.73846153846153}}
{"episode_reward_max": 99.974724881351, "episode_reward_min": -2.2950017638504505, "episode_reward_mean": 64.61464209047588, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -0.9958695992827415}, "policy_reward_max": {"shared_policy": 33.53635387122631}, "policy_reward_mean": {"shared_policy": 21.53821403015862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.87319488078354, 47.124028332531424, 52.77971589565277, 17.896646558074266, 50.94554705545305, 71.80476288497447, 66.17001951858398, 55.679083049297304, 56.8284858323168, 58.20137176825665, 74.98242267291059, 76.29578563943502, 53.143907587975264, 79.53411485627292, 61.67743534594773, 58.45754598826167, 56.02399127557871, 74.24337452650067, 66.37637536667714, 56.70664428919551, 85.30226849392056, 55.627959329634876, 76.2836742289364, 31.851898677647114, 78.955411484465, 68.26151774823666, 75.68843189533797, 58.14023581892252, 82.67207789793608, 76.55117016565052, 59.55451122298835, 39.763061955571175, 77.44446229189634, 55.527542632073164, 67.37137113045898, 52.92502643913029, 65.93723702430725, 72.24016111344098, 76.06561045348643, 67.4023503065109, 66.35233052074908, 50.29927936010061, 74.00116662681103, 90.01794366538523, 47.682854218408465, 78.13667185604572, 64.69377477467057, 66.47710437327623, 91.07491714507339, 67.13208781927823, 62.66468666121361, 61.26356851123272, 81.72381499409674, 66.7436634339392, 76.5726616308093, 48.92304256092757, 60.59432171168736, 75.81907621398568, 75.76026954269035, 79.87035019695759, 57.15712278336285, 71.19327104836701, 67.08874265849589, 59.26837765425441, 84.60848216526207, 66.07654940430075, 53.018250320106716, 51.78185455501078, 65.63732171803713, 66.27430569194254, 40.91918382793662, 73.6807633321732, 73.21972979232669, 55.952084109187126, 69.24479959160088, 49.13403334841129, 80.80003486666828, 99.974724881351, 76.95507368072866, 49.97062538191675, 53.643630891106994, 83.84109737724063, 69.2999385073781, 53.14436295628548, -2.2950017638504505, 73.24662499129771, 44.140553414821596, 71.72671705856916, 72.45364705473183, 68.2732719145715, 73.67536405846477, 47.0350084993988, 47.89122851751742, 80.32301957346499, 90.2765366360545, 77.93893662653862, 30.81706023216246, 56.906811903230846, 63.69105846807359, 79.3649918665178], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.55289177348216, 23.241264720757798, 23.079038386543587, 15.425692106286675, 15.919288637737424, 15.779047588507325, 17.731779396533966, 17.372592642903328, 17.675343856215477, 6.118548914867759, 5.8792915691931995, 5.898806074013308, 17.043740538259343, 17.129734077801302, 16.772072439392403, 23.93779843797286, 23.946358298261956, 23.92060614873965, 22.08653341109553, 22.075238591680915, 22.00824751580754, 18.687813887993485, 18.452577004830033, 18.538692156473786, 18.986100282520056, 19.149319116724655, 18.69306643307209, 19.429870393127203, 19.574547884752974, 19.196953490376472, 25.281967516445235, 24.94698370496431, 24.753471451501042, 25.332031602660805, 25.263001451889664, 25.700752584884555, 17.54284379631281, 17.960904274135828, 17.640159517526627, 26.33565381666024, 26.804333352794245, 26.394127686818436, 20.24572080870469, 20.73795279425879, 20.69376174298425, 19.50149981180826, 19.598710181812436, 19.357335994640977, 18.49364678064981, 18.77444716791311, 18.755897327015788, 24.830771418909222, 24.688082220653683, 24.724520886937768, 21.919414843122155, 22.4110927129083, 22.045867810646683, 19.006603351483733, 18.798719505468995, 18.90132143224278, 28.559736225754023, 28.23139176517725, 28.511140502989292, 18.708232993880898, 18.65234617019692, 18.267380165557057, 25.41005816558996, 25.192371646563203, 25.681244416783244, 10.816746938973665, 10.300483338534832, 10.734668400138617, 26.645416406914592, 26.491873286664486, 25.818121790885925, 22.818606190383434, 22.634053967893124, 22.8088575899601, 25.05508459607759, 25.39066898605475, 25.24267831320563, 18.774579495191574, 19.66211048141122, 19.703545842319727, 27.618555201838404, 27.409791777531296, 27.643730918566376, 25.252604747811944, 25.76836690089354, 25.530198516945035, 19.846646775801972, 19.94009719168146, 19.76776725550492, 13.516571655869484, 13.299369871616364, 12.947120428085327, 25.78487493097782, 25.873241312801838, 25.786346048116684, 18.441759772598743, 18.631060268729925, 18.454722590744495, 21.819666291276604, 22.64723018060127, 22.90447465858111, 17.64034731437762, 17.681086865564183, 17.60359225918849, 22.0564873367548, 22.056997552514076, 21.823752135038376, 24.27272507299979, 23.851735343535736, 24.11570069690545, 25.74263822038968, 25.248590891559914, 25.074381341536835, 22.2397835801045, 22.500023717681557, 22.66254300872484, 22.274590761711195, 22.090032168974474, 21.98770759006341, 16.48257766415675, 16.94175170299907, 16.874949992944792, 24.484418988227844, 24.85103080421686, 24.66571683436632, 29.93452699979146, 29.828874488671616, 30.254542176922158, 16.15967725776136, 15.927237220108509, 15.595939740538597, 25.764358565211296, 26.28079053014517, 26.09152276068926, 21.50511663655439, 21.523275601367146, 21.665382536749036, 22.01396019011736, 22.203395169228315, 22.25974901393056, 30.279807205001504, 30.457564274470002, 30.33754566560188, 22.277650852998093, 22.44455563028653, 22.409881335993603, 20.705377067128808, 21.116985677431018, 20.842323916653783, 20.175402005513504, 20.644256434713796, 20.44391007100542, 27.22220045079787, 27.316891220708683, 27.184723322590187, 22.444495656838015, 22.025340427954987, 22.273827349146202, 25.16981513798237, 25.52181662619114, 25.8810298666358, 16.421443186700344, 16.71148497145623, 15.790114402770996, 20.527802083718896, 20.056697775920227, 20.009821852048233, 25.409874325618148, 25.015836969017982, 25.39336491934955, 25.186744583149746, 25.490845764831946, 25.08267919470866, 26.653688445687294, 26.34491068124771, 26.871751070022583, 19.046062880506113, 19.044653510053948, 19.06640639280279, 23.897980598111943, 23.98173775275548, 23.31355269749959, 22.41302530964215, 22.08859961231549, 22.587117736538247, 19.809976688275725, 19.918793162951857, 19.539607803026826, 27.887350673476845, 28.137458654741437, 28.583672837043792, 22.303384539671242, 22.089953135699034, 21.683211728930473, 17.561108260105044, 17.68938412393132, 17.767757936070353, 17.310939592619732, 17.210502823193863, 17.260412139197186, 21.98612768948078, 21.85076278448105, 21.8004312440753, 21.903206857542187, 22.31317847284177, 22.057920361558587, 13.414572800199181, 13.541549320022256, 13.963061707715184, 24.94681964131692, 24.53207544485727, 24.20186824599901, 24.104974195361137, 24.684910085052252, 24.4298455119133, 18.758869167417288, 18.79515640065074, 18.3980585411191, 22.96283886333306, 23.442263049383953, 22.839697678883866, 16.262973772982747, 16.541349350164325, 16.329710225264222, 26.776228066533804, 27.020817831158638, 27.002988968975842, 33.53635387122631, 33.19839307665825, 33.239977933466434, 25.765480933090046, 25.519679648180798, 25.669913099457816, 16.813761686285332, 16.365456153949097, 16.791407541682318, 17.567122573653847, 18.21214240944633, 17.864365908006818, 27.932910355428845, 27.997329379121453, 27.91085764269033, 23.069707185029984, 23.13108305633068, 23.099148266017437, 17.553339257836342, 17.83085185289383, 17.760171845555305, -0.9958695992827415, -0.8229851350188255, -0.47614702954888344, 24.292112564047173, 24.267919336756066, 24.68659309049447, 14.660153890649468, 14.997435043255479, 14.48296448091665, 23.787152501444012, 24.02933772156635, 23.910226835558802, 23.936446030934647, 24.546310288210705, 23.97089073558648, 22.513007054726273, 22.811937386790902, 22.94832747305432, 24.121786892414093, 24.64425252377987, 24.909324642270803, 15.427895973126084, 15.778455103437096, 15.828657422835619, 16.293784864867717, 15.917181717852742, 15.68026193479696, 26.47601607441902, 26.83975701406598, 27.007246484979987, 29.998081137736634, 30.138111410041645, 30.140344088276223, 26.041444825318948, 25.86131440599759, 26.036177395222083, 10.439432469507054, 9.76653168102105, 10.611096081634358, 18.72536800056696, 18.959469974040985, 19.2219739286229, 21.194686030348137, 21.501153798153, 20.995218639572457, 26.402441044648484, 26.617850342610225, 26.34470047925909]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1432668147405489, "mean_inference_ms": 0.6446118327875634, "mean_action_processing_ms": 0.09483632858916177, "mean_env_wait_ms": 0.8019371739946776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 604800, "timesteps_this_iter": 0, "agent_timesteps_total": 1814400, "timers": {"sample_time_ms": 9092.583, "sample_throughput": 527.903, "load_time_ms": 0.199, "load_throughput": 24102309.589, "learn_time_ms": 1170.316, "learn_throughput": 4101.457, "update_time_ms": 1.399}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.884219527244568, "policy_loss": -0.00035084353064218643, "vf_loss": 7.017189621925354, "vf_explained_var": -0.004362925887107849, "kl": 0.008496732625802405, "entropy": 13.338475346565247, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 604800, "num_agent_steps_sampled": 1814400, "num_steps_trained": 604800, "num_agent_steps_trained": 1814400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2945, "training_iteration": 126, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-02-22", "timestamp": 1706148142, "time_this_iter_s": 9.050370454788208, "time_total_s": 1182.2723109722137, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1182.2723109722137, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 9.515384615384614, "ram_util_percent": 46.7}}
{"episode_reward_max": 99.974724881351, "episode_reward_min": -2.2950017638504505, "episode_reward_mean": 66.39455529970559, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -0.9958695992827415}, "policy_reward_max": {"shared_policy": 33.53635387122631}, "policy_reward_mean": {"shared_policy": 22.131518433235193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.02399127557871, 74.24337452650067, 66.37637536667714, 56.70664428919551, 85.30226849392056, 55.627959329634876, 76.2836742289364, 31.851898677647114, 78.955411484465, 68.26151774823666, 75.68843189533797, 58.14023581892252, 82.67207789793608, 76.55117016565052, 59.55451122298835, 39.763061955571175, 77.44446229189634, 55.527542632073164, 67.37137113045898, 52.92502643913029, 65.93723702430725, 72.24016111344098, 76.06561045348643, 67.4023503065109, 66.35233052074908, 50.29927936010061, 74.00116662681103, 90.01794366538523, 47.682854218408465, 78.13667185604572, 64.69377477467057, 66.47710437327623, 91.07491714507339, 67.13208781927823, 62.66468666121361, 61.26356851123272, 81.72381499409674, 66.7436634339392, 76.5726616308093, 48.92304256092757, 60.59432171168736, 75.81907621398568, 75.76026954269035, 79.87035019695759, 57.15712278336285, 71.19327104836701, 67.08874265849589, 59.26837765425441, 84.60848216526207, 66.07654940430075, 53.018250320106716, 51.78185455501078, 65.63732171803713, 66.27430569194254, 40.91918382793662, 73.6807633321732, 73.21972979232669, 55.952084109187126, 69.24479959160088, 49.13403334841129, 80.80003486666828, 99.974724881351, 76.95507368072866, 49.97062538191675, 53.643630891106994, 83.84109737724063, 69.2999385073781, 53.14436295628548, -2.2950017638504505, 73.24662499129771, 44.140553414821596, 71.72671705856916, 72.45364705473183, 68.2732719145715, 73.67536405846477, 47.0350084993988, 47.89122851751742, 80.32301957346499, 90.2765366360545, 77.93893662653862, 30.81706023216246, 56.906811903230846, 63.69105846807359, 79.3649918665178, 62.55942567065358, 67.16979433596134, 73.73312415555117, 73.81529103964567, 66.83805703185497, 72.1424603462219, 74.59134592860937, 86.33634578064084, 53.73437801748513, 85.57580640912053, 59.87461317330599, 50.766659304499626, 51.34633415192366, 69.18851473182437, 95.47823259234428, 86.23500612005589], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.49364678064981, 18.77444716791311, 18.755897327015788, 24.830771418909222, 24.688082220653683, 24.724520886937768, 21.919414843122155, 22.4110927129083, 22.045867810646683, 19.006603351483733, 18.798719505468995, 18.90132143224278, 28.559736225754023, 28.23139176517725, 28.511140502989292, 18.708232993880898, 18.65234617019692, 18.267380165557057, 25.41005816558996, 25.192371646563203, 25.681244416783244, 10.816746938973665, 10.300483338534832, 10.734668400138617, 26.645416406914592, 26.491873286664486, 25.818121790885925, 22.818606190383434, 22.634053967893124, 22.8088575899601, 25.05508459607759, 25.39066898605475, 25.24267831320563, 18.774579495191574, 19.66211048141122, 19.703545842319727, 27.618555201838404, 27.409791777531296, 27.643730918566376, 25.252604747811944, 25.76836690089354, 25.530198516945035, 19.846646775801972, 19.94009719168146, 19.76776725550492, 13.516571655869484, 13.299369871616364, 12.947120428085327, 25.78487493097782, 25.873241312801838, 25.786346048116684, 18.441759772598743, 18.631060268729925, 18.454722590744495, 21.819666291276604, 22.64723018060127, 22.90447465858111, 17.64034731437762, 17.681086865564183, 17.60359225918849, 22.0564873367548, 22.056997552514076, 21.823752135038376, 24.27272507299979, 23.851735343535736, 24.11570069690545, 25.74263822038968, 25.248590891559914, 25.074381341536835, 22.2397835801045, 22.500023717681557, 22.66254300872484, 22.274590761711195, 22.090032168974474, 21.98770759006341, 16.48257766415675, 16.94175170299907, 16.874949992944792, 24.484418988227844, 24.85103080421686, 24.66571683436632, 29.93452699979146, 29.828874488671616, 30.254542176922158, 16.15967725776136, 15.927237220108509, 15.595939740538597, 25.764358565211296, 26.28079053014517, 26.09152276068926, 21.50511663655439, 21.523275601367146, 21.665382536749036, 22.01396019011736, 22.203395169228315, 22.25974901393056, 30.279807205001504, 30.457564274470002, 30.33754566560188, 22.277650852998093, 22.44455563028653, 22.409881335993603, 20.705377067128808, 21.116985677431018, 20.842323916653783, 20.175402005513504, 20.644256434713796, 20.44391007100542, 27.22220045079787, 27.316891220708683, 27.184723322590187, 22.444495656838015, 22.025340427954987, 22.273827349146202, 25.16981513798237, 25.52181662619114, 25.8810298666358, 16.421443186700344, 16.71148497145623, 15.790114402770996, 20.527802083718896, 20.056697775920227, 20.009821852048233, 25.409874325618148, 25.015836969017982, 25.39336491934955, 25.186744583149746, 25.490845764831946, 25.08267919470866, 26.653688445687294, 26.34491068124771, 26.871751070022583, 19.046062880506113, 19.044653510053948, 19.06640639280279, 23.897980598111943, 23.98173775275548, 23.31355269749959, 22.41302530964215, 22.08859961231549, 22.587117736538247, 19.809976688275725, 19.918793162951857, 19.539607803026826, 27.887350673476845, 28.137458654741437, 28.583672837043792, 22.303384539671242, 22.089953135699034, 21.683211728930473, 17.561108260105044, 17.68938412393132, 17.767757936070353, 17.310939592619732, 17.210502823193863, 17.260412139197186, 21.98612768948078, 21.85076278448105, 21.8004312440753, 21.903206857542187, 22.31317847284177, 22.057920361558587, 13.414572800199181, 13.541549320022256, 13.963061707715184, 24.94681964131692, 24.53207544485727, 24.20186824599901, 24.104974195361137, 24.684910085052252, 24.4298455119133, 18.758869167417288, 18.79515640065074, 18.3980585411191, 22.96283886333306, 23.442263049383953, 22.839697678883866, 16.262973772982747, 16.541349350164325, 16.329710225264222, 26.776228066533804, 27.020817831158638, 27.002988968975842, 33.53635387122631, 33.19839307665825, 33.239977933466434, 25.765480933090046, 25.519679648180798, 25.669913099457816, 16.813761686285332, 16.365456153949097, 16.791407541682318, 17.567122573653847, 18.21214240944633, 17.864365908006818, 27.932910355428845, 27.997329379121453, 27.91085764269033, 23.069707185029984, 23.13108305633068, 23.099148266017437, 17.553339257836342, 17.83085185289383, 17.760171845555305, -0.9958695992827415, -0.8229851350188255, -0.47614702954888344, 24.292112564047173, 24.267919336756066, 24.68659309049447, 14.660153890649468, 14.997435043255479, 14.48296448091665, 23.787152501444012, 24.02933772156635, 23.910226835558802, 23.936446030934647, 24.546310288210705, 23.97089073558648, 22.513007054726273, 22.811937386790902, 22.94832747305432, 24.121786892414093, 24.64425252377987, 24.909324642270803, 15.427895973126084, 15.778455103437096, 15.828657422835619, 16.293784864867717, 15.917181717852742, 15.68026193479696, 26.47601607441902, 26.83975701406598, 27.007246484979987, 29.998081137736634, 30.138111410041645, 30.140344088276223, 26.041444825318948, 25.86131440599759, 26.036177395222083, 10.439432469507054, 9.76653168102105, 10.611096081634358, 18.72536800056696, 18.959469974040985, 19.2219739286229, 21.194686030348137, 21.501153798153, 20.995218639572457, 26.402441044648484, 26.617850342610225, 26.34470047925909, 20.68140199035406, 20.682201586663723, 21.195822093635798, 22.572142999619246, 22.38281163945794, 22.214839696884155, 24.09253607193628, 24.94817380482951, 24.692414278785378, 24.778581093996763, 24.377497285604477, 24.65921266004443, 22.121756610771016, 22.693964395051196, 22.02233602603276, 23.87616517643133, 24.227451557914407, 24.03884361187616, 24.879356756806374, 24.892182875424623, 24.819806296378374, 28.970871802419424, 28.76274149119854, 28.602732487022877, 18.114328814049557, 17.994195764263466, 17.625853439172104, 28.76773319641748, 28.393570477763802, 28.414502734939248, 20.004945397377014, 19.97624095529318, 19.893426820635796, 16.700643077492714, 17.078799437731504, 16.987216789275408, 17.036829605698586, 17.14630877226591, 17.16319577395916, 23.032221796611935, 23.1659906754891, 22.990302259723336, 31.861755914986134, 31.754684515297413, 31.861792162060738, 28.697486030558736, 28.666860828797013, 28.870659260700137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14319611518204145, "mean_inference_ms": 0.6445417512324907, "mean_action_processing_ms": 0.09481525331419903, "mean_env_wait_ms": 0.8016562038066687, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 609600, "timesteps_this_iter": 0, "agent_timesteps_total": 1828800, "timers": {"sample_time_ms": 9105.797, "sample_throughput": 527.137, "load_time_ms": 0.099, "load_throughput": 48419093.795, "learn_time_ms": 1166.308, "learn_throughput": 4115.552, "update_time_ms": 1.3}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.709963381290436, "policy_loss": 0.0013482274053967513, "vf_loss": 6.841488301753998, "vf_explained_var": -0.016183599829673767, "kl": 0.01571682246883418, "entropy": 13.428911805152893, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 609600, "num_agent_steps_sampled": 1828800, "num_steps_trained": 609600, "num_agent_steps_trained": 1828800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2961, "training_iteration": 127, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-02-31", "timestamp": 1706148151, "time_this_iter_s": 9.305121898651123, "time_total_s": 1191.5774328708649, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C22C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1191.5774328708649, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 10.946153846153846, "ram_util_percent": 46.80769230769231}}
{"episode_reward_max": 100.70062366127968, "episode_reward_min": -2.2950017638504505, "episode_reward_mean": 67.75673424073494, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -0.9958695992827415}, "policy_reward_max": {"shared_policy": 33.85382962971926}, "policy_reward_mean": {"shared_policy": 22.58557808024498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.44446229189634, 55.527542632073164, 67.37137113045898, 52.92502643913029, 65.93723702430725, 72.24016111344098, 76.06561045348643, 67.4023503065109, 66.35233052074908, 50.29927936010061, 74.00116662681103, 90.01794366538523, 47.682854218408465, 78.13667185604572, 64.69377477467057, 66.47710437327623, 91.07491714507339, 67.13208781927823, 62.66468666121361, 61.26356851123272, 81.72381499409674, 66.7436634339392, 76.5726616308093, 48.92304256092757, 60.59432171168736, 75.81907621398568, 75.76026954269035, 79.87035019695759, 57.15712278336285, 71.19327104836701, 67.08874265849589, 59.26837765425441, 84.60848216526207, 66.07654940430075, 53.018250320106716, 51.78185455501078, 65.63732171803713, 66.27430569194254, 40.91918382793662, 73.6807633321732, 73.21972979232669, 55.952084109187126, 69.24479959160088, 49.13403334841129, 80.80003486666828, 99.974724881351, 76.95507368072866, 49.97062538191675, 53.643630891106994, 83.84109737724063, 69.2999385073781, 53.14436295628548, -2.2950017638504505, 73.24662499129771, 44.140553414821596, 71.72671705856916, 72.45364705473183, 68.2732719145715, 73.67536405846477, 47.0350084993988, 47.89122851751742, 80.32301957346499, 90.2765366360545, 77.93893662653862, 30.81706023216246, 56.906811903230846, 63.69105846807359, 79.3649918665178, 62.55942567065358, 67.16979433596134, 73.73312415555117, 73.81529103964567, 66.83805703185497, 72.1424603462219, 74.59134592860937, 86.33634578064084, 53.73437801748513, 85.57580640912053, 59.87461317330599, 50.766659304499626, 51.34633415192366, 69.18851473182437, 95.47823259234428, 86.23500612005589, 48.32085007056591, 78.35059123090466, 74.57731640152632, 68.44402700662611, 77.01975948642938, 64.2173604061827, 69.97904973849651, 60.755414994433494, 75.48974722623825, 64.85089645534754, 100.70062366127968, 79.30202941410242, 91.80435937596485, 82.42632042150943, 78.06662177480757, 63.91553081572056], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.78487493097782, 25.873241312801838, 25.786346048116684, 18.441759772598743, 18.631060268729925, 18.454722590744495, 21.819666291276604, 22.64723018060127, 22.90447465858111, 17.64034731437762, 17.681086865564183, 17.60359225918849, 22.0564873367548, 22.056997552514076, 21.823752135038376, 24.27272507299979, 23.851735343535736, 24.11570069690545, 25.74263822038968, 25.248590891559914, 25.074381341536835, 22.2397835801045, 22.500023717681557, 22.66254300872484, 22.274590761711195, 22.090032168974474, 21.98770759006341, 16.48257766415675, 16.94175170299907, 16.874949992944792, 24.484418988227844, 24.85103080421686, 24.66571683436632, 29.93452699979146, 29.828874488671616, 30.254542176922158, 16.15967725776136, 15.927237220108509, 15.595939740538597, 25.764358565211296, 26.28079053014517, 26.09152276068926, 21.50511663655439, 21.523275601367146, 21.665382536749036, 22.01396019011736, 22.203395169228315, 22.25974901393056, 30.279807205001504, 30.457564274470002, 30.33754566560188, 22.277650852998093, 22.44455563028653, 22.409881335993603, 20.705377067128808, 21.116985677431018, 20.842323916653783, 20.175402005513504, 20.644256434713796, 20.44391007100542, 27.22220045079787, 27.316891220708683, 27.184723322590187, 22.444495656838015, 22.025340427954987, 22.273827349146202, 25.16981513798237, 25.52181662619114, 25.8810298666358, 16.421443186700344, 16.71148497145623, 15.790114402770996, 20.527802083718896, 20.056697775920227, 20.009821852048233, 25.409874325618148, 25.015836969017982, 25.39336491934955, 25.186744583149746, 25.490845764831946, 25.08267919470866, 26.653688445687294, 26.34491068124771, 26.871751070022583, 19.046062880506113, 19.044653510053948, 19.06640639280279, 23.897980598111943, 23.98173775275548, 23.31355269749959, 22.41302530964215, 22.08859961231549, 22.587117736538247, 19.809976688275725, 19.918793162951857, 19.539607803026826, 27.887350673476845, 28.137458654741437, 28.583672837043792, 22.303384539671242, 22.089953135699034, 21.683211728930473, 17.561108260105044, 17.68938412393132, 17.767757936070353, 17.310939592619732, 17.210502823193863, 17.260412139197186, 21.98612768948078, 21.85076278448105, 21.8004312440753, 21.903206857542187, 22.31317847284177, 22.057920361558587, 13.414572800199181, 13.541549320022256, 13.963061707715184, 24.94681964131692, 24.53207544485727, 24.20186824599901, 24.104974195361137, 24.684910085052252, 24.4298455119133, 18.758869167417288, 18.79515640065074, 18.3980585411191, 22.96283886333306, 23.442263049383953, 22.839697678883866, 16.262973772982747, 16.541349350164325, 16.329710225264222, 26.776228066533804, 27.020817831158638, 27.002988968975842, 33.53635387122631, 33.19839307665825, 33.239977933466434, 25.765480933090046, 25.519679648180798, 25.669913099457816, 16.813761686285332, 16.365456153949097, 16.791407541682318, 17.567122573653847, 18.21214240944633, 17.864365908006818, 27.932910355428845, 27.997329379121453, 27.91085764269033, 23.069707185029984, 23.13108305633068, 23.099148266017437, 17.553339257836342, 17.83085185289383, 17.760171845555305, -0.9958695992827415, -0.8229851350188255, -0.47614702954888344, 24.292112564047173, 24.267919336756066, 24.68659309049447, 14.660153890649468, 14.997435043255479, 14.48296448091665, 23.787152501444012, 24.02933772156635, 23.910226835558802, 23.936446030934647, 24.546310288210705, 23.97089073558648, 22.513007054726273, 22.811937386790902, 22.94832747305432, 24.121786892414093, 24.64425252377987, 24.909324642270803, 15.427895973126084, 15.778455103437096, 15.828657422835619, 16.293784864867717, 15.917181717852742, 15.68026193479696, 26.47601607441902, 26.83975701406598, 27.007246484979987, 29.998081137736634, 30.138111410041645, 30.140344088276223, 26.041444825318948, 25.86131440599759, 26.036177395222083, 10.439432469507054, 9.76653168102105, 10.611096081634358, 18.72536800056696, 18.959469974040985, 19.2219739286229, 21.194686030348137, 21.501153798153, 20.995218639572457, 26.402441044648484, 26.617850342610225, 26.34470047925909, 20.68140199035406, 20.682201586663723, 21.195822093635798, 22.572142999619246, 22.38281163945794, 22.214839696884155, 24.09253607193628, 24.94817380482951, 24.692414278785378, 24.778581093996763, 24.377497285604477, 24.65921266004443, 22.121756610771016, 22.693964395051196, 22.02233602603276, 23.87616517643133, 24.227451557914407, 24.03884361187616, 24.879356756806374, 24.892182875424623, 24.819806296378374, 28.970871802419424, 28.76274149119854, 28.602732487022877, 18.114328814049557, 17.994195764263466, 17.625853439172104, 28.76773319641748, 28.393570477763802, 28.414502734939248, 20.004945397377014, 19.97624095529318, 19.893426820635796, 16.700643077492714, 17.078799437731504, 16.987216789275408, 17.036829605698586, 17.14630877226591, 17.16319577395916, 23.032221796611935, 23.1659906754891, 22.990302259723336, 31.861755914986134, 31.754684515297413, 31.861792162060738, 28.697486030558736, 28.666860828797013, 28.870659260700137, 15.896463851133973, 16.394782243917376, 16.02960397551456, 26.199938262502343, 25.69756170610586, 26.453091262296454, 25.287061917906, 24.570894127090767, 24.71936035652955, 23.144938697417572, 22.927688111861542, 22.371400197347, 25.777404977319136, 25.55577391137679, 25.686580597733453, 21.62559339310974, 21.425857841968536, 21.16590917110443, 23.00814565519491, 23.310713137189538, 23.660190946112067, 20.649603460604936, 20.379262822369725, 19.726548711458832, 25.330188632942736, 24.81730554252863, 25.342253050766885, 21.603012658655643, 21.806266471743584, 21.44161732494831, 33.152441173791885, 33.694352857768536, 33.85382962971926, 26.509969367956117, 26.309726753582552, 26.48233329256375, 30.4985086992383, 30.56685270741582, 30.73899796931073, 27.592716927950576, 27.164239225288227, 27.669364268270627, 25.533712297677994, 26.301473962143064, 26.231435514986515, 21.458334289491177, 21.087703332304955, 21.369493193924427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1431306290265032, "mean_inference_ms": 0.6444846741132508, "mean_action_processing_ms": 0.0947892753418832, "mean_env_wait_ms": 0.8013935078412413, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 614400, "timesteps_this_iter": 0, "agent_timesteps_total": 1843200, "timers": {"sample_time_ms": 9089.196, "sample_throughput": 528.1, "load_time_ms": 0.099, "load_throughput": 48419093.795, "learn_time_ms": 1166.801, "learn_throughput": 4113.811, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.4839189648628235, "policy_loss": 0.002830995957677551, "vf_loss": 5.614886164665222, "vf_explained_var": -0.03946748375892639, "kl": 0.014852115302511189, "entropy": 13.51365315914154, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 614400, "num_agent_steps_sampled": 1843200, "num_steps_trained": 614400, "num_agent_steps_trained": 1843200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2977, "training_iteration": 128, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-02-40", "timestamp": 1706148160, "time_this_iter_s": 9.079366683959961, "time_total_s": 1200.6567995548248, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F9040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1200.6567995548248, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 6.253846153846154, "ram_util_percent": 46.81538461538461}}
{"episode_reward_max": 100.70062366127968, "episode_reward_min": -2.2950017638504505, "episode_reward_mean": 67.86914405508665, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -0.9958695992827415}, "policy_reward_max": {"shared_policy": 33.85382962971926}, "policy_reward_mean": {"shared_policy": 22.623048018362212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.07491714507339, 67.13208781927823, 62.66468666121361, 61.26356851123272, 81.72381499409674, 66.7436634339392, 76.5726616308093, 48.92304256092757, 60.59432171168736, 75.81907621398568, 75.76026954269035, 79.87035019695759, 57.15712278336285, 71.19327104836701, 67.08874265849589, 59.26837765425441, 84.60848216526207, 66.07654940430075, 53.018250320106716, 51.78185455501078, 65.63732171803713, 66.27430569194254, 40.91918382793662, 73.6807633321732, 73.21972979232669, 55.952084109187126, 69.24479959160088, 49.13403334841129, 80.80003486666828, 99.974724881351, 76.95507368072866, 49.97062538191675, 53.643630891106994, 83.84109737724063, 69.2999385073781, 53.14436295628548, -2.2950017638504505, 73.24662499129771, 44.140553414821596, 71.72671705856916, 72.45364705473183, 68.2732719145715, 73.67536405846477, 47.0350084993988, 47.89122851751742, 80.32301957346499, 90.2765366360545, 77.93893662653862, 30.81706023216246, 56.906811903230846, 63.69105846807359, 79.3649918665178, 62.55942567065358, 67.16979433596134, 73.73312415555117, 73.81529103964567, 66.83805703185497, 72.1424603462219, 74.59134592860937, 86.33634578064084, 53.73437801748513, 85.57580640912053, 59.87461317330599, 50.766659304499626, 51.34633415192366, 69.18851473182437, 95.47823259234428, 86.23500612005589, 48.32085007056591, 78.35059123090466, 74.57731640152632, 68.44402700662611, 77.01975948642938, 64.2173604061827, 69.97904973849651, 60.755414994433494, 75.48974722623825, 64.85089645534754, 100.70062366127968, 79.30202941410242, 91.80435937596485, 82.42632042150943, 78.06662177480757, 63.91553081572056, 75.92163333296776, 71.20480814576148, 77.06988945184273, 83.21719043329355, 77.33672219514845, 43.82744343951343, 74.75488333404063, 63.26855235546826, 96.64671853929757, 76.42453601211308, 69.15619687736032, 34.0404797941446, 71.76198909804224, 47.718460985692204, 70.60394467413424, 50.86241955310105], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.279807205001504, 30.457564274470002, 30.33754566560188, 22.277650852998093, 22.44455563028653, 22.409881335993603, 20.705377067128808, 21.116985677431018, 20.842323916653783, 20.175402005513504, 20.644256434713796, 20.44391007100542, 27.22220045079787, 27.316891220708683, 27.184723322590187, 22.444495656838015, 22.025340427954987, 22.273827349146202, 25.16981513798237, 25.52181662619114, 25.8810298666358, 16.421443186700344, 16.71148497145623, 15.790114402770996, 20.527802083718896, 20.056697775920227, 20.009821852048233, 25.409874325618148, 25.015836969017982, 25.39336491934955, 25.186744583149746, 25.490845764831946, 25.08267919470866, 26.653688445687294, 26.34491068124771, 26.871751070022583, 19.046062880506113, 19.044653510053948, 19.06640639280279, 23.897980598111943, 23.98173775275548, 23.31355269749959, 22.41302530964215, 22.08859961231549, 22.587117736538247, 19.809976688275725, 19.918793162951857, 19.539607803026826, 27.887350673476845, 28.137458654741437, 28.583672837043792, 22.303384539671242, 22.089953135699034, 21.683211728930473, 17.561108260105044, 17.68938412393132, 17.767757936070353, 17.310939592619732, 17.210502823193863, 17.260412139197186, 21.98612768948078, 21.85076278448105, 21.8004312440753, 21.903206857542187, 22.31317847284177, 22.057920361558587, 13.414572800199181, 13.541549320022256, 13.963061707715184, 24.94681964131692, 24.53207544485727, 24.20186824599901, 24.104974195361137, 24.684910085052252, 24.4298455119133, 18.758869167417288, 18.79515640065074, 18.3980585411191, 22.96283886333306, 23.442263049383953, 22.839697678883866, 16.262973772982747, 16.541349350164325, 16.329710225264222, 26.776228066533804, 27.020817831158638, 27.002988968975842, 33.53635387122631, 33.19839307665825, 33.239977933466434, 25.765480933090046, 25.519679648180798, 25.669913099457816, 16.813761686285332, 16.365456153949097, 16.791407541682318, 17.567122573653847, 18.21214240944633, 17.864365908006818, 27.932910355428845, 27.997329379121453, 27.91085764269033, 23.069707185029984, 23.13108305633068, 23.099148266017437, 17.553339257836342, 17.83085185289383, 17.760171845555305, -0.9958695992827415, -0.8229851350188255, -0.47614702954888344, 24.292112564047173, 24.267919336756066, 24.68659309049447, 14.660153890649468, 14.997435043255479, 14.48296448091665, 23.787152501444012, 24.02933772156635, 23.910226835558802, 23.936446030934647, 24.546310288210705, 23.97089073558648, 22.513007054726273, 22.811937386790902, 22.94832747305432, 24.121786892414093, 24.64425252377987, 24.909324642270803, 15.427895973126084, 15.778455103437096, 15.828657422835619, 16.293784864867717, 15.917181717852742, 15.68026193479696, 26.47601607441902, 26.83975701406598, 27.007246484979987, 29.998081137736634, 30.138111410041645, 30.140344088276223, 26.041444825318948, 25.86131440599759, 26.036177395222083, 10.439432469507054, 9.76653168102105, 10.611096081634358, 18.72536800056696, 18.959469974040985, 19.2219739286229, 21.194686030348137, 21.501153798153, 20.995218639572457, 26.402441044648484, 26.617850342610225, 26.34470047925909, 20.68140199035406, 20.682201586663723, 21.195822093635798, 22.572142999619246, 22.38281163945794, 22.214839696884155, 24.09253607193628, 24.94817380482951, 24.692414278785378, 24.778581093996763, 24.377497285604477, 24.65921266004443, 22.121756610771016, 22.693964395051196, 22.02233602603276, 23.87616517643133, 24.227451557914407, 24.03884361187616, 24.879356756806374, 24.892182875424623, 24.819806296378374, 28.970871802419424, 28.76274149119854, 28.602732487022877, 18.114328814049557, 17.994195764263466, 17.625853439172104, 28.76773319641748, 28.393570477763802, 28.414502734939248, 20.004945397377014, 19.97624095529318, 19.893426820635796, 16.700643077492714, 17.078799437731504, 16.987216789275408, 17.036829605698586, 17.14630877226591, 17.16319577395916, 23.032221796611935, 23.1659906754891, 22.990302259723336, 31.861755914986134, 31.754684515297413, 31.861792162060738, 28.697486030558736, 28.666860828797013, 28.870659260700137, 15.896463851133973, 16.394782243917376, 16.02960397551456, 26.199938262502343, 25.69756170610586, 26.453091262296454, 25.287061917906, 24.570894127090767, 24.71936035652955, 23.144938697417572, 22.927688111861542, 22.371400197347, 25.777404977319136, 25.55577391137679, 25.686580597733453, 21.62559339310974, 21.425857841968536, 21.16590917110443, 23.00814565519491, 23.310713137189538, 23.660190946112067, 20.649603460604936, 20.379262822369725, 19.726548711458832, 25.330188632942736, 24.81730554252863, 25.342253050766885, 21.603012658655643, 21.806266471743584, 21.44161732494831, 33.152441173791885, 33.694352857768536, 33.85382962971926, 26.509969367956117, 26.309726753582552, 26.48233329256375, 30.4985086992383, 30.56685270741582, 30.73899796931073, 27.592716927950576, 27.164239225288227, 27.669364268270627, 25.533712297677994, 26.301473962143064, 26.231435514986515, 21.458334289491177, 21.087703332304955, 21.369493193924427, 25.42638174444437, 25.358958162367344, 25.136293426156044, 23.722012122472123, 23.778087613483265, 23.704708409806088, 26.093014171502233, 25.002426619331032, 25.97444866100946, 27.67567332337299, 27.849686979005725, 27.691830130914838, 26.09836660077174, 25.781896484394863, 25.45645910998185, 14.772166789819792, 14.65120283265908, 14.404073817034558, 24.895351250966385, 24.73344253500302, 25.12608954807122, 21.149431904156998, 21.278772977491215, 20.840347473820046, 32.02004498740037, 32.24812294294436, 32.378550608952835, 25.473344778021172, 25.625838009019688, 25.32535322507222, 23.037425893048436, 23.007630127171666, 23.111140857140214, 11.332135232786328, 11.032563964525849, 11.675780596832425, 23.709250902136162, 23.888126788039997, 24.164611407866076, 16.197505338660747, 15.741655831535653, 15.779299815495804, 23.53648480524619, 23.49574141701062, 23.57171845187743, 16.87305351843436, 17.074819711347416, 16.91454632331927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14306389398994926, "mean_inference_ms": 0.6444307812832186, "mean_action_processing_ms": 0.09476164323072628, "mean_env_wait_ms": 0.8011379083246937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 619200, "timesteps_this_iter": 0, "agent_timesteps_total": 1857600, "timers": {"sample_time_ms": 9079.708, "sample_throughput": 528.651, "load_time_ms": 0.099, "load_throughput": 48419093.795, "learn_time_ms": 1169.5, "learn_throughput": 4104.317, "update_time_ms": 1.201}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.533363699913025, "policy_loss": -0.0005240227090608229, "vf_loss": 6.668676674365997, "vf_explained_var": -0.01861715316772461, "kl": 0.008424642204937839, "entropy": 13.554782390594482, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 619200, "num_agent_steps_sampled": 1857600, "num_steps_trained": 619200, "num_agent_steps_trained": 1857600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2993, "training_iteration": 129, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-02-49", "timestamp": 1706148169, "time_this_iter_s": 8.96564269065857, "time_total_s": 1209.6224422454834, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1209.6224422454834, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 7.115384615384615, "ram_util_percent": 46.75384615384615}}
{"episode_reward_max": 100.70062366127968, "episode_reward_min": -2.2950017638504505, "episode_reward_mean": 68.06996013130149, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -0.9958695992827415}, "policy_reward_max": {"shared_policy": 33.85382962971926}, "policy_reward_mean": {"shared_policy": 22.68998671043382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.60848216526207, 66.07654940430075, 53.018250320106716, 51.78185455501078, 65.63732171803713, 66.27430569194254, 40.91918382793662, 73.6807633321732, 73.21972979232669, 55.952084109187126, 69.24479959160088, 49.13403334841129, 80.80003486666828, 99.974724881351, 76.95507368072866, 49.97062538191675, 53.643630891106994, 83.84109737724063, 69.2999385073781, 53.14436295628548, -2.2950017638504505, 73.24662499129771, 44.140553414821596, 71.72671705856916, 72.45364705473183, 68.2732719145715, 73.67536405846477, 47.0350084993988, 47.89122851751742, 80.32301957346499, 90.2765366360545, 77.93893662653862, 30.81706023216246, 56.906811903230846, 63.69105846807359, 79.3649918665178, 62.55942567065358, 67.16979433596134, 73.73312415555117, 73.81529103964567, 66.83805703185497, 72.1424603462219, 74.59134592860937, 86.33634578064084, 53.73437801748513, 85.57580640912053, 59.87461317330599, 50.766659304499626, 51.34633415192366, 69.18851473182437, 95.47823259234428, 86.23500612005589, 48.32085007056591, 78.35059123090466, 74.57731640152632, 68.44402700662611, 77.01975948642938, 64.2173604061827, 69.97904973849651, 60.755414994433494, 75.48974722623825, 64.85089645534754, 100.70062366127968, 79.30202941410242, 91.80435937596485, 82.42632042150943, 78.06662177480757, 63.91553081572056, 75.92163333296776, 71.20480814576148, 77.06988945184273, 83.21719043329355, 77.33672219514845, 43.82744343951343, 74.75488333404063, 63.26855235546826, 96.64671853929757, 76.42453601211308, 69.15619687736032, 34.0404797941446, 71.76198909804224, 47.718460985692204, 70.60394467413424, 50.86241955310105, 76.84701480343936, 71.99023342877624, 49.97470471938139, 65.18898973986506, 71.48103539645672, 72.45512703247365, 52.37689597159623, 83.95395370246843, 68.06331462971865, 66.55345109850165, 70.1250409334898, 84.85846643554393, 68.50914890458806, 76.6307740882039, 75.09613163769244, 68.82729966565967], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.887350673476845, 28.137458654741437, 28.583672837043792, 22.303384539671242, 22.089953135699034, 21.683211728930473, 17.561108260105044, 17.68938412393132, 17.767757936070353, 17.310939592619732, 17.210502823193863, 17.260412139197186, 21.98612768948078, 21.85076278448105, 21.8004312440753, 21.903206857542187, 22.31317847284177, 22.057920361558587, 13.414572800199181, 13.541549320022256, 13.963061707715184, 24.94681964131692, 24.53207544485727, 24.20186824599901, 24.104974195361137, 24.684910085052252, 24.4298455119133, 18.758869167417288, 18.79515640065074, 18.3980585411191, 22.96283886333306, 23.442263049383953, 22.839697678883866, 16.262973772982747, 16.541349350164325, 16.329710225264222, 26.776228066533804, 27.020817831158638, 27.002988968975842, 33.53635387122631, 33.19839307665825, 33.239977933466434, 25.765480933090046, 25.519679648180798, 25.669913099457816, 16.813761686285332, 16.365456153949097, 16.791407541682318, 17.567122573653847, 18.21214240944633, 17.864365908006818, 27.932910355428845, 27.997329379121453, 27.91085764269033, 23.069707185029984, 23.13108305633068, 23.099148266017437, 17.553339257836342, 17.83085185289383, 17.760171845555305, -0.9958695992827415, -0.8229851350188255, -0.47614702954888344, 24.292112564047173, 24.267919336756066, 24.68659309049447, 14.660153890649468, 14.997435043255479, 14.48296448091665, 23.787152501444012, 24.02933772156635, 23.910226835558802, 23.936446030934647, 24.546310288210705, 23.97089073558648, 22.513007054726273, 22.811937386790902, 22.94832747305432, 24.121786892414093, 24.64425252377987, 24.909324642270803, 15.427895973126084, 15.778455103437096, 15.828657422835619, 16.293784864867717, 15.917181717852742, 15.68026193479696, 26.47601607441902, 26.83975701406598, 27.007246484979987, 29.998081137736634, 30.138111410041645, 30.140344088276223, 26.041444825318948, 25.86131440599759, 26.036177395222083, 10.439432469507054, 9.76653168102105, 10.611096081634358, 18.72536800056696, 18.959469974040985, 19.2219739286229, 21.194686030348137, 21.501153798153, 20.995218639572457, 26.402441044648484, 26.617850342610225, 26.34470047925909, 20.68140199035406, 20.682201586663723, 21.195822093635798, 22.572142999619246, 22.38281163945794, 22.214839696884155, 24.09253607193628, 24.94817380482951, 24.692414278785378, 24.778581093996763, 24.377497285604477, 24.65921266004443, 22.121756610771016, 22.693964395051196, 22.02233602603276, 23.87616517643133, 24.227451557914407, 24.03884361187616, 24.879356756806374, 24.892182875424623, 24.819806296378374, 28.970871802419424, 28.76274149119854, 28.602732487022877, 18.114328814049557, 17.994195764263466, 17.625853439172104, 28.76773319641748, 28.393570477763802, 28.414502734939248, 20.004945397377014, 19.97624095529318, 19.893426820635796, 16.700643077492714, 17.078799437731504, 16.987216789275408, 17.036829605698586, 17.14630877226591, 17.16319577395916, 23.032221796611935, 23.1659906754891, 22.990302259723336, 31.861755914986134, 31.754684515297413, 31.861792162060738, 28.697486030558736, 28.666860828797013, 28.870659260700137, 15.896463851133973, 16.394782243917376, 16.02960397551456, 26.199938262502343, 25.69756170610586, 26.453091262296454, 25.287061917906, 24.570894127090767, 24.71936035652955, 23.144938697417572, 22.927688111861542, 22.371400197347, 25.777404977319136, 25.55577391137679, 25.686580597733453, 21.62559339310974, 21.425857841968536, 21.16590917110443, 23.00814565519491, 23.310713137189538, 23.660190946112067, 20.649603460604936, 20.379262822369725, 19.726548711458832, 25.330188632942736, 24.81730554252863, 25.342253050766885, 21.603012658655643, 21.806266471743584, 21.44161732494831, 33.152441173791885, 33.694352857768536, 33.85382962971926, 26.509969367956117, 26.309726753582552, 26.48233329256375, 30.4985086992383, 30.56685270741582, 30.73899796931073, 27.592716927950576, 27.164239225288227, 27.669364268270627, 25.533712297677994, 26.301473962143064, 26.231435514986515, 21.458334289491177, 21.087703332304955, 21.369493193924427, 25.42638174444437, 25.358958162367344, 25.136293426156044, 23.722012122472123, 23.778087613483265, 23.704708409806088, 26.093014171502233, 25.002426619331032, 25.97444866100946, 27.67567332337299, 27.849686979005725, 27.691830130914838, 26.09836660077174, 25.781896484394863, 25.45645910998185, 14.772166789819792, 14.65120283265908, 14.404073817034558, 24.895351250966385, 24.73344253500302, 25.12608954807122, 21.149431904156998, 21.278772977491215, 20.840347473820046, 32.02004498740037, 32.24812294294436, 32.378550608952835, 25.473344778021172, 25.625838009019688, 25.32535322507222, 23.037425893048436, 23.007630127171666, 23.111140857140214, 11.332135232786328, 11.032563964525849, 11.675780596832425, 23.709250902136162, 23.888126788039997, 24.164611407866076, 16.197505338660747, 15.741655831535653, 15.779299815495804, 23.53648480524619, 23.49574141701062, 23.57171845187743, 16.87305351843436, 17.074819711347416, 16.91454632331927, 25.76565809672077, 25.53202936549981, 25.549327341218785, 23.96412772188583, 24.19155606130758, 23.834549645582825, 16.715889223230377, 16.764012785240382, 16.494802710910633, 21.93927351012826, 21.671220488846302, 21.578495740890503, 23.608990103006363, 23.939316399395466, 23.93272889405489, 24.32943941342333, 24.14923984805742, 23.976447770992905, 17.629343201716736, 17.113075261314705, 17.634477508564785, 27.855716418474913, 27.95508086308837, 28.143156420905143, 22.74932881755133, 22.7280482177933, 22.585937594374016, 22.167042436699063, 21.901520023743302, 22.48488863805929, 23.205622248351574, 23.472882732748985, 23.44653595238924, 28.53708604258523, 28.079637760917336, 28.241742632041365, 22.45486094554265, 22.89741751675804, 23.15687044228737, 25.234220519661903, 25.541762605309486, 25.854790963232517, 24.991312262912587, 25.085824144383267, 25.018995230396584, 22.407494008541107, 23.083813421428204, 23.335992235690355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1429852934345467, "mean_inference_ms": 0.6443758637752763, "mean_action_processing_ms": 0.09473652028290908, "mean_env_wait_ms": 0.8008921303126573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 624000, "timesteps_this_iter": 0, "agent_timesteps_total": 1872000, "timers": {"sample_time_ms": 9051.362, "sample_throughput": 530.307, "load_time_ms": 0.099, "load_throughput": 48419093.795, "learn_time_ms": 1167.1, "learn_throughput": 4112.76, "update_time_ms": 1.2}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.474989533424377, "policy_loss": -0.0007180766720811249, "vf_loss": 5.610549688339233, "vf_explained_var": -0.021880611777305603, "kl": 0.007145997195202137, "entropy": 13.548580884933472, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 624000, "num_agent_steps_sampled": 1872000, "num_steps_trained": 624000, "num_agent_steps_trained": 1872000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3009, "training_iteration": 130, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-02-58", "timestamp": 1706148178, "time_this_iter_s": 8.915584087371826, "time_total_s": 1218.5380263328552, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1218.5380263328552, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 8.591666666666667, "ram_util_percent": 46.724999999999994}}
{"episode_reward_max": 100.70062366127968, "episode_reward_min": -2.2950017638504505, "episode_reward_mean": 69.51632804489316, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -0.9958695992827415}, "policy_reward_max": {"shared_policy": 33.85382962971926}, "policy_reward_mean": {"shared_policy": 23.172109348297713}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.643630891106994, 83.84109737724063, 69.2999385073781, 53.14436295628548, -2.2950017638504505, 73.24662499129771, 44.140553414821596, 71.72671705856916, 72.45364705473183, 68.2732719145715, 73.67536405846477, 47.0350084993988, 47.89122851751742, 80.32301957346499, 90.2765366360545, 77.93893662653862, 30.81706023216246, 56.906811903230846, 63.69105846807359, 79.3649918665178, 62.55942567065358, 67.16979433596134, 73.73312415555117, 73.81529103964567, 66.83805703185497, 72.1424603462219, 74.59134592860937, 86.33634578064084, 53.73437801748513, 85.57580640912053, 59.87461317330599, 50.766659304499626, 51.34633415192366, 69.18851473182437, 95.47823259234428, 86.23500612005589, 48.32085007056591, 78.35059123090466, 74.57731640152632, 68.44402700662611, 77.01975948642938, 64.2173604061827, 69.97904973849651, 60.755414994433494, 75.48974722623825, 64.85089645534754, 100.70062366127968, 79.30202941410242, 91.80435937596485, 82.42632042150943, 78.06662177480757, 63.91553081572056, 75.92163333296776, 71.20480814576148, 77.06988945184273, 83.21719043329355, 77.33672219514845, 43.82744343951343, 74.75488333404063, 63.26855235546826, 96.64671853929757, 76.42453601211308, 69.15619687736032, 34.0404797941446, 71.76198909804224, 47.718460985692204, 70.60394467413424, 50.86241955310105, 76.84701480343936, 71.99023342877624, 49.97470471938139, 65.18898973986506, 71.48103539645672, 72.45512703247365, 52.37689597159623, 83.95395370246843, 68.06331462971865, 66.55345109850165, 70.1250409334898, 84.85846643554393, 68.50914890458806, 76.6307740882039, 75.09613163769244, 68.82729966565967, 69.33910711482167, 66.1995745366439, 56.465073220431805, 87.11917534843087, 61.416920293122516, 90.06393161462618, 77.09203867241739, 64.20544700324535, 100.0757743641734, 79.11378471925853, 64.24331671744585, 81.00514730811116, 58.73090344667432, 88.43902634829281, 90.31150528043507, 68.06388203799722], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.567122573653847, 18.21214240944633, 17.864365908006818, 27.932910355428845, 27.997329379121453, 27.91085764269033, 23.069707185029984, 23.13108305633068, 23.099148266017437, 17.553339257836342, 17.83085185289383, 17.760171845555305, -0.9958695992827415, -0.8229851350188255, -0.47614702954888344, 24.292112564047173, 24.267919336756066, 24.68659309049447, 14.660153890649468, 14.997435043255479, 14.48296448091665, 23.787152501444012, 24.02933772156635, 23.910226835558802, 23.936446030934647, 24.546310288210705, 23.97089073558648, 22.513007054726273, 22.811937386790902, 22.94832747305432, 24.121786892414093, 24.64425252377987, 24.909324642270803, 15.427895973126084, 15.778455103437096, 15.828657422835619, 16.293784864867717, 15.917181717852742, 15.68026193479696, 26.47601607441902, 26.83975701406598, 27.007246484979987, 29.998081137736634, 30.138111410041645, 30.140344088276223, 26.041444825318948, 25.86131440599759, 26.036177395222083, 10.439432469507054, 9.76653168102105, 10.611096081634358, 18.72536800056696, 18.959469974040985, 19.2219739286229, 21.194686030348137, 21.501153798153, 20.995218639572457, 26.402441044648484, 26.617850342610225, 26.34470047925909, 20.68140199035406, 20.682201586663723, 21.195822093635798, 22.572142999619246, 22.38281163945794, 22.214839696884155, 24.09253607193628, 24.94817380482951, 24.692414278785378, 24.778581093996763, 24.377497285604477, 24.65921266004443, 22.121756610771016, 22.693964395051196, 22.02233602603276, 23.87616517643133, 24.227451557914407, 24.03884361187616, 24.879356756806374, 24.892182875424623, 24.819806296378374, 28.970871802419424, 28.76274149119854, 28.602732487022877, 18.114328814049557, 17.994195764263466, 17.625853439172104, 28.76773319641748, 28.393570477763802, 28.414502734939248, 20.004945397377014, 19.97624095529318, 19.893426820635796, 16.700643077492714, 17.078799437731504, 16.987216789275408, 17.036829605698586, 17.14630877226591, 17.16319577395916, 23.032221796611935, 23.1659906754891, 22.990302259723336, 31.861755914986134, 31.754684515297413, 31.861792162060738, 28.697486030558736, 28.666860828797013, 28.870659260700137, 15.896463851133973, 16.394782243917376, 16.02960397551456, 26.199938262502343, 25.69756170610586, 26.453091262296454, 25.287061917906, 24.570894127090767, 24.71936035652955, 23.144938697417572, 22.927688111861542, 22.371400197347, 25.777404977319136, 25.55577391137679, 25.686580597733453, 21.62559339310974, 21.425857841968536, 21.16590917110443, 23.00814565519491, 23.310713137189538, 23.660190946112067, 20.649603460604936, 20.379262822369725, 19.726548711458832, 25.330188632942736, 24.81730554252863, 25.342253050766885, 21.603012658655643, 21.806266471743584, 21.44161732494831, 33.152441173791885, 33.694352857768536, 33.85382962971926, 26.509969367956117, 26.309726753582552, 26.48233329256375, 30.4985086992383, 30.56685270741582, 30.73899796931073, 27.592716927950576, 27.164239225288227, 27.669364268270627, 25.533712297677994, 26.301473962143064, 26.231435514986515, 21.458334289491177, 21.087703332304955, 21.369493193924427, 25.42638174444437, 25.358958162367344, 25.136293426156044, 23.722012122472123, 23.778087613483265, 23.704708409806088, 26.093014171502233, 25.002426619331032, 25.97444866100946, 27.67567332337299, 27.849686979005725, 27.691830130914838, 26.09836660077174, 25.781896484394863, 25.45645910998185, 14.772166789819792, 14.65120283265908, 14.404073817034558, 24.895351250966385, 24.73344253500302, 25.12608954807122, 21.149431904156998, 21.278772977491215, 20.840347473820046, 32.02004498740037, 32.24812294294436, 32.378550608952835, 25.473344778021172, 25.625838009019688, 25.32535322507222, 23.037425893048436, 23.007630127171666, 23.111140857140214, 11.332135232786328, 11.032563964525849, 11.675780596832425, 23.709250902136162, 23.888126788039997, 24.164611407866076, 16.197505338660747, 15.741655831535653, 15.779299815495804, 23.53648480524619, 23.49574141701062, 23.57171845187743, 16.87305351843436, 17.074819711347416, 16.91454632331927, 25.76565809672077, 25.53202936549981, 25.549327341218785, 23.96412772188583, 24.19155606130758, 23.834549645582825, 16.715889223230377, 16.764012785240382, 16.494802710910633, 21.93927351012826, 21.671220488846302, 21.578495740890503, 23.608990103006363, 23.939316399395466, 23.93272889405489, 24.32943941342333, 24.14923984805742, 23.976447770992905, 17.629343201716736, 17.113075261314705, 17.634477508564785, 27.855716418474913, 27.95508086308837, 28.143156420905143, 22.74932881755133, 22.7280482177933, 22.585937594374016, 22.167042436699063, 21.901520023743302, 22.48488863805929, 23.205622248351574, 23.472882732748985, 23.44653595238924, 28.53708604258523, 28.079637760917336, 28.241742632041365, 22.45486094554265, 22.89741751675804, 23.15687044228737, 25.234220519661903, 25.541762605309486, 25.854790963232517, 24.991312262912587, 25.085824144383267, 25.018995230396584, 22.407494008541107, 23.083813421428204, 23.335992235690355, 22.672628924250603, 23.577445592731237, 23.089032597839832, 21.99413290123144, 21.851573492089898, 22.353868143322558, 18.903248481452465, 18.81701471656561, 18.74481002241373, 29.08150839433074, 29.029297780245543, 29.00836917385459, 20.739870623995856, 20.490470615526036, 20.186579053600624, 29.710149136682347, 30.181969201968357, 30.17181327597548, 25.81562078868349, 25.61612182607253, 25.66029605766137, 21.392249122262, 21.354922905564308, 21.458274975419044, 33.38068569203217, 33.31503952046235, 33.380049151678875, 26.260772561033562, 26.107112010320023, 26.745900147904948, 21.625825375318527, 21.228973291814327, 21.388518050312996, 27.118973987797887, 26.909470851222665, 26.97670246909061, 19.408839503924042, 19.58710805575052, 19.734955886999757, 29.302198832233742, 29.419910853107766, 29.716916662951306, 29.977227141459778, 30.185088132818535, 30.149190006156758, 22.291130463282258, 22.751701364914567, 23.021050209800393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14291834769923945, "mean_inference_ms": 0.644313370813334, "mean_action_processing_ms": 0.0947129999550447, "mean_env_wait_ms": 0.8006473200473211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 628800, "timesteps_this_iter": 0, "agent_timesteps_total": 1886400, "timers": {"sample_time_ms": 9042.89, "sample_throughput": 530.804, "load_time_ms": 0.099, "load_throughput": 48419093.795, "learn_time_ms": 1167.48, "learn_throughput": 4111.419, "update_time_ms": 1.299}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 7.1743491888046265, "policy_loss": -0.00027225000743380523, "vf_loss": 7.309511780738831, "vf_explained_var": -0.006524026393890381, "kl": 0.008061547269046412, "entropy": 13.561691880226135, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 628800, "num_agent_steps_sampled": 1886400, "num_steps_trained": 628800, "num_agent_steps_trained": 1886400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3025, "training_iteration": 131, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-03-07", "timestamp": 1706148187, "time_this_iter_s": 8.961006164550781, "time_total_s": 1227.499032497406, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1227.499032497406, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 7.307692307692308, "ram_util_percent": 46.78461538461538}}
{"episode_reward_max": 100.70062366127968, "episode_reward_min": 30.81706023216246, "episode_reward_mean": 71.58269129967171, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.76653168102105}, "policy_reward_max": {"shared_policy": 33.85382962971926}, "policy_reward_mean": {"shared_policy": 23.860897099890565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.81706023216246, 56.906811903230846, 63.69105846807359, 79.3649918665178, 62.55942567065358, 67.16979433596134, 73.73312415555117, 73.81529103964567, 66.83805703185497, 72.1424603462219, 74.59134592860937, 86.33634578064084, 53.73437801748513, 85.57580640912053, 59.87461317330599, 50.766659304499626, 51.34633415192366, 69.18851473182437, 95.47823259234428, 86.23500612005589, 48.32085007056591, 78.35059123090466, 74.57731640152632, 68.44402700662611, 77.01975948642938, 64.2173604061827, 69.97904973849651, 60.755414994433494, 75.48974722623825, 64.85089645534754, 100.70062366127968, 79.30202941410242, 91.80435937596485, 82.42632042150943, 78.06662177480757, 63.91553081572056, 75.92163333296776, 71.20480814576148, 77.06988945184273, 83.21719043329355, 77.33672219514845, 43.82744343951343, 74.75488333404063, 63.26855235546826, 96.64671853929757, 76.42453601211308, 69.15619687736032, 34.0404797941446, 71.76198909804224, 47.718460985692204, 70.60394467413424, 50.86241955310105, 76.84701480343936, 71.99023342877624, 49.97470471938139, 65.18898973986506, 71.48103539645672, 72.45512703247365, 52.37689597159623, 83.95395370246843, 68.06331462971865, 66.55345109850165, 70.1250409334898, 84.85846643554393, 68.50914890458806, 76.6307740882039, 75.09613163769244, 68.82729966565967, 69.33910711482167, 66.1995745366439, 56.465073220431805, 87.11917534843087, 61.416920293122516, 90.06393161462618, 77.09203867241739, 64.20544700324535, 100.0757743641734, 79.11378471925853, 64.24331671744585, 81.00514730811116, 58.73090344667432, 88.43902634829281, 90.31150528043507, 68.06388203799722, 70.5233807340264, 81.83282072283326, 83.98480359092355, 78.7581577571109, 96.31614798307417, 81.48240107065064, 79.06041301414369, 70.43314910936166, 80.56564164534208, 74.82887916266915, 88.81880005449054, 73.97362285107373, 59.764960531145306, 60.52391501236707, 59.04866342432797, 71.3355051279068], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [10.439432469507054, 9.76653168102105, 10.611096081634358, 18.72536800056696, 18.959469974040985, 19.2219739286229, 21.194686030348137, 21.501153798153, 20.995218639572457, 26.402441044648484, 26.617850342610225, 26.34470047925909, 20.68140199035406, 20.682201586663723, 21.195822093635798, 22.572142999619246, 22.38281163945794, 22.214839696884155, 24.09253607193628, 24.94817380482951, 24.692414278785378, 24.778581093996763, 24.377497285604477, 24.65921266004443, 22.121756610771016, 22.693964395051196, 22.02233602603276, 23.87616517643133, 24.227451557914407, 24.03884361187616, 24.879356756806374, 24.892182875424623, 24.819806296378374, 28.970871802419424, 28.76274149119854, 28.602732487022877, 18.114328814049557, 17.994195764263466, 17.625853439172104, 28.76773319641748, 28.393570477763802, 28.414502734939248, 20.004945397377014, 19.97624095529318, 19.893426820635796, 16.700643077492714, 17.078799437731504, 16.987216789275408, 17.036829605698586, 17.14630877226591, 17.16319577395916, 23.032221796611935, 23.1659906754891, 22.990302259723336, 31.861755914986134, 31.754684515297413, 31.861792162060738, 28.697486030558736, 28.666860828797013, 28.870659260700137, 15.896463851133973, 16.394782243917376, 16.02960397551456, 26.199938262502343, 25.69756170610586, 26.453091262296454, 25.287061917906, 24.570894127090767, 24.71936035652955, 23.144938697417572, 22.927688111861542, 22.371400197347, 25.777404977319136, 25.55577391137679, 25.686580597733453, 21.62559339310974, 21.425857841968536, 21.16590917110443, 23.00814565519491, 23.310713137189538, 23.660190946112067, 20.649603460604936, 20.379262822369725, 19.726548711458832, 25.330188632942736, 24.81730554252863, 25.342253050766885, 21.603012658655643, 21.806266471743584, 21.44161732494831, 33.152441173791885, 33.694352857768536, 33.85382962971926, 26.509969367956117, 26.309726753582552, 26.48233329256375, 30.4985086992383, 30.56685270741582, 30.73899796931073, 27.592716927950576, 27.164239225288227, 27.669364268270627, 25.533712297677994, 26.301473962143064, 26.231435514986515, 21.458334289491177, 21.087703332304955, 21.369493193924427, 25.42638174444437, 25.358958162367344, 25.136293426156044, 23.722012122472123, 23.778087613483265, 23.704708409806088, 26.093014171502233, 25.002426619331032, 25.97444866100946, 27.67567332337299, 27.849686979005725, 27.691830130914838, 26.09836660077174, 25.781896484394863, 25.45645910998185, 14.772166789819792, 14.65120283265908, 14.404073817034558, 24.895351250966385, 24.73344253500302, 25.12608954807122, 21.149431904156998, 21.278772977491215, 20.840347473820046, 32.02004498740037, 32.24812294294436, 32.378550608952835, 25.473344778021172, 25.625838009019688, 25.32535322507222, 23.037425893048436, 23.007630127171666, 23.111140857140214, 11.332135232786328, 11.032563964525849, 11.675780596832425, 23.709250902136162, 23.888126788039997, 24.164611407866076, 16.197505338660747, 15.741655831535653, 15.779299815495804, 23.53648480524619, 23.49574141701062, 23.57171845187743, 16.87305351843436, 17.074819711347416, 16.91454632331927, 25.76565809672077, 25.53202936549981, 25.549327341218785, 23.96412772188583, 24.19155606130758, 23.834549645582825, 16.715889223230377, 16.764012785240382, 16.494802710910633, 21.93927351012826, 21.671220488846302, 21.578495740890503, 23.608990103006363, 23.939316399395466, 23.93272889405489, 24.32943941342333, 24.14923984805742, 23.976447770992905, 17.629343201716736, 17.113075261314705, 17.634477508564785, 27.855716418474913, 27.95508086308837, 28.143156420905143, 22.74932881755133, 22.7280482177933, 22.585937594374016, 22.167042436699063, 21.901520023743302, 22.48488863805929, 23.205622248351574, 23.472882732748985, 23.44653595238924, 28.53708604258523, 28.079637760917336, 28.241742632041365, 22.45486094554265, 22.89741751675804, 23.15687044228737, 25.234220519661903, 25.541762605309486, 25.854790963232517, 24.991312262912587, 25.085824144383267, 25.018995230396584, 22.407494008541107, 23.083813421428204, 23.335992235690355, 22.672628924250603, 23.577445592731237, 23.089032597839832, 21.99413290123144, 21.851573492089898, 22.353868143322558, 18.903248481452465, 18.81701471656561, 18.74481002241373, 29.08150839433074, 29.029297780245543, 29.00836917385459, 20.739870623995856, 20.490470615526036, 20.186579053600624, 29.710149136682347, 30.181969201968357, 30.17181327597548, 25.81562078868349, 25.61612182607253, 25.66029605766137, 21.392249122262, 21.354922905564308, 21.458274975419044, 33.38068569203217, 33.31503952046235, 33.380049151678875, 26.260772561033562, 26.107112010320023, 26.745900147904948, 21.625825375318527, 21.228973291814327, 21.388518050312996, 27.118973987797887, 26.909470851222665, 26.97670246909061, 19.408839503924042, 19.58710805575052, 19.734955886999757, 29.302198832233742, 29.419910853107766, 29.716916662951306, 29.977227141459778, 30.185088132818535, 30.149190006156758, 22.291130463282258, 22.751701364914567, 23.021050209800393, 23.22900704542795, 23.607190060118825, 23.68718362847963, 27.549400213484958, 26.930043404301003, 27.3533771050473, 28.209984723478556, 27.61152397096157, 28.16329489648342, 26.378260203637183, 26.19667273014784, 26.183224823325872, 32.297471319635704, 32.30244167645772, 31.71623498698075, 26.926045725742966, 27.28258965133378, 27.273765693573893, 26.16979670276244, 26.454082900037363, 26.436533411343888, 23.472414620841533, 23.592770292811707, 23.367964195708424, 26.85238369802633, 27.03270788366595, 26.680550063649804, 24.84845998386541, 24.997961620489747, 24.982457558313996, 29.62737304965654, 29.6808500761787, 29.510576928655297, 24.761132196833685, 24.765131221463278, 24.447359432776764, 19.82616455356279, 20.05517332876721, 19.883622648815305, 20.432892550714314, 20.00033489614725, 20.090687565505505, 19.767263922840357, 19.524070620536804, 19.75732888095081, 23.570477351546288, 23.687435522675514, 24.077592253684998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14284917917984485, "mean_inference_ms": 0.6442208444007055, "mean_action_processing_ms": 0.09469434655986339, "mean_env_wait_ms": 0.8003915324241728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 633600, "timesteps_this_iter": 0, "agent_timesteps_total": 1900800, "timers": {"sample_time_ms": 9033.664, "sample_throughput": 531.346, "load_time_ms": 0.199, "load_throughput": 24099424.467, "learn_time_ms": 1167.781, "learn_throughput": 4110.361, "update_time_ms": 1.299}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.851841926574707, "policy_loss": 0.001121929586386461, "vf_loss": 5.986454665660858, "vf_explained_var": -0.019625157117843628, "kl": 0.01013036980310705, "entropy": 13.664732336997986, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 633600, "num_agent_steps_sampled": 1900800, "num_steps_trained": 633600, "num_agent_steps_trained": 1900800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3041, "training_iteration": 132, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-03-16", "timestamp": 1706148196, "time_this_iter_s": 8.85462212562561, "time_total_s": 1236.3536546230316, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1236.3536546230316, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 5.025, "ram_util_percent": 46.76666666666666}}
{"episode_reward_max": 105.58799757121596, "episode_reward_min": 34.0404797941446, "episode_reward_mean": 72.5002040014902, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 11.032563964525849}, "policy_reward_max": {"shared_policy": 35.37743170617614}, "policy_reward_mean": {"shared_policy": 24.166734667163393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.34633415192366, 69.18851473182437, 95.47823259234428, 86.23500612005589, 48.32085007056591, 78.35059123090466, 74.57731640152632, 68.44402700662611, 77.01975948642938, 64.2173604061827, 69.97904973849651, 60.755414994433494, 75.48974722623825, 64.85089645534754, 100.70062366127968, 79.30202941410242, 91.80435937596485, 82.42632042150943, 78.06662177480757, 63.91553081572056, 75.92163333296776, 71.20480814576148, 77.06988945184273, 83.21719043329355, 77.33672219514845, 43.82744343951343, 74.75488333404063, 63.26855235546826, 96.64671853929757, 76.42453601211308, 69.15619687736032, 34.0404797941446, 71.76198909804224, 47.718460985692204, 70.60394467413424, 50.86241955310105, 76.84701480343936, 71.99023342877624, 49.97470471938139, 65.18898973986506, 71.48103539645672, 72.45512703247365, 52.37689597159623, 83.95395370246843, 68.06331462971865, 66.55345109850165, 70.1250409334898, 84.85846643554393, 68.50914890458806, 76.6307740882039, 75.09613163769244, 68.82729966565967, 69.33910711482167, 66.1995745366439, 56.465073220431805, 87.11917534843087, 61.416920293122516, 90.06393161462618, 77.09203867241739, 64.20544700324535, 100.0757743641734, 79.11378471925853, 64.24331671744585, 81.00514730811116, 58.73090344667432, 88.43902634829281, 90.31150528043507, 68.06388203799722, 70.5233807340264, 81.83282072283326, 83.98480359092355, 78.7581577571109, 96.31614798307417, 81.48240107065064, 79.06041301414369, 70.43314910936166, 80.56564164534208, 74.82887916266915, 88.81880005449054, 73.97362285107373, 59.764960531145306, 60.52391501236707, 59.04866342432797, 71.3355051279068, 46.775693658739314, 68.8604687526822, 75.40616106987, 69.77300770604049, 44.87875872477886, 71.42461056751198, 76.45120235159993, 77.36813943088053, 105.58799757121596, 78.26872856169939, 76.30802664905784, 57.09351013600825, 84.04844674537887, 80.56892086565495, 73.01253062486649, 63.84229042939842], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.036829605698586, 17.14630877226591, 17.16319577395916, 23.032221796611935, 23.1659906754891, 22.990302259723336, 31.861755914986134, 31.754684515297413, 31.861792162060738, 28.697486030558736, 28.666860828797013, 28.870659260700137, 15.896463851133973, 16.394782243917376, 16.02960397551456, 26.199938262502343, 25.69756170610586, 26.453091262296454, 25.287061917906, 24.570894127090767, 24.71936035652955, 23.144938697417572, 22.927688111861542, 22.371400197347, 25.777404977319136, 25.55577391137679, 25.686580597733453, 21.62559339310974, 21.425857841968536, 21.16590917110443, 23.00814565519491, 23.310713137189538, 23.660190946112067, 20.649603460604936, 20.379262822369725, 19.726548711458832, 25.330188632942736, 24.81730554252863, 25.342253050766885, 21.603012658655643, 21.806266471743584, 21.44161732494831, 33.152441173791885, 33.694352857768536, 33.85382962971926, 26.509969367956117, 26.309726753582552, 26.48233329256375, 30.4985086992383, 30.56685270741582, 30.73899796931073, 27.592716927950576, 27.164239225288227, 27.669364268270627, 25.533712297677994, 26.301473962143064, 26.231435514986515, 21.458334289491177, 21.087703332304955, 21.369493193924427, 25.42638174444437, 25.358958162367344, 25.136293426156044, 23.722012122472123, 23.778087613483265, 23.704708409806088, 26.093014171502233, 25.002426619331032, 25.97444866100946, 27.67567332337299, 27.849686979005725, 27.691830130914838, 26.09836660077174, 25.781896484394863, 25.45645910998185, 14.772166789819792, 14.65120283265908, 14.404073817034558, 24.895351250966385, 24.73344253500302, 25.12608954807122, 21.149431904156998, 21.278772977491215, 20.840347473820046, 32.02004498740037, 32.24812294294436, 32.378550608952835, 25.473344778021172, 25.625838009019688, 25.32535322507222, 23.037425893048436, 23.007630127171666, 23.111140857140214, 11.332135232786328, 11.032563964525849, 11.675780596832425, 23.709250902136162, 23.888126788039997, 24.164611407866076, 16.197505338660747, 15.741655831535653, 15.779299815495804, 23.53648480524619, 23.49574141701062, 23.57171845187743, 16.87305351843436, 17.074819711347416, 16.91454632331927, 25.76565809672077, 25.53202936549981, 25.549327341218785, 23.96412772188583, 24.19155606130758, 23.834549645582825, 16.715889223230377, 16.764012785240382, 16.494802710910633, 21.93927351012826, 21.671220488846302, 21.578495740890503, 23.608990103006363, 23.939316399395466, 23.93272889405489, 24.32943941342333, 24.14923984805742, 23.976447770992905, 17.629343201716736, 17.113075261314705, 17.634477508564785, 27.855716418474913, 27.95508086308837, 28.143156420905143, 22.74932881755133, 22.7280482177933, 22.585937594374016, 22.167042436699063, 21.901520023743302, 22.48488863805929, 23.205622248351574, 23.472882732748985, 23.44653595238924, 28.53708604258523, 28.079637760917336, 28.241742632041365, 22.45486094554265, 22.89741751675804, 23.15687044228737, 25.234220519661903, 25.541762605309486, 25.854790963232517, 24.991312262912587, 25.085824144383267, 25.018995230396584, 22.407494008541107, 23.083813421428204, 23.335992235690355, 22.672628924250603, 23.577445592731237, 23.089032597839832, 21.99413290123144, 21.851573492089898, 22.353868143322558, 18.903248481452465, 18.81701471656561, 18.74481002241373, 29.08150839433074, 29.029297780245543, 29.00836917385459, 20.739870623995856, 20.490470615526036, 20.186579053600624, 29.710149136682347, 30.181969201968357, 30.17181327597548, 25.81562078868349, 25.61612182607253, 25.66029605766137, 21.392249122262, 21.354922905564308, 21.458274975419044, 33.38068569203217, 33.31503952046235, 33.380049151678875, 26.260772561033562, 26.107112010320023, 26.745900147904948, 21.625825375318527, 21.228973291814327, 21.388518050312996, 27.118973987797887, 26.909470851222665, 26.97670246909061, 19.408839503924042, 19.58710805575052, 19.734955886999757, 29.302198832233742, 29.419910853107766, 29.716916662951306, 29.977227141459778, 30.185088132818535, 30.149190006156758, 22.291130463282258, 22.751701364914567, 23.021050209800393, 23.22900704542795, 23.607190060118825, 23.68718362847963, 27.549400213484958, 26.930043404301003, 27.3533771050473, 28.209984723478556, 27.61152397096157, 28.16329489648342, 26.378260203637183, 26.19667273014784, 26.183224823325872, 32.297471319635704, 32.30244167645772, 31.71623498698075, 26.926045725742966, 27.28258965133378, 27.273765693573893, 26.16979670276244, 26.454082900037363, 26.436533411343888, 23.472414620841533, 23.592770292811707, 23.367964195708424, 26.85238369802633, 27.03270788366595, 26.680550063649804, 24.84845998386541, 24.997961620489747, 24.982457558313996, 29.62737304965654, 29.6808500761787, 29.510576928655297, 24.761132196833685, 24.765131221463278, 24.447359432776764, 19.82616455356279, 20.05517332876721, 19.883622648815305, 20.432892550714314, 20.00033489614725, 20.090687565505505, 19.767263922840357, 19.524070620536804, 19.75732888095081, 23.570477351546288, 23.687435522675514, 24.077592253684998, 15.78086719786127, 15.558285181721047, 15.436541279156998, 22.92611928035815, 22.73228635390599, 23.202063118418053, 24.943627059459686, 25.203892193734646, 25.258641816675663, 23.40220998126702, 23.141064918289572, 23.229732806483895, 14.884061115483433, 15.032721972713858, 14.96197563658157, 23.750253458817795, 23.610368621846035, 24.063988486848146, 25.737106297165155, 25.148356407880783, 25.565739646553993, 26.061341946323708, 25.81007707615693, 25.496720408399895, 35.37743170617614, 35.183530904352665, 35.02703496068716, 26.202296145260334, 26.320193201303482, 25.746239215135574, 25.39373608926931, 25.3541130448381, 25.560177514950425, 19.09465718766053, 19.17737591763337, 18.821477030714348, 28.080400335292012, 27.584823514024407, 28.38322289606245, 26.846643328666687, 26.860518246889114, 26.861759290099144, 24.115360990166664, 24.426671244204044, 24.470498390495777, 21.374644374474883, 21.3911786749959, 21.076467379927635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14279615007633145, "mean_inference_ms": 0.6440885254506402, "mean_action_processing_ms": 0.09468317774504223, "mean_env_wait_ms": 0.8001101174978328, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 638400, "timesteps_this_iter": 0, "agent_timesteps_total": 1915200, "timers": {"sample_time_ms": 9043.031, "sample_throughput": 530.795, "load_time_ms": 0.1, "load_throughput": 47980598.665, "learn_time_ms": 1168.788, "learn_throughput": 4106.82, "update_time_ms": 1.298}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.8400333523750305, "policy_loss": 0.0018841555315076697, "vf_loss": 5.975058376789093, "vf_explained_var": -0.036399781703948975, "kl": 0.01064489956496787, "entropy": 13.78684675693512, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 638400, "num_agent_steps_sampled": 1915200, "num_steps_trained": 638400, "num_agent_steps_trained": 1915200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3057, "training_iteration": 133, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-03-25", "timestamp": 1706148205, "time_this_iter_s": 9.07810354232788, "time_total_s": 1245.4317581653595, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1245.4317581653595, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 6.230769230769231, "ram_util_percent": 46.87692307692308}}
{"episode_reward_max": 105.58799757121596, "episode_reward_min": 34.0404797941446, "episode_reward_mean": 72.425273181827, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 11.032563964525849}, "policy_reward_max": {"shared_policy": 35.37743170617614}, "policy_reward_mean": {"shared_policy": 24.14175772727566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.80435937596485, 82.42632042150943, 78.06662177480757, 63.91553081572056, 75.92163333296776, 71.20480814576148, 77.06988945184273, 83.21719043329355, 77.33672219514845, 43.82744343951343, 74.75488333404063, 63.26855235546826, 96.64671853929757, 76.42453601211308, 69.15619687736032, 34.0404797941446, 71.76198909804224, 47.718460985692204, 70.60394467413424, 50.86241955310105, 76.84701480343936, 71.99023342877624, 49.97470471938139, 65.18898973986506, 71.48103539645672, 72.45512703247365, 52.37689597159623, 83.95395370246843, 68.06331462971865, 66.55345109850165, 70.1250409334898, 84.85846643554393, 68.50914890458806, 76.6307740882039, 75.09613163769244, 68.82729966565967, 69.33910711482167, 66.1995745366439, 56.465073220431805, 87.11917534843087, 61.416920293122516, 90.06393161462618, 77.09203867241739, 64.20544700324535, 100.0757743641734, 79.11378471925853, 64.24331671744585, 81.00514730811116, 58.73090344667432, 88.43902634829281, 90.31150528043507, 68.06388203799722, 70.5233807340264, 81.83282072283326, 83.98480359092355, 78.7581577571109, 96.31614798307417, 81.48240107065064, 79.06041301414369, 70.43314910936166, 80.56564164534208, 74.82887916266915, 88.81880005449054, 73.97362285107373, 59.764960531145306, 60.52391501236707, 59.04866342432797, 71.3355051279068, 46.775693658739314, 68.8604687526822, 75.40616106987, 69.77300770604049, 44.87875872477886, 71.42461056751198, 76.45120235159993, 77.36813943088053, 105.58799757121596, 78.26872856169939, 76.30802664905784, 57.09351013600825, 84.04844674537887, 80.56892086565495, 73.01253062486649, 63.84229042939842, 78.85891402512787, 58.251789193600416, 85.43513935431838, 81.10634667798877, 80.71804735064507, 64.32238337770104, 65.59825818240641, 83.70159665495157, 77.87808334673898, 51.950372306630015, 86.8003495535813, 63.72894559055567, 64.31532894074915, 70.73143162578343, 77.62682999297975, 65.73885554820296], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.4985086992383, 30.56685270741582, 30.73899796931073, 27.592716927950576, 27.164239225288227, 27.669364268270627, 25.533712297677994, 26.301473962143064, 26.231435514986515, 21.458334289491177, 21.087703332304955, 21.369493193924427, 25.42638174444437, 25.358958162367344, 25.136293426156044, 23.722012122472123, 23.778087613483265, 23.704708409806088, 26.093014171502233, 25.002426619331032, 25.97444866100946, 27.67567332337299, 27.849686979005725, 27.691830130914838, 26.09836660077174, 25.781896484394863, 25.45645910998185, 14.772166789819792, 14.65120283265908, 14.404073817034558, 24.895351250966385, 24.73344253500302, 25.12608954807122, 21.149431904156998, 21.278772977491215, 20.840347473820046, 32.02004498740037, 32.24812294294436, 32.378550608952835, 25.473344778021172, 25.625838009019688, 25.32535322507222, 23.037425893048436, 23.007630127171666, 23.111140857140214, 11.332135232786328, 11.032563964525849, 11.675780596832425, 23.709250902136162, 23.888126788039997, 24.164611407866076, 16.197505338660747, 15.741655831535653, 15.779299815495804, 23.53648480524619, 23.49574141701062, 23.57171845187743, 16.87305351843436, 17.074819711347416, 16.91454632331927, 25.76565809672077, 25.53202936549981, 25.549327341218785, 23.96412772188583, 24.19155606130758, 23.834549645582825, 16.715889223230377, 16.764012785240382, 16.494802710910633, 21.93927351012826, 21.671220488846302, 21.578495740890503, 23.608990103006363, 23.939316399395466, 23.93272889405489, 24.32943941342333, 24.14923984805742, 23.976447770992905, 17.629343201716736, 17.113075261314705, 17.634477508564785, 27.855716418474913, 27.95508086308837, 28.143156420905143, 22.74932881755133, 22.7280482177933, 22.585937594374016, 22.167042436699063, 21.901520023743302, 22.48488863805929, 23.205622248351574, 23.472882732748985, 23.44653595238924, 28.53708604258523, 28.079637760917336, 28.241742632041365, 22.45486094554265, 22.89741751675804, 23.15687044228737, 25.234220519661903, 25.541762605309486, 25.854790963232517, 24.991312262912587, 25.085824144383267, 25.018995230396584, 22.407494008541107, 23.083813421428204, 23.335992235690355, 22.672628924250603, 23.577445592731237, 23.089032597839832, 21.99413290123144, 21.851573492089898, 22.353868143322558, 18.903248481452465, 18.81701471656561, 18.74481002241373, 29.08150839433074, 29.029297780245543, 29.00836917385459, 20.739870623995856, 20.490470615526036, 20.186579053600624, 29.710149136682347, 30.181969201968357, 30.17181327597548, 25.81562078868349, 25.61612182607253, 25.66029605766137, 21.392249122262, 21.354922905564308, 21.458274975419044, 33.38068569203217, 33.31503952046235, 33.380049151678875, 26.260772561033562, 26.107112010320023, 26.745900147904948, 21.625825375318527, 21.228973291814327, 21.388518050312996, 27.118973987797887, 26.909470851222665, 26.97670246909061, 19.408839503924042, 19.58710805575052, 19.734955886999757, 29.302198832233742, 29.419910853107766, 29.716916662951306, 29.977227141459778, 30.185088132818535, 30.149190006156758, 22.291130463282258, 22.751701364914567, 23.021050209800393, 23.22900704542795, 23.607190060118825, 23.68718362847963, 27.549400213484958, 26.930043404301003, 27.3533771050473, 28.209984723478556, 27.61152397096157, 28.16329489648342, 26.378260203637183, 26.19667273014784, 26.183224823325872, 32.297471319635704, 32.30244167645772, 31.71623498698075, 26.926045725742966, 27.28258965133378, 27.273765693573893, 26.16979670276244, 26.454082900037363, 26.436533411343888, 23.472414620841533, 23.592770292811707, 23.367964195708424, 26.85238369802633, 27.03270788366595, 26.680550063649804, 24.84845998386541, 24.997961620489747, 24.982457558313996, 29.62737304965654, 29.6808500761787, 29.510576928655297, 24.761132196833685, 24.765131221463278, 24.447359432776764, 19.82616455356279, 20.05517332876721, 19.883622648815305, 20.432892550714314, 20.00033489614725, 20.090687565505505, 19.767263922840357, 19.524070620536804, 19.75732888095081, 23.570477351546288, 23.687435522675514, 24.077592253684998, 15.78086719786127, 15.558285181721047, 15.436541279156998, 22.92611928035815, 22.73228635390599, 23.202063118418053, 24.943627059459686, 25.203892193734646, 25.258641816675663, 23.40220998126702, 23.141064918289572, 23.229732806483895, 14.884061115483433, 15.032721972713858, 14.96197563658157, 23.750253458817795, 23.610368621846035, 24.063988486848146, 25.737106297165155, 25.148356407880783, 25.565739646553993, 26.061341946323708, 25.81007707615693, 25.496720408399895, 35.37743170617614, 35.183530904352665, 35.02703496068716, 26.202296145260334, 26.320193201303482, 25.746239215135574, 25.39373608926931, 25.3541130448381, 25.560177514950425, 19.09465718766053, 19.17737591763337, 18.821477030714348, 28.080400335292012, 27.584823514024407, 28.38322289606245, 26.846643328666687, 26.860518246889114, 26.861759290099144, 24.115360990166664, 24.426671244204044, 24.470498390495777, 21.374644374474883, 21.3911786749959, 21.076467379927635, 26.23100111385186, 26.350051072736576, 26.277861838539437, 19.360828660428524, 19.51547147706151, 19.375489056110382, 28.66940612718463, 28.59349225461483, 28.17224097251892, 27.340280916541815, 26.85650173574686, 26.909564025700092, 26.638745725154877, 26.937081389129162, 27.142220236361027, 21.060635432600975, 21.439008697867393, 21.822739247232676, 21.973943670590714, 21.768726107974842, 21.855588403840855, 28.183561086654663, 28.31083730608225, 27.20719826221466, 26.012263326595217, 26.13100739290772, 25.73481262723604, 17.085182569921017, 17.483095737174153, 17.382093999534845, 28.88032605747381, 29.045886375165225, 28.874137120942265, 21.401642933487892, 21.064943447709084, 21.262359209358692, 21.4762845536073, 21.284430538614586, 21.554613848527268, 23.665474121769265, 23.394841765364006, 23.67111573865016, 26.242425003399447, 25.73737773050864, 25.647027259071663, 22.074455613891274, 21.85906722644964, 21.80533270786205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1427485109823829, "mean_inference_ms": 0.6439413594972409, "mean_action_processing_ms": 0.0946671150811487, "mean_env_wait_ms": 0.799799164643307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 643200, "timesteps_this_iter": 0, "agent_timesteps_total": 1929600, "timers": {"sample_time_ms": 9040.012, "sample_throughput": 530.973, "load_time_ms": 0.1, "load_throughput": 47980598.665, "learn_time_ms": 1169.582, "learn_throughput": 4104.03, "update_time_ms": 1.298}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.735899925231934, "policy_loss": 0.0022648503449615998, "vf_loss": 6.870077967643738, "vf_explained_var": -0.01876235008239746, "kl": 0.011543228523975628, "entropy": 13.748303055763245, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 643200, "num_agent_steps_sampled": 1929600, "num_steps_trained": 643200, "num_agent_steps_trained": 1929600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3073, "training_iteration": 134, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-03-34", "timestamp": 1706148214, "time_this_iter_s": 8.952702045440674, "time_total_s": 1254.3844602108002, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F4D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1254.3844602108002, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 5.6461538461538465, "ram_util_percent": 46.8076923076923}}
{"episode_reward_max": 105.58799757121596, "episode_reward_min": 44.87875872477886, "episode_reward_mean": 73.29706841328945, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.884061115483433}, "policy_reward_max": {"shared_policy": 35.37743170617614}, "policy_reward_mean": {"shared_policy": 24.432356137763144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.76198909804224, 47.718460985692204, 70.60394467413424, 50.86241955310105, 76.84701480343936, 71.99023342877624, 49.97470471938139, 65.18898973986506, 71.48103539645672, 72.45512703247365, 52.37689597159623, 83.95395370246843, 68.06331462971865, 66.55345109850165, 70.1250409334898, 84.85846643554393, 68.50914890458806, 76.6307740882039, 75.09613163769244, 68.82729966565967, 69.33910711482167, 66.1995745366439, 56.465073220431805, 87.11917534843087, 61.416920293122516, 90.06393161462618, 77.09203867241739, 64.20544700324535, 100.0757743641734, 79.11378471925853, 64.24331671744585, 81.00514730811116, 58.73090344667432, 88.43902634829281, 90.31150528043507, 68.06388203799722, 70.5233807340264, 81.83282072283326, 83.98480359092355, 78.7581577571109, 96.31614798307417, 81.48240107065064, 79.06041301414369, 70.43314910936166, 80.56564164534208, 74.82887916266915, 88.81880005449054, 73.97362285107373, 59.764960531145306, 60.52391501236707, 59.04866342432797, 71.3355051279068, 46.775693658739314, 68.8604687526822, 75.40616106987, 69.77300770604049, 44.87875872477886, 71.42461056751198, 76.45120235159993, 77.36813943088053, 105.58799757121596, 78.26872856169939, 76.30802664905784, 57.09351013600825, 84.04844674537887, 80.56892086565495, 73.01253062486649, 63.84229042939842, 78.85891402512787, 58.251789193600416, 85.43513935431838, 81.10634667798877, 80.71804735064507, 64.32238337770104, 65.59825818240641, 83.70159665495157, 77.87808334673898, 51.950372306630015, 86.8003495535813, 63.72894559055567, 64.31532894074915, 70.73143162578343, 77.62682999297975, 65.73885554820296, 68.08991325553507, 70.4310093820095, 89.11707916855812, 64.48693875875323, 77.37007880955932, 71.71000643027946, 65.30676487181334, 72.55001151189208, 92.71404406800866, 76.72430199012157, 79.57452180236575, 86.22304809093472, 78.63203501887617, 94.98568990081546, 89.42946976982054, 68.91649661585686], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.709250902136162, 23.888126788039997, 24.164611407866076, 16.197505338660747, 15.741655831535653, 15.779299815495804, 23.53648480524619, 23.49574141701062, 23.57171845187743, 16.87305351843436, 17.074819711347416, 16.91454632331927, 25.76565809672077, 25.53202936549981, 25.549327341218785, 23.96412772188583, 24.19155606130758, 23.834549645582825, 16.715889223230377, 16.764012785240382, 16.494802710910633, 21.93927351012826, 21.671220488846302, 21.578495740890503, 23.608990103006363, 23.939316399395466, 23.93272889405489, 24.32943941342333, 24.14923984805742, 23.976447770992905, 17.629343201716736, 17.113075261314705, 17.634477508564785, 27.855716418474913, 27.95508086308837, 28.143156420905143, 22.74932881755133, 22.7280482177933, 22.585937594374016, 22.167042436699063, 21.901520023743302, 22.48488863805929, 23.205622248351574, 23.472882732748985, 23.44653595238924, 28.53708604258523, 28.079637760917336, 28.241742632041365, 22.45486094554265, 22.89741751675804, 23.15687044228737, 25.234220519661903, 25.541762605309486, 25.854790963232517, 24.991312262912587, 25.085824144383267, 25.018995230396584, 22.407494008541107, 23.083813421428204, 23.335992235690355, 22.672628924250603, 23.577445592731237, 23.089032597839832, 21.99413290123144, 21.851573492089898, 22.353868143322558, 18.903248481452465, 18.81701471656561, 18.74481002241373, 29.08150839433074, 29.029297780245543, 29.00836917385459, 20.739870623995856, 20.490470615526036, 20.186579053600624, 29.710149136682347, 30.181969201968357, 30.17181327597548, 25.81562078868349, 25.61612182607253, 25.66029605766137, 21.392249122262, 21.354922905564308, 21.458274975419044, 33.38068569203217, 33.31503952046235, 33.380049151678875, 26.260772561033562, 26.107112010320023, 26.745900147904948, 21.625825375318527, 21.228973291814327, 21.388518050312996, 27.118973987797887, 26.909470851222665, 26.97670246909061, 19.408839503924042, 19.58710805575052, 19.734955886999757, 29.302198832233742, 29.419910853107766, 29.716916662951306, 29.977227141459778, 30.185088132818535, 30.149190006156758, 22.291130463282258, 22.751701364914567, 23.021050209800393, 23.22900704542795, 23.607190060118825, 23.68718362847963, 27.549400213484958, 26.930043404301003, 27.3533771050473, 28.209984723478556, 27.61152397096157, 28.16329489648342, 26.378260203637183, 26.19667273014784, 26.183224823325872, 32.297471319635704, 32.30244167645772, 31.71623498698075, 26.926045725742966, 27.28258965133378, 27.273765693573893, 26.16979670276244, 26.454082900037363, 26.436533411343888, 23.472414620841533, 23.592770292811707, 23.367964195708424, 26.85238369802633, 27.03270788366595, 26.680550063649804, 24.84845998386541, 24.997961620489747, 24.982457558313996, 29.62737304965654, 29.6808500761787, 29.510576928655297, 24.761132196833685, 24.765131221463278, 24.447359432776764, 19.82616455356279, 20.05517332876721, 19.883622648815305, 20.432892550714314, 20.00033489614725, 20.090687565505505, 19.767263922840357, 19.524070620536804, 19.75732888095081, 23.570477351546288, 23.687435522675514, 24.077592253684998, 15.78086719786127, 15.558285181721047, 15.436541279156998, 22.92611928035815, 22.73228635390599, 23.202063118418053, 24.943627059459686, 25.203892193734646, 25.258641816675663, 23.40220998126702, 23.141064918289572, 23.229732806483895, 14.884061115483433, 15.032721972713858, 14.96197563658157, 23.750253458817795, 23.610368621846035, 24.063988486848146, 25.737106297165155, 25.148356407880783, 25.565739646553993, 26.061341946323708, 25.81007707615693, 25.496720408399895, 35.37743170617614, 35.183530904352665, 35.02703496068716, 26.202296145260334, 26.320193201303482, 25.746239215135574, 25.39373608926931, 25.3541130448381, 25.560177514950425, 19.09465718766053, 19.17737591763337, 18.821477030714348, 28.080400335292012, 27.584823514024407, 28.38322289606245, 26.846643328666687, 26.860518246889114, 26.861759290099144, 24.115360990166664, 24.426671244204044, 24.470498390495777, 21.374644374474883, 21.3911786749959, 21.076467379927635, 26.23100111385186, 26.350051072736576, 26.277861838539437, 19.360828660428524, 19.51547147706151, 19.375489056110382, 28.66940612718463, 28.59349225461483, 28.17224097251892, 27.340280916541815, 26.85650173574686, 26.909564025700092, 26.638745725154877, 26.937081389129162, 27.142220236361027, 21.060635432600975, 21.439008697867393, 21.822739247232676, 21.973943670590714, 21.768726107974842, 21.855588403840855, 28.183561086654663, 28.31083730608225, 27.20719826221466, 26.012263326595217, 26.13100739290772, 25.73481262723604, 17.085182569921017, 17.483095737174153, 17.382093999534845, 28.88032605747381, 29.045886375165225, 28.874137120942265, 21.401642933487892, 21.064943447709084, 21.262359209358692, 21.4762845536073, 21.284430538614586, 21.554613848527268, 23.665474121769265, 23.394841765364006, 23.67111573865016, 26.242425003399447, 25.73737773050864, 25.647027259071663, 22.074455613891274, 21.85906722644964, 21.80533270786205, 22.789494171738625, 22.821226990781724, 22.479192093014717, 23.668659031391144, 23.36727626621723, 23.39507408440113, 30.02781420201063, 29.447178423404694, 29.642086543142796, 21.708581459087625, 21.381933984657124, 21.396423315008477, 25.70892273883024, 25.51463722685972, 26.14651884386936, 24.01733550429344, 23.61486255377531, 24.07780837221071, 21.584778306384877, 21.675227237244442, 22.046759328184024, 24.466231357306242, 24.097109645605087, 23.98667050898075, 31.10517441853881, 30.979449726641178, 30.629419922828674, 25.72420848036805, 25.694236377875, 25.305857131878525, 26.438976707557828, 26.344883585969598, 26.790661508838326, 28.752793076137692, 28.655215765039117, 28.815039249757916, 26.013534794251115, 26.57713877844313, 26.041361446181924, 31.832108723620564, 31.317042673627526, 31.83653850356737, 29.88689164320627, 29.323718498150498, 30.218859628463775, 23.18178645024696, 23.587015538165957, 22.14769462744394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1426977295524687, "mean_inference_ms": 0.6438019872475236, "mean_action_processing_ms": 0.09465909414904793, "mean_env_wait_ms": 0.799493962095712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 648000, "timesteps_this_iter": 0, "agent_timesteps_total": 1944000, "timers": {"sample_time_ms": 9044.869, "sample_throughput": 530.688, "load_time_ms": 0.1, "load_throughput": 47980598.665, "learn_time_ms": 1168.383, "learn_throughput": 4108.243, "update_time_ms": 1.398}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.841983675956726, "policy_loss": 0.0012048577427696827, "vf_loss": 6.97722327709198, "vf_explained_var": -0.02259981632232666, "kl": 0.01430899568385067, "entropy": 13.773345470428467, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 648000, "num_agent_steps_sampled": 1944000, "num_steps_trained": 648000, "num_agent_steps_trained": 1944000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3089, "training_iteration": 135, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-03-43", "timestamp": 1706148223, "time_this_iter_s": 9.005358457565308, "time_total_s": 1263.3898186683655, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BFD280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1263.3898186683655, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 5.561538461538461, "ram_util_percent": 46.93076923076922}}
{"episode_reward_max": 112.81593937426803, "episode_reward_min": 44.87875872477886, "episode_reward_mean": 74.66927281588295, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.884061115483433}, "policy_reward_max": {"shared_policy": 37.81226484725872}, "policy_reward_mean": {"shared_policy": 24.88975760529431}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.50914890458806, 76.6307740882039, 75.09613163769244, 68.82729966565967, 69.33910711482167, 66.1995745366439, 56.465073220431805, 87.11917534843087, 61.416920293122516, 90.06393161462618, 77.09203867241739, 64.20544700324535, 100.0757743641734, 79.11378471925853, 64.24331671744585, 81.00514730811116, 58.73090344667432, 88.43902634829281, 90.31150528043507, 68.06388203799722, 70.5233807340264, 81.83282072283326, 83.98480359092355, 78.7581577571109, 96.31614798307417, 81.48240107065064, 79.06041301414369, 70.43314910936166, 80.56564164534208, 74.82887916266915, 88.81880005449054, 73.97362285107373, 59.764960531145306, 60.52391501236707, 59.04866342432797, 71.3355051279068, 46.775693658739314, 68.8604687526822, 75.40616106987, 69.77300770604049, 44.87875872477886, 71.42461056751198, 76.45120235159993, 77.36813943088053, 105.58799757121596, 78.26872856169939, 76.30802664905784, 57.09351013600825, 84.04844674537887, 80.56892086565495, 73.01253062486649, 63.84229042939842, 78.85891402512787, 58.251789193600416, 85.43513935431838, 81.10634667798877, 80.71804735064507, 64.32238337770104, 65.59825818240641, 83.70159665495157, 77.87808334673898, 51.950372306630015, 86.8003495535813, 63.72894559055567, 64.31532894074915, 70.73143162578343, 77.62682999297975, 65.73885554820296, 68.08991325553507, 70.4310093820095, 89.11707916855812, 64.48693875875323, 77.37007880955932, 71.71000643027946, 65.30676487181334, 72.55001151189208, 92.71404406800866, 76.72430199012157, 79.57452180236575, 86.22304809093472, 78.63203501887617, 94.98568990081546, 89.42946976982054, 68.91649661585686, 84.47378316335379, 86.06583461165425, 75.44728083536029, 73.96114078816024, 59.28001141548154, 84.11237246543168, 66.61750274896619, 72.32689048349854, 112.81593937426803, 85.62769057787952, 65.99130330234766, 48.328758422285304, 96.23031212389469, 64.83956421725452, 60.468397580087185, 75.44870035210623], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.45486094554265, 22.89741751675804, 23.15687044228737, 25.234220519661903, 25.541762605309486, 25.854790963232517, 24.991312262912587, 25.085824144383267, 25.018995230396584, 22.407494008541107, 23.083813421428204, 23.335992235690355, 22.672628924250603, 23.577445592731237, 23.089032597839832, 21.99413290123144, 21.851573492089898, 22.353868143322558, 18.903248481452465, 18.81701471656561, 18.74481002241373, 29.08150839433074, 29.029297780245543, 29.00836917385459, 20.739870623995856, 20.490470615526036, 20.186579053600624, 29.710149136682347, 30.181969201968357, 30.17181327597548, 25.81562078868349, 25.61612182607253, 25.66029605766137, 21.392249122262, 21.354922905564308, 21.458274975419044, 33.38068569203217, 33.31503952046235, 33.380049151678875, 26.260772561033562, 26.107112010320023, 26.745900147904948, 21.625825375318527, 21.228973291814327, 21.388518050312996, 27.118973987797887, 26.909470851222665, 26.97670246909061, 19.408839503924042, 19.58710805575052, 19.734955886999757, 29.302198832233742, 29.419910853107766, 29.716916662951306, 29.977227141459778, 30.185088132818535, 30.149190006156758, 22.291130463282258, 22.751701364914567, 23.021050209800393, 23.22900704542795, 23.607190060118825, 23.68718362847963, 27.549400213484958, 26.930043404301003, 27.3533771050473, 28.209984723478556, 27.61152397096157, 28.16329489648342, 26.378260203637183, 26.19667273014784, 26.183224823325872, 32.297471319635704, 32.30244167645772, 31.71623498698075, 26.926045725742966, 27.28258965133378, 27.273765693573893, 26.16979670276244, 26.454082900037363, 26.436533411343888, 23.472414620841533, 23.592770292811707, 23.367964195708424, 26.85238369802633, 27.03270788366595, 26.680550063649804, 24.84845998386541, 24.997961620489747, 24.982457558313996, 29.62737304965654, 29.6808500761787, 29.510576928655297, 24.761132196833685, 24.765131221463278, 24.447359432776764, 19.82616455356279, 20.05517332876721, 19.883622648815305, 20.432892550714314, 20.00033489614725, 20.090687565505505, 19.767263922840357, 19.524070620536804, 19.75732888095081, 23.570477351546288, 23.687435522675514, 24.077592253684998, 15.78086719786127, 15.558285181721047, 15.436541279156998, 22.92611928035815, 22.73228635390599, 23.202063118418053, 24.943627059459686, 25.203892193734646, 25.258641816675663, 23.40220998126702, 23.141064918289572, 23.229732806483895, 14.884061115483433, 15.032721972713858, 14.96197563658157, 23.750253458817795, 23.610368621846035, 24.063988486848146, 25.737106297165155, 25.148356407880783, 25.565739646553993, 26.061341946323708, 25.81007707615693, 25.496720408399895, 35.37743170617614, 35.183530904352665, 35.02703496068716, 26.202296145260334, 26.320193201303482, 25.746239215135574, 25.39373608926931, 25.3541130448381, 25.560177514950425, 19.09465718766053, 19.17737591763337, 18.821477030714348, 28.080400335292012, 27.584823514024407, 28.38322289606245, 26.846643328666687, 26.860518246889114, 26.861759290099144, 24.115360990166664, 24.426671244204044, 24.470498390495777, 21.374644374474883, 21.3911786749959, 21.076467379927635, 26.23100111385186, 26.350051072736576, 26.277861838539437, 19.360828660428524, 19.51547147706151, 19.375489056110382, 28.66940612718463, 28.59349225461483, 28.17224097251892, 27.340280916541815, 26.85650173574686, 26.909564025700092, 26.638745725154877, 26.937081389129162, 27.142220236361027, 21.060635432600975, 21.439008697867393, 21.822739247232676, 21.973943670590714, 21.768726107974842, 21.855588403840855, 28.183561086654663, 28.31083730608225, 27.20719826221466, 26.012263326595217, 26.13100739290772, 25.73481262723604, 17.085182569921017, 17.483095737174153, 17.382093999534845, 28.88032605747381, 29.045886375165225, 28.874137120942265, 21.401642933487892, 21.064943447709084, 21.262359209358692, 21.4762845536073, 21.284430538614586, 21.554613848527268, 23.665474121769265, 23.394841765364006, 23.67111573865016, 26.242425003399447, 25.73737773050864, 25.647027259071663, 22.074455613891274, 21.85906722644964, 21.80533270786205, 22.789494171738625, 22.821226990781724, 22.479192093014717, 23.668659031391144, 23.36727626621723, 23.39507408440113, 30.02781420201063, 29.447178423404694, 29.642086543142796, 21.708581459087625, 21.381933984657124, 21.396423315008477, 25.70892273883024, 25.51463722685972, 26.14651884386936, 24.01733550429344, 23.61486255377531, 24.07780837221071, 21.584778306384877, 21.675227237244442, 22.046759328184024, 24.466231357306242, 24.097109645605087, 23.98667050898075, 31.10517441853881, 30.979449726641178, 30.629419922828674, 25.72420848036805, 25.694236377875, 25.305857131878525, 26.438976707557828, 26.344883585969598, 26.790661508838326, 28.752793076137692, 28.655215765039117, 28.815039249757916, 26.013534794251115, 26.57713877844313, 26.041361446181924, 31.832108723620564, 31.317042673627526, 31.83653850356737, 29.88689164320627, 29.323718498150498, 30.218859628463775, 23.18178645024696, 23.587015538165957, 22.14769462744394, 28.542048606400684, 28.282538150747612, 27.64919640620549, 28.407048160831124, 28.839768680433423, 28.819017770389706, 25.124743543565273, 25.32684376463294, 24.995693527162075, 24.810825308474392, 24.534699923048407, 24.615615556637437, 19.641275661687047, 19.93630341688791, 19.702432336906583, 28.058734868963555, 28.02679132421811, 28.026846272250012, 22.495912770430238, 22.16941014925638, 21.952179829279572, 24.194266657034547, 23.904309617976338, 24.22831420848766, 37.81226484725872, 37.773686374227196, 37.22998815278211, 28.613899553815514, 28.070488924781472, 28.943302099282533, 21.97912260144949, 22.37418080866337, 21.637999892234802, 16.089824226995304, 16.0798657250901, 16.159068470199898, 32.34096963703632, 32.05356468260288, 31.835777804255486, 21.53321612626314, 21.77434659563005, 21.532001495361328, 20.12546768784523, 20.329320974648, 20.013608917593956, 24.934456196924046, 25.03090288241704, 25.483341272765145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14264799718261797, "mean_inference_ms": 0.6436439151242139, "mean_action_processing_ms": 0.09465660296334125, "mean_env_wait_ms": 0.7991951276656495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 652800, "timesteps_this_iter": 0, "agent_timesteps_total": 1958400, "timers": {"sample_time_ms": 9025.031, "sample_throughput": 531.854, "load_time_ms": 0.1, "load_throughput": 47980598.665, "learn_time_ms": 1168.082, "learn_throughput": 4109.302, "update_time_ms": 1.498}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 7.762593507766724, "policy_loss": 0.0020214170044184493, "vf_loss": 7.897235929965973, "vf_explained_var": -0.02154669165611267, "kl": 0.014593057451010775, "entropy": 13.79788327217102, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 652800, "num_agent_steps_sampled": 1958400, "num_steps_trained": 652800, "num_agent_steps_trained": 1958400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3105, "training_iteration": 136, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-03-52", "timestamp": 1706148232, "time_this_iter_s": 8.861704111099243, "time_total_s": 1272.2515227794647, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000466A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1272.2515227794647, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 6.8500000000000005, "ram_util_percent": 46.86666666666667}}
{"episode_reward_max": 112.81593937426803, "episode_reward_min": 44.87875872477886, "episode_reward_mean": 74.51160909128936, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.884061115483433}, "policy_reward_max": {"shared_policy": 37.81226484725872}, "policy_reward_mean": {"shared_policy": 24.83720303042978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.73090344667432, 88.43902634829281, 90.31150528043507, 68.06388203799722, 70.5233807340264, 81.83282072283326, 83.98480359092355, 78.7581577571109, 96.31614798307417, 81.48240107065064, 79.06041301414369, 70.43314910936166, 80.56564164534208, 74.82887916266915, 88.81880005449054, 73.97362285107373, 59.764960531145306, 60.52391501236707, 59.04866342432797, 71.3355051279068, 46.775693658739314, 68.8604687526822, 75.40616106987, 69.77300770604049, 44.87875872477886, 71.42461056751198, 76.45120235159993, 77.36813943088053, 105.58799757121596, 78.26872856169939, 76.30802664905784, 57.09351013600825, 84.04844674537887, 80.56892086565495, 73.01253062486649, 63.84229042939842, 78.85891402512787, 58.251789193600416, 85.43513935431838, 81.10634667798877, 80.71804735064507, 64.32238337770104, 65.59825818240641, 83.70159665495157, 77.87808334673898, 51.950372306630015, 86.8003495535813, 63.72894559055567, 64.31532894074915, 70.73143162578343, 77.62682999297975, 65.73885554820296, 68.08991325553507, 70.4310093820095, 89.11707916855812, 64.48693875875323, 77.37007880955932, 71.71000643027946, 65.30676487181334, 72.55001151189208, 92.71404406800866, 76.72430199012157, 79.57452180236575, 86.22304809093472, 78.63203501887617, 94.98568990081546, 89.42946976982054, 68.91649661585686, 84.47378316335379, 86.06583461165425, 75.44728083536029, 73.96114078816024, 59.28001141548154, 84.11237246543168, 66.61750274896619, 72.32689048349854, 112.81593937426803, 85.62769057787952, 65.99130330234766, 48.328758422285304, 96.23031212389469, 64.83956421725452, 60.468397580087185, 75.44870035210623, 68.15420470386742, 70.01740891579537, 65.80061973631379, 80.17568141967058, 83.90968765504655, 62.23905032873151, 58.21076608449221, 69.20316958613694, 64.64681299775837, 105.2250654892996, 73.9542169747874, 72.70169205218554, 70.98109108954665, 72.20318442676216, 68.77793793438465, 83.43568335473537], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.408839503924042, 19.58710805575052, 19.734955886999757, 29.302198832233742, 29.419910853107766, 29.716916662951306, 29.977227141459778, 30.185088132818535, 30.149190006156758, 22.291130463282258, 22.751701364914567, 23.021050209800393, 23.22900704542795, 23.607190060118825, 23.68718362847963, 27.549400213484958, 26.930043404301003, 27.3533771050473, 28.209984723478556, 27.61152397096157, 28.16329489648342, 26.378260203637183, 26.19667273014784, 26.183224823325872, 32.297471319635704, 32.30244167645772, 31.71623498698075, 26.926045725742966, 27.28258965133378, 27.273765693573893, 26.16979670276244, 26.454082900037363, 26.436533411343888, 23.472414620841533, 23.592770292811707, 23.367964195708424, 26.85238369802633, 27.03270788366595, 26.680550063649804, 24.84845998386541, 24.997961620489747, 24.982457558313996, 29.62737304965654, 29.6808500761787, 29.510576928655297, 24.761132196833685, 24.765131221463278, 24.447359432776764, 19.82616455356279, 20.05517332876721, 19.883622648815305, 20.432892550714314, 20.00033489614725, 20.090687565505505, 19.767263922840357, 19.524070620536804, 19.75732888095081, 23.570477351546288, 23.687435522675514, 24.077592253684998, 15.78086719786127, 15.558285181721047, 15.436541279156998, 22.92611928035815, 22.73228635390599, 23.202063118418053, 24.943627059459686, 25.203892193734646, 25.258641816675663, 23.40220998126702, 23.141064918289572, 23.229732806483895, 14.884061115483433, 15.032721972713858, 14.96197563658157, 23.750253458817795, 23.610368621846035, 24.063988486848146, 25.737106297165155, 25.148356407880783, 25.565739646553993, 26.061341946323708, 25.81007707615693, 25.496720408399895, 35.37743170617614, 35.183530904352665, 35.02703496068716, 26.202296145260334, 26.320193201303482, 25.746239215135574, 25.39373608926931, 25.3541130448381, 25.560177514950425, 19.09465718766053, 19.17737591763337, 18.821477030714348, 28.080400335292012, 27.584823514024407, 28.38322289606245, 26.846643328666687, 26.860518246889114, 26.861759290099144, 24.115360990166664, 24.426671244204044, 24.470498390495777, 21.374644374474883, 21.3911786749959, 21.076467379927635, 26.23100111385186, 26.350051072736576, 26.277861838539437, 19.360828660428524, 19.51547147706151, 19.375489056110382, 28.66940612718463, 28.59349225461483, 28.17224097251892, 27.340280916541815, 26.85650173574686, 26.909564025700092, 26.638745725154877, 26.937081389129162, 27.142220236361027, 21.060635432600975, 21.439008697867393, 21.822739247232676, 21.973943670590714, 21.768726107974842, 21.855588403840855, 28.183561086654663, 28.31083730608225, 27.20719826221466, 26.012263326595217, 26.13100739290772, 25.73481262723604, 17.085182569921017, 17.483095737174153, 17.382093999534845, 28.88032605747381, 29.045886375165225, 28.874137120942265, 21.401642933487892, 21.064943447709084, 21.262359209358692, 21.4762845536073, 21.284430538614586, 21.554613848527268, 23.665474121769265, 23.394841765364006, 23.67111573865016, 26.242425003399447, 25.73737773050864, 25.647027259071663, 22.074455613891274, 21.85906722644964, 21.80533270786205, 22.789494171738625, 22.821226990781724, 22.479192093014717, 23.668659031391144, 23.36727626621723, 23.39507408440113, 30.02781420201063, 29.447178423404694, 29.642086543142796, 21.708581459087625, 21.381933984657124, 21.396423315008477, 25.70892273883024, 25.51463722685972, 26.14651884386936, 24.01733550429344, 23.61486255377531, 24.07780837221071, 21.584778306384877, 21.675227237244442, 22.046759328184024, 24.466231357306242, 24.097109645605087, 23.98667050898075, 31.10517441853881, 30.979449726641178, 30.629419922828674, 25.72420848036805, 25.694236377875, 25.305857131878525, 26.438976707557828, 26.344883585969598, 26.790661508838326, 28.752793076137692, 28.655215765039117, 28.815039249757916, 26.013534794251115, 26.57713877844313, 26.041361446181924, 31.832108723620564, 31.317042673627526, 31.83653850356737, 29.88689164320627, 29.323718498150498, 30.218859628463775, 23.18178645024696, 23.587015538165957, 22.14769462744394, 28.542048606400684, 28.282538150747612, 27.64919640620549, 28.407048160831124, 28.839768680433423, 28.819017770389706, 25.124743543565273, 25.32684376463294, 24.995693527162075, 24.810825308474392, 24.534699923048407, 24.615615556637437, 19.641275661687047, 19.93630341688791, 19.702432336906583, 28.058734868963555, 28.02679132421811, 28.026846272250012, 22.495912770430238, 22.16941014925638, 21.952179829279572, 24.194266657034547, 23.904309617976338, 24.22831420848766, 37.81226484725872, 37.773686374227196, 37.22998815278211, 28.613899553815514, 28.070488924781472, 28.943302099282533, 21.97912260144949, 22.37418080866337, 21.637999892234802, 16.089824226995304, 16.0798657250901, 16.159068470199898, 32.34096963703632, 32.05356468260288, 31.835777804255486, 21.53321612626314, 21.77434659563005, 21.532001495361328, 20.12546768784523, 20.329320974648, 20.013608917593956, 24.934456196924046, 25.03090288241704, 25.483341272765145, 22.708889727791146, 22.749653437485293, 22.695661538590983, 23.39671326366563, 23.252866887797907, 23.367828764331833, 21.885121556619794, 21.899755316476018, 22.01574286321798, 26.703093104064465, 26.787317261099815, 26.685271054506302, 27.884058165053517, 27.799390176932008, 28.22623931306103, 20.79572371641794, 20.616006920735032, 20.827319691578538, 19.467883747071028, 19.50561311468482, 19.23726922273636, 22.969859816133976, 23.20671829022467, 23.02659147977829, 21.54587337871392, 21.600633208950356, 21.500306410094097, 35.17349672317505, 34.76705078780651, 35.284517978318036, 24.467007999618843, 25.136776186836258, 24.3504327883323, 24.291989844292402, 23.968976348638535, 24.4407258592546, 23.63485777626434, 23.878817091385514, 23.467416221896798, 24.25872834865004, 23.922920934855938, 24.021535143256187, 22.848193163673074, 22.90908965530494, 23.02065511540664, 27.547379568219185, 27.992373503744602, 27.895930282771587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14259697411732858, "mean_inference_ms": 0.6434881293546206, "mean_action_processing_ms": 0.09464776617527455, "mean_env_wait_ms": 0.79890713098862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 657600, "timesteps_this_iter": 0, "agent_timesteps_total": 1972800, "timers": {"sample_time_ms": 8988.575, "sample_throughput": 534.011, "load_time_ms": 0.2, "load_throughput": 24001739.628, "learn_time_ms": 1168.688, "learn_throughput": 4107.169, "update_time_ms": 1.598}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.32304584980011, "policy_loss": 0.0003647639544861747, "vf_loss": 5.460925042629242, "vf_explained_var": -0.01586093008518219, "kl": 0.01070602569979695, "entropy": 13.92084789276123, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 657600, "num_agent_steps_sampled": 1972800, "num_steps_trained": 657600, "num_agent_steps_trained": 1972800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3121, "training_iteration": 137, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-04-01", "timestamp": 1706148241, "time_this_iter_s": 8.954362869262695, "time_total_s": 1281.2058856487274, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1281.2058856487274, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 7.130769230769231, "ram_util_percent": 46.9076923076923}}
{"episode_reward_max": 112.81593937426803, "episode_reward_min": 44.87875872477886, "episode_reward_mean": 73.7123816079813, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.884061115483433}, "policy_reward_max": {"shared_policy": 37.81226484725872}, "policy_reward_mean": {"shared_policy": 24.570793869327094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.764960531145306, 60.52391501236707, 59.04866342432797, 71.3355051279068, 46.775693658739314, 68.8604687526822, 75.40616106987, 69.77300770604049, 44.87875872477886, 71.42461056751198, 76.45120235159993, 77.36813943088053, 105.58799757121596, 78.26872856169939, 76.30802664905784, 57.09351013600825, 84.04844674537887, 80.56892086565495, 73.01253062486649, 63.84229042939842, 78.85891402512787, 58.251789193600416, 85.43513935431838, 81.10634667798877, 80.71804735064507, 64.32238337770104, 65.59825818240641, 83.70159665495157, 77.87808334673898, 51.950372306630015, 86.8003495535813, 63.72894559055567, 64.31532894074915, 70.73143162578343, 77.62682999297975, 65.73885554820296, 68.08991325553507, 70.4310093820095, 89.11707916855812, 64.48693875875323, 77.37007880955932, 71.71000643027946, 65.30676487181334, 72.55001151189208, 92.71404406800866, 76.72430199012157, 79.57452180236575, 86.22304809093472, 78.63203501887617, 94.98568990081546, 89.42946976982054, 68.91649661585686, 84.47378316335379, 86.06583461165425, 75.44728083536029, 73.96114078816024, 59.28001141548154, 84.11237246543168, 66.61750274896619, 72.32689048349854, 112.81593937426803, 85.62769057787952, 65.99130330234766, 48.328758422285304, 96.23031212389469, 64.83956421725452, 60.468397580087185, 75.44870035210623, 68.15420470386742, 70.01740891579537, 65.80061973631379, 80.17568141967058, 83.90968765504655, 62.23905032873151, 58.21076608449221, 69.20316958613694, 64.64681299775837, 105.2250654892996, 73.9542169747874, 72.70169205218554, 70.98109108954665, 72.20318442676216, 68.77793793438465, 83.43568335473537, 81.46641795733011, 61.383327191637335, 92.15261380374432, 69.16388033330439, 56.97271297744007, 62.316132833366254, 62.72608930245039, 72.7828845158219, 81.74520387314257, 84.33090579509732, 97.32831002771852, 73.37359867803752, 74.34409156162289, 72.00783988833426, 77.74348838068543, 66.36328935856], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.82616455356279, 20.05517332876721, 19.883622648815305, 20.432892550714314, 20.00033489614725, 20.090687565505505, 19.767263922840357, 19.524070620536804, 19.75732888095081, 23.570477351546288, 23.687435522675514, 24.077592253684998, 15.78086719786127, 15.558285181721047, 15.436541279156998, 22.92611928035815, 22.73228635390599, 23.202063118418053, 24.943627059459686, 25.203892193734646, 25.258641816675663, 23.40220998126702, 23.141064918289572, 23.229732806483895, 14.884061115483433, 15.032721972713858, 14.96197563658157, 23.750253458817795, 23.610368621846035, 24.063988486848146, 25.737106297165155, 25.148356407880783, 25.565739646553993, 26.061341946323708, 25.81007707615693, 25.496720408399895, 35.37743170617614, 35.183530904352665, 35.02703496068716, 26.202296145260334, 26.320193201303482, 25.746239215135574, 25.39373608926931, 25.3541130448381, 25.560177514950425, 19.09465718766053, 19.17737591763337, 18.821477030714348, 28.080400335292012, 27.584823514024407, 28.38322289606245, 26.846643328666687, 26.860518246889114, 26.861759290099144, 24.115360990166664, 24.426671244204044, 24.470498390495777, 21.374644374474883, 21.3911786749959, 21.076467379927635, 26.23100111385186, 26.350051072736576, 26.277861838539437, 19.360828660428524, 19.51547147706151, 19.375489056110382, 28.66940612718463, 28.59349225461483, 28.17224097251892, 27.340280916541815, 26.85650173574686, 26.909564025700092, 26.638745725154877, 26.937081389129162, 27.142220236361027, 21.060635432600975, 21.439008697867393, 21.822739247232676, 21.973943670590714, 21.768726107974842, 21.855588403840855, 28.183561086654663, 28.31083730608225, 27.20719826221466, 26.012263326595217, 26.13100739290772, 25.73481262723604, 17.085182569921017, 17.483095737174153, 17.382093999534845, 28.88032605747381, 29.045886375165225, 28.874137120942265, 21.401642933487892, 21.064943447709084, 21.262359209358692, 21.4762845536073, 21.284430538614586, 21.554613848527268, 23.665474121769265, 23.394841765364006, 23.67111573865016, 26.242425003399447, 25.73737773050864, 25.647027259071663, 22.074455613891274, 21.85906722644964, 21.80533270786205, 22.789494171738625, 22.821226990781724, 22.479192093014717, 23.668659031391144, 23.36727626621723, 23.39507408440113, 30.02781420201063, 29.447178423404694, 29.642086543142796, 21.708581459087625, 21.381933984657124, 21.396423315008477, 25.70892273883024, 25.51463722685972, 26.14651884386936, 24.01733550429344, 23.61486255377531, 24.07780837221071, 21.584778306384877, 21.675227237244442, 22.046759328184024, 24.466231357306242, 24.097109645605087, 23.98667050898075, 31.10517441853881, 30.979449726641178, 30.629419922828674, 25.72420848036805, 25.694236377875, 25.305857131878525, 26.438976707557828, 26.344883585969598, 26.790661508838326, 28.752793076137692, 28.655215765039117, 28.815039249757916, 26.013534794251115, 26.57713877844313, 26.041361446181924, 31.832108723620564, 31.317042673627526, 31.83653850356737, 29.88689164320627, 29.323718498150498, 30.218859628463775, 23.18178645024696, 23.587015538165957, 22.14769462744394, 28.542048606400684, 28.282538150747612, 27.64919640620549, 28.407048160831124, 28.839768680433423, 28.819017770389706, 25.124743543565273, 25.32684376463294, 24.995693527162075, 24.810825308474392, 24.534699923048407, 24.615615556637437, 19.641275661687047, 19.93630341688791, 19.702432336906583, 28.058734868963555, 28.02679132421811, 28.026846272250012, 22.495912770430238, 22.16941014925638, 21.952179829279572, 24.194266657034547, 23.904309617976338, 24.22831420848766, 37.81226484725872, 37.773686374227196, 37.22998815278211, 28.613899553815514, 28.070488924781472, 28.943302099282533, 21.97912260144949, 22.37418080866337, 21.637999892234802, 16.089824226995304, 16.0798657250901, 16.159068470199898, 32.34096963703632, 32.05356468260288, 31.835777804255486, 21.53321612626314, 21.77434659563005, 21.532001495361328, 20.12546768784523, 20.329320974648, 20.013608917593956, 24.934456196924046, 25.03090288241704, 25.483341272765145, 22.708889727791146, 22.749653437485293, 22.695661538590983, 23.39671326366563, 23.252866887797907, 23.367828764331833, 21.885121556619794, 21.899755316476018, 22.01574286321798, 26.703093104064465, 26.787317261099815, 26.685271054506302, 27.884058165053517, 27.799390176932008, 28.22623931306103, 20.79572371641794, 20.616006920735032, 20.827319691578538, 19.467883747071028, 19.50561311468482, 19.23726922273636, 22.969859816133976, 23.20671829022467, 23.02659147977829, 21.54587337871392, 21.600633208950356, 21.500306410094097, 35.17349672317505, 34.76705078780651, 35.284517978318036, 24.467007999618843, 25.136776186836258, 24.3504327883323, 24.291989844292402, 23.968976348638535, 24.4407258592546, 23.63485777626434, 23.878817091385514, 23.467416221896798, 24.25872834865004, 23.922920934855938, 24.021535143256187, 22.848193163673074, 22.90908965530494, 23.02065511540664, 27.547379568219185, 27.992373503744602, 27.895930282771587, 26.929530320068196, 27.292038278266162, 27.24484935899575, 20.39258891592422, 20.967292361524102, 20.02344591418901, 30.757565781474113, 30.510268196463585, 30.884779825806618, 22.523324881990746, 23.435778376956776, 23.20477707435687, 19.023765639091522, 18.874817645798117, 19.07412969255043, 20.932860661220417, 20.446597958604485, 20.93667421354135, 21.162508993099124, 20.76672452191511, 20.796855787436158, 24.15171509484449, 24.307281168798596, 24.32388825217882, 27.326098817090184, 27.68558917256692, 26.733515883485467, 27.851017306248337, 28.379790636400372, 28.100097852448613, 32.46173361192146, 32.34432680408159, 32.522249611715466, 24.20333558320999, 24.48760712146759, 24.682655973359942, 25.005565710055322, 24.633274013797433, 24.705251837770135, 24.12585752209027, 24.288905431826905, 23.593076934417084, 26.1449232318749, 25.556650226314858, 26.04191492249568, 21.837000027298927, 22.413133720401675, 22.113155610859394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.142538850249006, "mean_inference_ms": 0.6433432077257192, "mean_action_processing_ms": 0.09463538254300378, "mean_env_wait_ms": 0.7986445701356902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 662400, "timesteps_this_iter": 0, "agent_timesteps_total": 1987200, "timers": {"sample_time_ms": 8978.006, "sample_throughput": 534.64, "load_time_ms": 0.2, "load_throughput": 24001739.628, "learn_time_ms": 1168.188, "learn_throughput": 4108.929, "update_time_ms": 1.498}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 7.418873369693756, "policy_loss": 0.0014111191783579002, "vf_loss": 7.554546654224396, "vf_explained_var": -0.011655300855636597, "kl": 0.012197659933185268, "entropy": 13.818323731422424, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 662400, "num_agent_steps_sampled": 1987200, "num_steps_trained": 662400, "num_agent_steps_trained": 1987200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3137, "training_iteration": 138, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-04-10", "timestamp": 1706148250, "time_this_iter_s": 8.962361812591553, "time_total_s": 1290.168247461319, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1290.168247461319, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 6.830769230769231, "ram_util_percent": 46.89230769230768}}
{"episode_reward_max": 112.81593937426803, "episode_reward_min": 48.328758422285304, "episode_reward_mean": 74.82379060190571, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 16.0798657250901}, "policy_reward_max": {"shared_policy": 37.81226484725872}, "policy_reward_mean": {"shared_policy": 24.941263533968563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.04844674537887, 80.56892086565495, 73.01253062486649, 63.84229042939842, 78.85891402512787, 58.251789193600416, 85.43513935431838, 81.10634667798877, 80.71804735064507, 64.32238337770104, 65.59825818240641, 83.70159665495157, 77.87808334673898, 51.950372306630015, 86.8003495535813, 63.72894559055567, 64.31532894074915, 70.73143162578343, 77.62682999297975, 65.73885554820296, 68.08991325553507, 70.4310093820095, 89.11707916855812, 64.48693875875323, 77.37007880955932, 71.71000643027946, 65.30676487181334, 72.55001151189208, 92.71404406800866, 76.72430199012157, 79.57452180236575, 86.22304809093472, 78.63203501887617, 94.98568990081546, 89.42946976982054, 68.91649661585686, 84.47378316335379, 86.06583461165425, 75.44728083536029, 73.96114078816024, 59.28001141548154, 84.11237246543168, 66.61750274896619, 72.32689048349854, 112.81593937426803, 85.62769057787952, 65.99130330234766, 48.328758422285304, 96.23031212389469, 64.83956421725452, 60.468397580087185, 75.44870035210623, 68.15420470386742, 70.01740891579537, 65.80061973631379, 80.17568141967058, 83.90968765504655, 62.23905032873151, 58.21076608449221, 69.20316958613694, 64.64681299775837, 105.2250654892996, 73.9542169747874, 72.70169205218554, 70.98109108954665, 72.20318442676216, 68.77793793438465, 83.43568335473537, 81.46641795733011, 61.383327191637335, 92.15261380374432, 69.16388033330439, 56.97271297744007, 62.316132833366254, 62.72608930245039, 72.7828845158219, 81.74520387314257, 84.33090579509732, 97.32831002771852, 73.37359867803752, 74.34409156162289, 72.00783988833426, 77.74348838068543, 66.36328935856, 104.99524533144722, 73.34414709731935, 81.8636468015611, 55.0358373033814, 89.42960141226648, 76.33504546619949, 83.26241517718879, 69.08556505967863, 74.02302674017845, 88.69810041040179, 78.97615531366317, 61.15232384204863, 67.9123888290487, 65.28221270814538, 74.99846455454825, 65.61607262119648], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.080400335292012, 27.584823514024407, 28.38322289606245, 26.846643328666687, 26.860518246889114, 26.861759290099144, 24.115360990166664, 24.426671244204044, 24.470498390495777, 21.374644374474883, 21.3911786749959, 21.076467379927635, 26.23100111385186, 26.350051072736576, 26.277861838539437, 19.360828660428524, 19.51547147706151, 19.375489056110382, 28.66940612718463, 28.59349225461483, 28.17224097251892, 27.340280916541815, 26.85650173574686, 26.909564025700092, 26.638745725154877, 26.937081389129162, 27.142220236361027, 21.060635432600975, 21.439008697867393, 21.822739247232676, 21.973943670590714, 21.768726107974842, 21.855588403840855, 28.183561086654663, 28.31083730608225, 27.20719826221466, 26.012263326595217, 26.13100739290772, 25.73481262723604, 17.085182569921017, 17.483095737174153, 17.382093999534845, 28.88032605747381, 29.045886375165225, 28.874137120942265, 21.401642933487892, 21.064943447709084, 21.262359209358692, 21.4762845536073, 21.284430538614586, 21.554613848527268, 23.665474121769265, 23.394841765364006, 23.67111573865016, 26.242425003399447, 25.73737773050864, 25.647027259071663, 22.074455613891274, 21.85906722644964, 21.80533270786205, 22.789494171738625, 22.821226990781724, 22.479192093014717, 23.668659031391144, 23.36727626621723, 23.39507408440113, 30.02781420201063, 29.447178423404694, 29.642086543142796, 21.708581459087625, 21.381933984657124, 21.396423315008477, 25.70892273883024, 25.51463722685972, 26.14651884386936, 24.01733550429344, 23.61486255377531, 24.07780837221071, 21.584778306384877, 21.675227237244442, 22.046759328184024, 24.466231357306242, 24.097109645605087, 23.98667050898075, 31.10517441853881, 30.979449726641178, 30.629419922828674, 25.72420848036805, 25.694236377875, 25.305857131878525, 26.438976707557828, 26.344883585969598, 26.790661508838326, 28.752793076137692, 28.655215765039117, 28.815039249757916, 26.013534794251115, 26.57713877844313, 26.041361446181924, 31.832108723620564, 31.317042673627526, 31.83653850356737, 29.88689164320627, 29.323718498150498, 30.218859628463775, 23.18178645024696, 23.587015538165957, 22.14769462744394, 28.542048606400684, 28.282538150747612, 27.64919640620549, 28.407048160831124, 28.839768680433423, 28.819017770389706, 25.124743543565273, 25.32684376463294, 24.995693527162075, 24.810825308474392, 24.534699923048407, 24.615615556637437, 19.641275661687047, 19.93630341688791, 19.702432336906583, 28.058734868963555, 28.02679132421811, 28.026846272250012, 22.495912770430238, 22.16941014925638, 21.952179829279572, 24.194266657034547, 23.904309617976338, 24.22831420848766, 37.81226484725872, 37.773686374227196, 37.22998815278211, 28.613899553815514, 28.070488924781472, 28.943302099282533, 21.97912260144949, 22.37418080866337, 21.637999892234802, 16.089824226995304, 16.0798657250901, 16.159068470199898, 32.34096963703632, 32.05356468260288, 31.835777804255486, 21.53321612626314, 21.77434659563005, 21.532001495361328, 20.12546768784523, 20.329320974648, 20.013608917593956, 24.934456196924046, 25.03090288241704, 25.483341272765145, 22.708889727791146, 22.749653437485293, 22.695661538590983, 23.39671326366563, 23.252866887797907, 23.367828764331833, 21.885121556619794, 21.899755316476018, 22.01574286321798, 26.703093104064465, 26.787317261099815, 26.685271054506302, 27.884058165053517, 27.799390176932008, 28.22623931306103, 20.79572371641794, 20.616006920735032, 20.827319691578538, 19.467883747071028, 19.50561311468482, 19.23726922273636, 22.969859816133976, 23.20671829022467, 23.02659147977829, 21.54587337871392, 21.600633208950356, 21.500306410094097, 35.17349672317505, 34.76705078780651, 35.284517978318036, 24.467007999618843, 25.136776186836258, 24.3504327883323, 24.291989844292402, 23.968976348638535, 24.4407258592546, 23.63485777626434, 23.878817091385514, 23.467416221896798, 24.25872834865004, 23.922920934855938, 24.021535143256187, 22.848193163673074, 22.90908965530494, 23.02065511540664, 27.547379568219185, 27.992373503744602, 27.895930282771587, 26.929530320068196, 27.292038278266162, 27.24484935899575, 20.39258891592422, 20.967292361524102, 20.02344591418901, 30.757565781474113, 30.510268196463585, 30.884779825806618, 22.523324881990746, 23.435778376956776, 23.20477707435687, 19.023765639091522, 18.874817645798117, 19.07412969255043, 20.932860661220417, 20.446597958604485, 20.93667421354135, 21.162508993099124, 20.76672452191511, 20.796855787436158, 24.15171509484449, 24.307281168798596, 24.32388825217882, 27.326098817090184, 27.68558917256692, 26.733515883485467, 27.851017306248337, 28.379790636400372, 28.100097852448613, 32.46173361192146, 32.34432680408159, 32.522249611715466, 24.20333558320999, 24.48760712146759, 24.682655973359942, 25.005565710055322, 24.633274013797433, 24.705251837770135, 24.12585752209027, 24.288905431826905, 23.593076934417084, 26.1449232318749, 25.556650226314858, 26.04191492249568, 21.837000027298927, 22.413133720401675, 22.113155610859394, 35.06291790865362, 35.16909532576392, 34.763232097029686, 24.209515285988644, 24.53810356681545, 24.596528244515255, 27.064686273535088, 27.56025607263048, 27.238704455395535, 18.390076143046215, 18.199797143538788, 18.445964016796395, 30.05686133479078, 29.897937936087445, 29.474802141388253, 25.71728062319258, 25.09015283981958, 25.52761200318733, 27.492761875192315, 27.961877209755272, 27.8077760922412, 23.11071819253266, 22.781151846051216, 23.193695021094754, 24.858143463109926, 24.378440131743744, 24.78644314532478, 29.39310314754644, 29.61732270816961, 29.687674554685742, 25.988091697295502, 26.663235105884567, 26.3248285104831, 20.346195941170052, 19.98619319995244, 20.81993470092614, 22.649665455023438, 22.471047806243092, 22.791675567782164, 21.435138002038002, 21.9441387206316, 21.90293598547578, 24.80012885232766, 24.901718561848, 25.29661714037259, 21.929314273099095, 21.57794306675592, 22.108815281341464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1424685389802573, "mean_inference_ms": 0.6431979679501425, "mean_action_processing_ms": 0.09461977784340035, "mean_env_wait_ms": 0.7983863283588173, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 667200, "timesteps_this_iter": 0, "agent_timesteps_total": 2001600, "timers": {"sample_time_ms": 8976.906, "sample_throughput": 534.705, "load_time_ms": 0.2, "load_throughput": 24001739.628, "learn_time_ms": 1164.882, "learn_throughput": 4120.588, "update_time_ms": 1.598}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 7.168108224868774, "policy_loss": -0.00045021188849592164, "vf_loss": 7.307393789291382, "vf_explained_var": -0.0153074711561203, "kl": 0.009034335671638274, "entropy": 13.964946627616882, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 667200, "num_agent_steps_sampled": 2001600, "num_steps_trained": 667200, "num_agent_steps_trained": 2001600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3153, "training_iteration": 139, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-04-19", "timestamp": 1706148259, "time_this_iter_s": 8.929049730300903, "time_total_s": 1299.0972971916199, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000466790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1299.0972971916199, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 5.958333333333332, "ram_util_percent": 46.916666666666664}}
{"episode_reward_max": 112.81593937426803, "episode_reward_min": 48.328758422285304, "episode_reward_mean": 74.85769034249664, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 16.0798657250901}, "policy_reward_max": {"shared_policy": 37.81226484725872}, "policy_reward_mean": {"shared_policy": 24.952563447498875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.31532894074915, 70.73143162578343, 77.62682999297975, 65.73885554820296, 68.08991325553507, 70.4310093820095, 89.11707916855812, 64.48693875875323, 77.37007880955932, 71.71000643027946, 65.30676487181334, 72.55001151189208, 92.71404406800866, 76.72430199012157, 79.57452180236575, 86.22304809093472, 78.63203501887617, 94.98568990081546, 89.42946976982054, 68.91649661585686, 84.47378316335379, 86.06583461165425, 75.44728083536029, 73.96114078816024, 59.28001141548154, 84.11237246543168, 66.61750274896619, 72.32689048349854, 112.81593937426803, 85.62769057787952, 65.99130330234766, 48.328758422285304, 96.23031212389469, 64.83956421725452, 60.468397580087185, 75.44870035210623, 68.15420470386742, 70.01740891579537, 65.80061973631379, 80.17568141967058, 83.90968765504655, 62.23905032873151, 58.21076608449221, 69.20316958613694, 64.64681299775837, 105.2250654892996, 73.9542169747874, 72.70169205218554, 70.98109108954665, 72.20318442676216, 68.77793793438465, 83.43568335473537, 81.46641795733011, 61.383327191637335, 92.15261380374432, 69.16388033330439, 56.97271297744007, 62.316132833366254, 62.72608930245039, 72.7828845158219, 81.74520387314257, 84.33090579509732, 97.32831002771852, 73.37359867803752, 74.34409156162289, 72.00783988833426, 77.74348838068543, 66.36328935856, 104.99524533144722, 73.34414709731935, 81.8636468015611, 55.0358373033814, 89.42960141226648, 76.33504546619949, 83.26241517718879, 69.08556505967863, 74.02302674017845, 88.69810041040179, 78.97615531366317, 61.15232384204863, 67.9123888290487, 65.28221270814538, 74.99846455454825, 65.61607262119648, 65.24565419554709, 63.81392267718911, 84.86424472695217, 77.78270433843133, 89.99044038727878, 50.69945659674701, 74.85141506046057, 65.75615143030882, 79.36997305974364, 76.87612707912919, 77.70328571146818, 86.73301673308015, 73.84368340671062, 79.94423616677521, 68.90270249545574, 66.83537427335975], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.4762845536073, 21.284430538614586, 21.554613848527268, 23.665474121769265, 23.394841765364006, 23.67111573865016, 26.242425003399447, 25.73737773050864, 25.647027259071663, 22.074455613891274, 21.85906722644964, 21.80533270786205, 22.789494171738625, 22.821226990781724, 22.479192093014717, 23.668659031391144, 23.36727626621723, 23.39507408440113, 30.02781420201063, 29.447178423404694, 29.642086543142796, 21.708581459087625, 21.381933984657124, 21.396423315008477, 25.70892273883024, 25.51463722685972, 26.14651884386936, 24.01733550429344, 23.61486255377531, 24.07780837221071, 21.584778306384877, 21.675227237244442, 22.046759328184024, 24.466231357306242, 24.097109645605087, 23.98667050898075, 31.10517441853881, 30.979449726641178, 30.629419922828674, 25.72420848036805, 25.694236377875, 25.305857131878525, 26.438976707557828, 26.344883585969598, 26.790661508838326, 28.752793076137692, 28.655215765039117, 28.815039249757916, 26.013534794251115, 26.57713877844313, 26.041361446181924, 31.832108723620564, 31.317042673627526, 31.83653850356737, 29.88689164320627, 29.323718498150498, 30.218859628463775, 23.18178645024696, 23.587015538165957, 22.14769462744394, 28.542048606400684, 28.282538150747612, 27.64919640620549, 28.407048160831124, 28.839768680433423, 28.819017770389706, 25.124743543565273, 25.32684376463294, 24.995693527162075, 24.810825308474392, 24.534699923048407, 24.615615556637437, 19.641275661687047, 19.93630341688791, 19.702432336906583, 28.058734868963555, 28.02679132421811, 28.026846272250012, 22.495912770430238, 22.16941014925638, 21.952179829279572, 24.194266657034547, 23.904309617976338, 24.22831420848766, 37.81226484725872, 37.773686374227196, 37.22998815278211, 28.613899553815514, 28.070488924781472, 28.943302099282533, 21.97912260144949, 22.37418080866337, 21.637999892234802, 16.089824226995304, 16.0798657250901, 16.159068470199898, 32.34096963703632, 32.05356468260288, 31.835777804255486, 21.53321612626314, 21.77434659563005, 21.532001495361328, 20.12546768784523, 20.329320974648, 20.013608917593956, 24.934456196924046, 25.03090288241704, 25.483341272765145, 22.708889727791146, 22.749653437485293, 22.695661538590983, 23.39671326366563, 23.252866887797907, 23.367828764331833, 21.885121556619794, 21.899755316476018, 22.01574286321798, 26.703093104064465, 26.787317261099815, 26.685271054506302, 27.884058165053517, 27.799390176932008, 28.22623931306103, 20.79572371641794, 20.616006920735032, 20.827319691578538, 19.467883747071028, 19.50561311468482, 19.23726922273636, 22.969859816133976, 23.20671829022467, 23.02659147977829, 21.54587337871392, 21.600633208950356, 21.500306410094097, 35.17349672317505, 34.76705078780651, 35.284517978318036, 24.467007999618843, 25.136776186836258, 24.3504327883323, 24.291989844292402, 23.968976348638535, 24.4407258592546, 23.63485777626434, 23.878817091385514, 23.467416221896798, 24.25872834865004, 23.922920934855938, 24.021535143256187, 22.848193163673074, 22.90908965530494, 23.02065511540664, 27.547379568219185, 27.992373503744602, 27.895930282771587, 26.929530320068196, 27.292038278266162, 27.24484935899575, 20.39258891592422, 20.967292361524102, 20.02344591418901, 30.757565781474113, 30.510268196463585, 30.884779825806618, 22.523324881990746, 23.435778376956776, 23.20477707435687, 19.023765639091522, 18.874817645798117, 19.07412969255043, 20.932860661220417, 20.446597958604485, 20.93667421354135, 21.162508993099124, 20.76672452191511, 20.796855787436158, 24.15171509484449, 24.307281168798596, 24.32388825217882, 27.326098817090184, 27.68558917256692, 26.733515883485467, 27.851017306248337, 28.379790636400372, 28.100097852448613, 32.46173361192146, 32.34432680408159, 32.522249611715466, 24.20333558320999, 24.48760712146759, 24.682655973359942, 25.005565710055322, 24.633274013797433, 24.705251837770135, 24.12585752209027, 24.288905431826905, 23.593076934417084, 26.1449232318749, 25.556650226314858, 26.04191492249568, 21.837000027298927, 22.413133720401675, 22.113155610859394, 35.06291790865362, 35.16909532576392, 34.763232097029686, 24.209515285988644, 24.53810356681545, 24.596528244515255, 27.064686273535088, 27.56025607263048, 27.238704455395535, 18.390076143046215, 18.199797143538788, 18.445964016796395, 30.05686133479078, 29.897937936087445, 29.474802141388253, 25.71728062319258, 25.09015283981958, 25.52761200318733, 27.492761875192315, 27.961877209755272, 27.8077760922412, 23.11071819253266, 22.781151846051216, 23.193695021094754, 24.858143463109926, 24.378440131743744, 24.78644314532478, 29.39310314754644, 29.61732270816961, 29.687674554685742, 25.988091697295502, 26.663235105884567, 26.3248285104831, 20.346195941170052, 19.98619319995244, 20.81993470092614, 22.649665455023438, 22.471047806243092, 22.791675567782164, 21.435138002038002, 21.9441387206316, 21.90293598547578, 24.80012885232766, 24.901718561848, 25.29661714037259, 21.929314273099095, 21.57794306675592, 22.108815281341464, 21.475548689564064, 21.850572769840554, 21.91953273614247, 21.485160779207945, 21.275817029178143, 21.052944868803024, 27.921712934970856, 28.29989818483591, 28.6426336071454, 25.94257832566896, 25.858485410610825, 25.981640602151543, 30.20749148105581, 29.93924168994029, 29.84370721628268, 16.8947718484948, 17.02054592842856, 16.784138819823653, 24.732844933867455, 25.14292299002409, 24.975647136569023, 21.808355517685413, 21.886885568499565, 22.06091034412384, 26.64671114459634, 26.49157301336527, 26.231688901782036, 25.735544609526784, 25.702808919052273, 25.437773550550133, 25.67125191291173, 25.668862288196877, 26.363171510359578, 28.946212377399206, 28.72143080085516, 29.065373554825783, 24.607637211680412, 24.542400188744068, 24.693646006286144, 26.52018969257672, 26.82049573709567, 26.60355073710282, 23.046548582613468, 22.659810960292816, 23.196342952549458, 22.208780298630387, 22.32105745623508, 22.30553651849428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1423936010298808, "mean_inference_ms": 0.6430437597058914, "mean_action_processing_ms": 0.0946157748955479, "mean_env_wait_ms": 0.7981527043286982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 672000, "timesteps_this_iter": 0, "agent_timesteps_total": 2016000, "timers": {"sample_time_ms": 8983.085, "sample_throughput": 534.338, "load_time_ms": 0.2, "load_throughput": 24001739.628, "learn_time_ms": 1165.22, "learn_throughput": 4119.394, "update_time_ms": 1.599}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.21005254983902, "policy_loss": 0.00012312939848113658, "vf_loss": 6.348597407341003, "vf_explained_var": 0.0041893646121025085, "kl": 0.010111305746429695, "entropy": 13.957919478416443, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 672000, "num_agent_steps_sampled": 2016000, "num_steps_trained": 672000, "num_agent_steps_trained": 2016000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3169, "training_iteration": 140, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-04-28", "timestamp": 1706148268, "time_this_iter_s": 9.01332426071167, "time_total_s": 1308.1106214523315, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1308.1106214523315, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 6.938461538461539, "ram_util_percent": 46.9153846153846}}
{"episode_reward_max": 112.81593937426803, "episode_reward_min": 48.328758422285304, "episode_reward_mean": 74.61303864924193, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 16.0798657250901}, "policy_reward_max": {"shared_policy": 37.81226484725872}, "policy_reward_mean": {"shared_policy": 24.87101288308064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.63203501887617, 94.98568990081546, 89.42946976982054, 68.91649661585686, 84.47378316335379, 86.06583461165425, 75.44728083536029, 73.96114078816024, 59.28001141548154, 84.11237246543168, 66.61750274896619, 72.32689048349854, 112.81593937426803, 85.62769057787952, 65.99130330234766, 48.328758422285304, 96.23031212389469, 64.83956421725452, 60.468397580087185, 75.44870035210623, 68.15420470386742, 70.01740891579537, 65.80061973631379, 80.17568141967058, 83.90968765504655, 62.23905032873151, 58.21076608449221, 69.20316958613694, 64.64681299775837, 105.2250654892996, 73.9542169747874, 72.70169205218554, 70.98109108954665, 72.20318442676216, 68.77793793438465, 83.43568335473537, 81.46641795733011, 61.383327191637335, 92.15261380374432, 69.16388033330439, 56.97271297744007, 62.316132833366254, 62.72608930245039, 72.7828845158219, 81.74520387314257, 84.33090579509732, 97.32831002771852, 73.37359867803752, 74.34409156162289, 72.00783988833426, 77.74348838068543, 66.36328935856, 104.99524533144722, 73.34414709731935, 81.8636468015611, 55.0358373033814, 89.42960141226648, 76.33504546619949, 83.26241517718879, 69.08556505967863, 74.02302674017845, 88.69810041040179, 78.97615531366317, 61.15232384204863, 67.9123888290487, 65.28221270814538, 74.99846455454825, 65.61607262119648, 65.24565419554709, 63.81392267718911, 84.86424472695217, 77.78270433843133, 89.99044038727878, 50.69945659674701, 74.85141506046057, 65.75615143030882, 79.36997305974364, 76.87612707912919, 77.70328571146818, 86.73301673308015, 73.84368340671062, 79.94423616677521, 68.90270249545574, 66.83537427335975, 93.42090371996164, 63.99346662685272, 76.32222564518449, 65.2504158243537, 92.8193979896605, 73.30039724335073, 79.24337856471537, 73.95772660709918, 68.37769535090771, 83.27884179027751, 66.8776198029518, 54.13861871697007, 67.4605192095041, 69.5536253005266, 74.93242717813698, 65.3177353516221], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.013534794251115, 26.57713877844313, 26.041361446181924, 31.832108723620564, 31.317042673627526, 31.83653850356737, 29.88689164320627, 29.323718498150498, 30.218859628463775, 23.18178645024696, 23.587015538165957, 22.14769462744394, 28.542048606400684, 28.282538150747612, 27.64919640620549, 28.407048160831124, 28.839768680433423, 28.819017770389706, 25.124743543565273, 25.32684376463294, 24.995693527162075, 24.810825308474392, 24.534699923048407, 24.615615556637437, 19.641275661687047, 19.93630341688791, 19.702432336906583, 28.058734868963555, 28.02679132421811, 28.026846272250012, 22.495912770430238, 22.16941014925638, 21.952179829279572, 24.194266657034547, 23.904309617976338, 24.22831420848766, 37.81226484725872, 37.773686374227196, 37.22998815278211, 28.613899553815514, 28.070488924781472, 28.943302099282533, 21.97912260144949, 22.37418080866337, 21.637999892234802, 16.089824226995304, 16.0798657250901, 16.159068470199898, 32.34096963703632, 32.05356468260288, 31.835777804255486, 21.53321612626314, 21.77434659563005, 21.532001495361328, 20.12546768784523, 20.329320974648, 20.013608917593956, 24.934456196924046, 25.03090288241704, 25.483341272765145, 22.708889727791146, 22.749653437485293, 22.695661538590983, 23.39671326366563, 23.252866887797907, 23.367828764331833, 21.885121556619794, 21.899755316476018, 22.01574286321798, 26.703093104064465, 26.787317261099815, 26.685271054506302, 27.884058165053517, 27.799390176932008, 28.22623931306103, 20.79572371641794, 20.616006920735032, 20.827319691578538, 19.467883747071028, 19.50561311468482, 19.23726922273636, 22.969859816133976, 23.20671829022467, 23.02659147977829, 21.54587337871392, 21.600633208950356, 21.500306410094097, 35.17349672317505, 34.76705078780651, 35.284517978318036, 24.467007999618843, 25.136776186836258, 24.3504327883323, 24.291989844292402, 23.968976348638535, 24.4407258592546, 23.63485777626434, 23.878817091385514, 23.467416221896798, 24.25872834865004, 23.922920934855938, 24.021535143256187, 22.848193163673074, 22.90908965530494, 23.02065511540664, 27.547379568219185, 27.992373503744602, 27.895930282771587, 26.929530320068196, 27.292038278266162, 27.24484935899575, 20.39258891592422, 20.967292361524102, 20.02344591418901, 30.757565781474113, 30.510268196463585, 30.884779825806618, 22.523324881990746, 23.435778376956776, 23.20477707435687, 19.023765639091522, 18.874817645798117, 19.07412969255043, 20.932860661220417, 20.446597958604485, 20.93667421354135, 21.162508993099124, 20.76672452191511, 20.796855787436158, 24.15171509484449, 24.307281168798596, 24.32388825217882, 27.326098817090184, 27.68558917256692, 26.733515883485467, 27.851017306248337, 28.379790636400372, 28.100097852448613, 32.46173361192146, 32.34432680408159, 32.522249611715466, 24.20333558320999, 24.48760712146759, 24.682655973359942, 25.005565710055322, 24.633274013797433, 24.705251837770135, 24.12585752209027, 24.288905431826905, 23.593076934417084, 26.1449232318749, 25.556650226314858, 26.04191492249568, 21.837000027298927, 22.413133720401675, 22.113155610859394, 35.06291790865362, 35.16909532576392, 34.763232097029686, 24.209515285988644, 24.53810356681545, 24.596528244515255, 27.064686273535088, 27.56025607263048, 27.238704455395535, 18.390076143046215, 18.199797143538788, 18.445964016796395, 30.05686133479078, 29.897937936087445, 29.474802141388253, 25.71728062319258, 25.09015283981958, 25.52761200318733, 27.492761875192315, 27.961877209755272, 27.8077760922412, 23.11071819253266, 22.781151846051216, 23.193695021094754, 24.858143463109926, 24.378440131743744, 24.78644314532478, 29.39310314754644, 29.61732270816961, 29.687674554685742, 25.988091697295502, 26.663235105884567, 26.3248285104831, 20.346195941170052, 19.98619319995244, 20.81993470092614, 22.649665455023438, 22.471047806243092, 22.791675567782164, 21.435138002038002, 21.9441387206316, 21.90293598547578, 24.80012885232766, 24.901718561848, 25.29661714037259, 21.929314273099095, 21.57794306675592, 22.108815281341464, 21.475548689564064, 21.850572769840554, 21.91953273614247, 21.485160779207945, 21.275817029178143, 21.052944868803024, 27.921712934970856, 28.29989818483591, 28.6426336071454, 25.94257832566896, 25.858485410610825, 25.981640602151543, 30.20749148105581, 29.93924168994029, 29.84370721628268, 16.8947718484948, 17.02054592842856, 16.784138819823653, 24.732844933867455, 25.14292299002409, 24.975647136569023, 21.808355517685413, 21.886885568499565, 22.06091034412384, 26.64671114459634, 26.49157301336527, 26.231688901782036, 25.735544609526784, 25.702808919052273, 25.437773550550133, 25.67125191291173, 25.668862288196877, 26.363171510359578, 28.946212377399206, 28.72143080085516, 29.065373554825783, 24.607637211680412, 24.542400188744068, 24.693646006286144, 26.52018969257672, 26.82049573709567, 26.60355073710282, 23.046548582613468, 22.659810960292816, 23.196342952549458, 22.208780298630387, 22.32105745623508, 22.30553651849428, 31.28527471795678, 30.784888491034508, 31.350740510970354, 21.165740514794976, 21.379395114878804, 21.448330997178942, 25.425257364908845, 25.118421743313462, 25.778546536962182, 21.821826722472906, 21.677524231374264, 21.751064870506525, 30.694362744688988, 31.203264985233545, 30.92177025973797, 24.075862025221184, 24.60694496085246, 24.617590257277087, 26.288679738839463, 26.282419612010315, 26.672279213865593, 24.514650210738182, 24.852189237251878, 24.590887159109116, 22.80658797423044, 22.490713606278092, 23.080393770399183, 27.57660398632288, 27.5534133836627, 28.14882442029193, 22.549513799448803, 22.259400484462574, 22.06870551904042, 17.8626408179601, 17.661509936054543, 18.61446796295543, 22.24360458056131, 22.470266255239636, 22.746648373703152, 22.962129046519593, 23.2378607665499, 23.35363548745711, 24.901805172363908, 24.690184394518525, 25.340437611254544, 21.87109839823097, 21.83233279455453, 21.614304158836603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14232811087472888, "mean_inference_ms": 0.6429165680026142, "mean_action_processing_ms": 0.0946199023388557, "mean_env_wait_ms": 0.7979371569984803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 676800, "timesteps_this_iter": 0, "agent_timesteps_total": 2030400, "timers": {"sample_time_ms": 9010.292, "sample_throughput": 532.724, "load_time_ms": 0.2, "load_throughput": 24001739.628, "learn_time_ms": 1170.525, "learn_throughput": 4100.725, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.314933955669403, "policy_loss": -0.0010846172440768242, "vf_loss": 6.4576608538627625, "vf_explained_var": -0.00039496272802352905, "kl": 0.006264453637602521, "entropy": 14.220694065093994, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 676800, "num_agent_steps_sampled": 2030400, "num_steps_trained": 676800, "num_agent_steps_trained": 2030400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3185, "training_iteration": 141, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-04-37", "timestamp": 1706148277, "time_this_iter_s": 9.28043532371521, "time_total_s": 1317.3910567760468, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C118B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1317.3910567760468, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 7.807692307692307, "ram_util_percent": 46.95384615384615}}
{"episode_reward_max": 107.38549856096506, "episode_reward_min": 50.69945659674701, "episode_reward_mean": 74.39805221022529, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 16.784138819823653}, "policy_reward_max": {"shared_policy": 36.0019049346447}, "policy_reward_mean": {"shared_policy": 24.799350736741758}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.23031212389469, 64.83956421725452, 60.468397580087185, 75.44870035210623, 68.15420470386742, 70.01740891579537, 65.80061973631379, 80.17568141967058, 83.90968765504655, 62.23905032873151, 58.21076608449221, 69.20316958613694, 64.64681299775837, 105.2250654892996, 73.9542169747874, 72.70169205218554, 70.98109108954665, 72.20318442676216, 68.77793793438465, 83.43568335473537, 81.46641795733011, 61.383327191637335, 92.15261380374432, 69.16388033330439, 56.97271297744007, 62.316132833366254, 62.72608930245039, 72.7828845158219, 81.74520387314257, 84.33090579509732, 97.32831002771852, 73.37359867803752, 74.34409156162289, 72.00783988833426, 77.74348838068543, 66.36328935856, 104.99524533144722, 73.34414709731935, 81.8636468015611, 55.0358373033814, 89.42960141226648, 76.33504546619949, 83.26241517718879, 69.08556505967863, 74.02302674017845, 88.69810041040179, 78.97615531366317, 61.15232384204863, 67.9123888290487, 65.28221270814538, 74.99846455454825, 65.61607262119648, 65.24565419554709, 63.81392267718911, 84.86424472695217, 77.78270433843133, 89.99044038727878, 50.69945659674701, 74.85141506046057, 65.75615143030882, 79.36997305974364, 76.87612707912919, 77.70328571146818, 86.73301673308015, 73.84368340671062, 79.94423616677521, 68.90270249545574, 66.83537427335975, 93.42090371996164, 63.99346662685272, 76.32222564518449, 65.2504158243537, 92.8193979896605, 73.30039724335073, 79.24337856471537, 73.95772660709918, 68.37769535090771, 83.27884179027751, 66.8776198029518, 54.13861871697007, 67.4605192095041, 69.5536253005266, 74.93242717813698, 65.3177353516221, 90.99008976295589, 57.34317370131609, 73.46374716935678, 82.7288392782211, 66.48488260805604, 66.2719372306019, 71.11900606192647, 80.06903515383601, 73.96738710254431, 69.94282570108768, 81.72808691114187, 57.59871556982395, 75.16211306583133, 107.38549856096506, 104.73374715447424, 66.52447056025265], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [32.34096963703632, 32.05356468260288, 31.835777804255486, 21.53321612626314, 21.77434659563005, 21.532001495361328, 20.12546768784523, 20.329320974648, 20.013608917593956, 24.934456196924046, 25.03090288241704, 25.483341272765145, 22.708889727791146, 22.749653437485293, 22.695661538590983, 23.39671326366563, 23.252866887797907, 23.367828764331833, 21.885121556619794, 21.899755316476018, 22.01574286321798, 26.703093104064465, 26.787317261099815, 26.685271054506302, 27.884058165053517, 27.799390176932008, 28.22623931306103, 20.79572371641794, 20.616006920735032, 20.827319691578538, 19.467883747071028, 19.50561311468482, 19.23726922273636, 22.969859816133976, 23.20671829022467, 23.02659147977829, 21.54587337871392, 21.600633208950356, 21.500306410094097, 35.17349672317505, 34.76705078780651, 35.284517978318036, 24.467007999618843, 25.136776186836258, 24.3504327883323, 24.291989844292402, 23.968976348638535, 24.4407258592546, 23.63485777626434, 23.878817091385514, 23.467416221896798, 24.25872834865004, 23.922920934855938, 24.021535143256187, 22.848193163673074, 22.90908965530494, 23.02065511540664, 27.547379568219185, 27.992373503744602, 27.895930282771587, 26.929530320068196, 27.292038278266162, 27.24484935899575, 20.39258891592422, 20.967292361524102, 20.02344591418901, 30.757565781474113, 30.510268196463585, 30.884779825806618, 22.523324881990746, 23.435778376956776, 23.20477707435687, 19.023765639091522, 18.874817645798117, 19.07412969255043, 20.932860661220417, 20.446597958604485, 20.93667421354135, 21.162508993099124, 20.76672452191511, 20.796855787436158, 24.15171509484449, 24.307281168798596, 24.32388825217882, 27.326098817090184, 27.68558917256692, 26.733515883485467, 27.851017306248337, 28.379790636400372, 28.100097852448613, 32.46173361192146, 32.34432680408159, 32.522249611715466, 24.20333558320999, 24.48760712146759, 24.682655973359942, 25.005565710055322, 24.633274013797433, 24.705251837770135, 24.12585752209027, 24.288905431826905, 23.593076934417084, 26.1449232318749, 25.556650226314858, 26.04191492249568, 21.837000027298927, 22.413133720401675, 22.113155610859394, 35.06291790865362, 35.16909532576392, 34.763232097029686, 24.209515285988644, 24.53810356681545, 24.596528244515255, 27.064686273535088, 27.56025607263048, 27.238704455395535, 18.390076143046215, 18.199797143538788, 18.445964016796395, 30.05686133479078, 29.897937936087445, 29.474802141388253, 25.71728062319258, 25.09015283981958, 25.52761200318733, 27.492761875192315, 27.961877209755272, 27.8077760922412, 23.11071819253266, 22.781151846051216, 23.193695021094754, 24.858143463109926, 24.378440131743744, 24.78644314532478, 29.39310314754644, 29.61732270816961, 29.687674554685742, 25.988091697295502, 26.663235105884567, 26.3248285104831, 20.346195941170052, 19.98619319995244, 20.81993470092614, 22.649665455023438, 22.471047806243092, 22.791675567782164, 21.435138002038002, 21.9441387206316, 21.90293598547578, 24.80012885232766, 24.901718561848, 25.29661714037259, 21.929314273099095, 21.57794306675592, 22.108815281341464, 21.475548689564064, 21.850572769840554, 21.91953273614247, 21.485160779207945, 21.275817029178143, 21.052944868803024, 27.921712934970856, 28.29989818483591, 28.6426336071454, 25.94257832566896, 25.858485410610825, 25.981640602151543, 30.20749148105581, 29.93924168994029, 29.84370721628268, 16.8947718484948, 17.02054592842856, 16.784138819823653, 24.732844933867455, 25.14292299002409, 24.975647136569023, 21.808355517685413, 21.886885568499565, 22.06091034412384, 26.64671114459634, 26.49157301336527, 26.231688901782036, 25.735544609526784, 25.702808919052273, 25.437773550550133, 25.67125191291173, 25.668862288196877, 26.363171510359578, 28.946212377399206, 28.72143080085516, 29.065373554825783, 24.607637211680412, 24.542400188744068, 24.693646006286144, 26.52018969257672, 26.82049573709567, 26.60355073710282, 23.046548582613468, 22.659810960292816, 23.196342952549458, 22.208780298630387, 22.32105745623508, 22.30553651849428, 31.28527471795678, 30.784888491034508, 31.350740510970354, 21.165740514794976, 21.379395114878804, 21.448330997178942, 25.425257364908845, 25.118421743313462, 25.778546536962182, 21.821826722472906, 21.677524231374264, 21.751064870506525, 30.694362744688988, 31.203264985233545, 30.92177025973797, 24.075862025221184, 24.60694496085246, 24.617590257277087, 26.288679738839463, 26.282419612010315, 26.672279213865593, 24.514650210738182, 24.852189237251878, 24.590887159109116, 22.80658797423044, 22.490713606278092, 23.080393770399183, 27.57660398632288, 27.5534133836627, 28.14882442029193, 22.549513799448803, 22.259400484462574, 22.06870551904042, 17.8626408179601, 17.661509936054543, 18.61446796295543, 22.24360458056131, 22.470266255239636, 22.746648373703152, 22.962129046519593, 23.2378607665499, 23.35363548745711, 24.901805172363908, 24.690184394518525, 25.340437611254544, 21.87109839823097, 21.83233279455453, 21.614304158836603, 30.523352855195597, 30.267619890471295, 30.199117017288998, 19.215517951796443, 19.077101717392594, 19.050554032127053, 24.83270990926151, 24.530714755256966, 24.100322504838303, 27.518377783397824, 27.81281105677286, 27.39765043805042, 22.32109739134708, 22.29301734517017, 21.87076787153879, 21.947973132133484, 22.082451920956373, 22.24151217751205, 23.604783688982323, 23.656557102998093, 23.857665269946054, 26.663103982806206, 26.679887011647224, 26.72604415938258, 24.52076581120491, 24.727272724732757, 24.71934856660664, 23.30902341256538, 23.1100615064303, 23.523740782092005, 27.11820474267006, 27.519604958593845, 27.090277209877968, 19.331902785847575, 19.33982716749111, 18.92698561648527, 24.92349575708309, 25.017368900279195, 25.22124840846905, 35.387237921357155, 36.0019049346447, 35.99635570496321, 34.725249504049614, 35.04347993185122, 34.96501771857341, 22.118417297800377, 22.474836123486355, 21.93121713896592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1422616631965249, "mean_inference_ms": 0.642800703168897, "mean_action_processing_ms": 0.09461501241937718, "mean_env_wait_ms": 0.7977358399551774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 681600, "timesteps_this_iter": 0, "agent_timesteps_total": 2044800, "timers": {"sample_time_ms": 9024.607, "sample_throughput": 531.879, "load_time_ms": 0.1, "load_throughput": 48026381.679, "learn_time_ms": 1170.43, "learn_throughput": 4101.056, "update_time_ms": 1.602}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.4541095495224, "policy_loss": -0.0012797016300949704, "vf_loss": 6.594946205615997, "vf_explained_var": 0.0037595927715301514, "kl": 0.0072301866895948174, "entropy": 14.020865559577942, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 681600, "num_agent_steps_sampled": 2044800, "num_steps_trained": 681600, "num_agent_steps_trained": 2044800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3201, "training_iteration": 142, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-04-46", "timestamp": 1706148286, "time_this_iter_s": 8.94590139389038, "time_total_s": 1326.3369581699371, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1C3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1326.3369581699371, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 7.953846153846154, "ram_util_percent": 46.88461538461539}}
{"episode_reward_max": 109.16371338441965, "episode_reward_min": 43.736193377524586, "episode_reward_mean": 74.57025251775354, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.311256940166146}, "policy_reward_max": {"shared_policy": 36.64887738848725}, "policy_reward_mean": {"shared_policy": 24.856750839251173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.98109108954665, 72.20318442676216, 68.77793793438465, 83.43568335473537, 81.46641795733011, 61.383327191637335, 92.15261380374432, 69.16388033330439, 56.97271297744007, 62.316132833366254, 62.72608930245039, 72.7828845158219, 81.74520387314257, 84.33090579509732, 97.32831002771852, 73.37359867803752, 74.34409156162289, 72.00783988833426, 77.74348838068543, 66.36328935856, 104.99524533144722, 73.34414709731935, 81.8636468015611, 55.0358373033814, 89.42960141226648, 76.33504546619949, 83.26241517718879, 69.08556505967863, 74.02302674017845, 88.69810041040179, 78.97615531366317, 61.15232384204863, 67.9123888290487, 65.28221270814538, 74.99846455454825, 65.61607262119648, 65.24565419554709, 63.81392267718911, 84.86424472695217, 77.78270433843133, 89.99044038727878, 50.69945659674701, 74.85141506046057, 65.75615143030882, 79.36997305974364, 76.87612707912919, 77.70328571146818, 86.73301673308015, 73.84368340671062, 79.94423616677521, 68.90270249545574, 66.83537427335975, 93.42090371996164, 63.99346662685272, 76.32222564518449, 65.2504158243537, 92.8193979896605, 73.30039724335073, 79.24337856471537, 73.95772660709918, 68.37769535090771, 83.27884179027751, 66.8776198029518, 54.13861871697007, 67.4605192095041, 69.5536253005266, 74.93242717813698, 65.3177353516221, 90.99008976295589, 57.34317370131609, 73.46374716935678, 82.7288392782211, 66.48488260805604, 66.2719372306019, 71.11900606192647, 80.06903515383601, 73.96738710254431, 69.94282570108768, 81.72808691114187, 57.59871556982395, 75.16211306583133, 107.38549856096506, 104.73374715447424, 66.52447056025265, 91.82340689375997, 95.74458798766135, 61.47074260190129, 109.16371338441965, 78.1364014483988, 57.045302320271716, 69.19900071236768, 43.736193377524586, 80.89642959553747, 63.098290126770706, 76.92279433459044, 80.01104687154292, 96.89094096422193, 64.40934181213379, 51.61454552412033, 68.28264301503076], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.63485777626434, 23.878817091385514, 23.467416221896798, 24.25872834865004, 23.922920934855938, 24.021535143256187, 22.848193163673074, 22.90908965530494, 23.02065511540664, 27.547379568219185, 27.992373503744602, 27.895930282771587, 26.929530320068196, 27.292038278266162, 27.24484935899575, 20.39258891592422, 20.967292361524102, 20.02344591418901, 30.757565781474113, 30.510268196463585, 30.884779825806618, 22.523324881990746, 23.435778376956776, 23.20477707435687, 19.023765639091522, 18.874817645798117, 19.07412969255043, 20.932860661220417, 20.446597958604485, 20.93667421354135, 21.162508993099124, 20.76672452191511, 20.796855787436158, 24.15171509484449, 24.307281168798596, 24.32388825217882, 27.326098817090184, 27.68558917256692, 26.733515883485467, 27.851017306248337, 28.379790636400372, 28.100097852448613, 32.46173361192146, 32.34432680408159, 32.522249611715466, 24.20333558320999, 24.48760712146759, 24.682655973359942, 25.005565710055322, 24.633274013797433, 24.705251837770135, 24.12585752209027, 24.288905431826905, 23.593076934417084, 26.1449232318749, 25.556650226314858, 26.04191492249568, 21.837000027298927, 22.413133720401675, 22.113155610859394, 35.06291790865362, 35.16909532576392, 34.763232097029686, 24.209515285988644, 24.53810356681545, 24.596528244515255, 27.064686273535088, 27.56025607263048, 27.238704455395535, 18.390076143046215, 18.199797143538788, 18.445964016796395, 30.05686133479078, 29.897937936087445, 29.474802141388253, 25.71728062319258, 25.09015283981958, 25.52761200318733, 27.492761875192315, 27.961877209755272, 27.8077760922412, 23.11071819253266, 22.781151846051216, 23.193695021094754, 24.858143463109926, 24.378440131743744, 24.78644314532478, 29.39310314754644, 29.61732270816961, 29.687674554685742, 25.988091697295502, 26.663235105884567, 26.3248285104831, 20.346195941170052, 19.98619319995244, 20.81993470092614, 22.649665455023438, 22.471047806243092, 22.791675567782164, 21.435138002038002, 21.9441387206316, 21.90293598547578, 24.80012885232766, 24.901718561848, 25.29661714037259, 21.929314273099095, 21.57794306675592, 22.108815281341464, 21.475548689564064, 21.850572769840554, 21.91953273614247, 21.485160779207945, 21.275817029178143, 21.052944868803024, 27.921712934970856, 28.29989818483591, 28.6426336071454, 25.94257832566896, 25.858485410610825, 25.981640602151543, 30.20749148105581, 29.93924168994029, 29.84370721628268, 16.8947718484948, 17.02054592842856, 16.784138819823653, 24.732844933867455, 25.14292299002409, 24.975647136569023, 21.808355517685413, 21.886885568499565, 22.06091034412384, 26.64671114459634, 26.49157301336527, 26.231688901782036, 25.735544609526784, 25.702808919052273, 25.437773550550133, 25.67125191291173, 25.668862288196877, 26.363171510359578, 28.946212377399206, 28.72143080085516, 29.065373554825783, 24.607637211680412, 24.542400188744068, 24.693646006286144, 26.52018969257672, 26.82049573709567, 26.60355073710282, 23.046548582613468, 22.659810960292816, 23.196342952549458, 22.208780298630387, 22.32105745623508, 22.30553651849428, 31.28527471795678, 30.784888491034508, 31.350740510970354, 21.165740514794976, 21.379395114878804, 21.448330997178942, 25.425257364908845, 25.118421743313462, 25.778546536962182, 21.821826722472906, 21.677524231374264, 21.751064870506525, 30.694362744688988, 31.203264985233545, 30.92177025973797, 24.075862025221184, 24.60694496085246, 24.617590257277087, 26.288679738839463, 26.282419612010315, 26.672279213865593, 24.514650210738182, 24.852189237251878, 24.590887159109116, 22.80658797423044, 22.490713606278092, 23.080393770399183, 27.57660398632288, 27.5534133836627, 28.14882442029193, 22.549513799448803, 22.259400484462574, 22.06870551904042, 17.8626408179601, 17.661509936054543, 18.61446796295543, 22.24360458056131, 22.470266255239636, 22.746648373703152, 22.962129046519593, 23.2378607665499, 23.35363548745711, 24.901805172363908, 24.690184394518525, 25.340437611254544, 21.87109839823097, 21.83233279455453, 21.614304158836603, 30.523352855195597, 30.267619890471295, 30.199117017288998, 19.215517951796443, 19.077101717392594, 19.050554032127053, 24.83270990926151, 24.530714755256966, 24.100322504838303, 27.518377783397824, 27.81281105677286, 27.39765043805042, 22.32109739134708, 22.29301734517017, 21.87076787153879, 21.947973132133484, 22.082451920956373, 22.24151217751205, 23.604783688982323, 23.656557102998093, 23.857665269946054, 26.663103982806206, 26.679887011647224, 26.72604415938258, 24.52076581120491, 24.727272724732757, 24.71934856660664, 23.30902341256538, 23.1100615064303, 23.523740782092005, 27.11820474267006, 27.519604958593845, 27.090277209877968, 19.331902785847575, 19.33982716749111, 18.92698561648527, 24.92349575708309, 25.017368900279195, 25.22124840846905, 35.387237921357155, 36.0019049346447, 35.99635570496321, 34.725249504049614, 35.04347993185122, 34.96501771857341, 22.118417297800377, 22.474836123486355, 21.93121713896592, 30.439163640141487, 30.60246818512678, 30.781775068491697, 31.78538343062003, 31.93774053951104, 32.02146401753028, 20.060492500662804, 20.522427529096603, 20.887822572141886, 36.11385505149761, 36.40098094443479, 36.64887738848725, 25.664629871646554, 26.084426092604787, 26.38734548414746, 18.83466189851363, 19.038702381153897, 19.17193804060419, 23.047624463836343, 23.129885962737404, 23.02149028579393, 14.487602050105721, 14.311256940166146, 14.937334387252719, 26.99644388755162, 26.570546274383858, 27.32943943360199, 20.845810780922562, 21.21253344292441, 21.039945902923733, 25.813990861177444, 25.702998369932175, 25.405805103480816, 26.64848542710145, 26.948590715726212, 26.413970728715256, 31.982413629690797, 32.38356630007425, 32.52496103445688, 21.37787014245987, 21.551964730024338, 21.479506939649582, 16.76878134906292, 17.3596681766212, 17.486095998436213, 22.48471539964278, 22.918736983866737, 22.87919063152124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14219652869193136, "mean_inference_ms": 0.6427043318237164, "mean_action_processing_ms": 0.09462001936260961, "mean_env_wait_ms": 0.7975340780508202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 686400, "timesteps_this_iter": 0, "agent_timesteps_total": 2059200, "timers": {"sample_time_ms": 9024.676, "sample_throughput": 531.875, "load_time_ms": 0.1, "load_throughput": 48026381.679, "learn_time_ms": 1168.336, "learn_throughput": 4108.407, "update_time_ms": 1.702}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 7.207330882549286, "policy_loss": -0.0004565788833941764, "vf_loss": 7.348515689373016, "vf_explained_var": -0.009751677513122559, "kl": 0.010290167643880813, "entropy": 14.16555142402649, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 686400, "num_agent_steps_sampled": 2059200, "num_steps_trained": 686400, "num_agent_steps_trained": 2059200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3217, "training_iteration": 143, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-04-55", "timestamp": 1706148295, "time_this_iter_s": 9.027488470077515, "time_total_s": 1335.3644466400146, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1C160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1335.3644466400146, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 7.715384615384616, "ram_util_percent": 46.87692307692308}}
{"episode_reward_max": 109.16371338441965, "episode_reward_min": 36.233207140117884, "episode_reward_mean": 73.58027501252727, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.021790824830532}, "policy_reward_max": {"shared_policy": 36.64887738848725}, "policy_reward_mean": {"shared_policy": 24.526758337509083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.34409156162289, 72.00783988833426, 77.74348838068543, 66.36328935856, 104.99524533144722, 73.34414709731935, 81.8636468015611, 55.0358373033814, 89.42960141226648, 76.33504546619949, 83.26241517718879, 69.08556505967863, 74.02302674017845, 88.69810041040179, 78.97615531366317, 61.15232384204863, 67.9123888290487, 65.28221270814538, 74.99846455454825, 65.61607262119648, 65.24565419554709, 63.81392267718911, 84.86424472695217, 77.78270433843133, 89.99044038727878, 50.69945659674701, 74.85141506046057, 65.75615143030882, 79.36997305974364, 76.87612707912919, 77.70328571146818, 86.73301673308015, 73.84368340671062, 79.94423616677521, 68.90270249545574, 66.83537427335975, 93.42090371996164, 63.99346662685272, 76.32222564518449, 65.2504158243537, 92.8193979896605, 73.30039724335073, 79.24337856471537, 73.95772660709918, 68.37769535090771, 83.27884179027751, 66.8776198029518, 54.13861871697007, 67.4605192095041, 69.5536253005266, 74.93242717813698, 65.3177353516221, 90.99008976295589, 57.34317370131609, 73.46374716935678, 82.7288392782211, 66.48488260805604, 66.2719372306019, 71.11900606192647, 80.06903515383601, 73.96738710254431, 69.94282570108768, 81.72808691114187, 57.59871556982395, 75.16211306583133, 107.38549856096506, 104.73374715447424, 66.52447056025265, 91.82340689375997, 95.74458798766135, 61.47074260190129, 109.16371338441965, 78.1364014483988, 57.045302320271716, 69.19900071236768, 43.736193377524586, 80.89642959553747, 63.098290126770706, 76.92279433459044, 80.01104687154292, 96.89094096422193, 64.40934181213379, 51.61454552412033, 68.28264301503076, 68.32050077430904, 92.95612850040195, 71.76929669082163, 79.62031088257206, 91.91730798128992, 54.39673060178757, 56.03262552130036, 36.233207140117884, 85.31539010629058, 72.7167615108192, 65.17443842440844, 78.80420824885366, 51.33700045570728, 70.6946524430532, 64.47279093787071, 52.3808733522892], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.005565710055322, 24.633274013797433, 24.705251837770135, 24.12585752209027, 24.288905431826905, 23.593076934417084, 26.1449232318749, 25.556650226314858, 26.04191492249568, 21.837000027298927, 22.413133720401675, 22.113155610859394, 35.06291790865362, 35.16909532576392, 34.763232097029686, 24.209515285988644, 24.53810356681545, 24.596528244515255, 27.064686273535088, 27.56025607263048, 27.238704455395535, 18.390076143046215, 18.199797143538788, 18.445964016796395, 30.05686133479078, 29.897937936087445, 29.474802141388253, 25.71728062319258, 25.09015283981958, 25.52761200318733, 27.492761875192315, 27.961877209755272, 27.8077760922412, 23.11071819253266, 22.781151846051216, 23.193695021094754, 24.858143463109926, 24.378440131743744, 24.78644314532478, 29.39310314754644, 29.61732270816961, 29.687674554685742, 25.988091697295502, 26.663235105884567, 26.3248285104831, 20.346195941170052, 19.98619319995244, 20.81993470092614, 22.649665455023438, 22.471047806243092, 22.791675567782164, 21.435138002038002, 21.9441387206316, 21.90293598547578, 24.80012885232766, 24.901718561848, 25.29661714037259, 21.929314273099095, 21.57794306675592, 22.108815281341464, 21.475548689564064, 21.850572769840554, 21.91953273614247, 21.485160779207945, 21.275817029178143, 21.052944868803024, 27.921712934970856, 28.29989818483591, 28.6426336071454, 25.94257832566896, 25.858485410610825, 25.981640602151543, 30.20749148105581, 29.93924168994029, 29.84370721628268, 16.8947718484948, 17.02054592842856, 16.784138819823653, 24.732844933867455, 25.14292299002409, 24.975647136569023, 21.808355517685413, 21.886885568499565, 22.06091034412384, 26.64671114459634, 26.49157301336527, 26.231688901782036, 25.735544609526784, 25.702808919052273, 25.437773550550133, 25.67125191291173, 25.668862288196877, 26.363171510359578, 28.946212377399206, 28.72143080085516, 29.065373554825783, 24.607637211680412, 24.542400188744068, 24.693646006286144, 26.52018969257672, 26.82049573709567, 26.60355073710282, 23.046548582613468, 22.659810960292816, 23.196342952549458, 22.208780298630387, 22.32105745623508, 22.30553651849428, 31.28527471795678, 30.784888491034508, 31.350740510970354, 21.165740514794976, 21.379395114878804, 21.448330997178942, 25.425257364908845, 25.118421743313462, 25.778546536962182, 21.821826722472906, 21.677524231374264, 21.751064870506525, 30.694362744688988, 31.203264985233545, 30.92177025973797, 24.075862025221184, 24.60694496085246, 24.617590257277087, 26.288679738839463, 26.282419612010315, 26.672279213865593, 24.514650210738182, 24.852189237251878, 24.590887159109116, 22.80658797423044, 22.490713606278092, 23.080393770399183, 27.57660398632288, 27.5534133836627, 28.14882442029193, 22.549513799448803, 22.259400484462574, 22.06870551904042, 17.8626408179601, 17.661509936054543, 18.61446796295543, 22.24360458056131, 22.470266255239636, 22.746648373703152, 22.962129046519593, 23.2378607665499, 23.35363548745711, 24.901805172363908, 24.690184394518525, 25.340437611254544, 21.87109839823097, 21.83233279455453, 21.614304158836603, 30.523352855195597, 30.267619890471295, 30.199117017288998, 19.215517951796443, 19.077101717392594, 19.050554032127053, 24.83270990926151, 24.530714755256966, 24.100322504838303, 27.518377783397824, 27.81281105677286, 27.39765043805042, 22.32109739134708, 22.29301734517017, 21.87076787153879, 21.947973132133484, 22.082451920956373, 22.24151217751205, 23.604783688982323, 23.656557102998093, 23.857665269946054, 26.663103982806206, 26.679887011647224, 26.72604415938258, 24.52076581120491, 24.727272724732757, 24.71934856660664, 23.30902341256538, 23.1100615064303, 23.523740782092005, 27.11820474267006, 27.519604958593845, 27.090277209877968, 19.331902785847575, 19.33982716749111, 18.92698561648527, 24.92349575708309, 25.017368900279195, 25.22124840846905, 35.387237921357155, 36.0019049346447, 35.99635570496321, 34.725249504049614, 35.04347993185122, 34.96501771857341, 22.118417297800377, 22.474836123486355, 21.93121713896592, 30.439163640141487, 30.60246818512678, 30.781775068491697, 31.78538343062003, 31.93774053951104, 32.02146401753028, 20.060492500662804, 20.522427529096603, 20.887822572141886, 36.11385505149761, 36.40098094443479, 36.64887738848725, 25.664629871646554, 26.084426092604787, 26.38734548414746, 18.83466189851363, 19.038702381153897, 19.17193804060419, 23.047624463836343, 23.129885962737404, 23.02149028579393, 14.487602050105721, 14.311256940166146, 14.937334387252719, 26.99644388755162, 26.570546274383858, 27.32943943360199, 20.845810780922562, 21.21253344292441, 21.039945902923733, 25.813990861177444, 25.702998369932175, 25.405805103480816, 26.64848542710145, 26.948590715726212, 26.413970728715256, 31.982413629690797, 32.38356630007425, 32.52496103445688, 21.37787014245987, 21.551964730024338, 21.479506939649582, 16.76878134906292, 17.3596681766212, 17.486095998436213, 22.48471539964278, 22.918736983866737, 22.87919063152124, 22.466977551579475, 22.900189185515046, 22.953334037214518, 30.86643677453199, 31.025935451189667, 31.063756274680287, 23.633594517906502, 23.958111261328057, 24.177590911587075, 26.422886001567036, 26.78429835770899, 26.41312652329603, 30.544163815677166, 30.83319339249283, 30.539950773119926, 17.88194700330496, 18.297424159944057, 18.21735943853855, 18.47784409672022, 18.712338101118803, 18.84244332346134, 12.108951181173325, 12.102465134114027, 12.021790824830532, 28.289749041199684, 28.746366050094366, 28.27927501499653, 24.15104303508997, 24.34500465169549, 24.220713824033737, 21.5878347158432, 21.746925435960293, 21.839678272604942, 26.409535924593598, 26.348001355926186, 26.04667096833387, 17.111739257971436, 17.318375429759413, 16.906885767976433, 23.541502002626657, 23.36727499961853, 23.785875440808013, 21.565194732199103, 21.359842556218297, 21.547753649453313, 17.771090485155582, 17.394965805113316, 17.214817062020302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1421299103269951, "mean_inference_ms": 0.6426092130697613, "mean_action_processing_ms": 0.0946250577556135, "mean_env_wait_ms": 0.7973330129508437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 691200, "timesteps_this_iter": 0, "agent_timesteps_total": 2073600, "timers": {"sample_time_ms": 9023.681, "sample_throughput": 531.934, "load_time_ms": 0.1, "load_throughput": 48026381.679, "learn_time_ms": 1165.135, "learn_throughput": 4119.694, "update_time_ms": 1.602}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.946747362613678, "policy_loss": 0.000493170604976445, "vf_loss": 6.088747620582581, "vf_explained_var": 0.009263291954994202, "kl": 0.009474283026262777, "entropy": 14.33468747138977, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 691200, "num_agent_steps_sampled": 2073600, "num_steps_trained": 691200, "num_agent_steps_trained": 2073600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3233, "training_iteration": 144, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-05-04", "timestamp": 1706148304, "time_this_iter_s": 8.926852226257324, "time_total_s": 1344.291298866272, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1CA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1344.291298866272, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 10.283333333333331, "ram_util_percent": 46.849999999999994}}
{"episode_reward_max": 109.16371338441965, "episode_reward_min": 36.233207140117884, "episode_reward_mean": 72.1285470566951, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.021790824830532}, "policy_reward_max": {"shared_policy": 36.64887738848725}, "policy_reward_mean": {"shared_policy": 24.04284901889836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.9123888290487, 65.28221270814538, 74.99846455454825, 65.61607262119648, 65.24565419554709, 63.81392267718911, 84.86424472695217, 77.78270433843133, 89.99044038727878, 50.69945659674701, 74.85141506046057, 65.75615143030882, 79.36997305974364, 76.87612707912919, 77.70328571146818, 86.73301673308015, 73.84368340671062, 79.94423616677521, 68.90270249545574, 66.83537427335975, 93.42090371996164, 63.99346662685272, 76.32222564518449, 65.2504158243537, 92.8193979896605, 73.30039724335073, 79.24337856471537, 73.95772660709918, 68.37769535090771, 83.27884179027751, 66.8776198029518, 54.13861871697007, 67.4605192095041, 69.5536253005266, 74.93242717813698, 65.3177353516221, 90.99008976295589, 57.34317370131609, 73.46374716935678, 82.7288392782211, 66.48488260805604, 66.2719372306019, 71.11900606192647, 80.06903515383601, 73.96738710254431, 69.94282570108768, 81.72808691114187, 57.59871556982395, 75.16211306583133, 107.38549856096506, 104.73374715447424, 66.52447056025265, 91.82340689375997, 95.74458798766135, 61.47074260190129, 109.16371338441965, 78.1364014483988, 57.045302320271716, 69.19900071236768, 43.736193377524586, 80.89642959553747, 63.098290126770706, 76.92279433459044, 80.01104687154292, 96.89094096422193, 64.40934181213379, 51.61454552412033, 68.28264301503076, 68.32050077430904, 92.95612850040195, 71.76929669082163, 79.62031088257206, 91.91730798128992, 54.39673060178757, 56.03262552130036, 36.233207140117884, 85.31539010629058, 72.7167615108192, 65.17443842440844, 78.80420824885366, 51.33700045570728, 70.6946524430532, 64.47279093787071, 52.3808733522892, 55.55018643289803, 63.57571406662464, 71.1825352311134, 71.20154325291512, 69.29031363595276, 69.48837831430137, 74.45820227079092, 57.87733832979575, 64.4403915889561, 74.72595933824778, 78.24832357279955, 70.28977150842547, 60.972863491624565, 71.41313316766171, 81.28189420327541, 47.49047515593699], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.649665455023438, 22.471047806243092, 22.791675567782164, 21.435138002038002, 21.9441387206316, 21.90293598547578, 24.80012885232766, 24.901718561848, 25.29661714037259, 21.929314273099095, 21.57794306675592, 22.108815281341464, 21.475548689564064, 21.850572769840554, 21.91953273614247, 21.485160779207945, 21.275817029178143, 21.052944868803024, 27.921712934970856, 28.29989818483591, 28.6426336071454, 25.94257832566896, 25.858485410610825, 25.981640602151543, 30.20749148105581, 29.93924168994029, 29.84370721628268, 16.8947718484948, 17.02054592842856, 16.784138819823653, 24.732844933867455, 25.14292299002409, 24.975647136569023, 21.808355517685413, 21.886885568499565, 22.06091034412384, 26.64671114459634, 26.49157301336527, 26.231688901782036, 25.735544609526784, 25.702808919052273, 25.437773550550133, 25.67125191291173, 25.668862288196877, 26.363171510359578, 28.946212377399206, 28.72143080085516, 29.065373554825783, 24.607637211680412, 24.542400188744068, 24.693646006286144, 26.52018969257672, 26.82049573709567, 26.60355073710282, 23.046548582613468, 22.659810960292816, 23.196342952549458, 22.208780298630387, 22.32105745623508, 22.30553651849428, 31.28527471795678, 30.784888491034508, 31.350740510970354, 21.165740514794976, 21.379395114878804, 21.448330997178942, 25.425257364908845, 25.118421743313462, 25.778546536962182, 21.821826722472906, 21.677524231374264, 21.751064870506525, 30.694362744688988, 31.203264985233545, 30.92177025973797, 24.075862025221184, 24.60694496085246, 24.617590257277087, 26.288679738839463, 26.282419612010315, 26.672279213865593, 24.514650210738182, 24.852189237251878, 24.590887159109116, 22.80658797423044, 22.490713606278092, 23.080393770399183, 27.57660398632288, 27.5534133836627, 28.14882442029193, 22.549513799448803, 22.259400484462574, 22.06870551904042, 17.8626408179601, 17.661509936054543, 18.61446796295543, 22.24360458056131, 22.470266255239636, 22.746648373703152, 22.962129046519593, 23.2378607665499, 23.35363548745711, 24.901805172363908, 24.690184394518525, 25.340437611254544, 21.87109839823097, 21.83233279455453, 21.614304158836603, 30.523352855195597, 30.267619890471295, 30.199117017288998, 19.215517951796443, 19.077101717392594, 19.050554032127053, 24.83270990926151, 24.530714755256966, 24.100322504838303, 27.518377783397824, 27.81281105677286, 27.39765043805042, 22.32109739134708, 22.29301734517017, 21.87076787153879, 21.947973132133484, 22.082451920956373, 22.24151217751205, 23.604783688982323, 23.656557102998093, 23.857665269946054, 26.663103982806206, 26.679887011647224, 26.72604415938258, 24.52076581120491, 24.727272724732757, 24.71934856660664, 23.30902341256538, 23.1100615064303, 23.523740782092005, 27.11820474267006, 27.519604958593845, 27.090277209877968, 19.331902785847575, 19.33982716749111, 18.92698561648527, 24.92349575708309, 25.017368900279195, 25.22124840846905, 35.387237921357155, 36.0019049346447, 35.99635570496321, 34.725249504049614, 35.04347993185122, 34.96501771857341, 22.118417297800377, 22.474836123486355, 21.93121713896592, 30.439163640141487, 30.60246818512678, 30.781775068491697, 31.78538343062003, 31.93774053951104, 32.02146401753028, 20.060492500662804, 20.522427529096603, 20.887822572141886, 36.11385505149761, 36.40098094443479, 36.64887738848725, 25.664629871646554, 26.084426092604787, 26.38734548414746, 18.83466189851363, 19.038702381153897, 19.17193804060419, 23.047624463836343, 23.129885962737404, 23.02149028579393, 14.487602050105721, 14.311256940166146, 14.937334387252719, 26.99644388755162, 26.570546274383858, 27.32943943360199, 20.845810780922562, 21.21253344292441, 21.039945902923733, 25.813990861177444, 25.702998369932175, 25.405805103480816, 26.64848542710145, 26.948590715726212, 26.413970728715256, 31.982413629690797, 32.38356630007425, 32.52496103445688, 21.37787014245987, 21.551964730024338, 21.479506939649582, 16.76878134906292, 17.3596681766212, 17.486095998436213, 22.48471539964278, 22.918736983866737, 22.87919063152124, 22.466977551579475, 22.900189185515046, 22.953334037214518, 30.86643677453199, 31.025935451189667, 31.063756274680287, 23.633594517906502, 23.958111261328057, 24.177590911587075, 26.422886001567036, 26.78429835770899, 26.41312652329603, 30.544163815677166, 30.83319339249283, 30.539950773119926, 17.88194700330496, 18.297424159944057, 18.21735943853855, 18.47784409672022, 18.712338101118803, 18.84244332346134, 12.108951181173325, 12.102465134114027, 12.021790824830532, 28.289749041199684, 28.746366050094366, 28.27927501499653, 24.15104303508997, 24.34500465169549, 24.220713824033737, 21.5878347158432, 21.746925435960293, 21.839678272604942, 26.409535924593598, 26.348001355926186, 26.04667096833387, 17.111739257971436, 17.318375429759413, 16.906885767976433, 23.541502002626657, 23.36727499961853, 23.785875440808013, 21.565194732199103, 21.359842556218297, 21.547753649453313, 17.771090485155582, 17.394965805113316, 17.214817062020302, 18.355708253880337, 18.626211398591593, 18.5682667804261, 21.156554862856865, 21.201098568737507, 21.21806063503027, 23.922342265645653, 23.641777167717606, 23.618415797750146, 23.5962433690826, 23.764486009875924, 23.84081387395659, 23.255798487303153, 23.10620345299442, 22.928311695655182, 22.9481308311224, 23.556575817987323, 22.98367166519165, 24.83777181183298, 24.81148207498093, 24.80894838397701, 19.166142519563437, 19.285236120224, 19.425959690008312, 21.39629291494687, 21.403029320140675, 21.64106935386856, 25.02412226051092, 24.92765784263611, 24.774179235100746, 26.01715612163146, 25.961524312694863, 26.269643138473228, 23.790588822215796, 23.16473425924778, 23.3344484269619, 20.416305443892867, 20.28250804791847, 20.27404999981323, 23.99594098174323, 23.688540173073605, 23.728652012844876, 27.062822754184396, 26.858693758646638, 27.36037769044438, 15.865164865487401, 15.783751641089708, 15.841558649359882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420690273277746, "mean_inference_ms": 0.642517034264398, "mean_action_processing_ms": 0.09463069488698003, "mean_env_wait_ms": 0.7971365441254243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 696000, "timesteps_this_iter": 0, "agent_timesteps_total": 2088000, "timers": {"sample_time_ms": 9018.064, "sample_throughput": 532.265, "load_time_ms": 0.1, "load_throughput": 48026381.679, "learn_time_ms": 1166.935, "learn_throughput": 4113.339, "update_time_ms": 1.602}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.398604452610016, "policy_loss": 0.0003874673517485494, "vf_loss": 5.54047703742981, "vf_explained_var": -0.0017258226871490479, "kl": 0.010487368621593862, "entropy": 14.320482730865479, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 696000, "num_agent_steps_sampled": 2088000, "num_steps_trained": 696000, "num_agent_steps_trained": 2088000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3249, "training_iteration": 145, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-05-13", "timestamp": 1706148313, "time_this_iter_s": 8.995753049850464, "time_total_s": 1353.2870519161224, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632F99D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1353.2870519161224, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 7.461538461538461, "ram_util_percent": 46.93846153846153}}
{"episode_reward_max": 109.16371338441965, "episode_reward_min": 36.233207140117884, "episode_reward_mean": 71.69938816671929, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.021790824830532}, "policy_reward_max": {"shared_policy": 36.64887738848725}, "policy_reward_mean": {"shared_policy": 23.89979605557309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.84368340671062, 79.94423616677521, 68.90270249545574, 66.83537427335975, 93.42090371996164, 63.99346662685272, 76.32222564518449, 65.2504158243537, 92.8193979896605, 73.30039724335073, 79.24337856471537, 73.95772660709918, 68.37769535090771, 83.27884179027751, 66.8776198029518, 54.13861871697007, 67.4605192095041, 69.5536253005266, 74.93242717813698, 65.3177353516221, 90.99008976295589, 57.34317370131609, 73.46374716935678, 82.7288392782211, 66.48488260805604, 66.2719372306019, 71.11900606192647, 80.06903515383601, 73.96738710254431, 69.94282570108768, 81.72808691114187, 57.59871556982395, 75.16211306583133, 107.38549856096506, 104.73374715447424, 66.52447056025265, 91.82340689375997, 95.74458798766135, 61.47074260190129, 109.16371338441965, 78.1364014483988, 57.045302320271716, 69.19900071236768, 43.736193377524586, 80.89642959553747, 63.098290126770706, 76.92279433459044, 80.01104687154292, 96.89094096422193, 64.40934181213379, 51.61454552412033, 68.28264301503076, 68.32050077430904, 92.95612850040195, 71.76929669082163, 79.62031088257206, 91.91730798128992, 54.39673060178757, 56.03262552130036, 36.233207140117884, 85.31539010629058, 72.7167615108192, 65.17443842440844, 78.80420824885366, 51.33700045570728, 70.6946524430532, 64.47279093787071, 52.3808733522892, 55.55018643289803, 63.57571406662464, 71.1825352311134, 71.20154325291512, 69.29031363595276, 69.48837831430137, 74.45820227079092, 57.87733832979575, 64.4403915889561, 74.72595933824778, 78.24832357279955, 70.28977150842547, 60.972863491624565, 71.41313316766171, 81.28189420327541, 47.49047515593699, 54.282346984371515, 65.51699115335938, 82.17304202090597, 58.667651921510696, 68.15628799796103, 65.04888451844452, 73.29014457389712, 59.272703506052494, 60.751126293092966, 79.0610038973391, 60.75030229240653, 71.51187216863036, 60.36834281275513, 89.87181171774863, 73.87911860272285, 101.97801125049591], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.607637211680412, 24.542400188744068, 24.693646006286144, 26.52018969257672, 26.82049573709567, 26.60355073710282, 23.046548582613468, 22.659810960292816, 23.196342952549458, 22.208780298630387, 22.32105745623508, 22.30553651849428, 31.28527471795678, 30.784888491034508, 31.350740510970354, 21.165740514794976, 21.379395114878804, 21.448330997178942, 25.425257364908845, 25.118421743313462, 25.778546536962182, 21.821826722472906, 21.677524231374264, 21.751064870506525, 30.694362744688988, 31.203264985233545, 30.92177025973797, 24.075862025221184, 24.60694496085246, 24.617590257277087, 26.288679738839463, 26.282419612010315, 26.672279213865593, 24.514650210738182, 24.852189237251878, 24.590887159109116, 22.80658797423044, 22.490713606278092, 23.080393770399183, 27.57660398632288, 27.5534133836627, 28.14882442029193, 22.549513799448803, 22.259400484462574, 22.06870551904042, 17.8626408179601, 17.661509936054543, 18.61446796295543, 22.24360458056131, 22.470266255239636, 22.746648373703152, 22.962129046519593, 23.2378607665499, 23.35363548745711, 24.901805172363908, 24.690184394518525, 25.340437611254544, 21.87109839823097, 21.83233279455453, 21.614304158836603, 30.523352855195597, 30.267619890471295, 30.199117017288998, 19.215517951796443, 19.077101717392594, 19.050554032127053, 24.83270990926151, 24.530714755256966, 24.100322504838303, 27.518377783397824, 27.81281105677286, 27.39765043805042, 22.32109739134708, 22.29301734517017, 21.87076787153879, 21.947973132133484, 22.082451920956373, 22.24151217751205, 23.604783688982323, 23.656557102998093, 23.857665269946054, 26.663103982806206, 26.679887011647224, 26.72604415938258, 24.52076581120491, 24.727272724732757, 24.71934856660664, 23.30902341256538, 23.1100615064303, 23.523740782092005, 27.11820474267006, 27.519604958593845, 27.090277209877968, 19.331902785847575, 19.33982716749111, 18.92698561648527, 24.92349575708309, 25.017368900279195, 25.22124840846905, 35.387237921357155, 36.0019049346447, 35.99635570496321, 34.725249504049614, 35.04347993185122, 34.96501771857341, 22.118417297800377, 22.474836123486355, 21.93121713896592, 30.439163640141487, 30.60246818512678, 30.781775068491697, 31.78538343062003, 31.93774053951104, 32.02146401753028, 20.060492500662804, 20.522427529096603, 20.887822572141886, 36.11385505149761, 36.40098094443479, 36.64887738848725, 25.664629871646554, 26.084426092604787, 26.38734548414746, 18.83466189851363, 19.038702381153897, 19.17193804060419, 23.047624463836343, 23.129885962737404, 23.02149028579393, 14.487602050105721, 14.311256940166146, 14.937334387252719, 26.99644388755162, 26.570546274383858, 27.32943943360199, 20.845810780922562, 21.21253344292441, 21.039945902923733, 25.813990861177444, 25.702998369932175, 25.405805103480816, 26.64848542710145, 26.948590715726212, 26.413970728715256, 31.982413629690797, 32.38356630007425, 32.52496103445688, 21.37787014245987, 21.551964730024338, 21.479506939649582, 16.76878134906292, 17.3596681766212, 17.486095998436213, 22.48471539964278, 22.918736983866737, 22.87919063152124, 22.466977551579475, 22.900189185515046, 22.953334037214518, 30.86643677453199, 31.025935451189667, 31.063756274680287, 23.633594517906502, 23.958111261328057, 24.177590911587075, 26.422886001567036, 26.78429835770899, 26.41312652329603, 30.544163815677166, 30.83319339249283, 30.539950773119926, 17.88194700330496, 18.297424159944057, 18.21735943853855, 18.47784409672022, 18.712338101118803, 18.84244332346134, 12.108951181173325, 12.102465134114027, 12.021790824830532, 28.289749041199684, 28.746366050094366, 28.27927501499653, 24.15104303508997, 24.34500465169549, 24.220713824033737, 21.5878347158432, 21.746925435960293, 21.839678272604942, 26.409535924593598, 26.348001355926186, 26.04667096833387, 17.111739257971436, 17.318375429759413, 16.906885767976433, 23.541502002626657, 23.36727499961853, 23.785875440808013, 21.565194732199103, 21.359842556218297, 21.547753649453313, 17.771090485155582, 17.394965805113316, 17.214817062020302, 18.355708253880337, 18.626211398591593, 18.5682667804261, 21.156554862856865, 21.201098568737507, 21.21806063503027, 23.922342265645653, 23.641777167717606, 23.618415797750146, 23.5962433690826, 23.764486009875924, 23.84081387395659, 23.255798487303153, 23.10620345299442, 22.928311695655182, 22.9481308311224, 23.556575817987323, 22.98367166519165, 24.83777181183298, 24.81148207498093, 24.80894838397701, 19.166142519563437, 19.285236120224, 19.425959690008312, 21.39629291494687, 21.403029320140675, 21.64106935386856, 25.02412226051092, 24.92765784263611, 24.774179235100746, 26.01715612163146, 25.961524312694863, 26.269643138473228, 23.790588822215796, 23.16473425924778, 23.3344484269619, 20.416305443892867, 20.28250804791847, 20.27404999981323, 23.99594098174323, 23.688540173073605, 23.728652012844876, 27.062822754184396, 26.858693758646638, 27.36037769044438, 15.865164865487401, 15.783751641089708, 15.841558649359882, 18.08169105152288, 18.256143108631164, 17.94451282421747, 21.810975181559712, 21.752214464048535, 21.953801507751137, 26.97706628839174, 27.43175871918598, 27.76421701332825, 19.675630301237106, 19.696064114570618, 19.295957505702972, 22.436162417133644, 22.857300636668995, 22.86282494415839, 21.961843406160668, 21.422657181819275, 21.66438393046458, 24.309325471520424, 24.26374788582325, 24.71707121655345, 19.78125811740756, 19.7083303257823, 19.783115062862635, 20.44258252903819, 19.85643680393696, 20.452106960117817, 26.92410022392869, 26.366646945476532, 25.770256727933884, 20.267406264940888, 20.18048872301975, 20.302407304445893, 23.90474759042263, 23.55937048792839, 24.04775409027934, 20.06653820102413, 20.035689798494175, 20.266114813236825, 29.74050400157769, 30.180819158752755, 29.950488557418183, 24.42725825558105, 24.73994435245791, 24.711915994683892, 34.020630694925785, 34.02004936337471, 33.937331192195415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14200782016271263, "mean_inference_ms": 0.6424326753809143, "mean_action_processing_ms": 0.0946352374560411, "mean_env_wait_ms": 0.7969400991413313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 700800, "timesteps_this_iter": 0, "agent_timesteps_total": 2102400, "timers": {"sample_time_ms": 9033.87, "sample_throughput": 531.334, "load_time_ms": 0.2, "load_throughput": 23996018.117, "learn_time_ms": 1169.143, "learn_throughput": 4105.572, "update_time_ms": 1.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.183977782726288, "policy_loss": 0.0018585469128564736, "vf_loss": 6.3267141580581665, "vf_explained_var": 0.005668148398399353, "kl": 0.014176541823167658, "entropy": 14.587239742279053, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700800, "num_agent_steps_sampled": 2102400, "num_steps_trained": 700800, "num_agent_steps_trained": 2102400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3265, "training_iteration": 146, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-05-22", "timestamp": 1706148322, "time_this_iter_s": 9.026736974716187, "time_total_s": 1362.3137888908386, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004664C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1362.3137888908386, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 7.43076923076923, "ram_util_percent": 46.95384615384616}}
{"episode_reward_max": 109.16371338441965, "episode_reward_min": 36.233207140117884, "episode_reward_mean": 71.58696676674037, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.021790824830532}, "policy_reward_max": {"shared_policy": 36.64887738848725}, "policy_reward_mean": {"shared_policy": 23.862322255580118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.4605192095041, 69.5536253005266, 74.93242717813698, 65.3177353516221, 90.99008976295589, 57.34317370131609, 73.46374716935678, 82.7288392782211, 66.48488260805604, 66.2719372306019, 71.11900606192647, 80.06903515383601, 73.96738710254431, 69.94282570108768, 81.72808691114187, 57.59871556982395, 75.16211306583133, 107.38549856096506, 104.73374715447424, 66.52447056025265, 91.82340689375997, 95.74458798766135, 61.47074260190129, 109.16371338441965, 78.1364014483988, 57.045302320271716, 69.19900071236768, 43.736193377524586, 80.89642959553747, 63.098290126770706, 76.92279433459044, 80.01104687154292, 96.89094096422193, 64.40934181213379, 51.61454552412033, 68.28264301503076, 68.32050077430904, 92.95612850040195, 71.76929669082163, 79.62031088257206, 91.91730798128992, 54.39673060178757, 56.03262552130036, 36.233207140117884, 85.31539010629058, 72.7167615108192, 65.17443842440844, 78.80420824885366, 51.33700045570728, 70.6946524430532, 64.47279093787071, 52.3808733522892, 55.55018643289803, 63.57571406662464, 71.1825352311134, 71.20154325291512, 69.29031363595276, 69.48837831430137, 74.45820227079092, 57.87733832979575, 64.4403915889561, 74.72595933824778, 78.24832357279955, 70.28977150842547, 60.972863491624565, 71.41313316766171, 81.28189420327541, 47.49047515593699, 54.282346984371515, 65.51699115335938, 82.17304202090597, 58.667651921510696, 68.15628799796103, 65.04888451844452, 73.29014457389712, 59.272703506052494, 60.751126293092966, 79.0610038973391, 60.75030229240653, 71.51187216863036, 60.36834281275513, 89.87181171774863, 73.87911860272285, 101.97801125049591, 53.40049931406972, 103.59353131428358, 62.23035270813851, 56.97168755531308, 86.43108974024653, 73.87659045308828, 80.8334105592221, 72.45993274264036, 61.556043632328496, 56.16871596872805, 93.08483406528829, 62.06835542246698, 75.2271035388112, 60.19378851354119, 87.06799570843575, 84.10061299009249], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.24360458056131, 22.470266255239636, 22.746648373703152, 22.962129046519593, 23.2378607665499, 23.35363548745711, 24.901805172363908, 24.690184394518525, 25.340437611254544, 21.87109839823097, 21.83233279455453, 21.614304158836603, 30.523352855195597, 30.267619890471295, 30.199117017288998, 19.215517951796443, 19.077101717392594, 19.050554032127053, 24.83270990926151, 24.530714755256966, 24.100322504838303, 27.518377783397824, 27.81281105677286, 27.39765043805042, 22.32109739134708, 22.29301734517017, 21.87076787153879, 21.947973132133484, 22.082451920956373, 22.24151217751205, 23.604783688982323, 23.656557102998093, 23.857665269946054, 26.663103982806206, 26.679887011647224, 26.72604415938258, 24.52076581120491, 24.727272724732757, 24.71934856660664, 23.30902341256538, 23.1100615064303, 23.523740782092005, 27.11820474267006, 27.519604958593845, 27.090277209877968, 19.331902785847575, 19.33982716749111, 18.92698561648527, 24.92349575708309, 25.017368900279195, 25.22124840846905, 35.387237921357155, 36.0019049346447, 35.99635570496321, 34.725249504049614, 35.04347993185122, 34.96501771857341, 22.118417297800377, 22.474836123486355, 21.93121713896592, 30.439163640141487, 30.60246818512678, 30.781775068491697, 31.78538343062003, 31.93774053951104, 32.02146401753028, 20.060492500662804, 20.522427529096603, 20.887822572141886, 36.11385505149761, 36.40098094443479, 36.64887738848725, 25.664629871646554, 26.084426092604787, 26.38734548414746, 18.83466189851363, 19.038702381153897, 19.17193804060419, 23.047624463836343, 23.129885962737404, 23.02149028579393, 14.487602050105721, 14.311256940166146, 14.937334387252719, 26.99644388755162, 26.570546274383858, 27.32943943360199, 20.845810780922562, 21.21253344292441, 21.039945902923733, 25.813990861177444, 25.702998369932175, 25.405805103480816, 26.64848542710145, 26.948590715726212, 26.413970728715256, 31.982413629690797, 32.38356630007425, 32.52496103445688, 21.37787014245987, 21.551964730024338, 21.479506939649582, 16.76878134906292, 17.3596681766212, 17.486095998436213, 22.48471539964278, 22.918736983866737, 22.87919063152124, 22.466977551579475, 22.900189185515046, 22.953334037214518, 30.86643677453199, 31.025935451189667, 31.063756274680287, 23.633594517906502, 23.958111261328057, 24.177590911587075, 26.422886001567036, 26.78429835770899, 26.41312652329603, 30.544163815677166, 30.83319339249283, 30.539950773119926, 17.88194700330496, 18.297424159944057, 18.21735943853855, 18.47784409672022, 18.712338101118803, 18.84244332346134, 12.108951181173325, 12.102465134114027, 12.021790824830532, 28.289749041199684, 28.746366050094366, 28.27927501499653, 24.15104303508997, 24.34500465169549, 24.220713824033737, 21.5878347158432, 21.746925435960293, 21.839678272604942, 26.409535924593598, 26.348001355926186, 26.04667096833387, 17.111739257971436, 17.318375429759413, 16.906885767976433, 23.541502002626657, 23.36727499961853, 23.785875440808013, 21.565194732199103, 21.359842556218297, 21.547753649453313, 17.771090485155582, 17.394965805113316, 17.214817062020302, 18.355708253880337, 18.626211398591593, 18.5682667804261, 21.156554862856865, 21.201098568737507, 21.21806063503027, 23.922342265645653, 23.641777167717606, 23.618415797750146, 23.5962433690826, 23.764486009875924, 23.84081387395659, 23.255798487303153, 23.10620345299442, 22.928311695655182, 22.9481308311224, 23.556575817987323, 22.98367166519165, 24.83777181183298, 24.81148207498093, 24.80894838397701, 19.166142519563437, 19.285236120224, 19.425959690008312, 21.39629291494687, 21.403029320140675, 21.64106935386856, 25.02412226051092, 24.92765784263611, 24.774179235100746, 26.01715612163146, 25.961524312694863, 26.269643138473228, 23.790588822215796, 23.16473425924778, 23.3344484269619, 20.416305443892867, 20.28250804791847, 20.27404999981323, 23.99594098174323, 23.688540173073605, 23.728652012844876, 27.062822754184396, 26.858693758646638, 27.36037769044438, 15.865164865487401, 15.783751641089708, 15.841558649359882, 18.08169105152288, 18.256143108631164, 17.94451282421747, 21.810975181559712, 21.752214464048535, 21.953801507751137, 26.97706628839174, 27.43175871918598, 27.76421701332825, 19.675630301237106, 19.696064114570618, 19.295957505702972, 22.436162417133644, 22.857300636668995, 22.86282494415839, 21.961843406160668, 21.422657181819275, 21.66438393046458, 24.309325471520424, 24.26374788582325, 24.71707121655345, 19.78125811740756, 19.7083303257823, 19.783115062862635, 20.44258252903819, 19.85643680393696, 20.452106960117817, 26.92410022392869, 26.366646945476532, 25.770256727933884, 20.267406264940888, 20.18048872301975, 20.302407304445893, 23.90474759042263, 23.55937048792839, 24.04775409027934, 20.06653820102413, 20.035689798494175, 20.266114813236825, 29.74050400157769, 30.180819158752755, 29.950488557418183, 24.42725825558105, 24.73994435245791, 24.711915994683892, 34.020630694925785, 34.02004936337471, 33.937331192195415, 17.71522199610868, 17.85243535755822, 17.832841960402817, 34.60836675266424, 34.416992908964545, 34.5681716526548, 21.146585529980555, 20.621766683955983, 20.462000494201973, 18.864322687188775, 18.624513680736214, 19.482851187388093, 28.697003960609436, 28.91178278811276, 28.82230299152434, 24.76664547622204, 24.413446828722954, 24.69649814814329, 26.81372930109501, 26.685574769973755, 27.33410648815334, 24.1352144939204, 24.047691759963826, 24.277026488756135, 20.214586695035294, 20.61637620379527, 20.725080733497933, 18.584968527158097, 18.59975792964299, 18.983989511926964, 30.672938009103135, 31.29889527832468, 31.113000777860478, 20.514110346635178, 20.921353363742426, 20.632891712089375, 25.275094263255596, 24.973457880318165, 24.978551395237446, 19.951892393330724, 19.956727149585873, 20.285168970624596, 28.897680709759385, 28.799087623755128, 29.371227374921233, 28.268623534124345, 27.695657767355442, 28.1363316886127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14196005249773538, "mean_inference_ms": 0.6424344725024173, "mean_action_processing_ms": 0.09463463168017888, "mean_env_wait_ms": 0.7968243181277357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 705600, "timesteps_this_iter": 0, "agent_timesteps_total": 2116800, "timers": {"sample_time_ms": 9136.296, "sample_throughput": 525.377, "load_time_ms": 0.201, "load_throughput": 23899168.091, "learn_time_ms": 1184.075, "learn_throughput": 4053.797, "update_time_ms": 1.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 7.0576722621917725, "policy_loss": 0.001391107865282848, "vf_loss": 7.19944167137146, "vf_explained_var": 0.011821098625659943, "kl": 0.012537077069482698, "entropy": 14.42901599407196, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 705600, "num_agent_steps_sampled": 2116800, "num_steps_trained": 705600, "num_agent_steps_trained": 2116800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3281, "training_iteration": 147, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-05-32", "timestamp": 1706148332, "time_this_iter_s": 10.10472297668457, "time_total_s": 1372.4185118675232, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000466EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1372.4185118675232, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 9.22142857142857, "ram_util_percent": 47.24285714285714}}
{"episode_reward_max": 109.16371338441965, "episode_reward_min": 36.233207140117884, "episode_reward_mean": 71.92559169095213, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.021790824830532}, "policy_reward_max": {"shared_policy": 36.64887738848725}, "policy_reward_mean": {"shared_policy": 23.97519723031737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.16211306583133, 107.38549856096506, 104.73374715447424, 66.52447056025265, 91.82340689375997, 95.74458798766135, 61.47074260190129, 109.16371338441965, 78.1364014483988, 57.045302320271716, 69.19900071236768, 43.736193377524586, 80.89642959553747, 63.098290126770706, 76.92279433459044, 80.01104687154292, 96.89094096422193, 64.40934181213379, 51.61454552412033, 68.28264301503076, 68.32050077430904, 92.95612850040195, 71.76929669082163, 79.62031088257206, 91.91730798128992, 54.39673060178757, 56.03262552130036, 36.233207140117884, 85.31539010629058, 72.7167615108192, 65.17443842440844, 78.80420824885366, 51.33700045570728, 70.6946524430532, 64.47279093787071, 52.3808733522892, 55.55018643289803, 63.57571406662464, 71.1825352311134, 71.20154325291512, 69.29031363595276, 69.48837831430137, 74.45820227079092, 57.87733832979575, 64.4403915889561, 74.72595933824778, 78.24832357279955, 70.28977150842547, 60.972863491624565, 71.41313316766171, 81.28189420327541, 47.49047515593699, 54.282346984371515, 65.51699115335938, 82.17304202090597, 58.667651921510696, 68.15628799796103, 65.04888451844452, 73.29014457389712, 59.272703506052494, 60.751126293092966, 79.0610038973391, 60.75030229240653, 71.51187216863036, 60.36834281275513, 89.87181171774863, 73.87911860272285, 101.97801125049591, 53.40049931406972, 103.59353131428358, 62.23035270813851, 56.97168755531308, 86.43108974024653, 73.87659045308828, 80.8334105592221, 72.45993274264036, 61.556043632328496, 56.16871596872805, 93.08483406528829, 62.06835542246698, 75.2271035388112, 60.19378851354119, 87.06799570843575, 84.10061299009249, 50.64742602966723, 78.08402167260645, 94.14859557803719, 62.396593507379265, 79.14016202371567, 36.49991714954375, 58.974184703081846, 86.6772877573967, 74.12930587120354, 76.32458143308759, 74.16670910269019, 70.37286296486855, 103.22063512168823, 78.67415902763605, 83.00817622616884, 76.36990754306314], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.92349575708309, 25.017368900279195, 25.22124840846905, 35.387237921357155, 36.0019049346447, 35.99635570496321, 34.725249504049614, 35.04347993185122, 34.96501771857341, 22.118417297800377, 22.474836123486355, 21.93121713896592, 30.439163640141487, 30.60246818512678, 30.781775068491697, 31.78538343062003, 31.93774053951104, 32.02146401753028, 20.060492500662804, 20.522427529096603, 20.887822572141886, 36.11385505149761, 36.40098094443479, 36.64887738848725, 25.664629871646554, 26.084426092604787, 26.38734548414746, 18.83466189851363, 19.038702381153897, 19.17193804060419, 23.047624463836343, 23.129885962737404, 23.02149028579393, 14.487602050105721, 14.311256940166146, 14.937334387252719, 26.99644388755162, 26.570546274383858, 27.32943943360199, 20.845810780922562, 21.21253344292441, 21.039945902923733, 25.813990861177444, 25.702998369932175, 25.405805103480816, 26.64848542710145, 26.948590715726212, 26.413970728715256, 31.982413629690797, 32.38356630007425, 32.52496103445688, 21.37787014245987, 21.551964730024338, 21.479506939649582, 16.76878134906292, 17.3596681766212, 17.486095998436213, 22.48471539964278, 22.918736983866737, 22.87919063152124, 22.466977551579475, 22.900189185515046, 22.953334037214518, 30.86643677453199, 31.025935451189667, 31.063756274680287, 23.633594517906502, 23.958111261328057, 24.177590911587075, 26.422886001567036, 26.78429835770899, 26.41312652329603, 30.544163815677166, 30.83319339249283, 30.539950773119926, 17.88194700330496, 18.297424159944057, 18.21735943853855, 18.47784409672022, 18.712338101118803, 18.84244332346134, 12.108951181173325, 12.102465134114027, 12.021790824830532, 28.289749041199684, 28.746366050094366, 28.27927501499653, 24.15104303508997, 24.34500465169549, 24.220713824033737, 21.5878347158432, 21.746925435960293, 21.839678272604942, 26.409535924593598, 26.348001355926186, 26.04667096833387, 17.111739257971436, 17.318375429759413, 16.906885767976433, 23.541502002626657, 23.36727499961853, 23.785875440808013, 21.565194732199103, 21.359842556218297, 21.547753649453313, 17.771090485155582, 17.394965805113316, 17.214817062020302, 18.355708253880337, 18.626211398591593, 18.5682667804261, 21.156554862856865, 21.201098568737507, 21.21806063503027, 23.922342265645653, 23.641777167717606, 23.618415797750146, 23.5962433690826, 23.764486009875924, 23.84081387395659, 23.255798487303153, 23.10620345299442, 22.928311695655182, 22.9481308311224, 23.556575817987323, 22.98367166519165, 24.83777181183298, 24.81148207498093, 24.80894838397701, 19.166142519563437, 19.285236120224, 19.425959690008312, 21.39629291494687, 21.403029320140675, 21.64106935386856, 25.02412226051092, 24.92765784263611, 24.774179235100746, 26.01715612163146, 25.961524312694863, 26.269643138473228, 23.790588822215796, 23.16473425924778, 23.3344484269619, 20.416305443892867, 20.28250804791847, 20.27404999981323, 23.99594098174323, 23.688540173073605, 23.728652012844876, 27.062822754184396, 26.858693758646638, 27.36037769044438, 15.865164865487401, 15.783751641089708, 15.841558649359882, 18.08169105152288, 18.256143108631164, 17.94451282421747, 21.810975181559712, 21.752214464048535, 21.953801507751137, 26.97706628839174, 27.43175871918598, 27.76421701332825, 19.675630301237106, 19.696064114570618, 19.295957505702972, 22.436162417133644, 22.857300636668995, 22.86282494415839, 21.961843406160668, 21.422657181819275, 21.66438393046458, 24.309325471520424, 24.26374788582325, 24.71707121655345, 19.78125811740756, 19.7083303257823, 19.783115062862635, 20.44258252903819, 19.85643680393696, 20.452106960117817, 26.92410022392869, 26.366646945476532, 25.770256727933884, 20.267406264940888, 20.18048872301975, 20.302407304445893, 23.90474759042263, 23.55937048792839, 24.04775409027934, 20.06653820102413, 20.035689798494175, 20.266114813236825, 29.74050400157769, 30.180819158752755, 29.950488557418183, 24.42725825558105, 24.73994435245791, 24.711915994683892, 34.020630694925785, 34.02004936337471, 33.937331192195415, 17.71522199610868, 17.85243535755822, 17.832841960402817, 34.60836675266424, 34.416992908964545, 34.5681716526548, 21.146585529980555, 20.621766683955983, 20.462000494201973, 18.864322687188775, 18.624513680736214, 19.482851187388093, 28.697003960609436, 28.91178278811276, 28.82230299152434, 24.76664547622204, 24.413446828722954, 24.69649814814329, 26.81372930109501, 26.685574769973755, 27.33410648815334, 24.1352144939204, 24.047691759963826, 24.277026488756135, 20.214586695035294, 20.61637620379527, 20.725080733497933, 18.584968527158097, 18.59975792964299, 18.983989511926964, 30.672938009103135, 31.29889527832468, 31.113000777860478, 20.514110346635178, 20.921353363742426, 20.632891712089375, 25.275094263255596, 24.973457880318165, 24.978551395237446, 19.951892393330724, 19.956727149585873, 20.285168970624596, 28.897680709759385, 28.799087623755128, 29.371227374921233, 28.268623534124345, 27.695657767355442, 28.1363316886127, 16.718216220537812, 17.088737011576683, 16.840472797552735, 25.903065358599022, 26.100244731952742, 26.08071158205469, 31.20558402438958, 31.384645131727055, 31.558366421920553, 20.752251012871653, 20.854603382448346, 20.789739112059266, 26.238457575440407, 26.29509212076664, 26.60661232750863, 12.219810975094632, 12.035643388827637, 12.24446278562148, 19.669071663171053, 19.84303741157055, 19.462075628340244, 28.928329546004534, 29.000330951064825, 28.74862726032734, 24.768809150904417, 24.570003241300583, 24.790493478998542, 25.290026634931564, 25.538274858146906, 25.496279940009117, 24.697999144593865, 24.673396098117024, 24.795313859979302, 23.46288710832596, 23.325456641614437, 23.58451921492815, 34.16442101200421, 34.60728349474569, 34.448930614938334, 26.137747384607792, 26.296001330018044, 26.240410313010216, 27.60178121055165, 27.688891946027667, 27.717503069589526, 25.289549897114426, 25.574019024769456, 25.506338621179253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14193105733612965, "mean_inference_ms": 0.6425574651964945, "mean_action_processing_ms": 0.09465859639405039, "mean_env_wait_ms": 0.7967551917758294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 710400, "timesteps_this_iter": 0, "agent_timesteps_total": 2131200, "timers": {"sample_time_ms": 9251.322, "sample_throughput": 518.845, "load_time_ms": 0.301, "load_throughput": 15959301.784, "learn_time_ms": 1188.281, "learn_throughput": 4039.45, "update_time_ms": 1.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.883426308631897, "policy_loss": -0.0013022787620302623, "vf_loss": 6.029793679714203, "vf_explained_var": 0.0011190623044967651, "kl": 0.008835094457492577, "entropy": 14.586118936538696, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 710400, "num_agent_steps_sampled": 2131200, "num_steps_trained": 710400, "num_agent_steps_trained": 2131200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3297, "training_iteration": 148, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-05-43", "timestamp": 1706148343, "time_this_iter_s": 10.0004723072052, "time_total_s": 1382.4189841747284, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1382.4189841747284, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 7.457142857142856, "ram_util_percent": 47.42857142857143}}
{"episode_reward_max": 103.59353131428358, "episode_reward_min": 36.233207140117884, "episode_reward_mean": 71.52050760323735, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.021790824830532}, "policy_reward_max": {"shared_policy": 34.60836675266424}, "policy_reward_mean": {"shared_policy": 23.84016920107911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.89094096422193, 64.40934181213379, 51.61454552412033, 68.28264301503076, 68.32050077430904, 92.95612850040195, 71.76929669082163, 79.62031088257206, 91.91730798128992, 54.39673060178757, 56.03262552130036, 36.233207140117884, 85.31539010629058, 72.7167615108192, 65.17443842440844, 78.80420824885366, 51.33700045570728, 70.6946524430532, 64.47279093787071, 52.3808733522892, 55.55018643289803, 63.57571406662464, 71.1825352311134, 71.20154325291512, 69.29031363595276, 69.48837831430137, 74.45820227079092, 57.87733832979575, 64.4403915889561, 74.72595933824778, 78.24832357279955, 70.28977150842547, 60.972863491624565, 71.41313316766171, 81.28189420327541, 47.49047515593699, 54.282346984371515, 65.51699115335938, 82.17304202090597, 58.667651921510696, 68.15628799796103, 65.04888451844452, 73.29014457389712, 59.272703506052494, 60.751126293092966, 79.0610038973391, 60.75030229240653, 71.51187216863036, 60.36834281275513, 89.87181171774863, 73.87911860272285, 101.97801125049591, 53.40049931406972, 103.59353131428358, 62.23035270813851, 56.97168755531308, 86.43108974024653, 73.87659045308828, 80.8334105592221, 72.45993274264036, 61.556043632328496, 56.16871596872805, 93.08483406528829, 62.06835542246698, 75.2271035388112, 60.19378851354119, 87.06799570843575, 84.10061299009249, 50.64742602966723, 78.08402167260645, 94.14859557803719, 62.396593507379265, 79.14016202371567, 36.49991714954375, 58.974184703081846, 86.6772877573967, 74.12930587120354, 76.32458143308759, 74.16670910269019, 70.37286296486855, 103.22063512168823, 78.67415902763605, 83.00817622616884, 76.36990754306314, 57.15957409888506, 84.25435442477463, 81.9808097705245, 72.99697679467498, 89.75929946824908, 92.16571982391177, 69.79235883429644, 64.70999250560997, 59.31535996496676, 96.39886450045742, 83.6039191931486, 66.97448675706981, 99.58744175359607, 53.95782908424734, 63.48532465379685, 84.4030185965821], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [31.982413629690797, 32.38356630007425, 32.52496103445688, 21.37787014245987, 21.551964730024338, 21.479506939649582, 16.76878134906292, 17.3596681766212, 17.486095998436213, 22.48471539964278, 22.918736983866737, 22.87919063152124, 22.466977551579475, 22.900189185515046, 22.953334037214518, 30.86643677453199, 31.025935451189667, 31.063756274680287, 23.633594517906502, 23.958111261328057, 24.177590911587075, 26.422886001567036, 26.78429835770899, 26.41312652329603, 30.544163815677166, 30.83319339249283, 30.539950773119926, 17.88194700330496, 18.297424159944057, 18.21735943853855, 18.47784409672022, 18.712338101118803, 18.84244332346134, 12.108951181173325, 12.102465134114027, 12.021790824830532, 28.289749041199684, 28.746366050094366, 28.27927501499653, 24.15104303508997, 24.34500465169549, 24.220713824033737, 21.5878347158432, 21.746925435960293, 21.839678272604942, 26.409535924593598, 26.348001355926186, 26.04667096833387, 17.111739257971436, 17.318375429759413, 16.906885767976433, 23.541502002626657, 23.36727499961853, 23.785875440808013, 21.565194732199103, 21.359842556218297, 21.547753649453313, 17.771090485155582, 17.394965805113316, 17.214817062020302, 18.355708253880337, 18.626211398591593, 18.5682667804261, 21.156554862856865, 21.201098568737507, 21.21806063503027, 23.922342265645653, 23.641777167717606, 23.618415797750146, 23.5962433690826, 23.764486009875924, 23.84081387395659, 23.255798487303153, 23.10620345299442, 22.928311695655182, 22.9481308311224, 23.556575817987323, 22.98367166519165, 24.83777181183298, 24.81148207498093, 24.80894838397701, 19.166142519563437, 19.285236120224, 19.425959690008312, 21.39629291494687, 21.403029320140675, 21.64106935386856, 25.02412226051092, 24.92765784263611, 24.774179235100746, 26.01715612163146, 25.961524312694863, 26.269643138473228, 23.790588822215796, 23.16473425924778, 23.3344484269619, 20.416305443892867, 20.28250804791847, 20.27404999981323, 23.99594098174323, 23.688540173073605, 23.728652012844876, 27.062822754184396, 26.858693758646638, 27.36037769044438, 15.865164865487401, 15.783751641089708, 15.841558649359882, 18.08169105152288, 18.256143108631164, 17.94451282421747, 21.810975181559712, 21.752214464048535, 21.953801507751137, 26.97706628839174, 27.43175871918598, 27.76421701332825, 19.675630301237106, 19.696064114570618, 19.295957505702972, 22.436162417133644, 22.857300636668995, 22.86282494415839, 21.961843406160668, 21.422657181819275, 21.66438393046458, 24.309325471520424, 24.26374788582325, 24.71707121655345, 19.78125811740756, 19.7083303257823, 19.783115062862635, 20.44258252903819, 19.85643680393696, 20.452106960117817, 26.92410022392869, 26.366646945476532, 25.770256727933884, 20.267406264940888, 20.18048872301975, 20.302407304445893, 23.90474759042263, 23.55937048792839, 24.04775409027934, 20.06653820102413, 20.035689798494175, 20.266114813236825, 29.74050400157769, 30.180819158752755, 29.950488557418183, 24.42725825558105, 24.73994435245791, 24.711915994683892, 34.020630694925785, 34.02004936337471, 33.937331192195415, 17.71522199610868, 17.85243535755822, 17.832841960402817, 34.60836675266424, 34.416992908964545, 34.5681716526548, 21.146585529980555, 20.621766683955983, 20.462000494201973, 18.864322687188775, 18.624513680736214, 19.482851187388093, 28.697003960609436, 28.91178278811276, 28.82230299152434, 24.76664547622204, 24.413446828722954, 24.69649814814329, 26.81372930109501, 26.685574769973755, 27.33410648815334, 24.1352144939204, 24.047691759963826, 24.277026488756135, 20.214586695035294, 20.61637620379527, 20.725080733497933, 18.584968527158097, 18.59975792964299, 18.983989511926964, 30.672938009103135, 31.29889527832468, 31.113000777860478, 20.514110346635178, 20.921353363742426, 20.632891712089375, 25.275094263255596, 24.973457880318165, 24.978551395237446, 19.951892393330724, 19.956727149585873, 20.285168970624596, 28.897680709759385, 28.799087623755128, 29.371227374921233, 28.268623534124345, 27.695657767355442, 28.1363316886127, 16.718216220537812, 17.088737011576683, 16.840472797552735, 25.903065358599022, 26.100244731952742, 26.08071158205469, 31.20558402438958, 31.384645131727055, 31.558366421920553, 20.752251012871653, 20.854603382448346, 20.789739112059266, 26.238457575440407, 26.29509212076664, 26.60661232750863, 12.219810975094632, 12.035643388827637, 12.24446278562148, 19.669071663171053, 19.84303741157055, 19.462075628340244, 28.928329546004534, 29.000330951064825, 28.74862726032734, 24.768809150904417, 24.570003241300583, 24.790493478998542, 25.290026634931564, 25.538274858146906, 25.496279940009117, 24.697999144593865, 24.673396098117024, 24.795313859979302, 23.46288710832596, 23.325456641614437, 23.58451921492815, 34.16442101200421, 34.60728349474569, 34.448930614938334, 26.137747384607792, 26.296001330018044, 26.240410313010216, 27.60178121055165, 27.688891946027667, 27.717503069589526, 25.289549897114426, 25.574019024769456, 25.506338621179253, 19.1086552888155, 18.919840291142464, 19.131078518927097, 28.000030194719628, 27.993397538860634, 28.26092669119437, 27.14852999150753, 27.21368435025215, 27.61859542876482, 24.282223780949906, 24.3785232057174, 24.336229808007673, 29.838395327329636, 30.014582745730877, 29.90632139518857, 30.323082377513245, 31.095893263195947, 30.74674418320258, 23.191958794991166, 23.68188068146506, 22.91851935784021, 21.29024392118056, 21.682769322146967, 21.736979262282446, 19.743844376256064, 19.708950867255524, 19.862564721455172, 31.982414841651917, 31.958791360259056, 32.45765829854645, 27.89734861751397, 27.878549834092453, 27.828020741542176, 22.50070808206995, 22.329124619563416, 22.144654055436447, 33.54639237001538, 33.17546322196722, 32.865586161613464, 17.79759460439284, 18.051678513487175, 18.10855596636732, 20.92059101164341, 21.599075409583747, 20.965658232569695, 27.73035245140393, 28.38133360849072, 28.29133253668745]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14191595680449148, "mean_inference_ms": 0.6426945627218659, "mean_action_processing_ms": 0.09468062403253502, "mean_env_wait_ms": 0.7967058003818555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 715200, "timesteps_this_iter": 0, "agent_timesteps_total": 2145600, "timers": {"sample_time_ms": 9282.611, "sample_throughput": 517.096, "load_time_ms": 0.4, "load_throughput": 11993720.481, "learn_time_ms": 1213.435, "learn_throughput": 3955.713, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 7.063768982887268, "policy_loss": -0.0012343560842498214, "vf_loss": 7.210210978984833, "vf_explained_var": -0.00337374210357666, "kl": 0.006217192247479263, "entropy": 14.576787233352661, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 715200, "num_agent_steps_sampled": 2145600, "num_steps_trained": 715200, "num_agent_steps_trained": 2145600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3313, "training_iteration": 149, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-05-52", "timestamp": 1706148352, "time_this_iter_s": 9.450650691986084, "time_total_s": 1391.8696348667145, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F91F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1391.8696348667145, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 9.728571428571428, "ram_util_percent": 47.285714285714285}}
{"episode_reward_max": 103.59353131428358, "episode_reward_min": 36.49991714954375, "episode_reward_mean": 72.74728365934308, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.035643388827637}, "policy_reward_max": {"shared_policy": 34.60836675266424}, "policy_reward_mean": {"shared_policy": 24.249094553114354}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.33700045570728, 70.6946524430532, 64.47279093787071, 52.3808733522892, 55.55018643289803, 63.57571406662464, 71.1825352311134, 71.20154325291512, 69.29031363595276, 69.48837831430137, 74.45820227079092, 57.87733832979575, 64.4403915889561, 74.72595933824778, 78.24832357279955, 70.28977150842547, 60.972863491624565, 71.41313316766171, 81.28189420327541, 47.49047515593699, 54.282346984371515, 65.51699115335938, 82.17304202090597, 58.667651921510696, 68.15628799796103, 65.04888451844452, 73.29014457389712, 59.272703506052494, 60.751126293092966, 79.0610038973391, 60.75030229240653, 71.51187216863036, 60.36834281275513, 89.87181171774863, 73.87911860272285, 101.97801125049591, 53.40049931406972, 103.59353131428358, 62.23035270813851, 56.97168755531308, 86.43108974024653, 73.87659045308828, 80.8334105592221, 72.45993274264036, 61.556043632328496, 56.16871596872805, 93.08483406528829, 62.06835542246698, 75.2271035388112, 60.19378851354119, 87.06799570843575, 84.10061299009249, 50.64742602966723, 78.08402167260645, 94.14859557803719, 62.396593507379265, 79.14016202371567, 36.49991714954375, 58.974184703081846, 86.6772877573967, 74.12930587120354, 76.32458143308759, 74.16670910269019, 70.37286296486855, 103.22063512168823, 78.67415902763605, 83.00817622616884, 76.36990754306314, 57.15957409888506, 84.25435442477463, 81.9808097705245, 72.99697679467498, 89.75929946824908, 92.16571982391177, 69.79235883429644, 64.70999250560997, 59.31535996496676, 96.39886450045742, 83.6039191931486, 66.97448675706981, 99.58744175359607, 53.95782908424734, 63.48532465379685, 84.4030185965821, 74.40548891946672, 87.23213540017602, 86.3803573772311, 79.41972807981071, 67.22175143659113, 96.73184170201418, 78.85399144515392, 71.91777197271584, 79.3940411885269, 91.42884106934069, 73.51451463066039, 81.58365292474626, 86.90829493012279, 69.92871246440333, 65.86114193871616, 66.34971782937644], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.111739257971436, 17.318375429759413, 16.906885767976433, 23.541502002626657, 23.36727499961853, 23.785875440808013, 21.565194732199103, 21.359842556218297, 21.547753649453313, 17.771090485155582, 17.394965805113316, 17.214817062020302, 18.355708253880337, 18.626211398591593, 18.5682667804261, 21.156554862856865, 21.201098568737507, 21.21806063503027, 23.922342265645653, 23.641777167717606, 23.618415797750146, 23.5962433690826, 23.764486009875924, 23.84081387395659, 23.255798487303153, 23.10620345299442, 22.928311695655182, 22.9481308311224, 23.556575817987323, 22.98367166519165, 24.83777181183298, 24.81148207498093, 24.80894838397701, 19.166142519563437, 19.285236120224, 19.425959690008312, 21.39629291494687, 21.403029320140675, 21.64106935386856, 25.02412226051092, 24.92765784263611, 24.774179235100746, 26.01715612163146, 25.961524312694863, 26.269643138473228, 23.790588822215796, 23.16473425924778, 23.3344484269619, 20.416305443892867, 20.28250804791847, 20.27404999981323, 23.99594098174323, 23.688540173073605, 23.728652012844876, 27.062822754184396, 26.858693758646638, 27.36037769044438, 15.865164865487401, 15.783751641089708, 15.841558649359882, 18.08169105152288, 18.256143108631164, 17.94451282421747, 21.810975181559712, 21.752214464048535, 21.953801507751137, 26.97706628839174, 27.43175871918598, 27.76421701332825, 19.675630301237106, 19.696064114570618, 19.295957505702972, 22.436162417133644, 22.857300636668995, 22.86282494415839, 21.961843406160668, 21.422657181819275, 21.66438393046458, 24.309325471520424, 24.26374788582325, 24.71707121655345, 19.78125811740756, 19.7083303257823, 19.783115062862635, 20.44258252903819, 19.85643680393696, 20.452106960117817, 26.92410022392869, 26.366646945476532, 25.770256727933884, 20.267406264940888, 20.18048872301975, 20.302407304445893, 23.90474759042263, 23.55937048792839, 24.04775409027934, 20.06653820102413, 20.035689798494175, 20.266114813236825, 29.74050400157769, 30.180819158752755, 29.950488557418183, 24.42725825558105, 24.73994435245791, 24.711915994683892, 34.020630694925785, 34.02004936337471, 33.937331192195415, 17.71522199610868, 17.85243535755822, 17.832841960402817, 34.60836675266424, 34.416992908964545, 34.5681716526548, 21.146585529980555, 20.621766683955983, 20.462000494201973, 18.864322687188775, 18.624513680736214, 19.482851187388093, 28.697003960609436, 28.91178278811276, 28.82230299152434, 24.76664547622204, 24.413446828722954, 24.69649814814329, 26.81372930109501, 26.685574769973755, 27.33410648815334, 24.1352144939204, 24.047691759963826, 24.277026488756135, 20.214586695035294, 20.61637620379527, 20.725080733497933, 18.584968527158097, 18.59975792964299, 18.983989511926964, 30.672938009103135, 31.29889527832468, 31.113000777860478, 20.514110346635178, 20.921353363742426, 20.632891712089375, 25.275094263255596, 24.973457880318165, 24.978551395237446, 19.951892393330724, 19.956727149585873, 20.285168970624596, 28.897680709759385, 28.799087623755128, 29.371227374921233, 28.268623534124345, 27.695657767355442, 28.1363316886127, 16.718216220537812, 17.088737011576683, 16.840472797552735, 25.903065358599022, 26.100244731952742, 26.08071158205469, 31.20558402438958, 31.384645131727055, 31.558366421920553, 20.752251012871653, 20.854603382448346, 20.789739112059266, 26.238457575440407, 26.29509212076664, 26.60661232750863, 12.219810975094632, 12.035643388827637, 12.24446278562148, 19.669071663171053, 19.84303741157055, 19.462075628340244, 28.928329546004534, 29.000330951064825, 28.74862726032734, 24.768809150904417, 24.570003241300583, 24.790493478998542, 25.290026634931564, 25.538274858146906, 25.496279940009117, 24.697999144593865, 24.673396098117024, 24.795313859979302, 23.46288710832596, 23.325456641614437, 23.58451921492815, 34.16442101200421, 34.60728349474569, 34.448930614938334, 26.137747384607792, 26.296001330018044, 26.240410313010216, 27.60178121055165, 27.688891946027667, 27.717503069589526, 25.289549897114426, 25.574019024769456, 25.506338621179253, 19.1086552888155, 18.919840291142464, 19.131078518927097, 28.000030194719628, 27.993397538860634, 28.26092669119437, 27.14852999150753, 27.21368435025215, 27.61859542876482, 24.282223780949906, 24.3785232057174, 24.336229808007673, 29.838395327329636, 30.014582745730877, 29.90632139518857, 30.323082377513245, 31.095893263195947, 30.74674418320258, 23.191958794991166, 23.68188068146506, 22.91851935784021, 21.29024392118056, 21.682769322146967, 21.736979262282446, 19.743844376256064, 19.708950867255524, 19.862564721455172, 31.982414841651917, 31.958791360259056, 32.45765829854645, 27.89734861751397, 27.878549834092453, 27.828020741542176, 22.50070808206995, 22.329124619563416, 22.144654055436447, 33.54639237001538, 33.17546322196722, 32.865586161613464, 17.79759460439284, 18.051678513487175, 18.10855596636732, 20.92059101164341, 21.599075409583747, 20.965658232569695, 27.73035245140393, 28.38133360849072, 28.29133253668745, 24.849429213752344, 24.85477204372485, 24.701287661989525, 28.905439878503472, 29.2146900097529, 29.112005511919648, 28.853235085805252, 28.574822721381977, 28.952299570043877, 26.832012922192604, 26.703830032298953, 25.883885125319154, 22.307379630704716, 22.712714125712708, 22.20165768017371, 32.43213633323708, 32.003131250540406, 32.29657411823669, 26.223124819497258, 26.408176771054656, 26.22268985460201, 24.116753568251923, 24.211813402672604, 23.589205001791314, 26.544454410672188, 26.794057943392545, 26.055528834462166, 30.159118254979447, 30.625508227696017, 30.64421458666523, 24.77194355490306, 24.541016618410737, 24.20155445734659, 26.609595542152718, 27.46011328262587, 27.513944099967674, 28.685960106551647, 29.04929606989026, 29.173038753680885, 23.38219652387002, 23.062409194807202, 23.48410674572611, 21.526963119705513, 22.1098961358269, 22.224282683183745, 21.746490096052483, 22.134947088857487, 22.468280644466475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14191458428190015, "mean_inference_ms": 0.6428984232705391, "mean_action_processing_ms": 0.09471280768720403, "mean_env_wait_ms": 0.7966988864364609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 2160000, "timers": {"sample_time_ms": 9360.415, "sample_throughput": 512.798, "load_time_ms": 0.4, "load_throughput": 11993720.481, "learn_time_ms": 1214.197, "learn_throughput": 3953.231, "update_time_ms": 1.601}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 4.929195582866669, "policy_loss": -0.0003296492070270496, "vf_loss": 5.07490736246109, "vf_explained_var": -0.001507297158241272, "kl": 0.005978760775386617, "entropy": 14.592065334320068, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 2160000, "num_steps_trained": 720000, "num_agent_steps_trained": 2160000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 93.81097411736845, "episode_reward_min": 55.751253776252256, "episode_reward_mean": 74.62366968682034, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 18.476922561724976}, "policy_reward_max": {"shared_policy": 31.548915312935904}, "policy_reward_mean": {"shared_policy": 24.874556562273444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.67654213681817, 61.0441913632676, 65.56596237048504, 69.66860383749005, 76.40616568922995, 93.81097411736845, 81.03128594905135, 55.751253776252256, 77.74200973287225, 87.53970789536831], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.849642895162106, 25.992192208766937, 25.834707032889128, 20.281075973063707, 20.5352119570598, 20.227903433144093, 21.639150234560162, 21.95853758851686, 21.968274547408015, 23.147565970818192, 23.331561821202428, 23.189476045469434, 25.46327046801646, 25.55905669679244, 25.38383852442105, 30.946483959754303, 31.31557484467824, 31.548915312935904, 26.886138821641595, 27.155193405846745, 26.989953721563012, 18.476922561724976, 18.61744278421004, 18.656888430317238, 25.809612445533276, 25.914167057722807, 26.018230229616165, 28.923885862032563, 29.139138127366692, 29.476683905969054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13347611869924658, "mean_inference_ms": 0.6530703212462533, "mean_action_processing_ms": 0.0920477183061346, "mean_env_wait_ms": 0.7960475444848277, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 3329, "training_iteration": 150, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-06-07", "timestamp": 1706148367, "time_this_iter_s": 14.569463968276978, "time_total_s": 1406.4390988349915, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1406.4390988349915, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 6.625, "ram_util_percent": 47.275}}
{"episode_reward_max": 103.59353131428358, "episode_reward_min": 36.49991714954375, "episode_reward_mean": 73.48280263580119, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.035643388827637}, "policy_reward_max": {"shared_policy": 34.60836675266424}, "policy_reward_mean": {"shared_policy": 24.49426754526706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.972863491624565, 71.41313316766171, 81.28189420327541, 47.49047515593699, 54.282346984371515, 65.51699115335938, 82.17304202090597, 58.667651921510696, 68.15628799796103, 65.04888451844452, 73.29014457389712, 59.272703506052494, 60.751126293092966, 79.0610038973391, 60.75030229240653, 71.51187216863036, 60.36834281275513, 89.87181171774863, 73.87911860272285, 101.97801125049591, 53.40049931406972, 103.59353131428358, 62.23035270813851, 56.97168755531308, 86.43108974024653, 73.87659045308828, 80.8334105592221, 72.45993274264036, 61.556043632328496, 56.16871596872805, 93.08483406528829, 62.06835542246698, 75.2271035388112, 60.19378851354119, 87.06799570843575, 84.10061299009249, 50.64742602966723, 78.08402167260645, 94.14859557803719, 62.396593507379265, 79.14016202371567, 36.49991714954375, 58.974184703081846, 86.6772877573967, 74.12930587120354, 76.32458143308759, 74.16670910269019, 70.37286296486855, 103.22063512168823, 78.67415902763605, 83.00817622616884, 76.36990754306314, 57.15957409888506, 84.25435442477463, 81.9808097705245, 72.99697679467498, 89.75929946824908, 92.16571982391177, 69.79235883429644, 64.70999250560997, 59.31535996496676, 96.39886450045742, 83.6039191931486, 66.97448675706981, 99.58744175359607, 53.95782908424734, 63.48532465379685, 84.4030185965821, 74.40548891946672, 87.23213540017602, 86.3803573772311, 79.41972807981071, 67.22175143659113, 96.73184170201418, 78.85399144515392, 71.91777197271584, 79.3940411885269, 91.42884106934069, 73.51451463066039, 81.58365292474626, 86.90829493012279, 69.92871246440333, 65.86114193871616, 66.34971782937644, 40.23625342920421, 75.35607608966527, 63.7403902951628, 87.68099215254185, 74.1350329881534, 94.27955170720814, 83.33083007344975, 81.9272630753694, 60.08245811611411, 76.9617951372638, 79.17923178523776, 80.9634377332404, 69.17193933576344, 66.20385136362162, 55.18618921935557, 44.33057987620123], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.416305443892867, 20.28250804791847, 20.27404999981323, 23.99594098174323, 23.688540173073605, 23.728652012844876, 27.062822754184396, 26.858693758646638, 27.36037769044438, 15.865164865487401, 15.783751641089708, 15.841558649359882, 18.08169105152288, 18.256143108631164, 17.94451282421747, 21.810975181559712, 21.752214464048535, 21.953801507751137, 26.97706628839174, 27.43175871918598, 27.76421701332825, 19.675630301237106, 19.696064114570618, 19.295957505702972, 22.436162417133644, 22.857300636668995, 22.86282494415839, 21.961843406160668, 21.422657181819275, 21.66438393046458, 24.309325471520424, 24.26374788582325, 24.71707121655345, 19.78125811740756, 19.7083303257823, 19.783115062862635, 20.44258252903819, 19.85643680393696, 20.452106960117817, 26.92410022392869, 26.366646945476532, 25.770256727933884, 20.267406264940888, 20.18048872301975, 20.302407304445893, 23.90474759042263, 23.55937048792839, 24.04775409027934, 20.06653820102413, 20.035689798494175, 20.266114813236825, 29.74050400157769, 30.180819158752755, 29.950488557418183, 24.42725825558105, 24.73994435245791, 24.711915994683892, 34.020630694925785, 34.02004936337471, 33.937331192195415, 17.71522199610868, 17.85243535755822, 17.832841960402817, 34.60836675266424, 34.416992908964545, 34.5681716526548, 21.146585529980555, 20.621766683955983, 20.462000494201973, 18.864322687188775, 18.624513680736214, 19.482851187388093, 28.697003960609436, 28.91178278811276, 28.82230299152434, 24.76664547622204, 24.413446828722954, 24.69649814814329, 26.81372930109501, 26.685574769973755, 27.33410648815334, 24.1352144939204, 24.047691759963826, 24.277026488756135, 20.214586695035294, 20.61637620379527, 20.725080733497933, 18.584968527158097, 18.59975792964299, 18.983989511926964, 30.672938009103135, 31.29889527832468, 31.113000777860478, 20.514110346635178, 20.921353363742426, 20.632891712089375, 25.275094263255596, 24.973457880318165, 24.978551395237446, 19.951892393330724, 19.956727149585873, 20.285168970624596, 28.897680709759385, 28.799087623755128, 29.371227374921233, 28.268623534124345, 27.695657767355442, 28.1363316886127, 16.718216220537812, 17.088737011576683, 16.840472797552735, 25.903065358599022, 26.100244731952742, 26.08071158205469, 31.20558402438958, 31.384645131727055, 31.558366421920553, 20.752251012871653, 20.854603382448346, 20.789739112059266, 26.238457575440407, 26.29509212076664, 26.60661232750863, 12.219810975094632, 12.035643388827637, 12.24446278562148, 19.669071663171053, 19.84303741157055, 19.462075628340244, 28.928329546004534, 29.000330951064825, 28.74862726032734, 24.768809150904417, 24.570003241300583, 24.790493478998542, 25.290026634931564, 25.538274858146906, 25.496279940009117, 24.697999144593865, 24.673396098117024, 24.795313859979302, 23.46288710832596, 23.325456641614437, 23.58451921492815, 34.16442101200421, 34.60728349474569, 34.448930614938334, 26.137747384607792, 26.296001330018044, 26.240410313010216, 27.60178121055165, 27.688891946027667, 27.717503069589526, 25.289549897114426, 25.574019024769456, 25.506338621179253, 19.1086552888155, 18.919840291142464, 19.131078518927097, 28.000030194719628, 27.993397538860634, 28.26092669119437, 27.14852999150753, 27.21368435025215, 27.61859542876482, 24.282223780949906, 24.3785232057174, 24.336229808007673, 29.838395327329636, 30.014582745730877, 29.90632139518857, 30.323082377513245, 31.095893263195947, 30.74674418320258, 23.191958794991166, 23.68188068146506, 22.91851935784021, 21.29024392118056, 21.682769322146967, 21.736979262282446, 19.743844376256064, 19.708950867255524, 19.862564721455172, 31.982414841651917, 31.958791360259056, 32.45765829854645, 27.89734861751397, 27.878549834092453, 27.828020741542176, 22.50070808206995, 22.329124619563416, 22.144654055436447, 33.54639237001538, 33.17546322196722, 32.865586161613464, 17.79759460439284, 18.051678513487175, 18.10855596636732, 20.92059101164341, 21.599075409583747, 20.965658232569695, 27.73035245140393, 28.38133360849072, 28.29133253668745, 24.849429213752344, 24.85477204372485, 24.701287661989525, 28.905439878503472, 29.2146900097529, 29.112005511919648, 28.853235085805252, 28.574822721381977, 28.952299570043877, 26.832012922192604, 26.703830032298953, 25.883885125319154, 22.307379630704716, 22.712714125712708, 22.20165768017371, 32.43213633323708, 32.003131250540406, 32.29657411823669, 26.223124819497258, 26.408176771054656, 26.22268985460201, 24.116753568251923, 24.211813402672604, 23.589205001791314, 26.544454410672188, 26.794057943392545, 26.055528834462166, 30.159118254979447, 30.625508227696017, 30.64421458666523, 24.77194355490306, 24.541016618410737, 24.20155445734659, 26.609595542152718, 27.46011328262587, 27.513944099967674, 28.685960106551647, 29.04929606989026, 29.173038753680885, 23.38219652387002, 23.062409194807202, 23.48410674572611, 21.526963119705513, 22.1098961358269, 22.224282683183745, 21.746490096052483, 22.134947088857487, 22.468280644466475, 13.802561531153813, 12.597562511761978, 13.83612938628842, 25.054250980416924, 25.166884508604795, 25.134940600643546, 21.392011070623994, 21.212545797228813, 21.13583342730999, 29.338031536589057, 29.292594524721295, 29.050366091231496, 24.36052033305168, 24.793270524591208, 24.98124213051051, 30.869785626729325, 31.86056264241536, 31.549203438063458, 27.749512647589043, 28.06102300792311, 27.520294417937592, 27.18903525670369, 27.10579651345809, 27.632431305207618, 19.868161755303532, 20.142639654378087, 20.071656706432492, 25.431010755399853, 25.602047289411217, 25.928737092452735, 26.26564847926298, 26.354338179032, 26.559245126942784, 27.283565438973397, 26.7407846028606, 26.9390876914064, 23.21428220470746, 22.846136574943856, 23.111520556112126, 22.004511798421532, 22.369352960648627, 21.829986604551465, 18.563125764330223, 18.485094492634133, 18.137968962391213, 14.921556431101635, 14.703532800078392, 14.7054906450212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14191562596525706, "mean_inference_ms": 0.6431239020701598, "mean_action_processing_ms": 0.0947433654278207, "mean_env_wait_ms": 0.7966963151418838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 724800, "timesteps_this_iter": 0, "agent_timesteps_total": 2174400, "timers": {"sample_time_ms": 9848.082, "sample_throughput": 487.405, "load_time_ms": 0.4, "load_throughput": 11993720.481, "learn_time_ms": 1226.691, "learn_throughput": 3912.966, "update_time_ms": 1.704}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.571997225284576, "policy_loss": -0.0012420030516255842, "vf_loss": 5.718504011631012, "vf_explained_var": -0.006459817290306091, "kl": 0.00681726919740762, "entropy": 14.587862610816956, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 724800, "num_agent_steps_sampled": 2174400, "num_steps_trained": 724800, "num_agent_steps_trained": 2174400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3345, "training_iteration": 151, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-06-16", "timestamp": 1706148376, "time_this_iter_s": 9.254767179489136, "time_total_s": 1415.6938660144806, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D4E4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1415.6938660144806, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 4.869230769230769, "ram_util_percent": 47.17692307692308}}
{"episode_reward_max": 108.13742878567425, "episode_reward_min": 36.49991714954375, "episode_reward_mean": 75.21042658440535, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.035643388827637}, "policy_reward_max": {"shared_policy": 36.55541759512076}, "policy_reward_mean": {"shared_policy": 25.07014219480178}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.36834281275513, 89.87181171774863, 73.87911860272285, 101.97801125049591, 53.40049931406972, 103.59353131428358, 62.23035270813851, 56.97168755531308, 86.43108974024653, 73.87659045308828, 80.8334105592221, 72.45993274264036, 61.556043632328496, 56.16871596872805, 93.08483406528829, 62.06835542246698, 75.2271035388112, 60.19378851354119, 87.06799570843575, 84.10061299009249, 50.64742602966723, 78.08402167260645, 94.14859557803719, 62.396593507379265, 79.14016202371567, 36.49991714954375, 58.974184703081846, 86.6772877573967, 74.12930587120354, 76.32458143308759, 74.16670910269019, 70.37286296486855, 103.22063512168823, 78.67415902763605, 83.00817622616884, 76.36990754306314, 57.15957409888506, 84.25435442477463, 81.9808097705245, 72.99697679467498, 89.75929946824908, 92.16571982391177, 69.79235883429644, 64.70999250560997, 59.31535996496676, 96.39886450045742, 83.6039191931486, 66.97448675706981, 99.58744175359607, 53.95782908424734, 63.48532465379685, 84.4030185965821, 74.40548891946672, 87.23213540017602, 86.3803573772311, 79.41972807981071, 67.22175143659113, 96.73184170201418, 78.85399144515392, 71.91777197271584, 79.3940411885269, 91.42884106934069, 73.51451463066039, 81.58365292474626, 86.90829493012279, 69.92871246440333, 65.86114193871616, 66.34971782937644, 40.23625342920421, 75.35607608966527, 63.7403902951628, 87.68099215254185, 74.1350329881534, 94.27955170720814, 83.33083007344975, 81.9272630753694, 60.08245811611411, 76.9617951372638, 79.17923178523776, 80.9634377332404, 69.17193933576344, 66.20385136362162, 55.18618921935557, 44.33057987620123, 79.14335099235176, 108.13742878567425, 78.34442886710167, 77.80105299688873, 62.450805359985665, 88.23074956983328, 58.276163104921565, 75.53759580105542, 61.64548883959648, 101.48130815289912, 67.06935662357137, 70.77013865858315, 72.1387825028505, 77.08017953019589, 76.45172624476253, 77.84456217661499], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.06653820102413, 20.035689798494175, 20.266114813236825, 29.74050400157769, 30.180819158752755, 29.950488557418183, 24.42725825558105, 24.73994435245791, 24.711915994683892, 34.020630694925785, 34.02004936337471, 33.937331192195415, 17.71522199610868, 17.85243535755822, 17.832841960402817, 34.60836675266424, 34.416992908964545, 34.5681716526548, 21.146585529980555, 20.621766683955983, 20.462000494201973, 18.864322687188775, 18.624513680736214, 19.482851187388093, 28.697003960609436, 28.91178278811276, 28.82230299152434, 24.76664547622204, 24.413446828722954, 24.69649814814329, 26.81372930109501, 26.685574769973755, 27.33410648815334, 24.1352144939204, 24.047691759963826, 24.277026488756135, 20.214586695035294, 20.61637620379527, 20.725080733497933, 18.584968527158097, 18.59975792964299, 18.983989511926964, 30.672938009103135, 31.29889527832468, 31.113000777860478, 20.514110346635178, 20.921353363742426, 20.632891712089375, 25.275094263255596, 24.973457880318165, 24.978551395237446, 19.951892393330724, 19.956727149585873, 20.285168970624596, 28.897680709759385, 28.799087623755128, 29.371227374921233, 28.268623534124345, 27.695657767355442, 28.1363316886127, 16.718216220537812, 17.088737011576683, 16.840472797552735, 25.903065358599022, 26.100244731952742, 26.08071158205469, 31.20558402438958, 31.384645131727055, 31.558366421920553, 20.752251012871653, 20.854603382448346, 20.789739112059266, 26.238457575440407, 26.29509212076664, 26.60661232750863, 12.219810975094632, 12.035643388827637, 12.24446278562148, 19.669071663171053, 19.84303741157055, 19.462075628340244, 28.928329546004534, 29.000330951064825, 28.74862726032734, 24.768809150904417, 24.570003241300583, 24.790493478998542, 25.290026634931564, 25.538274858146906, 25.496279940009117, 24.697999144593865, 24.673396098117024, 24.795313859979302, 23.46288710832596, 23.325456641614437, 23.58451921492815, 34.16442101200421, 34.60728349474569, 34.448930614938334, 26.137747384607792, 26.296001330018044, 26.240410313010216, 27.60178121055165, 27.688891946027667, 27.717503069589526, 25.289549897114426, 25.574019024769456, 25.506338621179253, 19.1086552888155, 18.919840291142464, 19.131078518927097, 28.000030194719628, 27.993397538860634, 28.26092669119437, 27.14852999150753, 27.21368435025215, 27.61859542876482, 24.282223780949906, 24.3785232057174, 24.336229808007673, 29.838395327329636, 30.014582745730877, 29.90632139518857, 30.323082377513245, 31.095893263195947, 30.74674418320258, 23.191958794991166, 23.68188068146506, 22.91851935784021, 21.29024392118056, 21.682769322146967, 21.736979262282446, 19.743844376256064, 19.708950867255524, 19.862564721455172, 31.982414841651917, 31.958791360259056, 32.45765829854645, 27.89734861751397, 27.878549834092453, 27.828020741542176, 22.50070808206995, 22.329124619563416, 22.144654055436447, 33.54639237001538, 33.17546322196722, 32.865586161613464, 17.79759460439284, 18.051678513487175, 18.10855596636732, 20.92059101164341, 21.599075409583747, 20.965658232569695, 27.73035245140393, 28.38133360849072, 28.29133253668745, 24.849429213752344, 24.85477204372485, 24.701287661989525, 28.905439878503472, 29.2146900097529, 29.112005511919648, 28.853235085805252, 28.574822721381977, 28.952299570043877, 26.832012922192604, 26.703830032298953, 25.883885125319154, 22.307379630704716, 22.712714125712708, 22.20165768017371, 32.43213633323708, 32.003131250540406, 32.29657411823669, 26.223124819497258, 26.408176771054656, 26.22268985460201, 24.116753568251923, 24.211813402672604, 23.589205001791314, 26.544454410672188, 26.794057943392545, 26.055528834462166, 30.159118254979447, 30.625508227696017, 30.64421458666523, 24.77194355490306, 24.541016618410737, 24.20155445734659, 26.609595542152718, 27.46011328262587, 27.513944099967674, 28.685960106551647, 29.04929606989026, 29.173038753680885, 23.38219652387002, 23.062409194807202, 23.48410674572611, 21.526963119705513, 22.1098961358269, 22.224282683183745, 21.746490096052483, 22.134947088857487, 22.468280644466475, 13.802561531153813, 12.597562511761978, 13.83612938628842, 25.054250980416924, 25.166884508604795, 25.134940600643546, 21.392011070623994, 21.212545797228813, 21.13583342730999, 29.338031536589057, 29.292594524721295, 29.050366091231496, 24.36052033305168, 24.793270524591208, 24.98124213051051, 30.869785626729325, 31.86056264241536, 31.549203438063458, 27.749512647589043, 28.06102300792311, 27.520294417937592, 27.18903525670369, 27.10579651345809, 27.632431305207618, 19.868161755303532, 20.142639654378087, 20.071656706432492, 25.431010755399853, 25.602047289411217, 25.928737092452735, 26.26564847926298, 26.354338179032, 26.559245126942784, 27.283565438973397, 26.7407846028606, 26.9390876914064, 23.21428220470746, 22.846136574943856, 23.111520556112126, 22.004511798421532, 22.369352960648627, 21.829986604551465, 18.563125764330223, 18.485094492634133, 18.137968962391213, 14.921556431101635, 14.703532800078392, 14.7054906450212, 26.371623461445168, 26.472190299381808, 26.29953723152478, 35.59074805180231, 35.99126313875118, 36.55541759512076, 26.409107133746147, 25.63555797934532, 26.2997637540102, 25.905157602081687, 25.814647669593484, 26.081247725213558, 20.80217183878024, 20.593183202048138, 21.055450319157288, 29.12752355635166, 29.505386345088482, 29.597839668393135, 19.164467220505074, 19.59793521960576, 19.513760664810732, 25.137438946714, 25.205710032333926, 25.194446822007492, 20.59506927865246, 20.54299780415991, 20.50742175678411, 33.918693664173276, 33.516799102226884, 34.04581538649896, 22.77298666862771, 22.406086266040802, 21.890283688902855, 23.651207973559693, 23.723068637152508, 23.39586204787095, 23.807909076412514, 23.889466000099972, 24.441407426338017, 25.5535881370306, 25.62009283900261, 25.90649855416268, 25.249314201374844, 25.530085270603493, 25.67232677278419, 25.9265719850858, 25.751156111558274, 26.16683407997091]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14193510528673545, "mean_inference_ms": 0.6433891061638743, "mean_action_processing_ms": 0.09477955863871056, "mean_env_wait_ms": 0.7967172157688631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 729600, "timesteps_this_iter": 0, "agent_timesteps_total": 2188800, "timers": {"sample_time_ms": 9906.104, "sample_throughput": 484.55, "load_time_ms": 0.5, "load_throughput": 9595662.361, "learn_time_ms": 1233.884, "learn_throughput": 3890.155, "update_time_ms": 1.803}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 6.005419671535492, "policy_loss": 0.0012738733835027105, "vf_loss": 6.149218797683716, "vf_explained_var": -0.008590012788772583, "kl": 0.015349677764083462, "entropy": 14.645614266395569, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 729600, "num_agent_steps_sampled": 2188800, "num_steps_trained": 729600, "num_agent_steps_trained": 2188800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3361, "training_iteration": 152, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-06-25", "timestamp": 1706148385, "time_this_iter_s": 9.471982479095459, "time_total_s": 1425.165848493576, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1425.165848493576, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 6.271428571428571, "ram_util_percent": 47.214285714285715}}
{"episode_reward_max": 108.13742878567425, "episode_reward_min": 36.49991714954375, "episode_reward_mean": 74.49710330092246, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.035643388827637}, "policy_reward_max": {"shared_policy": 36.55541759512076}, "policy_reward_mean": {"shared_policy": 24.832367766974148}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.2271035388112, 60.19378851354119, 87.06799570843575, 84.10061299009249, 50.64742602966723, 78.08402167260645, 94.14859557803719, 62.396593507379265, 79.14016202371567, 36.49991714954375, 58.974184703081846, 86.6772877573967, 74.12930587120354, 76.32458143308759, 74.16670910269019, 70.37286296486855, 103.22063512168823, 78.67415902763605, 83.00817622616884, 76.36990754306314, 57.15957409888506, 84.25435442477463, 81.9808097705245, 72.99697679467498, 89.75929946824908, 92.16571982391177, 69.79235883429644, 64.70999250560997, 59.31535996496676, 96.39886450045742, 83.6039191931486, 66.97448675706981, 99.58744175359607, 53.95782908424734, 63.48532465379685, 84.4030185965821, 74.40548891946672, 87.23213540017602, 86.3803573772311, 79.41972807981071, 67.22175143659113, 96.73184170201418, 78.85399144515392, 71.91777197271584, 79.3940411885269, 91.42884106934069, 73.51451463066039, 81.58365292474626, 86.90829493012279, 69.92871246440333, 65.86114193871616, 66.34971782937644, 40.23625342920421, 75.35607608966527, 63.7403902951628, 87.68099215254185, 74.1350329881534, 94.27955170720814, 83.33083007344975, 81.9272630753694, 60.08245811611411, 76.9617951372638, 79.17923178523776, 80.9634377332404, 69.17193933576344, 66.20385136362162, 55.18618921935557, 44.33057987620123, 79.14335099235176, 108.13742878567425, 78.34442886710167, 77.80105299688873, 62.450805359985665, 88.23074956983328, 58.276163104921565, 75.53759580105542, 61.64548883959648, 101.48130815289912, 67.06935662357137, 70.77013865858315, 72.1387825028505, 77.08017953019589, 76.45172624476253, 77.84456217661499, 58.49085505306718, 73.04297211859375, 64.11240035668014, 48.09073127806185, 94.58107440087768, 45.783573113381834, 69.30984491563865, 73.50996606983242, 65.83756158128381, 97.87078935559836, 59.75860399921655, 85.41502589732409, 57.28456446528432, 105.05859428830445, 61.62594336643812, 57.667499251663685], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.275094263255596, 24.973457880318165, 24.978551395237446, 19.951892393330724, 19.956727149585873, 20.285168970624596, 28.897680709759385, 28.799087623755128, 29.371227374921233, 28.268623534124345, 27.695657767355442, 28.1363316886127, 16.718216220537812, 17.088737011576683, 16.840472797552735, 25.903065358599022, 26.100244731952742, 26.08071158205469, 31.20558402438958, 31.384645131727055, 31.558366421920553, 20.752251012871653, 20.854603382448346, 20.789739112059266, 26.238457575440407, 26.29509212076664, 26.60661232750863, 12.219810975094632, 12.035643388827637, 12.24446278562148, 19.669071663171053, 19.84303741157055, 19.462075628340244, 28.928329546004534, 29.000330951064825, 28.74862726032734, 24.768809150904417, 24.570003241300583, 24.790493478998542, 25.290026634931564, 25.538274858146906, 25.496279940009117, 24.697999144593865, 24.673396098117024, 24.795313859979302, 23.46288710832596, 23.325456641614437, 23.58451921492815, 34.16442101200421, 34.60728349474569, 34.448930614938334, 26.137747384607792, 26.296001330018044, 26.240410313010216, 27.60178121055165, 27.688891946027667, 27.717503069589526, 25.289549897114426, 25.574019024769456, 25.506338621179253, 19.1086552888155, 18.919840291142464, 19.131078518927097, 28.000030194719628, 27.993397538860634, 28.26092669119437, 27.14852999150753, 27.21368435025215, 27.61859542876482, 24.282223780949906, 24.3785232057174, 24.336229808007673, 29.838395327329636, 30.014582745730877, 29.90632139518857, 30.323082377513245, 31.095893263195947, 30.74674418320258, 23.191958794991166, 23.68188068146506, 22.91851935784021, 21.29024392118056, 21.682769322146967, 21.736979262282446, 19.743844376256064, 19.708950867255524, 19.862564721455172, 31.982414841651917, 31.958791360259056, 32.45765829854645, 27.89734861751397, 27.878549834092453, 27.828020741542176, 22.50070808206995, 22.329124619563416, 22.144654055436447, 33.54639237001538, 33.17546322196722, 32.865586161613464, 17.79759460439284, 18.051678513487175, 18.10855596636732, 20.92059101164341, 21.599075409583747, 20.965658232569695, 27.73035245140393, 28.38133360849072, 28.29133253668745, 24.849429213752344, 24.85477204372485, 24.701287661989525, 28.905439878503472, 29.2146900097529, 29.112005511919648, 28.853235085805252, 28.574822721381977, 28.952299570043877, 26.832012922192604, 26.703830032298953, 25.883885125319154, 22.307379630704716, 22.712714125712708, 22.20165768017371, 32.43213633323708, 32.003131250540406, 32.29657411823669, 26.223124819497258, 26.408176771054656, 26.22268985460201, 24.116753568251923, 24.211813402672604, 23.589205001791314, 26.544454410672188, 26.794057943392545, 26.055528834462166, 30.159118254979447, 30.625508227696017, 30.64421458666523, 24.77194355490306, 24.541016618410737, 24.20155445734659, 26.609595542152718, 27.46011328262587, 27.513944099967674, 28.685960106551647, 29.04929606989026, 29.173038753680885, 23.38219652387002, 23.062409194807202, 23.48410674572611, 21.526963119705513, 22.1098961358269, 22.224282683183745, 21.746490096052483, 22.134947088857487, 22.468280644466475, 13.802561531153813, 12.597562511761978, 13.83612938628842, 25.054250980416924, 25.166884508604795, 25.134940600643546, 21.392011070623994, 21.212545797228813, 21.13583342730999, 29.338031536589057, 29.292594524721295, 29.050366091231496, 24.36052033305168, 24.793270524591208, 24.98124213051051, 30.869785626729325, 31.86056264241536, 31.549203438063458, 27.749512647589043, 28.06102300792311, 27.520294417937592, 27.18903525670369, 27.10579651345809, 27.632431305207618, 19.868161755303532, 20.142639654378087, 20.071656706432492, 25.431010755399853, 25.602047289411217, 25.928737092452735, 26.26564847926298, 26.354338179032, 26.559245126942784, 27.283565438973397, 26.7407846028606, 26.9390876914064, 23.21428220470746, 22.846136574943856, 23.111520556112126, 22.004511798421532, 22.369352960648627, 21.829986604551465, 18.563125764330223, 18.485094492634133, 18.137968962391213, 14.921556431101635, 14.703532800078392, 14.7054906450212, 26.371623461445168, 26.472190299381808, 26.29953723152478, 35.59074805180231, 35.99126313875118, 36.55541759512076, 26.409107133746147, 25.63555797934532, 26.2997637540102, 25.905157602081687, 25.814647669593484, 26.081247725213558, 20.80217183878024, 20.593183202048138, 21.055450319157288, 29.12752355635166, 29.505386345088482, 29.597839668393135, 19.164467220505074, 19.59793521960576, 19.513760664810732, 25.137438946714, 25.205710032333926, 25.194446822007492, 20.59506927865246, 20.54299780415991, 20.50742175678411, 33.918693664173276, 33.516799102226884, 34.04581538649896, 22.77298666862771, 22.406086266040802, 21.890283688902855, 23.651207973559693, 23.723068637152508, 23.39586204787095, 23.807909076412514, 23.889466000099972, 24.441407426338017, 25.5535881370306, 25.62009283900261, 25.90649855416268, 25.249314201374844, 25.530085270603493, 25.67232677278419, 25.9265719850858, 25.751156111558274, 26.16683407997091, 19.53627151499191, 19.58421793828407, 19.3703655997912, 24.372735843993723, 24.322091840207577, 24.348144434392452, 21.223471773167446, 21.334389199813202, 21.554539383699492, 16.12178997447093, 16.363481519122914, 15.60545978446801, 31.488297832508877, 31.713584442074833, 31.379192126293972, 15.052040139834077, 15.350359412531049, 15.381173561016709, 23.058781693379075, 22.879431466261536, 23.371631755998038, 24.598122301201016, 24.920219105357916, 23.991624663273484, 22.39923657849431, 22.249717637896538, 21.18860736489296, 32.71713450054327, 32.41712241868177, 32.736532436373324, 19.159232328335435, 20.577367473839928, 20.022004197041184, 28.499152928590775, 28.44523821771145, 28.470634751021862, 19.344817156592995, 19.062322134772927, 18.877425173918397, 34.68493112921715, 35.289606830105186, 35.084056328982115, 20.542486774424702, 20.425510237614304, 20.657946354399115, 19.239928781986237, 19.186051733791828, 19.24151873588562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14194140663066063, "mean_inference_ms": 0.6436160398038168, "mean_action_processing_ms": 0.0948245674065674, "mean_env_wait_ms": 0.7966993573035925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 734400, "timesteps_this_iter": 0, "agent_timesteps_total": 2203200, "timers": {"sample_time_ms": 9943.116, "sample_throughput": 482.746, "load_time_ms": 0.5, "load_throughput": 9595662.361, "learn_time_ms": 1234.079, "learn_throughput": 3889.541, "update_time_ms": 1.702}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.5925896763801575, "policy_loss": -0.00011695549920354154, "vf_loss": 5.737686455249786, "vf_explained_var": -0.013322874903678894, "kl": 0.011017235985697803, "entropy": 14.5972740650177, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 734400, "num_agent_steps_sampled": 2203200, "num_steps_trained": 734400, "num_agent_steps_trained": 2203200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3377, "training_iteration": 153, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-06-35", "timestamp": 1706148395, "time_this_iter_s": 9.35683274269104, "time_total_s": 1434.522681236267, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1434.522681236267, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 8.792307692307691, "ram_util_percent": 47.78461538461538}}
{"episode_reward_max": 108.13742878567425, "episode_reward_min": 40.23625342920421, "episode_reward_mean": 74.59726513034867, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.597562511761978}, "policy_reward_max": {"shared_policy": 36.55541759512076}, "policy_reward_mean": {"shared_policy": 24.865755043449553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.22063512168823, 78.67415902763605, 83.00817622616884, 76.36990754306314, 57.15957409888506, 84.25435442477463, 81.9808097705245, 72.99697679467498, 89.75929946824908, 92.16571982391177, 69.79235883429644, 64.70999250560997, 59.31535996496676, 96.39886450045742, 83.6039191931486, 66.97448675706981, 99.58744175359607, 53.95782908424734, 63.48532465379685, 84.4030185965821, 74.40548891946672, 87.23213540017602, 86.3803573772311, 79.41972807981071, 67.22175143659113, 96.73184170201418, 78.85399144515392, 71.91777197271584, 79.3940411885269, 91.42884106934069, 73.51451463066039, 81.58365292474626, 86.90829493012279, 69.92871246440333, 65.86114193871616, 66.34971782937644, 40.23625342920421, 75.35607608966527, 63.7403902951628, 87.68099215254185, 74.1350329881534, 94.27955170720814, 83.33083007344975, 81.9272630753694, 60.08245811611411, 76.9617951372638, 79.17923178523776, 80.9634377332404, 69.17193933576344, 66.20385136362162, 55.18618921935557, 44.33057987620123, 79.14335099235176, 108.13742878567425, 78.34442886710167, 77.80105299688873, 62.450805359985665, 88.23074956983328, 58.276163104921565, 75.53759580105542, 61.64548883959648, 101.48130815289912, 67.06935662357137, 70.77013865858315, 72.1387825028505, 77.08017953019589, 76.45172624476253, 77.84456217661499, 58.49085505306718, 73.04297211859375, 64.11240035668014, 48.09073127806185, 94.58107440087768, 45.783573113381834, 69.30984491563865, 73.50996606983242, 65.83756158128381, 97.87078935559836, 59.75860399921655, 85.41502589732409, 57.28456446528432, 105.05859428830445, 61.62594336643812, 57.667499251663685, 99.41850256919858, 89.01561498269439, 74.89890255033968, 80.59983052685854, 61.1414619833231, 64.75636021327226, 73.62968525332688, 74.40093504672404, 82.00710945203899, 80.46019849926232, 42.93363988120106, 58.403349086642265, 50.77863570675254, 69.67205031774937, 77.29431629274038, 78.7567391246557], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [34.16442101200421, 34.60728349474569, 34.448930614938334, 26.137747384607792, 26.296001330018044, 26.240410313010216, 27.60178121055165, 27.688891946027667, 27.717503069589526, 25.289549897114426, 25.574019024769456, 25.506338621179253, 19.1086552888155, 18.919840291142464, 19.131078518927097, 28.000030194719628, 27.993397538860634, 28.26092669119437, 27.14852999150753, 27.21368435025215, 27.61859542876482, 24.282223780949906, 24.3785232057174, 24.336229808007673, 29.838395327329636, 30.014582745730877, 29.90632139518857, 30.323082377513245, 31.095893263195947, 30.74674418320258, 23.191958794991166, 23.68188068146506, 22.91851935784021, 21.29024392118056, 21.682769322146967, 21.736979262282446, 19.743844376256064, 19.708950867255524, 19.862564721455172, 31.982414841651917, 31.958791360259056, 32.45765829854645, 27.89734861751397, 27.878549834092453, 27.828020741542176, 22.50070808206995, 22.329124619563416, 22.144654055436447, 33.54639237001538, 33.17546322196722, 32.865586161613464, 17.79759460439284, 18.051678513487175, 18.10855596636732, 20.92059101164341, 21.599075409583747, 20.965658232569695, 27.73035245140393, 28.38133360849072, 28.29133253668745, 24.849429213752344, 24.85477204372485, 24.701287661989525, 28.905439878503472, 29.2146900097529, 29.112005511919648, 28.853235085805252, 28.574822721381977, 28.952299570043877, 26.832012922192604, 26.703830032298953, 25.883885125319154, 22.307379630704716, 22.712714125712708, 22.20165768017371, 32.43213633323708, 32.003131250540406, 32.29657411823669, 26.223124819497258, 26.408176771054656, 26.22268985460201, 24.116753568251923, 24.211813402672604, 23.589205001791314, 26.544454410672188, 26.794057943392545, 26.055528834462166, 30.159118254979447, 30.625508227696017, 30.64421458666523, 24.77194355490306, 24.541016618410737, 24.20155445734659, 26.609595542152718, 27.46011328262587, 27.513944099967674, 28.685960106551647, 29.04929606989026, 29.173038753680885, 23.38219652387002, 23.062409194807202, 23.48410674572611, 21.526963119705513, 22.1098961358269, 22.224282683183745, 21.746490096052483, 22.134947088857487, 22.468280644466475, 13.802561531153813, 12.597562511761978, 13.83612938628842, 25.054250980416924, 25.166884508604795, 25.134940600643546, 21.392011070623994, 21.212545797228813, 21.13583342730999, 29.338031536589057, 29.292594524721295, 29.050366091231496, 24.36052033305168, 24.793270524591208, 24.98124213051051, 30.869785626729325, 31.86056264241536, 31.549203438063458, 27.749512647589043, 28.06102300792311, 27.520294417937592, 27.18903525670369, 27.10579651345809, 27.632431305207618, 19.868161755303532, 20.142639654378087, 20.071656706432492, 25.431010755399853, 25.602047289411217, 25.928737092452735, 26.26564847926298, 26.354338179032, 26.559245126942784, 27.283565438973397, 26.7407846028606, 26.9390876914064, 23.21428220470746, 22.846136574943856, 23.111520556112126, 22.004511798421532, 22.369352960648627, 21.829986604551465, 18.563125764330223, 18.485094492634133, 18.137968962391213, 14.921556431101635, 14.703532800078392, 14.7054906450212, 26.371623461445168, 26.472190299381808, 26.29953723152478, 35.59074805180231, 35.99126313875118, 36.55541759512076, 26.409107133746147, 25.63555797934532, 26.2997637540102, 25.905157602081687, 25.814647669593484, 26.081247725213558, 20.80217183878024, 20.593183202048138, 21.055450319157288, 29.12752355635166, 29.505386345088482, 29.597839668393135, 19.164467220505074, 19.59793521960576, 19.513760664810732, 25.137438946714, 25.205710032333926, 25.194446822007492, 20.59506927865246, 20.54299780415991, 20.50742175678411, 33.918693664173276, 33.516799102226884, 34.04581538649896, 22.77298666862771, 22.406086266040802, 21.890283688902855, 23.651207973559693, 23.723068637152508, 23.39586204787095, 23.807909076412514, 23.889466000099972, 24.441407426338017, 25.5535881370306, 25.62009283900261, 25.90649855416268, 25.249314201374844, 25.530085270603493, 25.67232677278419, 25.9265719850858, 25.751156111558274, 26.16683407997091, 19.53627151499191, 19.58421793828407, 19.3703655997912, 24.372735843993723, 24.322091840207577, 24.348144434392452, 21.223471773167446, 21.334389199813202, 21.554539383699492, 16.12178997447093, 16.363481519122914, 15.60545978446801, 31.488297832508877, 31.713584442074833, 31.379192126293972, 15.052040139834077, 15.350359412531049, 15.381173561016709, 23.058781693379075, 22.879431466261536, 23.371631755998038, 24.598122301201016, 24.920219105357916, 23.991624663273484, 22.39923657849431, 22.249717637896538, 21.18860736489296, 32.71713450054327, 32.41712241868177, 32.736532436373324, 19.159232328335435, 20.577367473839928, 20.022004197041184, 28.499152928590775, 28.44523821771145, 28.470634751021862, 19.344817156592995, 19.062322134772927, 18.877425173918397, 34.68493112921715, 35.289606830105186, 35.084056328982115, 20.542486774424702, 20.425510237614304, 20.657946354399115, 19.239928781986237, 19.186051733791828, 19.24151873588562, 33.512098530928284, 33.23788021008173, 32.66852382818857, 29.819074638187885, 29.718170512467623, 29.47836983203888, 24.711750273903206, 25.163506654401615, 25.023645622034863, 26.976957763234765, 27.269230051587016, 26.35364271203676, 20.49364572763443, 20.040864035487175, 20.606952220201492, 21.592617617299155, 21.377516915400818, 21.786225680572286, 24.21973658104737, 24.67566903525342, 24.73427963702609, 24.9792917445302, 25.119293913594447, 24.302349388599396, 27.408921757092074, 27.29490192731221, 27.303285767634705, 26.73595868547757, 26.773577151199177, 26.95066266258557, 14.161428092668444, 14.418144408302993, 14.354067380229623, 19.130219772458076, 19.652986723929644, 19.620142590254545, 16.798983931541443, 17.13946333900094, 16.840188436210155, 22.986748491724327, 23.198354368408516, 23.486947457616523, 25.52161035935083, 25.599644834796578, 26.173061098592967, 26.113213660816342, 26.431000928084046, 26.212524535755307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.141934988374008, "mean_inference_ms": 0.6437401607843686, "mean_action_processing_ms": 0.09485611358591911, "mean_env_wait_ms": 0.7966325434549258, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 739200, "timesteps_this_iter": 0, "agent_timesteps_total": 2217600, "timers": {"sample_time_ms": 9964.752, "sample_throughput": 481.698, "load_time_ms": 0.5, "load_throughput": 9595662.361, "learn_time_ms": 1234.984, "learn_throughput": 3886.689, "update_time_ms": 1.802}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09010162353515626, "cur_lr": 0.0005, "total_loss": 5.9009533524513245, "policy_loss": 0.0034645052901600693, "vf_loss": 6.0433661341667175, "vf_explained_var": 0.0020910128951072693, "kl": 0.02938119159101388, "entropy": 14.8524649143219, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 739200, "num_agent_steps_sampled": 2217600, "num_steps_trained": 739200, "num_agent_steps_trained": 2217600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3393, "training_iteration": 154, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-06-44", "timestamp": 1706148404, "time_this_iter_s": 9.154992580413818, "time_total_s": 1443.677673816681, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050CA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1443.677673816681, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 8.284615384615385, "ram_util_percent": 47.76153846153847}}
{"episode_reward_max": 108.13742878567425, "episode_reward_min": 34.81301043927667, "episode_reward_mean": 72.71385645276256, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 11.510805825392396}, "policy_reward_max": {"shared_policy": 36.55541759512076}, "policy_reward_mean": {"shared_policy": 24.237952150920847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.58744175359607, 53.95782908424734, 63.48532465379685, 84.4030185965821, 74.40548891946672, 87.23213540017602, 86.3803573772311, 79.41972807981071, 67.22175143659113, 96.73184170201418, 78.85399144515392, 71.91777197271584, 79.3940411885269, 91.42884106934069, 73.51451463066039, 81.58365292474626, 86.90829493012279, 69.92871246440333, 65.86114193871616, 66.34971782937644, 40.23625342920421, 75.35607608966527, 63.7403902951628, 87.68099215254185, 74.1350329881534, 94.27955170720814, 83.33083007344975, 81.9272630753694, 60.08245811611411, 76.9617951372638, 79.17923178523776, 80.9634377332404, 69.17193933576344, 66.20385136362162, 55.18618921935557, 44.33057987620123, 79.14335099235176, 108.13742878567425, 78.34442886710167, 77.80105299688873, 62.450805359985665, 88.23074956983328, 58.276163104921565, 75.53759580105542, 61.64548883959648, 101.48130815289912, 67.06935662357137, 70.77013865858315, 72.1387825028505, 77.08017953019589, 76.45172624476253, 77.84456217661499, 58.49085505306718, 73.04297211859375, 64.11240035668014, 48.09073127806185, 94.58107440087768, 45.783573113381834, 69.30984491563865, 73.50996606983242, 65.83756158128381, 97.87078935559836, 59.75860399921655, 85.41502589732409, 57.28456446528432, 105.05859428830445, 61.62594336643812, 57.667499251663685, 99.41850256919858, 89.01561498269439, 74.89890255033968, 80.59983052685854, 61.1414619833231, 64.75636021327226, 73.62968525332688, 74.40093504672404, 82.00710945203899, 80.46019849926232, 42.93363988120106, 58.403349086642265, 50.77863570675254, 69.67205031774937, 77.29431629274038, 78.7567391246557, 57.74754017591475, 34.81301043927667, 39.84484458982479, 84.84477851307018, 77.5781273692846, 63.34053839184344, 74.66271706670523, 44.48255450651047, 78.320930656977, 59.73508383706212, 81.75781082361935, 77.2027333676815, 70.83474007248878, 65.27112952060997, 98.42685082415117, 63.18033614149314], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [33.54639237001538, 33.17546322196722, 32.865586161613464, 17.79759460439284, 18.051678513487175, 18.10855596636732, 20.92059101164341, 21.599075409583747, 20.965658232569695, 27.73035245140393, 28.38133360849072, 28.29133253668745, 24.849429213752344, 24.85477204372485, 24.701287661989525, 28.905439878503472, 29.2146900097529, 29.112005511919648, 28.853235085805252, 28.574822721381977, 28.952299570043877, 26.832012922192604, 26.703830032298953, 25.883885125319154, 22.307379630704716, 22.712714125712708, 22.20165768017371, 32.43213633323708, 32.003131250540406, 32.29657411823669, 26.223124819497258, 26.408176771054656, 26.22268985460201, 24.116753568251923, 24.211813402672604, 23.589205001791314, 26.544454410672188, 26.794057943392545, 26.055528834462166, 30.159118254979447, 30.625508227696017, 30.64421458666523, 24.77194355490306, 24.541016618410737, 24.20155445734659, 26.609595542152718, 27.46011328262587, 27.513944099967674, 28.685960106551647, 29.04929606989026, 29.173038753680885, 23.38219652387002, 23.062409194807202, 23.48410674572611, 21.526963119705513, 22.1098961358269, 22.224282683183745, 21.746490096052483, 22.134947088857487, 22.468280644466475, 13.802561531153813, 12.597562511761978, 13.83612938628842, 25.054250980416924, 25.166884508604795, 25.134940600643546, 21.392011070623994, 21.212545797228813, 21.13583342730999, 29.338031536589057, 29.292594524721295, 29.050366091231496, 24.36052033305168, 24.793270524591208, 24.98124213051051, 30.869785626729325, 31.86056264241536, 31.549203438063458, 27.749512647589043, 28.06102300792311, 27.520294417937592, 27.18903525670369, 27.10579651345809, 27.632431305207618, 19.868161755303532, 20.142639654378087, 20.071656706432492, 25.431010755399853, 25.602047289411217, 25.928737092452735, 26.26564847926298, 26.354338179032, 26.559245126942784, 27.283565438973397, 26.7407846028606, 26.9390876914064, 23.21428220470746, 22.846136574943856, 23.111520556112126, 22.004511798421532, 22.369352960648627, 21.829986604551465, 18.563125764330223, 18.485094492634133, 18.137968962391213, 14.921556431101635, 14.703532800078392, 14.7054906450212, 26.371623461445168, 26.472190299381808, 26.29953723152478, 35.59074805180231, 35.99126313875118, 36.55541759512076, 26.409107133746147, 25.63555797934532, 26.2997637540102, 25.905157602081687, 25.814647669593484, 26.081247725213558, 20.80217183878024, 20.593183202048138, 21.055450319157288, 29.12752355635166, 29.505386345088482, 29.597839668393135, 19.164467220505074, 19.59793521960576, 19.513760664810732, 25.137438946714, 25.205710032333926, 25.194446822007492, 20.59506927865246, 20.54299780415991, 20.50742175678411, 33.918693664173276, 33.516799102226884, 34.04581538649896, 22.77298666862771, 22.406086266040802, 21.890283688902855, 23.651207973559693, 23.723068637152508, 23.39586204787095, 23.807909076412514, 23.889466000099972, 24.441407426338017, 25.5535881370306, 25.62009283900261, 25.90649855416268, 25.249314201374844, 25.530085270603493, 25.67232677278419, 25.9265719850858, 25.751156111558274, 26.16683407997091, 19.53627151499191, 19.58421793828407, 19.3703655997912, 24.372735843993723, 24.322091840207577, 24.348144434392452, 21.223471773167446, 21.334389199813202, 21.554539383699492, 16.12178997447093, 16.363481519122914, 15.60545978446801, 31.488297832508877, 31.713584442074833, 31.379192126293972, 15.052040139834077, 15.350359412531049, 15.381173561016709, 23.058781693379075, 22.879431466261536, 23.371631755998038, 24.598122301201016, 24.920219105357916, 23.991624663273484, 22.39923657849431, 22.249717637896538, 21.18860736489296, 32.71713450054327, 32.41712241868177, 32.736532436373324, 19.159232328335435, 20.577367473839928, 20.022004197041184, 28.499152928590775, 28.44523821771145, 28.470634751021862, 19.344817156592995, 19.062322134772927, 18.877425173918397, 34.68493112921715, 35.289606830105186, 35.084056328982115, 20.542486774424702, 20.425510237614304, 20.657946354399115, 19.239928781986237, 19.186051733791828, 19.24151873588562, 33.512098530928284, 33.23788021008173, 32.66852382818857, 29.819074638187885, 29.718170512467623, 29.47836983203888, 24.711750273903206, 25.163506654401615, 25.023645622034863, 26.976957763234765, 27.269230051587016, 26.35364271203676, 20.49364572763443, 20.040864035487175, 20.606952220201492, 21.592617617299155, 21.377516915400818, 21.786225680572286, 24.21973658104737, 24.67566903525342, 24.73427963702609, 24.9792917445302, 25.119293913594447, 24.302349388599396, 27.408921757092074, 27.29490192731221, 27.303285767634705, 26.73595868547757, 26.773577151199177, 26.95066266258557, 14.161428092668444, 14.418144408302993, 14.354067380229623, 19.130219772458076, 19.652986723929644, 19.620142590254545, 16.798983931541443, 17.13946333900094, 16.840188436210155, 22.986748491724327, 23.198354368408516, 23.486947457616523, 25.52161035935083, 25.599644834796578, 26.173061098592967, 26.113213660816342, 26.431000928084046, 26.212524535755307, 19.012751554449395, 19.499811319013432, 19.234977302451924, 11.510805825392396, 11.685342306892068, 11.616862306992203, 13.313196413218975, 13.130021840333939, 13.401626336271875, 28.284503904481724, 28.56646088029568, 27.99381372829278, 26.37747503320375, 25.797771657506615, 25.402880678574235, 21.076293393969536, 21.23047767393291, 21.033767323940992, 24.960768535733223, 24.91162856668234, 24.790319964289665, 14.917283738652856, 14.681644710401685, 14.883626057455928, 25.987585105001926, 26.020897805690765, 26.312447746284306, 19.869482398033142, 19.948658376932144, 19.916943062096834, 27.36868855853875, 27.2025337566932, 27.186588508387402, 25.805682957172394, 25.515128530561924, 25.881921879947186, 23.62737277150154, 23.619521647691727, 23.587845653295517, 21.08826044201851, 22.064820893108845, 22.11804818548262, 32.37970459957917, 32.68799517055352, 33.35915105401848, 21.22948286884153, 21.174444463724882, 20.776408808926732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14192465252549913, "mean_inference_ms": 0.6438881816889049, "mean_action_processing_ms": 0.09487971358694548, "mean_env_wait_ms": 0.7965825559864343, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 744000, "timesteps_this_iter": 0, "agent_timesteps_total": 2232000, "timers": {"sample_time_ms": 10022.014, "sample_throughput": 478.946, "load_time_ms": 0.6, "load_throughput": 8002487.956, "learn_time_ms": 1235.983, "learn_throughput": 3883.548, "update_time_ms": 1.803}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 6.7928853034973145, "policy_loss": 0.003089980484025201, "vf_loss": 6.93759423494339, "vf_explained_var": 0.005711682140827179, "kl": 0.016322790412451, "entropy": 15.000500679016113, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 744000, "num_agent_steps_sampled": 2232000, "num_steps_trained": 744000, "num_agent_steps_trained": 2232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3409, "training_iteration": 155, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-06-54", "timestamp": 1706148414, "time_this_iter_s": 9.565002679824829, "time_total_s": 1453.2426764965057, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C225E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1453.2426764965057, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 9.86923076923077, "ram_util_percent": 47.646153846153844}}
{"episode_reward_max": 108.13742878567425, "episode_reward_min": 34.81301043927667, "episode_reward_mean": 70.73567111878918, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 11.510805825392396}, "policy_reward_max": {"shared_policy": 36.55541759512076}, "policy_reward_mean": {"shared_policy": 23.578557039596387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.90829493012279, 69.92871246440333, 65.86114193871616, 66.34971782937644, 40.23625342920421, 75.35607608966527, 63.7403902951628, 87.68099215254185, 74.1350329881534, 94.27955170720814, 83.33083007344975, 81.9272630753694, 60.08245811611411, 76.9617951372638, 79.17923178523776, 80.9634377332404, 69.17193933576344, 66.20385136362162, 55.18618921935557, 44.33057987620123, 79.14335099235176, 108.13742878567425, 78.34442886710167, 77.80105299688873, 62.450805359985665, 88.23074956983328, 58.276163104921565, 75.53759580105542, 61.64548883959648, 101.48130815289912, 67.06935662357137, 70.77013865858315, 72.1387825028505, 77.08017953019589, 76.45172624476253, 77.84456217661499, 58.49085505306718, 73.04297211859375, 64.11240035668014, 48.09073127806185, 94.58107440087768, 45.783573113381834, 69.30984491563865, 73.50996606983242, 65.83756158128381, 97.87078935559836, 59.75860399921655, 85.41502589732409, 57.28456446528432, 105.05859428830445, 61.62594336643812, 57.667499251663685, 99.41850256919858, 89.01561498269439, 74.89890255033968, 80.59983052685854, 61.1414619833231, 64.75636021327226, 73.62968525332688, 74.40093504672404, 82.00710945203899, 80.46019849926232, 42.93363988120106, 58.403349086642265, 50.77863570675254, 69.67205031774937, 77.29431629274038, 78.7567391246557, 57.74754017591475, 34.81301043927667, 39.84484458982479, 84.84477851307018, 77.5781273692846, 63.34053839184344, 74.66271706670523, 44.48255450651047, 78.320930656977, 59.73508383706212, 81.75781082361935, 77.2027333676815, 70.83474007248878, 65.27112952060997, 98.42685082415117, 63.18033614149314, 79.71554973442106, 67.31261800602078, 75.23066248511894, 52.889577883295686, 54.16830091737209, 89.99373402260242, 59.44801676645875, 75.68555246619506, 53.708907287567826, 52.84483857452868, 63.28931333124635, 75.6917876866064, 61.565497495234, 80.22483699116853, 84.10594140738247, 45.82406178209929], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.685960106551647, 29.04929606989026, 29.173038753680885, 23.38219652387002, 23.062409194807202, 23.48410674572611, 21.526963119705513, 22.1098961358269, 22.224282683183745, 21.746490096052483, 22.134947088857487, 22.468280644466475, 13.802561531153813, 12.597562511761978, 13.83612938628842, 25.054250980416924, 25.166884508604795, 25.134940600643546, 21.392011070623994, 21.212545797228813, 21.13583342730999, 29.338031536589057, 29.292594524721295, 29.050366091231496, 24.36052033305168, 24.793270524591208, 24.98124213051051, 30.869785626729325, 31.86056264241536, 31.549203438063458, 27.749512647589043, 28.06102300792311, 27.520294417937592, 27.18903525670369, 27.10579651345809, 27.632431305207618, 19.868161755303532, 20.142639654378087, 20.071656706432492, 25.431010755399853, 25.602047289411217, 25.928737092452735, 26.26564847926298, 26.354338179032, 26.559245126942784, 27.283565438973397, 26.7407846028606, 26.9390876914064, 23.21428220470746, 22.846136574943856, 23.111520556112126, 22.004511798421532, 22.369352960648627, 21.829986604551465, 18.563125764330223, 18.485094492634133, 18.137968962391213, 14.921556431101635, 14.703532800078392, 14.7054906450212, 26.371623461445168, 26.472190299381808, 26.29953723152478, 35.59074805180231, 35.99126313875118, 36.55541759512076, 26.409107133746147, 25.63555797934532, 26.2997637540102, 25.905157602081687, 25.814647669593484, 26.081247725213558, 20.80217183878024, 20.593183202048138, 21.055450319157288, 29.12752355635166, 29.505386345088482, 29.597839668393135, 19.164467220505074, 19.59793521960576, 19.513760664810732, 25.137438946714, 25.205710032333926, 25.194446822007492, 20.59506927865246, 20.54299780415991, 20.50742175678411, 33.918693664173276, 33.516799102226884, 34.04581538649896, 22.77298666862771, 22.406086266040802, 21.890283688902855, 23.651207973559693, 23.723068637152508, 23.39586204787095, 23.807909076412514, 23.889466000099972, 24.441407426338017, 25.5535881370306, 25.62009283900261, 25.90649855416268, 25.249314201374844, 25.530085270603493, 25.67232677278419, 25.9265719850858, 25.751156111558274, 26.16683407997091, 19.53627151499191, 19.58421793828407, 19.3703655997912, 24.372735843993723, 24.322091840207577, 24.348144434392452, 21.223471773167446, 21.334389199813202, 21.554539383699492, 16.12178997447093, 16.363481519122914, 15.60545978446801, 31.488297832508877, 31.713584442074833, 31.379192126293972, 15.052040139834077, 15.350359412531049, 15.381173561016709, 23.058781693379075, 22.879431466261536, 23.371631755998038, 24.598122301201016, 24.920219105357916, 23.991624663273484, 22.39923657849431, 22.249717637896538, 21.18860736489296, 32.71713450054327, 32.41712241868177, 32.736532436373324, 19.159232328335435, 20.577367473839928, 20.022004197041184, 28.499152928590775, 28.44523821771145, 28.470634751021862, 19.344817156592995, 19.062322134772927, 18.877425173918397, 34.68493112921715, 35.289606830105186, 35.084056328982115, 20.542486774424702, 20.425510237614304, 20.657946354399115, 19.239928781986237, 19.186051733791828, 19.24151873588562, 33.512098530928284, 33.23788021008173, 32.66852382818857, 29.819074638187885, 29.718170512467623, 29.47836983203888, 24.711750273903206, 25.163506654401615, 25.023645622034863, 26.976957763234765, 27.269230051587016, 26.35364271203676, 20.49364572763443, 20.040864035487175, 20.606952220201492, 21.592617617299155, 21.377516915400818, 21.786225680572286, 24.21973658104737, 24.67566903525342, 24.73427963702609, 24.9792917445302, 25.119293913594447, 24.302349388599396, 27.408921757092074, 27.29490192731221, 27.303285767634705, 26.73595868547757, 26.773577151199177, 26.95066266258557, 14.161428092668444, 14.418144408302993, 14.354067380229623, 19.130219772458076, 19.652986723929644, 19.620142590254545, 16.798983931541443, 17.13946333900094, 16.840188436210155, 22.986748491724327, 23.198354368408516, 23.486947457616523, 25.52161035935083, 25.599644834796578, 26.173061098592967, 26.113213660816342, 26.431000928084046, 26.212524535755307, 19.012751554449395, 19.499811319013432, 19.234977302451924, 11.510805825392396, 11.685342306892068, 11.616862306992203, 13.313196413218975, 13.130021840333939, 13.401626336271875, 28.284503904481724, 28.56646088029568, 27.99381372829278, 26.37747503320375, 25.797771657506615, 25.402880678574235, 21.076293393969536, 21.23047767393291, 21.033767323940992, 24.960768535733223, 24.91162856668234, 24.790319964289665, 14.917283738652856, 14.681644710401685, 14.883626057455928, 25.987585105001926, 26.020897805690765, 26.312447746284306, 19.869482398033142, 19.948658376932144, 19.916943062096834, 27.36868855853875, 27.2025337566932, 27.186588508387402, 25.805682957172394, 25.515128530561924, 25.881921879947186, 23.62737277150154, 23.619521647691727, 23.587845653295517, 21.08826044201851, 22.064820893108845, 22.11804818548262, 32.37970459957917, 32.68799517055352, 33.35915105401848, 21.22948286884153, 21.174444463724882, 20.776408808926732, 26.767717073050633, 26.584431072076157, 26.36340158929427, 22.52892666682601, 22.301051013171673, 22.482640326023102, 25.39958017955844, 25.1248140198489, 24.7062682857116, 17.55536214510599, 18.22405275485167, 17.11016298333803, 18.32663003665705, 17.935557303329304, 17.90611357738574, 30.142530314003423, 30.021985703458384, 29.829218005140618, 19.9723417237401, 19.45375356078148, 20.02192148193717, 24.463528533776596, 25.595049112414316, 25.62697482000415, 17.75228218982616, 18.06999888146916, 17.886626216272504, 17.706260730822876, 17.931010772784546, 17.207567070921257, 21.213608699540288, 20.871957073609025, 21.203747558097035, 25.30128227826208, 25.025991804897785, 25.36451360344654, 20.69934919973214, 20.792410266896084, 20.073738028605774, 27.046776231067867, 26.54397642115751, 26.634084338943154, 28.215593458463744, 28.239137069632605, 27.651210879286126, 15.038992842038468, 15.089223464330033, 15.695845475730792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14191084670556242, "mean_inference_ms": 0.6439733577492457, "mean_action_processing_ms": 0.0948928165712838, "mean_env_wait_ms": 0.7964931994470075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 748800, "timesteps_this_iter": 0, "agent_timesteps_total": 2246400, "timers": {"sample_time_ms": 10014.626, "sample_throughput": 479.299, "load_time_ms": 0.5, "load_throughput": 9605276.336, "learn_time_ms": 1235.876, "learn_throughput": 3883.884, "update_time_ms": 1.804}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 5.502756774425507, "policy_loss": -0.0009759160299229741, "vf_loss": 5.65167909860611, "vf_explained_var": -0.0012530684471130371, "kl": 0.007314047601753957, "entropy": 14.893488645553589, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 748800, "num_agent_steps_sampled": 2246400, "num_steps_trained": 748800, "num_agent_steps_trained": 2246400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3425, "training_iteration": 156, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-07-03", "timestamp": 1706148423, "time_this_iter_s": 8.94176459312439, "time_total_s": 1462.1844410896301, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1462.1844410896301, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 7.615384615384615, "ram_util_percent": 47.646153846153865}}
{"episode_reward_max": 108.13742878567425, "episode_reward_min": 30.537062138319, "episode_reward_mean": 70.80658374613064, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 10.096615826090172}, "policy_reward_max": {"shared_policy": 36.55541759512076}, "policy_reward_mean": {"shared_policy": 23.602194582043538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.17193933576344, 66.20385136362162, 55.18618921935557, 44.33057987620123, 79.14335099235176, 108.13742878567425, 78.34442886710167, 77.80105299688873, 62.450805359985665, 88.23074956983328, 58.276163104921565, 75.53759580105542, 61.64548883959648, 101.48130815289912, 67.06935662357137, 70.77013865858315, 72.1387825028505, 77.08017953019589, 76.45172624476253, 77.84456217661499, 58.49085505306718, 73.04297211859375, 64.11240035668014, 48.09073127806185, 94.58107440087768, 45.783573113381834, 69.30984491563865, 73.50996606983242, 65.83756158128381, 97.87078935559836, 59.75860399921655, 85.41502589732409, 57.28456446528432, 105.05859428830445, 61.62594336643812, 57.667499251663685, 99.41850256919858, 89.01561498269439, 74.89890255033968, 80.59983052685854, 61.1414619833231, 64.75636021327226, 73.62968525332688, 74.40093504672404, 82.00710945203899, 80.46019849926232, 42.93363988120106, 58.403349086642265, 50.77863570675254, 69.67205031774937, 77.29431629274038, 78.7567391246557, 57.74754017591475, 34.81301043927667, 39.84484458982479, 84.84477851307018, 77.5781273692846, 63.34053839184344, 74.66271706670523, 44.48255450651047, 78.320930656977, 59.73508383706212, 81.75781082361935, 77.2027333676815, 70.83474007248878, 65.27112952060997, 98.42685082415117, 63.18033614149314, 79.71554973442106, 67.31261800602078, 75.23066248511894, 52.889577883295686, 54.16830091737209, 89.99373402260242, 59.44801676645875, 75.68555246619506, 53.708907287567826, 52.84483857452868, 63.28931333124635, 75.6917876866064, 61.565497495234, 80.22483699116853, 84.10594140738247, 45.82406178209929, 68.80599554628134, 102.24096442013978, 62.856412118300796, 74.5661181733012, 88.16162267513573, 63.85767869278787, 74.5375778186135, 69.68306413665414, 85.90078710857776, 64.01168938912448, 78.16780160367487, 80.0372665375471, 91.24109498411416, 30.537062138319, 81.33822671696544, 78.06908041983841], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.21428220470746, 22.846136574943856, 23.111520556112126, 22.004511798421532, 22.369352960648627, 21.829986604551465, 18.563125764330223, 18.485094492634133, 18.137968962391213, 14.921556431101635, 14.703532800078392, 14.7054906450212, 26.371623461445168, 26.472190299381808, 26.29953723152478, 35.59074805180231, 35.99126313875118, 36.55541759512076, 26.409107133746147, 25.63555797934532, 26.2997637540102, 25.905157602081687, 25.814647669593484, 26.081247725213558, 20.80217183878024, 20.593183202048138, 21.055450319157288, 29.12752355635166, 29.505386345088482, 29.597839668393135, 19.164467220505074, 19.59793521960576, 19.513760664810732, 25.137438946714, 25.205710032333926, 25.194446822007492, 20.59506927865246, 20.54299780415991, 20.50742175678411, 33.918693664173276, 33.516799102226884, 34.04581538649896, 22.77298666862771, 22.406086266040802, 21.890283688902855, 23.651207973559693, 23.723068637152508, 23.39586204787095, 23.807909076412514, 23.889466000099972, 24.441407426338017, 25.5535881370306, 25.62009283900261, 25.90649855416268, 25.249314201374844, 25.530085270603493, 25.67232677278419, 25.9265719850858, 25.751156111558274, 26.16683407997091, 19.53627151499191, 19.58421793828407, 19.3703655997912, 24.372735843993723, 24.322091840207577, 24.348144434392452, 21.223471773167446, 21.334389199813202, 21.554539383699492, 16.12178997447093, 16.363481519122914, 15.60545978446801, 31.488297832508877, 31.713584442074833, 31.379192126293972, 15.052040139834077, 15.350359412531049, 15.381173561016709, 23.058781693379075, 22.879431466261536, 23.371631755998038, 24.598122301201016, 24.920219105357916, 23.991624663273484, 22.39923657849431, 22.249717637896538, 21.18860736489296, 32.71713450054327, 32.41712241868177, 32.736532436373324, 19.159232328335435, 20.577367473839928, 20.022004197041184, 28.499152928590775, 28.44523821771145, 28.470634751021862, 19.344817156592995, 19.062322134772927, 18.877425173918397, 34.68493112921715, 35.289606830105186, 35.084056328982115, 20.542486774424702, 20.425510237614304, 20.657946354399115, 19.239928781986237, 19.186051733791828, 19.24151873588562, 33.512098530928284, 33.23788021008173, 32.66852382818857, 29.819074638187885, 29.718170512467623, 29.47836983203888, 24.711750273903206, 25.163506654401615, 25.023645622034863, 26.976957763234765, 27.269230051587016, 26.35364271203676, 20.49364572763443, 20.040864035487175, 20.606952220201492, 21.592617617299155, 21.377516915400818, 21.786225680572286, 24.21973658104737, 24.67566903525342, 24.73427963702609, 24.9792917445302, 25.119293913594447, 24.302349388599396, 27.408921757092074, 27.29490192731221, 27.303285767634705, 26.73595868547757, 26.773577151199177, 26.95066266258557, 14.161428092668444, 14.418144408302993, 14.354067380229623, 19.130219772458076, 19.652986723929644, 19.620142590254545, 16.798983931541443, 17.13946333900094, 16.840188436210155, 22.986748491724327, 23.198354368408516, 23.486947457616523, 25.52161035935083, 25.599644834796578, 26.173061098592967, 26.113213660816342, 26.431000928084046, 26.212524535755307, 19.012751554449395, 19.499811319013432, 19.234977302451924, 11.510805825392396, 11.685342306892068, 11.616862306992203, 13.313196413218975, 13.130021840333939, 13.401626336271875, 28.284503904481724, 28.56646088029568, 27.99381372829278, 26.37747503320375, 25.797771657506615, 25.402880678574235, 21.076293393969536, 21.23047767393291, 21.033767323940992, 24.960768535733223, 24.91162856668234, 24.790319964289665, 14.917283738652856, 14.681644710401685, 14.883626057455928, 25.987585105001926, 26.020897805690765, 26.312447746284306, 19.869482398033142, 19.948658376932144, 19.916943062096834, 27.36868855853875, 27.2025337566932, 27.186588508387402, 25.805682957172394, 25.515128530561924, 25.881921879947186, 23.62737277150154, 23.619521647691727, 23.587845653295517, 21.08826044201851, 22.064820893108845, 22.11804818548262, 32.37970459957917, 32.68799517055352, 33.35915105401848, 21.22948286884153, 21.174444463724882, 20.776408808926732, 26.767717073050633, 26.584431072076157, 26.36340158929427, 22.52892666682601, 22.301051013171673, 22.482640326023102, 25.39958017955844, 25.1248140198489, 24.7062682857116, 17.55536214510599, 18.22405275485167, 17.11016298333803, 18.32663003665705, 17.935557303329304, 17.90611357738574, 30.142530314003423, 30.021985703458384, 29.829218005140618, 19.9723417237401, 19.45375356078148, 20.02192148193717, 24.463528533776596, 25.595049112414316, 25.62697482000415, 17.75228218982616, 18.06999888146916, 17.886626216272504, 17.706260730822876, 17.931010772784546, 17.207567070921257, 21.213608699540288, 20.871957073609025, 21.203747558097035, 25.30128227826208, 25.025991804897785, 25.36451360344654, 20.69934919973214, 20.792410266896084, 20.073738028605774, 27.046776231067867, 26.54397642115751, 26.634084338943154, 28.215593458463744, 28.239137069632605, 27.651210879286126, 15.038992842038468, 15.089223464330033, 15.695845475730792, 22.84236926585436, 22.898441143333912, 23.065185137093067, 33.99416023989518, 33.993053307135895, 34.2537508731087, 20.824617572128773, 20.943635512143373, 21.08815903402865, 25.358327594896153, 24.93157238264878, 24.27621819575627, 29.385975241661072, 29.197431407868862, 29.578216025605798, 21.28166627635558, 21.23749007036288, 21.33852234606941, 24.596701107919216, 25.126966777723283, 24.813909932971, 23.336965568363667, 23.497050549834967, 22.849048018455505, 28.312817404667527, 28.571080381671578, 29.016889322238654, 20.709615657726914, 21.602836419517786, 21.699237311879784, 25.923282725115612, 26.01571764548619, 26.22880123307307, 26.61912267406781, 26.658012097080544, 26.760131766398743, 30.604179238279656, 30.106527616580323, 30.530388129254177, 10.16684429099162, 10.096615826090172, 10.27360202123721, 26.98387510329485, 26.935952708125114, 27.418398905545473, 26.08390363802512, 25.9010513027509, 26.084125479062394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418866364598773, "mean_inference_ms": 0.6440230751953144, "mean_action_processing_ms": 0.09491073478854116, "mean_env_wait_ms": 0.7963915237398642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 753600, "timesteps_this_iter": 0, "agent_timesteps_total": 2260800, "timers": {"sample_time_ms": 9913.489, "sample_throughput": 484.189, "load_time_ms": 0.399, "load_throughput": 12030990.319, "learn_time_ms": 1220.051, "learn_throughput": 3934.263, "update_time_ms": 1.803}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 6.634872317314148, "policy_loss": -0.0008928518404194286, "vf_loss": 6.782666862010956, "vf_explained_var": -0.0008559376001358032, "kl": 0.005727375508498711, "entropy": 14.767606019973755, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 753600, "num_agent_steps_sampled": 2260800, "num_steps_trained": 753600, "num_agent_steps_trained": 2260800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3441, "training_iteration": 157, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-07-11", "timestamp": 1706148431, "time_this_iter_s": 8.939116477966309, "time_total_s": 1471.1235575675964, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1471.1235575675964, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 6.092307692307691, "ram_util_percent": 47.43846153846153}}
{"episode_reward_max": 105.05859428830445, "episode_reward_min": 30.537062138319, "episode_reward_mean": 71.33373177539703, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 10.096615826090172}, "policy_reward_max": {"shared_policy": 35.289606830105186}, "policy_reward_mean": {"shared_policy": 23.777910591799003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.1387825028505, 77.08017953019589, 76.45172624476253, 77.84456217661499, 58.49085505306718, 73.04297211859375, 64.11240035668014, 48.09073127806185, 94.58107440087768, 45.783573113381834, 69.30984491563865, 73.50996606983242, 65.83756158128381, 97.87078935559836, 59.75860399921655, 85.41502589732409, 57.28456446528432, 105.05859428830445, 61.62594336643812, 57.667499251663685, 99.41850256919858, 89.01561498269439, 74.89890255033968, 80.59983052685854, 61.1414619833231, 64.75636021327226, 73.62968525332688, 74.40093504672404, 82.00710945203899, 80.46019849926232, 42.93363988120106, 58.403349086642265, 50.77863570675254, 69.67205031774937, 77.29431629274038, 78.7567391246557, 57.74754017591475, 34.81301043927667, 39.84484458982479, 84.84477851307018, 77.5781273692846, 63.34053839184344, 74.66271706670523, 44.48255450651047, 78.320930656977, 59.73508383706212, 81.75781082361935, 77.2027333676815, 70.83474007248878, 65.27112952060997, 98.42685082415117, 63.18033614149314, 79.71554973442106, 67.31261800602078, 75.23066248511894, 52.889577883295686, 54.16830091737209, 89.99373402260242, 59.44801676645875, 75.68555246619506, 53.708907287567826, 52.84483857452868, 63.28931333124635, 75.6917876866064, 61.565497495234, 80.22483699116853, 84.10594140738247, 45.82406178209929, 68.80599554628134, 102.24096442013978, 62.856412118300796, 74.5661181733012, 88.16162267513573, 63.85767869278787, 74.5375778186135, 69.68306413665414, 85.90078710857776, 64.01168938912448, 78.16780160367487, 80.0372665375471, 91.24109498411416, 30.537062138319, 81.33822671696544, 78.06908041983841, 59.15791337937115, 73.73244857229291, 97.50015701353547, 90.8952367864549, 74.51283621042964, 87.31714135035872, 104.01243470981714, 79.31306063290683, 64.567745690234, 65.65715834498405, 64.11744036525488, 71.03996237367392, 87.8157012052834, 61.00574008002876, 45.78051737928763, 90.06973638013005], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.807909076412514, 23.889466000099972, 24.441407426338017, 25.5535881370306, 25.62009283900261, 25.90649855416268, 25.249314201374844, 25.530085270603493, 25.67232677278419, 25.9265719850858, 25.751156111558274, 26.16683407997091, 19.53627151499191, 19.58421793828407, 19.3703655997912, 24.372735843993723, 24.322091840207577, 24.348144434392452, 21.223471773167446, 21.334389199813202, 21.554539383699492, 16.12178997447093, 16.363481519122914, 15.60545978446801, 31.488297832508877, 31.713584442074833, 31.379192126293972, 15.052040139834077, 15.350359412531049, 15.381173561016709, 23.058781693379075, 22.879431466261536, 23.371631755998038, 24.598122301201016, 24.920219105357916, 23.991624663273484, 22.39923657849431, 22.249717637896538, 21.18860736489296, 32.71713450054327, 32.41712241868177, 32.736532436373324, 19.159232328335435, 20.577367473839928, 20.022004197041184, 28.499152928590775, 28.44523821771145, 28.470634751021862, 19.344817156592995, 19.062322134772927, 18.877425173918397, 34.68493112921715, 35.289606830105186, 35.084056328982115, 20.542486774424702, 20.425510237614304, 20.657946354399115, 19.239928781986237, 19.186051733791828, 19.24151873588562, 33.512098530928284, 33.23788021008173, 32.66852382818857, 29.819074638187885, 29.718170512467623, 29.47836983203888, 24.711750273903206, 25.163506654401615, 25.023645622034863, 26.976957763234765, 27.269230051587016, 26.35364271203676, 20.49364572763443, 20.040864035487175, 20.606952220201492, 21.592617617299155, 21.377516915400818, 21.786225680572286, 24.21973658104737, 24.67566903525342, 24.73427963702609, 24.9792917445302, 25.119293913594447, 24.302349388599396, 27.408921757092074, 27.29490192731221, 27.303285767634705, 26.73595868547757, 26.773577151199177, 26.95066266258557, 14.161428092668444, 14.418144408302993, 14.354067380229623, 19.130219772458076, 19.652986723929644, 19.620142590254545, 16.798983931541443, 17.13946333900094, 16.840188436210155, 22.986748491724327, 23.198354368408516, 23.486947457616523, 25.52161035935083, 25.599644834796578, 26.173061098592967, 26.113213660816342, 26.431000928084046, 26.212524535755307, 19.012751554449395, 19.499811319013432, 19.234977302451924, 11.510805825392396, 11.685342306892068, 11.616862306992203, 13.313196413218975, 13.130021840333939, 13.401626336271875, 28.284503904481724, 28.56646088029568, 27.99381372829278, 26.37747503320375, 25.797771657506615, 25.402880678574235, 21.076293393969536, 21.23047767393291, 21.033767323940992, 24.960768535733223, 24.91162856668234, 24.790319964289665, 14.917283738652856, 14.681644710401685, 14.883626057455928, 25.987585105001926, 26.020897805690765, 26.312447746284306, 19.869482398033142, 19.948658376932144, 19.916943062096834, 27.36868855853875, 27.2025337566932, 27.186588508387402, 25.805682957172394, 25.515128530561924, 25.881921879947186, 23.62737277150154, 23.619521647691727, 23.587845653295517, 21.08826044201851, 22.064820893108845, 22.11804818548262, 32.37970459957917, 32.68799517055352, 33.35915105401848, 21.22948286884153, 21.174444463724882, 20.776408808926732, 26.767717073050633, 26.584431072076157, 26.36340158929427, 22.52892666682601, 22.301051013171673, 22.482640326023102, 25.39958017955844, 25.1248140198489, 24.7062682857116, 17.55536214510599, 18.22405275485167, 17.11016298333803, 18.32663003665705, 17.935557303329304, 17.90611357738574, 30.142530314003423, 30.021985703458384, 29.829218005140618, 19.9723417237401, 19.45375356078148, 20.02192148193717, 24.463528533776596, 25.595049112414316, 25.62697482000415, 17.75228218982616, 18.06999888146916, 17.886626216272504, 17.706260730822876, 17.931010772784546, 17.207567070921257, 21.213608699540288, 20.871957073609025, 21.203747558097035, 25.30128227826208, 25.025991804897785, 25.36451360344654, 20.69934919973214, 20.792410266896084, 20.073738028605774, 27.046776231067867, 26.54397642115751, 26.634084338943154, 28.215593458463744, 28.239137069632605, 27.651210879286126, 15.038992842038468, 15.089223464330033, 15.695845475730792, 22.84236926585436, 22.898441143333912, 23.065185137093067, 33.99416023989518, 33.993053307135895, 34.2537508731087, 20.824617572128773, 20.943635512143373, 21.08815903402865, 25.358327594896153, 24.93157238264878, 24.27621819575627, 29.385975241661072, 29.197431407868862, 29.578216025605798, 21.28166627635558, 21.23749007036288, 21.33852234606941, 24.596701107919216, 25.126966777723283, 24.813909932971, 23.336965568363667, 23.497050549834967, 22.849048018455505, 28.312817404667527, 28.571080381671578, 29.016889322238654, 20.709615657726914, 21.602836419517786, 21.699237311879784, 25.923282725115612, 26.01571764548619, 26.22880123307307, 26.61912267406781, 26.658012097080544, 26.760131766398743, 30.604179238279656, 30.106527616580323, 30.530388129254177, 10.16684429099162, 10.096615826090172, 10.27360202123721, 26.98387510329485, 26.935952708125114, 27.418398905545473, 26.08390363802512, 25.9010513027509, 26.084125479062394, 19.627558705707386, 19.740990200390414, 19.789364473273352, 24.628315949191645, 24.791135358934596, 24.31299726416667, 32.630930236230284, 32.53302752102414, 32.33619925628105, 30.138985117276505, 30.379310895999268, 30.37694077317913, 25.15615085574487, 25.18316135245064, 24.17352400223413, 28.779113367199898, 28.922148197889328, 29.6158797852695, 34.596340912083775, 34.801255515466124, 34.61483828226724, 26.17549607406059, 26.580860897588224, 26.556703661258013, 21.573908280581236, 21.74501817021519, 21.24881923943758, 21.79168462753296, 22.046462409198284, 21.81901130825281, 21.241878286004066, 21.47437870129943, 21.401183377951384, 23.944266133010387, 23.308797731995583, 23.786898508667946, 29.53417904302478, 29.379316993057728, 28.902205169200897, 20.141862546404198, 20.558321074893072, 20.305556458731488, 15.742611260153353, 14.285829871892929, 15.752076247241348, 30.161400768905878, 30.17769304662943, 29.730642564594746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14185353119836466, "mean_inference_ms": 0.6440472765073727, "mean_action_processing_ms": 0.0949189023952433, "mean_env_wait_ms": 0.7962743046708429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 758400, "timesteps_this_iter": 0, "agent_timesteps_total": 2275200, "timers": {"sample_time_ms": 9805.783, "sample_throughput": 489.507, "load_time_ms": 0.299, "load_throughput": 16050912.222, "learn_time_ms": 1216.652, "learn_throughput": 3945.254, "update_time_ms": 1.903}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 6.922138512134552, "policy_loss": -0.0012368245525511412, "vf_loss": 7.0710039138793945, "vf_explained_var": 0.0021767616271972656, "kl": 0.007179373817267554, "entropy": 14.859887957572937, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 758400, "num_agent_steps_sampled": 2275200, "num_steps_trained": 758400, "num_agent_steps_trained": 2275200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3457, "training_iteration": 158, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-07-21", "timestamp": 1706148441, "time_this_iter_s": 9.056230545043945, "time_total_s": 1480.1797881126404, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1480.1797881126404, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 10.069230769230769, "ram_util_percent": 47.39999999999999}}
{"episode_reward_max": 105.05859428830445, "episode_reward_min": 30.105561524629564, "episode_reward_mean": 71.08185625026599, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.69822674492994}, "policy_reward_max": {"shared_policy": 35.289606830105186}, "policy_reward_mean": {"shared_policy": 23.69395208342199}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.28456446528432, 105.05859428830445, 61.62594336643812, 57.667499251663685, 99.41850256919858, 89.01561498269439, 74.89890255033968, 80.59983052685854, 61.1414619833231, 64.75636021327226, 73.62968525332688, 74.40093504672404, 82.00710945203899, 80.46019849926232, 42.93363988120106, 58.403349086642265, 50.77863570675254, 69.67205031774937, 77.29431629274038, 78.7567391246557, 57.74754017591475, 34.81301043927667, 39.84484458982479, 84.84477851307018, 77.5781273692846, 63.34053839184344, 74.66271706670523, 44.48255450651047, 78.320930656977, 59.73508383706212, 81.75781082361935, 77.2027333676815, 70.83474007248878, 65.27112952060997, 98.42685082415117, 63.18033614149314, 79.71554973442106, 67.31261800602078, 75.23066248511894, 52.889577883295686, 54.16830091737209, 89.99373402260242, 59.44801676645875, 75.68555246619506, 53.708907287567826, 52.84483857452868, 63.28931333124635, 75.6917876866064, 61.565497495234, 80.22483699116853, 84.10594140738247, 45.82406178209929, 68.80599554628134, 102.24096442013978, 62.856412118300796, 74.5661181733012, 88.16162267513573, 63.85767869278787, 74.5375778186135, 69.68306413665414, 85.90078710857776, 64.01168938912448, 78.16780160367487, 80.0372665375471, 91.24109498411416, 30.537062138319, 81.33822671696544, 78.06908041983841, 59.15791337937115, 73.73244857229291, 97.50015701353547, 90.8952367864549, 74.51283621042964, 87.31714135035872, 104.01243470981714, 79.31306063290683, 64.567745690234, 65.65715834498405, 64.11744036525488, 71.03996237367392, 87.8157012052834, 61.00574008002876, 45.78051737928763, 90.06973638013005, 78.29462920129299, 49.38817006442693, 44.4718526266515, 80.49819252733138, 66.99680719524622, 67.71313961315899, 72.93573281541467, 98.57988386042413, 80.00689371675253, 61.23652673140165, 82.8135506212711, 30.105561524629564, 54.875611025840016, 75.07592789083718, 83.73373112455009, 87.40488554164766], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.344817156592995, 19.062322134772927, 18.877425173918397, 34.68493112921715, 35.289606830105186, 35.084056328982115, 20.542486774424702, 20.425510237614304, 20.657946354399115, 19.239928781986237, 19.186051733791828, 19.24151873588562, 33.512098530928284, 33.23788021008173, 32.66852382818857, 29.819074638187885, 29.718170512467623, 29.47836983203888, 24.711750273903206, 25.163506654401615, 25.023645622034863, 26.976957763234765, 27.269230051587016, 26.35364271203676, 20.49364572763443, 20.040864035487175, 20.606952220201492, 21.592617617299155, 21.377516915400818, 21.786225680572286, 24.21973658104737, 24.67566903525342, 24.73427963702609, 24.9792917445302, 25.119293913594447, 24.302349388599396, 27.408921757092074, 27.29490192731221, 27.303285767634705, 26.73595868547757, 26.773577151199177, 26.95066266258557, 14.161428092668444, 14.418144408302993, 14.354067380229623, 19.130219772458076, 19.652986723929644, 19.620142590254545, 16.798983931541443, 17.13946333900094, 16.840188436210155, 22.986748491724327, 23.198354368408516, 23.486947457616523, 25.52161035935083, 25.599644834796578, 26.173061098592967, 26.113213660816342, 26.431000928084046, 26.212524535755307, 19.012751554449395, 19.499811319013432, 19.234977302451924, 11.510805825392396, 11.685342306892068, 11.616862306992203, 13.313196413218975, 13.130021840333939, 13.401626336271875, 28.284503904481724, 28.56646088029568, 27.99381372829278, 26.37747503320375, 25.797771657506615, 25.402880678574235, 21.076293393969536, 21.23047767393291, 21.033767323940992, 24.960768535733223, 24.91162856668234, 24.790319964289665, 14.917283738652856, 14.681644710401685, 14.883626057455928, 25.987585105001926, 26.020897805690765, 26.312447746284306, 19.869482398033142, 19.948658376932144, 19.916943062096834, 27.36868855853875, 27.2025337566932, 27.186588508387402, 25.805682957172394, 25.515128530561924, 25.881921879947186, 23.62737277150154, 23.619521647691727, 23.587845653295517, 21.08826044201851, 22.064820893108845, 22.11804818548262, 32.37970459957917, 32.68799517055352, 33.35915105401848, 21.22948286884153, 21.174444463724882, 20.776408808926732, 26.767717073050633, 26.584431072076157, 26.36340158929427, 22.52892666682601, 22.301051013171673, 22.482640326023102, 25.39958017955844, 25.1248140198489, 24.7062682857116, 17.55536214510599, 18.22405275485167, 17.11016298333803, 18.32663003665705, 17.935557303329304, 17.90611357738574, 30.142530314003423, 30.021985703458384, 29.829218005140618, 19.9723417237401, 19.45375356078148, 20.02192148193717, 24.463528533776596, 25.595049112414316, 25.62697482000415, 17.75228218982616, 18.06999888146916, 17.886626216272504, 17.706260730822876, 17.931010772784546, 17.207567070921257, 21.213608699540288, 20.871957073609025, 21.203747558097035, 25.30128227826208, 25.025991804897785, 25.36451360344654, 20.69934919973214, 20.792410266896084, 20.073738028605774, 27.046776231067867, 26.54397642115751, 26.634084338943154, 28.215593458463744, 28.239137069632605, 27.651210879286126, 15.038992842038468, 15.089223464330033, 15.695845475730792, 22.84236926585436, 22.898441143333912, 23.065185137093067, 33.99416023989518, 33.993053307135895, 34.2537508731087, 20.824617572128773, 20.943635512143373, 21.08815903402865, 25.358327594896153, 24.93157238264878, 24.27621819575627, 29.385975241661072, 29.197431407868862, 29.578216025605798, 21.28166627635558, 21.23749007036288, 21.33852234606941, 24.596701107919216, 25.126966777723283, 24.813909932971, 23.336965568363667, 23.497050549834967, 22.849048018455505, 28.312817404667527, 28.571080381671578, 29.016889322238654, 20.709615657726914, 21.602836419517786, 21.699237311879784, 25.923282725115612, 26.01571764548619, 26.22880123307307, 26.61912267406781, 26.658012097080544, 26.760131766398743, 30.604179238279656, 30.106527616580323, 30.530388129254177, 10.16684429099162, 10.096615826090172, 10.27360202123721, 26.98387510329485, 26.935952708125114, 27.418398905545473, 26.08390363802512, 25.9010513027509, 26.084125479062394, 19.627558705707386, 19.740990200390414, 19.789364473273352, 24.628315949191645, 24.791135358934596, 24.31299726416667, 32.630930236230284, 32.53302752102414, 32.33619925628105, 30.138985117276505, 30.379310895999268, 30.37694077317913, 25.15615085574487, 25.18316135245064, 24.17352400223413, 28.779113367199898, 28.922148197889328, 29.6158797852695, 34.596340912083775, 34.801255515466124, 34.61483828226724, 26.17549607406059, 26.580860897588224, 26.556703661258013, 21.573908280581236, 21.74501817021519, 21.24881923943758, 21.79168462753296, 22.046462409198284, 21.81901130825281, 21.241878286004066, 21.47437870129943, 21.401183377951384, 23.944266133010387, 23.308797731995583, 23.786898508667946, 29.53417904302478, 29.379316993057728, 28.902205169200897, 20.141862546404198, 20.558321074893072, 20.305556458731488, 15.742611260153353, 14.285829871892929, 15.752076247241348, 30.161400768905878, 30.17769304662943, 29.730642564594746, 26.44143359363079, 25.536944657564163, 26.316250950098038, 16.430689762035996, 16.840675081747264, 16.11680522064367, 14.967857523510844, 14.800117927292973, 14.70387717584768, 26.806252452234418, 26.558204556504876, 27.13373551859209, 22.386530861258507, 22.40235712379217, 22.20791921019554, 22.451182154317692, 22.43477165450652, 22.827185804334775, 23.99820552766323, 24.34016877412796, 24.597358513623476, 32.698215449849755, 32.69197346518436, 33.189694945390016, 26.43124482035637, 27.079785116016865, 26.495863780379295, 20.20223148415485, 20.582733436177165, 20.451561811069638, 27.67025431493917, 27.342198098699242, 27.80109820763269, 10.209717186788708, 10.197617592910916, 9.69822674492994, 18.339330236117036, 18.03188746670881, 18.50439332301417, 24.93982922037442, 25.138118897875145, 24.997979772587613, 28.096402054031685, 27.65048525234063, 27.986843818177775, 29.11662871887286, 29.113324405004576, 29.174932417770222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14180864789037506, "mean_inference_ms": 0.644030483624518, "mean_action_processing_ms": 0.09491485456216095, "mean_env_wait_ms": 0.796134306670836, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 763200, "timesteps_this_iter": 0, "agent_timesteps_total": 2289600, "timers": {"sample_time_ms": 9777.582, "sample_throughput": 490.919, "load_time_ms": 0.3, "load_throughput": 16025359.548, "learn_time_ms": 1193.203, "learn_throughput": 4022.787, "update_time_ms": 1.804}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 6.3797988295555115, "policy_loss": -0.00032501700859732807, "vf_loss": 6.529430508613586, "vf_explained_var": -0.0031510591506958008, "kl": 0.006432690890722435, "entropy": 15.017648220062256, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 763200, "num_agent_steps_sampled": 2289600, "num_steps_trained": 763200, "num_agent_steps_trained": 2289600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3473, "training_iteration": 159, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-07-30", "timestamp": 1706148450, "time_this_iter_s": 8.966557502746582, "time_total_s": 1489.146345615387, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1489.146345615387, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 9.841666666666665, "ram_util_percent": 47.449999999999996}}
{"episode_reward_max": 104.01243470981714, "episode_reward_min": 30.105561524629564, "episode_reward_mean": 70.87180883499096, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.69822674492994}, "policy_reward_max": {"shared_policy": 34.801255515466124}, "policy_reward_mean": {"shared_policy": 23.623936278330312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.77863570675254, 69.67205031774937, 77.29431629274038, 78.7567391246557, 57.74754017591475, 34.81301043927667, 39.84484458982479, 84.84477851307018, 77.5781273692846, 63.34053839184344, 74.66271706670523, 44.48255450651047, 78.320930656977, 59.73508383706212, 81.75781082361935, 77.2027333676815, 70.83474007248878, 65.27112952060997, 98.42685082415117, 63.18033614149314, 79.71554973442106, 67.31261800602078, 75.23066248511894, 52.889577883295686, 54.16830091737209, 89.99373402260242, 59.44801676645875, 75.68555246619506, 53.708907287567826, 52.84483857452868, 63.28931333124635, 75.6917876866064, 61.565497495234, 80.22483699116853, 84.10594140738247, 45.82406178209929, 68.80599554628134, 102.24096442013978, 62.856412118300796, 74.5661181733012, 88.16162267513573, 63.85767869278787, 74.5375778186135, 69.68306413665414, 85.90078710857776, 64.01168938912448, 78.16780160367487, 80.0372665375471, 91.24109498411416, 30.537062138319, 81.33822671696544, 78.06908041983841, 59.15791337937115, 73.73244857229291, 97.50015701353547, 90.8952367864549, 74.51283621042964, 87.31714135035872, 104.01243470981714, 79.31306063290683, 64.567745690234, 65.65715834498405, 64.11744036525488, 71.03996237367392, 87.8157012052834, 61.00574008002876, 45.78051737928763, 90.06973638013005, 78.29462920129299, 49.38817006442693, 44.4718526266515, 80.49819252733138, 66.99680719524622, 67.71313961315899, 72.93573281541467, 98.57988386042413, 80.00689371675253, 61.23652673140165, 82.8135506212711, 30.105561524629564, 54.875611025840016, 75.07592789083718, 83.73373112455009, 87.40488554164766, 70.01887429133058, 57.62946513295174, 59.540221102011856, 90.38627834245563, 49.17351546138522, 46.46027953922746, 74.70580909121779, 70.2831029789522, 69.62109159352256, 85.41167881339786, 81.67278988286851, 74.11594762653111, 66.052809625864, 90.15546734631062, 75.29666970716787, 81.77344935387373], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.798983931541443, 17.13946333900094, 16.840188436210155, 22.986748491724327, 23.198354368408516, 23.486947457616523, 25.52161035935083, 25.599644834796578, 26.173061098592967, 26.113213660816342, 26.431000928084046, 26.212524535755307, 19.012751554449395, 19.499811319013432, 19.234977302451924, 11.510805825392396, 11.685342306892068, 11.616862306992203, 13.313196413218975, 13.130021840333939, 13.401626336271875, 28.284503904481724, 28.56646088029568, 27.99381372829278, 26.37747503320375, 25.797771657506615, 25.402880678574235, 21.076293393969536, 21.23047767393291, 21.033767323940992, 24.960768535733223, 24.91162856668234, 24.790319964289665, 14.917283738652856, 14.681644710401685, 14.883626057455928, 25.987585105001926, 26.020897805690765, 26.312447746284306, 19.869482398033142, 19.948658376932144, 19.916943062096834, 27.36868855853875, 27.2025337566932, 27.186588508387402, 25.805682957172394, 25.515128530561924, 25.881921879947186, 23.62737277150154, 23.619521647691727, 23.587845653295517, 21.08826044201851, 22.064820893108845, 22.11804818548262, 32.37970459957917, 32.68799517055352, 33.35915105401848, 21.22948286884153, 21.174444463724882, 20.776408808926732, 26.767717073050633, 26.584431072076157, 26.36340158929427, 22.52892666682601, 22.301051013171673, 22.482640326023102, 25.39958017955844, 25.1248140198489, 24.7062682857116, 17.55536214510599, 18.22405275485167, 17.11016298333803, 18.32663003665705, 17.935557303329304, 17.90611357738574, 30.142530314003423, 30.021985703458384, 29.829218005140618, 19.9723417237401, 19.45375356078148, 20.02192148193717, 24.463528533776596, 25.595049112414316, 25.62697482000415, 17.75228218982616, 18.06999888146916, 17.886626216272504, 17.706260730822876, 17.931010772784546, 17.207567070921257, 21.213608699540288, 20.871957073609025, 21.203747558097035, 25.30128227826208, 25.025991804897785, 25.36451360344654, 20.69934919973214, 20.792410266896084, 20.073738028605774, 27.046776231067867, 26.54397642115751, 26.634084338943154, 28.215593458463744, 28.239137069632605, 27.651210879286126, 15.038992842038468, 15.089223464330033, 15.695845475730792, 22.84236926585436, 22.898441143333912, 23.065185137093067, 33.99416023989518, 33.993053307135895, 34.2537508731087, 20.824617572128773, 20.943635512143373, 21.08815903402865, 25.358327594896153, 24.93157238264878, 24.27621819575627, 29.385975241661072, 29.197431407868862, 29.578216025605798, 21.28166627635558, 21.23749007036288, 21.33852234606941, 24.596701107919216, 25.126966777723283, 24.813909932971, 23.336965568363667, 23.497050549834967, 22.849048018455505, 28.312817404667527, 28.571080381671578, 29.016889322238654, 20.709615657726914, 21.602836419517786, 21.699237311879784, 25.923282725115612, 26.01571764548619, 26.22880123307307, 26.61912267406781, 26.658012097080544, 26.760131766398743, 30.604179238279656, 30.106527616580323, 30.530388129254177, 10.16684429099162, 10.096615826090172, 10.27360202123721, 26.98387510329485, 26.935952708125114, 27.418398905545473, 26.08390363802512, 25.9010513027509, 26.084125479062394, 19.627558705707386, 19.740990200390414, 19.789364473273352, 24.628315949191645, 24.791135358934596, 24.31299726416667, 32.630930236230284, 32.53302752102414, 32.33619925628105, 30.138985117276505, 30.379310895999268, 30.37694077317913, 25.15615085574487, 25.18316135245064, 24.17352400223413, 28.779113367199898, 28.922148197889328, 29.6158797852695, 34.596340912083775, 34.801255515466124, 34.61483828226724, 26.17549607406059, 26.580860897588224, 26.556703661258013, 21.573908280581236, 21.74501817021519, 21.24881923943758, 21.79168462753296, 22.046462409198284, 21.81901130825281, 21.241878286004066, 21.47437870129943, 21.401183377951384, 23.944266133010387, 23.308797731995583, 23.786898508667946, 29.53417904302478, 29.379316993057728, 28.902205169200897, 20.141862546404198, 20.558321074893072, 20.305556458731488, 15.742611260153353, 14.285829871892929, 15.752076247241348, 30.161400768905878, 30.17769304662943, 29.730642564594746, 26.44143359363079, 25.536944657564163, 26.316250950098038, 16.430689762035996, 16.840675081747264, 16.11680522064367, 14.967857523510844, 14.800117927292973, 14.70387717584768, 26.806252452234418, 26.558204556504876, 27.13373551859209, 22.386530861258507, 22.40235712379217, 22.20791921019554, 22.451182154317692, 22.43477165450652, 22.827185804334775, 23.99820552766323, 24.34016877412796, 24.597358513623476, 32.698215449849755, 32.69197346518436, 33.189694945390016, 26.43124482035637, 27.079785116016865, 26.495863780379295, 20.20223148415485, 20.582733436177165, 20.451561811069638, 27.67025431493917, 27.342198098699242, 27.80109820763269, 10.209717186788708, 10.197617592910916, 9.69822674492994, 18.339330236117036, 18.03188746670881, 18.50439332301417, 24.93982922037442, 25.138118897875145, 24.997979772587613, 28.096402054031685, 27.65048525234063, 27.986843818177775, 29.11662871887286, 29.113324405004576, 29.174932417770222, 22.839976727962494, 23.58083413168788, 23.598063431680202, 19.378595367074013, 18.91303116083145, 19.337838605046272, 20.15163327701157, 19.689712941646576, 19.69887488335371, 30.216178935021162, 30.09951150417328, 30.070587903261185, 16.24587222437063, 16.469091358284146, 16.458551878730447, 15.879851112763077, 15.41241584221521, 15.168012584249169, 25.043134592163057, 24.939644421140343, 24.723030077914387, 23.627350944715232, 23.520275889585406, 23.135476144651562, 23.12391160180171, 23.429218115129814, 23.067961876591042, 28.3145864556233, 28.717802005509526, 28.37929035226503, 27.26771412727733, 27.09340940540035, 27.311666350190833, 24.592302923401192, 24.864155945678547, 24.65948875745137, 21.68549772600332, 22.182148250440747, 22.185163649419934, 30.181636944413185, 29.837567791342735, 30.136262610554695, 24.908996286491544, 25.240044937624276, 25.147628483052046, 27.368195325136185, 27.032560527324677, 27.37269350141287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14175977827627378, "mean_inference_ms": 0.6439739460791377, "mean_action_processing_ms": 0.09490373706341028, "mean_env_wait_ms": 0.795984585961763, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 768000, "timesteps_this_iter": 0, "agent_timesteps_total": 2304000, "timers": {"sample_time_ms": 9689.871, "sample_throughput": 495.363, "load_time_ms": 0.3, "load_throughput": 16025359.548, "learn_time_ms": 1194.097, "learn_throughput": 4019.775, "update_time_ms": 1.704}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 4.587078928947449, "policy_loss": -0.0018062398552622927, "vf_loss": 4.73763245344162, "vf_explained_var": -0.0025147348642349243, "kl": 0.006688675290424887, "entropy": 14.965113162994385, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 768000, "num_agent_steps_sampled": 2304000, "num_steps_trained": 768000, "num_agent_steps_trained": 2304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3489, "training_iteration": 160, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-07-38", "timestamp": 1706148458, "time_this_iter_s": 8.915290355682373, "time_total_s": 1498.0616359710693, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004ECDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1498.0616359710693, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 6.4923076923076914, "ram_util_percent": 47.46153846153846}}
{"episode_reward_max": 104.01243470981714, "episode_reward_min": 30.105561524629564, "episode_reward_mean": 73.56917564964505, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.69822674492994}, "policy_reward_max": {"shared_policy": 34.801255515466124}, "policy_reward_mean": {"shared_policy": 24.523058549881675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.83474007248878, 65.27112952060997, 98.42685082415117, 63.18033614149314, 79.71554973442106, 67.31261800602078, 75.23066248511894, 52.889577883295686, 54.16830091737209, 89.99373402260242, 59.44801676645875, 75.68555246619506, 53.708907287567826, 52.84483857452868, 63.28931333124635, 75.6917876866064, 61.565497495234, 80.22483699116853, 84.10594140738247, 45.82406178209929, 68.80599554628134, 102.24096442013978, 62.856412118300796, 74.5661181733012, 88.16162267513573, 63.85767869278787, 74.5375778186135, 69.68306413665414, 85.90078710857776, 64.01168938912448, 78.16780160367487, 80.0372665375471, 91.24109498411416, 30.537062138319, 81.33822671696544, 78.06908041983841, 59.15791337937115, 73.73244857229291, 97.50015701353547, 90.8952367864549, 74.51283621042964, 87.31714135035872, 104.01243470981714, 79.31306063290683, 64.567745690234, 65.65715834498405, 64.11744036525488, 71.03996237367392, 87.8157012052834, 61.00574008002876, 45.78051737928763, 90.06973638013005, 78.29462920129299, 49.38817006442693, 44.4718526266515, 80.49819252733138, 66.99680719524622, 67.71313961315899, 72.93573281541467, 98.57988386042413, 80.00689371675253, 61.23652673140165, 82.8135506212711, 30.105561524629564, 54.875611025840016, 75.07592789083718, 83.73373112455009, 87.40488554164766, 70.01887429133058, 57.62946513295174, 59.540221102011856, 90.38627834245563, 49.17351546138522, 46.46027953922746, 74.70580909121779, 70.2831029789522, 69.62109159352256, 85.41167881339786, 81.67278988286851, 74.11594762653111, 66.052809625864, 90.15546734631062, 75.29666970716787, 81.77344935387373, 73.72757717594503, 93.91306136548519, 95.91800163313746, 56.29057533666489, 70.30410274490711, 75.58068867027758, 91.93224016530439, 91.05075668543576, 101.85785397514701, 90.33763705752787, 93.95240453630683, 76.1141029880382, 84.05106341838837, 75.14242051914334, 70.47511601983567, 79.9214903535321], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.62737277150154, 23.619521647691727, 23.587845653295517, 21.08826044201851, 22.064820893108845, 22.11804818548262, 32.37970459957917, 32.68799517055352, 33.35915105401848, 21.22948286884153, 21.174444463724882, 20.776408808926732, 26.767717073050633, 26.584431072076157, 26.36340158929427, 22.52892666682601, 22.301051013171673, 22.482640326023102, 25.39958017955844, 25.1248140198489, 24.7062682857116, 17.55536214510599, 18.22405275485167, 17.11016298333803, 18.32663003665705, 17.935557303329304, 17.90611357738574, 30.142530314003423, 30.021985703458384, 29.829218005140618, 19.9723417237401, 19.45375356078148, 20.02192148193717, 24.463528533776596, 25.595049112414316, 25.62697482000415, 17.75228218982616, 18.06999888146916, 17.886626216272504, 17.706260730822876, 17.931010772784546, 17.207567070921257, 21.213608699540288, 20.871957073609025, 21.203747558097035, 25.30128227826208, 25.025991804897785, 25.36451360344654, 20.69934919973214, 20.792410266896084, 20.073738028605774, 27.046776231067867, 26.54397642115751, 26.634084338943154, 28.215593458463744, 28.239137069632605, 27.651210879286126, 15.038992842038468, 15.089223464330033, 15.695845475730792, 22.84236926585436, 22.898441143333912, 23.065185137093067, 33.99416023989518, 33.993053307135895, 34.2537508731087, 20.824617572128773, 20.943635512143373, 21.08815903402865, 25.358327594896153, 24.93157238264878, 24.27621819575627, 29.385975241661072, 29.197431407868862, 29.578216025605798, 21.28166627635558, 21.23749007036288, 21.33852234606941, 24.596701107919216, 25.126966777723283, 24.813909932971, 23.336965568363667, 23.497050549834967, 22.849048018455505, 28.312817404667527, 28.571080381671578, 29.016889322238654, 20.709615657726914, 21.602836419517786, 21.699237311879784, 25.923282725115612, 26.01571764548619, 26.22880123307307, 26.61912267406781, 26.658012097080544, 26.760131766398743, 30.604179238279656, 30.106527616580323, 30.530388129254177, 10.16684429099162, 10.096615826090172, 10.27360202123721, 26.98387510329485, 26.935952708125114, 27.418398905545473, 26.08390363802512, 25.9010513027509, 26.084125479062394, 19.627558705707386, 19.740990200390414, 19.789364473273352, 24.628315949191645, 24.791135358934596, 24.31299726416667, 32.630930236230284, 32.53302752102414, 32.33619925628105, 30.138985117276505, 30.379310895999268, 30.37694077317913, 25.15615085574487, 25.18316135245064, 24.17352400223413, 28.779113367199898, 28.922148197889328, 29.6158797852695, 34.596340912083775, 34.801255515466124, 34.61483828226724, 26.17549607406059, 26.580860897588224, 26.556703661258013, 21.573908280581236, 21.74501817021519, 21.24881923943758, 21.79168462753296, 22.046462409198284, 21.81901130825281, 21.241878286004066, 21.47437870129943, 21.401183377951384, 23.944266133010387, 23.308797731995583, 23.786898508667946, 29.53417904302478, 29.379316993057728, 28.902205169200897, 20.141862546404198, 20.558321074893072, 20.305556458731488, 15.742611260153353, 14.285829871892929, 15.752076247241348, 30.161400768905878, 30.17769304662943, 29.730642564594746, 26.44143359363079, 25.536944657564163, 26.316250950098038, 16.430689762035996, 16.840675081747264, 16.11680522064367, 14.967857523510844, 14.800117927292973, 14.70387717584768, 26.806252452234418, 26.558204556504876, 27.13373551859209, 22.386530861258507, 22.40235712379217, 22.20791921019554, 22.451182154317692, 22.43477165450652, 22.827185804334775, 23.99820552766323, 24.34016877412796, 24.597358513623476, 32.698215449849755, 32.69197346518436, 33.189694945390016, 26.43124482035637, 27.079785116016865, 26.495863780379295, 20.20223148415485, 20.582733436177165, 20.451561811069638, 27.67025431493917, 27.342198098699242, 27.80109820763269, 10.209717186788708, 10.197617592910916, 9.69822674492994, 18.339330236117036, 18.03188746670881, 18.50439332301417, 24.93982922037442, 25.138118897875145, 24.997979772587613, 28.096402054031685, 27.65048525234063, 27.986843818177775, 29.11662871887286, 29.113324405004576, 29.174932417770222, 22.839976727962494, 23.58083413168788, 23.598063431680202, 19.378595367074013, 18.91303116083145, 19.337838605046272, 20.15163327701157, 19.689712941646576, 19.69887488335371, 30.216178935021162, 30.09951150417328, 30.070587903261185, 16.24587222437063, 16.469091358284146, 16.458551878730447, 15.879851112763077, 15.41241584221521, 15.168012584249169, 25.043134592163057, 24.939644421140343, 24.723030077914387, 23.627350944715232, 23.520275889585406, 23.135476144651562, 23.12391160180171, 23.429218115129814, 23.067961876591042, 28.3145864556233, 28.717802005509526, 28.37929035226503, 27.26771412727733, 27.09340940540035, 27.311666350190833, 24.592302923401192, 24.864155945678547, 24.65948875745137, 21.68549772600332, 22.182148250440747, 22.185163649419934, 30.181636944413185, 29.837567791342735, 30.136262610554695, 24.908996286491544, 25.240044937624276, 25.147628483052046, 27.368195325136185, 27.032560527324677, 27.37269350141287, 24.58363801737626, 24.378196378548935, 24.765742780019835, 31.326277531683445, 31.37668689340353, 31.210096940398216, 31.899542208760977, 31.898666206747293, 32.119793217629194, 18.637491593758256, 18.78528820226589, 18.867795540640742, 23.36517622570196, 23.48493252756694, 23.453993991638214, 25.49555420627196, 25.291116905709103, 24.794017558296517, 30.41743116825819, 30.686457691714168, 30.828351305332035, 30.310576551904276, 30.541389690091208, 30.198790443440274, 33.70252254605293, 33.99060155451298, 34.1647298745811, 30.153567704061658, 30.214584187294037, 29.969485166172177, 31.531004476050526, 31.485414708654076, 30.935985351602227, 25.43736809616287, 25.61968602224563, 25.057048869629696, 28.32839895784855, 27.866605788469315, 27.856058672070503, 25.01591307669878, 24.838568471372128, 25.287938971072435, 23.031166459123284, 23.562321218351514, 23.88162834236087, 26.098728249470383, 26.800638078401477, 27.022124025660247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1416922770180756, "mean_inference_ms": 0.6438641048587109, "mean_action_processing_ms": 0.09488905150625254, "mean_env_wait_ms": 0.795810884076042, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 772800, "timesteps_this_iter": 0, "agent_timesteps_total": 2318400, "timers": {"sample_time_ms": 9175.924, "sample_throughput": 523.108, "load_time_ms": 0.3, "load_throughput": 16025359.548, "learn_time_ms": 1177.291, "learn_throughput": 4077.158, "update_time_ms": 1.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 6.636744320392609, "policy_loss": -0.0013118577186186364, "vf_loss": 6.786939442157745, "vf_explained_var": 0.010287001729011536, "kl": 0.009461461450191614, "entropy": 15.016188621520996, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 772800, "num_agent_steps_sampled": 2318400, "num_steps_trained": 772800, "num_agent_steps_trained": 2318400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3505, "training_iteration": 161, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-07-47", "timestamp": 1706148467, "time_this_iter_s": 8.957757234573364, "time_total_s": 1507.0193932056427, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C2D430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1507.0193932056427, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 5.8307692307692305, "ram_util_percent": 47.4923076923077}}
{"episode_reward_max": 104.01243470981714, "episode_reward_min": 30.105561524629564, "episode_reward_mean": 74.8272118027418, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 9.69822674492994}, "policy_reward_max": {"shared_policy": 34.801255515466124}, "policy_reward_mean": {"shared_policy": 24.942403934247263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.565497495234, 80.22483699116853, 84.10594140738247, 45.82406178209929, 68.80599554628134, 102.24096442013978, 62.856412118300796, 74.5661181733012, 88.16162267513573, 63.85767869278787, 74.5375778186135, 69.68306413665414, 85.90078710857776, 64.01168938912448, 78.16780160367487, 80.0372665375471, 91.24109498411416, 30.537062138319, 81.33822671696544, 78.06908041983841, 59.15791337937115, 73.73244857229291, 97.50015701353547, 90.8952367864549, 74.51283621042964, 87.31714135035872, 104.01243470981714, 79.31306063290683, 64.567745690234, 65.65715834498405, 64.11744036525488, 71.03996237367392, 87.8157012052834, 61.00574008002876, 45.78051737928763, 90.06973638013005, 78.29462920129299, 49.38817006442693, 44.4718526266515, 80.49819252733138, 66.99680719524622, 67.71313961315899, 72.93573281541467, 98.57988386042413, 80.00689371675253, 61.23652673140165, 82.8135506212711, 30.105561524629564, 54.875611025840016, 75.07592789083718, 83.73373112455009, 87.40488554164766, 70.01887429133058, 57.62946513295174, 59.540221102011856, 90.38627834245563, 49.17351546138522, 46.46027953922746, 74.70580909121779, 70.2831029789522, 69.62109159352256, 85.41167881339786, 81.67278988286851, 74.11594762653111, 66.052809625864, 90.15546734631062, 75.29666970716787, 81.77344935387373, 73.72757717594503, 93.91306136548519, 95.91800163313746, 56.29057533666489, 70.30410274490711, 75.58068867027758, 91.93224016530439, 91.05075668543576, 101.85785397514701, 90.33763705752787, 93.95240453630683, 76.1141029880382, 84.05106341838837, 75.14242051914334, 70.47511601983567, 79.9214903535321, 80.78576325625178, 95.12970338575539, 75.31136818230149, 76.14290713146329, 98.0827671214938, 63.652419127523885, 73.73482478037474, 80.83574082702395, 58.96535233408211, 64.32462089508769, 64.68377102538943, 91.03184466995299, 67.92904598056336, 89.12815430574118, 71.5848783981055, 72.17236960874287], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.69934919973214, 20.792410266896084, 20.073738028605774, 27.046776231067867, 26.54397642115751, 26.634084338943154, 28.215593458463744, 28.239137069632605, 27.651210879286126, 15.038992842038468, 15.089223464330033, 15.695845475730792, 22.84236926585436, 22.898441143333912, 23.065185137093067, 33.99416023989518, 33.993053307135895, 34.2537508731087, 20.824617572128773, 20.943635512143373, 21.08815903402865, 25.358327594896153, 24.93157238264878, 24.27621819575627, 29.385975241661072, 29.197431407868862, 29.578216025605798, 21.28166627635558, 21.23749007036288, 21.33852234606941, 24.596701107919216, 25.126966777723283, 24.813909932971, 23.336965568363667, 23.497050549834967, 22.849048018455505, 28.312817404667527, 28.571080381671578, 29.016889322238654, 20.709615657726914, 21.602836419517786, 21.699237311879784, 25.923282725115612, 26.01571764548619, 26.22880123307307, 26.61912267406781, 26.658012097080544, 26.760131766398743, 30.604179238279656, 30.106527616580323, 30.530388129254177, 10.16684429099162, 10.096615826090172, 10.27360202123721, 26.98387510329485, 26.935952708125114, 27.418398905545473, 26.08390363802512, 25.9010513027509, 26.084125479062394, 19.627558705707386, 19.740990200390414, 19.789364473273352, 24.628315949191645, 24.791135358934596, 24.31299726416667, 32.630930236230284, 32.53302752102414, 32.33619925628105, 30.138985117276505, 30.379310895999268, 30.37694077317913, 25.15615085574487, 25.18316135245064, 24.17352400223413, 28.779113367199898, 28.922148197889328, 29.6158797852695, 34.596340912083775, 34.801255515466124, 34.61483828226724, 26.17549607406059, 26.580860897588224, 26.556703661258013, 21.573908280581236, 21.74501817021519, 21.24881923943758, 21.79168462753296, 22.046462409198284, 21.81901130825281, 21.241878286004066, 21.47437870129943, 21.401183377951384, 23.944266133010387, 23.308797731995583, 23.786898508667946, 29.53417904302478, 29.379316993057728, 28.902205169200897, 20.141862546404198, 20.558321074893072, 20.305556458731488, 15.742611260153353, 14.285829871892929, 15.752076247241348, 30.161400768905878, 30.17769304662943, 29.730642564594746, 26.44143359363079, 25.536944657564163, 26.316250950098038, 16.430689762035996, 16.840675081747264, 16.11680522064367, 14.967857523510844, 14.800117927292973, 14.70387717584768, 26.806252452234418, 26.558204556504876, 27.13373551859209, 22.386530861258507, 22.40235712379217, 22.20791921019554, 22.451182154317692, 22.43477165450652, 22.827185804334775, 23.99820552766323, 24.34016877412796, 24.597358513623476, 32.698215449849755, 32.69197346518436, 33.189694945390016, 26.43124482035637, 27.079785116016865, 26.495863780379295, 20.20223148415485, 20.582733436177165, 20.451561811069638, 27.67025431493917, 27.342198098699242, 27.80109820763269, 10.209717186788708, 10.197617592910916, 9.69822674492994, 18.339330236117036, 18.03188746670881, 18.50439332301417, 24.93982922037442, 25.138118897875145, 24.997979772587613, 28.096402054031685, 27.65048525234063, 27.986843818177775, 29.11662871887286, 29.113324405004576, 29.174932417770222, 22.839976727962494, 23.58083413168788, 23.598063431680202, 19.378595367074013, 18.91303116083145, 19.337838605046272, 20.15163327701157, 19.689712941646576, 19.69887488335371, 30.216178935021162, 30.09951150417328, 30.070587903261185, 16.24587222437063, 16.469091358284146, 16.458551878730447, 15.879851112763077, 15.41241584221521, 15.168012584249169, 25.043134592163057, 24.939644421140343, 24.723030077914387, 23.627350944715232, 23.520275889585406, 23.135476144651562, 23.12391160180171, 23.429218115129814, 23.067961876591042, 28.3145864556233, 28.717802005509526, 28.37929035226503, 27.26771412727733, 27.09340940540035, 27.311666350190833, 24.592302923401192, 24.864155945678547, 24.65948875745137, 21.68549772600332, 22.182148250440747, 22.185163649419934, 30.181636944413185, 29.837567791342735, 30.136262610554695, 24.908996286491544, 25.240044937624276, 25.147628483052046, 27.368195325136185, 27.032560527324677, 27.37269350141287, 24.58363801737626, 24.378196378548935, 24.765742780019835, 31.326277531683445, 31.37668689340353, 31.210096940398216, 31.899542208760977, 31.898666206747293, 32.119793217629194, 18.637491593758256, 18.78528820226589, 18.867795540640742, 23.36517622570196, 23.48493252756694, 23.453993991638214, 25.49555420627196, 25.291116905709103, 24.794017558296517, 30.41743116825819, 30.686457691714168, 30.828351305332035, 30.310576551904276, 30.541389690091208, 30.198790443440274, 33.70252254605293, 33.99060155451298, 34.1647298745811, 30.153567704061658, 30.214584187294037, 29.969485166172177, 31.531004476050526, 31.485414708654076, 30.935985351602227, 25.43736809616287, 25.61968602224563, 25.057048869629696, 28.32839895784855, 27.866605788469315, 27.856058672070503, 25.01591307669878, 24.838568471372128, 25.287938971072435, 23.031166459123284, 23.562321218351514, 23.88162834236087, 26.098728249470383, 26.800638078401477, 27.022124025660247, 27.155127479384333, 27.089666976282984, 26.540968800584466, 32.123099096740276, 31.483374784390122, 31.523229504624993, 25.053334000209958, 25.40788723776737, 24.850146944324166, 25.35931644588709, 25.135497391223907, 25.648093294352293, 32.69155831759174, 32.74603845303257, 32.64517035086949, 21.080176909764603, 21.346655940016106, 21.225586277743176, 24.56658315906921, 24.505539322892815, 24.66270229841271, 26.89953404168287, 27.360135974983365, 26.57607081035772, 19.743725908299282, 19.928211783369377, 19.293414642413452, 21.29669677714506, 21.478310621033103, 21.54961349690953, 21.75827895104885, 21.80030721053481, 21.12518486380577, 30.223608292639256, 30.497940653935075, 30.31029572337866, 22.3828816662232, 23.117432445675746, 22.428731868664414, 29.637082574268177, 29.471703117092446, 30.019368614380554, 23.655251622200012, 23.738974690437317, 24.190652085468173, 23.711580497523144, 24.18660695975025, 24.274182151469475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14162879631654526, "mean_inference_ms": 0.643816160536577, "mean_action_processing_ms": 0.0948841975575157, "mean_env_wait_ms": 0.7956813272699802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 777600, "timesteps_this_iter": 0, "agent_timesteps_total": 2332800, "timers": {"sample_time_ms": 9184.558, "sample_throughput": 522.616, "load_time_ms": 0.2, "load_throughput": 24059105.163, "learn_time_ms": 1176.696, "learn_throughput": 4079.217, "update_time_ms": 1.4}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 5.048036575317383, "policy_loss": 0.0006957525572701684, "vf_loss": 5.198066294193268, "vf_explained_var": 0.0012427642941474915, "kl": 0.013331405935106322, "entropy": 15.252742171287537, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 777600, "num_agent_steps_sampled": 2332800, "num_steps_trained": 777600, "num_agent_steps_trained": 2332800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3521, "training_iteration": 162, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-07-57", "timestamp": 1706148477, "time_this_iter_s": 9.717926979064941, "time_total_s": 1516.7373201847076, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1516.7373201847076, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 7.684615384615386, "ram_util_percent": 47.62307692307692}}
{"episode_reward_max": 104.01243470981714, "episode_reward_min": -12.347726598382025, "episode_reward_mean": 73.68533254255046, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -4.360079591472953}, "policy_reward_max": {"shared_policy": 34.801255515466124}, "policy_reward_mean": {"shared_policy": 24.56177751418348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.24109498411416, 30.537062138319, 81.33822671696544, 78.06908041983841, 59.15791337937115, 73.73244857229291, 97.50015701353547, 90.8952367864549, 74.51283621042964, 87.31714135035872, 104.01243470981714, 79.31306063290683, 64.567745690234, 65.65715834498405, 64.11744036525488, 71.03996237367392, 87.8157012052834, 61.00574008002876, 45.78051737928763, 90.06973638013005, 78.29462920129299, 49.38817006442693, 44.4718526266515, 80.49819252733138, 66.99680719524622, 67.71313961315899, 72.93573281541467, 98.57988386042413, 80.00689371675253, 61.23652673140165, 82.8135506212711, 30.105561524629564, 54.875611025840016, 75.07592789083718, 83.73373112455009, 87.40488554164766, 70.01887429133058, 57.62946513295174, 59.540221102011856, 90.38627834245563, 49.17351546138522, 46.46027953922746, 74.70580909121779, 70.2831029789522, 69.62109159352256, 85.41167881339786, 81.67278988286851, 74.11594762653111, 66.052809625864, 90.15546734631062, 75.29666970716787, 81.77344935387373, 73.72757717594503, 93.91306136548519, 95.91800163313746, 56.29057533666489, 70.30410274490711, 75.58068867027758, 91.93224016530439, 91.05075668543576, 101.85785397514701, 90.33763705752787, 93.95240453630683, 76.1141029880382, 84.05106341838837, 75.14242051914334, 70.47511601983567, 79.9214903535321, 80.78576325625178, 95.12970338575539, 75.31136818230149, 76.14290713146329, 98.0827671214938, 63.652419127523885, 73.73482478037474, 80.83574082702395, 58.96535233408211, 64.32462089508769, 64.68377102538943, 91.03184466995299, 67.92904598056336, 89.12815430574118, 71.5848783981055, 72.17236960874287, 71.29388531669974, 57.53762740641831, 64.80597931146622, 56.76494726538658, 75.96667412668465, 92.63903826661407, 47.479418003465966, 74.17724360339342, 79.58027459867299, 96.9876581719145, 87.12439618632195, 65.62839993223314, 66.45647393167017, -12.347726598382025, 75.76849242858587, 70.49660792574286], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.604179238279656, 30.106527616580323, 30.530388129254177, 10.16684429099162, 10.096615826090172, 10.27360202123721, 26.98387510329485, 26.935952708125114, 27.418398905545473, 26.08390363802512, 25.9010513027509, 26.084125479062394, 19.627558705707386, 19.740990200390414, 19.789364473273352, 24.628315949191645, 24.791135358934596, 24.31299726416667, 32.630930236230284, 32.53302752102414, 32.33619925628105, 30.138985117276505, 30.379310895999268, 30.37694077317913, 25.15615085574487, 25.18316135245064, 24.17352400223413, 28.779113367199898, 28.922148197889328, 29.6158797852695, 34.596340912083775, 34.801255515466124, 34.61483828226724, 26.17549607406059, 26.580860897588224, 26.556703661258013, 21.573908280581236, 21.74501817021519, 21.24881923943758, 21.79168462753296, 22.046462409198284, 21.81901130825281, 21.241878286004066, 21.47437870129943, 21.401183377951384, 23.944266133010387, 23.308797731995583, 23.786898508667946, 29.53417904302478, 29.379316993057728, 28.902205169200897, 20.141862546404198, 20.558321074893072, 20.305556458731488, 15.742611260153353, 14.285829871892929, 15.752076247241348, 30.161400768905878, 30.17769304662943, 29.730642564594746, 26.44143359363079, 25.536944657564163, 26.316250950098038, 16.430689762035996, 16.840675081747264, 16.11680522064367, 14.967857523510844, 14.800117927292973, 14.70387717584768, 26.806252452234418, 26.558204556504876, 27.13373551859209, 22.386530861258507, 22.40235712379217, 22.20791921019554, 22.451182154317692, 22.43477165450652, 22.827185804334775, 23.99820552766323, 24.34016877412796, 24.597358513623476, 32.698215449849755, 32.69197346518436, 33.189694945390016, 26.43124482035637, 27.079785116016865, 26.495863780379295, 20.20223148415485, 20.582733436177165, 20.451561811069638, 27.67025431493917, 27.342198098699242, 27.80109820763269, 10.209717186788708, 10.197617592910916, 9.69822674492994, 18.339330236117036, 18.03188746670881, 18.50439332301417, 24.93982922037442, 25.138118897875145, 24.997979772587613, 28.096402054031685, 27.65048525234063, 27.986843818177775, 29.11662871887286, 29.113324405004576, 29.174932417770222, 22.839976727962494, 23.58083413168788, 23.598063431680202, 19.378595367074013, 18.91303116083145, 19.337838605046272, 20.15163327701157, 19.689712941646576, 19.69887488335371, 30.216178935021162, 30.09951150417328, 30.070587903261185, 16.24587222437063, 16.469091358284146, 16.458551878730447, 15.879851112763077, 15.41241584221521, 15.168012584249169, 25.043134592163057, 24.939644421140343, 24.723030077914387, 23.627350944715232, 23.520275889585406, 23.135476144651562, 23.12391160180171, 23.429218115129814, 23.067961876591042, 28.3145864556233, 28.717802005509526, 28.37929035226503, 27.26771412727733, 27.09340940540035, 27.311666350190833, 24.592302923401192, 24.864155945678547, 24.65948875745137, 21.68549772600332, 22.182148250440747, 22.185163649419934, 30.181636944413185, 29.837567791342735, 30.136262610554695, 24.908996286491544, 25.240044937624276, 25.147628483052046, 27.368195325136185, 27.032560527324677, 27.37269350141287, 24.58363801737626, 24.378196378548935, 24.765742780019835, 31.326277531683445, 31.37668689340353, 31.210096940398216, 31.899542208760977, 31.898666206747293, 32.119793217629194, 18.637491593758256, 18.78528820226589, 18.867795540640742, 23.36517622570196, 23.48493252756694, 23.453993991638214, 25.49555420627196, 25.291116905709103, 24.794017558296517, 30.41743116825819, 30.686457691714168, 30.828351305332035, 30.310576551904276, 30.541389690091208, 30.198790443440274, 33.70252254605293, 33.99060155451298, 34.1647298745811, 30.153567704061658, 30.214584187294037, 29.969485166172177, 31.531004476050526, 31.485414708654076, 30.935985351602227, 25.43736809616287, 25.61968602224563, 25.057048869629696, 28.32839895784855, 27.866605788469315, 27.856058672070503, 25.01591307669878, 24.838568471372128, 25.287938971072435, 23.031166459123284, 23.562321218351514, 23.88162834236087, 26.098728249470383, 26.800638078401477, 27.022124025660247, 27.155127479384333, 27.089666976282984, 26.540968800584466, 32.123099096740276, 31.483374784390122, 31.523229504624993, 25.053334000209958, 25.40788723776737, 24.850146944324166, 25.35931644588709, 25.135497391223907, 25.648093294352293, 32.69155831759174, 32.74603845303257, 32.64517035086949, 21.080176909764603, 21.346655940016106, 21.225586277743176, 24.56658315906921, 24.505539322892815, 24.66270229841271, 26.89953404168287, 27.360135974983365, 26.57607081035772, 19.743725908299282, 19.928211783369377, 19.293414642413452, 21.29669677714506, 21.478310621033103, 21.54961349690953, 21.75827895104885, 21.80030721053481, 21.12518486380577, 30.223608292639256, 30.497940653935075, 30.31029572337866, 22.3828816662232, 23.117432445675746, 22.428731868664414, 29.637082574268177, 29.471703117092446, 30.019368614380554, 23.655251622200012, 23.738974690437317, 24.190652085468173, 23.711580497523144, 24.18660695975025, 24.274182151469475, 23.639557361602783, 23.670367673039436, 23.983960282057524, 19.266953462113932, 19.015970689555004, 19.254703254749373, 21.67109389230609, 21.691026281565428, 21.4438591375947, 18.986736342310905, 19.0170067101717, 18.761204212903976, 25.110430394609764, 25.523519491155938, 25.33272424091895, 30.91370727618535, 30.912960364793733, 30.812370625634983, 15.798703653117016, 15.944922747866556, 15.735791602482394, 24.481361364324883, 24.917045734201864, 24.778836504866675, 26.761772068217397, 26.38999419659376, 26.428508333861828, 32.42235738349457, 32.05220040430625, 32.513100384113685, 29.251246618727833, 28.438371102015168, 29.434778465578944, 22.013034316497695, 21.85535705213745, 21.760008563597992, 22.26913882916172, 22.25898189966877, 21.928353202839688, -4.360079591472953, -3.868565236528724, -4.1190817703803475, 25.078772490223244, 25.400125894074634, 25.289594044287995, 23.818963821977377, 23.755419999361038, 22.92222410440445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14157753711233215, "mean_inference_ms": 0.6438325146485497, "mean_action_processing_ms": 0.09488308361387322, "mean_env_wait_ms": 0.7955908922251624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 782400, "timesteps_this_iter": 0, "agent_timesteps_total": 2347200, "timers": {"sample_time_ms": 9201.776, "sample_throughput": 521.638, "load_time_ms": 0.2, "load_throughput": 24059105.163, "learn_time_ms": 1177.696, "learn_throughput": 4075.756, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 7.071119785308838, "policy_loss": 0.0017293602392922658, "vf_loss": 7.218308091163635, "vf_explained_var": 0.0007366836071014404, "kl": 0.01911643083462888, "entropy": 15.150148153305054, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 782400, "num_agent_steps_sampled": 2347200, "num_steps_trained": 782400, "num_agent_steps_trained": 2347200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3537, "training_iteration": 163, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-08-07", "timestamp": 1706148487, "time_this_iter_s": 9.512711524963379, "time_total_s": 1526.250031709671, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1526.250031709671, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 9.649999999999997, "ram_util_percent": 47.692857142857136}}
{"episode_reward_max": 101.85785397514701, "episode_reward_min": -12.347726598382025, "episode_reward_mean": 73.79859642723314, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -4.360079591472953}, "policy_reward_max": {"shared_policy": 34.1647298745811}, "policy_reward_mean": {"shared_policy": 24.59953214241104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.8157012052834, 61.00574008002876, 45.78051737928763, 90.06973638013005, 78.29462920129299, 49.38817006442693, 44.4718526266515, 80.49819252733138, 66.99680719524622, 67.71313961315899, 72.93573281541467, 98.57988386042413, 80.00689371675253, 61.23652673140165, 82.8135506212711, 30.105561524629564, 54.875611025840016, 75.07592789083718, 83.73373112455009, 87.40488554164766, 70.01887429133058, 57.62946513295174, 59.540221102011856, 90.38627834245563, 49.17351546138522, 46.46027953922746, 74.70580909121779, 70.2831029789522, 69.62109159352256, 85.41167881339786, 81.67278988286851, 74.11594762653111, 66.052809625864, 90.15546734631062, 75.29666970716787, 81.77344935387373, 73.72757717594503, 93.91306136548519, 95.91800163313746, 56.29057533666489, 70.30410274490711, 75.58068867027758, 91.93224016530439, 91.05075668543576, 101.85785397514701, 90.33763705752787, 93.95240453630683, 76.1141029880382, 84.05106341838837, 75.14242051914334, 70.47511601983567, 79.9214903535321, 80.78576325625178, 95.12970338575539, 75.31136818230149, 76.14290713146329, 98.0827671214938, 63.652419127523885, 73.73482478037474, 80.83574082702395, 58.96535233408211, 64.32462089508769, 64.68377102538943, 91.03184466995299, 67.92904598056336, 89.12815430574118, 71.5848783981055, 72.17236960874287, 71.29388531669974, 57.53762740641831, 64.80597931146622, 56.76494726538658, 75.96667412668465, 92.63903826661407, 47.479418003465966, 74.17724360339342, 79.58027459867299, 96.9876581719145, 87.12439618632195, 65.62839993223314, 66.45647393167017, -12.347726598382025, 75.76849242858587, 70.49660792574286, 89.42581841722131, 81.0358569100499, 63.88340724329461, 60.87185482680796, 72.8004103247076, 81.79653296433388, 72.27371923252939, 96.8399553275667, 83.87913154438137, 50.48714765626936, 98.13996750675139, 68.17992995679377, 76.503219878301, 81.66416189074513, 78.18120602518319, 68.37306845188138], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [29.53417904302478, 29.379316993057728, 28.902205169200897, 20.141862546404198, 20.558321074893072, 20.305556458731488, 15.742611260153353, 14.285829871892929, 15.752076247241348, 30.161400768905878, 30.17769304662943, 29.730642564594746, 26.44143359363079, 25.536944657564163, 26.316250950098038, 16.430689762035996, 16.840675081747264, 16.11680522064367, 14.967857523510844, 14.800117927292973, 14.70387717584768, 26.806252452234418, 26.558204556504876, 27.13373551859209, 22.386530861258507, 22.40235712379217, 22.20791921019554, 22.451182154317692, 22.43477165450652, 22.827185804334775, 23.99820552766323, 24.34016877412796, 24.597358513623476, 32.698215449849755, 32.69197346518436, 33.189694945390016, 26.43124482035637, 27.079785116016865, 26.495863780379295, 20.20223148415485, 20.582733436177165, 20.451561811069638, 27.67025431493917, 27.342198098699242, 27.80109820763269, 10.209717186788708, 10.197617592910916, 9.69822674492994, 18.339330236117036, 18.03188746670881, 18.50439332301417, 24.93982922037442, 25.138118897875145, 24.997979772587613, 28.096402054031685, 27.65048525234063, 27.986843818177775, 29.11662871887286, 29.113324405004576, 29.174932417770222, 22.839976727962494, 23.58083413168788, 23.598063431680202, 19.378595367074013, 18.91303116083145, 19.337838605046272, 20.15163327701157, 19.689712941646576, 19.69887488335371, 30.216178935021162, 30.09951150417328, 30.070587903261185, 16.24587222437063, 16.469091358284146, 16.458551878730447, 15.879851112763077, 15.41241584221521, 15.168012584249169, 25.043134592163057, 24.939644421140343, 24.723030077914387, 23.627350944715232, 23.520275889585406, 23.135476144651562, 23.12391160180171, 23.429218115129814, 23.067961876591042, 28.3145864556233, 28.717802005509526, 28.37929035226503, 27.26771412727733, 27.09340940540035, 27.311666350190833, 24.592302923401192, 24.864155945678547, 24.65948875745137, 21.68549772600332, 22.182148250440747, 22.185163649419934, 30.181636944413185, 29.837567791342735, 30.136262610554695, 24.908996286491544, 25.240044937624276, 25.147628483052046, 27.368195325136185, 27.032560527324677, 27.37269350141287, 24.58363801737626, 24.378196378548935, 24.765742780019835, 31.326277531683445, 31.37668689340353, 31.210096940398216, 31.899542208760977, 31.898666206747293, 32.119793217629194, 18.637491593758256, 18.78528820226589, 18.867795540640742, 23.36517622570196, 23.48493252756694, 23.453993991638214, 25.49555420627196, 25.291116905709103, 24.794017558296517, 30.41743116825819, 30.686457691714168, 30.828351305332035, 30.310576551904276, 30.541389690091208, 30.198790443440274, 33.70252254605293, 33.99060155451298, 34.1647298745811, 30.153567704061658, 30.214584187294037, 29.969485166172177, 31.531004476050526, 31.485414708654076, 30.935985351602227, 25.43736809616287, 25.61968602224563, 25.057048869629696, 28.32839895784855, 27.866605788469315, 27.856058672070503, 25.01591307669878, 24.838568471372128, 25.287938971072435, 23.031166459123284, 23.562321218351514, 23.88162834236087, 26.098728249470383, 26.800638078401477, 27.022124025660247, 27.155127479384333, 27.089666976282984, 26.540968800584466, 32.123099096740276, 31.483374784390122, 31.523229504624993, 25.053334000209958, 25.40788723776737, 24.850146944324166, 25.35931644588709, 25.135497391223907, 25.648093294352293, 32.69155831759174, 32.74603845303257, 32.64517035086949, 21.080176909764603, 21.346655940016106, 21.225586277743176, 24.56658315906921, 24.505539322892815, 24.66270229841271, 26.89953404168287, 27.360135974983365, 26.57607081035772, 19.743725908299282, 19.928211783369377, 19.293414642413452, 21.29669677714506, 21.478310621033103, 21.54961349690953, 21.75827895104885, 21.80030721053481, 21.12518486380577, 30.223608292639256, 30.497940653935075, 30.31029572337866, 22.3828816662232, 23.117432445675746, 22.428731868664414, 29.637082574268177, 29.471703117092446, 30.019368614380554, 23.655251622200012, 23.738974690437317, 24.190652085468173, 23.711580497523144, 24.18660695975025, 24.274182151469475, 23.639557361602783, 23.670367673039436, 23.983960282057524, 19.266953462113932, 19.015970689555004, 19.254703254749373, 21.67109389230609, 21.691026281565428, 21.4438591375947, 18.986736342310905, 19.0170067101717, 18.761204212903976, 25.110430394609764, 25.523519491155938, 25.33272424091895, 30.91370727618535, 30.912960364793733, 30.812370625634983, 15.798703653117016, 15.944922747866556, 15.735791602482394, 24.481361364324883, 24.917045734201864, 24.778836504866675, 26.761772068217397, 26.38999419659376, 26.428508333861828, 32.42235738349457, 32.05220040430625, 32.513100384113685, 29.251246618727833, 28.438371102015168, 29.434778465578944, 22.013034316497695, 21.85535705213745, 21.760008563597992, 22.26913882916172, 22.25898189966877, 21.928353202839688, -4.360079591472953, -3.868565236528724, -4.1190817703803475, 25.078772490223244, 25.400125894074634, 25.289594044287995, 23.818963821977377, 23.755419999361038, 22.92222410440445, 29.899272993206978, 29.805839527398348, 29.720705896615982, 26.857832362254456, 27.299737212558583, 26.878287335236863, 21.205651241044194, 21.26358466471234, 21.41417133753808, 20.50106320281823, 20.54013069470723, 19.8306609292825, 23.90317345658937, 24.588030685360224, 24.309206182758004, 27.12055630733569, 27.055291344722107, 27.62068531227608, 24.25125668322046, 24.02736623336871, 23.995096315940216, 32.18462789182861, 32.225258515526846, 32.43006892021124, 27.574381058414772, 28.18219705795248, 28.122553428014115, 16.488082771499947, 16.81576757629712, 17.18329730847229, 32.42643703023592, 32.984926470244915, 32.72860400627056, 22.133395706613854, 23.046806917836264, 22.999727332343653, 25.19951097170511, 25.590207031617553, 25.713501874978334, 27.473086299995572, 27.22347270200649, 26.967602888743073, 26.05322727312644, 25.896294129391507, 26.23168462266524, 22.902598037074, 22.721875655154378, 22.748594759653002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14152289821111974, "mean_inference_ms": 0.6438683857336234, "mean_action_processing_ms": 0.09488843826930786, "mean_env_wait_ms": 0.795527161565345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 787200, "timesteps_this_iter": 0, "agent_timesteps_total": 2361600, "timers": {"sample_time_ms": 9211.825, "sample_throughput": 521.069, "load_time_ms": 0.2, "load_throughput": 24059105.163, "learn_time_ms": 1188.503, "learn_throughput": 4038.695, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13515243530273438, "cur_lr": 0.0005, "total_loss": 6.597447037696838, "policy_loss": 0.007285318115415773, "vf_loss": 6.737379372119904, "vf_explained_var": 0.011909931898117065, "kl": 0.042500390787839334, "entropy": 15.296168804168701, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 787200, "num_agent_steps_sampled": 2361600, "num_steps_trained": 787200, "num_agent_steps_trained": 2361600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3553, "training_iteration": 164, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-08-16", "timestamp": 1706148496, "time_this_iter_s": 9.349745273590088, "time_total_s": 1535.599776983261, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C15700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1535.599776983261, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 6.3307692307692305, "ram_util_percent": 47.69230769230769}}
{"episode_reward_max": 101.85785397514701, "episode_reward_min": -12.347726598382025, "episode_reward_mean": 74.31529264354583, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -4.360079591472953}, "policy_reward_max": {"shared_policy": 34.1647298745811}, "policy_reward_mean": {"shared_policy": 24.771764214515272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.875611025840016, 75.07592789083718, 83.73373112455009, 87.40488554164766, 70.01887429133058, 57.62946513295174, 59.540221102011856, 90.38627834245563, 49.17351546138522, 46.46027953922746, 74.70580909121779, 70.2831029789522, 69.62109159352256, 85.41167881339786, 81.67278988286851, 74.11594762653111, 66.052809625864, 90.15546734631062, 75.29666970716787, 81.77344935387373, 73.72757717594503, 93.91306136548519, 95.91800163313746, 56.29057533666489, 70.30410274490711, 75.58068867027758, 91.93224016530439, 91.05075668543576, 101.85785397514701, 90.33763705752787, 93.95240453630683, 76.1141029880382, 84.05106341838837, 75.14242051914334, 70.47511601983567, 79.9214903535321, 80.78576325625178, 95.12970338575539, 75.31136818230149, 76.14290713146329, 98.0827671214938, 63.652419127523885, 73.73482478037474, 80.83574082702395, 58.96535233408211, 64.32462089508769, 64.68377102538943, 91.03184466995299, 67.92904598056336, 89.12815430574118, 71.5848783981055, 72.17236960874287, 71.29388531669974, 57.53762740641831, 64.80597931146622, 56.76494726538658, 75.96667412668465, 92.63903826661407, 47.479418003465966, 74.17724360339342, 79.58027459867299, 96.9876581719145, 87.12439618632195, 65.62839993223314, 66.45647393167017, -12.347726598382025, 75.76849242858587, 70.49660792574286, 89.42581841722131, 81.0358569100499, 63.88340724329461, 60.87185482680796, 72.8004103247076, 81.79653296433388, 72.27371923252939, 96.8399553275667, 83.87913154438137, 50.48714765626936, 98.13996750675139, 68.17992995679377, 76.503219878301, 81.66416189074513, 78.18120602518319, 68.37306845188138, 85.58559478819367, 92.81202656775713, 79.81381791085002, 80.88086935132742, 72.4803817272186, 79.86201685015111, 68.28153659403323, 78.83811283111571, 62.8153155595064, 55.555914731696234, 63.64265320636329, 42.80412746593353, 83.5202677696943, 72.59844833984971, 74.71424292982556, 55.17693055048582], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.339330236117036, 18.03188746670881, 18.50439332301417, 24.93982922037442, 25.138118897875145, 24.997979772587613, 28.096402054031685, 27.65048525234063, 27.986843818177775, 29.11662871887286, 29.113324405004576, 29.174932417770222, 22.839976727962494, 23.58083413168788, 23.598063431680202, 19.378595367074013, 18.91303116083145, 19.337838605046272, 20.15163327701157, 19.689712941646576, 19.69887488335371, 30.216178935021162, 30.09951150417328, 30.070587903261185, 16.24587222437063, 16.469091358284146, 16.458551878730447, 15.879851112763077, 15.41241584221521, 15.168012584249169, 25.043134592163057, 24.939644421140343, 24.723030077914387, 23.627350944715232, 23.520275889585406, 23.135476144651562, 23.12391160180171, 23.429218115129814, 23.067961876591042, 28.3145864556233, 28.717802005509526, 28.37929035226503, 27.26771412727733, 27.09340940540035, 27.311666350190833, 24.592302923401192, 24.864155945678547, 24.65948875745137, 21.68549772600332, 22.182148250440747, 22.185163649419934, 30.181636944413185, 29.837567791342735, 30.136262610554695, 24.908996286491544, 25.240044937624276, 25.147628483052046, 27.368195325136185, 27.032560527324677, 27.37269350141287, 24.58363801737626, 24.378196378548935, 24.765742780019835, 31.326277531683445, 31.37668689340353, 31.210096940398216, 31.899542208760977, 31.898666206747293, 32.119793217629194, 18.637491593758256, 18.78528820226589, 18.867795540640742, 23.36517622570196, 23.48493252756694, 23.453993991638214, 25.49555420627196, 25.291116905709103, 24.794017558296517, 30.41743116825819, 30.686457691714168, 30.828351305332035, 30.310576551904276, 30.541389690091208, 30.198790443440274, 33.70252254605293, 33.99060155451298, 34.1647298745811, 30.153567704061658, 30.214584187294037, 29.969485166172177, 31.531004476050526, 31.485414708654076, 30.935985351602227, 25.43736809616287, 25.61968602224563, 25.057048869629696, 28.32839895784855, 27.866605788469315, 27.856058672070503, 25.01591307669878, 24.838568471372128, 25.287938971072435, 23.031166459123284, 23.562321218351514, 23.88162834236087, 26.098728249470383, 26.800638078401477, 27.022124025660247, 27.155127479384333, 27.089666976282984, 26.540968800584466, 32.123099096740276, 31.483374784390122, 31.523229504624993, 25.053334000209958, 25.40788723776737, 24.850146944324166, 25.35931644588709, 25.135497391223907, 25.648093294352293, 32.69155831759174, 32.74603845303257, 32.64517035086949, 21.080176909764603, 21.346655940016106, 21.225586277743176, 24.56658315906921, 24.505539322892815, 24.66270229841271, 26.89953404168287, 27.360135974983365, 26.57607081035772, 19.743725908299282, 19.928211783369377, 19.293414642413452, 21.29669677714506, 21.478310621033103, 21.54961349690953, 21.75827895104885, 21.80030721053481, 21.12518486380577, 30.223608292639256, 30.497940653935075, 30.31029572337866, 22.3828816662232, 23.117432445675746, 22.428731868664414, 29.637082574268177, 29.471703117092446, 30.019368614380554, 23.655251622200012, 23.738974690437317, 24.190652085468173, 23.711580497523144, 24.18660695975025, 24.274182151469475, 23.639557361602783, 23.670367673039436, 23.983960282057524, 19.266953462113932, 19.015970689555004, 19.254703254749373, 21.67109389230609, 21.691026281565428, 21.4438591375947, 18.986736342310905, 19.0170067101717, 18.761204212903976, 25.110430394609764, 25.523519491155938, 25.33272424091895, 30.91370727618535, 30.912960364793733, 30.812370625634983, 15.798703653117016, 15.944922747866556, 15.735791602482394, 24.481361364324883, 24.917045734201864, 24.778836504866675, 26.761772068217397, 26.38999419659376, 26.428508333861828, 32.42235738349457, 32.05220040430625, 32.513100384113685, 29.251246618727833, 28.438371102015168, 29.434778465578944, 22.013034316497695, 21.85535705213745, 21.760008563597992, 22.26913882916172, 22.25898189966877, 21.928353202839688, -4.360079591472953, -3.868565236528724, -4.1190817703803475, 25.078772490223244, 25.400125894074634, 25.289594044287995, 23.818963821977377, 23.755419999361038, 22.92222410440445, 29.899272993206978, 29.805839527398348, 29.720705896615982, 26.857832362254456, 27.299737212558583, 26.878287335236863, 21.205651241044194, 21.26358466471234, 21.41417133753808, 20.50106320281823, 20.54013069470723, 19.8306609292825, 23.90317345658937, 24.588030685360224, 24.309206182758004, 27.12055630733569, 27.055291344722107, 27.62068531227608, 24.25125668322046, 24.02736623336871, 23.995096315940216, 32.18462789182861, 32.225258515526846, 32.43006892021124, 27.574381058414772, 28.18219705795248, 28.122553428014115, 16.488082771499947, 16.81576757629712, 17.18329730847229, 32.42643703023592, 32.984926470244915, 32.72860400627056, 22.133395706613854, 23.046806917836264, 22.999727332343653, 25.19951097170511, 25.590207031617553, 25.713501874978334, 27.473086299995572, 27.22347270200649, 26.967602888743073, 26.05322727312644, 25.896294129391507, 26.23168462266524, 22.902598037074, 22.721875655154378, 22.748594759653002, 28.853820505241544, 28.147068078319222, 28.58470620463291, 30.670842185616493, 30.95872174203396, 31.182462640106678, 26.73161012555161, 26.630887440095336, 26.451320345203072, 26.930750019848347, 26.81685984879732, 27.13325948268175, 24.072067240873963, 24.068688216308743, 24.339626270035893, 26.766040036765233, 26.459488054116562, 26.636488759269312, 22.705559720595673, 22.704063942035035, 22.87191293140252, 26.27467106779416, 26.325268556674317, 26.238173206647232, 20.92466103037198, 21.0910213937362, 20.799633135398224, 18.6269150947531, 18.613913356636957, 18.315086280306176, 21.515111692870647, 21.419902464995772, 20.707639048496873, 14.5358206766347, 14.106076608101517, 14.162230181197316, 27.849206196765095, 27.997135090331227, 27.673926482597977, 24.177066646516323, 24.382000248879194, 24.039381444454193, 24.315115615725517, 24.973171085119247, 25.425956228980795, 18.56684799368182, 18.243436152736336, 18.366646404067666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14147794034769787, "mean_inference_ms": 0.6439777220386891, "mean_action_processing_ms": 0.0948942279006717, "mean_env_wait_ms": 0.795503649946964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 792000, "timesteps_this_iter": 0, "agent_timesteps_total": 2376000, "timers": {"sample_time_ms": 9225.979, "sample_throughput": 520.27, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1189.11, "learn_throughput": 4036.632, "update_time_ms": 1.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20272865295410158, "cur_lr": 0.0005, "total_loss": 6.345670998096466, "policy_loss": 0.0016509087763875163, "vf_loss": 6.493437111377716, "vf_explained_var": 0.005699582397937775, "kl": 0.00977053929841747, "entropy": 15.139766454696655, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 792000, "num_agent_steps_sampled": 2376000, "num_steps_trained": 792000, "num_agent_steps_trained": 2376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3569, "training_iteration": 165, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-08-26", "timestamp": 1706148506, "time_this_iter_s": 9.6090407371521, "time_total_s": 1545.2088177204132, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F90D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1545.2088177204132, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 8.878571428571428, "ram_util_percent": 47.89285714285713}}
{"episode_reward_max": 101.85785397514701, "episode_reward_min": -12.347726598382025, "episode_reward_mean": 75.32312057124363, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -4.360079591472953}, "policy_reward_max": {"shared_policy": 34.1647298745811}, "policy_reward_mean": {"shared_policy": 25.107706857081205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.052809625864, 90.15546734631062, 75.29666970716787, 81.77344935387373, 73.72757717594503, 93.91306136548519, 95.91800163313746, 56.29057533666489, 70.30410274490711, 75.58068867027758, 91.93224016530439, 91.05075668543576, 101.85785397514701, 90.33763705752787, 93.95240453630683, 76.1141029880382, 84.05106341838837, 75.14242051914334, 70.47511601983567, 79.9214903535321, 80.78576325625178, 95.12970338575539, 75.31136818230149, 76.14290713146329, 98.0827671214938, 63.652419127523885, 73.73482478037474, 80.83574082702395, 58.96535233408211, 64.32462089508769, 64.68377102538943, 91.03184466995299, 67.92904598056336, 89.12815430574118, 71.5848783981055, 72.17236960874287, 71.29388531669974, 57.53762740641831, 64.80597931146622, 56.76494726538658, 75.96667412668465, 92.63903826661407, 47.479418003465966, 74.17724360339342, 79.58027459867299, 96.9876581719145, 87.12439618632195, 65.62839993223314, 66.45647393167017, -12.347726598382025, 75.76849242858587, 70.49660792574286, 89.42581841722131, 81.0358569100499, 63.88340724329461, 60.87185482680796, 72.8004103247076, 81.79653296433388, 72.27371923252939, 96.8399553275667, 83.87913154438137, 50.48714765626936, 98.13996750675139, 68.17992995679377, 76.503219878301, 81.66416189074513, 78.18120602518319, 68.37306845188138, 85.58559478819367, 92.81202656775713, 79.81381791085002, 80.88086935132742, 72.4803817272186, 79.86201685015111, 68.28153659403323, 78.83811283111571, 62.8153155595064, 55.555914731696234, 63.64265320636329, 42.80412746593353, 83.5202677696943, 72.59844833984971, 74.71424292982556, 55.17693055048582, 92.19398525357246, 85.11133582890031, 64.80603706836699, 62.6202598288655, 84.22904981300233, 67.00334402546287, 72.4094694033265, 97.67763808311426, 67.33857206255195, 91.06315828161313, 74.92844177782533, 67.26131953671573, 75.73153289966282, 81.64093497395515, 74.64081677794456, 72.23610659362747], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.68549772600332, 22.182148250440747, 22.185163649419934, 30.181636944413185, 29.837567791342735, 30.136262610554695, 24.908996286491544, 25.240044937624276, 25.147628483052046, 27.368195325136185, 27.032560527324677, 27.37269350141287, 24.58363801737626, 24.378196378548935, 24.765742780019835, 31.326277531683445, 31.37668689340353, 31.210096940398216, 31.899542208760977, 31.898666206747293, 32.119793217629194, 18.637491593758256, 18.78528820226589, 18.867795540640742, 23.36517622570196, 23.48493252756694, 23.453993991638214, 25.49555420627196, 25.291116905709103, 24.794017558296517, 30.41743116825819, 30.686457691714168, 30.828351305332035, 30.310576551904276, 30.541389690091208, 30.198790443440274, 33.70252254605293, 33.99060155451298, 34.1647298745811, 30.153567704061658, 30.214584187294037, 29.969485166172177, 31.531004476050526, 31.485414708654076, 30.935985351602227, 25.43736809616287, 25.61968602224563, 25.057048869629696, 28.32839895784855, 27.866605788469315, 27.856058672070503, 25.01591307669878, 24.838568471372128, 25.287938971072435, 23.031166459123284, 23.562321218351514, 23.88162834236087, 26.098728249470383, 26.800638078401477, 27.022124025660247, 27.155127479384333, 27.089666976282984, 26.540968800584466, 32.123099096740276, 31.483374784390122, 31.523229504624993, 25.053334000209958, 25.40788723776737, 24.850146944324166, 25.35931644588709, 25.135497391223907, 25.648093294352293, 32.69155831759174, 32.74603845303257, 32.64517035086949, 21.080176909764603, 21.346655940016106, 21.225586277743176, 24.56658315906921, 24.505539322892815, 24.66270229841271, 26.89953404168287, 27.360135974983365, 26.57607081035772, 19.743725908299282, 19.928211783369377, 19.293414642413452, 21.29669677714506, 21.478310621033103, 21.54961349690953, 21.75827895104885, 21.80030721053481, 21.12518486380577, 30.223608292639256, 30.497940653935075, 30.31029572337866, 22.3828816662232, 23.117432445675746, 22.428731868664414, 29.637082574268177, 29.471703117092446, 30.019368614380554, 23.655251622200012, 23.738974690437317, 24.190652085468173, 23.711580497523144, 24.18660695975025, 24.274182151469475, 23.639557361602783, 23.670367673039436, 23.983960282057524, 19.266953462113932, 19.015970689555004, 19.254703254749373, 21.67109389230609, 21.691026281565428, 21.4438591375947, 18.986736342310905, 19.0170067101717, 18.761204212903976, 25.110430394609764, 25.523519491155938, 25.33272424091895, 30.91370727618535, 30.912960364793733, 30.812370625634983, 15.798703653117016, 15.944922747866556, 15.735791602482394, 24.481361364324883, 24.917045734201864, 24.778836504866675, 26.761772068217397, 26.38999419659376, 26.428508333861828, 32.42235738349457, 32.05220040430625, 32.513100384113685, 29.251246618727833, 28.438371102015168, 29.434778465578944, 22.013034316497695, 21.85535705213745, 21.760008563597992, 22.26913882916172, 22.25898189966877, 21.928353202839688, -4.360079591472953, -3.868565236528724, -4.1190817703803475, 25.078772490223244, 25.400125894074634, 25.289594044287995, 23.818963821977377, 23.755419999361038, 22.92222410440445, 29.899272993206978, 29.805839527398348, 29.720705896615982, 26.857832362254456, 27.299737212558583, 26.878287335236863, 21.205651241044194, 21.26358466471234, 21.41417133753808, 20.50106320281823, 20.54013069470723, 19.8306609292825, 23.90317345658937, 24.588030685360224, 24.309206182758004, 27.12055630733569, 27.055291344722107, 27.62068531227608, 24.25125668322046, 24.02736623336871, 23.995096315940216, 32.18462789182861, 32.225258515526846, 32.43006892021124, 27.574381058414772, 28.18219705795248, 28.122553428014115, 16.488082771499947, 16.81576757629712, 17.18329730847229, 32.42643703023592, 32.984926470244915, 32.72860400627056, 22.133395706613854, 23.046806917836264, 22.999727332343653, 25.19951097170511, 25.590207031617553, 25.713501874978334, 27.473086299995572, 27.22347270200649, 26.967602888743073, 26.05322727312644, 25.896294129391507, 26.23168462266524, 22.902598037074, 22.721875655154378, 22.748594759653002, 28.853820505241544, 28.147068078319222, 28.58470620463291, 30.670842185616493, 30.95872174203396, 31.182462640106678, 26.73161012555161, 26.630887440095336, 26.451320345203072, 26.930750019848347, 26.81685984879732, 27.13325948268175, 24.072067240873963, 24.068688216308743, 24.339626270035893, 26.766040036765233, 26.459488054116562, 26.636488759269312, 22.705559720595673, 22.704063942035035, 22.87191293140252, 26.27467106779416, 26.325268556674317, 26.238173206647232, 20.92466103037198, 21.0910213937362, 20.799633135398224, 18.6269150947531, 18.613913356636957, 18.315086280306176, 21.515111692870647, 21.419902464995772, 20.707639048496873, 14.5358206766347, 14.106076608101517, 14.162230181197316, 27.849206196765095, 27.997135090331227, 27.673926482597977, 24.177066646516323, 24.382000248879194, 24.039381444454193, 24.315115615725517, 24.973171085119247, 25.425956228980795, 18.56684799368182, 18.243436152736336, 18.366646404067666, 30.808024793863297, 30.547676995396614, 30.838283464312553, 28.203004653255135, 28.427575098971516, 28.480756076673657, 21.616107047845915, 21.762467221667364, 21.42746279885371, 20.519394765297562, 21.0409936706225, 21.05987139294544, 28.20021442448099, 27.93143657346566, 28.097398815055683, 22.46239322796464, 22.546097092330456, 21.99485370516777, 23.955004659791783, 24.15825471033652, 24.296210033198193, 32.820525984085776, 32.03859018782774, 32.81852191120075, 22.657890460143477, 22.415216258416564, 22.265465343991906, 30.270963733394936, 30.24443934982021, 30.54775519839798, 24.983260403076798, 25.005908752481133, 24.939272622267396, 22.22672326614459, 22.36262397964795, 22.671972290923193, 24.96806568155685, 25.357997060442955, 25.405470157663018, 27.321790777146816, 27.027546599507332, 27.291597597301006, 24.828221634030342, 24.917742185294628, 24.894852958619595, 23.764924382170037, 24.123904549827174, 24.347277661630258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14143245874863541, "mean_inference_ms": 0.6441045109272031, "mean_action_processing_ms": 0.09489766388161673, "mean_env_wait_ms": 0.7954935231981759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 796800, "timesteps_this_iter": 0, "agent_timesteps_total": 2390400, "timers": {"sample_time_ms": 9239.046, "sample_throughput": 519.534, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1191.217, "learn_throughput": 4029.494, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20272865295410158, "cur_lr": 0.0005, "total_loss": 6.290421843528748, "policy_loss": 3.8331690488391246e-05, "vf_loss": 6.439446449279785, "vf_explained_var": 0.011778280138969421, "kl": 0.007178160187549506, "entropy": 15.051800727844238, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 796800, "num_agent_steps_sampled": 2390400, "num_steps_trained": 796800, "num_agent_steps_trained": 2390400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3585, "training_iteration": 166, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-08-35", "timestamp": 1706148515, "time_this_iter_s": 9.083549499511719, "time_total_s": 1554.292367219925, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BFD430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1554.292367219925, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 7.6499999999999995, "ram_util_percent": 47.616666666666674}}
{"episode_reward_max": 108.52139383147002, "episode_reward_min": -12.347726598382025, "episode_reward_mean": 73.68832544716336, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -4.360079591472953}, "policy_reward_max": {"shared_policy": 36.66111121167583}, "policy_reward_mean": {"shared_policy": 24.56277514905445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.05106341838837, 75.14242051914334, 70.47511601983567, 79.9214903535321, 80.78576325625178, 95.12970338575539, 75.31136818230149, 76.14290713146329, 98.0827671214938, 63.652419127523885, 73.73482478037474, 80.83574082702395, 58.96535233408211, 64.32462089508769, 64.68377102538943, 91.03184466995299, 67.92904598056336, 89.12815430574118, 71.5848783981055, 72.17236960874287, 71.29388531669974, 57.53762740641831, 64.80597931146622, 56.76494726538658, 75.96667412668465, 92.63903826661407, 47.479418003465966, 74.17724360339342, 79.58027459867299, 96.9876581719145, 87.12439618632195, 65.62839993223314, 66.45647393167017, -12.347726598382025, 75.76849242858587, 70.49660792574286, 89.42581841722131, 81.0358569100499, 63.88340724329461, 60.87185482680796, 72.8004103247076, 81.79653296433388, 72.27371923252939, 96.8399553275667, 83.87913154438137, 50.48714765626936, 98.13996750675139, 68.17992995679377, 76.503219878301, 81.66416189074513, 78.18120602518319, 68.37306845188138, 85.58559478819367, 92.81202656775713, 79.81381791085002, 80.88086935132742, 72.4803817272186, 79.86201685015111, 68.28153659403323, 78.83811283111571, 62.8153155595064, 55.555914731696234, 63.64265320636329, 42.80412746593353, 83.5202677696943, 72.59844833984971, 74.71424292982556, 55.17693055048582, 92.19398525357246, 85.11133582890031, 64.80603706836699, 62.6202598288655, 84.22904981300233, 67.00334402546287, 72.4094694033265, 97.67763808311426, 67.33857206255195, 91.06315828161313, 74.92844177782533, 67.26131953671573, 75.73153289966282, 81.64093497395515, 74.64081677794456, 72.23610659362747, 80.19041896797714, 82.91187233105302, 68.42153957299885, 58.034592688083634, 96.76459096907635, 47.03959561139342, 84.76382787711918, 59.669652268290506, 87.55591415497473, 68.56286258250475, 66.02965026348826, 108.52139383147002, 49.151969148311764, 66.39992961403914, 78.47217811178413, 58.28789796680212], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.32839895784855, 27.866605788469315, 27.856058672070503, 25.01591307669878, 24.838568471372128, 25.287938971072435, 23.031166459123284, 23.562321218351514, 23.88162834236087, 26.098728249470383, 26.800638078401477, 27.022124025660247, 27.155127479384333, 27.089666976282984, 26.540968800584466, 32.123099096740276, 31.483374784390122, 31.523229504624993, 25.053334000209958, 25.40788723776737, 24.850146944324166, 25.35931644588709, 25.135497391223907, 25.648093294352293, 32.69155831759174, 32.74603845303257, 32.64517035086949, 21.080176909764603, 21.346655940016106, 21.225586277743176, 24.56658315906921, 24.505539322892815, 24.66270229841271, 26.89953404168287, 27.360135974983365, 26.57607081035772, 19.743725908299282, 19.928211783369377, 19.293414642413452, 21.29669677714506, 21.478310621033103, 21.54961349690953, 21.75827895104885, 21.80030721053481, 21.12518486380577, 30.223608292639256, 30.497940653935075, 30.31029572337866, 22.3828816662232, 23.117432445675746, 22.428731868664414, 29.637082574268177, 29.471703117092446, 30.019368614380554, 23.655251622200012, 23.738974690437317, 24.190652085468173, 23.711580497523144, 24.18660695975025, 24.274182151469475, 23.639557361602783, 23.670367673039436, 23.983960282057524, 19.266953462113932, 19.015970689555004, 19.254703254749373, 21.67109389230609, 21.691026281565428, 21.4438591375947, 18.986736342310905, 19.0170067101717, 18.761204212903976, 25.110430394609764, 25.523519491155938, 25.33272424091895, 30.91370727618535, 30.912960364793733, 30.812370625634983, 15.798703653117016, 15.944922747866556, 15.735791602482394, 24.481361364324883, 24.917045734201864, 24.778836504866675, 26.761772068217397, 26.38999419659376, 26.428508333861828, 32.42235738349457, 32.05220040430625, 32.513100384113685, 29.251246618727833, 28.438371102015168, 29.434778465578944, 22.013034316497695, 21.85535705213745, 21.760008563597992, 22.26913882916172, 22.25898189966877, 21.928353202839688, -4.360079591472953, -3.868565236528724, -4.1190817703803475, 25.078772490223244, 25.400125894074634, 25.289594044287995, 23.818963821977377, 23.755419999361038, 22.92222410440445, 29.899272993206978, 29.805839527398348, 29.720705896615982, 26.857832362254456, 27.299737212558583, 26.878287335236863, 21.205651241044194, 21.26358466471234, 21.41417133753808, 20.50106320281823, 20.54013069470723, 19.8306609292825, 23.90317345658937, 24.588030685360224, 24.309206182758004, 27.12055630733569, 27.055291344722107, 27.62068531227608, 24.25125668322046, 24.02736623336871, 23.995096315940216, 32.18462789182861, 32.225258515526846, 32.43006892021124, 27.574381058414772, 28.18219705795248, 28.122553428014115, 16.488082771499947, 16.81576757629712, 17.18329730847229, 32.42643703023592, 32.984926470244915, 32.72860400627056, 22.133395706613854, 23.046806917836264, 22.999727332343653, 25.19951097170511, 25.590207031617553, 25.713501874978334, 27.473086299995572, 27.22347270200649, 26.967602888743073, 26.05322727312644, 25.896294129391507, 26.23168462266524, 22.902598037074, 22.721875655154378, 22.748594759653002, 28.853820505241544, 28.147068078319222, 28.58470620463291, 30.670842185616493, 30.95872174203396, 31.182462640106678, 26.73161012555161, 26.630887440095336, 26.451320345203072, 26.930750019848347, 26.81685984879732, 27.13325948268175, 24.072067240873963, 24.068688216308743, 24.339626270035893, 26.766040036765233, 26.459488054116562, 26.636488759269312, 22.705559720595673, 22.704063942035035, 22.87191293140252, 26.27467106779416, 26.325268556674317, 26.238173206647232, 20.92466103037198, 21.0910213937362, 20.799633135398224, 18.6269150947531, 18.613913356636957, 18.315086280306176, 21.515111692870647, 21.419902464995772, 20.707639048496873, 14.5358206766347, 14.106076608101517, 14.162230181197316, 27.849206196765095, 27.997135090331227, 27.673926482597977, 24.177066646516323, 24.382000248879194, 24.039381444454193, 24.315115615725517, 24.973171085119247, 25.425956228980795, 18.56684799368182, 18.243436152736336, 18.366646404067666, 30.808024793863297, 30.547676995396614, 30.838283464312553, 28.203004653255135, 28.427575098971516, 28.480756076673657, 21.616107047845915, 21.762467221667364, 21.42746279885371, 20.519394765297562, 21.0409936706225, 21.05987139294544, 28.20021442448099, 27.93143657346566, 28.097398815055683, 22.46239322796464, 22.546097092330456, 21.99485370516777, 23.955004659791783, 24.15825471033652, 24.296210033198193, 32.820525984085776, 32.03859018782774, 32.81852191120075, 22.657890460143477, 22.415216258416564, 22.265465343991906, 30.270963733394936, 30.24443934982021, 30.54775519839798, 24.983260403076798, 25.005908752481133, 24.939272622267396, 22.22672326614459, 22.36262397964795, 22.671972290923193, 24.96806568155685, 25.357997060442955, 25.405470157663018, 27.321790777146816, 27.027546599507332, 27.291597597301006, 24.828221634030342, 24.917742185294628, 24.894852958619595, 23.764924382170037, 24.123904549827174, 24.347277661630258, 26.429237859944493, 26.930800803626568, 26.830380304406077, 27.312294967472553, 27.869772078469396, 27.72980528511107, 22.75047781939307, 22.91542049559453, 22.755641258011252, 19.370112977301076, 19.29622172315915, 19.36825798762341, 32.146128239730984, 31.969068507353455, 32.64939422199191, 15.790088913093001, 15.410799356798321, 15.8387073415021, 28.29273833706975, 28.227309592068195, 28.24377994798124, 19.638991748293236, 19.887477849920586, 20.143182670076683, 29.32964226750967, 28.907769684990242, 29.318502202474818, 23.519636519253254, 22.531362414360046, 22.51186364889145, 21.8055085937182, 22.220196435848862, 22.0039452339212, 36.66111121167583, 35.89712160329023, 35.96316101650396, 16.28665306419134, 16.53381426865235, 16.331501815468073, 22.21161082573235, 22.219394392566755, 21.968924395740032, 26.306111151042074, 26.12892413015166, 26.037142830590398, 19.27970677614212, 19.494430255144835, 19.513760935515165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1414108777931635, "mean_inference_ms": 0.6442656427109386, "mean_action_processing_ms": 0.09490902183808128, "mean_env_wait_ms": 0.7955117428574526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 801600, "timesteps_this_iter": 0, "agent_timesteps_total": 2404800, "timers": {"sample_time_ms": 9288.624, "sample_throughput": 516.761, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1193.51, "learn_throughput": 4021.75, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20272865295410158, "cur_lr": 0.0005, "total_loss": 6.643434584140778, "policy_loss": 0.0005601647037716262, "vf_loss": 6.793495237827301, "vf_explained_var": 0.006389394402503967, "kl": 0.008529174840307772, "entropy": 15.23498809337616, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 801600, "num_agent_steps_sampled": 2404800, "num_steps_trained": 801600, "num_agent_steps_trained": 2404800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3601, "training_iteration": 167, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-08-44", "timestamp": 1706148524, "time_this_iter_s": 9.432392358779907, "time_total_s": 1563.7247595787048, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C2D3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1563.7247595787048, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 8.914285714285715, "ram_util_percent": 47.664285714285725}}
{"episode_reward_max": 108.52139383147002, "episode_reward_min": -12.347726598382025, "episode_reward_mean": 74.079483115536, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -4.360079591472953}, "policy_reward_max": {"shared_policy": 36.66111121167583}, "policy_reward_mean": {"shared_policy": 24.693161038511988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.92904598056336, 89.12815430574118, 71.5848783981055, 72.17236960874287, 71.29388531669974, 57.53762740641831, 64.80597931146622, 56.76494726538658, 75.96667412668465, 92.63903826661407, 47.479418003465966, 74.17724360339342, 79.58027459867299, 96.9876581719145, 87.12439618632195, 65.62839993223314, 66.45647393167017, -12.347726598382025, 75.76849242858587, 70.49660792574286, 89.42581841722131, 81.0358569100499, 63.88340724329461, 60.87185482680796, 72.8004103247076, 81.79653296433388, 72.27371923252939, 96.8399553275667, 83.87913154438137, 50.48714765626936, 98.13996750675139, 68.17992995679377, 76.503219878301, 81.66416189074513, 78.18120602518319, 68.37306845188138, 85.58559478819367, 92.81202656775713, 79.81381791085002, 80.88086935132742, 72.4803817272186, 79.86201685015111, 68.28153659403323, 78.83811283111571, 62.8153155595064, 55.555914731696234, 63.64265320636329, 42.80412746593353, 83.5202677696943, 72.59844833984971, 74.71424292982556, 55.17693055048582, 92.19398525357246, 85.11133582890031, 64.80603706836699, 62.6202598288655, 84.22904981300233, 67.00334402546287, 72.4094694033265, 97.67763808311426, 67.33857206255195, 91.06315828161313, 74.92844177782533, 67.26131953671573, 75.73153289966282, 81.64093497395515, 74.64081677794456, 72.23610659362747, 80.19041896797714, 82.91187233105302, 68.42153957299885, 58.034592688083634, 96.76459096907635, 47.03959561139342, 84.76382787711918, 59.669652268290506, 87.55591415497473, 68.56286258250475, 66.02965026348826, 108.52139383147002, 49.151969148311764, 66.39992961403914, 78.47217811178413, 58.28789796680212, 93.70083633670583, 99.27276703715323, 79.83355078101155, 84.47475603036581, 68.39956637448628, 82.54332036338744, 78.21707975119352, 74.36951680667697, 86.12657289532942, 96.40159080177543, 89.56302286311984, 61.471498003229485, 57.773193262517424, 67.51816823333502, 76.59548908472058, 75.12601125985381], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.3828816662232, 23.117432445675746, 22.428731868664414, 29.637082574268177, 29.471703117092446, 30.019368614380554, 23.655251622200012, 23.738974690437317, 24.190652085468173, 23.711580497523144, 24.18660695975025, 24.274182151469475, 23.639557361602783, 23.670367673039436, 23.983960282057524, 19.266953462113932, 19.015970689555004, 19.254703254749373, 21.67109389230609, 21.691026281565428, 21.4438591375947, 18.986736342310905, 19.0170067101717, 18.761204212903976, 25.110430394609764, 25.523519491155938, 25.33272424091895, 30.91370727618535, 30.912960364793733, 30.812370625634983, 15.798703653117016, 15.944922747866556, 15.735791602482394, 24.481361364324883, 24.917045734201864, 24.778836504866675, 26.761772068217397, 26.38999419659376, 26.428508333861828, 32.42235738349457, 32.05220040430625, 32.513100384113685, 29.251246618727833, 28.438371102015168, 29.434778465578944, 22.013034316497695, 21.85535705213745, 21.760008563597992, 22.26913882916172, 22.25898189966877, 21.928353202839688, -4.360079591472953, -3.868565236528724, -4.1190817703803475, 25.078772490223244, 25.400125894074634, 25.289594044287995, 23.818963821977377, 23.755419999361038, 22.92222410440445, 29.899272993206978, 29.805839527398348, 29.720705896615982, 26.857832362254456, 27.299737212558583, 26.878287335236863, 21.205651241044194, 21.26358466471234, 21.41417133753808, 20.50106320281823, 20.54013069470723, 19.8306609292825, 23.90317345658937, 24.588030685360224, 24.309206182758004, 27.12055630733569, 27.055291344722107, 27.62068531227608, 24.25125668322046, 24.02736623336871, 23.995096315940216, 32.18462789182861, 32.225258515526846, 32.43006892021124, 27.574381058414772, 28.18219705795248, 28.122553428014115, 16.488082771499947, 16.81576757629712, 17.18329730847229, 32.42643703023592, 32.984926470244915, 32.72860400627056, 22.133395706613854, 23.046806917836264, 22.999727332343653, 25.19951097170511, 25.590207031617553, 25.713501874978334, 27.473086299995572, 27.22347270200649, 26.967602888743073, 26.05322727312644, 25.896294129391507, 26.23168462266524, 22.902598037074, 22.721875655154378, 22.748594759653002, 28.853820505241544, 28.147068078319222, 28.58470620463291, 30.670842185616493, 30.95872174203396, 31.182462640106678, 26.73161012555161, 26.630887440095336, 26.451320345203072, 26.930750019848347, 26.81685984879732, 27.13325948268175, 24.072067240873963, 24.068688216308743, 24.339626270035893, 26.766040036765233, 26.459488054116562, 26.636488759269312, 22.705559720595673, 22.704063942035035, 22.87191293140252, 26.27467106779416, 26.325268556674317, 26.238173206647232, 20.92466103037198, 21.0910213937362, 20.799633135398224, 18.6269150947531, 18.613913356636957, 18.315086280306176, 21.515111692870647, 21.419902464995772, 20.707639048496873, 14.5358206766347, 14.106076608101517, 14.162230181197316, 27.849206196765095, 27.997135090331227, 27.673926482597977, 24.177066646516323, 24.382000248879194, 24.039381444454193, 24.315115615725517, 24.973171085119247, 25.425956228980795, 18.56684799368182, 18.243436152736336, 18.366646404067666, 30.808024793863297, 30.547676995396614, 30.838283464312553, 28.203004653255135, 28.427575098971516, 28.480756076673657, 21.616107047845915, 21.762467221667364, 21.42746279885371, 20.519394765297562, 21.0409936706225, 21.05987139294544, 28.20021442448099, 27.93143657346566, 28.097398815055683, 22.46239322796464, 22.546097092330456, 21.99485370516777, 23.955004659791783, 24.15825471033652, 24.296210033198193, 32.820525984085776, 32.03859018782774, 32.81852191120075, 22.657890460143477, 22.415216258416564, 22.265465343991906, 30.270963733394936, 30.24443934982021, 30.54775519839798, 24.983260403076798, 25.005908752481133, 24.939272622267396, 22.22672326614459, 22.36262397964795, 22.671972290923193, 24.96806568155685, 25.357997060442955, 25.405470157663018, 27.321790777146816, 27.027546599507332, 27.291597597301006, 24.828221634030342, 24.917742185294628, 24.894852958619595, 23.764924382170037, 24.123904549827174, 24.347277661630258, 26.429237859944493, 26.930800803626568, 26.830380304406077, 27.312294967472553, 27.869772078469396, 27.72980528511107, 22.75047781939307, 22.91542049559453, 22.755641258011252, 19.370112977301076, 19.29622172315915, 19.36825798762341, 32.146128239730984, 31.969068507353455, 32.64939422199191, 15.790088913093001, 15.410799356798321, 15.8387073415021, 28.29273833706975, 28.227309592068195, 28.24377994798124, 19.638991748293236, 19.887477849920586, 20.143182670076683, 29.32964226750967, 28.907769684990242, 29.318502202474818, 23.519636519253254, 22.531362414360046, 22.51186364889145, 21.8055085937182, 22.220196435848862, 22.0039452339212, 36.66111121167583, 35.89712160329023, 35.96316101650396, 16.28665306419134, 16.53381426865235, 16.331501815468073, 22.21161082573235, 22.219394392566755, 21.968924395740032, 26.306111151042074, 26.12892413015166, 26.037142830590398, 19.27970677614212, 19.494430255144835, 19.513760935515165, 31.33471842110157, 30.921398729085922, 31.44471918651834, 32.870203999181584, 33.1572978173693, 33.24526522060235, 26.777158091465623, 26.963364640871674, 26.093028048674256, 28.254659387593463, 28.084941448022917, 28.13515519474943, 22.843771352122218, 22.564830015103013, 22.990965007261053, 27.81661930369833, 27.64969967181483, 27.077001387874276, 26.025947518646717, 26.25713288784027, 25.933999344706535, 24.63350497682889, 24.62574318548043, 25.11026864436765, 28.37411698202291, 28.697789984444768, 29.054665928861738, 32.15274523446956, 32.10139702508846, 32.147448542217404, 29.80781039595604, 29.759062737226486, 29.996149729937315, 20.291476932664708, 20.452814561625317, 20.72720650893946, 19.038969735304505, 19.19032962123552, 19.5438939059774, 22.593104675412178, 22.63447353988886, 22.29059001803398, 25.65074027205506, 25.76891292507449, 25.175835887591035, 25.143958429495484, 24.819914350907, 25.16213847945133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1413856350748704, "mean_inference_ms": 0.644416143542735, "mean_action_processing_ms": 0.09492323131552396, "mean_env_wait_ms": 0.7955172045322427, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 806400, "timesteps_this_iter": 0, "agent_timesteps_total": 2419200, "timers": {"sample_time_ms": 9323.573, "sample_throughput": 514.824, "load_time_ms": 0.1, "load_throughput": 48037841.088, "learn_time_ms": 1194.211, "learn_throughput": 4019.389, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20272865295410158, "cur_lr": 0.0005, "total_loss": 7.169840335845947, "policy_loss": -0.00010122299757009401, "vf_loss": 7.319827318191528, "vf_explained_var": 0.007433511316776276, "kl": 0.00849104905523989, "entropy": 15.160719156265259, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 806400, "num_agent_steps_sampled": 2419200, "num_steps_trained": 806400, "num_agent_steps_trained": 2419200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3617, "training_iteration": 168, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-08-54", "timestamp": 1706148534, "time_this_iter_s": 9.382810592651367, "time_total_s": 1573.1075701713562, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF58B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1573.1075701713562, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 8.584615384615384, "ram_util_percent": 47.62307692307694}}
{"episode_reward_max": 108.52139383147002, "episode_reward_min": -12.347726598382025, "episode_reward_mean": 74.5796428576194, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -4.360079591472953}, "policy_reward_max": {"shared_policy": 36.66111121167583}, "policy_reward_mean": {"shared_policy": 24.859880952539793}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.45647393167017, -12.347726598382025, 75.76849242858587, 70.49660792574286, 89.42581841722131, 81.0358569100499, 63.88340724329461, 60.87185482680796, 72.8004103247076, 81.79653296433388, 72.27371923252939, 96.8399553275667, 83.87913154438137, 50.48714765626936, 98.13996750675139, 68.17992995679377, 76.503219878301, 81.66416189074513, 78.18120602518319, 68.37306845188138, 85.58559478819367, 92.81202656775713, 79.81381791085002, 80.88086935132742, 72.4803817272186, 79.86201685015111, 68.28153659403323, 78.83811283111571, 62.8153155595064, 55.555914731696234, 63.64265320636329, 42.80412746593353, 83.5202677696943, 72.59844833984971, 74.71424292982556, 55.17693055048582, 92.19398525357246, 85.11133582890031, 64.80603706836699, 62.6202598288655, 84.22904981300233, 67.00334402546287, 72.4094694033265, 97.67763808311426, 67.33857206255195, 91.06315828161313, 74.92844177782533, 67.26131953671573, 75.73153289966282, 81.64093497395515, 74.64081677794456, 72.23610659362747, 80.19041896797714, 82.91187233105302, 68.42153957299885, 58.034592688083634, 96.76459096907635, 47.03959561139342, 84.76382787711918, 59.669652268290506, 87.55591415497473, 68.56286258250475, 66.02965026348826, 108.52139383147002, 49.151969148311764, 66.39992961403914, 78.47217811178413, 58.28789796680212, 93.70083633670583, 99.27276703715323, 79.83355078101155, 84.47475603036581, 68.39956637448628, 82.54332036338744, 78.21707975119352, 74.36951680667697, 86.12657289532942, 96.40159080177543, 89.56302286311984, 61.471498003229485, 57.773193262517424, 67.51816823333502, 76.59548908472058, 75.12601125985381, 76.10225276934942, 64.09891958534718, 72.79079474508761, 57.81088107638058, 52.855932444334016, 83.25586546212433, 72.46890119835734, 71.68292698170987, 63.53346596285698, 91.7885670289397, 81.70959628868147, 77.05565179511903, 92.51349909417328, 92.52573088556525, 83.03754733502862, 87.58543203771112], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.26913882916172, 22.25898189966877, 21.928353202839688, -4.360079591472953, -3.868565236528724, -4.1190817703803475, 25.078772490223244, 25.400125894074634, 25.289594044287995, 23.818963821977377, 23.755419999361038, 22.92222410440445, 29.899272993206978, 29.805839527398348, 29.720705896615982, 26.857832362254456, 27.299737212558583, 26.878287335236863, 21.205651241044194, 21.26358466471234, 21.41417133753808, 20.50106320281823, 20.54013069470723, 19.8306609292825, 23.90317345658937, 24.588030685360224, 24.309206182758004, 27.12055630733569, 27.055291344722107, 27.62068531227608, 24.25125668322046, 24.02736623336871, 23.995096315940216, 32.18462789182861, 32.225258515526846, 32.43006892021124, 27.574381058414772, 28.18219705795248, 28.122553428014115, 16.488082771499947, 16.81576757629712, 17.18329730847229, 32.42643703023592, 32.984926470244915, 32.72860400627056, 22.133395706613854, 23.046806917836264, 22.999727332343653, 25.19951097170511, 25.590207031617553, 25.713501874978334, 27.473086299995572, 27.22347270200649, 26.967602888743073, 26.05322727312644, 25.896294129391507, 26.23168462266524, 22.902598037074, 22.721875655154378, 22.748594759653002, 28.853820505241544, 28.147068078319222, 28.58470620463291, 30.670842185616493, 30.95872174203396, 31.182462640106678, 26.73161012555161, 26.630887440095336, 26.451320345203072, 26.930750019848347, 26.81685984879732, 27.13325948268175, 24.072067240873963, 24.068688216308743, 24.339626270035893, 26.766040036765233, 26.459488054116562, 26.636488759269312, 22.705559720595673, 22.704063942035035, 22.87191293140252, 26.27467106779416, 26.325268556674317, 26.238173206647232, 20.92466103037198, 21.0910213937362, 20.799633135398224, 18.6269150947531, 18.613913356636957, 18.315086280306176, 21.515111692870647, 21.419902464995772, 20.707639048496873, 14.5358206766347, 14.106076608101517, 14.162230181197316, 27.849206196765095, 27.997135090331227, 27.673926482597977, 24.177066646516323, 24.382000248879194, 24.039381444454193, 24.315115615725517, 24.973171085119247, 25.425956228980795, 18.56684799368182, 18.243436152736336, 18.366646404067666, 30.808024793863297, 30.547676995396614, 30.838283464312553, 28.203004653255135, 28.427575098971516, 28.480756076673657, 21.616107047845915, 21.762467221667364, 21.42746279885371, 20.519394765297562, 21.0409936706225, 21.05987139294544, 28.20021442448099, 27.93143657346566, 28.097398815055683, 22.46239322796464, 22.546097092330456, 21.99485370516777, 23.955004659791783, 24.15825471033652, 24.296210033198193, 32.820525984085776, 32.03859018782774, 32.81852191120075, 22.657890460143477, 22.415216258416564, 22.265465343991906, 30.270963733394936, 30.24443934982021, 30.54775519839798, 24.983260403076798, 25.005908752481133, 24.939272622267396, 22.22672326614459, 22.36262397964795, 22.671972290923193, 24.96806568155685, 25.357997060442955, 25.405470157663018, 27.321790777146816, 27.027546599507332, 27.291597597301006, 24.828221634030342, 24.917742185294628, 24.894852958619595, 23.764924382170037, 24.123904549827174, 24.347277661630258, 26.429237859944493, 26.930800803626568, 26.830380304406077, 27.312294967472553, 27.869772078469396, 27.72980528511107, 22.75047781939307, 22.91542049559453, 22.755641258011252, 19.370112977301076, 19.29622172315915, 19.36825798762341, 32.146128239730984, 31.969068507353455, 32.64939422199191, 15.790088913093001, 15.410799356798321, 15.8387073415021, 28.29273833706975, 28.227309592068195, 28.24377994798124, 19.638991748293236, 19.887477849920586, 20.143182670076683, 29.32964226750967, 28.907769684990242, 29.318502202474818, 23.519636519253254, 22.531362414360046, 22.51186364889145, 21.8055085937182, 22.220196435848862, 22.0039452339212, 36.66111121167583, 35.89712160329023, 35.96316101650396, 16.28665306419134, 16.53381426865235, 16.331501815468073, 22.21161082573235, 22.219394392566755, 21.968924395740032, 26.306111151042074, 26.12892413015166, 26.037142830590398, 19.27970677614212, 19.494430255144835, 19.513760935515165, 31.33471842110157, 30.921398729085922, 31.44471918651834, 32.870203999181584, 33.1572978173693, 33.24526522060235, 26.777158091465623, 26.963364640871674, 26.093028048674256, 28.254659387593463, 28.084941448022917, 28.13515519474943, 22.843771352122218, 22.564830015103013, 22.990965007261053, 27.81661930369833, 27.64969967181483, 27.077001387874276, 26.025947518646717, 26.25713288784027, 25.933999344706535, 24.63350497682889, 24.62574318548043, 25.11026864436765, 28.37411698202291, 28.697789984444768, 29.054665928861738, 32.15274523446956, 32.10139702508846, 32.147448542217404, 29.80781039595604, 29.759062737226486, 29.996149729937315, 20.291476932664708, 20.452814561625317, 20.72720650893946, 19.038969735304505, 19.19032962123552, 19.5438939059774, 22.593104675412178, 22.63447353988886, 22.29059001803398, 25.65074027205506, 25.76891292507449, 25.175835887591035, 25.143958429495484, 24.819914350907, 25.16213847945133, 25.564896542954855, 25.16582939525445, 25.371526831140116, 21.53950224071741, 21.561513043940067, 20.997904300689697, 24.039511059721306, 24.44572453697522, 24.305559148391083, 19.514363393808395, 19.20489657173553, 19.091621110836655, 17.41464264442523, 17.687964883943394, 17.753324915965393, 27.93367395487924, 27.507413414617375, 27.81477809262772, 24.147096874192357, 24.103829126805067, 24.21797519735992, 23.83405529956022, 23.77243378261724, 24.076437899532408, 21.184153671065957, 21.041560808817536, 21.307751482973487, 30.709153110782296, 30.191545257965714, 30.887868660191685, 27.058222527305276, 27.824022598545213, 26.82735116283098, 25.719130886097744, 25.28867720564206, 26.04784370337923, 30.581961321334035, 31.018874031181127, 30.912663741658122, 30.684825370709092, 30.76770685861507, 31.07319865624109, 27.665900009373814, 27.843732478717953, 27.527914846936852, 29.03090068201223, 29.26282801727453, 29.291703338424355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14135251978511626, "mean_inference_ms": 0.644514890805359, "mean_action_processing_ms": 0.0949321157593765, "mean_env_wait_ms": 0.7955029363030914, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 811200, "timesteps_this_iter": 0, "agent_timesteps_total": 2433600, "timers": {"sample_time_ms": 9341.914, "sample_throughput": 513.813, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1195.579, "learn_throughput": 4014.792, "update_time_ms": 1.601}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20272865295410158, "cur_lr": 0.0005, "total_loss": 5.967654705047607, "policy_loss": -0.001085735643023833, "vf_loss": 6.121195018291473, "vf_explained_var": 0.0071304962038993835, "kl": 0.005592015106464068, "entropy": 15.358789086341858, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 811200, "num_agent_steps_sampled": 2433600, "num_steps_trained": 811200, "num_agent_steps_trained": 2433600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3633, "training_iteration": 169, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-09-03", "timestamp": 1706148543, "time_this_iter_s": 9.155653953552246, "time_total_s": 1582.2632241249084, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C2D040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1582.2632241249084, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 10.784615384615384, "ram_util_percent": 47.63076923076923}}
{"episode_reward_max": 108.52139383147002, "episode_reward_min": 42.80412746593353, "episode_reward_mean": 76.12477311249945, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.106076608101517}, "policy_reward_max": {"shared_policy": 36.66111121167583}, "policy_reward_mean": {"shared_policy": 25.37492437083315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.503219878301, 81.66416189074513, 78.18120602518319, 68.37306845188138, 85.58559478819367, 92.81202656775713, 79.81381791085002, 80.88086935132742, 72.4803817272186, 79.86201685015111, 68.28153659403323, 78.83811283111571, 62.8153155595064, 55.555914731696234, 63.64265320636329, 42.80412746593353, 83.5202677696943, 72.59844833984971, 74.71424292982556, 55.17693055048582, 92.19398525357246, 85.11133582890031, 64.80603706836699, 62.6202598288655, 84.22904981300233, 67.00334402546287, 72.4094694033265, 97.67763808311426, 67.33857206255195, 91.06315828161313, 74.92844177782533, 67.26131953671573, 75.73153289966282, 81.64093497395515, 74.64081677794456, 72.23610659362747, 80.19041896797714, 82.91187233105302, 68.42153957299885, 58.034592688083634, 96.76459096907635, 47.03959561139342, 84.76382787711918, 59.669652268290506, 87.55591415497473, 68.56286258250475, 66.02965026348826, 108.52139383147002, 49.151969148311764, 66.39992961403914, 78.47217811178413, 58.28789796680212, 93.70083633670583, 99.27276703715323, 79.83355078101155, 84.47475603036581, 68.39956637448628, 82.54332036338744, 78.21707975119352, 74.36951680667697, 86.12657289532942, 96.40159080177543, 89.56302286311984, 61.471498003229485, 57.773193262517424, 67.51816823333502, 76.59548908472058, 75.12601125985381, 76.10225276934942, 64.09891958534718, 72.79079474508761, 57.81088107638058, 52.855932444334016, 83.25586546212433, 72.46890119835734, 71.68292698170987, 63.53346596285698, 91.7885670289397, 81.70959628868147, 77.05565179511903, 92.51349909417328, 92.52573088556525, 83.03754733502862, 87.58543203771112, 77.18840773776171, 85.47061874531208, 64.13351261615753, 78.05253626219925, 90.58268423378468, 66.09634936973451, 89.27059625089167, 83.32201833650468, 79.54273764789103, 94.74770200997591, 73.85251394379884, 76.0844093840569, 106.67464564368127, 72.78834958374497, 55.2284002304077, 81.46512309042737], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.19951097170511, 25.590207031617553, 25.713501874978334, 27.473086299995572, 27.22347270200649, 26.967602888743073, 26.05322727312644, 25.896294129391507, 26.23168462266524, 22.902598037074, 22.721875655154378, 22.748594759653002, 28.853820505241544, 28.147068078319222, 28.58470620463291, 30.670842185616493, 30.95872174203396, 31.182462640106678, 26.73161012555161, 26.630887440095336, 26.451320345203072, 26.930750019848347, 26.81685984879732, 27.13325948268175, 24.072067240873963, 24.068688216308743, 24.339626270035893, 26.766040036765233, 26.459488054116562, 26.636488759269312, 22.705559720595673, 22.704063942035035, 22.87191293140252, 26.27467106779416, 26.325268556674317, 26.238173206647232, 20.92466103037198, 21.0910213937362, 20.799633135398224, 18.6269150947531, 18.613913356636957, 18.315086280306176, 21.515111692870647, 21.419902464995772, 20.707639048496873, 14.5358206766347, 14.106076608101517, 14.162230181197316, 27.849206196765095, 27.997135090331227, 27.673926482597977, 24.177066646516323, 24.382000248879194, 24.039381444454193, 24.315115615725517, 24.973171085119247, 25.425956228980795, 18.56684799368182, 18.243436152736336, 18.366646404067666, 30.808024793863297, 30.547676995396614, 30.838283464312553, 28.203004653255135, 28.427575098971516, 28.480756076673657, 21.616107047845915, 21.762467221667364, 21.42746279885371, 20.519394765297562, 21.0409936706225, 21.05987139294544, 28.20021442448099, 27.93143657346566, 28.097398815055683, 22.46239322796464, 22.546097092330456, 21.99485370516777, 23.955004659791783, 24.15825471033652, 24.296210033198193, 32.820525984085776, 32.03859018782774, 32.81852191120075, 22.657890460143477, 22.415216258416564, 22.265465343991906, 30.270963733394936, 30.24443934982021, 30.54775519839798, 24.983260403076798, 25.005908752481133, 24.939272622267396, 22.22672326614459, 22.36262397964795, 22.671972290923193, 24.96806568155685, 25.357997060442955, 25.405470157663018, 27.321790777146816, 27.027546599507332, 27.291597597301006, 24.828221634030342, 24.917742185294628, 24.894852958619595, 23.764924382170037, 24.123904549827174, 24.347277661630258, 26.429237859944493, 26.930800803626568, 26.830380304406077, 27.312294967472553, 27.869772078469396, 27.72980528511107, 22.75047781939307, 22.91542049559453, 22.755641258011252, 19.370112977301076, 19.29622172315915, 19.36825798762341, 32.146128239730984, 31.969068507353455, 32.64939422199191, 15.790088913093001, 15.410799356798321, 15.8387073415021, 28.29273833706975, 28.227309592068195, 28.24377994798124, 19.638991748293236, 19.887477849920586, 20.143182670076683, 29.32964226750967, 28.907769684990242, 29.318502202474818, 23.519636519253254, 22.531362414360046, 22.51186364889145, 21.8055085937182, 22.220196435848862, 22.0039452339212, 36.66111121167583, 35.89712160329023, 35.96316101650396, 16.28665306419134, 16.53381426865235, 16.331501815468073, 22.21161082573235, 22.219394392566755, 21.968924395740032, 26.306111151042074, 26.12892413015166, 26.037142830590398, 19.27970677614212, 19.494430255144835, 19.513760935515165, 31.33471842110157, 30.921398729085922, 31.44471918651834, 32.870203999181584, 33.1572978173693, 33.24526522060235, 26.777158091465623, 26.963364640871674, 26.093028048674256, 28.254659387593463, 28.084941448022917, 28.13515519474943, 22.843771352122218, 22.564830015103013, 22.990965007261053, 27.81661930369833, 27.64969967181483, 27.077001387874276, 26.025947518646717, 26.25713288784027, 25.933999344706535, 24.63350497682889, 24.62574318548043, 25.11026864436765, 28.37411698202291, 28.697789984444768, 29.054665928861738, 32.15274523446956, 32.10139702508846, 32.147448542217404, 29.80781039595604, 29.759062737226486, 29.996149729937315, 20.291476932664708, 20.452814561625317, 20.72720650893946, 19.038969735304505, 19.19032962123552, 19.5438939059774, 22.593104675412178, 22.63447353988886, 22.29059001803398, 25.65074027205506, 25.76891292507449, 25.175835887591035, 25.143958429495484, 24.819914350907, 25.16213847945133, 25.564896542954855, 25.16582939525445, 25.371526831140116, 21.53950224071741, 21.561513043940067, 20.997904300689697, 24.039511059721306, 24.44572453697522, 24.305559148391083, 19.514363393808395, 19.20489657173553, 19.091621110836655, 17.41464264442523, 17.687964883943394, 17.753324915965393, 27.93367395487924, 27.507413414617375, 27.81477809262772, 24.147096874192357, 24.103829126805067, 24.21797519735992, 23.83405529956022, 23.77243378261724, 24.076437899532408, 21.184153671065957, 21.041560808817536, 21.307751482973487, 30.709153110782296, 30.191545257965714, 30.887868660191685, 27.058222527305276, 27.824022598545213, 26.82735116283098, 25.719130886097744, 25.28867720564206, 26.04784370337923, 30.581961321334035, 31.018874031181127, 30.912663741658122, 30.684825370709092, 30.76770685861507, 31.07319865624109, 27.665900009373814, 27.843732478717953, 27.527914846936852, 29.03090068201223, 29.26282801727453, 29.291703338424355, 25.899249537537486, 25.399838070074708, 25.889320130149514, 28.51728921135266, 28.082894956072167, 28.870434577887252, 21.459321465343237, 21.338991869241, 21.335199281573296, 25.964495348433644, 25.978729645411164, 26.109311268354446, 30.16826594620943, 30.419108740985394, 29.99530954658985, 22.205058724929884, 21.86322185893853, 22.028068785866097, 29.646522914369896, 29.74641730015476, 29.877656036367014, 28.2329568353792, 27.754600596924618, 27.334460904200867, 26.230764006574944, 26.694210459788636, 26.61776318152745, 31.615446165204048, 31.993276618421078, 31.138979226350784, 24.51854170113802, 24.52500604838133, 24.808966194279492, 25.618941529343516, 25.601219792539865, 24.864248062173516, 35.121812288959816, 35.94638739650448, 35.60644595821698, 24.425390551487595, 24.150024729470402, 24.212934302786977, 18.710639898975685, 18.44890323777993, 18.068857093652085, 26.678530782461166, 27.72989859012887, 27.056693717837334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14133081595756775, "mean_inference_ms": 0.6445927964635371, "mean_action_processing_ms": 0.09493534403227002, "mean_env_wait_ms": 0.7954630113810094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 816000, "timesteps_this_iter": 0, "agent_timesteps_total": 2448000, "timers": {"sample_time_ms": 9363.014, "sample_throughput": 512.655, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1198.345, "learn_throughput": 4005.526, "update_time_ms": 1.695}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20272865295410158, "cur_lr": 0.0005, "total_loss": 7.702177941799164, "policy_loss": -0.0017119082470727909, "vf_loss": 7.8551284074783325, "vf_explained_var": 0.011329658329486847, "kl": 0.003438162850442569, "entropy": 15.193570733070374, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 816000, "num_agent_steps_sampled": 2448000, "num_steps_trained": 816000, "num_agent_steps_trained": 2448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3649, "training_iteration": 170, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-09-12", "timestamp": 1706148552, "time_this_iter_s": 9.139101266860962, "time_total_s": 1591.4023253917694, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1591.4023253917694, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 10.200000000000001, "ram_util_percent": 47.54615384615385}}
{"episode_reward_max": 108.52139383147002, "episode_reward_min": 47.03959561139342, "episode_reward_mean": 76.41177766412038, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 15.410799356798321}, "policy_reward_max": {"shared_policy": 36.66111121167583}, "policy_reward_mean": {"shared_policy": 25.470592554706787}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.5202677696943, 72.59844833984971, 74.71424292982556, 55.17693055048582, 92.19398525357246, 85.11133582890031, 64.80603706836699, 62.6202598288655, 84.22904981300233, 67.00334402546287, 72.4094694033265, 97.67763808311426, 67.33857206255195, 91.06315828161313, 74.92844177782533, 67.26131953671573, 75.73153289966282, 81.64093497395515, 74.64081677794456, 72.23610659362747, 80.19041896797714, 82.91187233105302, 68.42153957299885, 58.034592688083634, 96.76459096907635, 47.03959561139342, 84.76382787711918, 59.669652268290506, 87.55591415497473, 68.56286258250475, 66.02965026348826, 108.52139383147002, 49.151969148311764, 66.39992961403914, 78.47217811178413, 58.28789796680212, 93.70083633670583, 99.27276703715323, 79.83355078101155, 84.47475603036581, 68.39956637448628, 82.54332036338744, 78.21707975119352, 74.36951680667697, 86.12657289532942, 96.40159080177543, 89.56302286311984, 61.471498003229485, 57.773193262517424, 67.51816823333502, 76.59548908472058, 75.12601125985381, 76.10225276934942, 64.09891958534718, 72.79079474508761, 57.81088107638058, 52.855932444334016, 83.25586546212433, 72.46890119835734, 71.68292698170987, 63.53346596285698, 91.7885670289397, 81.70959628868147, 77.05565179511903, 92.51349909417328, 92.52573088556525, 83.03754733502862, 87.58543203771112, 77.18840773776171, 85.47061874531208, 64.13351261615753, 78.05253626219925, 90.58268423378468, 66.09634936973451, 89.27059625089167, 83.32201833650468, 79.54273764789103, 94.74770200997591, 73.85251394379884, 76.0844093840569, 106.67464564368127, 72.78834958374497, 55.2284002304077, 81.46512309042737, 70.26559435203671, 77.4301940910518, 74.35269267857073, 78.24826021865007, 77.040052264987, 68.17652693018316, 66.42371056252158, 60.91858500055969, 89.61966405814744, 69.32294756546615, 80.99084094353019, 84.41605596244334, 69.28900800645351, 68.03572896309197, 76.52809156663713, 85.73652582801877], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.849206196765095, 27.997135090331227, 27.673926482597977, 24.177066646516323, 24.382000248879194, 24.039381444454193, 24.315115615725517, 24.973171085119247, 25.425956228980795, 18.56684799368182, 18.243436152736336, 18.366646404067666, 30.808024793863297, 30.547676995396614, 30.838283464312553, 28.203004653255135, 28.427575098971516, 28.480756076673657, 21.616107047845915, 21.762467221667364, 21.42746279885371, 20.519394765297562, 21.0409936706225, 21.05987139294544, 28.20021442448099, 27.93143657346566, 28.097398815055683, 22.46239322796464, 22.546097092330456, 21.99485370516777, 23.955004659791783, 24.15825471033652, 24.296210033198193, 32.820525984085776, 32.03859018782774, 32.81852191120075, 22.657890460143477, 22.415216258416564, 22.265465343991906, 30.270963733394936, 30.24443934982021, 30.54775519839798, 24.983260403076798, 25.005908752481133, 24.939272622267396, 22.22672326614459, 22.36262397964795, 22.671972290923193, 24.96806568155685, 25.357997060442955, 25.405470157663018, 27.321790777146816, 27.027546599507332, 27.291597597301006, 24.828221634030342, 24.917742185294628, 24.894852958619595, 23.764924382170037, 24.123904549827174, 24.347277661630258, 26.429237859944493, 26.930800803626568, 26.830380304406077, 27.312294967472553, 27.869772078469396, 27.72980528511107, 22.75047781939307, 22.91542049559453, 22.755641258011252, 19.370112977301076, 19.29622172315915, 19.36825798762341, 32.146128239730984, 31.969068507353455, 32.64939422199191, 15.790088913093001, 15.410799356798321, 15.8387073415021, 28.29273833706975, 28.227309592068195, 28.24377994798124, 19.638991748293236, 19.887477849920586, 20.143182670076683, 29.32964226750967, 28.907769684990242, 29.318502202474818, 23.519636519253254, 22.531362414360046, 22.51186364889145, 21.8055085937182, 22.220196435848862, 22.0039452339212, 36.66111121167583, 35.89712160329023, 35.96316101650396, 16.28665306419134, 16.53381426865235, 16.331501815468073, 22.21161082573235, 22.219394392566755, 21.968924395740032, 26.306111151042074, 26.12892413015166, 26.037142830590398, 19.27970677614212, 19.494430255144835, 19.513760935515165, 31.33471842110157, 30.921398729085922, 31.44471918651834, 32.870203999181584, 33.1572978173693, 33.24526522060235, 26.777158091465623, 26.963364640871674, 26.093028048674256, 28.254659387593463, 28.084941448022917, 28.13515519474943, 22.843771352122218, 22.564830015103013, 22.990965007261053, 27.81661930369833, 27.64969967181483, 27.077001387874276, 26.025947518646717, 26.25713288784027, 25.933999344706535, 24.63350497682889, 24.62574318548043, 25.11026864436765, 28.37411698202291, 28.697789984444768, 29.054665928861738, 32.15274523446956, 32.10139702508846, 32.147448542217404, 29.80781039595604, 29.759062737226486, 29.996149729937315, 20.291476932664708, 20.452814561625317, 20.72720650893946, 19.038969735304505, 19.19032962123552, 19.5438939059774, 22.593104675412178, 22.63447353988886, 22.29059001803398, 25.65074027205506, 25.76891292507449, 25.175835887591035, 25.143958429495484, 24.819914350907, 25.16213847945133, 25.564896542954855, 25.16582939525445, 25.371526831140116, 21.53950224071741, 21.561513043940067, 20.997904300689697, 24.039511059721306, 24.44572453697522, 24.305559148391083, 19.514363393808395, 19.20489657173553, 19.091621110836655, 17.41464264442523, 17.687964883943394, 17.753324915965393, 27.93367395487924, 27.507413414617375, 27.81477809262772, 24.147096874192357, 24.103829126805067, 24.21797519735992, 23.83405529956022, 23.77243378261724, 24.076437899532408, 21.184153671065957, 21.041560808817536, 21.307751482973487, 30.709153110782296, 30.191545257965714, 30.887868660191685, 27.058222527305276, 27.824022598545213, 26.82735116283098, 25.719130886097744, 25.28867720564206, 26.04784370337923, 30.581961321334035, 31.018874031181127, 30.912663741658122, 30.684825370709092, 30.76770685861507, 31.07319865624109, 27.665900009373814, 27.843732478717953, 27.527914846936852, 29.03090068201223, 29.26282801727453, 29.291703338424355, 25.899249537537486, 25.399838070074708, 25.889320130149514, 28.51728921135266, 28.082894956072167, 28.870434577887252, 21.459321465343237, 21.338991869241, 21.335199281573296, 25.964495348433644, 25.978729645411164, 26.109311268354446, 30.16826594620943, 30.419108740985394, 29.99530954658985, 22.205058724929884, 21.86322185893853, 22.028068785866097, 29.646522914369896, 29.74641730015476, 29.877656036367014, 28.2329568353792, 27.754600596924618, 27.334460904200867, 26.230764006574944, 26.694210459788636, 26.61776318152745, 31.615446165204048, 31.993276618421078, 31.138979226350784, 24.51854170113802, 24.52500604838133, 24.808966194279492, 25.618941529343516, 25.601219792539865, 24.864248062173516, 35.121812288959816, 35.94638739650448, 35.60644595821698, 24.425390551487595, 24.150024729470402, 24.212934302786977, 18.710639898975685, 18.44890323777993, 18.068857093652085, 26.678530782461166, 27.72989859012887, 27.056693717837334, 23.396104115992785, 23.503847651183605, 23.365642584860325, 26.08575640742977, 26.016397481163338, 25.328040202458695, 24.81532230538626, 24.741223170732454, 24.79614720245202, 25.83652914563814, 26.17773740614453, 26.233993666867406, 25.86189858869571, 25.64141413072744, 25.536739545563847, 22.78022728239496, 22.81913423289855, 22.57716541488965, 21.91862454017003, 22.131790568431214, 22.373295453920335, 20.38738805614412, 20.40380370616913, 20.12739323824644, 30.171953799882118, 29.587582799295575, 29.860127458969743, 23.331512996306017, 22.82223979135354, 23.169194777806595, 27.22912004900475, 26.688605693479374, 27.073115201046065, 27.797923927505806, 28.166918588181332, 28.4512134467562, 23.03963914513588, 23.103453777730465, 23.14591508358717, 22.873722354881465, 22.274366065859795, 22.88764054235071, 25.280489491919667, 25.701746352637798, 25.545855722079665, 28.753126631801322, 28.56755143528183, 28.41584776093562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14132080249571935, "mean_inference_ms": 0.644660162760738, "mean_action_processing_ms": 0.09494551464039272, "mean_env_wait_ms": 0.795411353094432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 820800, "timesteps_this_iter": 0, "agent_timesteps_total": 2462400, "timers": {"sample_time_ms": 9417.396, "sample_throughput": 509.695, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1202.75, "learn_throughput": 3990.855, "update_time_ms": 1.795}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10136432647705079, "cur_lr": 0.0005, "total_loss": 5.561868369579315, "policy_loss": -0.0021397466744950133, "vf_loss": 5.716982960700989, "vf_explained_var": 0.00023220479488372803, "kl": 0.0041719502917288145, "entropy": 15.33979344367981, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820800, "num_agent_steps_sampled": 2462400, "num_steps_trained": 820800, "num_agent_steps_trained": 2462400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3665, "training_iteration": 171, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-09-22", "timestamp": 1706148562, "time_this_iter_s": 9.522742748260498, "time_total_s": 1600.92506814003, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004ECE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1600.92506814003, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 10.157142857142855, "ram_util_percent": 47.52857142857143}}
{"episode_reward_max": 117.63014496304092, "episode_reward_min": 47.03959561139342, "episode_reward_mean": 76.81425466357621, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 15.410799356798321}, "policy_reward_max": {"shared_policy": 39.320031587655336}, "policy_reward_mean": {"shared_policy": 25.604751554525397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.73153289966282, 81.64093497395515, 74.64081677794456, 72.23610659362747, 80.19041896797714, 82.91187233105302, 68.42153957299885, 58.034592688083634, 96.76459096907635, 47.03959561139342, 84.76382787711918, 59.669652268290506, 87.55591415497473, 68.56286258250475, 66.02965026348826, 108.52139383147002, 49.151969148311764, 66.39992961403914, 78.47217811178413, 58.28789796680212, 93.70083633670583, 99.27276703715323, 79.83355078101155, 84.47475603036581, 68.39956637448628, 82.54332036338744, 78.21707975119352, 74.36951680667697, 86.12657289532942, 96.40159080177543, 89.56302286311984, 61.471498003229485, 57.773193262517424, 67.51816823333502, 76.59548908472058, 75.12601125985381, 76.10225276934942, 64.09891958534718, 72.79079474508761, 57.81088107638058, 52.855932444334016, 83.25586546212433, 72.46890119835734, 71.68292698170987, 63.53346596285698, 91.7885670289397, 81.70959628868147, 77.05565179511903, 92.51349909417328, 92.52573088556525, 83.03754733502862, 87.58543203771112, 77.18840773776171, 85.47061874531208, 64.13351261615753, 78.05253626219925, 90.58268423378468, 66.09634936973451, 89.27059625089167, 83.32201833650468, 79.54273764789103, 94.74770200997591, 73.85251394379884, 76.0844093840569, 106.67464564368127, 72.78834958374497, 55.2284002304077, 81.46512309042737, 70.26559435203671, 77.4301940910518, 74.35269267857073, 78.24826021865007, 77.040052264987, 68.17652693018316, 66.42371056252158, 60.91858500055969, 89.61966405814744, 69.32294756546615, 80.99084094353019, 84.41605596244334, 69.28900800645351, 68.03572896309197, 76.52809156663713, 85.73652582801877, 57.68737327493727, 80.43745150417088, 117.63014496304092, 85.32196990400551, 106.7294186502695, 65.65498452633618, 50.14434759132563, 70.73672792594878, 78.64952570945022, 84.89326428622006, 61.03048878535627, 93.04799715103579, 102.411417433992, 59.470128534361706, 72.41384647041559, 66.64111378788948], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.96806568155685, 25.357997060442955, 25.405470157663018, 27.321790777146816, 27.027546599507332, 27.291597597301006, 24.828221634030342, 24.917742185294628, 24.894852958619595, 23.764924382170037, 24.123904549827174, 24.347277661630258, 26.429237859944493, 26.930800803626568, 26.830380304406077, 27.312294967472553, 27.869772078469396, 27.72980528511107, 22.75047781939307, 22.91542049559453, 22.755641258011252, 19.370112977301076, 19.29622172315915, 19.36825798762341, 32.146128239730984, 31.969068507353455, 32.64939422199191, 15.790088913093001, 15.410799356798321, 15.8387073415021, 28.29273833706975, 28.227309592068195, 28.24377994798124, 19.638991748293236, 19.887477849920586, 20.143182670076683, 29.32964226750967, 28.907769684990242, 29.318502202474818, 23.519636519253254, 22.531362414360046, 22.51186364889145, 21.8055085937182, 22.220196435848862, 22.0039452339212, 36.66111121167583, 35.89712160329023, 35.96316101650396, 16.28665306419134, 16.53381426865235, 16.331501815468073, 22.21161082573235, 22.219394392566755, 21.968924395740032, 26.306111151042074, 26.12892413015166, 26.037142830590398, 19.27970677614212, 19.494430255144835, 19.513760935515165, 31.33471842110157, 30.921398729085922, 31.44471918651834, 32.870203999181584, 33.1572978173693, 33.24526522060235, 26.777158091465623, 26.963364640871674, 26.093028048674256, 28.254659387593463, 28.084941448022917, 28.13515519474943, 22.843771352122218, 22.564830015103013, 22.990965007261053, 27.81661930369833, 27.64969967181483, 27.077001387874276, 26.025947518646717, 26.25713288784027, 25.933999344706535, 24.63350497682889, 24.62574318548043, 25.11026864436765, 28.37411698202291, 28.697789984444768, 29.054665928861738, 32.15274523446956, 32.10139702508846, 32.147448542217404, 29.80781039595604, 29.759062737226486, 29.996149729937315, 20.291476932664708, 20.452814561625317, 20.72720650893946, 19.038969735304505, 19.19032962123552, 19.5438939059774, 22.593104675412178, 22.63447353988886, 22.29059001803398, 25.65074027205506, 25.76891292507449, 25.175835887591035, 25.143958429495484, 24.819914350907, 25.16213847945133, 25.564896542954855, 25.16582939525445, 25.371526831140116, 21.53950224071741, 21.561513043940067, 20.997904300689697, 24.039511059721306, 24.44572453697522, 24.305559148391083, 19.514363393808395, 19.20489657173553, 19.091621110836655, 17.41464264442523, 17.687964883943394, 17.753324915965393, 27.93367395487924, 27.507413414617375, 27.81477809262772, 24.147096874192357, 24.103829126805067, 24.21797519735992, 23.83405529956022, 23.77243378261724, 24.076437899532408, 21.184153671065957, 21.041560808817536, 21.307751482973487, 30.709153110782296, 30.191545257965714, 30.887868660191685, 27.058222527305276, 27.824022598545213, 26.82735116283098, 25.719130886097744, 25.28867720564206, 26.04784370337923, 30.581961321334035, 31.018874031181127, 30.912663741658122, 30.684825370709092, 30.76770685861507, 31.07319865624109, 27.665900009373814, 27.843732478717953, 27.527914846936852, 29.03090068201223, 29.26282801727453, 29.291703338424355, 25.899249537537486, 25.399838070074708, 25.889320130149514, 28.51728921135266, 28.082894956072167, 28.870434577887252, 21.459321465343237, 21.338991869241, 21.335199281573296, 25.964495348433644, 25.978729645411164, 26.109311268354446, 30.16826594620943, 30.419108740985394, 29.99530954658985, 22.205058724929884, 21.86322185893853, 22.028068785866097, 29.646522914369896, 29.74641730015476, 29.877656036367014, 28.2329568353792, 27.754600596924618, 27.334460904200867, 26.230764006574944, 26.694210459788636, 26.61776318152745, 31.615446165204048, 31.993276618421078, 31.138979226350784, 24.51854170113802, 24.52500604838133, 24.808966194279492, 25.618941529343516, 25.601219792539865, 24.864248062173516, 35.121812288959816, 35.94638739650448, 35.60644595821698, 24.425390551487595, 24.150024729470402, 24.212934302786977, 18.710639898975685, 18.44890323777993, 18.068857093652085, 26.678530782461166, 27.72989859012887, 27.056693717837334, 23.396104115992785, 23.503847651183605, 23.365642584860325, 26.08575640742977, 26.016397481163338, 25.328040202458695, 24.81532230538626, 24.741223170732454, 24.79614720245202, 25.83652914563814, 26.17773740614453, 26.233993666867406, 25.86189858869571, 25.64141413072744, 25.536739545563847, 22.78022728239496, 22.81913423289855, 22.57716541488965, 21.91862454017003, 22.131790568431214, 22.373295453920335, 20.38738805614412, 20.40380370616913, 20.12739323824644, 30.171953799882118, 29.587582799295575, 29.860127458969743, 23.331512996306017, 22.82223979135354, 23.169194777806595, 27.22912004900475, 26.688605693479374, 27.073115201046065, 27.797923927505806, 28.166918588181332, 28.4512134467562, 23.03963914513588, 23.103453777730465, 23.14591508358717, 22.873722354881465, 22.274366065859795, 22.88764054235071, 25.280489491919667, 25.701746352637798, 25.545855722079665, 28.753126631801322, 28.56755143528183, 28.41584776093562, 19.10067981481552, 19.334238911047578, 19.252454549074173, 26.718836841483906, 26.794383754332856, 26.92423090835412, 39.06870542714992, 39.320031587655336, 39.24140794823566, 28.87484512974818, 28.20091414948304, 28.246210624774292, 35.64772520711024, 35.542760868867234, 35.53893257429202, 21.90619760503371, 21.828539942701653, 21.920246978600815, 16.637183730800942, 16.8994200186183, 16.607743841906384, 23.339115490516022, 24.009575389636055, 23.388037045796708, 25.994074727098138, 26.365779946247727, 26.28967103610435, 28.464410354693726, 28.059005861481026, 28.369848070045308, 20.299961817761258, 20.566037529458598, 20.164489438136414, 31.06459581075856, 30.89477604503432, 31.088625295242906, 33.96950292835632, 34.41803612249592, 34.02387838313976, 19.9940921322753, 19.734577169020966, 19.74145923306544, 24.082677647471428, 24.34558431059122, 23.985584512352943, 22.415600702166557, 21.8162709325552, 22.409242153167725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14131068135129204, "mean_inference_ms": 0.6447345722973423, "mean_action_processing_ms": 0.09496315485782836, "mean_env_wait_ms": 0.7953449558927344, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 825600, "timesteps_this_iter": 0, "agent_timesteps_total": 2476800, "timers": {"sample_time_ms": 9374.755, "sample_throughput": 512.013, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1197.744, "learn_throughput": 4007.535, "update_time_ms": 1.894}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 8.174808025360107, "policy_loss": -0.0015531084926139194, "vf_loss": 8.331175088882446, "vf_explained_var": 0.002436809241771698, "kl": 0.005359826638835243, "entropy": 15.508597493171692, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 825600, "num_agent_steps_sampled": 2476800, "num_steps_trained": 825600, "num_agent_steps_trained": 2476800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3681, "training_iteration": 172, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-09-31", "timestamp": 1706148571, "time_this_iter_s": 9.202843427658081, "time_total_s": 1610.127911567688, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1610.127911567688, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 7.276923076923077, "ram_util_percent": 47.51538461538462}}
{"episode_reward_max": 117.63014496304092, "episode_reward_min": 46.004889790376154, "episode_reward_mean": 75.81185079760914, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.351054171721131}, "policy_reward_max": {"shared_policy": 39.320031587655336}, "policy_reward_mean": {"shared_policy": 25.270616932536377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.151969148311764, 66.39992961403914, 78.47217811178413, 58.28789796680212, 93.70083633670583, 99.27276703715323, 79.83355078101155, 84.47475603036581, 68.39956637448628, 82.54332036338744, 78.21707975119352, 74.36951680667697, 86.12657289532942, 96.40159080177543, 89.56302286311984, 61.471498003229485, 57.773193262517424, 67.51816823333502, 76.59548908472058, 75.12601125985381, 76.10225276934942, 64.09891958534718, 72.79079474508761, 57.81088107638058, 52.855932444334016, 83.25586546212433, 72.46890119835734, 71.68292698170987, 63.53346596285698, 91.7885670289397, 81.70959628868147, 77.05565179511903, 92.51349909417328, 92.52573088556525, 83.03754733502862, 87.58543203771112, 77.18840773776171, 85.47061874531208, 64.13351261615753, 78.05253626219925, 90.58268423378468, 66.09634936973451, 89.27059625089167, 83.32201833650468, 79.54273764789103, 94.74770200997591, 73.85251394379884, 76.0844093840569, 106.67464564368127, 72.78834958374497, 55.2284002304077, 81.46512309042737, 70.26559435203671, 77.4301940910518, 74.35269267857073, 78.24826021865007, 77.040052264987, 68.17652693018316, 66.42371056252158, 60.91858500055969, 89.61966405814744, 69.32294756546615, 80.99084094353019, 84.41605596244334, 69.28900800645351, 68.03572896309197, 76.52809156663713, 85.73652582801877, 57.68737327493727, 80.43745150417088, 117.63014496304092, 85.32196990400551, 106.7294186502695, 65.65498452633618, 50.14434759132563, 70.73672792594878, 78.64952570945022, 84.89326428622006, 61.03048878535627, 93.04799715103579, 102.411417433992, 59.470128534361706, 72.41384647041559, 66.64111378788948, 46.004889790376154, 88.22707825235554, 81.73915707133709, 60.063341714441776, 70.97519924119112, 48.815510727465124, 50.93390776589513, 67.54340990073979, 65.63093203119931, 79.1215677987784, 78.90532784163952, 84.58500223606823, 50.35139829665421, 87.210572341457, 76.63381169410421, 75.73380906321105], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.28665306419134, 16.53381426865235, 16.331501815468073, 22.21161082573235, 22.219394392566755, 21.968924395740032, 26.306111151042074, 26.12892413015166, 26.037142830590398, 19.27970677614212, 19.494430255144835, 19.513760935515165, 31.33471842110157, 30.921398729085922, 31.44471918651834, 32.870203999181584, 33.1572978173693, 33.24526522060235, 26.777158091465623, 26.963364640871674, 26.093028048674256, 28.254659387593463, 28.084941448022917, 28.13515519474943, 22.843771352122218, 22.564830015103013, 22.990965007261053, 27.81661930369833, 27.64969967181483, 27.077001387874276, 26.025947518646717, 26.25713288784027, 25.933999344706535, 24.63350497682889, 24.62574318548043, 25.11026864436765, 28.37411698202291, 28.697789984444768, 29.054665928861738, 32.15274523446956, 32.10139702508846, 32.147448542217404, 29.80781039595604, 29.759062737226486, 29.996149729937315, 20.291476932664708, 20.452814561625317, 20.72720650893946, 19.038969735304505, 19.19032962123552, 19.5438939059774, 22.593104675412178, 22.63447353988886, 22.29059001803398, 25.65074027205506, 25.76891292507449, 25.175835887591035, 25.143958429495484, 24.819914350907, 25.16213847945133, 25.564896542954855, 25.16582939525445, 25.371526831140116, 21.53950224071741, 21.561513043940067, 20.997904300689697, 24.039511059721306, 24.44572453697522, 24.305559148391083, 19.514363393808395, 19.20489657173553, 19.091621110836655, 17.41464264442523, 17.687964883943394, 17.753324915965393, 27.93367395487924, 27.507413414617375, 27.81477809262772, 24.147096874192357, 24.103829126805067, 24.21797519735992, 23.83405529956022, 23.77243378261724, 24.076437899532408, 21.184153671065957, 21.041560808817536, 21.307751482973487, 30.709153110782296, 30.191545257965714, 30.887868660191685, 27.058222527305276, 27.824022598545213, 26.82735116283098, 25.719130886097744, 25.28867720564206, 26.04784370337923, 30.581961321334035, 31.018874031181127, 30.912663741658122, 30.684825370709092, 30.76770685861507, 31.07319865624109, 27.665900009373814, 27.843732478717953, 27.527914846936852, 29.03090068201223, 29.26282801727453, 29.291703338424355, 25.899249537537486, 25.399838070074708, 25.889320130149514, 28.51728921135266, 28.082894956072167, 28.870434577887252, 21.459321465343237, 21.338991869241, 21.335199281573296, 25.964495348433644, 25.978729645411164, 26.109311268354446, 30.16826594620943, 30.419108740985394, 29.99530954658985, 22.205058724929884, 21.86322185893853, 22.028068785866097, 29.646522914369896, 29.74641730015476, 29.877656036367014, 28.2329568353792, 27.754600596924618, 27.334460904200867, 26.230764006574944, 26.694210459788636, 26.61776318152745, 31.615446165204048, 31.993276618421078, 31.138979226350784, 24.51854170113802, 24.52500604838133, 24.808966194279492, 25.618941529343516, 25.601219792539865, 24.864248062173516, 35.121812288959816, 35.94638739650448, 35.60644595821698, 24.425390551487595, 24.150024729470402, 24.212934302786977, 18.710639898975685, 18.44890323777993, 18.068857093652085, 26.678530782461166, 27.72989859012887, 27.056693717837334, 23.396104115992785, 23.503847651183605, 23.365642584860325, 26.08575640742977, 26.016397481163338, 25.328040202458695, 24.81532230538626, 24.741223170732454, 24.79614720245202, 25.83652914563814, 26.17773740614453, 26.233993666867406, 25.86189858869571, 25.64141413072744, 25.536739545563847, 22.78022728239496, 22.81913423289855, 22.57716541488965, 21.91862454017003, 22.131790568431214, 22.373295453920335, 20.38738805614412, 20.40380370616913, 20.12739323824644, 30.171953799882118, 29.587582799295575, 29.860127458969743, 23.331512996306017, 22.82223979135354, 23.169194777806595, 27.22912004900475, 26.688605693479374, 27.073115201046065, 27.797923927505806, 28.166918588181332, 28.4512134467562, 23.03963914513588, 23.103453777730465, 23.14591508358717, 22.873722354881465, 22.274366065859795, 22.88764054235071, 25.280489491919667, 25.701746352637798, 25.545855722079665, 28.753126631801322, 28.56755143528183, 28.41584776093562, 19.10067981481552, 19.334238911047578, 19.252454549074173, 26.718836841483906, 26.794383754332856, 26.92423090835412, 39.06870542714992, 39.320031587655336, 39.24140794823566, 28.87484512974818, 28.20091414948304, 28.246210624774292, 35.64772520711024, 35.542760868867234, 35.53893257429202, 21.90619760503371, 21.828539942701653, 21.920246978600815, 16.637183730800942, 16.8994200186183, 16.607743841906384, 23.339115490516022, 24.009575389636055, 23.388037045796708, 25.994074727098138, 26.365779946247727, 26.28967103610435, 28.464410354693726, 28.059005861481026, 28.369848070045308, 20.299961817761258, 20.566037529458598, 20.164489438136414, 31.06459581075856, 30.89477604503432, 31.088625295242906, 33.96950292835632, 34.41803612249592, 34.02387838313976, 19.9940921322753, 19.734577169020966, 19.74145923306544, 24.082677647471428, 24.34558431059122, 23.985584512352943, 22.415600702166557, 21.8162709325552, 22.409242153167725, 15.749795253078133, 15.90404036557689, 14.351054171721131, 29.70700032139817, 29.884287870993518, 28.635790059963853, 27.150477920969323, 27.367580565934375, 27.221098584433392, 19.55947758257389, 20.20331361889839, 20.300550512969494, 23.53075751165548, 23.925943477700145, 23.518498251835496, 16.389027203122765, 16.418938266734273, 16.007545257608086, 16.733305245637894, 17.16913427785039, 17.031468242406845, 22.53766972757876, 22.553968477994204, 22.451771695166826, 21.92548821369806, 21.974153236175567, 21.73129058132568, 26.551253306989864, 26.225269739826516, 26.34504475196202, 26.215277537703514, 26.456178948283195, 26.23387135565281, 28.419650067885712, 27.988857125242546, 28.176495042939976, 16.617149775226906, 16.966752623518303, 16.767495897909, 29.235351671775177, 29.363470225905374, 28.611750443776444, 25.080568497379616, 25.816212937080607, 25.737030259643987, 25.48928389387825, 24.937702054778725, 25.306823114554078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14130561776059403, "mean_inference_ms": 0.64484126719416, "mean_action_processing_ms": 0.09498148646998562, "mean_env_wait_ms": 0.7952870024443783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 830400, "timesteps_this_iter": 0, "agent_timesteps_total": 2491200, "timers": {"sample_time_ms": 9372.431, "sample_throughput": 512.14, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1200.937, "learn_throughput": 3996.88, "update_time_ms": 1.794}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.224840879440308, "policy_loss": -0.0014481769881806716, "vf_loss": 6.379545569419861, "vf_explained_var": 0.0037995055317878723, "kl": 0.005785744521072092, "entropy": 15.354989409446716, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 830400, "num_agent_steps_sampled": 2491200, "num_steps_trained": 830400, "num_agent_steps_trained": 2491200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3697, "training_iteration": 173, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-09-41", "timestamp": 1706148581, "time_this_iter_s": 9.602722406387329, "time_total_s": 1619.7306339740753, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004ECC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1619.7306339740753, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 47.57692307692309}}
{"episode_reward_max": 117.63014496304092, "episode_reward_min": 46.004889790376154, "episode_reward_mean": 75.1207754857379, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.351054171721131}, "policy_reward_max": {"shared_policy": 39.320031587655336}, "policy_reward_mean": {"shared_policy": 25.04025849524596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.773193262517424, 67.51816823333502, 76.59548908472058, 75.12601125985381, 76.10225276934942, 64.09891958534718, 72.79079474508761, 57.81088107638058, 52.855932444334016, 83.25586546212433, 72.46890119835734, 71.68292698170987, 63.53346596285698, 91.7885670289397, 81.70959628868147, 77.05565179511903, 92.51349909417328, 92.52573088556525, 83.03754733502862, 87.58543203771112, 77.18840773776171, 85.47061874531208, 64.13351261615753, 78.05253626219925, 90.58268423378468, 66.09634936973451, 89.27059625089167, 83.32201833650468, 79.54273764789103, 94.74770200997591, 73.85251394379884, 76.0844093840569, 106.67464564368127, 72.78834958374497, 55.2284002304077, 81.46512309042737, 70.26559435203671, 77.4301940910518, 74.35269267857073, 78.24826021865007, 77.040052264987, 68.17652693018316, 66.42371056252158, 60.91858500055969, 89.61966405814744, 69.32294756546615, 80.99084094353019, 84.41605596244334, 69.28900800645351, 68.03572896309197, 76.52809156663713, 85.73652582801877, 57.68737327493727, 80.43745150417088, 117.63014496304092, 85.32196990400551, 106.7294186502695, 65.65498452633618, 50.14434759132563, 70.73672792594878, 78.64952570945022, 84.89326428622006, 61.03048878535627, 93.04799715103579, 102.411417433992, 59.470128534361706, 72.41384647041559, 66.64111378788948, 46.004889790376154, 88.22707825235554, 81.73915707133709, 60.063341714441776, 70.97519924119112, 48.815510727465124, 50.93390776589513, 67.54340990073979, 65.63093203119931, 79.1215677987784, 78.90532784163952, 84.58500223606823, 50.35139829665421, 87.210572341457, 76.63381169410421, 75.73380906321105, 73.31767740659413, 72.79780611023304, 75.41048610396682, 67.04650009796022, 88.77661366760728, 63.015091269277036, 66.29544519633055, 91.13641118258238, 54.86214703973383, 56.48619129508732, 68.33111347258088, 82.20939011499283, 62.699515137355775, 116.33483473956582, 75.34189944341776, 63.51739942096174], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.038969735304505, 19.19032962123552, 19.5438939059774, 22.593104675412178, 22.63447353988886, 22.29059001803398, 25.65074027205506, 25.76891292507449, 25.175835887591035, 25.143958429495484, 24.819914350907, 25.16213847945133, 25.564896542954855, 25.16582939525445, 25.371526831140116, 21.53950224071741, 21.561513043940067, 20.997904300689697, 24.039511059721306, 24.44572453697522, 24.305559148391083, 19.514363393808395, 19.20489657173553, 19.091621110836655, 17.41464264442523, 17.687964883943394, 17.753324915965393, 27.93367395487924, 27.507413414617375, 27.81477809262772, 24.147096874192357, 24.103829126805067, 24.21797519735992, 23.83405529956022, 23.77243378261724, 24.076437899532408, 21.184153671065957, 21.041560808817536, 21.307751482973487, 30.709153110782296, 30.191545257965714, 30.887868660191685, 27.058222527305276, 27.824022598545213, 26.82735116283098, 25.719130886097744, 25.28867720564206, 26.04784370337923, 30.581961321334035, 31.018874031181127, 30.912663741658122, 30.684825370709092, 30.76770685861507, 31.07319865624109, 27.665900009373814, 27.843732478717953, 27.527914846936852, 29.03090068201223, 29.26282801727453, 29.291703338424355, 25.899249537537486, 25.399838070074708, 25.889320130149514, 28.51728921135266, 28.082894956072167, 28.870434577887252, 21.459321465343237, 21.338991869241, 21.335199281573296, 25.964495348433644, 25.978729645411164, 26.109311268354446, 30.16826594620943, 30.419108740985394, 29.99530954658985, 22.205058724929884, 21.86322185893853, 22.028068785866097, 29.646522914369896, 29.74641730015476, 29.877656036367014, 28.2329568353792, 27.754600596924618, 27.334460904200867, 26.230764006574944, 26.694210459788636, 26.61776318152745, 31.615446165204048, 31.993276618421078, 31.138979226350784, 24.51854170113802, 24.52500604838133, 24.808966194279492, 25.618941529343516, 25.601219792539865, 24.864248062173516, 35.121812288959816, 35.94638739650448, 35.60644595821698, 24.425390551487595, 24.150024729470402, 24.212934302786977, 18.710639898975685, 18.44890323777993, 18.068857093652085, 26.678530782461166, 27.72989859012887, 27.056693717837334, 23.396104115992785, 23.503847651183605, 23.365642584860325, 26.08575640742977, 26.016397481163338, 25.328040202458695, 24.81532230538626, 24.741223170732454, 24.79614720245202, 25.83652914563814, 26.17773740614453, 26.233993666867406, 25.86189858869571, 25.64141413072744, 25.536739545563847, 22.78022728239496, 22.81913423289855, 22.57716541488965, 21.91862454017003, 22.131790568431214, 22.373295453920335, 20.38738805614412, 20.40380370616913, 20.12739323824644, 30.171953799882118, 29.587582799295575, 29.860127458969743, 23.331512996306017, 22.82223979135354, 23.169194777806595, 27.22912004900475, 26.688605693479374, 27.073115201046065, 27.797923927505806, 28.166918588181332, 28.4512134467562, 23.03963914513588, 23.103453777730465, 23.14591508358717, 22.873722354881465, 22.274366065859795, 22.88764054235071, 25.280489491919667, 25.701746352637798, 25.545855722079665, 28.753126631801322, 28.56755143528183, 28.41584776093562, 19.10067981481552, 19.334238911047578, 19.252454549074173, 26.718836841483906, 26.794383754332856, 26.92423090835412, 39.06870542714992, 39.320031587655336, 39.24140794823566, 28.87484512974818, 28.20091414948304, 28.246210624774292, 35.64772520711024, 35.542760868867234, 35.53893257429202, 21.90619760503371, 21.828539942701653, 21.920246978600815, 16.637183730800942, 16.8994200186183, 16.607743841906384, 23.339115490516022, 24.009575389636055, 23.388037045796708, 25.994074727098138, 26.365779946247727, 26.28967103610435, 28.464410354693726, 28.059005861481026, 28.369848070045308, 20.299961817761258, 20.566037529458598, 20.164489438136414, 31.06459581075856, 30.89477604503432, 31.088625295242906, 33.96950292835632, 34.41803612249592, 34.02387838313976, 19.9940921322753, 19.734577169020966, 19.74145923306544, 24.082677647471428, 24.34558431059122, 23.985584512352943, 22.415600702166557, 21.8162709325552, 22.409242153167725, 15.749795253078133, 15.90404036557689, 14.351054171721131, 29.70700032139817, 29.884287870993518, 28.635790059963853, 27.150477920969323, 27.367580565934375, 27.221098584433392, 19.55947758257389, 20.20331361889839, 20.300550512969494, 23.53075751165548, 23.925943477700145, 23.518498251835496, 16.389027203122765, 16.418938266734273, 16.007545257608086, 16.733305245637894, 17.16913427785039, 17.031468242406845, 22.53766972757876, 22.553968477994204, 22.451771695166826, 21.92548821369806, 21.974153236175567, 21.73129058132568, 26.551253306989864, 26.225269739826516, 26.34504475196202, 26.215277537703514, 26.456178948283195, 26.23387135565281, 28.419650067885712, 27.988857125242546, 28.176495042939976, 16.617149775226906, 16.966752623518303, 16.767495897909, 29.235351671775177, 29.363470225905374, 28.611750443776444, 25.080568497379616, 25.816212937080607, 25.737030259643987, 25.48928389387825, 24.937702054778725, 25.306823114554078, 24.355200833330542, 24.581911579395324, 24.380564993868262, 24.247778224448354, 24.091748426357896, 24.45827945942679, 25.310051347439483, 25.19832906251152, 24.902105694015816, 22.36711849396427, 22.365784784158066, 22.313596819837883, 29.63121344583729, 29.592931859816105, 29.552468361953885, 20.689762502908707, 20.968857526779175, 21.356471239589155, 22.159624822437763, 22.087902776896954, 22.04791759699583, 30.36536506563425, 30.332496866583824, 30.438549250364304, 18.551840323023498, 18.317392218858004, 17.992914497852325, 18.55889979501565, 19.18193518867095, 18.745356311400727, 22.790873403350503, 22.688528055946023, 22.851712013284356, 27.130600000421197, 27.63123421991864, 27.447555894652993, 20.32589480280876, 21.470510836225003, 20.90310949832201, 38.7654658059279, 38.89322828749815, 38.67614064613977, 25.042143921057374, 25.235157227764518, 25.064598294595868, 21.035188920795918, 21.24086756259203, 21.24134293757379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1413081083545838, "mean_inference_ms": 0.6449305778709803, "mean_action_processing_ms": 0.09499318033096188, "mean_env_wait_ms": 0.7952261975825714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 835200, "timesteps_this_iter": 0, "agent_timesteps_total": 2505600, "timers": {"sample_time_ms": 9378.79, "sample_throughput": 511.793, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1191.43, "learn_throughput": 4028.771, "update_time_ms": 1.694}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.563625872135162, "policy_loss": -0.0019540527082830828, "vf_loss": 6.721291124820709, "vf_explained_var": 0.008882962167263031, "kl": 0.005575175018992775, "entropy": 15.599360227584839, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 835200, "num_agent_steps_sampled": 2505600, "num_steps_trained": 835200, "num_agent_steps_trained": 2505600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3713, "training_iteration": 174, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-09-50", "timestamp": 1706148590, "time_this_iter_s": 9.290292263031006, "time_total_s": 1629.0209262371063, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100050C790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1629.0209262371063, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 6.753846153846154, "ram_util_percent": 47.60769230769232}}
{"episode_reward_max": 117.63014496304092, "episode_reward_min": 46.004889790376154, "episode_reward_mean": 76.17342282083759, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.351054171721131}, "policy_reward_max": {"shared_policy": 39.320031587655336}, "policy_reward_mean": {"shared_policy": 25.39114094027919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.51349909417328, 92.52573088556525, 83.03754733502862, 87.58543203771112, 77.18840773776171, 85.47061874531208, 64.13351261615753, 78.05253626219925, 90.58268423378468, 66.09634936973451, 89.27059625089167, 83.32201833650468, 79.54273764789103, 94.74770200997591, 73.85251394379884, 76.0844093840569, 106.67464564368127, 72.78834958374497, 55.2284002304077, 81.46512309042737, 70.26559435203671, 77.4301940910518, 74.35269267857073, 78.24826021865007, 77.040052264987, 68.17652693018316, 66.42371056252158, 60.91858500055969, 89.61966405814744, 69.32294756546615, 80.99084094353019, 84.41605596244334, 69.28900800645351, 68.03572896309197, 76.52809156663713, 85.73652582801877, 57.68737327493727, 80.43745150417088, 117.63014496304092, 85.32196990400551, 106.7294186502695, 65.65498452633618, 50.14434759132563, 70.73672792594878, 78.64952570945022, 84.89326428622006, 61.03048878535627, 93.04799715103579, 102.411417433992, 59.470128534361706, 72.41384647041559, 66.64111378788948, 46.004889790376154, 88.22707825235554, 81.73915707133709, 60.063341714441776, 70.97519924119112, 48.815510727465124, 50.93390776589513, 67.54340990073979, 65.63093203119931, 79.1215677987784, 78.90532784163952, 84.58500223606823, 50.35139829665421, 87.210572341457, 76.63381169410421, 75.73380906321105, 73.31767740659413, 72.79780611023304, 75.41048610396682, 67.04650009796022, 88.77661366760728, 63.015091269277036, 66.29544519633055, 91.13641118258238, 54.86214703973383, 56.48619129508732, 68.33111347258088, 82.20939011499283, 62.699515137355775, 116.33483473956582, 75.34189944341776, 63.51739942096174, 63.58278296887872, 92.13370791450141, 89.14053040742873, 74.64494650810956, 49.22628022730348, 80.77245162520558, 89.38841099292037, 80.09439983218907, 76.56568428687751, 63.64886932261288, 72.7798249013722, 91.8838625345379, 93.99972203793004, 85.74529353878458, 68.51056731492281, 75.31401627510783], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.581961321334035, 31.018874031181127, 30.912663741658122, 30.684825370709092, 30.76770685861507, 31.07319865624109, 27.665900009373814, 27.843732478717953, 27.527914846936852, 29.03090068201223, 29.26282801727453, 29.291703338424355, 25.899249537537486, 25.399838070074708, 25.889320130149514, 28.51728921135266, 28.082894956072167, 28.870434577887252, 21.459321465343237, 21.338991869241, 21.335199281573296, 25.964495348433644, 25.978729645411164, 26.109311268354446, 30.16826594620943, 30.419108740985394, 29.99530954658985, 22.205058724929884, 21.86322185893853, 22.028068785866097, 29.646522914369896, 29.74641730015476, 29.877656036367014, 28.2329568353792, 27.754600596924618, 27.334460904200867, 26.230764006574944, 26.694210459788636, 26.61776318152745, 31.615446165204048, 31.993276618421078, 31.138979226350784, 24.51854170113802, 24.52500604838133, 24.808966194279492, 25.618941529343516, 25.601219792539865, 24.864248062173516, 35.121812288959816, 35.94638739650448, 35.60644595821698, 24.425390551487595, 24.150024729470402, 24.212934302786977, 18.710639898975685, 18.44890323777993, 18.068857093652085, 26.678530782461166, 27.72989859012887, 27.056693717837334, 23.396104115992785, 23.503847651183605, 23.365642584860325, 26.08575640742977, 26.016397481163338, 25.328040202458695, 24.81532230538626, 24.741223170732454, 24.79614720245202, 25.83652914563814, 26.17773740614453, 26.233993666867406, 25.86189858869571, 25.64141413072744, 25.536739545563847, 22.78022728239496, 22.81913423289855, 22.57716541488965, 21.91862454017003, 22.131790568431214, 22.373295453920335, 20.38738805614412, 20.40380370616913, 20.12739323824644, 30.171953799882118, 29.587582799295575, 29.860127458969743, 23.331512996306017, 22.82223979135354, 23.169194777806595, 27.22912004900475, 26.688605693479374, 27.073115201046065, 27.797923927505806, 28.166918588181332, 28.4512134467562, 23.03963914513588, 23.103453777730465, 23.14591508358717, 22.873722354881465, 22.274366065859795, 22.88764054235071, 25.280489491919667, 25.701746352637798, 25.545855722079665, 28.753126631801322, 28.56755143528183, 28.41584776093562, 19.10067981481552, 19.334238911047578, 19.252454549074173, 26.718836841483906, 26.794383754332856, 26.92423090835412, 39.06870542714992, 39.320031587655336, 39.24140794823566, 28.87484512974818, 28.20091414948304, 28.246210624774292, 35.64772520711024, 35.542760868867234, 35.53893257429202, 21.90619760503371, 21.828539942701653, 21.920246978600815, 16.637183730800942, 16.8994200186183, 16.607743841906384, 23.339115490516022, 24.009575389636055, 23.388037045796708, 25.994074727098138, 26.365779946247727, 26.28967103610435, 28.464410354693726, 28.059005861481026, 28.369848070045308, 20.299961817761258, 20.566037529458598, 20.164489438136414, 31.06459581075856, 30.89477604503432, 31.088625295242906, 33.96950292835632, 34.41803612249592, 34.02387838313976, 19.9940921322753, 19.734577169020966, 19.74145923306544, 24.082677647471428, 24.34558431059122, 23.985584512352943, 22.415600702166557, 21.8162709325552, 22.409242153167725, 15.749795253078133, 15.90404036557689, 14.351054171721131, 29.70700032139817, 29.884287870993518, 28.635790059963853, 27.150477920969323, 27.367580565934375, 27.221098584433392, 19.55947758257389, 20.20331361889839, 20.300550512969494, 23.53075751165548, 23.925943477700145, 23.518498251835496, 16.389027203122765, 16.418938266734273, 16.007545257608086, 16.733305245637894, 17.16913427785039, 17.031468242406845, 22.53766972757876, 22.553968477994204, 22.451771695166826, 21.92548821369806, 21.974153236175567, 21.73129058132568, 26.551253306989864, 26.225269739826516, 26.34504475196202, 26.215277537703514, 26.456178948283195, 26.23387135565281, 28.419650067885712, 27.988857125242546, 28.176495042939976, 16.617149775226906, 16.966752623518303, 16.767495897909, 29.235351671775177, 29.363470225905374, 28.611750443776444, 25.080568497379616, 25.816212937080607, 25.737030259643987, 25.48928389387825, 24.937702054778725, 25.306823114554078, 24.355200833330542, 24.581911579395324, 24.380564993868262, 24.247778224448354, 24.091748426357896, 24.45827945942679, 25.310051347439483, 25.19832906251152, 24.902105694015816, 22.36711849396427, 22.365784784158066, 22.313596819837883, 29.63121344583729, 29.592931859816105, 29.552468361953885, 20.689762502908707, 20.968857526779175, 21.356471239589155, 22.159624822437763, 22.087902776896954, 22.04791759699583, 30.36536506563425, 30.332496866583824, 30.438549250364304, 18.551840323023498, 18.317392218858004, 17.992914497852325, 18.55889979501565, 19.18193518867095, 18.745356311400727, 22.790873403350503, 22.688528055946023, 22.851712013284356, 27.130600000421197, 27.63123421991864, 27.447555894652993, 20.32589480280876, 21.470510836225003, 20.90310949832201, 38.7654658059279, 38.89322828749815, 38.67614064613977, 25.042143921057374, 25.235157227764518, 25.064598294595868, 21.035188920795918, 21.24086756259203, 21.24134293757379, 21.05542706946531, 21.272769353042037, 21.25458654637137, 30.487328608830765, 30.819910177340105, 30.826469128330544, 29.52813774098952, 29.66853368779023, 29.943858978648976, 25.093902820100382, 24.946098388483122, 24.60494529952605, 16.32733395944038, 16.358090961972863, 16.540855305890233, 26.835651606321335, 26.864513460546732, 27.07228655833751, 30.16732999558249, 30.140888481090457, 29.080192516247422, 26.766457575683788, 26.769115886961416, 26.558826369543866, 25.481596499681473, 25.818901447579265, 25.265186339616776, 20.967762529850006, 21.20657379180193, 21.474533000960946, 24.137959107756615, 24.30682882666588, 24.3350369669497, 30.778015117471412, 30.552041569103793, 30.553805847962693, 31.42420021397993, 31.173851739615202, 31.40167008433491, 28.02812548975149, 28.66216222445169, 29.0550058245814, 22.554880887269974, 22.877938359975815, 23.07774806767702, 25.30329060057798, 24.74468138317266, 25.26604429135719]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14132513963303187, "mean_inference_ms": 0.6450603468406907, "mean_action_processing_ms": 0.09500464250724684, "mean_env_wait_ms": 0.795184941335992, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 2520000, "timers": {"sample_time_ms": 9368.701, "sample_throughput": 512.344, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1191.224, "learn_throughput": 4029.468, "update_time_ms": 1.594}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.5942710638046265, "policy_loss": -0.0023686607788678815, "vf_loss": 6.751387000083923, "vf_explained_var": 0.006275571882724762, "kl": 0.008540681418043053, "entropy": 15.518014192581177, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 2520000, "num_steps_trained": 840000, "num_agent_steps_trained": 2520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3729, "training_iteration": 175, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-09-59", "timestamp": 1706148599, "time_this_iter_s": 9.603435039520264, "time_total_s": 1638.6243612766266, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BFDB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1638.6243612766266, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 6.3571428571428585, "ram_util_percent": 47.61428571428572}}
{"episode_reward_max": 117.63014496304092, "episode_reward_min": 46.004889790376154, "episode_reward_mean": 74.2695697110868, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.351054171721131}, "policy_reward_max": {"shared_policy": 39.320031587655336}, "policy_reward_mean": {"shared_policy": 24.75652323702893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.67464564368127, 72.78834958374497, 55.2284002304077, 81.46512309042737, 70.26559435203671, 77.4301940910518, 74.35269267857073, 78.24826021865007, 77.040052264987, 68.17652693018316, 66.42371056252158, 60.91858500055969, 89.61966405814744, 69.32294756546615, 80.99084094353019, 84.41605596244334, 69.28900800645351, 68.03572896309197, 76.52809156663713, 85.73652582801877, 57.68737327493727, 80.43745150417088, 117.63014496304092, 85.32196990400551, 106.7294186502695, 65.65498452633618, 50.14434759132563, 70.73672792594878, 78.64952570945022, 84.89326428622006, 61.03048878535627, 93.04799715103579, 102.411417433992, 59.470128534361706, 72.41384647041559, 66.64111378788948, 46.004889790376154, 88.22707825235554, 81.73915707133709, 60.063341714441776, 70.97519924119112, 48.815510727465124, 50.93390776589513, 67.54340990073979, 65.63093203119931, 79.1215677987784, 78.90532784163952, 84.58500223606823, 50.35139829665421, 87.210572341457, 76.63381169410421, 75.73380906321105, 73.31767740659413, 72.79780611023304, 75.41048610396682, 67.04650009796022, 88.77661366760728, 63.015091269277036, 66.29544519633055, 91.13641118258238, 54.86214703973383, 56.48619129508732, 68.33111347258088, 82.20939011499283, 62.699515137355775, 116.33483473956582, 75.34189944341776, 63.51739942096174, 63.58278296887872, 92.13370791450141, 89.14053040742873, 74.64494650810956, 49.22628022730348, 80.77245162520558, 89.38841099292037, 80.09439983218907, 76.56568428687751, 63.64886932261288, 72.7798249013722, 91.8838625345379, 93.99972203793004, 85.74529353878458, 68.51056731492281, 75.31401627510783, 75.35707424581048, 78.84579728543758, 65.23203651857327, 62.669822651892886, 79.83370068110523, 67.569099039305, 74.11144678294659, 76.79814368858933, 63.64307880401611, 59.919869452714906, 57.44503248296677, 80.27934877574444, 88.42802079592366, 55.43101095082238, 69.12350858375427, 68.93399417586622], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [35.121812288959816, 35.94638739650448, 35.60644595821698, 24.425390551487595, 24.150024729470402, 24.212934302786977, 18.710639898975685, 18.44890323777993, 18.068857093652085, 26.678530782461166, 27.72989859012887, 27.056693717837334, 23.396104115992785, 23.503847651183605, 23.365642584860325, 26.08575640742977, 26.016397481163338, 25.328040202458695, 24.81532230538626, 24.741223170732454, 24.79614720245202, 25.83652914563814, 26.17773740614453, 26.233993666867406, 25.86189858869571, 25.64141413072744, 25.536739545563847, 22.78022728239496, 22.81913423289855, 22.57716541488965, 21.91862454017003, 22.131790568431214, 22.373295453920335, 20.38738805614412, 20.40380370616913, 20.12739323824644, 30.171953799882118, 29.587582799295575, 29.860127458969743, 23.331512996306017, 22.82223979135354, 23.169194777806595, 27.22912004900475, 26.688605693479374, 27.073115201046065, 27.797923927505806, 28.166918588181332, 28.4512134467562, 23.03963914513588, 23.103453777730465, 23.14591508358717, 22.873722354881465, 22.274366065859795, 22.88764054235071, 25.280489491919667, 25.701746352637798, 25.545855722079665, 28.753126631801322, 28.56755143528183, 28.41584776093562, 19.10067981481552, 19.334238911047578, 19.252454549074173, 26.718836841483906, 26.794383754332856, 26.92423090835412, 39.06870542714992, 39.320031587655336, 39.24140794823566, 28.87484512974818, 28.20091414948304, 28.246210624774292, 35.64772520711024, 35.542760868867234, 35.53893257429202, 21.90619760503371, 21.828539942701653, 21.920246978600815, 16.637183730800942, 16.8994200186183, 16.607743841906384, 23.339115490516022, 24.009575389636055, 23.388037045796708, 25.994074727098138, 26.365779946247727, 26.28967103610435, 28.464410354693726, 28.059005861481026, 28.369848070045308, 20.299961817761258, 20.566037529458598, 20.164489438136414, 31.06459581075856, 30.89477604503432, 31.088625295242906, 33.96950292835632, 34.41803612249592, 34.02387838313976, 19.9940921322753, 19.734577169020966, 19.74145923306544, 24.082677647471428, 24.34558431059122, 23.985584512352943, 22.415600702166557, 21.8162709325552, 22.409242153167725, 15.749795253078133, 15.90404036557689, 14.351054171721131, 29.70700032139817, 29.884287870993518, 28.635790059963853, 27.150477920969323, 27.367580565934375, 27.221098584433392, 19.55947758257389, 20.20331361889839, 20.300550512969494, 23.53075751165548, 23.925943477700145, 23.518498251835496, 16.389027203122765, 16.418938266734273, 16.007545257608086, 16.733305245637894, 17.16913427785039, 17.031468242406845, 22.53766972757876, 22.553968477994204, 22.451771695166826, 21.92548821369806, 21.974153236175567, 21.73129058132568, 26.551253306989864, 26.225269739826516, 26.34504475196202, 26.215277537703514, 26.456178948283195, 26.23387135565281, 28.419650067885712, 27.988857125242546, 28.176495042939976, 16.617149775226906, 16.966752623518303, 16.767495897909, 29.235351671775177, 29.363470225905374, 28.611750443776444, 25.080568497379616, 25.816212937080607, 25.737030259643987, 25.48928389387825, 24.937702054778725, 25.306823114554078, 24.355200833330542, 24.581911579395324, 24.380564993868262, 24.247778224448354, 24.091748426357896, 24.45827945942679, 25.310051347439483, 25.19832906251152, 24.902105694015816, 22.36711849396427, 22.365784784158066, 22.313596819837883, 29.63121344583729, 29.592931859816105, 29.552468361953885, 20.689762502908707, 20.968857526779175, 21.356471239589155, 22.159624822437763, 22.087902776896954, 22.04791759699583, 30.36536506563425, 30.332496866583824, 30.438549250364304, 18.551840323023498, 18.317392218858004, 17.992914497852325, 18.55889979501565, 19.18193518867095, 18.745356311400727, 22.790873403350503, 22.688528055946023, 22.851712013284356, 27.130600000421197, 27.63123421991864, 27.447555894652993, 20.32589480280876, 21.470510836225003, 20.90310949832201, 38.7654658059279, 38.89322828749815, 38.67614064613977, 25.042143921057374, 25.235157227764518, 25.064598294595868, 21.035188920795918, 21.24086756259203, 21.24134293757379, 21.05542706946531, 21.272769353042037, 21.25458654637137, 30.487328608830765, 30.819910177340105, 30.826469128330544, 29.52813774098952, 29.66853368779023, 29.943858978648976, 25.093902820100382, 24.946098388483122, 24.60494529952605, 16.32733395944038, 16.358090961972863, 16.540855305890233, 26.835651606321335, 26.864513460546732, 27.07228655833751, 30.16732999558249, 30.140888481090457, 29.080192516247422, 26.766457575683788, 26.769115886961416, 26.558826369543866, 25.481596499681473, 25.818901447579265, 25.265186339616776, 20.967762529850006, 21.20657379180193, 21.474533000960946, 24.137959107756615, 24.30682882666588, 24.3350369669497, 30.778015117471412, 30.552041569103793, 30.553805847962693, 31.42420021397993, 31.173851739615202, 31.40167008433491, 28.02812548975149, 28.66216222445169, 29.0550058245814, 22.554880887269974, 22.877938359975815, 23.07774806767702, 25.30329060057798, 24.74468138317266, 25.26604429135719, 24.936868632833153, 24.9054966221253, 25.51470899085203, 26.182303488254547, 26.360059179365635, 26.303434617817402, 21.849179367224366, 22.083184925237816, 21.299672226111085, 20.785928462942437, 21.064601728071764, 20.819292460878685, 26.65404701481262, 26.747396615023405, 26.432257051269204, 22.62701376527548, 22.99678946333006, 21.945295810699463, 24.733480639755726, 24.564501583576202, 24.81346455961466, 25.650191128253937, 25.139065951108932, 26.008886609226465, 21.329454444348812, 20.886753425002098, 21.426870934665203, 19.9999222656091, 20.025424522658184, 19.89452266444762, 19.260023971398667, 19.287070463721946, 18.897938047846154, 27.064490735530853, 26.49363984167576, 26.721218198537827, 29.309518195688725, 29.458358965814114, 29.66014363442082, 18.70860892953351, 18.486833333969116, 18.235568687319756, 23.0786224293212, 22.886515858272702, 23.15837029616037, 23.097707285235316, 22.61580043534437, 23.220486455286533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14133848594525808, "mean_inference_ms": 0.6452124571560485, "mean_action_processing_ms": 0.09501560232647804, "mean_env_wait_ms": 0.7951656120801198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 844800, "timesteps_this_iter": 0, "agent_timesteps_total": 2534400, "timers": {"sample_time_ms": 9395.754, "sample_throughput": 510.869, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1189.423, "learn_throughput": 4035.569, "update_time_ms": 1.594}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 5.510740876197815, "policy_loss": -0.0011620971084225218, "vf_loss": 5.668595552444458, "vf_explained_var": 0.0194154754281044, "kl": 0.007890888548245711, "entropy": 15.70929503440857, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 844800, "num_agent_steps_sampled": 2534400, "num_steps_trained": 844800, "num_agent_steps_trained": 2534400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3745, "training_iteration": 176, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-10-09", "timestamp": 1706148609, "time_this_iter_s": 9.339475870132446, "time_total_s": 1647.963837146759, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015BC1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1647.963837146759, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 11.446153846153845, "ram_util_percent": 47.79230769230769}}
{"episode_reward_max": 117.63014496304092, "episode_reward_min": 46.004889790376154, "episode_reward_mean": 75.11019794668886, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 14.351054171721131}, "policy_reward_max": {"shared_policy": 39.320031587655336}, "policy_reward_mean": {"shared_policy": 25.03673264889628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.28900800645351, 68.03572896309197, 76.52809156663713, 85.73652582801877, 57.68737327493727, 80.43745150417088, 117.63014496304092, 85.32196990400551, 106.7294186502695, 65.65498452633618, 50.14434759132563, 70.73672792594878, 78.64952570945022, 84.89326428622006, 61.03048878535627, 93.04799715103579, 102.411417433992, 59.470128534361706, 72.41384647041559, 66.64111378788948, 46.004889790376154, 88.22707825235554, 81.73915707133709, 60.063341714441776, 70.97519924119112, 48.815510727465124, 50.93390776589513, 67.54340990073979, 65.63093203119931, 79.1215677987784, 78.90532784163952, 84.58500223606823, 50.35139829665421, 87.210572341457, 76.63381169410421, 75.73380906321105, 73.31767740659413, 72.79780611023304, 75.41048610396682, 67.04650009796022, 88.77661366760728, 63.015091269277036, 66.29544519633055, 91.13641118258238, 54.86214703973383, 56.48619129508732, 68.33111347258088, 82.20939011499283, 62.699515137355775, 116.33483473956582, 75.34189944341776, 63.51739942096174, 63.58278296887872, 92.13370791450141, 89.14053040742873, 74.64494650810956, 49.22628022730348, 80.77245162520558, 89.38841099292037, 80.09439983218907, 76.56568428687751, 63.64886932261288, 72.7798249013722, 91.8838625345379, 93.99972203793004, 85.74529353878458, 68.51056731492281, 75.31401627510783, 75.35707424581048, 78.84579728543758, 65.23203651857327, 62.669822651892886, 79.83370068110523, 67.569099039305, 74.11144678294659, 76.79814368858933, 63.64307880401611, 59.919869452714906, 57.44503248296677, 80.27934877574444, 88.42802079592366, 55.43101095082238, 69.12350858375427, 68.93399417586622, 88.07013400271535, 55.55847443826495, 89.36905207671224, 82.3356720865704, 87.19258321076632, 79.60647492855787, 81.28311485424635, 82.75159323960543, 93.18867361545561, 62.187980424612746, 93.33805799111724, 78.96500632353124, 90.71015043929216, 63.95336357643828, 102.81513182632624, 66.09900370240209], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.03963914513588, 23.103453777730465, 23.14591508358717, 22.873722354881465, 22.274366065859795, 22.88764054235071, 25.280489491919667, 25.701746352637798, 25.545855722079665, 28.753126631801322, 28.56755143528183, 28.41584776093562, 19.10067981481552, 19.334238911047578, 19.252454549074173, 26.718836841483906, 26.794383754332856, 26.92423090835412, 39.06870542714992, 39.320031587655336, 39.24140794823566, 28.87484512974818, 28.20091414948304, 28.246210624774292, 35.64772520711024, 35.542760868867234, 35.53893257429202, 21.90619760503371, 21.828539942701653, 21.920246978600815, 16.637183730800942, 16.8994200186183, 16.607743841906384, 23.339115490516022, 24.009575389636055, 23.388037045796708, 25.994074727098138, 26.365779946247727, 26.28967103610435, 28.464410354693726, 28.059005861481026, 28.369848070045308, 20.299961817761258, 20.566037529458598, 20.164489438136414, 31.06459581075856, 30.89477604503432, 31.088625295242906, 33.96950292835632, 34.41803612249592, 34.02387838313976, 19.9940921322753, 19.734577169020966, 19.74145923306544, 24.082677647471428, 24.34558431059122, 23.985584512352943, 22.415600702166557, 21.8162709325552, 22.409242153167725, 15.749795253078133, 15.90404036557689, 14.351054171721131, 29.70700032139817, 29.884287870993518, 28.635790059963853, 27.150477920969323, 27.367580565934375, 27.221098584433392, 19.55947758257389, 20.20331361889839, 20.300550512969494, 23.53075751165548, 23.925943477700145, 23.518498251835496, 16.389027203122765, 16.418938266734273, 16.007545257608086, 16.733305245637894, 17.16913427785039, 17.031468242406845, 22.53766972757876, 22.553968477994204, 22.451771695166826, 21.92548821369806, 21.974153236175567, 21.73129058132568, 26.551253306989864, 26.225269739826516, 26.34504475196202, 26.215277537703514, 26.456178948283195, 26.23387135565281, 28.419650067885712, 27.988857125242546, 28.176495042939976, 16.617149775226906, 16.966752623518303, 16.767495897909, 29.235351671775177, 29.363470225905374, 28.611750443776444, 25.080568497379616, 25.816212937080607, 25.737030259643987, 25.48928389387825, 24.937702054778725, 25.306823114554078, 24.355200833330542, 24.581911579395324, 24.380564993868262, 24.247778224448354, 24.091748426357896, 24.45827945942679, 25.310051347439483, 25.19832906251152, 24.902105694015816, 22.36711849396427, 22.365784784158066, 22.313596819837883, 29.63121344583729, 29.592931859816105, 29.552468361953885, 20.689762502908707, 20.968857526779175, 21.356471239589155, 22.159624822437763, 22.087902776896954, 22.04791759699583, 30.36536506563425, 30.332496866583824, 30.438549250364304, 18.551840323023498, 18.317392218858004, 17.992914497852325, 18.55889979501565, 19.18193518867095, 18.745356311400727, 22.790873403350503, 22.688528055946023, 22.851712013284356, 27.130600000421197, 27.63123421991864, 27.447555894652993, 20.32589480280876, 21.470510836225003, 20.90310949832201, 38.7654658059279, 38.89322828749815, 38.67614064613977, 25.042143921057374, 25.235157227764518, 25.064598294595868, 21.035188920795918, 21.24086756259203, 21.24134293757379, 21.05542706946531, 21.272769353042037, 21.25458654637137, 30.487328608830765, 30.819910177340105, 30.826469128330544, 29.52813774098952, 29.66853368779023, 29.943858978648976, 25.093902820100382, 24.946098388483122, 24.60494529952605, 16.32733395944038, 16.358090961972863, 16.540855305890233, 26.835651606321335, 26.864513460546732, 27.07228655833751, 30.16732999558249, 30.140888481090457, 29.080192516247422, 26.766457575683788, 26.769115886961416, 26.558826369543866, 25.481596499681473, 25.818901447579265, 25.265186339616776, 20.967762529850006, 21.20657379180193, 21.474533000960946, 24.137959107756615, 24.30682882666588, 24.3350369669497, 30.778015117471412, 30.552041569103793, 30.553805847962693, 31.42420021397993, 31.173851739615202, 31.40167008433491, 28.02812548975149, 28.66216222445169, 29.0550058245814, 22.554880887269974, 22.877938359975815, 23.07774806767702, 25.30329060057798, 24.74468138317266, 25.26604429135719, 24.936868632833153, 24.9054966221253, 25.51470899085203, 26.182303488254547, 26.360059179365635, 26.303434617817402, 21.849179367224366, 22.083184925237816, 21.299672226111085, 20.785928462942437, 21.064601728071764, 20.819292460878685, 26.65404701481262, 26.747396615023405, 26.432257051269204, 22.62701376527548, 22.99678946333006, 21.945295810699463, 24.733480639755726, 24.564501583576202, 24.81346455961466, 25.650191128253937, 25.139065951108932, 26.008886609226465, 21.329454444348812, 20.886753425002098, 21.426870934665203, 19.9999222656091, 20.025424522658184, 19.89452266444762, 19.260023971398667, 19.287070463721946, 18.897938047846154, 27.064490735530853, 26.49363984167576, 26.721218198537827, 29.309518195688725, 29.458358965814114, 29.66014363442082, 18.70860892953351, 18.486833333969116, 18.235568687319756, 23.0786224293212, 22.886515858272702, 23.15837029616037, 23.097707285235316, 22.61580043534437, 23.220486455286533, 29.18079648911953, 29.51458326354623, 29.37475425004959, 18.347960223754242, 18.640590885033205, 18.569923329477504, 29.509363179405526, 29.752175105114773, 30.107513792191938, 27.267785874505833, 27.679616570317492, 27.388269641747073, 28.979554429650307, 28.960085950791836, 29.252942830324173, 26.477388501167297, 26.563831701874733, 26.565254725515842, 27.07557541752854, 27.314723948637635, 26.892815488080174, 27.29276467859745, 27.66827367991209, 27.790554881095886, 31.464581732948616, 30.92821681996186, 30.795875062545136, 20.904361510028437, 20.59427126993735, 20.689347644646958, 31.372809793800116, 31.292854726314545, 30.67239347100258, 26.521383319670946, 26.21036012719074, 26.233262876669556, 30.508065989861876, 29.867034221688897, 30.33505022774139, 21.5945890173316, 20.647922083735466, 21.71085247537121, 34.25544963901241, 34.221923907597855, 34.33775827971597, 21.628679285446793, 22.051244924465806, 22.419079492489487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14136559359044346, "mean_inference_ms": 0.6453780747615336, "mean_action_processing_ms": 0.09502618708617216, "mean_env_wait_ms": 0.7951628047955872, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 849600, "timesteps_this_iter": 0, "agent_timesteps_total": 2548800, "timers": {"sample_time_ms": 9415.053, "sample_throughput": 509.822, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1196.326, "learn_throughput": 4012.283, "update_time_ms": 1.598}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 7.135168552398682, "policy_loss": -0.000606368401414481, "vf_loss": 7.2917890548706055, "vf_explained_var": 0.031103625893592834, "kl": 0.009918789728795441, "entropy": 15.651673555374146, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 849600, "num_agent_steps_sampled": 2548800, "num_steps_trained": 849600, "num_agent_steps_trained": 2548800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3761, "training_iteration": 177, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-10-19", "timestamp": 1706148619, "time_this_iter_s": 9.715123891830444, "time_total_s": 1657.6789610385895, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021063471670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1657.6789610385895, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 8.557142857142857, "ram_util_percent": 47.82857142857142}}
{"episode_reward_max": 116.33483473956582, "episode_reward_min": 39.00774673302655, "episode_reward_mean": 73.46352623317507, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.926229237268359}, "policy_reward_max": {"shared_policy": 38.89322828749815}, "policy_reward_mean": {"shared_policy": 24.487842077725016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.411417433992, 59.470128534361706, 72.41384647041559, 66.64111378788948, 46.004889790376154, 88.22707825235554, 81.73915707133709, 60.063341714441776, 70.97519924119112, 48.815510727465124, 50.93390776589513, 67.54340990073979, 65.63093203119931, 79.1215677987784, 78.90532784163952, 84.58500223606823, 50.35139829665421, 87.210572341457, 76.63381169410421, 75.73380906321105, 73.31767740659413, 72.79780611023304, 75.41048610396682, 67.04650009796022, 88.77661366760728, 63.015091269277036, 66.29544519633055, 91.13641118258238, 54.86214703973383, 56.48619129508732, 68.33111347258088, 82.20939011499283, 62.699515137355775, 116.33483473956582, 75.34189944341776, 63.51739942096174, 63.58278296887872, 92.13370791450141, 89.14053040742873, 74.64494650810956, 49.22628022730348, 80.77245162520558, 89.38841099292037, 80.09439983218907, 76.56568428687751, 63.64886932261288, 72.7798249013722, 91.8838625345379, 93.99972203793004, 85.74529353878458, 68.51056731492281, 75.31401627510783, 75.35707424581048, 78.84579728543758, 65.23203651857327, 62.669822651892886, 79.83370068110523, 67.569099039305, 74.11144678294659, 76.79814368858933, 63.64307880401611, 59.919869452714906, 57.44503248296677, 80.27934877574444, 88.42802079592366, 55.43101095082238, 69.12350858375427, 68.93399417586622, 88.07013400271535, 55.55847443826495, 89.36905207671224, 82.3356720865704, 87.19258321076632, 79.60647492855787, 81.28311485424635, 82.75159323960543, 93.18867361545561, 62.187980424612746, 93.33805799111724, 78.96500632353124, 90.71015043929216, 63.95336357643828, 102.81513182632624, 66.09900370240209, 56.51960772648451, 67.93868410214782, 61.37434284389016, 39.00774673302655, 74.96017674263567, 70.21406567469238, 88.59538827463982, 76.98236511647698, 64.18949985131621, 43.330970837734625, 56.05010395590216, 78.88199545815586, 71.92552039399743, 65.8136935904622, 95.78667961200696, 75.31503637135026], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [33.96950292835632, 34.41803612249592, 34.02387838313976, 19.9940921322753, 19.734577169020966, 19.74145923306544, 24.082677647471428, 24.34558431059122, 23.985584512352943, 22.415600702166557, 21.8162709325552, 22.409242153167725, 15.749795253078133, 15.90404036557689, 14.351054171721131, 29.70700032139817, 29.884287870993518, 28.635790059963853, 27.150477920969323, 27.367580565934375, 27.221098584433392, 19.55947758257389, 20.20331361889839, 20.300550512969494, 23.53075751165548, 23.925943477700145, 23.518498251835496, 16.389027203122765, 16.418938266734273, 16.007545257608086, 16.733305245637894, 17.16913427785039, 17.031468242406845, 22.53766972757876, 22.553968477994204, 22.451771695166826, 21.92548821369806, 21.974153236175567, 21.73129058132568, 26.551253306989864, 26.225269739826516, 26.34504475196202, 26.215277537703514, 26.456178948283195, 26.23387135565281, 28.419650067885712, 27.988857125242546, 28.176495042939976, 16.617149775226906, 16.966752623518303, 16.767495897909, 29.235351671775177, 29.363470225905374, 28.611750443776444, 25.080568497379616, 25.816212937080607, 25.737030259643987, 25.48928389387825, 24.937702054778725, 25.306823114554078, 24.355200833330542, 24.581911579395324, 24.380564993868262, 24.247778224448354, 24.091748426357896, 24.45827945942679, 25.310051347439483, 25.19832906251152, 24.902105694015816, 22.36711849396427, 22.365784784158066, 22.313596819837883, 29.63121344583729, 29.592931859816105, 29.552468361953885, 20.689762502908707, 20.968857526779175, 21.356471239589155, 22.159624822437763, 22.087902776896954, 22.04791759699583, 30.36536506563425, 30.332496866583824, 30.438549250364304, 18.551840323023498, 18.317392218858004, 17.992914497852325, 18.55889979501565, 19.18193518867095, 18.745356311400727, 22.790873403350503, 22.688528055946023, 22.851712013284356, 27.130600000421197, 27.63123421991864, 27.447555894652993, 20.32589480280876, 21.470510836225003, 20.90310949832201, 38.7654658059279, 38.89322828749815, 38.67614064613977, 25.042143921057374, 25.235157227764518, 25.064598294595868, 21.035188920795918, 21.24086756259203, 21.24134293757379, 21.05542706946531, 21.272769353042037, 21.25458654637137, 30.487328608830765, 30.819910177340105, 30.826469128330544, 29.52813774098952, 29.66853368779023, 29.943858978648976, 25.093902820100382, 24.946098388483122, 24.60494529952605, 16.32733395944038, 16.358090961972863, 16.540855305890233, 26.835651606321335, 26.864513460546732, 27.07228655833751, 30.16732999558249, 30.140888481090457, 29.080192516247422, 26.766457575683788, 26.769115886961416, 26.558826369543866, 25.481596499681473, 25.818901447579265, 25.265186339616776, 20.967762529850006, 21.20657379180193, 21.474533000960946, 24.137959107756615, 24.30682882666588, 24.3350369669497, 30.778015117471412, 30.552041569103793, 30.553805847962693, 31.42420021397993, 31.173851739615202, 31.40167008433491, 28.02812548975149, 28.66216222445169, 29.0550058245814, 22.554880887269974, 22.877938359975815, 23.07774806767702, 25.30329060057798, 24.74468138317266, 25.26604429135719, 24.936868632833153, 24.9054966221253, 25.51470899085203, 26.182303488254547, 26.360059179365635, 26.303434617817402, 21.849179367224366, 22.083184925237816, 21.299672226111085, 20.785928462942437, 21.064601728071764, 20.819292460878685, 26.65404701481262, 26.747396615023405, 26.432257051269204, 22.62701376527548, 22.99678946333006, 21.945295810699463, 24.733480639755726, 24.564501583576202, 24.81346455961466, 25.650191128253937, 25.139065951108932, 26.008886609226465, 21.329454444348812, 20.886753425002098, 21.426870934665203, 19.9999222656091, 20.025424522658184, 19.89452266444762, 19.260023971398667, 19.287070463721946, 18.897938047846154, 27.064490735530853, 26.49363984167576, 26.721218198537827, 29.309518195688725, 29.458358965814114, 29.66014363442082, 18.70860892953351, 18.486833333969116, 18.235568687319756, 23.0786224293212, 22.886515858272702, 23.15837029616037, 23.097707285235316, 22.61580043534437, 23.220486455286533, 29.18079648911953, 29.51458326354623, 29.37475425004959, 18.347960223754242, 18.640590885033205, 18.569923329477504, 29.509363179405526, 29.752175105114773, 30.107513792191938, 27.267785874505833, 27.679616570317492, 27.388269641747073, 28.979554429650307, 28.960085950791836, 29.252942830324173, 26.477388501167297, 26.563831701874733, 26.565254725515842, 27.07557541752854, 27.314723948637635, 26.892815488080174, 27.29276467859745, 27.66827367991209, 27.790554881095886, 31.464581732948616, 30.92821681996186, 30.795875062545136, 20.904361510028437, 20.59427126993735, 20.689347644646958, 31.372809793800116, 31.292854726314545, 30.67239347100258, 26.521383319670946, 26.21036012719074, 26.233262876669556, 30.508065989861876, 29.867034221688897, 30.33505022774139, 21.5945890173316, 20.647922083735466, 21.71085247537121, 34.25544963901241, 34.221923907597855, 34.33775827971597, 21.628679285446793, 22.051244924465806, 22.419079492489487, 18.78533975283304, 18.813750288138777, 18.920517685512692, 22.19696508347988, 22.7904154881835, 22.951303530484438, 20.47642898807922, 20.711351605753094, 20.186562250057847, 12.939499186972768, 12.926229237268359, 13.142018308785424, 24.537835657596588, 24.93859001994133, 25.48375106509775, 23.3364388992389, 23.688590088238314, 23.189036687215165, 29.604033468912036, 29.24322388569513, 29.74813092003265, 25.687409395972878, 25.65870916346708, 25.636246557037026, 21.40607612580061, 21.512777026742697, 21.270646698772907, 13.942587589224175, 14.647759775941566, 14.740623472568885, 18.16728486120701, 18.82855484634638, 19.054264248348773, 26.31859777619441, 26.032166202863053, 26.531231479098395, 24.36234077438712, 23.699660450220108, 23.8635191693902, 22.185023364921406, 22.04667878647645, 21.58199143906434, 32.41760914415741, 31.4738575319449, 31.895212935904652, 24.836805577079446, 25.005790668229253, 25.472440126041562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14139948454649987, "mean_inference_ms": 0.6455532888599239, "mean_action_processing_ms": 0.09502959815373441, "mean_env_wait_ms": 0.7951935108201783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 854400, "timesteps_this_iter": 0, "agent_timesteps_total": 2563200, "timers": {"sample_time_ms": 9434.514, "sample_throughput": 508.77, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1195.433, "learn_throughput": 4015.283, "update_time_ms": 1.598}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.36493194103241, "policy_loss": 0.001342323794702227, "vf_loss": 6.52047073841095, "vf_explained_var": 0.009473666548728943, "kl": 0.012041992508132926, "entropy": 15.749152779579163, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 854400, "num_agent_steps_sampled": 2563200, "num_steps_trained": 854400, "num_agent_steps_trained": 2563200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3777, "training_iteration": 178, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-10-28", "timestamp": 1706148628, "time_this_iter_s": 9.504064798355103, "time_total_s": 1667.1830258369446, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015BC040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1667.1830258369446, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 6.7846153846153845, "ram_util_percent": 47.9076923076923}}
{"episode_reward_max": 116.33483473956582, "episode_reward_min": 39.00774673302655, "episode_reward_mean": 74.19643426374009, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.926229237268359}, "policy_reward_max": {"shared_policy": 38.89322828749815}, "policy_reward_mean": {"shared_policy": 24.732144754580023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.35139829665421, 87.210572341457, 76.63381169410421, 75.73380906321105, 73.31767740659413, 72.79780611023304, 75.41048610396682, 67.04650009796022, 88.77661366760728, 63.015091269277036, 66.29544519633055, 91.13641118258238, 54.86214703973383, 56.48619129508732, 68.33111347258088, 82.20939011499283, 62.699515137355775, 116.33483473956582, 75.34189944341776, 63.51739942096174, 63.58278296887872, 92.13370791450141, 89.14053040742873, 74.64494650810956, 49.22628022730348, 80.77245162520558, 89.38841099292037, 80.09439983218907, 76.56568428687751, 63.64886932261288, 72.7798249013722, 91.8838625345379, 93.99972203793004, 85.74529353878458, 68.51056731492281, 75.31401627510783, 75.35707424581048, 78.84579728543758, 65.23203651857327, 62.669822651892886, 79.83370068110523, 67.569099039305, 74.11144678294659, 76.79814368858933, 63.64307880401611, 59.919869452714906, 57.44503248296677, 80.27934877574444, 88.42802079592366, 55.43101095082238, 69.12350858375427, 68.93399417586622, 88.07013400271535, 55.55847443826495, 89.36905207671224, 82.3356720865704, 87.19258321076632, 79.60647492855787, 81.28311485424635, 82.75159323960543, 93.18867361545561, 62.187980424612746, 93.33805799111724, 78.96500632353124, 90.71015043929216, 63.95336357643828, 102.81513182632624, 66.09900370240209, 56.51960772648451, 67.93868410214782, 61.37434284389016, 39.00774673302655, 74.96017674263567, 70.21406567469238, 88.59538827463982, 76.98236511647698, 64.18949985131621, 43.330970837734625, 56.05010395590216, 78.88199545815586, 71.92552039399743, 65.8136935904622, 95.78667961200696, 75.31503637135026, 98.33547963574527, 79.90633610170335, 82.62934240698812, 68.42759065702558, 49.39605346322057, 60.39985025674103, 69.40861964039505, 76.29158972203732, 52.35225184552834, 82.40305695310234, 83.02723528817293, 95.8019429594278, 64.40254236757752, 79.59949102997777, 78.7597311446443, 75.63152018235996], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.617149775226906, 16.966752623518303, 16.767495897909, 29.235351671775177, 29.363470225905374, 28.611750443776444, 25.080568497379616, 25.816212937080607, 25.737030259643987, 25.48928389387825, 24.937702054778725, 25.306823114554078, 24.355200833330542, 24.581911579395324, 24.380564993868262, 24.247778224448354, 24.091748426357896, 24.45827945942679, 25.310051347439483, 25.19832906251152, 24.902105694015816, 22.36711849396427, 22.365784784158066, 22.313596819837883, 29.63121344583729, 29.592931859816105, 29.552468361953885, 20.689762502908707, 20.968857526779175, 21.356471239589155, 22.159624822437763, 22.087902776896954, 22.04791759699583, 30.36536506563425, 30.332496866583824, 30.438549250364304, 18.551840323023498, 18.317392218858004, 17.992914497852325, 18.55889979501565, 19.18193518867095, 18.745356311400727, 22.790873403350503, 22.688528055946023, 22.851712013284356, 27.130600000421197, 27.63123421991864, 27.447555894652993, 20.32589480280876, 21.470510836225003, 20.90310949832201, 38.7654658059279, 38.89322828749815, 38.67614064613977, 25.042143921057374, 25.235157227764518, 25.064598294595868, 21.035188920795918, 21.24086756259203, 21.24134293757379, 21.05542706946531, 21.272769353042037, 21.25458654637137, 30.487328608830765, 30.819910177340105, 30.826469128330544, 29.52813774098952, 29.66853368779023, 29.943858978648976, 25.093902820100382, 24.946098388483122, 24.60494529952605, 16.32733395944038, 16.358090961972863, 16.540855305890233, 26.835651606321335, 26.864513460546732, 27.07228655833751, 30.16732999558249, 30.140888481090457, 29.080192516247422, 26.766457575683788, 26.769115886961416, 26.558826369543866, 25.481596499681473, 25.818901447579265, 25.265186339616776, 20.967762529850006, 21.20657379180193, 21.474533000960946, 24.137959107756615, 24.30682882666588, 24.3350369669497, 30.778015117471412, 30.552041569103793, 30.553805847962693, 31.42420021397993, 31.173851739615202, 31.40167008433491, 28.02812548975149, 28.66216222445169, 29.0550058245814, 22.554880887269974, 22.877938359975815, 23.07774806767702, 25.30329060057798, 24.74468138317266, 25.26604429135719, 24.936868632833153, 24.9054966221253, 25.51470899085203, 26.182303488254547, 26.360059179365635, 26.303434617817402, 21.849179367224366, 22.083184925237816, 21.299672226111085, 20.785928462942437, 21.064601728071764, 20.819292460878685, 26.65404701481262, 26.747396615023405, 26.432257051269204, 22.62701376527548, 22.99678946333006, 21.945295810699463, 24.733480639755726, 24.564501583576202, 24.81346455961466, 25.650191128253937, 25.139065951108932, 26.008886609226465, 21.329454444348812, 20.886753425002098, 21.426870934665203, 19.9999222656091, 20.025424522658184, 19.89452266444762, 19.260023971398667, 19.287070463721946, 18.897938047846154, 27.064490735530853, 26.49363984167576, 26.721218198537827, 29.309518195688725, 29.458358965814114, 29.66014363442082, 18.70860892953351, 18.486833333969116, 18.235568687319756, 23.0786224293212, 22.886515858272702, 23.15837029616037, 23.097707285235316, 22.61580043534437, 23.220486455286533, 29.18079648911953, 29.51458326354623, 29.37475425004959, 18.347960223754242, 18.640590885033205, 18.569923329477504, 29.509363179405526, 29.752175105114773, 30.107513792191938, 27.267785874505833, 27.679616570317492, 27.388269641747073, 28.979554429650307, 28.960085950791836, 29.252942830324173, 26.477388501167297, 26.563831701874733, 26.565254725515842, 27.07557541752854, 27.314723948637635, 26.892815488080174, 27.29276467859745, 27.66827367991209, 27.790554881095886, 31.464581732948616, 30.92821681996186, 30.795875062545136, 20.904361510028437, 20.59427126993735, 20.689347644646958, 31.372809793800116, 31.292854726314545, 30.67239347100258, 26.521383319670946, 26.21036012719074, 26.233262876669556, 30.508065989861876, 29.867034221688897, 30.33505022774139, 21.5945890173316, 20.647922083735466, 21.71085247537121, 34.25544963901241, 34.221923907597855, 34.33775827971597, 21.628679285446793, 22.051244924465806, 22.419079492489487, 18.78533975283304, 18.813750288138777, 18.920517685512692, 22.19696508347988, 22.7904154881835, 22.951303530484438, 20.47642898807922, 20.711351605753094, 20.186562250057847, 12.939499186972768, 12.926229237268359, 13.142018308785424, 24.537835657596588, 24.93859001994133, 25.48375106509775, 23.3364388992389, 23.688590088238314, 23.189036687215165, 29.604033468912036, 29.24322388569513, 29.74813092003265, 25.687409395972878, 25.65870916346708, 25.636246557037026, 21.40607612580061, 21.512777026742697, 21.270646698772907, 13.942587589224175, 14.647759775941566, 14.740623472568885, 18.16728486120701, 18.82855484634638, 19.054264248348773, 26.31859777619441, 26.032166202863053, 26.531231479098395, 24.36234077438712, 23.699660450220108, 23.8635191693902, 22.185023364921406, 22.04667878647645, 21.58199143906434, 32.41760914415741, 31.4738575319449, 31.895212935904652, 24.836805577079446, 25.005790668229253, 25.472440126041562, 32.66029058893521, 32.61659800012906, 33.058591046681, 26.140994876623154, 26.95642865728587, 26.808912567794323, 27.47201747323075, 27.53152963767448, 27.625795296082885, 23.214560475200415, 22.070268213748932, 23.14276196807623, 16.36035270492235, 16.45977776000896, 16.575922998289258, 20.143153920148805, 20.12395106380184, 20.132745272790388, 23.07084672898054, 22.864899307489395, 23.47287360392511, 25.294189125299454, 25.548031523823738, 25.449369072914124, 17.72915467414228, 17.27591737608114, 17.347179795304925, 27.13769257565339, 27.631925982733563, 27.633438394715384, 27.983184947321803, 27.382133478919656, 27.661916861931473, 32.031901496152074, 31.860170270005852, 31.90987119326988, 21.57166742781797, 21.440396728614957, 21.390478211144597, 26.532046834627778, 26.471047813693673, 26.59639638165632, 26.09851874162753, 26.536801142928496, 26.12441126008828, 25.523152567911893, 25.143973603844643, 24.964394010603428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14141641374028616, "mean_inference_ms": 0.6457063761184382, "mean_action_processing_ms": 0.09502370529653685, "mean_env_wait_ms": 0.7952334793067237, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 859200, "timesteps_this_iter": 0, "agent_timesteps_total": 2577600, "timers": {"sample_time_ms": 9447.553, "sample_throughput": 508.068, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1194.56, "learn_throughput": 4018.217, "update_time_ms": 1.597}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 5.804431200027466, "policy_loss": -0.00020535003589516876, "vf_loss": 5.964318811893463, "vf_explained_var": 0.0089501291513443, "kl": 0.008368680457622993, "entropy": 16.01065504550934, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 859200, "num_agent_steps_sampled": 2577600, "num_steps_trained": 859200, "num_agent_steps_trained": 2577600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3793, "training_iteration": 179, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-10-37", "timestamp": 1706148637, "time_this_iter_s": 9.287635564804077, "time_total_s": 1676.4706614017487, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1676.4706614017487, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 7.084615384615385, "ram_util_percent": 47.853846153846156}}
{"episode_reward_max": 116.33483473956582, "episode_reward_min": 38.90692290663719, "episode_reward_mean": 74.47697000489163, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.5015919059515}, "policy_reward_max": {"shared_policy": 38.89322828749815}, "policy_reward_mean": {"shared_policy": 24.825656668297206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.699515137355775, 116.33483473956582, 75.34189944341776, 63.51739942096174, 63.58278296887872, 92.13370791450141, 89.14053040742873, 74.64494650810956, 49.22628022730348, 80.77245162520558, 89.38841099292037, 80.09439983218907, 76.56568428687751, 63.64886932261288, 72.7798249013722, 91.8838625345379, 93.99972203793004, 85.74529353878458, 68.51056731492281, 75.31401627510783, 75.35707424581048, 78.84579728543758, 65.23203651857327, 62.669822651892886, 79.83370068110523, 67.569099039305, 74.11144678294659, 76.79814368858933, 63.64307880401611, 59.919869452714906, 57.44503248296677, 80.27934877574444, 88.42802079592366, 55.43101095082238, 69.12350858375427, 68.93399417586622, 88.07013400271535, 55.55847443826495, 89.36905207671224, 82.3356720865704, 87.19258321076632, 79.60647492855787, 81.28311485424635, 82.75159323960543, 93.18867361545561, 62.187980424612746, 93.33805799111724, 78.96500632353124, 90.71015043929216, 63.95336357643828, 102.81513182632624, 66.09900370240209, 56.51960772648451, 67.93868410214782, 61.37434284389016, 39.00774673302655, 74.96017674263567, 70.21406567469238, 88.59538827463982, 76.98236511647698, 64.18949985131621, 43.330970837734625, 56.05010395590216, 78.88199545815586, 71.92552039399743, 65.8136935904622, 95.78667961200696, 75.31503637135026, 98.33547963574527, 79.90633610170335, 82.62934240698812, 68.42759065702558, 49.39605346322057, 60.39985025674103, 69.40861964039505, 76.29158972203732, 52.35225184552834, 82.40305695310234, 83.02723528817293, 95.8019429594278, 64.40254236757752, 79.59949102997777, 78.7597311446443, 75.63152018235996, 61.03416586667298, 47.77576346695422, 68.53361855435648, 66.19105729460716, 77.32389204949138, 83.58221040992063, 100.45475965924558, 78.97571228444575, 66.2291947379708, 97.05633964948353, 84.35995479370465, 69.52791708242148, 69.92134065506978, 69.72579534724355, 38.90692290663719, 98.06939370930192], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.32589480280876, 21.470510836225003, 20.90310949832201, 38.7654658059279, 38.89322828749815, 38.67614064613977, 25.042143921057374, 25.235157227764518, 25.064598294595868, 21.035188920795918, 21.24086756259203, 21.24134293757379, 21.05542706946531, 21.272769353042037, 21.25458654637137, 30.487328608830765, 30.819910177340105, 30.826469128330544, 29.52813774098952, 29.66853368779023, 29.943858978648976, 25.093902820100382, 24.946098388483122, 24.60494529952605, 16.32733395944038, 16.358090961972863, 16.540855305890233, 26.835651606321335, 26.864513460546732, 27.07228655833751, 30.16732999558249, 30.140888481090457, 29.080192516247422, 26.766457575683788, 26.769115886961416, 26.558826369543866, 25.481596499681473, 25.818901447579265, 25.265186339616776, 20.967762529850006, 21.20657379180193, 21.474533000960946, 24.137959107756615, 24.30682882666588, 24.3350369669497, 30.778015117471412, 30.552041569103793, 30.553805847962693, 31.42420021397993, 31.173851739615202, 31.40167008433491, 28.02812548975149, 28.66216222445169, 29.0550058245814, 22.554880887269974, 22.877938359975815, 23.07774806767702, 25.30329060057798, 24.74468138317266, 25.26604429135719, 24.936868632833153, 24.9054966221253, 25.51470899085203, 26.182303488254547, 26.360059179365635, 26.303434617817402, 21.849179367224366, 22.083184925237816, 21.299672226111085, 20.785928462942437, 21.064601728071764, 20.819292460878685, 26.65404701481262, 26.747396615023405, 26.432257051269204, 22.62701376527548, 22.99678946333006, 21.945295810699463, 24.733480639755726, 24.564501583576202, 24.81346455961466, 25.650191128253937, 25.139065951108932, 26.008886609226465, 21.329454444348812, 20.886753425002098, 21.426870934665203, 19.9999222656091, 20.025424522658184, 19.89452266444762, 19.260023971398667, 19.287070463721946, 18.897938047846154, 27.064490735530853, 26.49363984167576, 26.721218198537827, 29.309518195688725, 29.458358965814114, 29.66014363442082, 18.70860892953351, 18.486833333969116, 18.235568687319756, 23.0786224293212, 22.886515858272702, 23.15837029616037, 23.097707285235316, 22.61580043534437, 23.220486455286533, 29.18079648911953, 29.51458326354623, 29.37475425004959, 18.347960223754242, 18.640590885033205, 18.569923329477504, 29.509363179405526, 29.752175105114773, 30.107513792191938, 27.267785874505833, 27.679616570317492, 27.388269641747073, 28.979554429650307, 28.960085950791836, 29.252942830324173, 26.477388501167297, 26.563831701874733, 26.565254725515842, 27.07557541752854, 27.314723948637635, 26.892815488080174, 27.29276467859745, 27.66827367991209, 27.790554881095886, 31.464581732948616, 30.92821681996186, 30.795875062545136, 20.904361510028437, 20.59427126993735, 20.689347644646958, 31.372809793800116, 31.292854726314545, 30.67239347100258, 26.521383319670946, 26.21036012719074, 26.233262876669556, 30.508065989861876, 29.867034221688897, 30.33505022774139, 21.5945890173316, 20.647922083735466, 21.71085247537121, 34.25544963901241, 34.221923907597855, 34.33775827971597, 21.628679285446793, 22.051244924465806, 22.419079492489487, 18.78533975283304, 18.813750288138777, 18.920517685512692, 22.19696508347988, 22.7904154881835, 22.951303530484438, 20.47642898807922, 20.711351605753094, 20.186562250057847, 12.939499186972768, 12.926229237268359, 13.142018308785424, 24.537835657596588, 24.93859001994133, 25.48375106509775, 23.3364388992389, 23.688590088238314, 23.189036687215165, 29.604033468912036, 29.24322388569513, 29.74813092003265, 25.687409395972878, 25.65870916346708, 25.636246557037026, 21.40607612580061, 21.512777026742697, 21.270646698772907, 13.942587589224175, 14.647759775941566, 14.740623472568885, 18.16728486120701, 18.82855484634638, 19.054264248348773, 26.31859777619441, 26.032166202863053, 26.531231479098395, 24.36234077438712, 23.699660450220108, 23.8635191693902, 22.185023364921406, 22.04667878647645, 21.58199143906434, 32.41760914415741, 31.4738575319449, 31.895212935904652, 24.836805577079446, 25.005790668229253, 25.472440126041562, 32.66029058893521, 32.61659800012906, 33.058591046681, 26.140994876623154, 26.95642865728587, 26.808912567794323, 27.47201747323075, 27.53152963767448, 27.625795296082885, 23.214560475200415, 22.070268213748932, 23.14276196807623, 16.36035270492235, 16.45977776000896, 16.575922998289258, 20.143153920148805, 20.12395106380184, 20.132745272790388, 23.07084672898054, 22.864899307489395, 23.47287360392511, 25.294189125299454, 25.548031523823738, 25.449369072914124, 17.72915467414228, 17.27591737608114, 17.347179795304925, 27.13769257565339, 27.631925982733563, 27.633438394715384, 27.983184947321803, 27.382133478919656, 27.661916861931473, 32.031901496152074, 31.860170270005852, 31.90987119326988, 21.57166742781797, 21.440396728614957, 21.390478211144597, 26.532046834627778, 26.471047813693673, 26.59639638165632, 26.09851874162753, 26.536801142928496, 26.12441126008828, 25.523152567911893, 25.143973603844643, 24.964394010603428, 20.324968566497162, 20.355393198629216, 20.3538041015466, 16.054194820423916, 15.675702830155686, 16.045865816374615, 23.111958548931085, 22.457488576571137, 22.964171428854257, 21.807693600654602, 22.199423912912607, 22.183939781039953, 25.888784586141497, 25.958836658547312, 25.476270804802567, 27.674679058293492, 28.132619297287107, 27.774912054340035, 33.40210175017515, 33.257031234602124, 33.79562667446831, 26.322607969244316, 25.91520396371682, 26.737900351484612, 22.451832282046468, 21.883254448572785, 21.894108007351548, 32.393333109716565, 32.496414080883056, 32.16659245888391, 28.200699793795735, 28.387000135534123, 27.772254864374787, 23.276904499158263, 22.951876245439053, 23.299136337824166, 23.242736627658203, 23.022157122691468, 23.656446904720113, 23.427104458212852, 22.633252322673798, 23.665438566356897, 13.200645461678505, 13.204685539007187, 12.5015919059515, 32.789474005500466, 32.51449062178531, 32.76542908201614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1414179873790841, "mean_inference_ms": 0.6458276082436598, "mean_action_processing_ms": 0.09501803421624905, "mean_env_wait_ms": 0.7952555825992695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 864000, "timesteps_this_iter": 0, "agent_timesteps_total": 2592000, "timers": {"sample_time_ms": 9436.775, "sample_throughput": 508.648, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1190.702, "learn_throughput": 4031.237, "update_time_ms": 1.604}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.4399548172950745, "policy_loss": 0.0008740337480938054, "vf_loss": 6.5984121561050415, "vf_explained_var": -0.0025016367435455322, "kl": 0.011632087175073356, "entropy": 15.992110133171082, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 864000, "num_agent_steps_sampled": 2592000, "num_steps_trained": 864000, "num_agent_steps_trained": 2592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3809, "training_iteration": 180, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-10-46", "timestamp": 1706148646, "time_this_iter_s": 9.006331205368042, "time_total_s": 1685.4769926071167, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000466790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1685.4769926071167, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 8.569230769230769, "ram_util_percent": 47.84615384615384}}
{"episode_reward_max": 102.81513182632624, "episode_reward_min": 38.90692290663719, "episode_reward_mean": 73.03448797694116, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.5015919059515}, "policy_reward_max": {"shared_policy": 34.33775827971597}, "policy_reward_mean": {"shared_policy": 24.344829325647048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.99972203793004, 85.74529353878458, 68.51056731492281, 75.31401627510783, 75.35707424581048, 78.84579728543758, 65.23203651857327, 62.669822651892886, 79.83370068110523, 67.569099039305, 74.11144678294659, 76.79814368858933, 63.64307880401611, 59.919869452714906, 57.44503248296677, 80.27934877574444, 88.42802079592366, 55.43101095082238, 69.12350858375427, 68.93399417586622, 88.07013400271535, 55.55847443826495, 89.36905207671224, 82.3356720865704, 87.19258321076632, 79.60647492855787, 81.28311485424635, 82.75159323960543, 93.18867361545561, 62.187980424612746, 93.33805799111724, 78.96500632353124, 90.71015043929216, 63.95336357643828, 102.81513182632624, 66.09900370240209, 56.51960772648451, 67.93868410214782, 61.37434284389016, 39.00774673302655, 74.96017674263567, 70.21406567469238, 88.59538827463982, 76.98236511647698, 64.18949985131621, 43.330970837734625, 56.05010395590216, 78.88199545815586, 71.92552039399743, 65.8136935904622, 95.78667961200696, 75.31503637135026, 98.33547963574527, 79.90633610170335, 82.62934240698812, 68.42759065702558, 49.39605346322057, 60.39985025674103, 69.40861964039505, 76.29158972203732, 52.35225184552834, 82.40305695310234, 83.02723528817293, 95.8019429594278, 64.40254236757752, 79.59949102997777, 78.7597311446443, 75.63152018235996, 61.03416586667298, 47.77576346695422, 68.53361855435648, 66.19105729460716, 77.32389204949138, 83.58221040992063, 100.45475965924558, 78.97571228444575, 66.2291947379708, 97.05633964948353, 84.35995479370465, 69.52791708242148, 69.92134065506978, 69.72579534724355, 38.90692290663719, 98.06939370930192, 70.1010374575853, 79.09205273911354, 61.61482717189938, 57.759656712412806, 90.24070723191835, 53.21199920773503, 63.048972902819486, 71.41880373284218, 65.07100544311106, 79.95676949620245, 82.39681932330132, 56.97526975721118, 79.59580893442033, 60.69317147065884, 69.68252298992591, 56.64777289703488], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [31.42420021397993, 31.173851739615202, 31.40167008433491, 28.02812548975149, 28.66216222445169, 29.0550058245814, 22.554880887269974, 22.877938359975815, 23.07774806767702, 25.30329060057798, 24.74468138317266, 25.26604429135719, 24.936868632833153, 24.9054966221253, 25.51470899085203, 26.182303488254547, 26.360059179365635, 26.303434617817402, 21.849179367224366, 22.083184925237816, 21.299672226111085, 20.785928462942437, 21.064601728071764, 20.819292460878685, 26.65404701481262, 26.747396615023405, 26.432257051269204, 22.62701376527548, 22.99678946333006, 21.945295810699463, 24.733480639755726, 24.564501583576202, 24.81346455961466, 25.650191128253937, 25.139065951108932, 26.008886609226465, 21.329454444348812, 20.886753425002098, 21.426870934665203, 19.9999222656091, 20.025424522658184, 19.89452266444762, 19.260023971398667, 19.287070463721946, 18.897938047846154, 27.064490735530853, 26.49363984167576, 26.721218198537827, 29.309518195688725, 29.458358965814114, 29.66014363442082, 18.70860892953351, 18.486833333969116, 18.235568687319756, 23.0786224293212, 22.886515858272702, 23.15837029616037, 23.097707285235316, 22.61580043534437, 23.220486455286533, 29.18079648911953, 29.51458326354623, 29.37475425004959, 18.347960223754242, 18.640590885033205, 18.569923329477504, 29.509363179405526, 29.752175105114773, 30.107513792191938, 27.267785874505833, 27.679616570317492, 27.388269641747073, 28.979554429650307, 28.960085950791836, 29.252942830324173, 26.477388501167297, 26.563831701874733, 26.565254725515842, 27.07557541752854, 27.314723948637635, 26.892815488080174, 27.29276467859745, 27.66827367991209, 27.790554881095886, 31.464581732948616, 30.92821681996186, 30.795875062545136, 20.904361510028437, 20.59427126993735, 20.689347644646958, 31.372809793800116, 31.292854726314545, 30.67239347100258, 26.521383319670946, 26.21036012719074, 26.233262876669556, 30.508065989861876, 29.867034221688897, 30.33505022774139, 21.5945890173316, 20.647922083735466, 21.71085247537121, 34.25544963901241, 34.221923907597855, 34.33775827971597, 21.628679285446793, 22.051244924465806, 22.419079492489487, 18.78533975283304, 18.813750288138777, 18.920517685512692, 22.19696508347988, 22.7904154881835, 22.951303530484438, 20.47642898807922, 20.711351605753094, 20.186562250057847, 12.939499186972768, 12.926229237268359, 13.142018308785424, 24.537835657596588, 24.93859001994133, 25.48375106509775, 23.3364388992389, 23.688590088238314, 23.189036687215165, 29.604033468912036, 29.24322388569513, 29.74813092003265, 25.687409395972878, 25.65870916346708, 25.636246557037026, 21.40607612580061, 21.512777026742697, 21.270646698772907, 13.942587589224175, 14.647759775941566, 14.740623472568885, 18.16728486120701, 18.82855484634638, 19.054264248348773, 26.31859777619441, 26.032166202863053, 26.531231479098395, 24.36234077438712, 23.699660450220108, 23.8635191693902, 22.185023364921406, 22.04667878647645, 21.58199143906434, 32.41760914415741, 31.4738575319449, 31.895212935904652, 24.836805577079446, 25.005790668229253, 25.472440126041562, 32.66029058893521, 32.61659800012906, 33.058591046681, 26.140994876623154, 26.95642865728587, 26.808912567794323, 27.47201747323075, 27.53152963767448, 27.625795296082885, 23.214560475200415, 22.070268213748932, 23.14276196807623, 16.36035270492235, 16.45977776000896, 16.575922998289258, 20.143153920148805, 20.12395106380184, 20.132745272790388, 23.07084672898054, 22.864899307489395, 23.47287360392511, 25.294189125299454, 25.548031523823738, 25.449369072914124, 17.72915467414228, 17.27591737608114, 17.347179795304925, 27.13769257565339, 27.631925982733563, 27.633438394715384, 27.983184947321803, 27.382133478919656, 27.661916861931473, 32.031901496152074, 31.860170270005852, 31.90987119326988, 21.57166742781797, 21.440396728614957, 21.390478211144597, 26.532046834627778, 26.471047813693673, 26.59639638165632, 26.09851874162753, 26.536801142928496, 26.12441126008828, 25.523152567911893, 25.143973603844643, 24.964394010603428, 20.324968566497162, 20.355393198629216, 20.3538041015466, 16.054194820423916, 15.675702830155686, 16.045865816374615, 23.111958548931085, 22.457488576571137, 22.964171428854257, 21.807693600654602, 22.199423912912607, 22.183939781039953, 25.888784586141497, 25.958836658547312, 25.476270804802567, 27.674679058293492, 28.132619297287107, 27.774912054340035, 33.40210175017515, 33.257031234602124, 33.79562667446831, 26.322607969244316, 25.91520396371682, 26.737900351484612, 22.451832282046468, 21.883254448572785, 21.894108007351548, 32.393333109716565, 32.496414080883056, 32.16659245888391, 28.200699793795735, 28.387000135534123, 27.772254864374787, 23.276904499158263, 22.951876245439053, 23.299136337824166, 23.242736627658203, 23.022157122691468, 23.656446904720113, 23.427104458212852, 22.633252322673798, 23.665438566356897, 13.200645461678505, 13.204685539007187, 12.5015919059515, 32.789474005500466, 32.51449062178531, 32.76542908201614, 23.20508703092733, 23.39357442657152, 23.502376000086457, 26.5030506538848, 26.31755885730186, 26.27144322792688, 21.035445966757834, 20.590137667953968, 19.989243537187576, 19.400796229640633, 19.00286854306856, 19.355991939703614, 30.15119001455605, 29.92219413816929, 30.16732307919301, 17.721834981503577, 17.716233011024684, 17.773931215206773, 21.24941171022752, 21.010705734292657, 20.78885545829931, 23.786288446436316, 23.810064050058514, 23.822451236347348, 21.665380530059338, 21.504294507205486, 21.901330405846238, 26.47086051603158, 27.061933179696396, 26.42397580047448, 27.649939566850662, 27.123393028974533, 27.62348672747612, 19.19779350111881, 18.94546807805696, 18.83200817803541, 26.423200731476143, 26.35893168797095, 26.81367651497324, 20.64178159514752, 19.995554154117897, 20.05583572139342, 23.03839622934659, 23.25436969225605, 23.389757068323277, 19.02162966504693, 18.625985711812973, 19.00015752017498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14140694137247212, "mean_inference_ms": 0.6459122732267898, "mean_action_processing_ms": 0.09501680372675401, "mean_env_wait_ms": 0.7952652246458723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 868800, "timesteps_this_iter": 0, "agent_timesteps_total": 2606400, "timers": {"sample_time_ms": 9405.958, "sample_throughput": 510.315, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1185.496, "learn_throughput": 4048.939, "update_time_ms": 1.604}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.311307847499847, "policy_loss": -0.0016565523405409621, "vf_loss": 6.472894072532654, "vf_explained_var": 0.00045533478260040283, "kl": 0.006086577166839612, "entropy": 16.023831486701965, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 868800, "num_agent_steps_sampled": 2606400, "num_steps_trained": 868800, "num_agent_steps_trained": 2606400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3825, "training_iteration": 181, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-10-56", "timestamp": 1706148656, "time_this_iter_s": 9.195816993713379, "time_total_s": 1694.67280960083, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BF5280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1694.67280960083, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 10.330769230769231, "ram_util_percent": 47.84615384615384}}
{"episode_reward_max": 102.81513182632624, "episode_reward_min": 38.90692290663719, "episode_reward_mean": 73.12409254200524, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.5015919059515}, "policy_reward_max": {"shared_policy": 34.33775827971597}, "policy_reward_mean": {"shared_policy": 24.37469751400174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.42802079592366, 55.43101095082238, 69.12350858375427, 68.93399417586622, 88.07013400271535, 55.55847443826495, 89.36905207671224, 82.3356720865704, 87.19258321076632, 79.60647492855787, 81.28311485424635, 82.75159323960543, 93.18867361545561, 62.187980424612746, 93.33805799111724, 78.96500632353124, 90.71015043929216, 63.95336357643828, 102.81513182632624, 66.09900370240209, 56.51960772648451, 67.93868410214782, 61.37434284389016, 39.00774673302655, 74.96017674263567, 70.21406567469238, 88.59538827463982, 76.98236511647698, 64.18949985131621, 43.330970837734625, 56.05010395590216, 78.88199545815586, 71.92552039399743, 65.8136935904622, 95.78667961200696, 75.31503637135026, 98.33547963574527, 79.90633610170335, 82.62934240698812, 68.42759065702558, 49.39605346322057, 60.39985025674103, 69.40861964039505, 76.29158972203732, 52.35225184552834, 82.40305695310234, 83.02723528817293, 95.8019429594278, 64.40254236757752, 79.59949102997777, 78.7597311446443, 75.63152018235996, 61.03416586667298, 47.77576346695422, 68.53361855435648, 66.19105729460716, 77.32389204949138, 83.58221040992063, 100.45475965924558, 78.97571228444575, 66.2291947379708, 97.05633964948353, 84.35995479370465, 69.52791708242148, 69.92134065506978, 69.72579534724355, 38.90692290663719, 98.06939370930192, 70.1010374575853, 79.09205273911354, 61.61482717189938, 57.759656712412806, 90.24070723191835, 53.21199920773503, 63.048972902819486, 71.41880373284218, 65.07100544311106, 79.95676949620245, 82.39681932330132, 56.97526975721118, 79.59580893442033, 60.69317147065884, 69.68252298992591, 56.64777289703488, 102.47522080317138, 52.46569328941402, 64.60426202043891, 83.85335607640444, 68.44947007298467, 69.1902316957712, 70.87091664224863, 65.54772571660578, 93.48558555543423, 55.241361588239656, 81.27046279003844, 94.07364659011363, 68.32794283330439, 52.78269295394419, 59.12847294751555, 92.46746450662613], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [29.309518195688725, 29.458358965814114, 29.66014363442082, 18.70860892953351, 18.486833333969116, 18.235568687319756, 23.0786224293212, 22.886515858272702, 23.15837029616037, 23.097707285235316, 22.61580043534437, 23.220486455286533, 29.18079648911953, 29.51458326354623, 29.37475425004959, 18.347960223754242, 18.640590885033205, 18.569923329477504, 29.509363179405526, 29.752175105114773, 30.107513792191938, 27.267785874505833, 27.679616570317492, 27.388269641747073, 28.979554429650307, 28.960085950791836, 29.252942830324173, 26.477388501167297, 26.563831701874733, 26.565254725515842, 27.07557541752854, 27.314723948637635, 26.892815488080174, 27.29276467859745, 27.66827367991209, 27.790554881095886, 31.464581732948616, 30.92821681996186, 30.795875062545136, 20.904361510028437, 20.59427126993735, 20.689347644646958, 31.372809793800116, 31.292854726314545, 30.67239347100258, 26.521383319670946, 26.21036012719074, 26.233262876669556, 30.508065989861876, 29.867034221688897, 30.33505022774139, 21.5945890173316, 20.647922083735466, 21.71085247537121, 34.25544963901241, 34.221923907597855, 34.33775827971597, 21.628679285446793, 22.051244924465806, 22.419079492489487, 18.78533975283304, 18.813750288138777, 18.920517685512692, 22.19696508347988, 22.7904154881835, 22.951303530484438, 20.47642898807922, 20.711351605753094, 20.186562250057847, 12.939499186972768, 12.926229237268359, 13.142018308785424, 24.537835657596588, 24.93859001994133, 25.48375106509775, 23.3364388992389, 23.688590088238314, 23.189036687215165, 29.604033468912036, 29.24322388569513, 29.74813092003265, 25.687409395972878, 25.65870916346708, 25.636246557037026, 21.40607612580061, 21.512777026742697, 21.270646698772907, 13.942587589224175, 14.647759775941566, 14.740623472568885, 18.16728486120701, 18.82855484634638, 19.054264248348773, 26.31859777619441, 26.032166202863053, 26.531231479098395, 24.36234077438712, 23.699660450220108, 23.8635191693902, 22.185023364921406, 22.04667878647645, 21.58199143906434, 32.41760914415741, 31.4738575319449, 31.895212935904652, 24.836805577079446, 25.005790668229253, 25.472440126041562, 32.66029058893521, 32.61659800012906, 33.058591046681, 26.140994876623154, 26.95642865728587, 26.808912567794323, 27.47201747323075, 27.53152963767448, 27.625795296082885, 23.214560475200415, 22.070268213748932, 23.14276196807623, 16.36035270492235, 16.45977776000896, 16.575922998289258, 20.143153920148805, 20.12395106380184, 20.132745272790388, 23.07084672898054, 22.864899307489395, 23.47287360392511, 25.294189125299454, 25.548031523823738, 25.449369072914124, 17.72915467414228, 17.27591737608114, 17.347179795304925, 27.13769257565339, 27.631925982733563, 27.633438394715384, 27.983184947321803, 27.382133478919656, 27.661916861931473, 32.031901496152074, 31.860170270005852, 31.90987119326988, 21.57166742781797, 21.440396728614957, 21.390478211144597, 26.532046834627778, 26.471047813693673, 26.59639638165632, 26.09851874162753, 26.536801142928496, 26.12441126008828, 25.523152567911893, 25.143973603844643, 24.964394010603428, 20.324968566497162, 20.355393198629216, 20.3538041015466, 16.054194820423916, 15.675702830155686, 16.045865816374615, 23.111958548931085, 22.457488576571137, 22.964171428854257, 21.807693600654602, 22.199423912912607, 22.183939781039953, 25.888784586141497, 25.958836658547312, 25.476270804802567, 27.674679058293492, 28.132619297287107, 27.774912054340035, 33.40210175017515, 33.257031234602124, 33.79562667446831, 26.322607969244316, 25.91520396371682, 26.737900351484612, 22.451832282046468, 21.883254448572785, 21.894108007351548, 32.393333109716565, 32.496414080883056, 32.16659245888391, 28.200699793795735, 28.387000135534123, 27.772254864374787, 23.276904499158263, 22.951876245439053, 23.299136337824166, 23.242736627658203, 23.022157122691468, 23.656446904720113, 23.427104458212852, 22.633252322673798, 23.665438566356897, 13.200645461678505, 13.204685539007187, 12.5015919059515, 32.789474005500466, 32.51449062178531, 32.76542908201614, 23.20508703092733, 23.39357442657152, 23.502376000086457, 26.5030506538848, 26.31755885730186, 26.27144322792688, 21.035445966757834, 20.590137667953968, 19.989243537187576, 19.400796229640633, 19.00286854306856, 19.355991939703614, 30.15119001455605, 29.92219413816929, 30.16732307919301, 17.721834981503577, 17.716233011024684, 17.773931215206773, 21.24941171022752, 21.010705734292657, 20.78885545829931, 23.786288446436316, 23.810064050058514, 23.822451236347348, 21.665380530059338, 21.504294507205486, 21.901330405846238, 26.47086051603158, 27.061933179696396, 26.42397580047448, 27.649939566850662, 27.123393028974533, 27.62348672747612, 19.19779350111881, 18.94546807805696, 18.83200817803541, 26.423200731476143, 26.35893168797095, 26.81367651497324, 20.64178159514752, 19.995554154117897, 20.05583572139342, 23.03839622934659, 23.25436969225605, 23.389757068323277, 19.02162966504693, 18.625985711812973, 19.00015752017498, 34.13534688142438, 34.253232146923736, 34.08664177482326, 17.421116443971783, 17.255073885122926, 17.78950296031931, 21.273520663380623, 21.610829643905163, 21.719911713153124, 27.88748576988776, 28.15648509872456, 27.80938520779212, 22.93441122646132, 22.566593701640755, 22.94846514488259, 23.405106646319226, 23.159856406350926, 22.62526864310105, 24.035533525049686, 23.501549929380417, 23.333833187818527, 21.853788439184427, 21.726240664720535, 21.96769661270082, 31.677368715405464, 31.030117630958557, 30.778099209070206, 18.740313050647572, 18.74341957022746, 17.757628967364624, 27.683549234177917, 26.591135889291763, 26.995777666568756, 31.45828356345494, 31.298280035456017, 31.317082991202668, 22.29940890272458, 22.74124941726525, 23.28728451331456, 17.720569678892687, 17.265287963052586, 17.79683531199892, 19.934736230410635, 19.50847005099058, 19.68526666611433, 30.57367615401745, 30.67287966609001, 31.22090868651867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14139756083560684, "mean_inference_ms": 0.646022531157929, "mean_action_processing_ms": 0.09502034081684375, "mean_env_wait_ms": 0.7952976635724744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 873600, "timesteps_this_iter": 0, "agent_timesteps_total": 2620800, "timers": {"sample_time_ms": 9451.193, "sample_throughput": 507.872, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1191.437, "learn_throughput": 4028.748, "update_time_ms": 1.504}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 5.784872114658356, "policy_loss": -0.0012688505537679085, "vf_loss": 5.945831596851349, "vf_explained_var": 0.006113976240158081, "kl": 0.009799410531108997, "entropy": 16.01872217655182, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 873600, "num_agent_steps_sampled": 2620800, "num_steps_trained": 873600, "num_agent_steps_trained": 2620800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3841, "training_iteration": 182, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-11-05", "timestamp": 1706148665, "time_this_iter_s": 9.76477861404419, "time_total_s": 1704.4375882148743, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1704.4375882148743, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 6.235714285714286, "ram_util_percent": 47.97857142857141}}
{"episode_reward_max": 107.47198906168342, "episode_reward_min": 37.213730750605436, "episode_reward_mean": 72.99211673451704, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.25285645077625}, "policy_reward_max": {"shared_policy": 36.09195387735963}, "policy_reward_mean": {"shared_policy": 24.330705578172342}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.71015043929216, 63.95336357643828, 102.81513182632624, 66.09900370240209, 56.51960772648451, 67.93868410214782, 61.37434284389016, 39.00774673302655, 74.96017674263567, 70.21406567469238, 88.59538827463982, 76.98236511647698, 64.18949985131621, 43.330970837734625, 56.05010395590216, 78.88199545815586, 71.92552039399743, 65.8136935904622, 95.78667961200696, 75.31503637135026, 98.33547963574527, 79.90633610170335, 82.62934240698812, 68.42759065702558, 49.39605346322057, 60.39985025674103, 69.40861964039505, 76.29158972203732, 52.35225184552834, 82.40305695310234, 83.02723528817293, 95.8019429594278, 64.40254236757752, 79.59949102997777, 78.7597311446443, 75.63152018235996, 61.03416586667298, 47.77576346695422, 68.53361855435648, 66.19105729460716, 77.32389204949138, 83.58221040992063, 100.45475965924558, 78.97571228444575, 66.2291947379708, 97.05633964948353, 84.35995479370465, 69.52791708242148, 69.92134065506978, 69.72579534724355, 38.90692290663719, 98.06939370930192, 70.1010374575853, 79.09205273911354, 61.61482717189938, 57.759656712412806, 90.24070723191835, 53.21199920773503, 63.048972902819486, 71.41880373284218, 65.07100544311106, 79.95676949620245, 82.39681932330132, 56.97526975721118, 79.59580893442033, 60.69317147065884, 69.68252298992591, 56.64777289703488, 102.47522080317138, 52.46569328941402, 64.60426202043891, 83.85335607640444, 68.44947007298467, 69.1902316957712, 70.87091664224863, 65.54772571660578, 93.48558555543423, 55.241361588239656, 81.27046279003844, 94.07364659011363, 68.32794283330439, 52.78269295394419, 59.12847294751555, 92.46746450662613, 73.33853809256104, 90.5794041957706, 82.50506123411466, 37.213730750605436, 78.119746979326, 77.83151442557573, 90.71868998371062, 62.8381844870746, 68.06305348128079, 107.47198906168342, 87.10616360930725, 82.12202465534209, 74.38521242304702, 80.27282850537446, 88.2055027037859, 61.794126361142816], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.508065989861876, 29.867034221688897, 30.33505022774139, 21.5945890173316, 20.647922083735466, 21.71085247537121, 34.25544963901241, 34.221923907597855, 34.33775827971597, 21.628679285446793, 22.051244924465806, 22.419079492489487, 18.78533975283304, 18.813750288138777, 18.920517685512692, 22.19696508347988, 22.7904154881835, 22.951303530484438, 20.47642898807922, 20.711351605753094, 20.186562250057847, 12.939499186972768, 12.926229237268359, 13.142018308785424, 24.537835657596588, 24.93859001994133, 25.48375106509775, 23.3364388992389, 23.688590088238314, 23.189036687215165, 29.604033468912036, 29.24322388569513, 29.74813092003265, 25.687409395972878, 25.65870916346708, 25.636246557037026, 21.40607612580061, 21.512777026742697, 21.270646698772907, 13.942587589224175, 14.647759775941566, 14.740623472568885, 18.16728486120701, 18.82855484634638, 19.054264248348773, 26.31859777619441, 26.032166202863053, 26.531231479098395, 24.36234077438712, 23.699660450220108, 23.8635191693902, 22.185023364921406, 22.04667878647645, 21.58199143906434, 32.41760914415741, 31.4738575319449, 31.895212935904652, 24.836805577079446, 25.005790668229253, 25.472440126041562, 32.66029058893521, 32.61659800012906, 33.058591046681, 26.140994876623154, 26.95642865728587, 26.808912567794323, 27.47201747323075, 27.53152963767448, 27.625795296082885, 23.214560475200415, 22.070268213748932, 23.14276196807623, 16.36035270492235, 16.45977776000896, 16.575922998289258, 20.143153920148805, 20.12395106380184, 20.132745272790388, 23.07084672898054, 22.864899307489395, 23.47287360392511, 25.294189125299454, 25.548031523823738, 25.449369072914124, 17.72915467414228, 17.27591737608114, 17.347179795304925, 27.13769257565339, 27.631925982733563, 27.633438394715384, 27.983184947321803, 27.382133478919656, 27.661916861931473, 32.031901496152074, 31.860170270005852, 31.90987119326988, 21.57166742781797, 21.440396728614957, 21.390478211144597, 26.532046834627778, 26.471047813693673, 26.59639638165632, 26.09851874162753, 26.536801142928496, 26.12441126008828, 25.523152567911893, 25.143973603844643, 24.964394010603428, 20.324968566497162, 20.355393198629216, 20.3538041015466, 16.054194820423916, 15.675702830155686, 16.045865816374615, 23.111958548931085, 22.457488576571137, 22.964171428854257, 21.807693600654602, 22.199423912912607, 22.183939781039953, 25.888784586141497, 25.958836658547312, 25.476270804802567, 27.674679058293492, 28.132619297287107, 27.774912054340035, 33.40210175017515, 33.257031234602124, 33.79562667446831, 26.322607969244316, 25.91520396371682, 26.737900351484612, 22.451832282046468, 21.883254448572785, 21.894108007351548, 32.393333109716565, 32.496414080883056, 32.16659245888391, 28.200699793795735, 28.387000135534123, 27.772254864374787, 23.276904499158263, 22.951876245439053, 23.299136337824166, 23.242736627658203, 23.022157122691468, 23.656446904720113, 23.427104458212852, 22.633252322673798, 23.665438566356897, 13.200645461678505, 13.204685539007187, 12.5015919059515, 32.789474005500466, 32.51449062178531, 32.76542908201614, 23.20508703092733, 23.39357442657152, 23.502376000086457, 26.5030506538848, 26.31755885730186, 26.27144322792688, 21.035445966757834, 20.590137667953968, 19.989243537187576, 19.400796229640633, 19.00286854306856, 19.355991939703614, 30.15119001455605, 29.92219413816929, 30.16732307919301, 17.721834981503577, 17.716233011024684, 17.773931215206773, 21.24941171022752, 21.010705734292657, 20.78885545829931, 23.786288446436316, 23.810064050058514, 23.822451236347348, 21.665380530059338, 21.504294507205486, 21.901330405846238, 26.47086051603158, 27.061933179696396, 26.42397580047448, 27.649939566850662, 27.123393028974533, 27.62348672747612, 19.19779350111881, 18.94546807805696, 18.83200817803541, 26.423200731476143, 26.35893168797095, 26.81367651497324, 20.64178159514752, 19.995554154117897, 20.05583572139342, 23.03839622934659, 23.25436969225605, 23.389757068323277, 19.02162966504693, 18.625985711812973, 19.00015752017498, 34.13534688142438, 34.253232146923736, 34.08664177482326, 17.421116443971783, 17.255073885122926, 17.78950296031931, 21.273520663380623, 21.610829643905163, 21.719911713153124, 27.88748576988776, 28.15648509872456, 27.80938520779212, 22.93441122646132, 22.566593701640755, 22.94846514488259, 23.405106646319226, 23.159856406350926, 22.62526864310105, 24.035533525049686, 23.501549929380417, 23.333833187818527, 21.853788439184427, 21.726240664720535, 21.96769661270082, 31.677368715405464, 31.030117630958557, 30.778099209070206, 18.740313050647572, 18.74341957022746, 17.757628967364624, 27.683549234177917, 26.591135889291763, 26.995777666568756, 31.45828356345494, 31.298280035456017, 31.317082991202668, 22.29940890272458, 22.74124941726525, 23.28728451331456, 17.720569678892687, 17.265287963052586, 17.79683531199892, 19.934736230410635, 19.50847005099058, 19.68526666611433, 30.57367615401745, 30.67287966609001, 31.22090868651867, 24.540356415013463, 24.642277866291494, 24.15590381125608, 30.08251915623744, 30.108345588048294, 30.388539451484874, 27.068680400649697, 27.819553246178344, 27.616827587286622, 12.25285645077625, 12.491351389015705, 12.469522910813481, 25.71187961598237, 26.311418020476893, 26.096449342866734, 26.132424108684063, 26.00325745344162, 25.69583286345005, 30.343623025963694, 29.95714611808458, 30.417920839662344, 20.89531737317641, 20.939758112033203, 21.003109001864985, 23.104841483136013, 22.796181102593735, 22.16203089555104, 35.53287287056446, 36.09195387735963, 35.84716231375933, 28.91980879878004, 29.128379921273634, 29.057974889253572, 27.28485060979922, 27.426170912881688, 27.41100313266118, 24.674215755114943, 24.870282941885904, 24.840713726046175, 26.338754455248505, 26.861308618138224, 27.072765431987733, 29.30175520479679, 29.45651687681675, 29.447230622172356, 20.534939202169568, 20.689793184554816, 20.569393974418432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14137114280169946, "mean_inference_ms": 0.6461431605028757, "mean_action_processing_ms": 0.09502751421222344, "mean_env_wait_ms": 0.795344513208392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 878400, "timesteps_this_iter": 0, "agent_timesteps_total": 2635200, "timers": {"sample_time_ms": 9468.105, "sample_throughput": 506.965, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1192.698, "learn_throughput": 4024.489, "update_time_ms": 1.604}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 7.32027131319046, "policy_loss": -0.001192841990462816, "vf_loss": 7.481218099594116, "vf_explained_var": 0.004883997142314911, "kl": 0.009066042548786624, "entropy": 16.02134358882904, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 878400, "num_agent_steps_sampled": 2635200, "num_steps_trained": 878400, "num_agent_steps_trained": 2635200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3857, "training_iteration": 183, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-11-15", "timestamp": 1706148675, "time_this_iter_s": 9.68927001953125, "time_total_s": 1714.1268582344055, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BFD0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1714.1268582344055, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 7.985714285714287, "ram_util_percent": 48.25000000000001}}
{"episode_reward_max": 107.47198906168342, "episode_reward_min": 37.213730750605436, "episode_reward_mean": 74.63065632957965, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.25285645077625}, "policy_reward_max": {"shared_policy": 36.09195387735963}, "policy_reward_mean": {"shared_policy": 24.876885443193213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.92552039399743, 65.8136935904622, 95.78667961200696, 75.31503637135026, 98.33547963574527, 79.90633610170335, 82.62934240698812, 68.42759065702558, 49.39605346322057, 60.39985025674103, 69.40861964039505, 76.29158972203732, 52.35225184552834, 82.40305695310234, 83.02723528817293, 95.8019429594278, 64.40254236757752, 79.59949102997777, 78.7597311446443, 75.63152018235996, 61.03416586667298, 47.77576346695422, 68.53361855435648, 66.19105729460716, 77.32389204949138, 83.58221040992063, 100.45475965924558, 78.97571228444575, 66.2291947379708, 97.05633964948353, 84.35995479370465, 69.52791708242148, 69.92134065506978, 69.72579534724355, 38.90692290663719, 98.06939370930192, 70.1010374575853, 79.09205273911354, 61.61482717189938, 57.759656712412806, 90.24070723191835, 53.21199920773503, 63.048972902819486, 71.41880373284218, 65.07100544311106, 79.95676949620245, 82.39681932330132, 56.97526975721118, 79.59580893442033, 60.69317147065884, 69.68252298992591, 56.64777289703488, 102.47522080317138, 52.46569328941402, 64.60426202043891, 83.85335607640444, 68.44947007298467, 69.1902316957712, 70.87091664224863, 65.54772571660578, 93.48558555543423, 55.241361588239656, 81.27046279003844, 94.07364659011363, 68.32794283330439, 52.78269295394419, 59.12847294751555, 92.46746450662613, 73.33853809256104, 90.5794041957706, 82.50506123411466, 37.213730750605436, 78.119746979326, 77.83151442557573, 90.71868998371062, 62.8381844870746, 68.06305348128079, 107.47198906168342, 87.10616360930725, 82.12202465534209, 74.38521242304702, 80.27282850537446, 88.2055027037859, 61.794126361142816, 94.26092447899282, 81.95446965098378, 66.79005343653259, 90.23921755142509, 76.45342819951472, 79.7042788809631, 78.25189752364531, 94.85957223922014, 83.89732243306935, 59.10065776109694, 83.86728822952135, 56.46998886391518, 91.46278408914803, 69.93422414548695, 79.76163314096627, 78.4688157433411], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.36234077438712, 23.699660450220108, 23.8635191693902, 22.185023364921406, 22.04667878647645, 21.58199143906434, 32.41760914415741, 31.4738575319449, 31.895212935904652, 24.836805577079446, 25.005790668229253, 25.472440126041562, 32.66029058893521, 32.61659800012906, 33.058591046681, 26.140994876623154, 26.95642865728587, 26.808912567794323, 27.47201747323075, 27.53152963767448, 27.625795296082885, 23.214560475200415, 22.070268213748932, 23.14276196807623, 16.36035270492235, 16.45977776000896, 16.575922998289258, 20.143153920148805, 20.12395106380184, 20.132745272790388, 23.07084672898054, 22.864899307489395, 23.47287360392511, 25.294189125299454, 25.548031523823738, 25.449369072914124, 17.72915467414228, 17.27591737608114, 17.347179795304925, 27.13769257565339, 27.631925982733563, 27.633438394715384, 27.983184947321803, 27.382133478919656, 27.661916861931473, 32.031901496152074, 31.860170270005852, 31.90987119326988, 21.57166742781797, 21.440396728614957, 21.390478211144597, 26.532046834627778, 26.471047813693673, 26.59639638165632, 26.09851874162753, 26.536801142928496, 26.12441126008828, 25.523152567911893, 25.143973603844643, 24.964394010603428, 20.324968566497162, 20.355393198629216, 20.3538041015466, 16.054194820423916, 15.675702830155686, 16.045865816374615, 23.111958548931085, 22.457488576571137, 22.964171428854257, 21.807693600654602, 22.199423912912607, 22.183939781039953, 25.888784586141497, 25.958836658547312, 25.476270804802567, 27.674679058293492, 28.132619297287107, 27.774912054340035, 33.40210175017515, 33.257031234602124, 33.79562667446831, 26.322607969244316, 25.91520396371682, 26.737900351484612, 22.451832282046468, 21.883254448572785, 21.894108007351548, 32.393333109716565, 32.496414080883056, 32.16659245888391, 28.200699793795735, 28.387000135534123, 27.772254864374787, 23.276904499158263, 22.951876245439053, 23.299136337824166, 23.242736627658203, 23.022157122691468, 23.656446904720113, 23.427104458212852, 22.633252322673798, 23.665438566356897, 13.200645461678505, 13.204685539007187, 12.5015919059515, 32.789474005500466, 32.51449062178531, 32.76542908201614, 23.20508703092733, 23.39357442657152, 23.502376000086457, 26.5030506538848, 26.31755885730186, 26.27144322792688, 21.035445966757834, 20.590137667953968, 19.989243537187576, 19.400796229640633, 19.00286854306856, 19.355991939703614, 30.15119001455605, 29.92219413816929, 30.16732307919301, 17.721834981503577, 17.716233011024684, 17.773931215206773, 21.24941171022752, 21.010705734292657, 20.78885545829931, 23.786288446436316, 23.810064050058514, 23.822451236347348, 21.665380530059338, 21.504294507205486, 21.901330405846238, 26.47086051603158, 27.061933179696396, 26.42397580047448, 27.649939566850662, 27.123393028974533, 27.62348672747612, 19.19779350111881, 18.94546807805696, 18.83200817803541, 26.423200731476143, 26.35893168797095, 26.81367651497324, 20.64178159514752, 19.995554154117897, 20.05583572139342, 23.03839622934659, 23.25436969225605, 23.389757068323277, 19.02162966504693, 18.625985711812973, 19.00015752017498, 34.13534688142438, 34.253232146923736, 34.08664177482326, 17.421116443971783, 17.255073885122926, 17.78950296031931, 21.273520663380623, 21.610829643905163, 21.719911713153124, 27.88748576988776, 28.15648509872456, 27.80938520779212, 22.93441122646132, 22.566593701640755, 22.94846514488259, 23.405106646319226, 23.159856406350926, 22.62526864310105, 24.035533525049686, 23.501549929380417, 23.333833187818527, 21.853788439184427, 21.726240664720535, 21.96769661270082, 31.677368715405464, 31.030117630958557, 30.778099209070206, 18.740313050647572, 18.74341957022746, 17.757628967364624, 27.683549234177917, 26.591135889291763, 26.995777666568756, 31.45828356345494, 31.298280035456017, 31.317082991202668, 22.29940890272458, 22.74124941726525, 23.28728451331456, 17.720569678892687, 17.265287963052586, 17.79683531199892, 19.934736230410635, 19.50847005099058, 19.68526666611433, 30.57367615401745, 30.67287966609001, 31.22090868651867, 24.540356415013463, 24.642277866291494, 24.15590381125608, 30.08251915623744, 30.108345588048294, 30.388539451484874, 27.068680400649697, 27.819553246178344, 27.616827587286622, 12.25285645077625, 12.491351389015705, 12.469522910813481, 25.71187961598237, 26.311418020476893, 26.096449342866734, 26.132424108684063, 26.00325745344162, 25.69583286345005, 30.343623025963694, 29.95714611808458, 30.417920839662344, 20.89531737317641, 20.939758112033203, 21.003109001864985, 23.104841483136013, 22.796181102593735, 22.16203089555104, 35.53287287056446, 36.09195387735963, 35.84716231375933, 28.91980879878004, 29.128379921273634, 29.057974889253572, 27.28485060979922, 27.426170912881688, 27.41100313266118, 24.674215755114943, 24.870282941885904, 24.840713726046175, 26.338754455248505, 26.861308618138224, 27.072765431987733, 29.30175520479679, 29.45651687681675, 29.447230622172356, 20.534939202169568, 20.689793184554816, 20.569393974418432, 31.502292243763804, 31.27305819094181, 31.485574044287205, 27.346373091141373, 27.807724664608628, 26.80037189523378, 22.360164598251373, 22.241611323008925, 22.18827751527229, 29.985438597699, 30.285047388946012, 29.96873156478007, 25.34981010357538, 25.01732466618219, 26.08629342975715, 26.684064593282528, 26.336879022419453, 26.68333526526112, 25.9670175537467, 25.877087518572807, 26.407792451325804, 31.55750174075365, 31.591523960232735, 31.710546538233757, 28.116903031244874, 27.956390731036663, 27.82402867078781, 19.75929098327954, 19.757629205783203, 19.583737572034195, 27.621661250789955, 28.24492343779032, 28.000703540941075, 18.869155863920838, 18.795748469109327, 18.80508453088501, 30.42955495913823, 30.343989511330918, 30.689239618678883, 23.070669777691364, 23.460450114682317, 23.40310425311327, 26.614673151324183, 26.768841263527662, 26.378118726114423, 26.754556541059472, 26.197653358181313, 25.51660584410031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14133658657036605, "mean_inference_ms": 0.6462408845028104, "mean_action_processing_ms": 0.09503683958121087, "mean_env_wait_ms": 0.7953711520626661, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 883200, "timesteps_this_iter": 0, "agent_timesteps_total": 2649600, "timers": {"sample_time_ms": 9468.609, "sample_throughput": 506.938, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1193.899, "learn_throughput": 4020.442, "update_time_ms": 1.604}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 7.844293177127838, "policy_loss": -0.0005138233990873431, "vf_loss": 8.003134310245514, "vf_explained_var": 0.002346813678741455, "kl": 0.010022994946025566, "entropy": 15.883518099784851, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 883200, "num_agent_steps_sampled": 2649600, "num_steps_trained": 883200, "num_agent_steps_trained": 2649600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3873, "training_iteration": 184, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-11-25", "timestamp": 1706148685, "time_this_iter_s": 9.29297137260437, "time_total_s": 1723.41982960701, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015CBA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1723.41982960701, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 9.053846153846154, "ram_util_percent": 48.05384615384616}}
{"episode_reward_max": 107.47198906168342, "episode_reward_min": 37.213730750605436, "episode_reward_mean": 75.49663587412098, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.25285645077625}, "policy_reward_max": {"shared_policy": 36.20507412403822}, "policy_reward_mean": {"shared_policy": 25.165545291373654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.40254236757752, 79.59949102997777, 78.7597311446443, 75.63152018235996, 61.03416586667298, 47.77576346695422, 68.53361855435648, 66.19105729460716, 77.32389204949138, 83.58221040992063, 100.45475965924558, 78.97571228444575, 66.2291947379708, 97.05633964948353, 84.35995479370465, 69.52791708242148, 69.92134065506978, 69.72579534724355, 38.90692290663719, 98.06939370930192, 70.1010374575853, 79.09205273911354, 61.61482717189938, 57.759656712412806, 90.24070723191835, 53.21199920773503, 63.048972902819486, 71.41880373284218, 65.07100544311106, 79.95676949620245, 82.39681932330132, 56.97526975721118, 79.59580893442033, 60.69317147065884, 69.68252298992591, 56.64777289703488, 102.47522080317138, 52.46569328941402, 64.60426202043891, 83.85335607640444, 68.44947007298467, 69.1902316957712, 70.87091664224863, 65.54772571660578, 93.48558555543423, 55.241361588239656, 81.27046279003844, 94.07364659011363, 68.32794283330439, 52.78269295394419, 59.12847294751555, 92.46746450662613, 73.33853809256104, 90.5794041957706, 82.50506123411466, 37.213730750605436, 78.119746979326, 77.83151442557573, 90.71868998371062, 62.8381844870746, 68.06305348128079, 107.47198906168342, 87.10616360930725, 82.12202465534209, 74.38521242304702, 80.27282850537446, 88.2055027037859, 61.794126361142816, 94.26092447899282, 81.95446965098378, 66.79005343653259, 90.23921755142509, 76.45342819951472, 79.7042788809631, 78.25189752364531, 94.85957223922014, 83.89732243306935, 59.10065776109694, 83.86728822952135, 56.46998886391518, 91.46278408914803, 69.93422414548695, 79.76163314096627, 78.4688157433411, 95.71329035609958, 82.28849387913942, 93.89975967630744, 75.36559764295815, 102.18616169691084, 82.84581427648662, 91.32298602536318, 76.62575583159922, 53.129041763953865, 73.26711353845891, 61.61683679372072, 107.4335148409009, 88.57530370354651, 70.2863975026412, 82.51544168032704, 56.74672414362428], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.57166742781797, 21.440396728614957, 21.390478211144597, 26.532046834627778, 26.471047813693673, 26.59639638165632, 26.09851874162753, 26.536801142928496, 26.12441126008828, 25.523152567911893, 25.143973603844643, 24.964394010603428, 20.324968566497162, 20.355393198629216, 20.3538041015466, 16.054194820423916, 15.675702830155686, 16.045865816374615, 23.111958548931085, 22.457488576571137, 22.964171428854257, 21.807693600654602, 22.199423912912607, 22.183939781039953, 25.888784586141497, 25.958836658547312, 25.476270804802567, 27.674679058293492, 28.132619297287107, 27.774912054340035, 33.40210175017515, 33.257031234602124, 33.79562667446831, 26.322607969244316, 25.91520396371682, 26.737900351484612, 22.451832282046468, 21.883254448572785, 21.894108007351548, 32.393333109716565, 32.496414080883056, 32.16659245888391, 28.200699793795735, 28.387000135534123, 27.772254864374787, 23.276904499158263, 22.951876245439053, 23.299136337824166, 23.242736627658203, 23.022157122691468, 23.656446904720113, 23.427104458212852, 22.633252322673798, 23.665438566356897, 13.200645461678505, 13.204685539007187, 12.5015919059515, 32.789474005500466, 32.51449062178531, 32.76542908201614, 23.20508703092733, 23.39357442657152, 23.502376000086457, 26.5030506538848, 26.31755885730186, 26.27144322792688, 21.035445966757834, 20.590137667953968, 19.989243537187576, 19.400796229640633, 19.00286854306856, 19.355991939703614, 30.15119001455605, 29.92219413816929, 30.16732307919301, 17.721834981503577, 17.716233011024684, 17.773931215206773, 21.24941171022752, 21.010705734292657, 20.78885545829931, 23.786288446436316, 23.810064050058514, 23.822451236347348, 21.665380530059338, 21.504294507205486, 21.901330405846238, 26.47086051603158, 27.061933179696396, 26.42397580047448, 27.649939566850662, 27.123393028974533, 27.62348672747612, 19.19779350111881, 18.94546807805696, 18.83200817803541, 26.423200731476143, 26.35893168797095, 26.81367651497324, 20.64178159514752, 19.995554154117897, 20.05583572139342, 23.03839622934659, 23.25436969225605, 23.389757068323277, 19.02162966504693, 18.625985711812973, 19.00015752017498, 34.13534688142438, 34.253232146923736, 34.08664177482326, 17.421116443971783, 17.255073885122926, 17.78950296031931, 21.273520663380623, 21.610829643905163, 21.719911713153124, 27.88748576988776, 28.15648509872456, 27.80938520779212, 22.93441122646132, 22.566593701640755, 22.94846514488259, 23.405106646319226, 23.159856406350926, 22.62526864310105, 24.035533525049686, 23.501549929380417, 23.333833187818527, 21.853788439184427, 21.726240664720535, 21.96769661270082, 31.677368715405464, 31.030117630958557, 30.778099209070206, 18.740313050647572, 18.74341957022746, 17.757628967364624, 27.683549234177917, 26.591135889291763, 26.995777666568756, 31.45828356345494, 31.298280035456017, 31.317082991202668, 22.29940890272458, 22.74124941726525, 23.28728451331456, 17.720569678892687, 17.265287963052586, 17.79683531199892, 19.934736230410635, 19.50847005099058, 19.68526666611433, 30.57367615401745, 30.67287966609001, 31.22090868651867, 24.540356415013463, 24.642277866291494, 24.15590381125608, 30.08251915623744, 30.108345588048294, 30.388539451484874, 27.068680400649697, 27.819553246178344, 27.616827587286622, 12.25285645077625, 12.491351389015705, 12.469522910813481, 25.71187961598237, 26.311418020476893, 26.096449342866734, 26.132424108684063, 26.00325745344162, 25.69583286345005, 30.343623025963694, 29.95714611808458, 30.417920839662344, 20.89531737317641, 20.939758112033203, 21.003109001864985, 23.104841483136013, 22.796181102593735, 22.16203089555104, 35.53287287056446, 36.09195387735963, 35.84716231375933, 28.91980879878004, 29.128379921273634, 29.057974889253572, 27.28485060979922, 27.426170912881688, 27.41100313266118, 24.674215755114943, 24.870282941885904, 24.840713726046175, 26.338754455248505, 26.861308618138224, 27.072765431987733, 29.30175520479679, 29.45651687681675, 29.447230622172356, 20.534939202169568, 20.689793184554816, 20.569393974418432, 31.502292243763804, 31.27305819094181, 31.485574044287205, 27.346373091141373, 27.807724664608628, 26.80037189523378, 22.360164598251373, 22.241611323008925, 22.18827751527229, 29.985438597699, 30.285047388946012, 29.96873156478007, 25.34981010357538, 25.01732466618219, 26.08629342975715, 26.684064593282528, 26.336879022419453, 26.68333526526112, 25.9670175537467, 25.877087518572807, 26.407792451325804, 31.55750174075365, 31.591523960232735, 31.710546538233757, 28.116903031244874, 27.956390731036663, 27.82402867078781, 19.75929098327954, 19.757629205783203, 19.583737572034195, 27.621661250789955, 28.24492343779032, 28.000703540941075, 18.869155863920838, 18.795748469109327, 18.80508453088501, 30.42955495913823, 30.343989511330918, 30.689239618678883, 23.070669777691364, 23.460450114682317, 23.40310425311327, 26.614673151324183, 26.768841263527662, 26.378118726114423, 26.754556541059472, 26.197653358181313, 25.51660584410031, 32.08229761819044, 31.639602484802396, 31.991390253106744, 27.369677558541298, 27.35796695947647, 27.560849361121655, 31.191501073539257, 31.44798144325614, 31.260277159512043, 24.985726096977785, 25.24257506554325, 25.137296480437115, 34.02329257627328, 34.04125488301118, 34.12161423762639, 27.801413254191473, 27.42298390467961, 27.621417117615536, 30.521295222143323, 30.595861247430236, 30.20582955578962, 25.641134043534592, 25.823578794797257, 25.161042993267372, 18.177051196806133, 17.79407962411642, 17.15791094303131, 24.894190129513532, 24.131747434536607, 24.241175974408776, 20.37333407998085, 20.570755131542683, 20.67274758219719, 35.5008879005909, 36.20507412403822, 35.72755281627178, 29.503461023171738, 29.66850062211354, 29.40334205826123, 23.497620671987534, 22.822090089321136, 23.966686741332524, 27.64312685405214, 27.10964373250802, 27.762671093766883, 19.180812428394944, 19.18752786020437, 18.378383855024964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14131055019007166, "mean_inference_ms": 0.6463124453735415, "mean_action_processing_ms": 0.0950524512597579, "mean_env_wait_ms": 0.7953712176491211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 888000, "timesteps_this_iter": 0, "agent_timesteps_total": 2664000, "timers": {"sample_time_ms": 9423.839, "sample_throughput": 509.347, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1195.199, "learn_throughput": 4016.069, "update_time_ms": 1.704}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 8.405886173248291, "policy_loss": -0.0011239794076312037, "vf_loss": 8.56760323047638, "vf_explained_var": 0.000954553484916687, "kl": 0.008415244869233321, "entropy": 16.101953983306885, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 888000, "num_agent_steps_sampled": 2664000, "num_steps_trained": 888000, "num_agent_steps_trained": 2664000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3889, "training_iteration": 185, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-11-34", "timestamp": 1706148694, "time_this_iter_s": 9.158826112747192, "time_total_s": 1732.578655719757, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632F9940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1732.578655719757, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 8.061538461538461, "ram_util_percent": 47.9923076923077}}
{"episode_reward_max": 119.40327837504444, "episode_reward_min": 37.213730750605436, "episode_reward_mean": 75.11049106164253, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.25285645077625}, "policy_reward_max": {"shared_policy": 39.908659043411404}, "policy_reward_mean": {"shared_policy": 25.036830353880838}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.92134065506978, 69.72579534724355, 38.90692290663719, 98.06939370930192, 70.1010374575853, 79.09205273911354, 61.61482717189938, 57.759656712412806, 90.24070723191835, 53.21199920773503, 63.048972902819486, 71.41880373284218, 65.07100544311106, 79.95676949620245, 82.39681932330132, 56.97526975721118, 79.59580893442033, 60.69317147065884, 69.68252298992591, 56.64777289703488, 102.47522080317138, 52.46569328941402, 64.60426202043891, 83.85335607640444, 68.44947007298467, 69.1902316957712, 70.87091664224863, 65.54772571660578, 93.48558555543423, 55.241361588239656, 81.27046279003844, 94.07364659011363, 68.32794283330439, 52.78269295394419, 59.12847294751555, 92.46746450662613, 73.33853809256104, 90.5794041957706, 82.50506123411466, 37.213730750605436, 78.119746979326, 77.83151442557573, 90.71868998371062, 62.8381844870746, 68.06305348128079, 107.47198906168342, 87.10616360930725, 82.12202465534209, 74.38521242304702, 80.27282850537446, 88.2055027037859, 61.794126361142816, 94.26092447899282, 81.95446965098378, 66.79005343653259, 90.23921755142509, 76.45342819951472, 79.7042788809631, 78.25189752364531, 94.85957223922014, 83.89732243306935, 59.10065776109694, 83.86728822952135, 56.46998886391518, 91.46278408914803, 69.93422414548695, 79.76163314096627, 78.4688157433411, 95.71329035609958, 82.28849387913942, 93.89975967630744, 75.36559764295815, 102.18616169691084, 82.84581427648662, 91.32298602536318, 76.62575583159922, 53.129041763953865, 73.26711353845891, 61.61683679372072, 107.4335148409009, 88.57530370354651, 70.2863975026412, 82.51544168032704, 56.74672414362428, 48.9417008459568, 72.48850980866698, 71.59662011265752, 80.65210429765284, 119.40327837504444, 84.11312177963552, 77.79755444824693, 60.89829610846935, 70.31771022640166, 45.99800308048725, 45.56179975392297, 81.34073547832666, 87.73514801636335, 80.56417581718414, 67.85456535592675, 65.56006582104601], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.242736627658203, 23.022157122691468, 23.656446904720113, 23.427104458212852, 22.633252322673798, 23.665438566356897, 13.200645461678505, 13.204685539007187, 12.5015919059515, 32.789474005500466, 32.51449062178531, 32.76542908201614, 23.20508703092733, 23.39357442657152, 23.502376000086457, 26.5030506538848, 26.31755885730186, 26.27144322792688, 21.035445966757834, 20.590137667953968, 19.989243537187576, 19.400796229640633, 19.00286854306856, 19.355991939703614, 30.15119001455605, 29.92219413816929, 30.16732307919301, 17.721834981503577, 17.716233011024684, 17.773931215206773, 21.24941171022752, 21.010705734292657, 20.78885545829931, 23.786288446436316, 23.810064050058514, 23.822451236347348, 21.665380530059338, 21.504294507205486, 21.901330405846238, 26.47086051603158, 27.061933179696396, 26.42397580047448, 27.649939566850662, 27.123393028974533, 27.62348672747612, 19.19779350111881, 18.94546807805696, 18.83200817803541, 26.423200731476143, 26.35893168797095, 26.81367651497324, 20.64178159514752, 19.995554154117897, 20.05583572139342, 23.03839622934659, 23.25436969225605, 23.389757068323277, 19.02162966504693, 18.625985711812973, 19.00015752017498, 34.13534688142438, 34.253232146923736, 34.08664177482326, 17.421116443971783, 17.255073885122926, 17.78950296031931, 21.273520663380623, 21.610829643905163, 21.719911713153124, 27.88748576988776, 28.15648509872456, 27.80938520779212, 22.93441122646132, 22.566593701640755, 22.94846514488259, 23.405106646319226, 23.159856406350926, 22.62526864310105, 24.035533525049686, 23.501549929380417, 23.333833187818527, 21.853788439184427, 21.726240664720535, 21.96769661270082, 31.677368715405464, 31.030117630958557, 30.778099209070206, 18.740313050647572, 18.74341957022746, 17.757628967364624, 27.683549234177917, 26.591135889291763, 26.995777666568756, 31.45828356345494, 31.298280035456017, 31.317082991202668, 22.29940890272458, 22.74124941726525, 23.28728451331456, 17.720569678892687, 17.265287963052586, 17.79683531199892, 19.934736230410635, 19.50847005099058, 19.68526666611433, 30.57367615401745, 30.67287966609001, 31.22090868651867, 24.540356415013463, 24.642277866291494, 24.15590381125608, 30.08251915623744, 30.108345588048294, 30.388539451484874, 27.068680400649697, 27.819553246178344, 27.616827587286622, 12.25285645077625, 12.491351389015705, 12.469522910813481, 25.71187961598237, 26.311418020476893, 26.096449342866734, 26.132424108684063, 26.00325745344162, 25.69583286345005, 30.343623025963694, 29.95714611808458, 30.417920839662344, 20.89531737317641, 20.939758112033203, 21.003109001864985, 23.104841483136013, 22.796181102593735, 22.16203089555104, 35.53287287056446, 36.09195387735963, 35.84716231375933, 28.91980879878004, 29.128379921273634, 29.057974889253572, 27.28485060979922, 27.426170912881688, 27.41100313266118, 24.674215755114943, 24.870282941885904, 24.840713726046175, 26.338754455248505, 26.861308618138224, 27.072765431987733, 29.30175520479679, 29.45651687681675, 29.447230622172356, 20.534939202169568, 20.689793184554816, 20.569393974418432, 31.502292243763804, 31.27305819094181, 31.485574044287205, 27.346373091141373, 27.807724664608628, 26.80037189523378, 22.360164598251373, 22.241611323008925, 22.18827751527229, 29.985438597699, 30.285047388946012, 29.96873156478007, 25.34981010357538, 25.01732466618219, 26.08629342975715, 26.684064593282528, 26.336879022419453, 26.68333526526112, 25.9670175537467, 25.877087518572807, 26.407792451325804, 31.55750174075365, 31.591523960232735, 31.710546538233757, 28.116903031244874, 27.956390731036663, 27.82402867078781, 19.75929098327954, 19.757629205783203, 19.583737572034195, 27.621661250789955, 28.24492343779032, 28.000703540941075, 18.869155863920838, 18.795748469109327, 18.80508453088501, 30.42955495913823, 30.343989511330918, 30.689239618678883, 23.070669777691364, 23.460450114682317, 23.40310425311327, 26.614673151324183, 26.768841263527662, 26.378118726114423, 26.754556541059472, 26.197653358181313, 25.51660584410031, 32.08229761819044, 31.639602484802396, 31.991390253106744, 27.369677558541298, 27.35796695947647, 27.560849361121655, 31.191501073539257, 31.44798144325614, 31.260277159512043, 24.985726096977785, 25.24257506554325, 25.137296480437115, 34.02329257627328, 34.04125488301118, 34.12161423762639, 27.801413254191473, 27.42298390467961, 27.621417117615536, 30.521295222143323, 30.595861247430236, 30.20582955578962, 25.641134043534592, 25.823578794797257, 25.161042993267372, 18.177051196806133, 17.79407962411642, 17.15791094303131, 24.894190129513532, 24.131747434536607, 24.241175974408776, 20.37333407998085, 20.570755131542683, 20.67274758219719, 35.5008879005909, 36.20507412403822, 35.72755281627178, 29.503461023171738, 29.66850062211354, 29.40334205826123, 23.497620671987534, 22.822090089321136, 23.966686741332524, 27.64312685405214, 27.10964373250802, 27.762671093766883, 19.180812428394944, 19.18752786020437, 18.378383855024964, 16.509758710861206, 16.618106618523598, 15.813835516571999, 24.074309113124997, 24.235413636701793, 24.178787058840186, 23.869222710529954, 24.170040572683007, 23.557356829444558, 26.893556114286184, 26.899881303310394, 26.858666880056262, 39.908659043411404, 39.59053150812784, 39.90408782350519, 28.118378930414707, 27.882631952563912, 28.1121108966569, 25.700111816326768, 26.018265316883713, 26.079177315036446, 20.21140057345231, 20.392477444683507, 20.294418090333536, 23.588095207388193, 23.317569794754178, 23.412045224259288, 15.736665070056915, 14.919078588485718, 15.342259421944618, 14.949797317385674, 15.530225534457713, 15.081776902079582, 27.174210566406444, 27.08924577509363, 27.07727913682659, 29.183091862748057, 29.233623842398316, 29.31843231121698, 26.89937141289313, 27.10023090274383, 26.564573501547173, 22.405239067971706, 22.739540193229914, 22.709786094725132, 21.943420497700572, 21.546808294951916, 22.069837028393522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1412871380137314, "mean_inference_ms": 0.646393884653961, "mean_action_processing_ms": 0.09506705624173359, "mean_env_wait_ms": 0.7953736444848293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 892800, "timesteps_this_iter": 0, "agent_timesteps_total": 2678400, "timers": {"sample_time_ms": 9407.053, "sample_throughput": 510.255, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1201.294, "learn_throughput": 3995.693, "update_time_ms": 1.803}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.890575051307678, "policy_loss": -0.0002964648278935833, "vf_loss": 7.050445139408112, "vf_explained_var": 0.003430604934692383, "kl": 0.009439874673536599, "entropy": 16.005197882652283, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 892800, "num_agent_steps_sampled": 2678400, "num_steps_trained": 892800, "num_agent_steps_trained": 2678400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3905, "training_iteration": 186, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-11-43", "timestamp": 1706148703, "time_this_iter_s": 9.223154544830322, "time_total_s": 1741.8018102645874, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015CB820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1741.8018102645874, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 7.976923076923078, "ram_util_percent": 48.0}}
{"episode_reward_max": 119.40327837504444, "episode_reward_min": 37.213730750605436, "episode_reward_mean": 74.8421755123377, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.25285645077625}, "policy_reward_max": {"shared_policy": 39.908659043411404}, "policy_reward_mean": {"shared_policy": 24.947391837445895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.59580893442033, 60.69317147065884, 69.68252298992591, 56.64777289703488, 102.47522080317138, 52.46569328941402, 64.60426202043891, 83.85335607640444, 68.44947007298467, 69.1902316957712, 70.87091664224863, 65.54772571660578, 93.48558555543423, 55.241361588239656, 81.27046279003844, 94.07364659011363, 68.32794283330439, 52.78269295394419, 59.12847294751555, 92.46746450662613, 73.33853809256104, 90.5794041957706, 82.50506123411466, 37.213730750605436, 78.119746979326, 77.83151442557573, 90.71868998371062, 62.8381844870746, 68.06305348128079, 107.47198906168342, 87.10616360930725, 82.12202465534209, 74.38521242304702, 80.27282850537446, 88.2055027037859, 61.794126361142816, 94.26092447899282, 81.95446965098378, 66.79005343653259, 90.23921755142509, 76.45342819951472, 79.7042788809631, 78.25189752364531, 94.85957223922014, 83.89732243306935, 59.10065776109694, 83.86728822952135, 56.46998886391518, 91.46278408914803, 69.93422414548695, 79.76163314096627, 78.4688157433411, 95.71329035609958, 82.28849387913942, 93.89975967630744, 75.36559764295815, 102.18616169691084, 82.84581427648662, 91.32298602536318, 76.62575583159922, 53.129041763953865, 73.26711353845891, 61.61683679372072, 107.4335148409009, 88.57530370354651, 70.2863975026412, 82.51544168032704, 56.74672414362428, 48.9417008459568, 72.48850980866698, 71.59662011265752, 80.65210429765284, 119.40327837504444, 84.11312177963552, 77.79755444824693, 60.89829610846935, 70.31771022640166, 45.99800308048725, 45.56179975392297, 81.34073547832666, 87.73514801636335, 80.56417581718414, 67.85456535592675, 65.56006582104601, 68.012122397311, 68.82892145216465, 63.13631442934273, 64.88483623415229, 68.34154964610934, 57.07110004872081, 81.15691654756662, 62.8404996320605, 79.35228854324669, 87.60421019652858, 66.45049348473547, 68.55850266106425, 70.49683011416343, 42.20520887523888, 73.30713630229002, 58.43288829922676], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.423200731476143, 26.35893168797095, 26.81367651497324, 20.64178159514752, 19.995554154117897, 20.05583572139342, 23.03839622934659, 23.25436969225605, 23.389757068323277, 19.02162966504693, 18.625985711812973, 19.00015752017498, 34.13534688142438, 34.253232146923736, 34.08664177482326, 17.421116443971783, 17.255073885122926, 17.78950296031931, 21.273520663380623, 21.610829643905163, 21.719911713153124, 27.88748576988776, 28.15648509872456, 27.80938520779212, 22.93441122646132, 22.566593701640755, 22.94846514488259, 23.405106646319226, 23.159856406350926, 22.62526864310105, 24.035533525049686, 23.501549929380417, 23.333833187818527, 21.853788439184427, 21.726240664720535, 21.96769661270082, 31.677368715405464, 31.030117630958557, 30.778099209070206, 18.740313050647572, 18.74341957022746, 17.757628967364624, 27.683549234177917, 26.591135889291763, 26.995777666568756, 31.45828356345494, 31.298280035456017, 31.317082991202668, 22.29940890272458, 22.74124941726525, 23.28728451331456, 17.720569678892687, 17.265287963052586, 17.79683531199892, 19.934736230410635, 19.50847005099058, 19.68526666611433, 30.57367615401745, 30.67287966609001, 31.22090868651867, 24.540356415013463, 24.642277866291494, 24.15590381125608, 30.08251915623744, 30.108345588048294, 30.388539451484874, 27.068680400649697, 27.819553246178344, 27.616827587286622, 12.25285645077625, 12.491351389015705, 12.469522910813481, 25.71187961598237, 26.311418020476893, 26.096449342866734, 26.132424108684063, 26.00325745344162, 25.69583286345005, 30.343623025963694, 29.95714611808458, 30.417920839662344, 20.89531737317641, 20.939758112033203, 21.003109001864985, 23.104841483136013, 22.796181102593735, 22.16203089555104, 35.53287287056446, 36.09195387735963, 35.84716231375933, 28.91980879878004, 29.128379921273634, 29.057974889253572, 27.28485060979922, 27.426170912881688, 27.41100313266118, 24.674215755114943, 24.870282941885904, 24.840713726046175, 26.338754455248505, 26.861308618138224, 27.072765431987733, 29.30175520479679, 29.45651687681675, 29.447230622172356, 20.534939202169568, 20.689793184554816, 20.569393974418432, 31.502292243763804, 31.27305819094181, 31.485574044287205, 27.346373091141373, 27.807724664608628, 26.80037189523378, 22.360164598251373, 22.241611323008925, 22.18827751527229, 29.985438597699, 30.285047388946012, 29.96873156478007, 25.34981010357538, 25.01732466618219, 26.08629342975715, 26.684064593282528, 26.336879022419453, 26.68333526526112, 25.9670175537467, 25.877087518572807, 26.407792451325804, 31.55750174075365, 31.591523960232735, 31.710546538233757, 28.116903031244874, 27.956390731036663, 27.82402867078781, 19.75929098327954, 19.757629205783203, 19.583737572034195, 27.621661250789955, 28.24492343779032, 28.000703540941075, 18.869155863920838, 18.795748469109327, 18.80508453088501, 30.42955495913823, 30.343989511330918, 30.689239618678883, 23.070669777691364, 23.460450114682317, 23.40310425311327, 26.614673151324183, 26.768841263527662, 26.378118726114423, 26.754556541059472, 26.197653358181313, 25.51660584410031, 32.08229761819044, 31.639602484802396, 31.991390253106744, 27.369677558541298, 27.35796695947647, 27.560849361121655, 31.191501073539257, 31.44798144325614, 31.260277159512043, 24.985726096977785, 25.24257506554325, 25.137296480437115, 34.02329257627328, 34.04125488301118, 34.12161423762639, 27.801413254191473, 27.42298390467961, 27.621417117615536, 30.521295222143323, 30.595861247430236, 30.20582955578962, 25.641134043534592, 25.823578794797257, 25.161042993267372, 18.177051196806133, 17.79407962411642, 17.15791094303131, 24.894190129513532, 24.131747434536607, 24.241175974408776, 20.37333407998085, 20.570755131542683, 20.67274758219719, 35.5008879005909, 36.20507412403822, 35.72755281627178, 29.503461023171738, 29.66850062211354, 29.40334205826123, 23.497620671987534, 22.822090089321136, 23.966686741332524, 27.64312685405214, 27.10964373250802, 27.762671093766883, 19.180812428394944, 19.18752786020437, 18.378383855024964, 16.509758710861206, 16.618106618523598, 15.813835516571999, 24.074309113124997, 24.235413636701793, 24.178787058840186, 23.869222710529954, 24.170040572683007, 23.557356829444558, 26.893556114286184, 26.899881303310394, 26.858666880056262, 39.908659043411404, 39.59053150812784, 39.90408782350519, 28.118378930414707, 27.882631952563912, 28.1121108966569, 25.700111816326768, 26.018265316883713, 26.079177315036446, 20.21140057345231, 20.392477444683507, 20.294418090333536, 23.588095207388193, 23.317569794754178, 23.412045224259288, 15.736665070056915, 14.919078588485718, 15.342259421944618, 14.949797317385674, 15.530225534457713, 15.081776902079582, 27.174210566406444, 27.08924577509363, 27.07727913682659, 29.183091862748057, 29.233623842398316, 29.31843231121698, 26.89937141289313, 27.10023090274383, 26.564573501547173, 22.405239067971706, 22.739540193229914, 22.709786094725132, 21.943420497700572, 21.546808294951916, 22.069837028393522, 23.14045348732421, 22.81505891184011, 22.056609998146683, 23.108944416046143, 22.90967684984207, 22.810300186276436, 21.12621736278136, 20.98858058949311, 21.02151647706826, 21.558019409577042, 21.646716504047305, 21.68010032052794, 22.74619125202298, 22.85234908014536, 22.743009313941002, 19.197549814979226, 19.033959391216428, 18.839590842525155, 26.836585397521645, 27.21182995910445, 27.10850119094053, 21.004217396179826, 20.75462622443834, 21.081656011442334, 26.124239459633827, 26.785485207103193, 26.442563876509666, 29.3702481132932, 28.95638172328472, 29.27758035995066, 21.956935947140053, 22.21747291584809, 22.27608462174733, 22.72933329393466, 22.92343501405169, 22.905734353077904, 23.388032654921204, 23.67650295390436, 23.432294505337865, 13.920185690124825, 14.066687275966004, 14.218335909148053, 24.433264270424843, 24.73069809138542, 24.143173940479755, 19.467466592788696, 19.513137720525265, 19.4522839859128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1412715510255276, "mean_inference_ms": 0.6464902245590303, "mean_action_processing_ms": 0.09507815724071494, "mean_env_wait_ms": 0.7953999283201231, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 897600, "timesteps_this_iter": 0, "agent_timesteps_total": 2692800, "timers": {"sample_time_ms": 9389.604, "sample_throughput": 511.204, "load_time_ms": 0.1, "load_throughput": 48060776.319, "learn_time_ms": 1200.789, "learn_throughput": 3997.371, "update_time_ms": 1.799}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 7.414176940917969, "policy_loss": 0.0007226476063563747, "vf_loss": 7.5721665024757385, "vf_explained_var": 0.03418467938899994, "kl": 0.011697051232025399, "entropy": 15.93048882484436, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 897600, "num_agent_steps_sampled": 2692800, "num_steps_trained": 897600, "num_agent_steps_trained": 2692800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3921, "training_iteration": 187, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-11-52", "timestamp": 1706148712, "time_this_iter_s": 9.475803136825562, "time_total_s": 1751.277613401413, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015CB430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1751.277613401413, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 9.885714285714286, "ram_util_percent": 47.971428571428575}}
{"episode_reward_max": 119.40327837504444, "episode_reward_min": 37.213730750605436, "episode_reward_mean": 74.84712676800031, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.25285645077625}, "policy_reward_max": {"shared_policy": 39.908659043411404}, "policy_reward_mean": {"shared_policy": 24.949042256000098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.32794283330439, 52.78269295394419, 59.12847294751555, 92.46746450662613, 73.33853809256104, 90.5794041957706, 82.50506123411466, 37.213730750605436, 78.119746979326, 77.83151442557573, 90.71868998371062, 62.8381844870746, 68.06305348128079, 107.47198906168342, 87.10616360930725, 82.12202465534209, 74.38521242304702, 80.27282850537446, 88.2055027037859, 61.794126361142816, 94.26092447899282, 81.95446965098378, 66.79005343653259, 90.23921755142509, 76.45342819951472, 79.7042788809631, 78.25189752364531, 94.85957223922014, 83.89732243306935, 59.10065776109694, 83.86728822952135, 56.46998886391518, 91.46278408914803, 69.93422414548695, 79.76163314096627, 78.4688157433411, 95.71329035609958, 82.28849387913942, 93.89975967630744, 75.36559764295815, 102.18616169691084, 82.84581427648662, 91.32298602536318, 76.62575583159922, 53.129041763953865, 73.26711353845891, 61.61683679372072, 107.4335148409009, 88.57530370354651, 70.2863975026412, 82.51544168032704, 56.74672414362428, 48.9417008459568, 72.48850980866698, 71.59662011265752, 80.65210429765284, 119.40327837504444, 84.11312177963552, 77.79755444824693, 60.89829610846935, 70.31771022640166, 45.99800308048725, 45.56179975392297, 81.34073547832666, 87.73514801636335, 80.56417581718414, 67.85456535592675, 65.56006582104601, 68.012122397311, 68.82892145216465, 63.13631442934273, 64.88483623415229, 68.34154964610934, 57.07110004872081, 81.15691654756662, 62.8404996320605, 79.35228854324669, 87.60421019652858, 66.45049348473547, 68.55850266106425, 70.49683011416343, 42.20520887523888, 73.30713630229002, 58.43288829922676, 56.7472416674718, 96.35826577618717, 60.172297481447444, 67.8161913566291, 82.13055217079818, 58.14788358658549, 50.683727206196636, 75.37430241797118, 69.86466716602442, 66.15140639990567, 75.95665583014488, 92.3200721517205, 67.66417421773075, 78.11806278675792, 65.47101547941564, 105.66581900417803], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.29940890272458, 22.74124941726525, 23.28728451331456, 17.720569678892687, 17.265287963052586, 17.79683531199892, 19.934736230410635, 19.50847005099058, 19.68526666611433, 30.57367615401745, 30.67287966609001, 31.22090868651867, 24.540356415013463, 24.642277866291494, 24.15590381125608, 30.08251915623744, 30.108345588048294, 30.388539451484874, 27.068680400649697, 27.819553246178344, 27.616827587286622, 12.25285645077625, 12.491351389015705, 12.469522910813481, 25.71187961598237, 26.311418020476893, 26.096449342866734, 26.132424108684063, 26.00325745344162, 25.69583286345005, 30.343623025963694, 29.95714611808458, 30.417920839662344, 20.89531737317641, 20.939758112033203, 21.003109001864985, 23.104841483136013, 22.796181102593735, 22.16203089555104, 35.53287287056446, 36.09195387735963, 35.84716231375933, 28.91980879878004, 29.128379921273634, 29.057974889253572, 27.28485060979922, 27.426170912881688, 27.41100313266118, 24.674215755114943, 24.870282941885904, 24.840713726046175, 26.338754455248505, 26.861308618138224, 27.072765431987733, 29.30175520479679, 29.45651687681675, 29.447230622172356, 20.534939202169568, 20.689793184554816, 20.569393974418432, 31.502292243763804, 31.27305819094181, 31.485574044287205, 27.346373091141373, 27.807724664608628, 26.80037189523378, 22.360164598251373, 22.241611323008925, 22.18827751527229, 29.985438597699, 30.285047388946012, 29.96873156478007, 25.34981010357538, 25.01732466618219, 26.08629342975715, 26.684064593282528, 26.336879022419453, 26.68333526526112, 25.9670175537467, 25.877087518572807, 26.407792451325804, 31.55750174075365, 31.591523960232735, 31.710546538233757, 28.116903031244874, 27.956390731036663, 27.82402867078781, 19.75929098327954, 19.757629205783203, 19.583737572034195, 27.621661250789955, 28.24492343779032, 28.000703540941075, 18.869155863920838, 18.795748469109327, 18.80508453088501, 30.42955495913823, 30.343989511330918, 30.689239618678883, 23.070669777691364, 23.460450114682317, 23.40310425311327, 26.614673151324183, 26.768841263527662, 26.378118726114423, 26.754556541059472, 26.197653358181313, 25.51660584410031, 32.08229761819044, 31.639602484802396, 31.991390253106744, 27.369677558541298, 27.35796695947647, 27.560849361121655, 31.191501073539257, 31.44798144325614, 31.260277159512043, 24.985726096977785, 25.24257506554325, 25.137296480437115, 34.02329257627328, 34.04125488301118, 34.12161423762639, 27.801413254191473, 27.42298390467961, 27.621417117615536, 30.521295222143323, 30.595861247430236, 30.20582955578962, 25.641134043534592, 25.823578794797257, 25.161042993267372, 18.177051196806133, 17.79407962411642, 17.15791094303131, 24.894190129513532, 24.131747434536607, 24.241175974408776, 20.37333407998085, 20.570755131542683, 20.67274758219719, 35.5008879005909, 36.20507412403822, 35.72755281627178, 29.503461023171738, 29.66850062211354, 29.40334205826123, 23.497620671987534, 22.822090089321136, 23.966686741332524, 27.64312685405214, 27.10964373250802, 27.762671093766883, 19.180812428394944, 19.18752786020437, 18.378383855024964, 16.509758710861206, 16.618106618523598, 15.813835516571999, 24.074309113124997, 24.235413636701793, 24.178787058840186, 23.869222710529954, 24.170040572683007, 23.557356829444558, 26.893556114286184, 26.899881303310394, 26.858666880056262, 39.908659043411404, 39.59053150812784, 39.90408782350519, 28.118378930414707, 27.882631952563912, 28.1121108966569, 25.700111816326768, 26.018265316883713, 26.079177315036446, 20.21140057345231, 20.392477444683507, 20.294418090333536, 23.588095207388193, 23.317569794754178, 23.412045224259288, 15.736665070056915, 14.919078588485718, 15.342259421944618, 14.949797317385674, 15.530225534457713, 15.081776902079582, 27.174210566406444, 27.08924577509363, 27.07727913682659, 29.183091862748057, 29.233623842398316, 29.31843231121698, 26.89937141289313, 27.10023090274383, 26.564573501547173, 22.405239067971706, 22.739540193229914, 22.709786094725132, 21.943420497700572, 21.546808294951916, 22.069837028393522, 23.14045348732421, 22.81505891184011, 22.056609998146683, 23.108944416046143, 22.90967684984207, 22.810300186276436, 21.12621736278136, 20.98858058949311, 21.02151647706826, 21.558019409577042, 21.646716504047305, 21.68010032052794, 22.74619125202298, 22.85234908014536, 22.743009313941002, 19.197549814979226, 19.033959391216428, 18.839590842525155, 26.836585397521645, 27.21182995910445, 27.10850119094053, 21.004217396179826, 20.75462622443834, 21.081656011442334, 26.124239459633827, 26.785485207103193, 26.442563876509666, 29.3702481132932, 28.95638172328472, 29.27758035995066, 21.956935947140053, 22.21747291584809, 22.27608462174733, 22.72933329393466, 22.92343501405169, 22.905734353077904, 23.388032654921204, 23.67650295390436, 23.432294505337865, 13.920185690124825, 14.066687275966004, 14.218335909148053, 24.433264270424843, 24.73069809138542, 24.143173940479755, 19.467466592788696, 19.513137720525265, 19.4522839859128, 19.102276602449507, 18.927981952826173, 18.716983112196118, 31.882193495829895, 32.11379609753688, 32.362276182820395, 19.929288325210408, 20.045564991732434, 20.197444164504603, 22.552461134890706, 22.633410948018224, 22.630319273720175, 27.342330187559128, 27.101250521838665, 27.68697146140039, 19.308232287565858, 19.817637684444577, 19.02201361457506, 17.099416127894074, 17.09636106621474, 16.487950012087822, 25.65558894568433, 24.247017582257584, 25.471695890029267, 23.320247585574776, 23.151056746641785, 23.393362833807856, 22.192481615891055, 22.279172250380114, 21.6797525336345, 25.49215766787529, 25.0816645398736, 25.382833622395992, 30.55244869987169, 31.054163719216973, 30.713459732631833, 22.7542169218262, 22.867900506903723, 22.042056789000824, 26.098652253548295, 26.04521210740009, 25.974198425809533, 21.565936778982476, 21.968714346488312, 21.936364353944853, 35.296423358221844, 35.20293429245551, 35.16646135350068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1412648888030548, "mean_inference_ms": 0.6466060019066323, "mean_action_processing_ms": 0.0950835964647613, "mean_env_wait_ms": 0.7954345119002965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 902400, "timesteps_this_iter": 0, "agent_timesteps_total": 2707200, "timers": {"sample_time_ms": 9416.785, "sample_throughput": 509.728, "load_time_ms": 0.2, "load_throughput": 24036126.074, "learn_time_ms": 1199.376, "learn_throughput": 4002.082, "update_time_ms": 1.799}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.932426989078522, "policy_loss": 0.0007423289336130345, "vf_loss": 7.089792251586914, "vf_explained_var": -0.0007745176553726196, "kl": 0.012414648488902658, "entropy": 15.873703002929688, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 902400, "num_agent_steps_sampled": 2707200, "num_steps_trained": 902400, "num_agent_steps_trained": 2707200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3937, "training_iteration": 188, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-12-02", "timestamp": 1706148722, "time_this_iter_s": 9.768934488296509, "time_total_s": 1761.0465478897095, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015CBB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1761.0465478897095, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 6.884615384615385, "ram_util_percent": 48.34615384615384}}
{"episode_reward_max": 119.40327837504444, "episode_reward_min": 42.20520887523888, "episode_reward_mean": 74.56029057277192, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 13.920185690124825}, "policy_reward_max": {"shared_policy": 39.908659043411404}, "policy_reward_mean": {"shared_policy": 24.853430190923966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.38521242304702, 80.27282850537446, 88.2055027037859, 61.794126361142816, 94.26092447899282, 81.95446965098378, 66.79005343653259, 90.23921755142509, 76.45342819951472, 79.7042788809631, 78.25189752364531, 94.85957223922014, 83.89732243306935, 59.10065776109694, 83.86728822952135, 56.46998886391518, 91.46278408914803, 69.93422414548695, 79.76163314096627, 78.4688157433411, 95.71329035609958, 82.28849387913942, 93.89975967630744, 75.36559764295815, 102.18616169691084, 82.84581427648662, 91.32298602536318, 76.62575583159922, 53.129041763953865, 73.26711353845891, 61.61683679372072, 107.4335148409009, 88.57530370354651, 70.2863975026412, 82.51544168032704, 56.74672414362428, 48.9417008459568, 72.48850980866698, 71.59662011265752, 80.65210429765284, 119.40327837504444, 84.11312177963552, 77.79755444824693, 60.89829610846935, 70.31771022640166, 45.99800308048725, 45.56179975392297, 81.34073547832666, 87.73514801636335, 80.56417581718414, 67.85456535592675, 65.56006582104601, 68.012122397311, 68.82892145216465, 63.13631442934273, 64.88483623415229, 68.34154964610934, 57.07110004872081, 81.15691654756662, 62.8404996320605, 79.35228854324669, 87.60421019652858, 66.45049348473547, 68.55850266106425, 70.49683011416343, 42.20520887523888, 73.30713630229002, 58.43288829922676, 56.7472416674718, 96.35826577618717, 60.172297481447444, 67.8161913566291, 82.13055217079818, 58.14788358658549, 50.683727206196636, 75.37430241797118, 69.86466716602442, 66.15140639990567, 75.95665583014488, 92.3200721517205, 67.66417421773075, 78.11806278675792, 65.47101547941564, 105.66581900417803, 62.631275117397294, 88.68198545649646, 85.69074086472392, 71.63832711614666, 54.12738561630249, 73.44883010908961, 57.45660253975075, 75.19423611089587, 80.50874466821548, 95.86337627377358, 72.11666963249445, 92.00047490000725, 50.43296087905762, 86.41217320784925, 75.01607532799241, 60.71119685471055], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.674215755114943, 24.870282941885904, 24.840713726046175, 26.338754455248505, 26.861308618138224, 27.072765431987733, 29.30175520479679, 29.45651687681675, 29.447230622172356, 20.534939202169568, 20.689793184554816, 20.569393974418432, 31.502292243763804, 31.27305819094181, 31.485574044287205, 27.346373091141373, 27.807724664608628, 26.80037189523378, 22.360164598251373, 22.241611323008925, 22.18827751527229, 29.985438597699, 30.285047388946012, 29.96873156478007, 25.34981010357538, 25.01732466618219, 26.08629342975715, 26.684064593282528, 26.336879022419453, 26.68333526526112, 25.9670175537467, 25.877087518572807, 26.407792451325804, 31.55750174075365, 31.591523960232735, 31.710546538233757, 28.116903031244874, 27.956390731036663, 27.82402867078781, 19.75929098327954, 19.757629205783203, 19.583737572034195, 27.621661250789955, 28.24492343779032, 28.000703540941075, 18.869155863920838, 18.795748469109327, 18.80508453088501, 30.42955495913823, 30.343989511330918, 30.689239618678883, 23.070669777691364, 23.460450114682317, 23.40310425311327, 26.614673151324183, 26.768841263527662, 26.378118726114423, 26.754556541059472, 26.197653358181313, 25.51660584410031, 32.08229761819044, 31.639602484802396, 31.991390253106744, 27.369677558541298, 27.35796695947647, 27.560849361121655, 31.191501073539257, 31.44798144325614, 31.260277159512043, 24.985726096977785, 25.24257506554325, 25.137296480437115, 34.02329257627328, 34.04125488301118, 34.12161423762639, 27.801413254191473, 27.42298390467961, 27.621417117615536, 30.521295222143323, 30.595861247430236, 30.20582955578962, 25.641134043534592, 25.823578794797257, 25.161042993267372, 18.177051196806133, 17.79407962411642, 17.15791094303131, 24.894190129513532, 24.131747434536607, 24.241175974408776, 20.37333407998085, 20.570755131542683, 20.67274758219719, 35.5008879005909, 36.20507412403822, 35.72755281627178, 29.503461023171738, 29.66850062211354, 29.40334205826123, 23.497620671987534, 22.822090089321136, 23.966686741332524, 27.64312685405214, 27.10964373250802, 27.762671093766883, 19.180812428394944, 19.18752786020437, 18.378383855024964, 16.509758710861206, 16.618106618523598, 15.813835516571999, 24.074309113124997, 24.235413636701793, 24.178787058840186, 23.869222710529954, 24.170040572683007, 23.557356829444558, 26.893556114286184, 26.899881303310394, 26.858666880056262, 39.908659043411404, 39.59053150812784, 39.90408782350519, 28.118378930414707, 27.882631952563912, 28.1121108966569, 25.700111816326768, 26.018265316883713, 26.079177315036446, 20.21140057345231, 20.392477444683507, 20.294418090333536, 23.588095207388193, 23.317569794754178, 23.412045224259288, 15.736665070056915, 14.919078588485718, 15.342259421944618, 14.949797317385674, 15.530225534457713, 15.081776902079582, 27.174210566406444, 27.08924577509363, 27.07727913682659, 29.183091862748057, 29.233623842398316, 29.31843231121698, 26.89937141289313, 27.10023090274383, 26.564573501547173, 22.405239067971706, 22.739540193229914, 22.709786094725132, 21.943420497700572, 21.546808294951916, 22.069837028393522, 23.14045348732421, 22.81505891184011, 22.056609998146683, 23.108944416046143, 22.90967684984207, 22.810300186276436, 21.12621736278136, 20.98858058949311, 21.02151647706826, 21.558019409577042, 21.646716504047305, 21.68010032052794, 22.74619125202298, 22.85234908014536, 22.743009313941002, 19.197549814979226, 19.033959391216428, 18.839590842525155, 26.836585397521645, 27.21182995910445, 27.10850119094053, 21.004217396179826, 20.75462622443834, 21.081656011442334, 26.124239459633827, 26.785485207103193, 26.442563876509666, 29.3702481132932, 28.95638172328472, 29.27758035995066, 21.956935947140053, 22.21747291584809, 22.27608462174733, 22.72933329393466, 22.92343501405169, 22.905734353077904, 23.388032654921204, 23.67650295390436, 23.432294505337865, 13.920185690124825, 14.066687275966004, 14.218335909148053, 24.433264270424843, 24.73069809138542, 24.143173940479755, 19.467466592788696, 19.513137720525265, 19.4522839859128, 19.102276602449507, 18.927981952826173, 18.716983112196118, 31.882193495829895, 32.11379609753688, 32.362276182820395, 19.929288325210408, 20.045564991732434, 20.197444164504603, 22.552461134890706, 22.633410948018224, 22.630319273720175, 27.342330187559128, 27.101250521838665, 27.68697146140039, 19.308232287565858, 19.817637684444577, 19.02201361457506, 17.099416127894074, 17.09636106621474, 16.487950012087822, 25.65558894568433, 24.247017582257584, 25.471695890029267, 23.320247585574776, 23.151056746641785, 23.393362833807856, 22.192481615891055, 22.279172250380114, 21.6797525336345, 25.49215766787529, 25.0816645398736, 25.382833622395992, 30.55244869987169, 31.054163719216973, 30.713459732631833, 22.7542169218262, 22.867900506903723, 22.042056789000824, 26.098652253548295, 26.04521210740009, 25.974198425809533, 21.565936778982476, 21.968714346488312, 21.936364353944853, 35.296423358221844, 35.20293429245551, 35.16646135350068, 20.794279185434178, 20.86597342168291, 20.971022510280207, 29.29565993448098, 29.59288426985343, 29.793441252162054, 28.338403582572937, 28.693103186786175, 28.65923409536481, 23.192787448565156, 24.414564062530786, 24.030975605050713, 17.95569382607937, 18.140744902193546, 18.030946888029575, 24.323073908686638, 24.517766296863556, 24.60798990353942, 18.871258608996868, 19.379771996173076, 19.205571934580803, 24.77200324833393, 25.39634795114398, 25.02588491141796, 26.567841211954743, 27.19749095166722, 26.743412504593522, 32.06984602070102, 32.039039383331925, 31.754490869740636, 24.194515593349934, 23.712709084153175, 24.20944495499134, 30.725687477737665, 30.664860863238573, 30.60992655903101, 16.751628922919423, 16.913406788061053, 16.76792516807714, 28.98257293303807, 28.941246555497244, 28.488353719313935, 25.10090352098146, 25.153647037843854, 24.761524769167096, 20.224770570794732, 19.622315655151993, 20.864110628763825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1412606731375665, "mean_inference_ms": 0.6466981351773065, "mean_action_processing_ms": 0.09508413162628358, "mean_env_wait_ms": 0.7954596361243904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 907200, "timesteps_this_iter": 0, "agent_timesteps_total": 2721600, "timers": {"sample_time_ms": 9434.874, "sample_throughput": 508.751, "load_time_ms": 0.2, "load_throughput": 24036126.074, "learn_time_ms": 1200.876, "learn_throughput": 3997.082, "update_time_ms": 1.7}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.788043141365051, "policy_loss": 0.0006866199935355866, "vf_loss": 6.945752859115601, "vf_explained_var": 0.006440460681915283, "kl": 0.013609406887821904, "entropy": 15.908589959144592, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 907200, "num_agent_steps_sampled": 2721600, "num_steps_trained": 907200, "num_agent_steps_trained": 2721600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3953, "training_iteration": 189, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-12-12", "timestamp": 1706148732, "time_this_iter_s": 9.49125075340271, "time_total_s": 1770.5377986431122, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1770.5377986431122, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 9.692857142857145, "ram_util_percent": 48.37142857142857}}
{"episode_reward_max": 119.40327837504444, "episode_reward_min": -8.615269841626287, "episode_reward_mean": 73.30017025222944, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -3.1707162857055664}, "policy_reward_max": {"shared_policy": 39.908659043411404}, "policy_reward_mean": {"shared_policy": 24.43339008407647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.46278408914803, 69.93422414548695, 79.76163314096627, 78.4688157433411, 95.71329035609958, 82.28849387913942, 93.89975967630744, 75.36559764295815, 102.18616169691084, 82.84581427648662, 91.32298602536318, 76.62575583159922, 53.129041763953865, 73.26711353845891, 61.61683679372072, 107.4335148409009, 88.57530370354651, 70.2863975026412, 82.51544168032704, 56.74672414362428, 48.9417008459568, 72.48850980866698, 71.59662011265752, 80.65210429765284, 119.40327837504444, 84.11312177963552, 77.79755444824693, 60.89829610846935, 70.31771022640166, 45.99800308048725, 45.56179975392297, 81.34073547832666, 87.73514801636335, 80.56417581718414, 67.85456535592675, 65.56006582104601, 68.012122397311, 68.82892145216465, 63.13631442934273, 64.88483623415229, 68.34154964610934, 57.07110004872081, 81.15691654756662, 62.8404996320605, 79.35228854324669, 87.60421019652858, 66.45049348473547, 68.55850266106425, 70.49683011416343, 42.20520887523888, 73.30713630229002, 58.43288829922676, 56.7472416674718, 96.35826577618717, 60.172297481447444, 67.8161913566291, 82.13055217079818, 58.14788358658549, 50.683727206196636, 75.37430241797118, 69.86466716602442, 66.15140639990567, 75.95665583014488, 92.3200721517205, 67.66417421773075, 78.11806278675792, 65.47101547941564, 105.66581900417803, 62.631275117397294, 88.68198545649646, 85.69074086472392, 71.63832711614666, 54.12738561630249, 73.44883010908961, 57.45660253975075, 75.19423611089587, 80.50874466821548, 95.86337627377358, 72.11666963249445, 92.00047490000725, 50.43296087905762, 86.41217320784925, 75.01607532799241, 60.71119685471055, 80.5750003522262, 84.34841227158904, 98.92595478892325, 77.43294492736456, 62.892827400937676, 65.00251877307889, 105.97536715550814, 83.22336492687462, 83.44648594968018, -8.615269841626287, 52.70955286920071, 83.37601435463876, 72.35686901211739, 30.492179913446293, 70.08090538531542, 82.27160894870758], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.42955495913823, 30.343989511330918, 30.689239618678883, 23.070669777691364, 23.460450114682317, 23.40310425311327, 26.614673151324183, 26.768841263527662, 26.378118726114423, 26.754556541059472, 26.197653358181313, 25.51660584410031, 32.08229761819044, 31.639602484802396, 31.991390253106744, 27.369677558541298, 27.35796695947647, 27.560849361121655, 31.191501073539257, 31.44798144325614, 31.260277159512043, 24.985726096977785, 25.24257506554325, 25.137296480437115, 34.02329257627328, 34.04125488301118, 34.12161423762639, 27.801413254191473, 27.42298390467961, 27.621417117615536, 30.521295222143323, 30.595861247430236, 30.20582955578962, 25.641134043534592, 25.823578794797257, 25.161042993267372, 18.177051196806133, 17.79407962411642, 17.15791094303131, 24.894190129513532, 24.131747434536607, 24.241175974408776, 20.37333407998085, 20.570755131542683, 20.67274758219719, 35.5008879005909, 36.20507412403822, 35.72755281627178, 29.503461023171738, 29.66850062211354, 29.40334205826123, 23.497620671987534, 22.822090089321136, 23.966686741332524, 27.64312685405214, 27.10964373250802, 27.762671093766883, 19.180812428394944, 19.18752786020437, 18.378383855024964, 16.509758710861206, 16.618106618523598, 15.813835516571999, 24.074309113124997, 24.235413636701793, 24.178787058840186, 23.869222710529954, 24.170040572683007, 23.557356829444558, 26.893556114286184, 26.899881303310394, 26.858666880056262, 39.908659043411404, 39.59053150812784, 39.90408782350519, 28.118378930414707, 27.882631952563912, 28.1121108966569, 25.700111816326768, 26.018265316883713, 26.079177315036446, 20.21140057345231, 20.392477444683507, 20.294418090333536, 23.588095207388193, 23.317569794754178, 23.412045224259288, 15.736665070056915, 14.919078588485718, 15.342259421944618, 14.949797317385674, 15.530225534457713, 15.081776902079582, 27.174210566406444, 27.08924577509363, 27.07727913682659, 29.183091862748057, 29.233623842398316, 29.31843231121698, 26.89937141289313, 27.10023090274383, 26.564573501547173, 22.405239067971706, 22.739540193229914, 22.709786094725132, 21.943420497700572, 21.546808294951916, 22.069837028393522, 23.14045348732421, 22.81505891184011, 22.056609998146683, 23.108944416046143, 22.90967684984207, 22.810300186276436, 21.12621736278136, 20.98858058949311, 21.02151647706826, 21.558019409577042, 21.646716504047305, 21.68010032052794, 22.74619125202298, 22.85234908014536, 22.743009313941002, 19.197549814979226, 19.033959391216428, 18.839590842525155, 26.836585397521645, 27.21182995910445, 27.10850119094053, 21.004217396179826, 20.75462622443834, 21.081656011442334, 26.124239459633827, 26.785485207103193, 26.442563876509666, 29.3702481132932, 28.95638172328472, 29.27758035995066, 21.956935947140053, 22.21747291584809, 22.27608462174733, 22.72933329393466, 22.92343501405169, 22.905734353077904, 23.388032654921204, 23.67650295390436, 23.432294505337865, 13.920185690124825, 14.066687275966004, 14.218335909148053, 24.433264270424843, 24.73069809138542, 24.143173940479755, 19.467466592788696, 19.513137720525265, 19.4522839859128, 19.102276602449507, 18.927981952826173, 18.716983112196118, 31.882193495829895, 32.11379609753688, 32.362276182820395, 19.929288325210408, 20.045564991732434, 20.197444164504603, 22.552461134890706, 22.633410948018224, 22.630319273720175, 27.342330187559128, 27.101250521838665, 27.68697146140039, 19.308232287565858, 19.817637684444577, 19.02201361457506, 17.099416127894074, 17.09636106621474, 16.487950012087822, 25.65558894568433, 24.247017582257584, 25.471695890029267, 23.320247585574776, 23.151056746641785, 23.393362833807856, 22.192481615891055, 22.279172250380114, 21.6797525336345, 25.49215766787529, 25.0816645398736, 25.382833622395992, 30.55244869987169, 31.054163719216973, 30.713459732631833, 22.7542169218262, 22.867900506903723, 22.042056789000824, 26.098652253548295, 26.04521210740009, 25.974198425809533, 21.565936778982476, 21.968714346488312, 21.936364353944853, 35.296423358221844, 35.20293429245551, 35.16646135350068, 20.794279185434178, 20.86597342168291, 20.971022510280207, 29.29565993448098, 29.59288426985343, 29.793441252162054, 28.338403582572937, 28.693103186786175, 28.65923409536481, 23.192787448565156, 24.414564062530786, 24.030975605050713, 17.95569382607937, 18.140744902193546, 18.030946888029575, 24.323073908686638, 24.517766296863556, 24.60798990353942, 18.871258608996868, 19.379771996173076, 19.205571934580803, 24.77200324833393, 25.39634795114398, 25.02588491141796, 26.567841211954743, 27.19749095166722, 26.743412504593522, 32.06984602070102, 32.039039383331925, 31.754490869740636, 24.194515593349934, 23.712709084153175, 24.20944495499134, 30.725687477737665, 30.664860863238573, 30.60992655903101, 16.751628922919423, 16.913406788061053, 16.76792516807714, 28.98257293303807, 28.941246555497244, 28.488353719313935, 25.10090352098146, 25.153647037843854, 24.761524769167096, 20.224770570794732, 19.622315655151993, 20.864110628763825, 26.690164901316166, 26.764226093888283, 27.12060935702175, 28.372631210833788, 28.480098478496075, 27.495682582259178, 33.07723407198985, 33.204727736612156, 32.643992980321244, 25.97425193960467, 25.894943843285233, 25.563749144474656, 20.36389611661434, 21.37223624624312, 21.156695038080215, 21.538465480009705, 21.532104956607014, 21.93194833646217, 35.18093002587557, 35.17750186473131, 35.61693526490126, 27.825786625345543, 27.606004407008484, 27.791573894520596, 28.378194474304706, 27.82360146443048, 27.244690010944993, -3.1707162857055664, -2.994194932281971, -2.450358623638749, 17.047304660081863, 17.755315005779266, 17.906933203339577, 27.852776592597365, 27.923788313753903, 27.599449448287487, 24.498194366693497, 24.306083157658577, 23.552591487765312, 10.231667626028255, 10.08748087038596, 10.173031417032078, 23.536742508411407, 22.780456572771072, 23.76370630413294, 27.247959852218628, 27.7440417855978, 27.27960731089115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14125844191671663, "mean_inference_ms": 0.6467783455627313, "mean_action_processing_ms": 0.09508249909173902, "mean_env_wait_ms": 0.7954604570674614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 912000, "timesteps_this_iter": 0, "agent_timesteps_total": 2736000, "timers": {"sample_time_ms": 9450.496, "sample_throughput": 507.91, "load_time_ms": 0.2, "load_throughput": 24036126.074, "learn_time_ms": 1203.274, "learn_throughput": 3989.116, "update_time_ms": 1.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 8.74451744556427, "policy_loss": 0.0010265083471393543, "vf_loss": 8.903154373168945, "vf_explained_var": 0.0015900656580924988, "kl": 0.01698046771371865, "entropy": 16.052388787269592, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 912000, "num_agent_steps_sampled": 2736000, "num_steps_trained": 912000, "num_agent_steps_trained": 2736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3969, "training_iteration": 190, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-12-21", "timestamp": 1706148741, "time_this_iter_s": 9.171363592147827, "time_total_s": 1779.70916223526, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F9280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1779.70916223526, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 8.646153846153846, "ram_util_percent": 48.06153846153847}}
{"episode_reward_max": 119.40327837504444, "episode_reward_min": -8.615269841626287, "episode_reward_mean": 71.56270810659058, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -3.1707162857055664}, "policy_reward_max": {"shared_policy": 39.908659043411404}, "policy_reward_mean": {"shared_policy": 23.85423603553019}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.57530370354651, 70.2863975026412, 82.51544168032704, 56.74672414362428, 48.9417008459568, 72.48850980866698, 71.59662011265752, 80.65210429765284, 119.40327837504444, 84.11312177963552, 77.79755444824693, 60.89829610846935, 70.31771022640166, 45.99800308048725, 45.56179975392297, 81.34073547832666, 87.73514801636335, 80.56417581718414, 67.85456535592675, 65.56006582104601, 68.012122397311, 68.82892145216465, 63.13631442934273, 64.88483623415229, 68.34154964610934, 57.07110004872081, 81.15691654756662, 62.8404996320605, 79.35228854324669, 87.60421019652858, 66.45049348473547, 68.55850266106425, 70.49683011416343, 42.20520887523888, 73.30713630229002, 58.43288829922676, 56.7472416674718, 96.35826577618717, 60.172297481447444, 67.8161913566291, 82.13055217079818, 58.14788358658549, 50.683727206196636, 75.37430241797118, 69.86466716602442, 66.15140639990567, 75.95665583014488, 92.3200721517205, 67.66417421773075, 78.11806278675792, 65.47101547941564, 105.66581900417803, 62.631275117397294, 88.68198545649646, 85.69074086472392, 71.63832711614666, 54.12738561630249, 73.44883010908961, 57.45660253975075, 75.19423611089587, 80.50874466821548, 95.86337627377358, 72.11666963249445, 92.00047490000725, 50.43296087905762, 86.41217320784925, 75.01607532799241, 60.71119685471055, 80.5750003522262, 84.34841227158904, 98.92595478892325, 77.43294492736456, 62.892827400937676, 65.00251877307889, 105.97536715550814, 83.22336492687462, 83.44648594968018, -8.615269841626287, 52.70955286920071, 83.37601435463876, 72.35686901211739, 30.492179913446293, 70.08090538531542, 82.27160894870758, 62.896515160799, 58.018718503415556, 79.19620439782736, 64.37911738082767, 86.58095113933086, 83.30365584045646, 66.26662779413164, 66.84247137606141, 63.43232588283715, 68.25580732845991, 83.10846413671969, 45.92333932220936, 91.65697532892226, 89.79506147652864, 49.19106388092041, 82.72830992750822], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [29.503461023171738, 29.66850062211354, 29.40334205826123, 23.497620671987534, 22.822090089321136, 23.966686741332524, 27.64312685405214, 27.10964373250802, 27.762671093766883, 19.180812428394944, 19.18752786020437, 18.378383855024964, 16.509758710861206, 16.618106618523598, 15.813835516571999, 24.074309113124997, 24.235413636701793, 24.178787058840186, 23.869222710529954, 24.170040572683007, 23.557356829444558, 26.893556114286184, 26.899881303310394, 26.858666880056262, 39.908659043411404, 39.59053150812784, 39.90408782350519, 28.118378930414707, 27.882631952563912, 28.1121108966569, 25.700111816326768, 26.018265316883713, 26.079177315036446, 20.21140057345231, 20.392477444683507, 20.294418090333536, 23.588095207388193, 23.317569794754178, 23.412045224259288, 15.736665070056915, 14.919078588485718, 15.342259421944618, 14.949797317385674, 15.530225534457713, 15.081776902079582, 27.174210566406444, 27.08924577509363, 27.07727913682659, 29.183091862748057, 29.233623842398316, 29.31843231121698, 26.89937141289313, 27.10023090274383, 26.564573501547173, 22.405239067971706, 22.739540193229914, 22.709786094725132, 21.943420497700572, 21.546808294951916, 22.069837028393522, 23.14045348732421, 22.81505891184011, 22.056609998146683, 23.108944416046143, 22.90967684984207, 22.810300186276436, 21.12621736278136, 20.98858058949311, 21.02151647706826, 21.558019409577042, 21.646716504047305, 21.68010032052794, 22.74619125202298, 22.85234908014536, 22.743009313941002, 19.197549814979226, 19.033959391216428, 18.839590842525155, 26.836585397521645, 27.21182995910445, 27.10850119094053, 21.004217396179826, 20.75462622443834, 21.081656011442334, 26.124239459633827, 26.785485207103193, 26.442563876509666, 29.3702481132932, 28.95638172328472, 29.27758035995066, 21.956935947140053, 22.21747291584809, 22.27608462174733, 22.72933329393466, 22.92343501405169, 22.905734353077904, 23.388032654921204, 23.67650295390436, 23.432294505337865, 13.920185690124825, 14.066687275966004, 14.218335909148053, 24.433264270424843, 24.73069809138542, 24.143173940479755, 19.467466592788696, 19.513137720525265, 19.4522839859128, 19.102276602449507, 18.927981952826173, 18.716983112196118, 31.882193495829895, 32.11379609753688, 32.362276182820395, 19.929288325210408, 20.045564991732434, 20.197444164504603, 22.552461134890706, 22.633410948018224, 22.630319273720175, 27.342330187559128, 27.101250521838665, 27.68697146140039, 19.308232287565858, 19.817637684444577, 19.02201361457506, 17.099416127894074, 17.09636106621474, 16.487950012087822, 25.65558894568433, 24.247017582257584, 25.471695890029267, 23.320247585574776, 23.151056746641785, 23.393362833807856, 22.192481615891055, 22.279172250380114, 21.6797525336345, 25.49215766787529, 25.0816645398736, 25.382833622395992, 30.55244869987169, 31.054163719216973, 30.713459732631833, 22.7542169218262, 22.867900506903723, 22.042056789000824, 26.098652253548295, 26.04521210740009, 25.974198425809533, 21.565936778982476, 21.968714346488312, 21.936364353944853, 35.296423358221844, 35.20293429245551, 35.16646135350068, 20.794279185434178, 20.86597342168291, 20.971022510280207, 29.29565993448098, 29.59288426985343, 29.793441252162054, 28.338403582572937, 28.693103186786175, 28.65923409536481, 23.192787448565156, 24.414564062530786, 24.030975605050713, 17.95569382607937, 18.140744902193546, 18.030946888029575, 24.323073908686638, 24.517766296863556, 24.60798990353942, 18.871258608996868, 19.379771996173076, 19.205571934580803, 24.77200324833393, 25.39634795114398, 25.02588491141796, 26.567841211954743, 27.19749095166722, 26.743412504593522, 32.06984602070102, 32.039039383331925, 31.754490869740636, 24.194515593349934, 23.712709084153175, 24.20944495499134, 30.725687477737665, 30.664860863238573, 30.60992655903101, 16.751628922919423, 16.913406788061053, 16.76792516807714, 28.98257293303807, 28.941246555497244, 28.488353719313935, 25.10090352098146, 25.153647037843854, 24.761524769167096, 20.224770570794732, 19.622315655151993, 20.864110628763825, 26.690164901316166, 26.764226093888283, 27.12060935702175, 28.372631210833788, 28.480098478496075, 27.495682582259178, 33.07723407198985, 33.204727736612156, 32.643992980321244, 25.97425193960467, 25.894943843285233, 25.563749144474656, 20.36389611661434, 21.37223624624312, 21.156695038080215, 21.538465480009705, 21.532104956607014, 21.93194833646217, 35.18093002587557, 35.17750186473131, 35.61693526490126, 27.825786625345543, 27.606004407008484, 27.791573894520596, 28.378194474304706, 27.82360146443048, 27.244690010944993, -3.1707162857055664, -2.994194932281971, -2.450358623638749, 17.047304660081863, 17.755315005779266, 17.906933203339577, 27.852776592597365, 27.923788313753903, 27.599449448287487, 24.498194366693497, 24.306083157658577, 23.552591487765312, 10.231667626028255, 10.08748087038596, 10.173031417032078, 23.536742508411407, 22.780456572771072, 23.76370630413294, 27.247959852218628, 27.7440417855978, 27.27960731089115, 21.061237110445887, 20.898939604560525, 20.936338445792586, 19.229355576137692, 19.45681498448053, 19.332547942797333, 26.566227725396544, 26.215313183764607, 26.414663488666207, 21.418230317533016, 21.393397942185402, 21.567489121109247, 28.90725936740637, 29.02186717838049, 28.651824593544006, 27.885048317412526, 27.948789263765008, 27.469818259278924, 22.07434300892055, 22.13522344455123, 22.057061340659857, 22.359012233714253, 22.067740129927785, 22.415719012419373, 21.011308910946042, 20.919873783985764, 21.501143187905342, 22.606411923964814, 22.52342042823632, 23.125974976258775, 27.861784880359963, 27.78821341445048, 27.458465841909245, 15.481624394655228, 15.269927211105824, 15.171787716448307, 30.85222940643628, 30.49977745612462, 30.30496846636136, 29.96145310997963, 29.83709168806672, 29.996516678482294, 16.49597092717886, 16.37264370173216, 16.322449252009392, 27.557806884249047, 27.3310837795337, 27.839419263725475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14125552914082984, "mean_inference_ms": 0.6469060753048668, "mean_action_processing_ms": 0.09507857859140077, "mean_env_wait_ms": 0.79548752435919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 916800, "timesteps_this_iter": 0, "agent_timesteps_total": 2750400, "timers": {"sample_time_ms": 9488.899, "sample_throughput": 505.854, "load_time_ms": 0.2, "load_throughput": 24036126.074, "learn_time_ms": 1207.681, "learn_throughput": 3974.558, "update_time_ms": 1.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.35811972618103, "policy_loss": -0.0003753878963309587, "vf_loss": 6.519925594329834, "vf_explained_var": 0.00897815078496933, "kl": 0.010417977464661773, "entropy": 16.19586730003357, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 916800, "num_agent_steps_sampled": 2750400, "num_steps_trained": 916800, "num_agent_steps_trained": 2750400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3985, "training_iteration": 191, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-12-31", "timestamp": 1706148751, "time_this_iter_s": 9.601771354675293, "time_total_s": 1789.3109335899353, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1C430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1789.3109335899353, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 7.946153846153846, "ram_util_percent": 48.0846153846154}}
{"episode_reward_max": 105.97536715550814, "episode_reward_min": -8.615269841626287, "episode_reward_mean": 71.84734461932341, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -3.1707162857055664}, "policy_reward_max": {"shared_policy": 35.61693526490126}, "policy_reward_mean": {"shared_policy": 23.9491148731078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.73514801636335, 80.56417581718414, 67.85456535592675, 65.56006582104601, 68.012122397311, 68.82892145216465, 63.13631442934273, 64.88483623415229, 68.34154964610934, 57.07110004872081, 81.15691654756662, 62.8404996320605, 79.35228854324669, 87.60421019652858, 66.45049348473547, 68.55850266106425, 70.49683011416343, 42.20520887523888, 73.30713630229002, 58.43288829922676, 56.7472416674718, 96.35826577618717, 60.172297481447444, 67.8161913566291, 82.13055217079818, 58.14788358658549, 50.683727206196636, 75.37430241797118, 69.86466716602442, 66.15140639990567, 75.95665583014488, 92.3200721517205, 67.66417421773075, 78.11806278675792, 65.47101547941564, 105.66581900417803, 62.631275117397294, 88.68198545649646, 85.69074086472392, 71.63832711614666, 54.12738561630249, 73.44883010908961, 57.45660253975075, 75.19423611089587, 80.50874466821548, 95.86337627377358, 72.11666963249445, 92.00047490000725, 50.43296087905762, 86.41217320784925, 75.01607532799241, 60.71119685471055, 80.5750003522262, 84.34841227158904, 98.92595478892325, 77.43294492736456, 62.892827400937676, 65.00251877307889, 105.97536715550814, 83.22336492687462, 83.44648594968018, -8.615269841626287, 52.70955286920071, 83.37601435463876, 72.35686901211739, 30.492179913446293, 70.08090538531542, 82.27160894870758, 62.896515160799, 58.018718503415556, 79.19620439782736, 64.37911738082767, 86.58095113933086, 83.30365584045646, 66.26662779413164, 66.84247137606141, 63.43232588283715, 68.25580732845991, 83.10846413671969, 45.92333932220936, 91.65697532892226, 89.79506147652864, 49.19106388092041, 82.72830992750822, 70.89941215142605, 83.93719853460789, 77.53645902127025, 75.16381553676909, 88.1998322457075, 82.00657962169495, 51.8188600298017, 67.61418620310722, 69.83912503533062, 60.59669307991862, 67.86683601327238, 74.0882362090051, 78.5008704960346, 69.0410305149853, 94.12265486270188, 74.4651630632579], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [29.183091862748057, 29.233623842398316, 29.31843231121698, 26.89937141289313, 27.10023090274383, 26.564573501547173, 22.405239067971706, 22.739540193229914, 22.709786094725132, 21.943420497700572, 21.546808294951916, 22.069837028393522, 23.14045348732421, 22.81505891184011, 22.056609998146683, 23.108944416046143, 22.90967684984207, 22.810300186276436, 21.12621736278136, 20.98858058949311, 21.02151647706826, 21.558019409577042, 21.646716504047305, 21.68010032052794, 22.74619125202298, 22.85234908014536, 22.743009313941002, 19.197549814979226, 19.033959391216428, 18.839590842525155, 26.836585397521645, 27.21182995910445, 27.10850119094053, 21.004217396179826, 20.75462622443834, 21.081656011442334, 26.124239459633827, 26.785485207103193, 26.442563876509666, 29.3702481132932, 28.95638172328472, 29.27758035995066, 21.956935947140053, 22.21747291584809, 22.27608462174733, 22.72933329393466, 22.92343501405169, 22.905734353077904, 23.388032654921204, 23.67650295390436, 23.432294505337865, 13.920185690124825, 14.066687275966004, 14.218335909148053, 24.433264270424843, 24.73069809138542, 24.143173940479755, 19.467466592788696, 19.513137720525265, 19.4522839859128, 19.102276602449507, 18.927981952826173, 18.716983112196118, 31.882193495829895, 32.11379609753688, 32.362276182820395, 19.929288325210408, 20.045564991732434, 20.197444164504603, 22.552461134890706, 22.633410948018224, 22.630319273720175, 27.342330187559128, 27.101250521838665, 27.68697146140039, 19.308232287565858, 19.817637684444577, 19.02201361457506, 17.099416127894074, 17.09636106621474, 16.487950012087822, 25.65558894568433, 24.247017582257584, 25.471695890029267, 23.320247585574776, 23.151056746641785, 23.393362833807856, 22.192481615891055, 22.279172250380114, 21.6797525336345, 25.49215766787529, 25.0816645398736, 25.382833622395992, 30.55244869987169, 31.054163719216973, 30.713459732631833, 22.7542169218262, 22.867900506903723, 22.042056789000824, 26.098652253548295, 26.04521210740009, 25.974198425809533, 21.565936778982476, 21.968714346488312, 21.936364353944853, 35.296423358221844, 35.20293429245551, 35.16646135350068, 20.794279185434178, 20.86597342168291, 20.971022510280207, 29.29565993448098, 29.59288426985343, 29.793441252162054, 28.338403582572937, 28.693103186786175, 28.65923409536481, 23.192787448565156, 24.414564062530786, 24.030975605050713, 17.95569382607937, 18.140744902193546, 18.030946888029575, 24.323073908686638, 24.517766296863556, 24.60798990353942, 18.871258608996868, 19.379771996173076, 19.205571934580803, 24.77200324833393, 25.39634795114398, 25.02588491141796, 26.567841211954743, 27.19749095166722, 26.743412504593522, 32.06984602070102, 32.039039383331925, 31.754490869740636, 24.194515593349934, 23.712709084153175, 24.20944495499134, 30.725687477737665, 30.664860863238573, 30.60992655903101, 16.751628922919423, 16.913406788061053, 16.76792516807714, 28.98257293303807, 28.941246555497244, 28.488353719313935, 25.10090352098146, 25.153647037843854, 24.761524769167096, 20.224770570794732, 19.622315655151993, 20.864110628763825, 26.690164901316166, 26.764226093888283, 27.12060935702175, 28.372631210833788, 28.480098478496075, 27.495682582259178, 33.07723407198985, 33.204727736612156, 32.643992980321244, 25.97425193960467, 25.894943843285233, 25.563749144474656, 20.36389611661434, 21.37223624624312, 21.156695038080215, 21.538465480009705, 21.532104956607014, 21.93194833646217, 35.18093002587557, 35.17750186473131, 35.61693526490126, 27.825786625345543, 27.606004407008484, 27.791573894520596, 28.378194474304706, 27.82360146443048, 27.244690010944993, -3.1707162857055664, -2.994194932281971, -2.450358623638749, 17.047304660081863, 17.755315005779266, 17.906933203339577, 27.852776592597365, 27.923788313753903, 27.599449448287487, 24.498194366693497, 24.306083157658577, 23.552591487765312, 10.231667626028255, 10.08748087038596, 10.173031417032078, 23.536742508411407, 22.780456572771072, 23.76370630413294, 27.247959852218628, 27.7440417855978, 27.27960731089115, 21.061237110445887, 20.898939604560525, 20.936338445792586, 19.229355576137692, 19.45681498448053, 19.332547942797333, 26.566227725396544, 26.215313183764607, 26.414663488666207, 21.418230317533016, 21.393397942185402, 21.567489121109247, 28.90725936740637, 29.02186717838049, 28.651824593544006, 27.885048317412526, 27.948789263765008, 27.469818259278924, 22.07434300892055, 22.13522344455123, 22.057061340659857, 22.359012233714253, 22.067740129927785, 22.415719012419373, 21.011308910946042, 20.919873783985764, 21.501143187905342, 22.606411923964814, 22.52342042823632, 23.125974976258775, 27.861784880359963, 27.78821341445048, 27.458465841909245, 15.481624394655228, 15.269927211105824, 15.171787716448307, 30.85222940643628, 30.49977745612462, 30.30496846636136, 29.96145310997963, 29.83709168806672, 29.996516678482294, 16.49597092717886, 16.37264370173216, 16.322449252009392, 27.557806884249047, 27.3310837795337, 27.839419263725475, 23.504799152413995, 23.49571909258762, 23.898893906424433, 27.674255698919296, 28.12004427611828, 28.142898559570312, 26.0916952031354, 25.579870137075574, 25.86489368105927, 24.965649728973702, 24.857238565882042, 25.34092724191335, 29.45904317994912, 29.139865708847836, 29.600923356910542, 27.23729297767082, 27.254732849697263, 27.514553794326872, 16.94017348686853, 17.235882970194012, 17.642803572739155, 22.78436313134928, 22.546171580751732, 22.28365149100621, 23.510465138281376, 23.278432982663304, 23.050226914385945, 20.003980539739132, 20.304123677313328, 20.288588862866163, 22.745011659959943, 22.399618017176778, 22.722206336135656, 24.505348597963646, 24.95987594251831, 24.623011668523148, 25.929569611946732, 26.099579791227967, 26.471721092859894, 23.270135855923087, 22.939026261369378, 22.83186839769283, 30.74949938555558, 31.785786633690194, 31.587368843456105, 24.83158492545286, 24.778113188842923, 24.855464948962123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1412595636839318, "mean_inference_ms": 0.6470610068575354, "mean_action_processing_ms": 0.0950748027858699, "mean_env_wait_ms": 0.7955353447116345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 921600, "timesteps_this_iter": 0, "agent_timesteps_total": 2764800, "timers": {"sample_time_ms": 9470.474, "sample_throughput": 506.838, "load_time_ms": 0.2, "load_throughput": 24036126.074, "learn_time_ms": 1202.893, "learn_throughput": 3990.381, "update_time_ms": 1.507}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 6.759147465229034, "policy_loss": 0.000654867854742669, "vf_loss": 6.918056786060333, "vf_explained_var": 0.018433548510074615, "kl": 0.015876808669699455, "entropy": 16.03686785697937, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 921600, "num_agent_steps_sampled": 2764800, "num_steps_trained": 921600, "num_agent_steps_trained": 2764800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4001, "training_iteration": 192, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-12-40", "timestamp": 1706148760, "time_this_iter_s": 9.485750436782837, "time_total_s": 1798.7966840267181, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1CD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1798.7966840267181, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 9.092857142857143, "ram_util_percent": 48.114285714285714}}
{"episode_reward_max": 105.97536715550814, "episode_reward_min": -8.615269841626287, "episode_reward_mean": 72.75374211546165, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -3.1707162857055664}, "policy_reward_max": {"shared_policy": 35.61693526490126}, "policy_reward_mean": {"shared_policy": 24.251247371820543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.49683011416343, 42.20520887523888, 73.30713630229002, 58.43288829922676, 56.7472416674718, 96.35826577618717, 60.172297481447444, 67.8161913566291, 82.13055217079818, 58.14788358658549, 50.683727206196636, 75.37430241797118, 69.86466716602442, 66.15140639990567, 75.95665583014488, 92.3200721517205, 67.66417421773075, 78.11806278675792, 65.47101547941564, 105.66581900417803, 62.631275117397294, 88.68198545649646, 85.69074086472392, 71.63832711614666, 54.12738561630249, 73.44883010908961, 57.45660253975075, 75.19423611089587, 80.50874466821548, 95.86337627377358, 72.11666963249445, 92.00047490000725, 50.43296087905762, 86.41217320784925, 75.01607532799241, 60.71119685471055, 80.5750003522262, 84.34841227158904, 98.92595478892325, 77.43294492736456, 62.892827400937676, 65.00251877307889, 105.97536715550814, 83.22336492687462, 83.44648594968018, -8.615269841626287, 52.70955286920071, 83.37601435463876, 72.35686901211739, 30.492179913446293, 70.08090538531542, 82.27160894870758, 62.896515160799, 58.018718503415556, 79.19620439782736, 64.37911738082767, 86.58095113933086, 83.30365584045646, 66.26662779413164, 66.84247137606141, 63.43232588283715, 68.25580732845991, 83.10846413671969, 45.92333932220936, 91.65697532892226, 89.79506147652864, 49.19106388092041, 82.72830992750822, 70.89941215142605, 83.93719853460789, 77.53645902127025, 75.16381553676909, 88.1998322457075, 82.00657962169495, 51.8188600298017, 67.61418620310722, 69.83912503533062, 60.59669307991862, 67.86683601327238, 74.0882362090051, 78.5008704960346, 69.0410305149853, 94.12265486270188, 74.4651630632579, 88.2731185276061, 104.28521060571072, 73.2312727794051, 74.04851235821842, 72.24455929454413, 86.22190890088677, 94.16042953077702, 70.66962839290498, 70.00596777349709, 70.99503563903271, 73.07580027729273, 53.90772309247403, 61.99473389238119, 65.48621908202765, 94.9512119591236, 75.04012779146431], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.388032654921204, 23.67650295390436, 23.432294505337865, 13.920185690124825, 14.066687275966004, 14.218335909148053, 24.433264270424843, 24.73069809138542, 24.143173940479755, 19.467466592788696, 19.513137720525265, 19.4522839859128, 19.102276602449507, 18.927981952826173, 18.716983112196118, 31.882193495829895, 32.11379609753688, 32.362276182820395, 19.929288325210408, 20.045564991732434, 20.197444164504603, 22.552461134890706, 22.633410948018224, 22.630319273720175, 27.342330187559128, 27.101250521838665, 27.68697146140039, 19.308232287565858, 19.817637684444577, 19.02201361457506, 17.099416127894074, 17.09636106621474, 16.487950012087822, 25.65558894568433, 24.247017582257584, 25.471695890029267, 23.320247585574776, 23.151056746641785, 23.393362833807856, 22.192481615891055, 22.279172250380114, 21.6797525336345, 25.49215766787529, 25.0816645398736, 25.382833622395992, 30.55244869987169, 31.054163719216973, 30.713459732631833, 22.7542169218262, 22.867900506903723, 22.042056789000824, 26.098652253548295, 26.04521210740009, 25.974198425809533, 21.565936778982476, 21.968714346488312, 21.936364353944853, 35.296423358221844, 35.20293429245551, 35.16646135350068, 20.794279185434178, 20.86597342168291, 20.971022510280207, 29.29565993448098, 29.59288426985343, 29.793441252162054, 28.338403582572937, 28.693103186786175, 28.65923409536481, 23.192787448565156, 24.414564062530786, 24.030975605050713, 17.95569382607937, 18.140744902193546, 18.030946888029575, 24.323073908686638, 24.517766296863556, 24.60798990353942, 18.871258608996868, 19.379771996173076, 19.205571934580803, 24.77200324833393, 25.39634795114398, 25.02588491141796, 26.567841211954743, 27.19749095166722, 26.743412504593522, 32.06984602070102, 32.039039383331925, 31.754490869740636, 24.194515593349934, 23.712709084153175, 24.20944495499134, 30.725687477737665, 30.664860863238573, 30.60992655903101, 16.751628922919423, 16.913406788061053, 16.76792516807714, 28.98257293303807, 28.941246555497244, 28.488353719313935, 25.10090352098146, 25.153647037843854, 24.761524769167096, 20.224770570794732, 19.622315655151993, 20.864110628763825, 26.690164901316166, 26.764226093888283, 27.12060935702175, 28.372631210833788, 28.480098478496075, 27.495682582259178, 33.07723407198985, 33.204727736612156, 32.643992980321244, 25.97425193960467, 25.894943843285233, 25.563749144474656, 20.36389611661434, 21.37223624624312, 21.156695038080215, 21.538465480009705, 21.532104956607014, 21.93194833646217, 35.18093002587557, 35.17750186473131, 35.61693526490126, 27.825786625345543, 27.606004407008484, 27.791573894520596, 28.378194474304706, 27.82360146443048, 27.244690010944993, -3.1707162857055664, -2.994194932281971, -2.450358623638749, 17.047304660081863, 17.755315005779266, 17.906933203339577, 27.852776592597365, 27.923788313753903, 27.599449448287487, 24.498194366693497, 24.306083157658577, 23.552591487765312, 10.231667626028255, 10.08748087038596, 10.173031417032078, 23.536742508411407, 22.780456572771072, 23.76370630413294, 27.247959852218628, 27.7440417855978, 27.27960731089115, 21.061237110445887, 20.898939604560525, 20.936338445792586, 19.229355576137692, 19.45681498448053, 19.332547942797333, 26.566227725396544, 26.215313183764607, 26.414663488666207, 21.418230317533016, 21.393397942185402, 21.567489121109247, 28.90725936740637, 29.02186717838049, 28.651824593544006, 27.885048317412526, 27.948789263765008, 27.469818259278924, 22.07434300892055, 22.13522344455123, 22.057061340659857, 22.359012233714253, 22.067740129927785, 22.415719012419373, 21.011308910946042, 20.919873783985764, 21.501143187905342, 22.606411923964814, 22.52342042823632, 23.125974976258775, 27.861784880359963, 27.78821341445048, 27.458465841909245, 15.481624394655228, 15.269927211105824, 15.171787716448307, 30.85222940643628, 30.49977745612462, 30.30496846636136, 29.96145310997963, 29.83709168806672, 29.996516678482294, 16.49597092717886, 16.37264370173216, 16.322449252009392, 27.557806884249047, 27.3310837795337, 27.839419263725475, 23.504799152413995, 23.49571909258762, 23.898893906424433, 27.674255698919296, 28.12004427611828, 28.142898559570312, 26.0916952031354, 25.579870137075574, 25.86489368105927, 24.965649728973702, 24.857238565882042, 25.34092724191335, 29.45904317994912, 29.139865708847836, 29.600923356910542, 27.23729297767082, 27.254732849697263, 27.514553794326872, 16.94017348686853, 17.235882970194012, 17.642803572739155, 22.78436313134928, 22.546171580751732, 22.28365149100621, 23.510465138281376, 23.278432982663304, 23.050226914385945, 20.003980539739132, 20.304123677313328, 20.288588862866163, 22.745011659959943, 22.399618017176778, 22.722206336135656, 24.505348597963646, 24.95987594251831, 24.623011668523148, 25.929569611946732, 26.099579791227967, 26.471721092859894, 23.270135855923087, 22.939026261369378, 22.83186839769283, 30.74949938555558, 31.785786633690194, 31.587368843456105, 24.83158492545286, 24.778113188842923, 24.855464948962123, 29.339724166939646, 29.496311966950685, 29.43708239371577, 34.87042025725046, 34.86336729551354, 34.55142305294672, 23.894916017850235, 24.273340319593743, 25.063016441961125, 24.513138105471924, 24.636811447640255, 24.898562805106238, 24.006463232139737, 24.383987890246004, 23.85410817215839, 28.810634933412075, 28.9316976480186, 28.4795763194561, 31.399661972497896, 31.220445362230137, 31.54032219604899, 24.030044728269175, 22.957313319047287, 23.68227034558852, 22.970511381824807, 23.586743128796414, 23.44871326287587, 23.376991187532738, 24.01856525552769, 23.59947919597228, 24.512879736721516, 24.214143753051758, 24.348776787519455, 18.206829768915966, 17.354187225302056, 18.346706098256007, 20.594118885695934, 20.871523670852184, 20.529091335833073, 21.394780943791062, 22.055892808983714, 22.03554532925287, 31.822639250506953, 31.58514368658264, 31.543429022034005, 24.6557381649812, 25.145280109097556, 25.239109517385558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14126579354674942, "mean_inference_ms": 0.6472057788264955, "mean_action_processing_ms": 0.09506378097399303, "mean_env_wait_ms": 0.7955852317676485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 926400, "timesteps_this_iter": 0, "agent_timesteps_total": 2779200, "timers": {"sample_time_ms": 9425.255, "sample_throughput": 509.27, "load_time_ms": 0.2, "load_throughput": 24036126.074, "learn_time_ms": 1198.638, "learn_throughput": 4004.544, "update_time_ms": 1.407}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 7.454999685287476, "policy_loss": -0.00041260702912193636, "vf_loss": 7.615168511867523, "vf_explained_var": 0.02464645355939865, "kl": 0.01143873395659114, "entropy": 16.033586621284485, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 926400, "num_agent_steps_sampled": 2779200, "num_steps_trained": 926400, "num_agent_steps_trained": 2779200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4017, "training_iteration": 193, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-12-49", "timestamp": 1706148769, "time_this_iter_s": 9.276183366775513, "time_total_s": 1808.0728673934937, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1808.0728673934937, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 7.084615384615384, "ram_util_percent": 48.2}}
{"episode_reward_max": 110.04549300298092, "episode_reward_min": -294.3901855535805, "episode_reward_mean": 70.1013484989405, "episode_len_mean": 297.66, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.49598601212105}, "policy_reward_max": {"shared_policy": 36.85035572076836}, "policy_reward_mean": {"shared_policy": 23.367116166313494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.66417421773075, 78.11806278675792, 65.47101547941564, 105.66581900417803, 62.631275117397294, 88.68198545649646, 85.69074086472392, 71.63832711614666, 54.12738561630249, 73.44883010908961, 57.45660253975075, 75.19423611089587, 80.50874466821548, 95.86337627377358, 72.11666963249445, 92.00047490000725, 50.43296087905762, 86.41217320784925, 75.01607532799241, 60.71119685471055, 80.5750003522262, 84.34841227158904, 98.92595478892325, 77.43294492736456, 62.892827400937676, 65.00251877307889, 105.97536715550814, 83.22336492687462, 83.44648594968018, -8.615269841626287, 52.70955286920071, 83.37601435463876, 72.35686901211739, 30.492179913446293, 70.08090538531542, 82.27160894870758, 62.896515160799, 58.018718503415556, 79.19620439782736, 64.37911738082767, 86.58095113933086, 83.30365584045646, 66.26662779413164, 66.84247137606141, 63.43232588283715, 68.25580732845991, 83.10846413671969, 45.92333932220936, 91.65697532892226, 89.79506147652864, 49.19106388092041, 82.72830992750822, 70.89941215142605, 83.93719853460789, 77.53645902127025, 75.16381553676909, 88.1998322457075, 82.00657962169495, 51.8188600298017, 67.61418620310722, 69.83912503533062, 60.59669307991862, 67.86683601327238, 74.0882362090051, 78.5008704960346, 69.0410305149853, 94.12265486270188, 74.4651630632579, 88.2731185276061, 104.28521060571072, 73.2312727794051, 74.04851235821842, 72.24455929454413, 86.22190890088677, 94.16042953077702, 70.66962839290498, 70.00596777349709, 70.99503563903271, 73.07580027729273, 53.90772309247403, 61.99473389238119, 65.48621908202765, 94.9512119591236, 75.04012779146431, 55.82478251308201, 63.398371096700416, 61.16560783144084, 72.42509400099516, 82.7620566189289, 110.04549300298092, 64.6959698423743, 69.47357418388125, 77.86156346835196, 92.96116521209476, 76.99160329997537, 71.52868130430576, -294.3901855535805, 106.59747862443328, 47.883228376507745, 71.70148132741451], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 66, 300, 300, 300], "policy_shared_policy_reward": [22.7542169218262, 22.867900506903723, 22.042056789000824, 26.098652253548295, 26.04521210740009, 25.974198425809533, 21.565936778982476, 21.968714346488312, 21.936364353944853, 35.296423358221844, 35.20293429245551, 35.16646135350068, 20.794279185434178, 20.86597342168291, 20.971022510280207, 29.29565993448098, 29.59288426985343, 29.793441252162054, 28.338403582572937, 28.693103186786175, 28.65923409536481, 23.192787448565156, 24.414564062530786, 24.030975605050713, 17.95569382607937, 18.140744902193546, 18.030946888029575, 24.323073908686638, 24.517766296863556, 24.60798990353942, 18.871258608996868, 19.379771996173076, 19.205571934580803, 24.77200324833393, 25.39634795114398, 25.02588491141796, 26.567841211954743, 27.19749095166722, 26.743412504593522, 32.06984602070102, 32.039039383331925, 31.754490869740636, 24.194515593349934, 23.712709084153175, 24.20944495499134, 30.725687477737665, 30.664860863238573, 30.60992655903101, 16.751628922919423, 16.913406788061053, 16.76792516807714, 28.98257293303807, 28.941246555497244, 28.488353719313935, 25.10090352098146, 25.153647037843854, 24.761524769167096, 20.224770570794732, 19.622315655151993, 20.864110628763825, 26.690164901316166, 26.764226093888283, 27.12060935702175, 28.372631210833788, 28.480098478496075, 27.495682582259178, 33.07723407198985, 33.204727736612156, 32.643992980321244, 25.97425193960467, 25.894943843285233, 25.563749144474656, 20.36389611661434, 21.37223624624312, 21.156695038080215, 21.538465480009705, 21.532104956607014, 21.93194833646217, 35.18093002587557, 35.17750186473131, 35.61693526490126, 27.825786625345543, 27.606004407008484, 27.791573894520596, 28.378194474304706, 27.82360146443048, 27.244690010944993, -3.1707162857055664, -2.994194932281971, -2.450358623638749, 17.047304660081863, 17.755315005779266, 17.906933203339577, 27.852776592597365, 27.923788313753903, 27.599449448287487, 24.498194366693497, 24.306083157658577, 23.552591487765312, 10.231667626028255, 10.08748087038596, 10.173031417032078, 23.536742508411407, 22.780456572771072, 23.76370630413294, 27.247959852218628, 27.7440417855978, 27.27960731089115, 21.061237110445887, 20.898939604560525, 20.936338445792586, 19.229355576137692, 19.45681498448053, 19.332547942797333, 26.566227725396544, 26.215313183764607, 26.414663488666207, 21.418230317533016, 21.393397942185402, 21.567489121109247, 28.90725936740637, 29.02186717838049, 28.651824593544006, 27.885048317412526, 27.948789263765008, 27.469818259278924, 22.07434300892055, 22.13522344455123, 22.057061340659857, 22.359012233714253, 22.067740129927785, 22.415719012419373, 21.011308910946042, 20.919873783985764, 21.501143187905342, 22.606411923964814, 22.52342042823632, 23.125974976258775, 27.861784880359963, 27.78821341445048, 27.458465841909245, 15.481624394655228, 15.269927211105824, 15.171787716448307, 30.85222940643628, 30.49977745612462, 30.30496846636136, 29.96145310997963, 29.83709168806672, 29.996516678482294, 16.49597092717886, 16.37264370173216, 16.322449252009392, 27.557806884249047, 27.3310837795337, 27.839419263725475, 23.504799152413995, 23.49571909258762, 23.898893906424433, 27.674255698919296, 28.12004427611828, 28.142898559570312, 26.0916952031354, 25.579870137075574, 25.86489368105927, 24.965649728973702, 24.857238565882042, 25.34092724191335, 29.45904317994912, 29.139865708847836, 29.600923356910542, 27.23729297767082, 27.254732849697263, 27.514553794326872, 16.94017348686853, 17.235882970194012, 17.642803572739155, 22.78436313134928, 22.546171580751732, 22.28365149100621, 23.510465138281376, 23.278432982663304, 23.050226914385945, 20.003980539739132, 20.304123677313328, 20.288588862866163, 22.745011659959943, 22.399618017176778, 22.722206336135656, 24.505348597963646, 24.95987594251831, 24.623011668523148, 25.929569611946732, 26.099579791227967, 26.471721092859894, 23.270135855923087, 22.939026261369378, 22.83186839769283, 30.74949938555558, 31.785786633690194, 31.587368843456105, 24.83158492545286, 24.778113188842923, 24.855464948962123, 29.339724166939646, 29.496311966950685, 29.43708239371577, 34.87042025725046, 34.86336729551354, 34.55142305294672, 23.894916017850235, 24.273340319593743, 25.063016441961125, 24.513138105471924, 24.636811447640255, 24.898562805106238, 24.006463232139737, 24.383987890246004, 23.85410817215839, 28.810634933412075, 28.9316976480186, 28.4795763194561, 31.399661972497896, 31.220445362230137, 31.54032219604899, 24.030044728269175, 22.957313319047287, 23.68227034558852, 22.970511381824807, 23.586743128796414, 23.44871326287587, 23.376991187532738, 24.01856525552769, 23.59947919597228, 24.512879736721516, 24.214143753051758, 24.348776787519455, 18.206829768915966, 17.354187225302056, 18.346706098256007, 20.594118885695934, 20.871523670852184, 20.529091335833073, 21.394780943791062, 22.055892808983714, 22.03554532925287, 31.822639250506953, 31.58514368658264, 31.543429022034005, 24.6557381649812, 25.145280109097556, 25.239109517385558, 18.74022090186675, 18.825931524236992, 18.258630086978272, 21.100606334706143, 21.1588719052573, 21.138892856736973, 20.730261178376765, 20.63516407708326, 19.800182575980813, 24.4784087613225, 24.392923519015312, 23.55376172065735, 27.68786735584338, 27.380413447817162, 27.693775815268353, 36.85035572076836, 36.70749044666687, 36.48764683554569, 21.829468900958688, 21.41246374199787, 21.45403719941774, 23.213672856489808, 23.30606612811485, 22.953835199276597, 25.761500388383865, 26.130542816594243, 25.96952026337385, 30.89162943760553, 31.401965337495, 30.667570436994225, 25.682238476971776, 25.55774054179588, 25.75162428120771, 23.95308388924846, 23.591756793359906, 23.983840621697397, -95.5280673702558, -104.49598601212105, -94.3661321712037, 35.55847054719925, 35.935063403099775, 35.103944674134254, 15.718207662304238, 16.163161886235073, 16.001858827968434, 24.307244017720222, 23.664515510201454, 23.729721799492836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14126714462935558, "mean_inference_ms": 0.6473222183284539, "mean_action_processing_ms": 0.09505535618963602, "mean_env_wait_ms": 0.7956165209763475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 931200, "timesteps_this_iter": 0, "agent_timesteps_total": 2793600, "timers": {"sample_time_ms": 9434.386, "sample_throughput": 508.777, "load_time_ms": 0.2, "load_throughput": 24036126.074, "learn_time_ms": 1198.238, "learn_throughput": 4005.881, "update_time_ms": 1.407}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.050682163238525396, "cur_lr": 0.0005, "total_loss": 96.11223983764648, "policy_loss": -0.001544243804908696, "vf_loss": 96.27323627471924, "vf_explained_var": -0.004250660538673401, "kl": 0.04140151734491876, "entropy": 16.154709577560425, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 931200, "num_agent_steps_sampled": 2793600, "num_steps_trained": 931200, "num_agent_steps_trained": 2793600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4033, "training_iteration": 194, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-12-59", "timestamp": 1706148779, "time_this_iter_s": 9.4208505153656, "time_total_s": 1817.4937179088593, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1817.4937179088593, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 8.515384615384615, "ram_util_percent": 48.1923076923077}}
{"episode_reward_max": 110.04549300298092, "episode_reward_min": -294.3901855535805, "episode_reward_mean": 69.17954743509719, "episode_len_mean": 297.66, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.49598601212105}, "policy_reward_max": {"shared_policy": 36.85035572076836}, "policy_reward_mean": {"shared_policy": 23.05984914503239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.43296087905762, 86.41217320784925, 75.01607532799241, 60.71119685471055, 80.5750003522262, 84.34841227158904, 98.92595478892325, 77.43294492736456, 62.892827400937676, 65.00251877307889, 105.97536715550814, 83.22336492687462, 83.44648594968018, -8.615269841626287, 52.70955286920071, 83.37601435463876, 72.35686901211739, 30.492179913446293, 70.08090538531542, 82.27160894870758, 62.896515160799, 58.018718503415556, 79.19620439782736, 64.37911738082767, 86.58095113933086, 83.30365584045646, 66.26662779413164, 66.84247137606141, 63.43232588283715, 68.25580732845991, 83.10846413671969, 45.92333932220936, 91.65697532892226, 89.79506147652864, 49.19106388092041, 82.72830992750822, 70.89941215142605, 83.93719853460789, 77.53645902127025, 75.16381553676909, 88.1998322457075, 82.00657962169495, 51.8188600298017, 67.61418620310722, 69.83912503533062, 60.59669307991862, 67.86683601327238, 74.0882362090051, 78.5008704960346, 69.0410305149853, 94.12265486270188, 74.4651630632579, 88.2731185276061, 104.28521060571072, 73.2312727794051, 74.04851235821842, 72.24455929454413, 86.22190890088677, 94.16042953077702, 70.66962839290498, 70.00596777349709, 70.99503563903271, 73.07580027729273, 53.90772309247403, 61.99473389238119, 65.48621908202765, 94.9512119591236, 75.04012779146431, 55.82478251308201, 63.398371096700416, 61.16560783144084, 72.42509400099516, 82.7620566189289, 110.04549300298092, 64.6959698423743, 69.47357418388125, 77.86156346835196, 92.96116521209476, 76.99160329997537, 71.52868130430576, -294.3901855535805, 106.59747862443328, 47.883228376507745, 71.70148132741451, 71.70743238041176, 75.39588420465587, 70.07021111994979, 64.18526981770992, 69.85977605730295, 69.11286554113028, 92.94818960130212, 58.103723399341106, 65.50471286289392, 73.76709685847163, 96.47922404296693, 64.35854240367188, 85.06684620305893, 53.81607246701604, 64.08735690265894, 59.63440964650361], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.751628922919423, 16.913406788061053, 16.76792516807714, 28.98257293303807, 28.941246555497244, 28.488353719313935, 25.10090352098146, 25.153647037843854, 24.761524769167096, 20.224770570794732, 19.622315655151993, 20.864110628763825, 26.690164901316166, 26.764226093888283, 27.12060935702175, 28.372631210833788, 28.480098478496075, 27.495682582259178, 33.07723407198985, 33.204727736612156, 32.643992980321244, 25.97425193960467, 25.894943843285233, 25.563749144474656, 20.36389611661434, 21.37223624624312, 21.156695038080215, 21.538465480009705, 21.532104956607014, 21.93194833646217, 35.18093002587557, 35.17750186473131, 35.61693526490126, 27.825786625345543, 27.606004407008484, 27.791573894520596, 28.378194474304706, 27.82360146443048, 27.244690010944993, -3.1707162857055664, -2.994194932281971, -2.450358623638749, 17.047304660081863, 17.755315005779266, 17.906933203339577, 27.852776592597365, 27.923788313753903, 27.599449448287487, 24.498194366693497, 24.306083157658577, 23.552591487765312, 10.231667626028255, 10.08748087038596, 10.173031417032078, 23.536742508411407, 22.780456572771072, 23.76370630413294, 27.247959852218628, 27.7440417855978, 27.27960731089115, 21.061237110445887, 20.898939604560525, 20.936338445792586, 19.229355576137692, 19.45681498448053, 19.332547942797333, 26.566227725396544, 26.215313183764607, 26.414663488666207, 21.418230317533016, 21.393397942185402, 21.567489121109247, 28.90725936740637, 29.02186717838049, 28.651824593544006, 27.885048317412526, 27.948789263765008, 27.469818259278924, 22.07434300892055, 22.13522344455123, 22.057061340659857, 22.359012233714253, 22.067740129927785, 22.415719012419373, 21.011308910946042, 20.919873783985764, 21.501143187905342, 22.606411923964814, 22.52342042823632, 23.125974976258775, 27.861784880359963, 27.78821341445048, 27.458465841909245, 15.481624394655228, 15.269927211105824, 15.171787716448307, 30.85222940643628, 30.49977745612462, 30.30496846636136, 29.96145310997963, 29.83709168806672, 29.996516678482294, 16.49597092717886, 16.37264370173216, 16.322449252009392, 27.557806884249047, 27.3310837795337, 27.839419263725475, 23.504799152413995, 23.49571909258762, 23.898893906424433, 27.674255698919296, 28.12004427611828, 28.142898559570312, 26.0916952031354, 25.579870137075574, 25.86489368105927, 24.965649728973702, 24.857238565882042, 25.34092724191335, 29.45904317994912, 29.139865708847836, 29.600923356910542, 27.23729297767082, 27.254732849697263, 27.514553794326872, 16.94017348686853, 17.235882970194012, 17.642803572739155, 22.78436313134928, 22.546171580751732, 22.28365149100621, 23.510465138281376, 23.278432982663304, 23.050226914385945, 20.003980539739132, 20.304123677313328, 20.288588862866163, 22.745011659959943, 22.399618017176778, 22.722206336135656, 24.505348597963646, 24.95987594251831, 24.623011668523148, 25.929569611946732, 26.099579791227967, 26.471721092859894, 23.270135855923087, 22.939026261369378, 22.83186839769283, 30.74949938555558, 31.785786633690194, 31.587368843456105, 24.83158492545286, 24.778113188842923, 24.855464948962123, 29.339724166939646, 29.496311966950685, 29.43708239371577, 34.87042025725046, 34.86336729551354, 34.55142305294672, 23.894916017850235, 24.273340319593743, 25.063016441961125, 24.513138105471924, 24.636811447640255, 24.898562805106238, 24.006463232139737, 24.383987890246004, 23.85410817215839, 28.810634933412075, 28.9316976480186, 28.4795763194561, 31.399661972497896, 31.220445362230137, 31.54032219604899, 24.030044728269175, 22.957313319047287, 23.68227034558852, 22.970511381824807, 23.586743128796414, 23.44871326287587, 23.376991187532738, 24.01856525552769, 23.59947919597228, 24.512879736721516, 24.214143753051758, 24.348776787519455, 18.206829768915966, 17.354187225302056, 18.346706098256007, 20.594118885695934, 20.871523670852184, 20.529091335833073, 21.394780943791062, 22.055892808983714, 22.03554532925287, 31.822639250506953, 31.58514368658264, 31.543429022034005, 24.6557381649812, 25.145280109097556, 25.239109517385558, 18.74022090186675, 18.825931524236992, 18.258630086978272, 21.100606334706143, 21.1588719052573, 21.138892856736973, 20.730261178376765, 20.63516407708326, 19.800182575980813, 24.4784087613225, 24.392923519015312, 23.55376172065735, 27.68786735584338, 27.380413447817162, 27.693775815268353, 36.85035572076836, 36.70749044666687, 36.48764683554569, 21.829468900958688, 21.41246374199787, 21.45403719941774, 23.213672856489808, 23.30606612811485, 22.953835199276597, 25.761500388383865, 26.130542816594243, 25.96952026337385, 30.89162943760553, 31.401965337495, 30.667570436994225, 25.682238476971776, 25.55774054179588, 25.75162428120771, 23.95308388924846, 23.591756793359906, 23.983840621697397, -95.5280673702558, -104.49598601212105, -94.3661321712037, 35.55847054719925, 35.935063403099775, 35.103944674134254, 15.718207662304238, 16.163161886235073, 16.001858827968434, 24.307244017720222, 23.664515510201454, 23.729721799492836, 24.052081848805145, 24.13298748231803, 23.522363049288586, 25.124964294334248, 25.08205984657009, 25.188860063751534, 23.457642289499432, 23.423373381296784, 23.189195449153573, 21.626498732715845, 21.518596183508635, 21.040174901485443, 23.366310499608517, 23.29224979132414, 23.201215766370296, 22.87982005874315, 23.31311302507916, 22.919932457307965, 31.216261225442082, 30.9818914408485, 30.750036935011536, 19.598871774971485, 19.249235585331917, 19.255616039037704, 22.036576013391212, 21.73077882577975, 21.73735802372296, 24.794964272528887, 24.46404366195202, 24.508088923990726, 32.0706751110653, 32.18980477253595, 32.218744159365684, 21.604892948487148, 21.553219556187585, 21.200429898997143, 28.316290727506072, 28.235121029118687, 28.51543444643417, 17.781068806846932, 17.593604450424507, 18.441399209744603, 21.55827286839485, 21.620775006711483, 20.908309027552605, 20.163400645678237, 20.16209926673521, 19.308909734090165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14125987178480368, "mean_inference_ms": 0.6474113701395229, "mean_action_processing_ms": 0.09504433919426082, "mean_env_wait_ms": 0.7956275253112739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 936000, "timesteps_this_iter": 0, "agent_timesteps_total": 2808000, "timers": {"sample_time_ms": 9442.489, "sample_throughput": 508.341, "load_time_ms": 0.1, "load_throughput": 48083733.461, "learn_time_ms": 1201.59, "learn_throughput": 3994.708, "update_time_ms": 1.307}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 7.470945775508881, "policy_loss": -0.0013196775980113262, "vf_loss": 7.633634984493256, "vf_explained_var": -0.003560781478881836, "kl": 0.012005377561139865, "entropy": 16.2282075881958, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 936000, "num_agent_steps_sampled": 2808000, "num_steps_trained": 936000, "num_agent_steps_trained": 2808000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4049, "training_iteration": 195, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-13-08", "timestamp": 1706148788, "time_this_iter_s": 9.274693727493286, "time_total_s": 1826.7684116363525, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000559940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1826.7684116363525, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 8.535714285714286, "ram_util_percent": 48.18571428571429}}
{"episode_reward_max": 110.04549300298092, "episode_reward_min": -294.3901855535805, "episode_reward_mean": 70.18621002947636, "episode_len_mean": 297.66, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.49598601212105}, "policy_reward_max": {"shared_policy": 36.85035572076836}, "policy_reward_mean": {"shared_policy": 23.395403343158776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.35686901211739, 30.492179913446293, 70.08090538531542, 82.27160894870758, 62.896515160799, 58.018718503415556, 79.19620439782736, 64.37911738082767, 86.58095113933086, 83.30365584045646, 66.26662779413164, 66.84247137606141, 63.43232588283715, 68.25580732845991, 83.10846413671969, 45.92333932220936, 91.65697532892226, 89.79506147652864, 49.19106388092041, 82.72830992750822, 70.89941215142605, 83.93719853460789, 77.53645902127025, 75.16381553676909, 88.1998322457075, 82.00657962169495, 51.8188600298017, 67.61418620310722, 69.83912503533062, 60.59669307991862, 67.86683601327238, 74.0882362090051, 78.5008704960346, 69.0410305149853, 94.12265486270188, 74.4651630632579, 88.2731185276061, 104.28521060571072, 73.2312727794051, 74.04851235821842, 72.24455929454413, 86.22190890088677, 94.16042953077702, 70.66962839290498, 70.00596777349709, 70.99503563903271, 73.07580027729273, 53.90772309247403, 61.99473389238119, 65.48621908202765, 94.9512119591236, 75.04012779146431, 55.82478251308201, 63.398371096700416, 61.16560783144084, 72.42509400099516, 82.7620566189289, 110.04549300298092, 64.6959698423743, 69.47357418388125, 77.86156346835196, 92.96116521209476, 76.99160329997537, 71.52868130430576, -294.3901855535805, 106.59747862443328, 47.883228376507745, 71.70148132741451, 71.70743238041176, 75.39588420465587, 70.07021111994979, 64.18526981770992, 69.85977605730295, 69.11286554113028, 92.94818960130212, 58.103723399341106, 65.50471286289392, 73.76709685847163, 96.47922404296693, 64.35854240367188, 85.06684620305893, 53.81607246701604, 64.08735690265894, 59.63440964650361, 104.98232690244912, 67.76491444185373, 93.19188406318426, 59.53786529460922, 69.20990318432449, 67.3343586307019, 109.28410896658895, 83.60490849241614, 61.449477348709465, 69.64303614199162, 66.47449598927051, 72.20705644786358, 59.00839476007967, 108.58363094739614, 61.15547519922255, 89.10000282526015], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.498194366693497, 24.306083157658577, 23.552591487765312, 10.231667626028255, 10.08748087038596, 10.173031417032078, 23.536742508411407, 22.780456572771072, 23.76370630413294, 27.247959852218628, 27.7440417855978, 27.27960731089115, 21.061237110445887, 20.898939604560525, 20.936338445792586, 19.229355576137692, 19.45681498448053, 19.332547942797333, 26.566227725396544, 26.215313183764607, 26.414663488666207, 21.418230317533016, 21.393397942185402, 21.567489121109247, 28.90725936740637, 29.02186717838049, 28.651824593544006, 27.885048317412526, 27.948789263765008, 27.469818259278924, 22.07434300892055, 22.13522344455123, 22.057061340659857, 22.359012233714253, 22.067740129927785, 22.415719012419373, 21.011308910946042, 20.919873783985764, 21.501143187905342, 22.606411923964814, 22.52342042823632, 23.125974976258775, 27.861784880359963, 27.78821341445048, 27.458465841909245, 15.481624394655228, 15.269927211105824, 15.171787716448307, 30.85222940643628, 30.49977745612462, 30.30496846636136, 29.96145310997963, 29.83709168806672, 29.996516678482294, 16.49597092717886, 16.37264370173216, 16.322449252009392, 27.557806884249047, 27.3310837795337, 27.839419263725475, 23.504799152413995, 23.49571909258762, 23.898893906424433, 27.674255698919296, 28.12004427611828, 28.142898559570312, 26.0916952031354, 25.579870137075574, 25.86489368105927, 24.965649728973702, 24.857238565882042, 25.34092724191335, 29.45904317994912, 29.139865708847836, 29.600923356910542, 27.23729297767082, 27.254732849697263, 27.514553794326872, 16.94017348686853, 17.235882970194012, 17.642803572739155, 22.78436313134928, 22.546171580751732, 22.28365149100621, 23.510465138281376, 23.278432982663304, 23.050226914385945, 20.003980539739132, 20.304123677313328, 20.288588862866163, 22.745011659959943, 22.399618017176778, 22.722206336135656, 24.505348597963646, 24.95987594251831, 24.623011668523148, 25.929569611946732, 26.099579791227967, 26.471721092859894, 23.270135855923087, 22.939026261369378, 22.83186839769283, 30.74949938555558, 31.785786633690194, 31.587368843456105, 24.83158492545286, 24.778113188842923, 24.855464948962123, 29.339724166939646, 29.496311966950685, 29.43708239371577, 34.87042025725046, 34.86336729551354, 34.55142305294672, 23.894916017850235, 24.273340319593743, 25.063016441961125, 24.513138105471924, 24.636811447640255, 24.898562805106238, 24.006463232139737, 24.383987890246004, 23.85410817215839, 28.810634933412075, 28.9316976480186, 28.4795763194561, 31.399661972497896, 31.220445362230137, 31.54032219604899, 24.030044728269175, 22.957313319047287, 23.68227034558852, 22.970511381824807, 23.586743128796414, 23.44871326287587, 23.376991187532738, 24.01856525552769, 23.59947919597228, 24.512879736721516, 24.214143753051758, 24.348776787519455, 18.206829768915966, 17.354187225302056, 18.346706098256007, 20.594118885695934, 20.871523670852184, 20.529091335833073, 21.394780943791062, 22.055892808983714, 22.03554532925287, 31.822639250506953, 31.58514368658264, 31.543429022034005, 24.6557381649812, 25.145280109097556, 25.239109517385558, 18.74022090186675, 18.825931524236992, 18.258630086978272, 21.100606334706143, 21.1588719052573, 21.138892856736973, 20.730261178376765, 20.63516407708326, 19.800182575980813, 24.4784087613225, 24.392923519015312, 23.55376172065735, 27.68786735584338, 27.380413447817162, 27.693775815268353, 36.85035572076836, 36.70749044666687, 36.48764683554569, 21.829468900958688, 21.41246374199787, 21.45403719941774, 23.213672856489808, 23.30606612811485, 22.953835199276597, 25.761500388383865, 26.130542816594243, 25.96952026337385, 30.89162943760553, 31.401965337495, 30.667570436994225, 25.682238476971776, 25.55774054179588, 25.75162428120771, 23.95308388924846, 23.591756793359906, 23.983840621697397, -95.5280673702558, -104.49598601212105, -94.3661321712037, 35.55847054719925, 35.935063403099775, 35.103944674134254, 15.718207662304238, 16.163161886235073, 16.001858827968434, 24.307244017720222, 23.664515510201454, 23.729721799492836, 24.052081848805145, 24.13298748231803, 23.522363049288586, 25.124964294334248, 25.08205984657009, 25.188860063751534, 23.457642289499432, 23.423373381296784, 23.189195449153573, 21.626498732715845, 21.518596183508635, 21.040174901485443, 23.366310499608517, 23.29224979132414, 23.201215766370296, 22.87982005874315, 23.31311302507916, 22.919932457307965, 31.216261225442082, 30.9818914408485, 30.750036935011536, 19.598871774971485, 19.249235585331917, 19.255616039037704, 22.036576013391212, 21.73077882577975, 21.73735802372296, 24.794964272528887, 24.46404366195202, 24.508088923990726, 32.0706751110653, 32.18980477253595, 32.218744159365684, 21.604892948487148, 21.553219556187585, 21.200429898997143, 28.316290727506072, 28.235121029118687, 28.51543444643417, 17.781068806846932, 17.593604450424507, 18.441399209744603, 21.55827286839485, 21.620775006711483, 20.908309027552605, 20.163400645678237, 20.16209926673521, 19.308909734090165, 35.1737823014458, 35.169938807686165, 34.638605793317154, 22.54003321627775, 23.00306700045863, 22.221814225117356, 30.986858300864697, 31.15064176917076, 31.054383993148804, 19.89257243881002, 19.817417787387967, 19.82787506841123, 23.128341288616255, 23.128659931321934, 22.9529019643863, 22.811208290979266, 22.209690928459167, 22.313459411263466, 36.18625195572773, 36.6081256220738, 36.48973138878742, 28.01071410998702, 28.034741394221783, 27.55945298820734, 20.781874304249257, 20.579051100959376, 20.088551943500832, 23.366230681538582, 23.2574123442173, 23.019393116235733, 22.048807680606842, 22.603183520026505, 21.82250478863716, 24.239080354571342, 23.723679959774017, 24.24429613351822, 19.746409389500812, 19.862589966816202, 19.399395403762654, 36.20732662578423, 36.49484291983147, 35.88146140178044, 20.187352885802582, 20.82973188658555, 20.13839042683442, 29.684306417902306, 29.824423116942242, 29.5912732904156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1412487869978368, "mean_inference_ms": 0.6474983911466787, "mean_action_processing_ms": 0.09503644325740257, "mean_env_wait_ms": 0.7956472030198785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 940800, "timesteps_this_iter": 0, "agent_timesteps_total": 2822400, "timers": {"sample_time_ms": 9458.706, "sample_throughput": 507.469, "load_time_ms": 0.1, "load_throughput": 48083733.461, "learn_time_ms": 1198.589, "learn_throughput": 4004.71, "update_time_ms": 1.307}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 8.168155789375305, "policy_loss": -0.0022462397304480186, "vf_loss": 8.328781008720398, "vf_explained_var": 0.020014889538288116, "kl": 0.008834343869518119, "entropy": 15.905068397521973, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940800, "num_agent_steps_sampled": 2822400, "num_steps_trained": 940800, "num_agent_steps_trained": 2822400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4065, "training_iteration": 196, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-13-18", "timestamp": 1706148798, "time_this_iter_s": 9.31502652168274, "time_total_s": 1836.0834381580353, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000466820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1836.0834381580353, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 6.6923076923076925, "ram_util_percent": 48.22307692307693}}
{"episode_reward_max": 110.04549300298092, "episode_reward_min": -294.3901855535805, "episode_reward_mean": 70.23602219332358, "episode_len_mean": 297.66, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.49598601212105}, "policy_reward_max": {"shared_policy": 36.85035572076836}, "policy_reward_mean": {"shared_policy": 23.412007397774524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.65697532892226, 89.79506147652864, 49.19106388092041, 82.72830992750822, 70.89941215142605, 83.93719853460789, 77.53645902127025, 75.16381553676909, 88.1998322457075, 82.00657962169495, 51.8188600298017, 67.61418620310722, 69.83912503533062, 60.59669307991862, 67.86683601327238, 74.0882362090051, 78.5008704960346, 69.0410305149853, 94.12265486270188, 74.4651630632579, 88.2731185276061, 104.28521060571072, 73.2312727794051, 74.04851235821842, 72.24455929454413, 86.22190890088677, 94.16042953077702, 70.66962839290498, 70.00596777349709, 70.99503563903271, 73.07580027729273, 53.90772309247403, 61.99473389238119, 65.48621908202765, 94.9512119591236, 75.04012779146431, 55.82478251308201, 63.398371096700416, 61.16560783144084, 72.42509400099516, 82.7620566189289, 110.04549300298092, 64.6959698423743, 69.47357418388125, 77.86156346835196, 92.96116521209476, 76.99160329997537, 71.52868130430576, -294.3901855535805, 106.59747862443328, 47.883228376507745, 71.70148132741451, 71.70743238041176, 75.39588420465587, 70.07021111994979, 64.18526981770992, 69.85977605730295, 69.11286554113028, 92.94818960130212, 58.103723399341106, 65.50471286289392, 73.76709685847163, 96.47922404296693, 64.35854240367188, 85.06684620305893, 53.81607246701604, 64.08735690265894, 59.63440964650361, 104.98232690244912, 67.76491444185373, 93.19188406318426, 59.53786529460922, 69.20990318432449, 67.3343586307019, 109.28410896658895, 83.60490849241614, 61.449477348709465, 69.64303614199162, 66.47449598927051, 72.20705644786358, 59.00839476007967, 108.58363094739614, 61.15547519922255, 89.10000282526015, 53.17225316690745, 72.7110885567963, 79.51394862029699, 49.747455738484845, 66.01147877424954, 85.04564089281483, 77.74034628272055, 45.73935001716018, 80.67081687040624, 62.58923822082578, 68.84740838222206, 88.84140411019322, 63.196266554296, 47.722807749174535, 61.09188457578419, 85.74558939505367], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.85222940643628, 30.49977745612462, 30.30496846636136, 29.96145310997963, 29.83709168806672, 29.996516678482294, 16.49597092717886, 16.37264370173216, 16.322449252009392, 27.557806884249047, 27.3310837795337, 27.839419263725475, 23.504799152413995, 23.49571909258762, 23.898893906424433, 27.674255698919296, 28.12004427611828, 28.142898559570312, 26.0916952031354, 25.579870137075574, 25.86489368105927, 24.965649728973702, 24.857238565882042, 25.34092724191335, 29.45904317994912, 29.139865708847836, 29.600923356910542, 27.23729297767082, 27.254732849697263, 27.514553794326872, 16.94017348686853, 17.235882970194012, 17.642803572739155, 22.78436313134928, 22.546171580751732, 22.28365149100621, 23.510465138281376, 23.278432982663304, 23.050226914385945, 20.003980539739132, 20.304123677313328, 20.288588862866163, 22.745011659959943, 22.399618017176778, 22.722206336135656, 24.505348597963646, 24.95987594251831, 24.623011668523148, 25.929569611946732, 26.099579791227967, 26.471721092859894, 23.270135855923087, 22.939026261369378, 22.83186839769283, 30.74949938555558, 31.785786633690194, 31.587368843456105, 24.83158492545286, 24.778113188842923, 24.855464948962123, 29.339724166939646, 29.496311966950685, 29.43708239371577, 34.87042025725046, 34.86336729551354, 34.55142305294672, 23.894916017850235, 24.273340319593743, 25.063016441961125, 24.513138105471924, 24.636811447640255, 24.898562805106238, 24.006463232139737, 24.383987890246004, 23.85410817215839, 28.810634933412075, 28.9316976480186, 28.4795763194561, 31.399661972497896, 31.220445362230137, 31.54032219604899, 24.030044728269175, 22.957313319047287, 23.68227034558852, 22.970511381824807, 23.586743128796414, 23.44871326287587, 23.376991187532738, 24.01856525552769, 23.59947919597228, 24.512879736721516, 24.214143753051758, 24.348776787519455, 18.206829768915966, 17.354187225302056, 18.346706098256007, 20.594118885695934, 20.871523670852184, 20.529091335833073, 21.394780943791062, 22.055892808983714, 22.03554532925287, 31.822639250506953, 31.58514368658264, 31.543429022034005, 24.6557381649812, 25.145280109097556, 25.239109517385558, 18.74022090186675, 18.825931524236992, 18.258630086978272, 21.100606334706143, 21.1588719052573, 21.138892856736973, 20.730261178376765, 20.63516407708326, 19.800182575980813, 24.4784087613225, 24.392923519015312, 23.55376172065735, 27.68786735584338, 27.380413447817162, 27.693775815268353, 36.85035572076836, 36.70749044666687, 36.48764683554569, 21.829468900958688, 21.41246374199787, 21.45403719941774, 23.213672856489808, 23.30606612811485, 22.953835199276597, 25.761500388383865, 26.130542816594243, 25.96952026337385, 30.89162943760553, 31.401965337495, 30.667570436994225, 25.682238476971776, 25.55774054179588, 25.75162428120771, 23.95308388924846, 23.591756793359906, 23.983840621697397, -95.5280673702558, -104.49598601212105, -94.3661321712037, 35.55847054719925, 35.935063403099775, 35.103944674134254, 15.718207662304238, 16.163161886235073, 16.001858827968434, 24.307244017720222, 23.664515510201454, 23.729721799492836, 24.052081848805145, 24.13298748231803, 23.522363049288586, 25.124964294334248, 25.08205984657009, 25.188860063751534, 23.457642289499432, 23.423373381296784, 23.189195449153573, 21.626498732715845, 21.518596183508635, 21.040174901485443, 23.366310499608517, 23.29224979132414, 23.201215766370296, 22.87982005874315, 23.31311302507916, 22.919932457307965, 31.216261225442082, 30.9818914408485, 30.750036935011536, 19.598871774971485, 19.249235585331917, 19.255616039037704, 22.036576013391212, 21.73077882577975, 21.73735802372296, 24.794964272528887, 24.46404366195202, 24.508088923990726, 32.0706751110653, 32.18980477253595, 32.218744159365684, 21.604892948487148, 21.553219556187585, 21.200429898997143, 28.316290727506072, 28.235121029118687, 28.51543444643417, 17.781068806846932, 17.593604450424507, 18.441399209744603, 21.55827286839485, 21.620775006711483, 20.908309027552605, 20.163400645678237, 20.16209926673521, 19.308909734090165, 35.1737823014458, 35.169938807686165, 34.638605793317154, 22.54003321627775, 23.00306700045863, 22.221814225117356, 30.986858300864697, 31.15064176917076, 31.054383993148804, 19.89257243881002, 19.817417787387967, 19.82787506841123, 23.128341288616255, 23.128659931321934, 22.9529019643863, 22.811208290979266, 22.209690928459167, 22.313459411263466, 36.18625195572773, 36.6081256220738, 36.48973138878742, 28.01071410998702, 28.034741394221783, 27.55945298820734, 20.781874304249257, 20.579051100959376, 20.088551943500832, 23.366230681538582, 23.2574123442173, 23.019393116235733, 22.048807680606842, 22.603183520026505, 21.82250478863716, 24.239080354571342, 23.723679959774017, 24.24429613351822, 19.746409389500812, 19.862589966816202, 19.399395403762654, 36.20732662578423, 36.49484291983147, 35.88146140178044, 20.187352885802582, 20.82973188658555, 20.13839042683442, 29.684306417902306, 29.824423116942242, 29.5912732904156, 17.780441162486866, 17.42139932264884, 17.970412681771748, 24.509504248698548, 23.651758467157677, 24.549825840940073, 26.568313768754393, 26.660543597924203, 26.28509125361839, 16.86682231848438, 16.999414936949805, 15.88121848305066, 21.940953378876046, 21.813935955365494, 22.256589440008, 28.278397823994354, 28.3574067701896, 28.40983629863088, 26.30953364570935, 26.027399902542427, 25.403412734468773, 15.109800763428211, 15.302810419350863, 15.326738834381104, 27.14698847072819, 26.833868796626717, 26.689959603051335, 20.675167342027024, 21.058033838247255, 20.8560370405515, 22.688149891793728, 23.01827334612608, 23.14098514430225, 29.70521597067514, 29.440735558668763, 29.69545258084932, 21.126913366218403, 20.858525459965065, 21.210827728112534, 16.260863489471376, 15.882156945765018, 15.57978731393814, 20.29363990326722, 20.46881292512019, 20.329431747396782, 28.552094136675194, 28.887561524597302, 28.305933733781174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14124142543432444, "mean_inference_ms": 0.6475721320657424, "mean_action_processing_ms": 0.09502826963566095, "mean_env_wait_ms": 0.7956733438065953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 945600, "timesteps_this_iter": 0, "agent_timesteps_total": 2836800, "timers": {"sample_time_ms": 9461.253, "sample_throughput": 507.332, "load_time_ms": 0.1, "load_throughput": 48083733.461, "learn_time_ms": 1196.189, "learn_throughput": 4012.743, "update_time_ms": 1.308}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 5.996869206428528, "policy_loss": -0.0011300525826664076, "vf_loss": 6.158064961433411, "vf_explained_var": 0.004153817892074585, "kl": 0.00746019888929883, "entropy": 16.063279151916504, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 945600, "num_agent_steps_sampled": 2836800, "num_steps_trained": 945600, "num_agent_steps_trained": 2836800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4081, "training_iteration": 197, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-13-27", "timestamp": 1706148807, "time_this_iter_s": 9.502264738082886, "time_total_s": 1845.5857028961182, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021000537790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1845.5857028961182, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 5.684615384615385, "ram_util_percent": 48.23076923076923}}
{"episode_reward_max": 113.5697187744081, "episode_reward_min": -294.3901855535805, "episode_reward_mean": 68.69551469765968, "episode_len_mean": 297.66, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -104.49598601212105}, "policy_reward_max": {"shared_policy": 37.97168919444084}, "policy_reward_mean": {"shared_policy": 22.898504899219883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.5008704960346, 69.0410305149853, 94.12265486270188, 74.4651630632579, 88.2731185276061, 104.28521060571072, 73.2312727794051, 74.04851235821842, 72.24455929454413, 86.22190890088677, 94.16042953077702, 70.66962839290498, 70.00596777349709, 70.99503563903271, 73.07580027729273, 53.90772309247403, 61.99473389238119, 65.48621908202765, 94.9512119591236, 75.04012779146431, 55.82478251308201, 63.398371096700416, 61.16560783144084, 72.42509400099516, 82.7620566189289, 110.04549300298092, 64.6959698423743, 69.47357418388125, 77.86156346835196, 92.96116521209476, 76.99160329997537, 71.52868130430576, -294.3901855535805, 106.59747862443328, 47.883228376507745, 71.70148132741451, 71.70743238041176, 75.39588420465587, 70.07021111994979, 64.18526981770992, 69.85977605730295, 69.11286554113028, 92.94818960130212, 58.103723399341106, 65.50471286289392, 73.76709685847163, 96.47922404296693, 64.35854240367188, 85.06684620305893, 53.81607246701604, 64.08735690265894, 59.63440964650361, 104.98232690244912, 67.76491444185373, 93.19188406318426, 59.53786529460922, 69.20990318432449, 67.3343586307019, 109.28410896658895, 83.60490849241614, 61.449477348709465, 69.64303614199162, 66.47449598927051, 72.20705644786358, 59.00839476007967, 108.58363094739614, 61.15547519922255, 89.10000282526015, 53.17225316690745, 72.7110885567963, 79.51394862029699, 49.747455738484845, 66.01147877424954, 85.04564089281483, 77.74034628272055, 45.73935001716018, 80.67081687040624, 62.58923822082578, 68.84740838222206, 88.84140411019322, 63.196266554296, 47.722807749174535, 61.09188457578419, 85.74558939505367, 60.59396033734083, 56.18249252066013, 59.4613779373467, 57.00662188977, 63.80637125391512, 85.57508417405187, 35.819479648023844, 113.5697187744081, 56.8749983916059, 55.014762974344194, 68.32510603591797, 54.5076112523675, 75.67964219301939, 81.65708444478511, 44.79324656073001, 60.02033634111285], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.929569611946732, 26.099579791227967, 26.471721092859894, 23.270135855923087, 22.939026261369378, 22.83186839769283, 30.74949938555558, 31.785786633690194, 31.587368843456105, 24.83158492545286, 24.778113188842923, 24.855464948962123, 29.339724166939646, 29.496311966950685, 29.43708239371577, 34.87042025725046, 34.86336729551354, 34.55142305294672, 23.894916017850235, 24.273340319593743, 25.063016441961125, 24.513138105471924, 24.636811447640255, 24.898562805106238, 24.006463232139737, 24.383987890246004, 23.85410817215839, 28.810634933412075, 28.9316976480186, 28.4795763194561, 31.399661972497896, 31.220445362230137, 31.54032219604899, 24.030044728269175, 22.957313319047287, 23.68227034558852, 22.970511381824807, 23.586743128796414, 23.44871326287587, 23.376991187532738, 24.01856525552769, 23.59947919597228, 24.512879736721516, 24.214143753051758, 24.348776787519455, 18.206829768915966, 17.354187225302056, 18.346706098256007, 20.594118885695934, 20.871523670852184, 20.529091335833073, 21.394780943791062, 22.055892808983714, 22.03554532925287, 31.822639250506953, 31.58514368658264, 31.543429022034005, 24.6557381649812, 25.145280109097556, 25.239109517385558, 18.74022090186675, 18.825931524236992, 18.258630086978272, 21.100606334706143, 21.1588719052573, 21.138892856736973, 20.730261178376765, 20.63516407708326, 19.800182575980813, 24.4784087613225, 24.392923519015312, 23.55376172065735, 27.68786735584338, 27.380413447817162, 27.693775815268353, 36.85035572076836, 36.70749044666687, 36.48764683554569, 21.829468900958688, 21.41246374199787, 21.45403719941774, 23.213672856489808, 23.30606612811485, 22.953835199276597, 25.761500388383865, 26.130542816594243, 25.96952026337385, 30.89162943760553, 31.401965337495, 30.667570436994225, 25.682238476971776, 25.55774054179588, 25.75162428120771, 23.95308388924846, 23.591756793359906, 23.983840621697397, -95.5280673702558, -104.49598601212105, -94.3661321712037, 35.55847054719925, 35.935063403099775, 35.103944674134254, 15.718207662304238, 16.163161886235073, 16.001858827968434, 24.307244017720222, 23.664515510201454, 23.729721799492836, 24.052081848805145, 24.13298748231803, 23.522363049288586, 25.124964294334248, 25.08205984657009, 25.188860063751534, 23.457642289499432, 23.423373381296784, 23.189195449153573, 21.626498732715845, 21.518596183508635, 21.040174901485443, 23.366310499608517, 23.29224979132414, 23.201215766370296, 22.87982005874315, 23.31311302507916, 22.919932457307965, 31.216261225442082, 30.9818914408485, 30.750036935011536, 19.598871774971485, 19.249235585331917, 19.255616039037704, 22.036576013391212, 21.73077882577975, 21.73735802372296, 24.794964272528887, 24.46404366195202, 24.508088923990726, 32.0706751110653, 32.18980477253595, 32.218744159365684, 21.604892948487148, 21.553219556187585, 21.200429898997143, 28.316290727506072, 28.235121029118687, 28.51543444643417, 17.781068806846932, 17.593604450424507, 18.441399209744603, 21.55827286839485, 21.620775006711483, 20.908309027552605, 20.163400645678237, 20.16209926673521, 19.308909734090165, 35.1737823014458, 35.169938807686165, 34.638605793317154, 22.54003321627775, 23.00306700045863, 22.221814225117356, 30.986858300864697, 31.15064176917076, 31.054383993148804, 19.89257243881002, 19.817417787387967, 19.82787506841123, 23.128341288616255, 23.128659931321934, 22.9529019643863, 22.811208290979266, 22.209690928459167, 22.313459411263466, 36.18625195572773, 36.6081256220738, 36.48973138878742, 28.01071410998702, 28.034741394221783, 27.55945298820734, 20.781874304249257, 20.579051100959376, 20.088551943500832, 23.366230681538582, 23.2574123442173, 23.019393116235733, 22.048807680606842, 22.603183520026505, 21.82250478863716, 24.239080354571342, 23.723679959774017, 24.24429613351822, 19.746409389500812, 19.862589966816202, 19.399395403762654, 36.20732662578423, 36.49484291983147, 35.88146140178044, 20.187352885802582, 20.82973188658555, 20.13839042683442, 29.684306417902306, 29.824423116942242, 29.5912732904156, 17.780441162486866, 17.42139932264884, 17.970412681771748, 24.509504248698548, 23.651758467157677, 24.549825840940073, 26.568313768754393, 26.660543597924203, 26.28509125361839, 16.86682231848438, 16.999414936949805, 15.88121848305066, 21.940953378876046, 21.813935955365494, 22.256589440008, 28.278397823994354, 28.3574067701896, 28.40983629863088, 26.30953364570935, 26.027399902542427, 25.403412734468773, 15.109800763428211, 15.302810419350863, 15.326738834381104, 27.14698847072819, 26.833868796626717, 26.689959603051335, 20.675167342027024, 21.058033838247255, 20.8560370405515, 22.688149891793728, 23.01827334612608, 23.14098514430225, 29.70521597067514, 29.440735558668763, 29.69545258084932, 21.126913366218403, 20.858525459965065, 21.210827728112534, 16.260863489471376, 15.882156945765018, 15.57978731393814, 20.29363990326722, 20.46881292512019, 20.329431747396782, 28.552094136675194, 28.887561524597302, 28.305933733781174, 20.14254144579172, 20.41374932229519, 20.03766956925392, 18.75887760768333, 18.528101200858742, 18.89551371211806, 19.153699845075607, 20.4370687790215, 19.870609313249588, 19.32876274238029, 18.309348265329987, 19.368510882059724, 20.95654173692067, 21.385532980163887, 21.46429653683056, 28.6321212661763, 28.767377588277057, 28.17558531959851, 11.853705257177353, 12.132896896451712, 11.83287749439478, 37.82693087682128, 37.97168919444084, 37.77109870314598, 19.038343550016478, 18.757603493829563, 19.079051347759858, 17.847772404551506, 18.470458570867777, 18.69653199892491, 22.899126183862478, 22.851287905747682, 22.57469194630781, 18.252721555531025, 18.06725324690342, 18.187636449933052, 24.958837792277336, 25.529461070895195, 25.19134332984686, 27.322398967046553, 27.202156000460178, 27.132529477278382, 14.274713496367127, 15.293652211936802, 15.224880852426082, 19.982125349342823, 20.116098280996084, 19.922112710773945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14123648070479106, "mean_inference_ms": 0.647636694264197, "mean_action_processing_ms": 0.09502055078890313, "mean_env_wait_ms": 0.7956978504425709, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 950400, "timesteps_this_iter": 0, "agent_timesteps_total": 2851200, "timers": {"sample_time_ms": 9427.32, "sample_throughput": 509.158, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1200.796, "learn_throughput": 3997.349, "update_time_ms": 1.208}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 5.744085431098938, "policy_loss": -0.0022165583839199865, "vf_loss": 5.9080522656440735, "vf_explained_var": 0.013806410133838654, "kl": 0.005959445552722373, "entropy": 16.220325231552124, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 950400, "num_agent_steps_sampled": 2851200, "num_steps_trained": 950400, "num_agent_steps_trained": 2851200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4097, "training_iteration": 198, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-13-37", "timestamp": 1706148817, "time_this_iter_s": 9.493955373764038, "time_total_s": 1855.0796582698822, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055ECA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1855.0796582698822, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 8.607142857142858, "ram_util_percent": 48.27142857142856}}
{"episode_reward_max": 114.67459098994729, "episode_reward_min": -294.3901855535805, "episode_reward_mean": 65.01481877652331, "episode_len_mean": 296.82, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"shared_policy": -104.49598601212105}, "policy_reward_max": {"shared_policy": 38.36625877643624}, "policy_reward_mean": {"shared_policy": 21.6716062588411}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.48621908202765, 94.9512119591236, 75.04012779146431, 55.82478251308201, 63.398371096700416, 61.16560783144084, 72.42509400099516, 82.7620566189289, 110.04549300298092, 64.6959698423743, 69.47357418388125, 77.86156346835196, 92.96116521209476, 76.99160329997537, 71.52868130430576, -294.3901855535805, 106.59747862443328, 47.883228376507745, 71.70148132741451, 71.70743238041176, 75.39588420465587, 70.07021111994979, 64.18526981770992, 69.85977605730295, 69.11286554113028, 92.94818960130212, 58.103723399341106, 65.50471286289392, 73.76709685847163, 96.47922404296693, 64.35854240367188, 85.06684620305893, 53.81607246701604, 64.08735690265894, 59.63440964650361, 104.98232690244912, 67.76491444185373, 93.19188406318426, 59.53786529460922, 69.20990318432449, 67.3343586307019, 109.28410896658895, 83.60490849241614, 61.449477348709465, 69.64303614199162, 66.47449598927051, 72.20705644786358, 59.00839476007967, 108.58363094739614, 61.15547519922255, 89.10000282526015, 53.17225316690745, 72.7110885567963, 79.51394862029699, 49.747455738484845, 66.01147877424954, 85.04564089281483, 77.74034628272055, 45.73935001716018, 80.67081687040624, 62.58923822082578, 68.84740838222206, 88.84140411019322, 63.196266554296, 47.722807749174535, 61.09188457578419, 85.74558939505367, 60.59396033734083, 56.18249252066013, 59.4613779373467, 57.00662188977, 63.80637125391512, 85.57508417405187, 35.819479648023844, 113.5697187744081, 56.8749983916059, 55.014762974344194, 68.32510603591797, 54.5076112523675, 75.67964219301939, 81.65708444478511, 44.79324656073001, 60.02033634111285, 63.806190822273464, 86.70608489494771, 54.94000413268802, 67.34319990314543, 80.0798853114247, 114.67459098994729, 70.03990047425032, 71.48498187214136, 63.804135639220476, 62.64734549075362, 88.26220646873115, -240.66444896906614, 68.06843833529271, 46.32951087132095, 85.61031332891434, 78.88244299497454, 79.15924532711503], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 216, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.394780943791062, 22.055892808983714, 22.03554532925287, 31.822639250506953, 31.58514368658264, 31.543429022034005, 24.6557381649812, 25.145280109097556, 25.239109517385558, 18.74022090186675, 18.825931524236992, 18.258630086978272, 21.100606334706143, 21.1588719052573, 21.138892856736973, 20.730261178376765, 20.63516407708326, 19.800182575980813, 24.4784087613225, 24.392923519015312, 23.55376172065735, 27.68786735584338, 27.380413447817162, 27.693775815268353, 36.85035572076836, 36.70749044666687, 36.48764683554569, 21.829468900958688, 21.41246374199787, 21.45403719941774, 23.213672856489808, 23.30606612811485, 22.953835199276597, 25.761500388383865, 26.130542816594243, 25.96952026337385, 30.89162943760553, 31.401965337495, 30.667570436994225, 25.682238476971776, 25.55774054179588, 25.75162428120771, 23.95308388924846, 23.591756793359906, 23.983840621697397, -95.5280673702558, -104.49598601212105, -94.3661321712037, 35.55847054719925, 35.935063403099775, 35.103944674134254, 15.718207662304238, 16.163161886235073, 16.001858827968434, 24.307244017720222, 23.664515510201454, 23.729721799492836, 24.052081848805145, 24.13298748231803, 23.522363049288586, 25.124964294334248, 25.08205984657009, 25.188860063751534, 23.457642289499432, 23.423373381296784, 23.189195449153573, 21.626498732715845, 21.518596183508635, 21.040174901485443, 23.366310499608517, 23.29224979132414, 23.201215766370296, 22.87982005874315, 23.31311302507916, 22.919932457307965, 31.216261225442082, 30.9818914408485, 30.750036935011536, 19.598871774971485, 19.249235585331917, 19.255616039037704, 22.036576013391212, 21.73077882577975, 21.73735802372296, 24.794964272528887, 24.46404366195202, 24.508088923990726, 32.0706751110653, 32.18980477253595, 32.218744159365684, 21.604892948487148, 21.553219556187585, 21.200429898997143, 28.316290727506072, 28.235121029118687, 28.51543444643417, 17.781068806846932, 17.593604450424507, 18.441399209744603, 21.55827286839485, 21.620775006711483, 20.908309027552605, 20.163400645678237, 20.16209926673521, 19.308909734090165, 35.1737823014458, 35.169938807686165, 34.638605793317154, 22.54003321627775, 23.00306700045863, 22.221814225117356, 30.986858300864697, 31.15064176917076, 31.054383993148804, 19.89257243881002, 19.817417787387967, 19.82787506841123, 23.128341288616255, 23.128659931321934, 22.9529019643863, 22.811208290979266, 22.209690928459167, 22.313459411263466, 36.18625195572773, 36.6081256220738, 36.48973138878742, 28.01071410998702, 28.034741394221783, 27.55945298820734, 20.781874304249257, 20.579051100959376, 20.088551943500832, 23.366230681538582, 23.2574123442173, 23.019393116235733, 22.048807680606842, 22.603183520026505, 21.82250478863716, 24.239080354571342, 23.723679959774017, 24.24429613351822, 19.746409389500812, 19.862589966816202, 19.399395403762654, 36.20732662578423, 36.49484291983147, 35.88146140178044, 20.187352885802582, 20.82973188658555, 20.13839042683442, 29.684306417902306, 29.824423116942242, 29.5912732904156, 17.780441162486866, 17.42139932264884, 17.970412681771748, 24.509504248698548, 23.651758467157677, 24.549825840940073, 26.568313768754393, 26.660543597924203, 26.28509125361839, 16.86682231848438, 16.999414936949805, 15.88121848305066, 21.940953378876046, 21.813935955365494, 22.256589440008, 28.278397823994354, 28.3574067701896, 28.40983629863088, 26.30953364570935, 26.027399902542427, 25.403412734468773, 15.109800763428211, 15.302810419350863, 15.326738834381104, 27.14698847072819, 26.833868796626717, 26.689959603051335, 20.675167342027024, 21.058033838247255, 20.8560370405515, 22.688149891793728, 23.01827334612608, 23.14098514430225, 29.70521597067514, 29.440735558668763, 29.69545258084932, 21.126913366218403, 20.858525459965065, 21.210827728112534, 16.260863489471376, 15.882156945765018, 15.57978731393814, 20.29363990326722, 20.46881292512019, 20.329431747396782, 28.552094136675194, 28.887561524597302, 28.305933733781174, 20.14254144579172, 20.41374932229519, 20.03766956925392, 18.75887760768333, 18.528101200858742, 18.89551371211806, 19.153699845075607, 20.4370687790215, 19.870609313249588, 19.32876274238029, 18.309348265329987, 19.368510882059724, 20.95654173692067, 21.385532980163887, 21.46429653683056, 28.6321212661763, 28.767377588277057, 28.17558531959851, 11.853705257177353, 12.132896896451712, 11.83287749439478, 37.82693087682128, 37.97168919444084, 37.77109870314598, 19.038343550016478, 18.757603493829563, 19.079051347759858, 17.847772404551506, 18.470458570867777, 18.69653199892491, 22.899126183862478, 22.851287905747682, 22.57469194630781, 18.252721555531025, 18.06725324690342, 18.187636449933052, 24.958837792277336, 25.529461070895195, 25.19134332984686, 27.322398967046553, 27.202156000460178, 27.132529477278382, 14.274713496367127, 15.293652211936802, 15.224880852426082, 19.982125349342823, 20.116098280996084, 19.922112710773945, 21.244195605317742, 21.214724237720162, 21.34727097923556, 29.034059088677168, 29.00973707344383, 28.66228873282671, 18.294720745335013, 18.332774753371865, 18.31250863398114, 22.196246773004532, 22.569539124146104, 22.577414005994797, 26.46561215321222, 26.90496868143478, 26.709304476777703, 37.98871224621931, 38.31961996729174, 38.36625877643624, 23.322349429130554, 23.524013623595238, 23.193537421524525, 23.797089837491512, 24.236148044466972, 23.451743990182877, 20.953054949641228, 21.410196144133806, 21.440884545445442, 20.867766159276158, 20.71518642703691, 21.064392904440552, 29.77191589896877, 28.699659203489617, 29.790631366272763, -77.28970119357109, -87.0790664255619, -76.29568134993315, 22.85870073308857, 22.347465763489396, 22.862271838714747, 15.542936780800417, 15.474429083367184, 15.312145007153347, 28.30674907565117, 28.74731762241572, 28.556246630847454, 26.147470501561955, 26.200068210562065, 26.53490428285052, 26.503155301014573, 26.643024230996758, 26.0130657951037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14123427954451373, "mean_inference_ms": 0.6477045434678853, "mean_action_processing_ms": 0.09501684111983419, "mean_env_wait_ms": 0.7957131748629028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 955200, "timesteps_this_iter": 0, "agent_timesteps_total": 2865600, "timers": {"sample_time_ms": 9415.771, "sample_throughput": 509.783, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1200.502, "learn_throughput": 3998.328, "update_time_ms": 1.208}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 106.36413383483887, "policy_loss": -0.00232758766337704, "vf_loss": 106.52763557434082, "vf_explained_var": -0.005799740552902222, "kl": 0.012290207785834936, "entropy": 16.210312843322754, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 955200, "num_agent_steps_sampled": 2865600, "num_steps_trained": 955200, "num_agent_steps_trained": 2865600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4114, "training_iteration": 199, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-13-46", "timestamp": 1706148826, "time_this_iter_s": 9.3272066116333, "time_total_s": 1864.4068648815155, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210005373A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1864.4068648815155, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 8.315384615384616, "ram_util_percent": 48.315384615384616}}
{"episode_reward_max": 114.67459098994729, "episode_reward_min": -240.66444896906614, "episode_reward_mean": 67.33601162331513, "episode_len_mean": 299.16, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -87.0790664255619}, "policy_reward_max": {"shared_policy": 38.36625877643624}, "policy_reward_mean": {"shared_policy": 22.445337207771704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.59747862443328, 47.883228376507745, 71.70148132741451, 71.70743238041176, 75.39588420465587, 70.07021111994979, 64.18526981770992, 69.85977605730295, 69.11286554113028, 92.94818960130212, 58.103723399341106, 65.50471286289392, 73.76709685847163, 96.47922404296693, 64.35854240367188, 85.06684620305893, 53.81607246701604, 64.08735690265894, 59.63440964650361, 104.98232690244912, 67.76491444185373, 93.19188406318426, 59.53786529460922, 69.20990318432449, 67.3343586307019, 109.28410896658895, 83.60490849241614, 61.449477348709465, 69.64303614199162, 66.47449598927051, 72.20705644786358, 59.00839476007967, 108.58363094739614, 61.15547519922255, 89.10000282526015, 53.17225316690745, 72.7110885567963, 79.51394862029699, 49.747455738484845, 66.01147877424954, 85.04564089281483, 77.74034628272055, 45.73935001716018, 80.67081687040624, 62.58923822082578, 68.84740838222206, 88.84140411019322, 63.196266554296, 47.722807749174535, 61.09188457578419, 85.74558939505367, 60.59396033734083, 56.18249252066013, 59.4613779373467, 57.00662188977, 63.80637125391512, 85.57508417405187, 35.819479648023844, 113.5697187744081, 56.8749983916059, 55.014762974344194, 68.32510603591797, 54.5076112523675, 75.67964219301939, 81.65708444478511, 44.79324656073001, 60.02033634111285, 63.806190822273464, 86.70608489494771, 54.94000413268802, 67.34319990314543, 80.0798853114247, 114.67459098994729, 70.03990047425032, 71.48498187214136, 63.804135639220476, 62.64734549075362, 88.26220646873115, -240.66444896906614, 68.06843833529271, 46.32951087132095, 85.61031332891434, 78.88244299497454, 79.15924532711503, 76.66918722353876, 51.5568896755576, 56.04040155932306, 68.63054753094909, 57.730515547096715, 79.88326450390741, 52.07661424577235, 70.02212640549986, 75.13396893441677, 54.69779793545602, 107.86066670343278, 50.94790880056098, 64.02850860357283, 72.86135238874704, 85.42856219038366, 48.772308085113735], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 216, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [35.55847054719925, 35.935063403099775, 35.103944674134254, 15.718207662304238, 16.163161886235073, 16.001858827968434, 24.307244017720222, 23.664515510201454, 23.729721799492836, 24.052081848805145, 24.13298748231803, 23.522363049288586, 25.124964294334248, 25.08205984657009, 25.188860063751534, 23.457642289499432, 23.423373381296784, 23.189195449153573, 21.626498732715845, 21.518596183508635, 21.040174901485443, 23.366310499608517, 23.29224979132414, 23.201215766370296, 22.87982005874315, 23.31311302507916, 22.919932457307965, 31.216261225442082, 30.9818914408485, 30.750036935011536, 19.598871774971485, 19.249235585331917, 19.255616039037704, 22.036576013391212, 21.73077882577975, 21.73735802372296, 24.794964272528887, 24.46404366195202, 24.508088923990726, 32.0706751110653, 32.18980477253595, 32.218744159365684, 21.604892948487148, 21.553219556187585, 21.200429898997143, 28.316290727506072, 28.235121029118687, 28.51543444643417, 17.781068806846932, 17.593604450424507, 18.441399209744603, 21.55827286839485, 21.620775006711483, 20.908309027552605, 20.163400645678237, 20.16209926673521, 19.308909734090165, 35.1737823014458, 35.169938807686165, 34.638605793317154, 22.54003321627775, 23.00306700045863, 22.221814225117356, 30.986858300864697, 31.15064176917076, 31.054383993148804, 19.89257243881002, 19.817417787387967, 19.82787506841123, 23.128341288616255, 23.128659931321934, 22.9529019643863, 22.811208290979266, 22.209690928459167, 22.313459411263466, 36.18625195572773, 36.6081256220738, 36.48973138878742, 28.01071410998702, 28.034741394221783, 27.55945298820734, 20.781874304249257, 20.579051100959376, 20.088551943500832, 23.366230681538582, 23.2574123442173, 23.019393116235733, 22.048807680606842, 22.603183520026505, 21.82250478863716, 24.239080354571342, 23.723679959774017, 24.24429613351822, 19.746409389500812, 19.862589966816202, 19.399395403762654, 36.20732662578423, 36.49484291983147, 35.88146140178044, 20.187352885802582, 20.82973188658555, 20.13839042683442, 29.684306417902306, 29.824423116942242, 29.5912732904156, 17.780441162486866, 17.42139932264884, 17.970412681771748, 24.509504248698548, 23.651758467157677, 24.549825840940073, 26.568313768754393, 26.660543597924203, 26.28509125361839, 16.86682231848438, 16.999414936949805, 15.88121848305066, 21.940953378876046, 21.813935955365494, 22.256589440008, 28.278397823994354, 28.3574067701896, 28.40983629863088, 26.30953364570935, 26.027399902542427, 25.403412734468773, 15.109800763428211, 15.302810419350863, 15.326738834381104, 27.14698847072819, 26.833868796626717, 26.689959603051335, 20.675167342027024, 21.058033838247255, 20.8560370405515, 22.688149891793728, 23.01827334612608, 23.14098514430225, 29.70521597067514, 29.440735558668763, 29.69545258084932, 21.126913366218403, 20.858525459965065, 21.210827728112534, 16.260863489471376, 15.882156945765018, 15.57978731393814, 20.29363990326722, 20.46881292512019, 20.329431747396782, 28.552094136675194, 28.887561524597302, 28.305933733781174, 20.14254144579172, 20.41374932229519, 20.03766956925392, 18.75887760768333, 18.528101200858742, 18.89551371211806, 19.153699845075607, 20.4370687790215, 19.870609313249588, 19.32876274238029, 18.309348265329987, 19.368510882059724, 20.95654173692067, 21.385532980163887, 21.46429653683056, 28.6321212661763, 28.767377588277057, 28.17558531959851, 11.853705257177353, 12.132896896451712, 11.83287749439478, 37.82693087682128, 37.97168919444084, 37.77109870314598, 19.038343550016478, 18.757603493829563, 19.079051347759858, 17.847772404551506, 18.470458570867777, 18.69653199892491, 22.899126183862478, 22.851287905747682, 22.57469194630781, 18.252721555531025, 18.06725324690342, 18.187636449933052, 24.958837792277336, 25.529461070895195, 25.19134332984686, 27.322398967046553, 27.202156000460178, 27.132529477278382, 14.274713496367127, 15.293652211936802, 15.224880852426082, 19.982125349342823, 20.116098280996084, 19.922112710773945, 21.244195605317742, 21.214724237720162, 21.34727097923556, 29.034059088677168, 29.00973707344383, 28.66228873282671, 18.294720745335013, 18.332774753371865, 18.31250863398114, 22.196246773004532, 22.569539124146104, 22.577414005994797, 26.46561215321222, 26.90496868143478, 26.709304476777703, 37.98871224621931, 38.31961996729174, 38.36625877643624, 23.322349429130554, 23.524013623595238, 23.193537421524525, 23.797089837491512, 24.236148044466972, 23.451743990182877, 20.953054949641228, 21.410196144133806, 21.440884545445442, 20.867766159276158, 20.71518642703691, 21.064392904440552, 29.77191589896877, 28.699659203489617, 29.790631366272763, -77.28970119357109, -87.0790664255619, -76.29568134993315, 22.85870073308857, 22.347465763489396, 22.862271838714747, 15.542936780800417, 15.474429083367184, 15.312145007153347, 28.30674907565117, 28.74731762241572, 28.556246630847454, 26.147470501561955, 26.200068210562065, 26.53490428285052, 26.503155301014573, 26.643024230996758, 26.0130657951037, 25.395442962646484, 25.36211897432804, 25.91162528656423, 17.17172374327977, 17.30301984896262, 17.08214608331521, 18.431317796309784, 19.041847483565405, 18.56723627944787, 22.998742202917725, 22.42728594938913, 23.20451937864223, 19.352947642405823, 19.19932009776433, 19.178247806926564, 26.370476201176643, 26.687658350914717, 26.825129951816052, 17.21568002303441, 17.522900988658265, 17.338033234079674, 23.124821481605366, 23.213844781120613, 23.683460142773882, 24.85035778582096, 25.03906288743019, 25.24454826116562, 18.456727155794695, 18.21022255470355, 18.03084822495778, 35.952247252066925, 36.06956277166803, 35.83885667969783, 17.15758040221408, 16.853104628622532, 16.93722376972437, 20.955511336525277, 21.275901613136128, 21.797095653911427, 24.797838387079537, 24.62415722757578, 23.43935677409172, 28.48571306963761, 28.63570538287361, 28.307143737872437, 16.74787779773274, 16.6611156190435, 15.363314668337495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14123120891073213, "mean_inference_ms": 0.6477667228093863, "mean_action_processing_ms": 0.09501561908715597, "mean_env_wait_ms": 0.7957296001381642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 2880000, "timers": {"sample_time_ms": 9439.599, "sample_throughput": 508.496, "load_time_ms": 0.1, "load_throughput": 47969166.548, "learn_time_ms": 1199.403, "learn_throughput": 4001.991, "update_time_ms": 1.308}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 5.877629339694977, "policy_loss": -0.0015259995584953334, "vf_loss": 6.043379902839661, "vf_explained_var": 0.0024756044149398804, "kl": 0.007104360848292906, "entropy": 16.476484537124634, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 2880000, "num_steps_trained": 960000, "num_agent_steps_trained": 2880000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 105.95030543208122, "episode_reward_min": 47.53262264560905, "episode_reward_mean": 75.49375663392712, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 15.593213806549699}, "policy_reward_max": {"shared_policy": 35.37308185920119}, "policy_reward_mean": {"shared_policy": 25.164585544642375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.53262264560905, 82.81643075216562, 75.46714538335799, 76.15957320854068, 87.70894975587723, 72.57356099784373, 55.73361238837241, 105.95030543208122, 78.07743037026374, 72.91793540515935], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.760333980123193, 16.17907485893616, 15.593213806549699, 27.318892419338226, 27.572477996349335, 27.925060336478055, 25.00078600396712, 25.19564888005455, 25.270710499336317, 25.454891495406628, 25.081822782754898, 25.622858930379152, 28.783403644959122, 29.569267361114413, 29.356278749803693, 24.258826424678162, 24.1872822244962, 24.127452348669365, 18.507399578889206, 18.56617711608608, 18.66003569339712, 35.25370055437088, 35.37308185920119, 35.32352301850915, 25.60864547391732, 26.143922117849186, 26.324862778497234, 24.385519598688305, 24.35495037756239, 24.17746542890866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13093565659475478, "mean_inference_ms": 0.6536115035497219, "mean_action_processing_ms": 0.09490394039760205, "mean_env_wait_ms": 0.7890443069784323, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 4130, "training_iteration": 200, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-14-00", "timestamp": 1706148840, "time_this_iter_s": 14.363261222839355, "time_total_s": 1878.7701261043549, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C22C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1878.7701261043549, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 6.105, "ram_util_percent": 48.30499999999999}}
{"episode_reward_max": 114.67459098994729, "episode_reward_min": -240.66444896906614, "episode_reward_mean": 67.630899529819, "episode_len_mean": 299.16, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -87.0790664255619}, "policy_reward_max": {"shared_policy": 38.36625877643624}, "policy_reward_mean": {"shared_policy": 22.543633176606328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.81607246701604, 64.08735690265894, 59.63440964650361, 104.98232690244912, 67.76491444185373, 93.19188406318426, 59.53786529460922, 69.20990318432449, 67.3343586307019, 109.28410896658895, 83.60490849241614, 61.449477348709465, 69.64303614199162, 66.47449598927051, 72.20705644786358, 59.00839476007967, 108.58363094739614, 61.15547519922255, 89.10000282526015, 53.17225316690745, 72.7110885567963, 79.51394862029699, 49.747455738484845, 66.01147877424954, 85.04564089281483, 77.74034628272055, 45.73935001716018, 80.67081687040624, 62.58923822082578, 68.84740838222206, 88.84140411019322, 63.196266554296, 47.722807749174535, 61.09188457578419, 85.74558939505367, 60.59396033734083, 56.18249252066013, 59.4613779373467, 57.00662188977, 63.80637125391512, 85.57508417405187, 35.819479648023844, 113.5697187744081, 56.8749983916059, 55.014762974344194, 68.32510603591797, 54.5076112523675, 75.67964219301939, 81.65708444478511, 44.79324656073001, 60.02033634111285, 63.806190822273464, 86.70608489494771, 54.94000413268802, 67.34319990314543, 80.0798853114247, 114.67459098994729, 70.03990047425032, 71.48498187214136, 63.804135639220476, 62.64734549075362, 88.26220646873115, -240.66444896906614, 68.06843833529271, 46.32951087132095, 85.61031332891434, 78.88244299497454, 79.15924532711503, 76.66918722353876, 51.5568896755576, 56.04040155932306, 68.63054753094909, 57.730515547096715, 79.88326450390741, 52.07661424577235, 70.02212640549986, 75.13396893441677, 54.69779793545602, 107.86066670343278, 50.94790880056098, 64.02850860357283, 72.86135238874704, 85.42856219038366, 48.772308085113735, 60.05975176393983, 84.91486616432665, 60.322587402537465, 79.28243928775188, 91.22622939944266, 99.18490955792365, 93.96218027686697, 60.38288709335026, 19.700173826888204, 92.44056202657518, 81.21755821630357, 104.43097524531183, 69.40350037813184, 104.77491644024846, 55.822853546589585, 55.10436284542082], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 216, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.781068806846932, 17.593604450424507, 18.441399209744603, 21.55827286839485, 21.620775006711483, 20.908309027552605, 20.163400645678237, 20.16209926673521, 19.308909734090165, 35.1737823014458, 35.169938807686165, 34.638605793317154, 22.54003321627775, 23.00306700045863, 22.221814225117356, 30.986858300864697, 31.15064176917076, 31.054383993148804, 19.89257243881002, 19.817417787387967, 19.82787506841123, 23.128341288616255, 23.128659931321934, 22.9529019643863, 22.811208290979266, 22.209690928459167, 22.313459411263466, 36.18625195572773, 36.6081256220738, 36.48973138878742, 28.01071410998702, 28.034741394221783, 27.55945298820734, 20.781874304249257, 20.579051100959376, 20.088551943500832, 23.366230681538582, 23.2574123442173, 23.019393116235733, 22.048807680606842, 22.603183520026505, 21.82250478863716, 24.239080354571342, 23.723679959774017, 24.24429613351822, 19.746409389500812, 19.862589966816202, 19.399395403762654, 36.20732662578423, 36.49484291983147, 35.88146140178044, 20.187352885802582, 20.82973188658555, 20.13839042683442, 29.684306417902306, 29.824423116942242, 29.5912732904156, 17.780441162486866, 17.42139932264884, 17.970412681771748, 24.509504248698548, 23.651758467157677, 24.549825840940073, 26.568313768754393, 26.660543597924203, 26.28509125361839, 16.86682231848438, 16.999414936949805, 15.88121848305066, 21.940953378876046, 21.813935955365494, 22.256589440008, 28.278397823994354, 28.3574067701896, 28.40983629863088, 26.30953364570935, 26.027399902542427, 25.403412734468773, 15.109800763428211, 15.302810419350863, 15.326738834381104, 27.14698847072819, 26.833868796626717, 26.689959603051335, 20.675167342027024, 21.058033838247255, 20.8560370405515, 22.688149891793728, 23.01827334612608, 23.14098514430225, 29.70521597067514, 29.440735558668763, 29.69545258084932, 21.126913366218403, 20.858525459965065, 21.210827728112534, 16.260863489471376, 15.882156945765018, 15.57978731393814, 20.29363990326722, 20.46881292512019, 20.329431747396782, 28.552094136675194, 28.887561524597302, 28.305933733781174, 20.14254144579172, 20.41374932229519, 20.03766956925392, 18.75887760768333, 18.528101200858742, 18.89551371211806, 19.153699845075607, 20.4370687790215, 19.870609313249588, 19.32876274238029, 18.309348265329987, 19.368510882059724, 20.95654173692067, 21.385532980163887, 21.46429653683056, 28.6321212661763, 28.767377588277057, 28.17558531959851, 11.853705257177353, 12.132896896451712, 11.83287749439478, 37.82693087682128, 37.97168919444084, 37.77109870314598, 19.038343550016478, 18.757603493829563, 19.079051347759858, 17.847772404551506, 18.470458570867777, 18.69653199892491, 22.899126183862478, 22.851287905747682, 22.57469194630781, 18.252721555531025, 18.06725324690342, 18.187636449933052, 24.958837792277336, 25.529461070895195, 25.19134332984686, 27.322398967046553, 27.202156000460178, 27.132529477278382, 14.274713496367127, 15.293652211936802, 15.224880852426082, 19.982125349342823, 20.116098280996084, 19.922112710773945, 21.244195605317742, 21.214724237720162, 21.34727097923556, 29.034059088677168, 29.00973707344383, 28.66228873282671, 18.294720745335013, 18.332774753371865, 18.31250863398114, 22.196246773004532, 22.569539124146104, 22.577414005994797, 26.46561215321222, 26.90496868143478, 26.709304476777703, 37.98871224621931, 38.31961996729174, 38.36625877643624, 23.322349429130554, 23.524013623595238, 23.193537421524525, 23.797089837491512, 24.236148044466972, 23.451743990182877, 20.953054949641228, 21.410196144133806, 21.440884545445442, 20.867766159276158, 20.71518642703691, 21.064392904440552, 29.77191589896877, 28.699659203489617, 29.790631366272763, -77.28970119357109, -87.0790664255619, -76.29568134993315, 22.85870073308857, 22.347465763489396, 22.862271838714747, 15.542936780800417, 15.474429083367184, 15.312145007153347, 28.30674907565117, 28.74731762241572, 28.556246630847454, 26.147470501561955, 26.200068210562065, 26.53490428285052, 26.503155301014573, 26.643024230996758, 26.0130657951037, 25.395442962646484, 25.36211897432804, 25.91162528656423, 17.17172374327977, 17.30301984896262, 17.08214608331521, 18.431317796309784, 19.041847483565405, 18.56723627944787, 22.998742202917725, 22.42728594938913, 23.20451937864223, 19.352947642405823, 19.19932009776433, 19.178247806926564, 26.370476201176643, 26.687658350914717, 26.825129951816052, 17.21568002303441, 17.522900988658265, 17.338033234079674, 23.124821481605366, 23.213844781120613, 23.683460142773882, 24.85035778582096, 25.03906288743019, 25.24454826116562, 18.456727155794695, 18.21022255470355, 18.03084822495778, 35.952247252066925, 36.06956277166803, 35.83885667969783, 17.15758040221408, 16.853104628622532, 16.93722376972437, 20.955511336525277, 21.275901613136128, 21.797095653911427, 24.797838387079537, 24.62415722757578, 23.43935677409172, 28.48571306963761, 28.63570538287361, 28.307143737872437, 16.74787779773274, 16.6611156190435, 15.363314668337495, 20.16274873415628, 19.939127678672463, 19.957875351111085, 28.447186661263302, 28.649683011074856, 27.817996491988495, 19.82778760790825, 20.298140870407224, 20.196658924221992, 26.693707919369132, 26.4599260042111, 26.128805364171654, 30.409303547193602, 30.568464563538626, 30.24846128871043, 32.80314900974432, 33.50251622560123, 32.8792443225781, 31.046835506955773, 31.44239843512574, 31.472946334785462, 20.098585727314145, 19.895893203715474, 20.388408162320644, 6.543596681207418, 6.630244391039014, 6.526332754641771, 30.860905079791934, 30.604292350510747, 30.9753645962725, 26.916647528608635, 27.079682697852448, 27.22122798984249, 34.82567240080485, 34.72217247883478, 34.8831303656722, 23.290652150909096, 22.57639784614244, 23.5364503810803, 34.91331510494152, 34.95105069379011, 34.910550641516835, 18.585066127280385, 18.80148126060763, 18.43630615870157, 18.482331156109765, 18.498533952360347, 18.12349773695071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14123244022594342, "mean_inference_ms": 0.647831896936038, "mean_action_processing_ms": 0.0950116477518726, "mean_env_wait_ms": 0.7957446585010516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 964800, "timesteps_this_iter": 0, "agent_timesteps_total": 2894400, "timers": {"sample_time_ms": 9906.322, "sample_throughput": 484.539, "load_time_ms": 0.201, "load_throughput": 23879325.347, "learn_time_ms": 1196.503, "learn_throughput": 4011.691, "update_time_ms": 1.308}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 7.257290542125702, "policy_loss": -0.0017959693236964114, "vf_loss": 7.420843064785004, "vf_explained_var": 0.011928066611289978, "kl": 0.00835782819223967, "entropy": 16.23918604850769, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 964800, "num_agent_steps_sampled": 2894400, "num_steps_trained": 964800, "num_agent_steps_trained": 2894400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4146, "training_iteration": 201, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-14-10", "timestamp": 1706148850, "time_this_iter_s": 9.273361444473267, "time_total_s": 1888.0434875488281, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002100055E430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1888.0434875488281, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 6.584615384615384, "ram_util_percent": 48.31538461538461}}
{"episode_reward_max": 134.4770035045221, "episode_reward_min": -240.66444896906614, "episode_reward_mean": 69.2758508996885, "episode_len_mean": 299.16, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -87.0790664255619}, "policy_reward_max": {"shared_policy": 44.94985748051354}, "policy_reward_mean": {"shared_policy": 23.09195029989617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.58363094739614, 61.15547519922255, 89.10000282526015, 53.17225316690745, 72.7110885567963, 79.51394862029699, 49.747455738484845, 66.01147877424954, 85.04564089281483, 77.74034628272055, 45.73935001716018, 80.67081687040624, 62.58923822082578, 68.84740838222206, 88.84140411019322, 63.196266554296, 47.722807749174535, 61.09188457578419, 85.74558939505367, 60.59396033734083, 56.18249252066013, 59.4613779373467, 57.00662188977, 63.80637125391512, 85.57508417405187, 35.819479648023844, 113.5697187744081, 56.8749983916059, 55.014762974344194, 68.32510603591797, 54.5076112523675, 75.67964219301939, 81.65708444478511, 44.79324656073001, 60.02033634111285, 63.806190822273464, 86.70608489494771, 54.94000413268802, 67.34319990314543, 80.0798853114247, 114.67459098994729, 70.03990047425032, 71.48498187214136, 63.804135639220476, 62.64734549075362, 88.26220646873115, -240.66444896906614, 68.06843833529271, 46.32951087132095, 85.61031332891434, 78.88244299497454, 79.15924532711503, 76.66918722353876, 51.5568896755576, 56.04040155932306, 68.63054753094909, 57.730515547096715, 79.88326450390741, 52.07661424577235, 70.02212640549986, 75.13396893441677, 54.69779793545602, 107.86066670343278, 50.94790880056098, 64.02850860357283, 72.86135238874704, 85.42856219038366, 48.772308085113735, 60.05975176393983, 84.91486616432665, 60.322587402537465, 79.28243928775188, 91.22622939944266, 99.18490955792365, 93.96218027686697, 60.38288709335026, 19.700173826888204, 92.44056202657518, 81.21755821630357, 104.43097524531183, 69.40350037813184, 104.77491644024846, 55.822853546589585, 55.10436284542082, 73.61107292398808, 106.83829762786627, 87.10306748747826, 65.21285886317489, 72.58916915208098, 52.49130538478494, 88.19899028586221, 81.48292559571564, 42.44165093638, 134.4770035045221, 119.0727494098246, 87.95092878863214, 85.95749577041715, 84.36260436475277, 55.56907857954501, 88.36650799214839], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 216, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [36.20732662578423, 36.49484291983147, 35.88146140178044, 20.187352885802582, 20.82973188658555, 20.13839042683442, 29.684306417902306, 29.824423116942242, 29.5912732904156, 17.780441162486866, 17.42139932264884, 17.970412681771748, 24.509504248698548, 23.651758467157677, 24.549825840940073, 26.568313768754393, 26.660543597924203, 26.28509125361839, 16.86682231848438, 16.999414936949805, 15.88121848305066, 21.940953378876046, 21.813935955365494, 22.256589440008, 28.278397823994354, 28.3574067701896, 28.40983629863088, 26.30953364570935, 26.027399902542427, 25.403412734468773, 15.109800763428211, 15.302810419350863, 15.326738834381104, 27.14698847072819, 26.833868796626717, 26.689959603051335, 20.675167342027024, 21.058033838247255, 20.8560370405515, 22.688149891793728, 23.01827334612608, 23.14098514430225, 29.70521597067514, 29.440735558668763, 29.69545258084932, 21.126913366218403, 20.858525459965065, 21.210827728112534, 16.260863489471376, 15.882156945765018, 15.57978731393814, 20.29363990326722, 20.46881292512019, 20.329431747396782, 28.552094136675194, 28.887561524597302, 28.305933733781174, 20.14254144579172, 20.41374932229519, 20.03766956925392, 18.75887760768333, 18.528101200858742, 18.89551371211806, 19.153699845075607, 20.4370687790215, 19.870609313249588, 19.32876274238029, 18.309348265329987, 19.368510882059724, 20.95654173692067, 21.385532980163887, 21.46429653683056, 28.6321212661763, 28.767377588277057, 28.17558531959851, 11.853705257177353, 12.132896896451712, 11.83287749439478, 37.82693087682128, 37.97168919444084, 37.77109870314598, 19.038343550016478, 18.757603493829563, 19.079051347759858, 17.847772404551506, 18.470458570867777, 18.69653199892491, 22.899126183862478, 22.851287905747682, 22.57469194630781, 18.252721555531025, 18.06725324690342, 18.187636449933052, 24.958837792277336, 25.529461070895195, 25.19134332984686, 27.322398967046553, 27.202156000460178, 27.132529477278382, 14.274713496367127, 15.293652211936802, 15.224880852426082, 19.982125349342823, 20.116098280996084, 19.922112710773945, 21.244195605317742, 21.214724237720162, 21.34727097923556, 29.034059088677168, 29.00973707344383, 28.66228873282671, 18.294720745335013, 18.332774753371865, 18.31250863398114, 22.196246773004532, 22.569539124146104, 22.577414005994797, 26.46561215321222, 26.90496868143478, 26.709304476777703, 37.98871224621931, 38.31961996729174, 38.36625877643624, 23.322349429130554, 23.524013623595238, 23.193537421524525, 23.797089837491512, 24.236148044466972, 23.451743990182877, 20.953054949641228, 21.410196144133806, 21.440884545445442, 20.867766159276158, 20.71518642703691, 21.064392904440552, 29.77191589896877, 28.699659203489617, 29.790631366272763, -77.28970119357109, -87.0790664255619, -76.29568134993315, 22.85870073308857, 22.347465763489396, 22.862271838714747, 15.542936780800417, 15.474429083367184, 15.312145007153347, 28.30674907565117, 28.74731762241572, 28.556246630847454, 26.147470501561955, 26.200068210562065, 26.53490428285052, 26.503155301014573, 26.643024230996758, 26.0130657951037, 25.395442962646484, 25.36211897432804, 25.91162528656423, 17.17172374327977, 17.30301984896262, 17.08214608331521, 18.431317796309784, 19.041847483565405, 18.56723627944787, 22.998742202917725, 22.42728594938913, 23.20451937864223, 19.352947642405823, 19.19932009776433, 19.178247806926564, 26.370476201176643, 26.687658350914717, 26.825129951816052, 17.21568002303441, 17.522900988658265, 17.338033234079674, 23.124821481605366, 23.213844781120613, 23.683460142773882, 24.85035778582096, 25.03906288743019, 25.24454826116562, 18.456727155794695, 18.21022255470355, 18.03084822495778, 35.952247252066925, 36.06956277166803, 35.83885667969783, 17.15758040221408, 16.853104628622532, 16.93722376972437, 20.955511336525277, 21.275901613136128, 21.797095653911427, 24.797838387079537, 24.62415722757578, 23.43935677409172, 28.48571306963761, 28.63570538287361, 28.307143737872437, 16.74787779773274, 16.6611156190435, 15.363314668337495, 20.16274873415628, 19.939127678672463, 19.957875351111085, 28.447186661263302, 28.649683011074856, 27.817996491988495, 19.82778760790825, 20.298140870407224, 20.196658924221992, 26.693707919369132, 26.4599260042111, 26.128805364171654, 30.409303547193602, 30.568464563538626, 30.24846128871043, 32.80314900974432, 33.50251622560123, 32.8792443225781, 31.046835506955773, 31.44239843512574, 31.472946334785462, 20.098585727314145, 19.895893203715474, 20.388408162320644, 6.543596681207418, 6.630244391039014, 6.526332754641771, 30.860905079791934, 30.604292350510747, 30.9753645962725, 26.916647528608635, 27.079682697852448, 27.22122798984249, 34.82567240080485, 34.72217247883478, 34.8831303656722, 23.290652150909096, 22.57639784614244, 23.5364503810803, 34.91331510494152, 34.95105069379011, 34.910550641516835, 18.585066127280385, 18.80148126060763, 18.43630615870157, 18.482331156109765, 18.498533952360347, 18.12349773695071, 24.845927397410065, 24.128367642561585, 24.636777884016425, 35.79083094000816, 35.35384701192379, 35.693619675934315, 29.014525059610605, 28.99637931957841, 29.092163108289242, 21.836964557568223, 21.682256529728562, 21.693637775878102, 24.14457783351341, 24.147989789644868, 24.296601528922707, 17.43541443347931, 17.424072973430157, 17.63181797787547, 29.483339556648076, 29.34874569127956, 29.366905037934572, 26.870878979563713, 27.088546089828014, 27.523500526323915, 14.177201331282646, 14.202134950707347, 14.062314654390008, 44.94985748051354, 44.7720744597415, 44.75507156426707, 39.63333526005347, 39.44482897718747, 39.994585172583655, 29.31281541784604, 29.375397482266024, 29.262715888520077, 28.837848301045597, 28.473873026669025, 28.645774442702532, 27.960950300097466, 28.532050788402557, 27.869603276252747, 18.567020406325653, 18.517706652482346, 18.484351520737007, 29.478190091749028, 29.508690123756722, 29.379627776642636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14123363658072102, "mean_inference_ms": 0.6478902860442843, "mean_action_processing_ms": 0.09500603744001074, "mean_env_wait_ms": 0.7957670658625754, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 969600, "timesteps_this_iter": 0, "agent_timesteps_total": 2908800, "timers": {"sample_time_ms": 9882.414, "sample_throughput": 485.711, "load_time_ms": 0.201, "load_throughput": 23879325.347, "learn_time_ms": 1194.751, "learn_throughput": 4017.573, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 9.542280673980713, "policy_loss": 0.0009216611221845028, "vf_loss": 9.7040935754776, "vf_explained_var": 0.006476081907749176, "kl": 0.0167656992565097, "entropy": 16.400898933410645, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 969600, "num_agent_steps_sampled": 2908800, "num_steps_trained": 969600, "num_agent_steps_trained": 2908800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4162, "training_iteration": 202, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-14-19", "timestamp": 1706148859, "time_this_iter_s": 9.258991003036499, "time_total_s": 1897.3024785518646, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1897.3024785518646, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 6.664285714285714, "ram_util_percent": 48.35714285714285}}
{"episode_reward_max": 134.4770035045221, "episode_reward_min": -240.66444896906614, "episode_reward_mean": 69.62782563386354, "episode_len_mean": 299.16, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -87.0790664255619}, "policy_reward_max": {"shared_policy": 44.94985748051354}, "policy_reward_mean": {"shared_policy": 23.209275211287842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.722807749174535, 61.09188457578419, 85.74558939505367, 60.59396033734083, 56.18249252066013, 59.4613779373467, 57.00662188977, 63.80637125391512, 85.57508417405187, 35.819479648023844, 113.5697187744081, 56.8749983916059, 55.014762974344194, 68.32510603591797, 54.5076112523675, 75.67964219301939, 81.65708444478511, 44.79324656073001, 60.02033634111285, 63.806190822273464, 86.70608489494771, 54.94000413268802, 67.34319990314543, 80.0798853114247, 114.67459098994729, 70.03990047425032, 71.48498187214136, 63.804135639220476, 62.64734549075362, 88.26220646873115, -240.66444896906614, 68.06843833529271, 46.32951087132095, 85.61031332891434, 78.88244299497454, 79.15924532711503, 76.66918722353876, 51.5568896755576, 56.04040155932306, 68.63054753094909, 57.730515547096715, 79.88326450390741, 52.07661424577235, 70.02212640549986, 75.13396893441677, 54.69779793545602, 107.86066670343278, 50.94790880056098, 64.02850860357283, 72.86135238874704, 85.42856219038366, 48.772308085113735, 60.05975176393983, 84.91486616432665, 60.322587402537465, 79.28243928775188, 91.22622939944266, 99.18490955792365, 93.96218027686697, 60.38288709335026, 19.700173826888204, 92.44056202657518, 81.21755821630357, 104.43097524531183, 69.40350037813184, 104.77491644024846, 55.822853546589585, 55.10436284542082, 73.61107292398808, 106.83829762786627, 87.10306748747826, 65.21285886317489, 72.58916915208098, 52.49130538478494, 88.19899028586221, 81.48292559571564, 42.44165093638, 134.4770035045221, 119.0727494098246, 87.95092878863214, 85.95749577041715, 84.36260436475277, 55.56907857954501, 88.36650799214839, 56.160964969545574, 80.38016214966774, 77.84889173787086, 105.40323840081689, 79.58508155867457, 43.34971000440416, 120.08073462545872, 60.556466203182936, 81.33992207201662, 67.92761243879792, 67.93039736617355, 72.75252818595617, 68.05381425889207, 56.36387230269608, 87.44930731179191, 62.680574990808935], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 216, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.260863489471376, 15.882156945765018, 15.57978731393814, 20.29363990326722, 20.46881292512019, 20.329431747396782, 28.552094136675194, 28.887561524597302, 28.305933733781174, 20.14254144579172, 20.41374932229519, 20.03766956925392, 18.75887760768333, 18.528101200858742, 18.89551371211806, 19.153699845075607, 20.4370687790215, 19.870609313249588, 19.32876274238029, 18.309348265329987, 19.368510882059724, 20.95654173692067, 21.385532980163887, 21.46429653683056, 28.6321212661763, 28.767377588277057, 28.17558531959851, 11.853705257177353, 12.132896896451712, 11.83287749439478, 37.82693087682128, 37.97168919444084, 37.77109870314598, 19.038343550016478, 18.757603493829563, 19.079051347759858, 17.847772404551506, 18.470458570867777, 18.69653199892491, 22.899126183862478, 22.851287905747682, 22.57469194630781, 18.252721555531025, 18.06725324690342, 18.187636449933052, 24.958837792277336, 25.529461070895195, 25.19134332984686, 27.322398967046553, 27.202156000460178, 27.132529477278382, 14.274713496367127, 15.293652211936802, 15.224880852426082, 19.982125349342823, 20.116098280996084, 19.922112710773945, 21.244195605317742, 21.214724237720162, 21.34727097923556, 29.034059088677168, 29.00973707344383, 28.66228873282671, 18.294720745335013, 18.332774753371865, 18.31250863398114, 22.196246773004532, 22.569539124146104, 22.577414005994797, 26.46561215321222, 26.90496868143478, 26.709304476777703, 37.98871224621931, 38.31961996729174, 38.36625877643624, 23.322349429130554, 23.524013623595238, 23.193537421524525, 23.797089837491512, 24.236148044466972, 23.451743990182877, 20.953054949641228, 21.410196144133806, 21.440884545445442, 20.867766159276158, 20.71518642703691, 21.064392904440552, 29.77191589896877, 28.699659203489617, 29.790631366272763, -77.28970119357109, -87.0790664255619, -76.29568134993315, 22.85870073308857, 22.347465763489396, 22.862271838714747, 15.542936780800417, 15.474429083367184, 15.312145007153347, 28.30674907565117, 28.74731762241572, 28.556246630847454, 26.147470501561955, 26.200068210562065, 26.53490428285052, 26.503155301014573, 26.643024230996758, 26.0130657951037, 25.395442962646484, 25.36211897432804, 25.91162528656423, 17.17172374327977, 17.30301984896262, 17.08214608331521, 18.431317796309784, 19.041847483565405, 18.56723627944787, 22.998742202917725, 22.42728594938913, 23.20451937864223, 19.352947642405823, 19.19932009776433, 19.178247806926564, 26.370476201176643, 26.687658350914717, 26.825129951816052, 17.21568002303441, 17.522900988658265, 17.338033234079674, 23.124821481605366, 23.213844781120613, 23.683460142773882, 24.85035778582096, 25.03906288743019, 25.24454826116562, 18.456727155794695, 18.21022255470355, 18.03084822495778, 35.952247252066925, 36.06956277166803, 35.83885667969783, 17.15758040221408, 16.853104628622532, 16.93722376972437, 20.955511336525277, 21.275901613136128, 21.797095653911427, 24.797838387079537, 24.62415722757578, 23.43935677409172, 28.48571306963761, 28.63570538287361, 28.307143737872437, 16.74787779773274, 16.6611156190435, 15.363314668337495, 20.16274873415628, 19.939127678672463, 19.957875351111085, 28.447186661263302, 28.649683011074856, 27.817996491988495, 19.82778760790825, 20.298140870407224, 20.196658924221992, 26.693707919369132, 26.4599260042111, 26.128805364171654, 30.409303547193602, 30.568464563538626, 30.24846128871043, 32.80314900974432, 33.50251622560123, 32.8792443225781, 31.046835506955773, 31.44239843512574, 31.472946334785462, 20.098585727314145, 19.895893203715474, 20.388408162320644, 6.543596681207418, 6.630244391039014, 6.526332754641771, 30.860905079791934, 30.604292350510747, 30.9753645962725, 26.916647528608635, 27.079682697852448, 27.22122798984249, 34.82567240080485, 34.72217247883478, 34.8831303656722, 23.290652150909096, 22.57639784614244, 23.5364503810803, 34.91331510494152, 34.95105069379011, 34.910550641516835, 18.585066127280385, 18.80148126060763, 18.43630615870157, 18.482331156109765, 18.498533952360347, 18.12349773695071, 24.845927397410065, 24.128367642561585, 24.636777884016425, 35.79083094000816, 35.35384701192379, 35.693619675934315, 29.014525059610605, 28.99637931957841, 29.092163108289242, 21.836964557568223, 21.682256529728562, 21.693637775878102, 24.14457783351341, 24.147989789644868, 24.296601528922707, 17.43541443347931, 17.424072973430157, 17.63181797787547, 29.483339556648076, 29.34874569127956, 29.366905037934572, 26.870878979563713, 27.088546089828014, 27.523500526323915, 14.177201331282646, 14.202134950707347, 14.062314654390008, 44.94985748051354, 44.7720744597415, 44.75507156426707, 39.63333526005347, 39.44482897718747, 39.994585172583655, 29.31281541784604, 29.375397482266024, 29.262715888520077, 28.837848301045597, 28.473873026669025, 28.645774442702532, 27.960950300097466, 28.532050788402557, 27.869603276252747, 18.567020406325653, 18.517706652482346, 18.484351520737007, 29.478190091749028, 29.508690123756722, 29.379627776642636, 18.497336054841668, 18.86855465794602, 18.795074256757886, 26.499653607606888, 26.996751725673676, 26.883756816387177, 25.807962646087006, 26.221745834064976, 25.819183257718876, 34.83707195023695, 35.025430301825196, 35.540736148754746, 26.564186822623014, 26.547161631286144, 26.473733104765415, 14.761261936898023, 14.357051129142434, 14.231396938363702, 39.78546519577503, 40.14283171668649, 40.1524377129972, 20.457756400108337, 19.853519305586815, 20.245190497487783, 27.008657493938998, 27.124146270876125, 27.207118307201497, 22.611650104324013, 22.740532668928296, 22.575429665545613, 22.940291198280946, 22.713739675780133, 22.276366492112473, 24.418618714747325, 24.30379377988477, 24.03011569132407, 22.684614670773342, 23.02920127830778, 22.33999830981095, 18.651760066548974, 18.903232072169573, 18.808880163977534, 29.00807513793309, 29.204852165964738, 29.236380007894084, 20.81364246706167, 20.88569502035776, 20.981237503389508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1412361428810739, "mean_inference_ms": 0.6479431585092956, "mean_action_processing_ms": 0.09500172951614888, "mean_env_wait_ms": 0.7957795022340619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 974400, "timesteps_this_iter": 0, "agent_timesteps_total": 2923200, "timers": {"sample_time_ms": 9892.623, "sample_throughput": 485.21, "load_time_ms": 0.201, "load_throughput": 23879325.347, "learn_time_ms": 1205.052, "learn_throughput": 3983.231, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 7.328439891338348, "policy_loss": 0.0008386689340114106, "vf_loss": 7.489514112472534, "vf_explained_var": 0.011942200362682343, "kl": 0.012335566454856608, "entropy": 16.285102367401123, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 974400, "num_agent_steps_sampled": 2923200, "num_steps_trained": 974400, "num_agent_steps_trained": 2923200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4178, "training_iteration": 203, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-14-28", "timestamp": 1706148868, "time_this_iter_s": 9.462591886520386, "time_total_s": 1906.765070438385, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D4E940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1906.765070438385, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 6.976923076923078, "ram_util_percent": 48.35384615384615}}
{"episode_reward_max": 134.4770035045221, "episode_reward_min": -240.66444896906614, "episode_reward_mean": 71.08499564879908, "episode_len_mean": 299.16, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -87.0790664255619}, "policy_reward_max": {"shared_policy": 44.94985748051354}, "policy_reward_mean": {"shared_policy": 23.69499854959969}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.65708444478511, 44.79324656073001, 60.02033634111285, 63.806190822273464, 86.70608489494771, 54.94000413268802, 67.34319990314543, 80.0798853114247, 114.67459098994729, 70.03990047425032, 71.48498187214136, 63.804135639220476, 62.64734549075362, 88.26220646873115, -240.66444896906614, 68.06843833529271, 46.32951087132095, 85.61031332891434, 78.88244299497454, 79.15924532711503, 76.66918722353876, 51.5568896755576, 56.04040155932306, 68.63054753094909, 57.730515547096715, 79.88326450390741, 52.07661424577235, 70.02212640549986, 75.13396893441677, 54.69779793545602, 107.86066670343278, 50.94790880056098, 64.02850860357283, 72.86135238874704, 85.42856219038366, 48.772308085113735, 60.05975176393983, 84.91486616432665, 60.322587402537465, 79.28243928775188, 91.22622939944266, 99.18490955792365, 93.96218027686697, 60.38288709335026, 19.700173826888204, 92.44056202657518, 81.21755821630357, 104.43097524531183, 69.40350037813184, 104.77491644024846, 55.822853546589585, 55.10436284542082, 73.61107292398808, 106.83829762786627, 87.10306748747826, 65.21285886317489, 72.58916915208098, 52.49130538478494, 88.19899028586221, 81.48292559571564, 42.44165093638, 134.4770035045221, 119.0727494098246, 87.95092878863214, 85.95749577041715, 84.36260436475277, 55.56907857954501, 88.36650799214839, 56.160964969545574, 80.38016214966774, 77.84889173787086, 105.40323840081689, 79.58508155867457, 43.34971000440416, 120.08073462545872, 60.556466203182936, 81.33992207201662, 67.92761243879792, 67.93039736617355, 72.75252818595617, 68.05381425889207, 56.36387230269608, 87.44930731179191, 62.680574990808935, 71.32113276049493, 74.54581842944023, 75.65681989490983, 78.15432942286131, 85.7014394290745, 81.44688429310915, 94.92008844530208, 96.37042132392526, 55.43967271037397, 70.84006674587724, 54.04873654525724, 70.68002731818703, 73.22029404342175, 51.702064940705895, 74.11832448840138, 74.52838980499654], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 216, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.322398967046553, 27.202156000460178, 27.132529477278382, 14.274713496367127, 15.293652211936802, 15.224880852426082, 19.982125349342823, 20.116098280996084, 19.922112710773945, 21.244195605317742, 21.214724237720162, 21.34727097923556, 29.034059088677168, 29.00973707344383, 28.66228873282671, 18.294720745335013, 18.332774753371865, 18.31250863398114, 22.196246773004532, 22.569539124146104, 22.577414005994797, 26.46561215321222, 26.90496868143478, 26.709304476777703, 37.98871224621931, 38.31961996729174, 38.36625877643624, 23.322349429130554, 23.524013623595238, 23.193537421524525, 23.797089837491512, 24.236148044466972, 23.451743990182877, 20.953054949641228, 21.410196144133806, 21.440884545445442, 20.867766159276158, 20.71518642703691, 21.064392904440552, 29.77191589896877, 28.699659203489617, 29.790631366272763, -77.28970119357109, -87.0790664255619, -76.29568134993315, 22.85870073308857, 22.347465763489396, 22.862271838714747, 15.542936780800417, 15.474429083367184, 15.312145007153347, 28.30674907565117, 28.74731762241572, 28.556246630847454, 26.147470501561955, 26.200068210562065, 26.53490428285052, 26.503155301014573, 26.643024230996758, 26.0130657951037, 25.395442962646484, 25.36211897432804, 25.91162528656423, 17.17172374327977, 17.30301984896262, 17.08214608331521, 18.431317796309784, 19.041847483565405, 18.56723627944787, 22.998742202917725, 22.42728594938913, 23.20451937864223, 19.352947642405823, 19.19932009776433, 19.178247806926564, 26.370476201176643, 26.687658350914717, 26.825129951816052, 17.21568002303441, 17.522900988658265, 17.338033234079674, 23.124821481605366, 23.213844781120613, 23.683460142773882, 24.85035778582096, 25.03906288743019, 25.24454826116562, 18.456727155794695, 18.21022255470355, 18.03084822495778, 35.952247252066925, 36.06956277166803, 35.83885667969783, 17.15758040221408, 16.853104628622532, 16.93722376972437, 20.955511336525277, 21.275901613136128, 21.797095653911427, 24.797838387079537, 24.62415722757578, 23.43935677409172, 28.48571306963761, 28.63570538287361, 28.307143737872437, 16.74787779773274, 16.6611156190435, 15.363314668337495, 20.16274873415628, 19.939127678672463, 19.957875351111085, 28.447186661263302, 28.649683011074856, 27.817996491988495, 19.82778760790825, 20.298140870407224, 20.196658924221992, 26.693707919369132, 26.4599260042111, 26.128805364171654, 30.409303547193602, 30.568464563538626, 30.24846128871043, 32.80314900974432, 33.50251622560123, 32.8792443225781, 31.046835506955773, 31.44239843512574, 31.472946334785462, 20.098585727314145, 19.895893203715474, 20.388408162320644, 6.543596681207418, 6.630244391039014, 6.526332754641771, 30.860905079791934, 30.604292350510747, 30.9753645962725, 26.916647528608635, 27.079682697852448, 27.22122798984249, 34.82567240080485, 34.72217247883478, 34.8831303656722, 23.290652150909096, 22.57639784614244, 23.5364503810803, 34.91331510494152, 34.95105069379011, 34.910550641516835, 18.585066127280385, 18.80148126060763, 18.43630615870157, 18.482331156109765, 18.498533952360347, 18.12349773695071, 24.845927397410065, 24.128367642561585, 24.636777884016425, 35.79083094000816, 35.35384701192379, 35.693619675934315, 29.014525059610605, 28.99637931957841, 29.092163108289242, 21.836964557568223, 21.682256529728562, 21.693637775878102, 24.14457783351341, 24.147989789644868, 24.296601528922707, 17.43541443347931, 17.424072973430157, 17.63181797787547, 29.483339556648076, 29.34874569127956, 29.366905037934572, 26.870878979563713, 27.088546089828014, 27.523500526323915, 14.177201331282646, 14.202134950707347, 14.062314654390008, 44.94985748051354, 44.7720744597415, 44.75507156426707, 39.63333526005347, 39.44482897718747, 39.994585172583655, 29.31281541784604, 29.375397482266024, 29.262715888520077, 28.837848301045597, 28.473873026669025, 28.645774442702532, 27.960950300097466, 28.532050788402557, 27.869603276252747, 18.567020406325653, 18.517706652482346, 18.484351520737007, 29.478190091749028, 29.508690123756722, 29.379627776642636, 18.497336054841668, 18.86855465794602, 18.795074256757886, 26.499653607606888, 26.996751725673676, 26.883756816387177, 25.807962646087006, 26.221745834064976, 25.819183257718876, 34.83707195023695, 35.025430301825196, 35.540736148754746, 26.564186822623014, 26.547161631286144, 26.473733104765415, 14.761261936898023, 14.357051129142434, 14.231396938363702, 39.78546519577503, 40.14283171668649, 40.1524377129972, 20.457756400108337, 19.853519305586815, 20.245190497487783, 27.008657493938998, 27.124146270876125, 27.207118307201497, 22.611650104324013, 22.740532668928296, 22.575429665545613, 22.940291198280946, 22.713739675780133, 22.276366492112473, 24.418618714747325, 24.30379377988477, 24.03011569132407, 22.684614670773342, 23.02920127830778, 22.33999830981095, 18.651760066548974, 18.903232072169573, 18.808880163977534, 29.00807513793309, 29.204852165964738, 29.236380007894084, 20.81364246706167, 20.88569502035776, 20.981237503389508, 23.371318255861596, 23.933883787443236, 24.015930717190102, 25.04737268264094, 24.514794806639344, 24.983650940159947, 25.06618612507978, 25.369179910669715, 25.221453859160334, 26.11428544173637, 26.268755591164023, 25.771288389960915, 28.594859867046267, 28.46984178821245, 28.63673777381578, 26.939353893200547, 27.121949816743523, 27.38558058316508, 31.9871723454756, 31.848967616756752, 31.083948483069733, 31.811039730906487, 32.24589676037431, 32.31348483264446, 18.21242559949556, 18.51657051841417, 18.71067659246424, 23.370504180590302, 24.0120835105578, 23.457479054729134, 17.87010759363571, 18.00506742919484, 18.173561522426695, 23.40641480187574, 23.558858579645545, 23.714753936665744, 24.348476566374302, 24.540385119616985, 24.331432357430458, 17.047444812953472, 17.50351214595139, 17.151107981801033, 24.170973564187676, 25.01131873826185, 24.93603218595186, 24.935280700524643, 24.925452402171985, 24.667656702299908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14123392071871455, "mean_inference_ms": 0.6479779964917455, "mean_action_processing_ms": 0.09499094472380981, "mean_env_wait_ms": 0.7957812230373422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 979200, "timesteps_this_iter": 0, "agent_timesteps_total": 2937600, "timers": {"sample_time_ms": 9883.897, "sample_throughput": 485.638, "load_time_ms": 0.201, "load_throughput": 23879325.347, "learn_time_ms": 1205.452, "learn_throughput": 3981.909, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 6.780782639980316, "policy_loss": -0.0012398220653833114, "vf_loss": 6.944528043270111, "vf_explained_var": 0.0115189328789711, "kl": 0.010613779479471466, "entropy": 16.33124613761902, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 979200, "num_agent_steps_sampled": 2937600, "num_steps_trained": 979200, "num_agent_steps_trained": 2937600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4194, "training_iteration": 204, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-14-38", "timestamp": 1706148878, "time_this_iter_s": 9.235053300857544, "time_total_s": 1916.0001237392426, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210632F9C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1916.0001237392426, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 6.961538461538461, "ram_util_percent": 48.46153846153847}}
{"episode_reward_max": 134.4770035045221, "episode_reward_min": 19.700173826888204, "episode_reward_mean": 74.23139027958037, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 6.526332754641771}, "policy_reward_max": {"shared_policy": 44.94985748051354}, "policy_reward_mean": {"shared_policy": 24.743796759860118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.32951087132095, 85.61031332891434, 78.88244299497454, 79.15924532711503, 76.66918722353876, 51.5568896755576, 56.04040155932306, 68.63054753094909, 57.730515547096715, 79.88326450390741, 52.07661424577235, 70.02212640549986, 75.13396893441677, 54.69779793545602, 107.86066670343278, 50.94790880056098, 64.02850860357283, 72.86135238874704, 85.42856219038366, 48.772308085113735, 60.05975176393983, 84.91486616432665, 60.322587402537465, 79.28243928775188, 91.22622939944266, 99.18490955792365, 93.96218027686697, 60.38288709335026, 19.700173826888204, 92.44056202657518, 81.21755821630357, 104.43097524531183, 69.40350037813184, 104.77491644024846, 55.822853546589585, 55.10436284542082, 73.61107292398808, 106.83829762786627, 87.10306748747826, 65.21285886317489, 72.58916915208098, 52.49130538478494, 88.19899028586221, 81.48292559571564, 42.44165093638, 134.4770035045221, 119.0727494098246, 87.95092878863214, 85.95749577041715, 84.36260436475277, 55.56907857954501, 88.36650799214839, 56.160964969545574, 80.38016214966774, 77.84889173787086, 105.40323840081689, 79.58508155867457, 43.34971000440416, 120.08073462545872, 60.556466203182936, 81.33992207201662, 67.92761243879792, 67.93039736617355, 72.75252818595617, 68.05381425889207, 56.36387230269608, 87.44930731179191, 62.680574990808935, 71.32113276049493, 74.54581842944023, 75.65681989490983, 78.15432942286131, 85.7014394290745, 81.44688429310915, 94.92008844530208, 96.37042132392526, 55.43967271037397, 70.84006674587724, 54.04873654525724, 70.68002731818703, 73.22029404342175, 51.702064940705895, 74.11832448840138, 74.52838980499654, 62.608767173136556, 72.64820840279572, 37.34039682149887, 107.03303551115094, 85.72554658353326, 38.88533869385719, 69.19005797430871, 49.40517568588257, 81.77499423967674, 76.62251527421176, 71.9419811479747, 79.49326634034512, 88.41553619876504, 87.61067116912452, 73.67036700621244, 69.93678756803271], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.542936780800417, 15.474429083367184, 15.312145007153347, 28.30674907565117, 28.74731762241572, 28.556246630847454, 26.147470501561955, 26.200068210562065, 26.53490428285052, 26.503155301014573, 26.643024230996758, 26.0130657951037, 25.395442962646484, 25.36211897432804, 25.91162528656423, 17.17172374327977, 17.30301984896262, 17.08214608331521, 18.431317796309784, 19.041847483565405, 18.56723627944787, 22.998742202917725, 22.42728594938913, 23.20451937864223, 19.352947642405823, 19.19932009776433, 19.178247806926564, 26.370476201176643, 26.687658350914717, 26.825129951816052, 17.21568002303441, 17.522900988658265, 17.338033234079674, 23.124821481605366, 23.213844781120613, 23.683460142773882, 24.85035778582096, 25.03906288743019, 25.24454826116562, 18.456727155794695, 18.21022255470355, 18.03084822495778, 35.952247252066925, 36.06956277166803, 35.83885667969783, 17.15758040221408, 16.853104628622532, 16.93722376972437, 20.955511336525277, 21.275901613136128, 21.797095653911427, 24.797838387079537, 24.62415722757578, 23.43935677409172, 28.48571306963761, 28.63570538287361, 28.307143737872437, 16.74787779773274, 16.6611156190435, 15.363314668337495, 20.16274873415628, 19.939127678672463, 19.957875351111085, 28.447186661263302, 28.649683011074856, 27.817996491988495, 19.82778760790825, 20.298140870407224, 20.196658924221992, 26.693707919369132, 26.4599260042111, 26.128805364171654, 30.409303547193602, 30.568464563538626, 30.24846128871043, 32.80314900974432, 33.50251622560123, 32.8792443225781, 31.046835506955773, 31.44239843512574, 31.472946334785462, 20.098585727314145, 19.895893203715474, 20.388408162320644, 6.543596681207418, 6.630244391039014, 6.526332754641771, 30.860905079791934, 30.604292350510747, 30.9753645962725, 26.916647528608635, 27.079682697852448, 27.22122798984249, 34.82567240080485, 34.72217247883478, 34.8831303656722, 23.290652150909096, 22.57639784614244, 23.5364503810803, 34.91331510494152, 34.95105069379011, 34.910550641516835, 18.585066127280385, 18.80148126060763, 18.43630615870157, 18.482331156109765, 18.498533952360347, 18.12349773695071, 24.845927397410065, 24.128367642561585, 24.636777884016425, 35.79083094000816, 35.35384701192379, 35.693619675934315, 29.014525059610605, 28.99637931957841, 29.092163108289242, 21.836964557568223, 21.682256529728562, 21.693637775878102, 24.14457783351341, 24.147989789644868, 24.296601528922707, 17.43541443347931, 17.424072973430157, 17.63181797787547, 29.483339556648076, 29.34874569127956, 29.366905037934572, 26.870878979563713, 27.088546089828014, 27.523500526323915, 14.177201331282646, 14.202134950707347, 14.062314654390008, 44.94985748051354, 44.7720744597415, 44.75507156426707, 39.63333526005347, 39.44482897718747, 39.994585172583655, 29.31281541784604, 29.375397482266024, 29.262715888520077, 28.837848301045597, 28.473873026669025, 28.645774442702532, 27.960950300097466, 28.532050788402557, 27.869603276252747, 18.567020406325653, 18.517706652482346, 18.484351520737007, 29.478190091749028, 29.508690123756722, 29.379627776642636, 18.497336054841668, 18.86855465794602, 18.795074256757886, 26.499653607606888, 26.996751725673676, 26.883756816387177, 25.807962646087006, 26.221745834064976, 25.819183257718876, 34.83707195023695, 35.025430301825196, 35.540736148754746, 26.564186822623014, 26.547161631286144, 26.473733104765415, 14.761261936898023, 14.357051129142434, 14.231396938363702, 39.78546519577503, 40.14283171668649, 40.1524377129972, 20.457756400108337, 19.853519305586815, 20.245190497487783, 27.008657493938998, 27.124146270876125, 27.207118307201497, 22.611650104324013, 22.740532668928296, 22.575429665545613, 22.940291198280946, 22.713739675780133, 22.276366492112473, 24.418618714747325, 24.30379377988477, 24.03011569132407, 22.684614670773342, 23.02920127830778, 22.33999830981095, 18.651760066548974, 18.903232072169573, 18.808880163977534, 29.00807513793309, 29.204852165964738, 29.236380007894084, 20.81364246706167, 20.88569502035776, 20.981237503389508, 23.371318255861596, 23.933883787443236, 24.015930717190102, 25.04737268264094, 24.514794806639344, 24.983650940159947, 25.06618612507978, 25.369179910669715, 25.221453859160334, 26.11428544173637, 26.268755591164023, 25.771288389960915, 28.594859867046267, 28.46984178821245, 28.63673777381578, 26.939353893200547, 27.121949816743523, 27.38558058316508, 31.9871723454756, 31.848967616756752, 31.083948483069733, 31.811039730906487, 32.24589676037431, 32.31348483264446, 18.21242559949556, 18.51657051841417, 18.71067659246424, 23.370504180590302, 24.0120835105578, 23.457479054729134, 17.87010759363571, 18.00506742919484, 18.173561522426695, 23.40641480187574, 23.558858579645545, 23.714753936665744, 24.348476566374302, 24.540385119616985, 24.331432357430458, 17.047444812953472, 17.50351214595139, 17.151107981801033, 24.170973564187676, 25.01131873826185, 24.93603218595186, 24.935280700524643, 24.925452402171985, 24.667656702299908, 20.596272478500993, 20.928092560420424, 21.08440213421514, 24.287438973784447, 23.55310669541359, 24.80766273359768, 12.3689074665308, 12.506233643740416, 12.465255711227655, 35.623779994746045, 35.81237953094144, 35.596875985463456, 28.703341968978435, 28.67239443647364, 28.349810178081185, 13.12647159397602, 13.135686174035072, 12.6231809258461, 23.309525435169533, 22.383330573638275, 23.497201965500906, 16.603614009916782, 16.31925943493843, 16.482302241027355, 26.93706538528204, 27.326557878404856, 27.51137097598985, 25.286757983267307, 25.63620548695326, 25.6995518039912, 23.761139685908944, 24.136741968492657, 24.0440994935731, 26.40401771167913, 26.30305604885021, 26.786192579815776, 29.555725302547216, 29.323204323649406, 29.536606572568417, 29.437734761896223, 29.09317851314941, 29.07975789407888, 24.65958363811174, 24.691578610489756, 24.319204757610947, 23.36157042781511, 23.548992874721677, 23.026224265495927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14122274352104344, "mean_inference_ms": 0.6480161223242082, "mean_action_processing_ms": 0.09498177713474776, "mean_env_wait_ms": 0.7957722266714253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 984000, "timesteps_this_iter": 0, "agent_timesteps_total": 2952000, "timers": {"sample_time_ms": 9887.686, "sample_throughput": 485.452, "load_time_ms": 0.201, "load_throughput": 23879325.347, "learn_time_ms": 1200.1, "learn_throughput": 3999.665, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 0.0005, "total_loss": 6.91835618019104, "policy_loss": 0.0032927430774076782, "vf_loss": 7.078913688659668, "vf_explained_var": 0.00556289404630661, "kl": 0.025107235415208838, "entropy": 16.575923442840576, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 984000, "num_agent_steps_sampled": 2952000, "num_steps_trained": 984000, "num_agent_steps_trained": 2952000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4210, "training_iteration": 205, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-14-47", "timestamp": 1706148887, "time_this_iter_s": 9.253145694732666, "time_total_s": 1925.2532694339752, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634F93A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1925.2532694339752, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 5.976923076923077, "ram_util_percent": 48.42307692307692}}
{"episode_reward_max": 134.4770035045221, "episode_reward_min": 19.700173826888204, "episode_reward_mean": 74.85085984941804, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 6.526332754641771}, "policy_reward_max": {"shared_policy": 44.94985748051354}, "policy_reward_mean": {"shared_policy": 24.950286616472678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.02850860357283, 72.86135238874704, 85.42856219038366, 48.772308085113735, 60.05975176393983, 84.91486616432665, 60.322587402537465, 79.28243928775188, 91.22622939944266, 99.18490955792365, 93.96218027686697, 60.38288709335026, 19.700173826888204, 92.44056202657518, 81.21755821630357, 104.43097524531183, 69.40350037813184, 104.77491644024846, 55.822853546589585, 55.10436284542082, 73.61107292398808, 106.83829762786627, 87.10306748747826, 65.21285886317489, 72.58916915208098, 52.49130538478494, 88.19899028586221, 81.48292559571564, 42.44165093638, 134.4770035045221, 119.0727494098246, 87.95092878863214, 85.95749577041715, 84.36260436475277, 55.56907857954501, 88.36650799214839, 56.160964969545574, 80.38016214966774, 77.84889173787086, 105.40323840081689, 79.58508155867457, 43.34971000440416, 120.08073462545872, 60.556466203182936, 81.33992207201662, 67.92761243879792, 67.93039736617355, 72.75252818595617, 68.05381425889207, 56.36387230269608, 87.44930731179191, 62.680574990808935, 71.32113276049493, 74.54581842944023, 75.65681989490983, 78.15432942286131, 85.7014394290745, 81.44688429310915, 94.92008844530208, 96.37042132392526, 55.43967271037397, 70.84006674587724, 54.04873654525724, 70.68002731818703, 73.22029404342175, 51.702064940705895, 74.11832448840138, 74.52838980499654, 62.608767173136556, 72.64820840279572, 37.34039682149887, 107.03303551115094, 85.72554658353326, 38.88533869385719, 69.19005797430871, 49.40517568588257, 81.77499423967674, 76.62251527421176, 71.9419811479747, 79.49326634034512, 88.41553619876504, 87.61067116912452, 73.67036700621244, 69.93678756803271, 72.01077697053549, 90.52077755983917, 48.39205898344515, 73.75151688139886, 61.72608184441924, 66.32863013446328, 100.7263696603477, 49.12266603112221, 68.9175381567329, 68.23132783174512, 64.42635913938282, 62.27210506144911, 60.33963259216398, 83.33918546605854, 89.43279367033392, 93.64053858816624], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.955511336525277, 21.275901613136128, 21.797095653911427, 24.797838387079537, 24.62415722757578, 23.43935677409172, 28.48571306963761, 28.63570538287361, 28.307143737872437, 16.74787779773274, 16.6611156190435, 15.363314668337495, 20.16274873415628, 19.939127678672463, 19.957875351111085, 28.447186661263302, 28.649683011074856, 27.817996491988495, 19.82778760790825, 20.298140870407224, 20.196658924221992, 26.693707919369132, 26.4599260042111, 26.128805364171654, 30.409303547193602, 30.568464563538626, 30.24846128871043, 32.80314900974432, 33.50251622560123, 32.8792443225781, 31.046835506955773, 31.44239843512574, 31.472946334785462, 20.098585727314145, 19.895893203715474, 20.388408162320644, 6.543596681207418, 6.630244391039014, 6.526332754641771, 30.860905079791934, 30.604292350510747, 30.9753645962725, 26.916647528608635, 27.079682697852448, 27.22122798984249, 34.82567240080485, 34.72217247883478, 34.8831303656722, 23.290652150909096, 22.57639784614244, 23.5364503810803, 34.91331510494152, 34.95105069379011, 34.910550641516835, 18.585066127280385, 18.80148126060763, 18.43630615870157, 18.482331156109765, 18.498533952360347, 18.12349773695071, 24.845927397410065, 24.128367642561585, 24.636777884016425, 35.79083094000816, 35.35384701192379, 35.693619675934315, 29.014525059610605, 28.99637931957841, 29.092163108289242, 21.836964557568223, 21.682256529728562, 21.693637775878102, 24.14457783351341, 24.147989789644868, 24.296601528922707, 17.43541443347931, 17.424072973430157, 17.63181797787547, 29.483339556648076, 29.34874569127956, 29.366905037934572, 26.870878979563713, 27.088546089828014, 27.523500526323915, 14.177201331282646, 14.202134950707347, 14.062314654390008, 44.94985748051354, 44.7720744597415, 44.75507156426707, 39.63333526005347, 39.44482897718747, 39.994585172583655, 29.31281541784604, 29.375397482266024, 29.262715888520077, 28.837848301045597, 28.473873026669025, 28.645774442702532, 27.960950300097466, 28.532050788402557, 27.869603276252747, 18.567020406325653, 18.517706652482346, 18.484351520737007, 29.478190091749028, 29.508690123756722, 29.379627776642636, 18.497336054841668, 18.86855465794602, 18.795074256757886, 26.499653607606888, 26.996751725673676, 26.883756816387177, 25.807962646087006, 26.221745834064976, 25.819183257718876, 34.83707195023695, 35.025430301825196, 35.540736148754746, 26.564186822623014, 26.547161631286144, 26.473733104765415, 14.761261936898023, 14.357051129142434, 14.231396938363702, 39.78546519577503, 40.14283171668649, 40.1524377129972, 20.457756400108337, 19.853519305586815, 20.245190497487783, 27.008657493938998, 27.124146270876125, 27.207118307201497, 22.611650104324013, 22.740532668928296, 22.575429665545613, 22.940291198280946, 22.713739675780133, 22.276366492112473, 24.418618714747325, 24.30379377988477, 24.03011569132407, 22.684614670773342, 23.02920127830778, 22.33999830981095, 18.651760066548974, 18.903232072169573, 18.808880163977534, 29.00807513793309, 29.204852165964738, 29.236380007894084, 20.81364246706167, 20.88569502035776, 20.981237503389508, 23.371318255861596, 23.933883787443236, 24.015930717190102, 25.04737268264094, 24.514794806639344, 24.983650940159947, 25.06618612507978, 25.369179910669715, 25.221453859160334, 26.11428544173637, 26.268755591164023, 25.771288389960915, 28.594859867046267, 28.46984178821245, 28.63673777381578, 26.939353893200547, 27.121949816743523, 27.38558058316508, 31.9871723454756, 31.848967616756752, 31.083948483069733, 31.811039730906487, 32.24589676037431, 32.31348483264446, 18.21242559949556, 18.51657051841417, 18.71067659246424, 23.370504180590302, 24.0120835105578, 23.457479054729134, 17.87010759363571, 18.00506742919484, 18.173561522426695, 23.40641480187574, 23.558858579645545, 23.714753936665744, 24.348476566374302, 24.540385119616985, 24.331432357430458, 17.047444812953472, 17.50351214595139, 17.151107981801033, 24.170973564187676, 25.01131873826185, 24.93603218595186, 24.935280700524643, 24.925452402171985, 24.667656702299908, 20.596272478500993, 20.928092560420424, 21.08440213421514, 24.287438973784447, 23.55310669541359, 24.80766273359768, 12.3689074665308, 12.506233643740416, 12.465255711227655, 35.623779994746045, 35.81237953094144, 35.596875985463456, 28.703341968978435, 28.67239443647364, 28.349810178081185, 13.12647159397602, 13.135686174035072, 12.6231809258461, 23.309525435169533, 22.383330573638275, 23.497201965500906, 16.603614009916782, 16.31925943493843, 16.482302241027355, 26.93706538528204, 27.326557878404856, 27.51137097598985, 25.286757983267307, 25.63620548695326, 25.6995518039912, 23.761139685908944, 24.136741968492657, 24.0440994935731, 26.40401771167913, 26.30305604885021, 26.786192579815776, 29.555725302547216, 29.323204323649406, 29.536606572568417, 29.437734761896223, 29.09317851314941, 29.07975789407888, 24.65958363811174, 24.691578610489756, 24.319204757610947, 23.36157042781511, 23.548992874721677, 23.026224265495927, 24.27077568198243, 24.043057459096104, 23.696943829456956, 29.995803420742348, 30.43773506985356, 30.087239069243267, 16.33490204190214, 16.372947723915175, 15.684209217627838, 24.548425756394863, 24.322997823357582, 24.88009330164641, 20.317768394947052, 20.874098610132933, 20.534214839339256, 22.139282668630273, 21.991975786785275, 22.197371679047734, 33.74599224701524, 33.33016560226679, 33.650211811065674, 16.362757317721844, 16.38732873648405, 16.372579976916313, 22.709859912594155, 23.286582934980586, 22.92109530915816, 22.812158601979405, 22.760234686235577, 22.658934543530137, 21.273268093665436, 21.58013295878966, 21.572958086927727, 21.170349252410233, 21.089592944830656, 20.01216286420822, 20.163576051592827, 20.539679846726358, 19.636376693844795, 27.798868240167693, 27.760479710375265, 27.77983751551558, 29.529106944799423, 29.654948443174362, 30.248738282360137, 31.264061078429222, 31.319681264460087, 31.056796245276928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1412147214873954, "mean_inference_ms": 0.6480773054443931, "mean_action_processing_ms": 0.09497528520970461, "mean_env_wait_ms": 0.7957740759474027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 988800, "timesteps_this_iter": 0, "agent_timesteps_total": 2966400, "timers": {"sample_time_ms": 9917.161, "sample_throughput": 484.01, "load_time_ms": 0.201, "load_throughput": 23879325.347, "learn_time_ms": 1195.995, "learn_throughput": 4013.396, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 0.0005, "total_loss": 6.312390565872192, "policy_loss": -0.00042167133152037906, "vf_loss": 6.476540684700012, "vf_explained_var": 0.008751004934310913, "kl": 0.013088815962265545, "entropy": 16.52209973335266, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 988800, "num_agent_steps_sampled": 2966400, "num_steps_trained": 988800, "num_agent_steps_trained": 2966400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4226, "training_iteration": 206, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-14-57", "timestamp": 1706148897, "time_this_iter_s": 9.627116680145264, "time_total_s": 1934.8803861141205, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D3B040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1934.8803861141205, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 7.307142857142857, "ram_util_percent": 48.46428571428572}}
{"episode_reward_max": 134.4770035045221, "episode_reward_min": 37.34039682149887, "episode_reward_mean": 73.645012789279, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 12.3689074665308}, "policy_reward_max": {"shared_policy": 44.94985748051354}, "policy_reward_mean": {"shared_policy": 24.548337596426325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.40350037813184, 104.77491644024846, 55.822853546589585, 55.10436284542082, 73.61107292398808, 106.83829762786627, 87.10306748747826, 65.21285886317489, 72.58916915208098, 52.49130538478494, 88.19899028586221, 81.48292559571564, 42.44165093638, 134.4770035045221, 119.0727494098246, 87.95092878863214, 85.95749577041715, 84.36260436475277, 55.56907857954501, 88.36650799214839, 56.160964969545574, 80.38016214966774, 77.84889173787086, 105.40323840081689, 79.58508155867457, 43.34971000440416, 120.08073462545872, 60.556466203182936, 81.33992207201662, 67.92761243879792, 67.93039736617355, 72.75252818595617, 68.05381425889207, 56.36387230269608, 87.44930731179191, 62.680574990808935, 71.32113276049493, 74.54581842944023, 75.65681989490983, 78.15432942286131, 85.7014394290745, 81.44688429310915, 94.92008844530208, 96.37042132392526, 55.43967271037397, 70.84006674587724, 54.04873654525724, 70.68002731818703, 73.22029404342175, 51.702064940705895, 74.11832448840138, 74.52838980499654, 62.608767173136556, 72.64820840279572, 37.34039682149887, 107.03303551115094, 85.72554658353326, 38.88533869385719, 69.19005797430871, 49.40517568588257, 81.77499423967674, 76.62251527421176, 71.9419811479747, 79.49326634034512, 88.41553619876504, 87.61067116912452, 73.67036700621244, 69.93678756803271, 72.01077697053549, 90.52077755983917, 48.39205898344515, 73.75151688139886, 61.72608184441924, 66.32863013446328, 100.7263696603477, 49.12266603112221, 68.9175381567329, 68.23132783174512, 64.42635913938282, 62.27210506144911, 60.33963259216398, 83.33918546605854, 89.43279367033392, 93.64053858816624, 74.39478340372443, 51.12550368532537, 59.74292273074387, 59.846976400353014, 69.34130882599854, 58.58541210740803, 68.35899387300012, 53.07733941078183, 64.57828362029976, 68.40101633965966, 52.57484265603122, 68.51197891496119, 85.56309047155082, 60.74436638597396, 63.954965889453874, 118.82936079986393], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.290652150909096, 22.57639784614244, 23.5364503810803, 34.91331510494152, 34.95105069379011, 34.910550641516835, 18.585066127280385, 18.80148126060763, 18.43630615870157, 18.482331156109765, 18.498533952360347, 18.12349773695071, 24.845927397410065, 24.128367642561585, 24.636777884016425, 35.79083094000816, 35.35384701192379, 35.693619675934315, 29.014525059610605, 28.99637931957841, 29.092163108289242, 21.836964557568223, 21.682256529728562, 21.693637775878102, 24.14457783351341, 24.147989789644868, 24.296601528922707, 17.43541443347931, 17.424072973430157, 17.63181797787547, 29.483339556648076, 29.34874569127956, 29.366905037934572, 26.870878979563713, 27.088546089828014, 27.523500526323915, 14.177201331282646, 14.202134950707347, 14.062314654390008, 44.94985748051354, 44.7720744597415, 44.75507156426707, 39.63333526005347, 39.44482897718747, 39.994585172583655, 29.31281541784604, 29.375397482266024, 29.262715888520077, 28.837848301045597, 28.473873026669025, 28.645774442702532, 27.960950300097466, 28.532050788402557, 27.869603276252747, 18.567020406325653, 18.517706652482346, 18.484351520737007, 29.478190091749028, 29.508690123756722, 29.379627776642636, 18.497336054841668, 18.86855465794602, 18.795074256757886, 26.499653607606888, 26.996751725673676, 26.883756816387177, 25.807962646087006, 26.221745834064976, 25.819183257718876, 34.83707195023695, 35.025430301825196, 35.540736148754746, 26.564186822623014, 26.547161631286144, 26.473733104765415, 14.761261936898023, 14.357051129142434, 14.231396938363702, 39.78546519577503, 40.14283171668649, 40.1524377129972, 20.457756400108337, 19.853519305586815, 20.245190497487783, 27.008657493938998, 27.124146270876125, 27.207118307201497, 22.611650104324013, 22.740532668928296, 22.575429665545613, 22.940291198280946, 22.713739675780133, 22.276366492112473, 24.418618714747325, 24.30379377988477, 24.03011569132407, 22.684614670773342, 23.02920127830778, 22.33999830981095, 18.651760066548974, 18.903232072169573, 18.808880163977534, 29.00807513793309, 29.204852165964738, 29.236380007894084, 20.81364246706167, 20.88569502035776, 20.981237503389508, 23.371318255861596, 23.933883787443236, 24.015930717190102, 25.04737268264094, 24.514794806639344, 24.983650940159947, 25.06618612507978, 25.369179910669715, 25.221453859160334, 26.11428544173637, 26.268755591164023, 25.771288389960915, 28.594859867046267, 28.46984178821245, 28.63673777381578, 26.939353893200547, 27.121949816743523, 27.38558058316508, 31.9871723454756, 31.848967616756752, 31.083948483069733, 31.811039730906487, 32.24589676037431, 32.31348483264446, 18.21242559949556, 18.51657051841417, 18.71067659246424, 23.370504180590302, 24.0120835105578, 23.457479054729134, 17.87010759363571, 18.00506742919484, 18.173561522426695, 23.40641480187574, 23.558858579645545, 23.714753936665744, 24.348476566374302, 24.540385119616985, 24.331432357430458, 17.047444812953472, 17.50351214595139, 17.151107981801033, 24.170973564187676, 25.01131873826185, 24.93603218595186, 24.935280700524643, 24.925452402171985, 24.667656702299908, 20.596272478500993, 20.928092560420424, 21.08440213421514, 24.287438973784447, 23.55310669541359, 24.80766273359768, 12.3689074665308, 12.506233643740416, 12.465255711227655, 35.623779994746045, 35.81237953094144, 35.596875985463456, 28.703341968978435, 28.67239443647364, 28.349810178081185, 13.12647159397602, 13.135686174035072, 12.6231809258461, 23.309525435169533, 22.383330573638275, 23.497201965500906, 16.603614009916782, 16.31925943493843, 16.482302241027355, 26.93706538528204, 27.326557878404856, 27.51137097598985, 25.286757983267307, 25.63620548695326, 25.6995518039912, 23.761139685908944, 24.136741968492657, 24.0440994935731, 26.40401771167913, 26.30305604885021, 26.786192579815776, 29.555725302547216, 29.323204323649406, 29.536606572568417, 29.437734761896223, 29.09317851314941, 29.07975789407888, 24.65958363811174, 24.691578610489756, 24.319204757610947, 23.36157042781511, 23.548992874721677, 23.026224265495927, 24.27077568198243, 24.043057459096104, 23.696943829456956, 29.995803420742348, 30.43773506985356, 30.087239069243267, 16.33490204190214, 16.372947723915175, 15.684209217627838, 24.548425756394863, 24.322997823357582, 24.88009330164641, 20.317768394947052, 20.874098610132933, 20.534214839339256, 22.139282668630273, 21.991975786785275, 22.197371679047734, 33.74599224701524, 33.33016560226679, 33.650211811065674, 16.362757317721844, 16.38732873648405, 16.372579976916313, 22.709859912594155, 23.286582934980586, 22.92109530915816, 22.812158601979405, 22.760234686235577, 22.658934543530137, 21.273268093665436, 21.58013295878966, 21.572958086927727, 21.170349252410233, 21.089592944830656, 20.01216286420822, 20.163576051592827, 20.539679846726358, 19.636376693844795, 27.798868240167693, 27.760479710375265, 27.77983751551558, 29.529106944799423, 29.654948443174362, 30.248738282360137, 31.264061078429222, 31.319681264460087, 31.056796245276928, 24.977392327040434, 24.432165041565895, 24.985226035118103, 16.542980348070458, 17.148390052219227, 17.434133285035685, 19.91653850426276, 20.178743695219353, 19.647640531261757, 20.05491574946791, 19.930811069905758, 19.861249580979347, 22.760417612890393, 23.242646905283124, 23.338244307825022, 19.68033895393212, 19.075447027881935, 19.829626125593975, 22.289672086636216, 22.940523887674004, 23.128797898689896, 17.635391439000756, 17.754515233139188, 17.68743273864189, 21.63247196244386, 21.50121785824497, 21.444593799610928, 22.718730757633836, 22.75594614694515, 22.926339435080678, 17.621796975533158, 17.851936702306062, 17.101108978192002, 22.94884028720358, 22.63675948480764, 22.92637914294997, 28.492600806057453, 28.572926027700305, 28.497563637793064, 20.338421313712985, 20.36724852739522, 20.038696544865758, 21.43958019961913, 21.390896168847874, 21.12448952098687, 39.34087589383125, 39.885235438123345, 39.603249467909336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14120559460913376, "mean_inference_ms": 0.6481497621998368, "mean_action_processing_ms": 0.09497372713953656, "mean_env_wait_ms": 0.7957813965733902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 993600, "timesteps_this_iter": 0, "agent_timesteps_total": 2980800, "timers": {"sample_time_ms": 9911.47, "sample_throughput": 484.287, "load_time_ms": 0.201, "load_throughput": 23879325.347, "learn_time_ms": 1198.895, "learn_throughput": 4003.685, "update_time_ms": 1.4}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 0.0005, "total_loss": 7.530302703380585, "policy_loss": 0.00038613850242552594, "vf_loss": 7.694080829620361, "vf_explained_var": 0.0030674487352371216, "kl": 0.010063982743602047, "entropy": 16.53117322921753, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 993600, "num_agent_steps_sampled": 2980800, "num_steps_trained": 993600, "num_agent_steps_trained": 2980800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4242, "training_iteration": 207, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-15-06", "timestamp": 1706148906, "time_this_iter_s": 9.519347190856934, "time_total_s": 1944.3997333049774, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015C9820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1944.3997333049774, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 10.72307692307692, "ram_util_percent": 48.53846153846154}}
{"episode_reward_max": 120.08073462545872, "episode_reward_min": 35.64222503080964, "episode_reward_mean": 72.00566919420264, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 11.19683238863945}, "policy_reward_max": {"shared_policy": 40.1524377129972}, "policy_reward_mean": {"shared_policy": 24.001889731400873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.95749577041715, 84.36260436475277, 55.56907857954501, 88.36650799214839, 56.160964969545574, 80.38016214966774, 77.84889173787086, 105.40323840081689, 79.58508155867457, 43.34971000440416, 120.08073462545872, 60.556466203182936, 81.33992207201662, 67.92761243879792, 67.93039736617355, 72.75252818595617, 68.05381425889207, 56.36387230269608, 87.44930731179191, 62.680574990808935, 71.32113276049493, 74.54581842944023, 75.65681989490983, 78.15432942286131, 85.7014394290745, 81.44688429310915, 94.92008844530208, 96.37042132392526, 55.43967271037397, 70.84006674587724, 54.04873654525724, 70.68002731818703, 73.22029404342175, 51.702064940705895, 74.11832448840138, 74.52838980499654, 62.608767173136556, 72.64820840279572, 37.34039682149887, 107.03303551115094, 85.72554658353326, 38.88533869385719, 69.19005797430871, 49.40517568588257, 81.77499423967674, 76.62251527421176, 71.9419811479747, 79.49326634034512, 88.41553619876504, 87.61067116912452, 73.67036700621244, 69.93678756803271, 72.01077697053549, 90.52077755983917, 48.39205898344515, 73.75151688139886, 61.72608184441924, 66.32863013446328, 100.7263696603477, 49.12266603112221, 68.9175381567329, 68.23132783174512, 64.42635913938282, 62.27210506144911, 60.33963259216398, 83.33918546605854, 89.43279367033392, 93.64053858816624, 74.39478340372443, 51.12550368532537, 59.74292273074387, 59.846976400353014, 69.34130882599854, 58.58541210740803, 68.35899387300012, 53.07733941078183, 64.57828362029976, 68.40101633965966, 52.57484265603122, 68.51197891496119, 85.56309047155082, 60.74436638597396, 63.954965889453874, 118.82936079986393, 92.20055461674926, 70.00696100667118, 72.53005760768426, 78.86922868341208, 61.64011783897875, 103.66083831712601, 80.30227057542649, 50.61391262244433, 61.28141072019933, 67.23913273029028, 77.800781507045, 69.14224841073153, 80.77274208609013, 63.13151054084298, 35.64222503080964, 67.80730136856434], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.837848301045597, 28.473873026669025, 28.645774442702532, 27.960950300097466, 28.532050788402557, 27.869603276252747, 18.567020406325653, 18.517706652482346, 18.484351520737007, 29.478190091749028, 29.508690123756722, 29.379627776642636, 18.497336054841668, 18.86855465794602, 18.795074256757886, 26.499653607606888, 26.996751725673676, 26.883756816387177, 25.807962646087006, 26.221745834064976, 25.819183257718876, 34.83707195023695, 35.025430301825196, 35.540736148754746, 26.564186822623014, 26.547161631286144, 26.473733104765415, 14.761261936898023, 14.357051129142434, 14.231396938363702, 39.78546519577503, 40.14283171668649, 40.1524377129972, 20.457756400108337, 19.853519305586815, 20.245190497487783, 27.008657493938998, 27.124146270876125, 27.207118307201497, 22.611650104324013, 22.740532668928296, 22.575429665545613, 22.940291198280946, 22.713739675780133, 22.276366492112473, 24.418618714747325, 24.30379377988477, 24.03011569132407, 22.684614670773342, 23.02920127830778, 22.33999830981095, 18.651760066548974, 18.903232072169573, 18.808880163977534, 29.00807513793309, 29.204852165964738, 29.236380007894084, 20.81364246706167, 20.88569502035776, 20.981237503389508, 23.371318255861596, 23.933883787443236, 24.015930717190102, 25.04737268264094, 24.514794806639344, 24.983650940159947, 25.06618612507978, 25.369179910669715, 25.221453859160334, 26.11428544173637, 26.268755591164023, 25.771288389960915, 28.594859867046267, 28.46984178821245, 28.63673777381578, 26.939353893200547, 27.121949816743523, 27.38558058316508, 31.9871723454756, 31.848967616756752, 31.083948483069733, 31.811039730906487, 32.24589676037431, 32.31348483264446, 18.21242559949556, 18.51657051841417, 18.71067659246424, 23.370504180590302, 24.0120835105578, 23.457479054729134, 17.87010759363571, 18.00506742919484, 18.173561522426695, 23.40641480187574, 23.558858579645545, 23.714753936665744, 24.348476566374302, 24.540385119616985, 24.331432357430458, 17.047444812953472, 17.50351214595139, 17.151107981801033, 24.170973564187676, 25.01131873826185, 24.93603218595186, 24.935280700524643, 24.925452402171985, 24.667656702299908, 20.596272478500993, 20.928092560420424, 21.08440213421514, 24.287438973784447, 23.55310669541359, 24.80766273359768, 12.3689074665308, 12.506233643740416, 12.465255711227655, 35.623779994746045, 35.81237953094144, 35.596875985463456, 28.703341968978435, 28.67239443647364, 28.349810178081185, 13.12647159397602, 13.135686174035072, 12.6231809258461, 23.309525435169533, 22.383330573638275, 23.497201965500906, 16.603614009916782, 16.31925943493843, 16.482302241027355, 26.93706538528204, 27.326557878404856, 27.51137097598985, 25.286757983267307, 25.63620548695326, 25.6995518039912, 23.761139685908944, 24.136741968492657, 24.0440994935731, 26.40401771167913, 26.30305604885021, 26.786192579815776, 29.555725302547216, 29.323204323649406, 29.536606572568417, 29.437734761896223, 29.09317851314941, 29.07975789407888, 24.65958363811174, 24.691578610489756, 24.319204757610947, 23.36157042781511, 23.548992874721677, 23.026224265495927, 24.27077568198243, 24.043057459096104, 23.696943829456956, 29.995803420742348, 30.43773506985356, 30.087239069243267, 16.33490204190214, 16.372947723915175, 15.684209217627838, 24.548425756394863, 24.322997823357582, 24.88009330164641, 20.317768394947052, 20.874098610132933, 20.534214839339256, 22.139282668630273, 21.991975786785275, 22.197371679047734, 33.74599224701524, 33.33016560226679, 33.650211811065674, 16.362757317721844, 16.38732873648405, 16.372579976916313, 22.709859912594155, 23.286582934980586, 22.92109530915816, 22.812158601979405, 22.760234686235577, 22.658934543530137, 21.273268093665436, 21.58013295878966, 21.572958086927727, 21.170349252410233, 21.089592944830656, 20.01216286420822, 20.163576051592827, 20.539679846726358, 19.636376693844795, 27.798868240167693, 27.760479710375265, 27.77983751551558, 29.529106944799423, 29.654948443174362, 30.248738282360137, 31.264061078429222, 31.319681264460087, 31.056796245276928, 24.977392327040434, 24.432165041565895, 24.985226035118103, 16.542980348070458, 17.148390052219227, 17.434133285035685, 19.91653850426276, 20.178743695219353, 19.647640531261757, 20.05491574946791, 19.930811069905758, 19.861249580979347, 22.760417612890393, 23.242646905283124, 23.338244307825022, 19.68033895393212, 19.075447027881935, 19.829626125593975, 22.289672086636216, 22.940523887674004, 23.128797898689896, 17.635391439000756, 17.754515233139188, 17.68743273864189, 21.63247196244386, 21.50121785824497, 21.444593799610928, 22.718730757633836, 22.75594614694515, 22.926339435080678, 17.621796975533158, 17.851936702306062, 17.101108978192002, 22.94884028720358, 22.63675948480764, 22.92637914294997, 28.492600806057453, 28.572926027700305, 28.497563637793064, 20.338421313712985, 20.36724852739522, 20.038696544865758, 21.43958019961913, 21.390896168847874, 21.12448952098687, 39.34087589383125, 39.885235438123345, 39.603249467909336, 30.523057321707398, 30.622342641154916, 31.055154653886945, 23.018756007154778, 23.52314932396014, 23.465055675556258, 24.441242278708756, 24.094966056446225, 23.993849272529275, 25.727392107248306, 26.694265238940716, 26.447571337223053, 20.514674832423523, 20.67238790293534, 20.45305510361989, 34.494700143734605, 34.45824188242355, 34.70789629096785, 26.80906614723304, 26.600294368962437, 26.892910059231014, 16.655357636511326, 17.128469984047115, 16.83008500188589, 20.460336954643324, 20.570953768988446, 20.250119996567562, 22.193362077077225, 22.57979486820598, 22.465975785007075, 25.995858325312525, 25.759795452157647, 26.04512772957483, 22.94191717604795, 23.05313355724016, 23.147197677443415, 27.153888514575854, 26.750089225669697, 26.868764345844582, 21.0834257180492, 21.085121079037577, 20.962963743756205, 12.165137186646461, 12.28025545552373, 11.19683238863945, 22.538682791093976, 22.380921403566987, 22.887697173903376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14119986068783189, "mean_inference_ms": 0.6482401373893205, "mean_action_processing_ms": 0.0949774583834795, "mean_env_wait_ms": 0.7958016732357409, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 998400, "timesteps_this_iter": 0, "agent_timesteps_total": 2995200, "timers": {"sample_time_ms": 9920.742, "sample_throughput": 483.835, "load_time_ms": 0.201, "load_throughput": 23879325.347, "learn_time_ms": 1198.4, "learn_throughput": 4005.34, "update_time_ms": 1.503}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 0.0005, "total_loss": 7.213219106197357, "policy_loss": -0.0015930437791715768, "vf_loss": 7.37979394197464, "vf_explained_var": 0.017973609268665314, "kl": 0.006236040761301403, "entropy": 16.569261074066162, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 998400, "num_agent_steps_sampled": 2995200, "num_steps_trained": 998400, "num_agent_steps_trained": 2995200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4258, "training_iteration": 208, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-15-16", "timestamp": 1706148916, "time_this_iter_s": 9.554064989089966, "time_total_s": 1953.9537982940674, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002BFD0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1953.9537982940674, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 7.535714285714286, "ram_util_percent": 48.70714285714285}}
{"episode_reward_max": 118.82936079986393, "episode_reward_min": 35.64222503080964, "episode_reward_mean": 72.88063536216912, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 11.19683238863945}, "policy_reward_max": {"shared_policy": 39.885235438123345}, "policy_reward_mean": {"shared_policy": 24.293545120723035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.05381425889207, 56.36387230269608, 87.44930731179191, 62.680574990808935, 71.32113276049493, 74.54581842944023, 75.65681989490983, 78.15432942286131, 85.7014394290745, 81.44688429310915, 94.92008844530208, 96.37042132392526, 55.43967271037397, 70.84006674587724, 54.04873654525724, 70.68002731818703, 73.22029404342175, 51.702064940705895, 74.11832448840138, 74.52838980499654, 62.608767173136556, 72.64820840279572, 37.34039682149887, 107.03303551115094, 85.72554658353326, 38.88533869385719, 69.19005797430871, 49.40517568588257, 81.77499423967674, 76.62251527421176, 71.9419811479747, 79.49326634034512, 88.41553619876504, 87.61067116912452, 73.67036700621244, 69.93678756803271, 72.01077697053549, 90.52077755983917, 48.39205898344515, 73.75151688139886, 61.72608184441924, 66.32863013446328, 100.7263696603477, 49.12266603112221, 68.9175381567329, 68.23132783174512, 64.42635913938282, 62.27210506144911, 60.33963259216398, 83.33918546605854, 89.43279367033392, 93.64053858816624, 74.39478340372443, 51.12550368532537, 59.74292273074387, 59.846976400353014, 69.34130882599854, 58.58541210740803, 68.35899387300012, 53.07733941078183, 64.57828362029976, 68.40101633965966, 52.57484265603122, 68.51197891496119, 85.56309047155082, 60.74436638597396, 63.954965889453874, 118.82936079986393, 92.20055461674926, 70.00696100667118, 72.53005760768426, 78.86922868341208, 61.64011783897875, 103.66083831712601, 80.30227057542649, 50.61391262244433, 61.28141072019933, 67.23913273029028, 77.800781507045, 69.14224841073153, 80.77274208609013, 63.13151054084298, 35.64222503080964, 67.80730136856434, 73.4750625863671, 98.48713654093443, 68.71457777917382, 63.8351775786723, 87.47608999535439, 78.4142736047506, 69.57811318524182, 77.21210150886326, 71.32968684658407, 91.55313318595287, 96.81338197924195, 104.83611105103046, 86.44735856726766, 75.06955199688673, 69.52466010488568, 102.30159670487046], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.684614670773342, 23.02920127830778, 22.33999830981095, 18.651760066548974, 18.903232072169573, 18.808880163977534, 29.00807513793309, 29.204852165964738, 29.236380007894084, 20.81364246706167, 20.88569502035776, 20.981237503389508, 23.371318255861596, 23.933883787443236, 24.015930717190102, 25.04737268264094, 24.514794806639344, 24.983650940159947, 25.06618612507978, 25.369179910669715, 25.221453859160334, 26.11428544173637, 26.268755591164023, 25.771288389960915, 28.594859867046267, 28.46984178821245, 28.63673777381578, 26.939353893200547, 27.121949816743523, 27.38558058316508, 31.9871723454756, 31.848967616756752, 31.083948483069733, 31.811039730906487, 32.24589676037431, 32.31348483264446, 18.21242559949556, 18.51657051841417, 18.71067659246424, 23.370504180590302, 24.0120835105578, 23.457479054729134, 17.87010759363571, 18.00506742919484, 18.173561522426695, 23.40641480187574, 23.558858579645545, 23.714753936665744, 24.348476566374302, 24.540385119616985, 24.331432357430458, 17.047444812953472, 17.50351214595139, 17.151107981801033, 24.170973564187676, 25.01131873826185, 24.93603218595186, 24.935280700524643, 24.925452402171985, 24.667656702299908, 20.596272478500993, 20.928092560420424, 21.08440213421514, 24.287438973784447, 23.55310669541359, 24.80766273359768, 12.3689074665308, 12.506233643740416, 12.465255711227655, 35.623779994746045, 35.81237953094144, 35.596875985463456, 28.703341968978435, 28.67239443647364, 28.349810178081185, 13.12647159397602, 13.135686174035072, 12.6231809258461, 23.309525435169533, 22.383330573638275, 23.497201965500906, 16.603614009916782, 16.31925943493843, 16.482302241027355, 26.93706538528204, 27.326557878404856, 27.51137097598985, 25.286757983267307, 25.63620548695326, 25.6995518039912, 23.761139685908944, 24.136741968492657, 24.0440994935731, 26.40401771167913, 26.30305604885021, 26.786192579815776, 29.555725302547216, 29.323204323649406, 29.536606572568417, 29.437734761896223, 29.09317851314941, 29.07975789407888, 24.65958363811174, 24.691578610489756, 24.319204757610947, 23.36157042781511, 23.548992874721677, 23.026224265495927, 24.27077568198243, 24.043057459096104, 23.696943829456956, 29.995803420742348, 30.43773506985356, 30.087239069243267, 16.33490204190214, 16.372947723915175, 15.684209217627838, 24.548425756394863, 24.322997823357582, 24.88009330164641, 20.317768394947052, 20.874098610132933, 20.534214839339256, 22.139282668630273, 21.991975786785275, 22.197371679047734, 33.74599224701524, 33.33016560226679, 33.650211811065674, 16.362757317721844, 16.38732873648405, 16.372579976916313, 22.709859912594155, 23.286582934980586, 22.92109530915816, 22.812158601979405, 22.760234686235577, 22.658934543530137, 21.273268093665436, 21.58013295878966, 21.572958086927727, 21.170349252410233, 21.089592944830656, 20.01216286420822, 20.163576051592827, 20.539679846726358, 19.636376693844795, 27.798868240167693, 27.760479710375265, 27.77983751551558, 29.529106944799423, 29.654948443174362, 30.248738282360137, 31.264061078429222, 31.319681264460087, 31.056796245276928, 24.977392327040434, 24.432165041565895, 24.985226035118103, 16.542980348070458, 17.148390052219227, 17.434133285035685, 19.91653850426276, 20.178743695219353, 19.647640531261757, 20.05491574946791, 19.930811069905758, 19.861249580979347, 22.760417612890393, 23.242646905283124, 23.338244307825022, 19.68033895393212, 19.075447027881935, 19.829626125593975, 22.289672086636216, 22.940523887674004, 23.128797898689896, 17.635391439000756, 17.754515233139188, 17.68743273864189, 21.63247196244386, 21.50121785824497, 21.444593799610928, 22.718730757633836, 22.75594614694515, 22.926339435080678, 17.621796975533158, 17.851936702306062, 17.101108978192002, 22.94884028720358, 22.63675948480764, 22.92637914294997, 28.492600806057453, 28.572926027700305, 28.497563637793064, 20.338421313712985, 20.36724852739522, 20.038696544865758, 21.43958019961913, 21.390896168847874, 21.12448952098687, 39.34087589383125, 39.885235438123345, 39.603249467909336, 30.523057321707398, 30.622342641154916, 31.055154653886945, 23.018756007154778, 23.52314932396014, 23.465055675556258, 24.441242278708756, 24.094966056446225, 23.993849272529275, 25.727392107248306, 26.694265238940716, 26.447571337223053, 20.514674832423523, 20.67238790293534, 20.45305510361989, 34.494700143734605, 34.45824188242355, 34.70789629096785, 26.80906614723304, 26.600294368962437, 26.892910059231014, 16.655357636511326, 17.128469984047115, 16.83008500188589, 20.460336954643324, 20.570953768988446, 20.250119996567562, 22.193362077077225, 22.57979486820598, 22.465975785007075, 25.995858325312525, 25.759795452157647, 26.04512772957483, 22.94191717604795, 23.05313355724016, 23.147197677443415, 27.153888514575854, 26.750089225669697, 26.868764345844582, 21.0834257180492, 21.085121079037577, 20.962963743756205, 12.165137186646461, 12.28025545552373, 11.19683238863945, 22.538682791093976, 22.380921403566987, 22.887697173903376, 24.53674275117615, 24.549744070197136, 24.388575764993817, 32.67622624834378, 32.892964317773774, 32.917945974816874, 22.83074418703714, 22.948385799924523, 22.93544779221216, 20.85772541165352, 21.685430214449298, 21.292021952569485, 29.24242186608413, 28.996324355403573, 29.237343773866684, 25.84582012395063, 26.14372071127096, 26.424732769529015, 23.26501263678074, 22.97927735745907, 23.33382319100201, 25.705786404510334, 25.661976655324295, 25.844338449028626, 23.704573599000767, 24.033321806540087, 23.591791441043213, 30.351179564992577, 30.861129617939383, 30.340824003020913, 32.353482750554875, 31.819691454370812, 32.640207774316266, 34.99578870087862, 35.472018231637776, 34.36830411851406, 29.00630596652627, 28.517339318990707, 28.92371328175068, 24.693553909659386, 25.188802365213633, 25.187195722013712, 23.290176364903644, 23.041183372338608, 23.19330036764343, 34.37698385491967, 34.13967315852642, 33.78493969142437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14119684959528453, "mean_inference_ms": 0.6483519367933498, "mean_action_processing_ms": 0.09498464415539398, "mean_env_wait_ms": 0.7958343699798174, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1003200, "timesteps_this_iter": 0, "agent_timesteps_total": 3009600, "timers": {"sample_time_ms": 9947.085, "sample_throughput": 482.553, "load_time_ms": 0.301, "load_throughput": 15951714.761, "learn_time_ms": 1202.201, "learn_throughput": 3992.677, "update_time_ms": 1.603}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 0.0005, "total_loss": 7.432803928852081, "policy_loss": -0.001991512230823833, "vf_loss": 7.599526941776276, "vf_explained_var": 0.015858516097068787, "kl": 0.0050464604867880725, "entropy": 16.530707597732544, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1003200, "num_agent_steps_sampled": 3009600, "num_steps_trained": 1003200, "num_agent_steps_trained": 3009600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4274, "training_iteration": 209, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-15-25", "timestamp": 1706148925, "time_this_iter_s": 9.640275716781616, "time_total_s": 1963.594074010849, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015BC040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1963.594074010849, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 8.292307692307691, "ram_util_percent": 48.78461538461538}}
{"episode_reward_max": 118.82936079986393, "episode_reward_min": 19.588208431377993, "episode_reward_mean": 73.14440070767829, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 6.133257572849587}, "policy_reward_max": {"shared_policy": 39.885235438123345}, "policy_reward_mean": {"shared_policy": 24.381466902559424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.22029404342175, 51.702064940705895, 74.11832448840138, 74.52838980499654, 62.608767173136556, 72.64820840279572, 37.34039682149887, 107.03303551115094, 85.72554658353326, 38.88533869385719, 69.19005797430871, 49.40517568588257, 81.77499423967674, 76.62251527421176, 71.9419811479747, 79.49326634034512, 88.41553619876504, 87.61067116912452, 73.67036700621244, 69.93678756803271, 72.01077697053549, 90.52077755983917, 48.39205898344515, 73.75151688139886, 61.72608184441924, 66.32863013446328, 100.7263696603477, 49.12266603112221, 68.9175381567329, 68.23132783174512, 64.42635913938282, 62.27210506144911, 60.33963259216398, 83.33918546605854, 89.43279367033392, 93.64053858816624, 74.39478340372443, 51.12550368532537, 59.74292273074387, 59.846976400353014, 69.34130882599854, 58.58541210740803, 68.35899387300012, 53.07733941078183, 64.57828362029976, 68.40101633965966, 52.57484265603122, 68.51197891496119, 85.56309047155082, 60.74436638597396, 63.954965889453874, 118.82936079986393, 92.20055461674926, 70.00696100667118, 72.53005760768426, 78.86922868341208, 61.64011783897875, 103.66083831712601, 80.30227057542649, 50.61391262244433, 61.28141072019933, 67.23913273029028, 77.800781507045, 69.14224841073153, 80.77274208609013, 63.13151054084298, 35.64222503080964, 67.80730136856434, 73.4750625863671, 98.48713654093443, 68.71457777917382, 63.8351775786723, 87.47608999535439, 78.4142736047506, 69.57811318524182, 77.21210150886326, 71.32968684658407, 91.55313318595287, 96.81338197924195, 104.83611105103046, 86.44735856726766, 75.06955199688673, 69.52466010488568, 102.30159670487046, 103.91037837415934, 65.73209267109631, 101.32436138391493, 76.79361211508511, 83.01595835387704, 19.588208431377993, 86.53157065063714, 91.59447243809697, 54.888510420918436, 71.04051791690289, 45.18075850605963, 113.08901585638523, 73.47249962389469, 83.05434622243047, 68.02919790335, 72.80403986573218], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.348476566374302, 24.540385119616985, 24.331432357430458, 17.047444812953472, 17.50351214595139, 17.151107981801033, 24.170973564187676, 25.01131873826185, 24.93603218595186, 24.935280700524643, 24.925452402171985, 24.667656702299908, 20.596272478500993, 20.928092560420424, 21.08440213421514, 24.287438973784447, 23.55310669541359, 24.80766273359768, 12.3689074665308, 12.506233643740416, 12.465255711227655, 35.623779994746045, 35.81237953094144, 35.596875985463456, 28.703341968978435, 28.67239443647364, 28.349810178081185, 13.12647159397602, 13.135686174035072, 12.6231809258461, 23.309525435169533, 22.383330573638275, 23.497201965500906, 16.603614009916782, 16.31925943493843, 16.482302241027355, 26.93706538528204, 27.326557878404856, 27.51137097598985, 25.286757983267307, 25.63620548695326, 25.6995518039912, 23.761139685908944, 24.136741968492657, 24.0440994935731, 26.40401771167913, 26.30305604885021, 26.786192579815776, 29.555725302547216, 29.323204323649406, 29.536606572568417, 29.437734761896223, 29.09317851314941, 29.07975789407888, 24.65958363811174, 24.691578610489756, 24.319204757610947, 23.36157042781511, 23.548992874721677, 23.026224265495927, 24.27077568198243, 24.043057459096104, 23.696943829456956, 29.995803420742348, 30.43773506985356, 30.087239069243267, 16.33490204190214, 16.372947723915175, 15.684209217627838, 24.548425756394863, 24.322997823357582, 24.88009330164641, 20.317768394947052, 20.874098610132933, 20.534214839339256, 22.139282668630273, 21.991975786785275, 22.197371679047734, 33.74599224701524, 33.33016560226679, 33.650211811065674, 16.362757317721844, 16.38732873648405, 16.372579976916313, 22.709859912594155, 23.286582934980586, 22.92109530915816, 22.812158601979405, 22.760234686235577, 22.658934543530137, 21.273268093665436, 21.58013295878966, 21.572958086927727, 21.170349252410233, 21.089592944830656, 20.01216286420822, 20.163576051592827, 20.539679846726358, 19.636376693844795, 27.798868240167693, 27.760479710375265, 27.77983751551558, 29.529106944799423, 29.654948443174362, 30.248738282360137, 31.264061078429222, 31.319681264460087, 31.056796245276928, 24.977392327040434, 24.432165041565895, 24.985226035118103, 16.542980348070458, 17.148390052219227, 17.434133285035685, 19.91653850426276, 20.178743695219353, 19.647640531261757, 20.05491574946791, 19.930811069905758, 19.861249580979347, 22.760417612890393, 23.242646905283124, 23.338244307825022, 19.68033895393212, 19.075447027881935, 19.829626125593975, 22.289672086636216, 22.940523887674004, 23.128797898689896, 17.635391439000756, 17.754515233139188, 17.68743273864189, 21.63247196244386, 21.50121785824497, 21.444593799610928, 22.718730757633836, 22.75594614694515, 22.926339435080678, 17.621796975533158, 17.851936702306062, 17.101108978192002, 22.94884028720358, 22.63675948480764, 22.92637914294997, 28.492600806057453, 28.572926027700305, 28.497563637793064, 20.338421313712985, 20.36724852739522, 20.038696544865758, 21.43958019961913, 21.390896168847874, 21.12448952098687, 39.34087589383125, 39.885235438123345, 39.603249467909336, 30.523057321707398, 30.622342641154916, 31.055154653886945, 23.018756007154778, 23.52314932396014, 23.465055675556258, 24.441242278708756, 24.094966056446225, 23.993849272529275, 25.727392107248306, 26.694265238940716, 26.447571337223053, 20.514674832423523, 20.67238790293534, 20.45305510361989, 34.494700143734605, 34.45824188242355, 34.70789629096785, 26.80906614723304, 26.600294368962437, 26.892910059231014, 16.655357636511326, 17.128469984047115, 16.83008500188589, 20.460336954643324, 20.570953768988446, 20.250119996567562, 22.193362077077225, 22.57979486820598, 22.465975785007075, 25.995858325312525, 25.759795452157647, 26.04512772957483, 22.94191717604795, 23.05313355724016, 23.147197677443415, 27.153888514575854, 26.750089225669697, 26.868764345844582, 21.0834257180492, 21.085121079037577, 20.962963743756205, 12.165137186646461, 12.28025545552373, 11.19683238863945, 22.538682791093976, 22.380921403566987, 22.887697173903376, 24.53674275117615, 24.549744070197136, 24.388575764993817, 32.67622624834378, 32.892964317773774, 32.917945974816874, 22.83074418703714, 22.948385799924523, 22.93544779221216, 20.85772541165352, 21.685430214449298, 21.292021952569485, 29.24242186608413, 28.996324355403573, 29.237343773866684, 25.84582012395063, 26.14372071127096, 26.424732769529015, 23.26501263678074, 22.97927735745907, 23.33382319100201, 25.705786404510334, 25.661976655324295, 25.844338449028626, 23.704573599000767, 24.033321806540087, 23.591791441043213, 30.351179564992577, 30.861129617939383, 30.340824003020913, 32.353482750554875, 31.819691454370812, 32.640207774316266, 34.99578870087862, 35.472018231637776, 34.36830411851406, 29.00630596652627, 28.517339318990707, 28.92371328175068, 24.693553909659386, 25.188802365213633, 25.187195722013712, 23.290176364903644, 23.041183372338608, 23.19330036764343, 34.37698385491967, 34.13967315852642, 33.78493969142437, 34.88466729968786, 34.528722405433655, 34.49698866903782, 21.986369875570134, 21.91554506619771, 21.83017772932847, 34.180599105854824, 33.849470419188336, 33.29429185887177, 25.75378807385762, 25.314878617723778, 25.724945423503712, 27.87465417260924, 27.809649309764296, 27.331654871503503, 6.133257572849587, 7.091080456351236, 6.36387040217717, 28.986733370771006, 28.31715377171834, 29.22768350814779, 30.664025540153176, 30.569708714882523, 30.360738183061272, 18.217047619322926, 18.29396182547012, 18.37750097612539, 23.871481935804084, 23.372317781050995, 23.796718200047806, 15.36117936422427, 15.404756990571812, 14.41482215126355, 37.73540958762169, 37.83860940486193, 37.514996863901615, 24.467867463827133, 24.797996655106544, 24.206635504961014, 27.69909824989736, 27.708098290488124, 27.647149682044983, 22.622983664274216, 22.957994820550084, 22.448219418525696, 24.06780173381169, 24.077808534105614, 24.658429597814873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14118903464442611, "mean_inference_ms": 0.6484569434479706, "mean_action_processing_ms": 0.09499408263257884, "mean_env_wait_ms": 0.7958675147222171, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1008000, "timesteps_this_iter": 0, "agent_timesteps_total": 3024000, "timers": {"sample_time_ms": 9930.632, "sample_throughput": 483.353, "load_time_ms": 0.201, "load_throughput": 23899168.091, "learn_time_ms": 1202.101, "learn_throughput": 3993.008, "update_time_ms": 1.603}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 0.0005, "total_loss": 9.324877977371216, "policy_loss": -0.0013560208767495752, "vf_loss": 9.48846447467804, "vf_explained_var": 0.019826248288154602, "kl": 0.008229493687692522, "entropy": 16.316858768463135, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1008000, "num_agent_steps_sampled": 3024000, "num_steps_trained": 1008000, "num_agent_steps_trained": 3024000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4290, "training_iteration": 210, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-15-35", "timestamp": 1706148935, "time_this_iter_s": 9.198715209960938, "time_total_s": 1972.79278922081, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210004ECE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1972.79278922081, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 8.200000000000001, "ram_util_percent": 48.76428571428571}}
{"episode_reward_max": 118.82936079986393, "episode_reward_min": 19.588208431377993, "episode_reward_mean": 73.30055409902532, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 6.133257572849587}, "policy_reward_max": {"shared_policy": 39.885235438123345}, "policy_reward_mean": {"shared_policy": 24.433518033008433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.41553619876504, 87.61067116912452, 73.67036700621244, 69.93678756803271, 72.01077697053549, 90.52077755983917, 48.39205898344515, 73.75151688139886, 61.72608184441924, 66.32863013446328, 100.7263696603477, 49.12266603112221, 68.9175381567329, 68.23132783174512, 64.42635913938282, 62.27210506144911, 60.33963259216398, 83.33918546605854, 89.43279367033392, 93.64053858816624, 74.39478340372443, 51.12550368532537, 59.74292273074387, 59.846976400353014, 69.34130882599854, 58.58541210740803, 68.35899387300012, 53.07733941078183, 64.57828362029976, 68.40101633965966, 52.57484265603122, 68.51197891496119, 85.56309047155082, 60.74436638597396, 63.954965889453874, 118.82936079986393, 92.20055461674926, 70.00696100667118, 72.53005760768426, 78.86922868341208, 61.64011783897875, 103.66083831712601, 80.30227057542649, 50.61391262244433, 61.28141072019933, 67.23913273029028, 77.800781507045, 69.14224841073153, 80.77274208609013, 63.13151054084298, 35.64222503080964, 67.80730136856434, 73.4750625863671, 98.48713654093443, 68.71457777917382, 63.8351775786723, 87.47608999535439, 78.4142736047506, 69.57811318524182, 77.21210150886326, 71.32968684658407, 91.55313318595287, 96.81338197924195, 104.83611105103046, 86.44735856726766, 75.06955199688673, 69.52466010488568, 102.30159670487046, 103.91037837415934, 65.73209267109631, 101.32436138391493, 76.79361211508511, 83.01595835387704, 19.588208431377993, 86.53157065063714, 91.59447243809697, 54.888510420918436, 71.04051791690289, 45.18075850605963, 113.08901585638523, 73.47249962389469, 83.05434622243047, 68.02919790335, 72.80403986573218, 68.89845640212297, 57.82562892604618, 72.09955548122522, 64.72006252035499, 69.51388876140116, 58.183711688965545, 73.967277277261, 75.85451147519049, 63.38758305693045, 66.25146386772393, 66.84774026367813, 66.07019235007463, 84.44929889030755, 54.21941753476858, 80.50623856997115, 99.05866919457912], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [29.555725302547216, 29.323204323649406, 29.536606572568417, 29.437734761896223, 29.09317851314941, 29.07975789407888, 24.65958363811174, 24.691578610489756, 24.319204757610947, 23.36157042781511, 23.548992874721677, 23.026224265495927, 24.27077568198243, 24.043057459096104, 23.696943829456956, 29.995803420742348, 30.43773506985356, 30.087239069243267, 16.33490204190214, 16.372947723915175, 15.684209217627838, 24.548425756394863, 24.322997823357582, 24.88009330164641, 20.317768394947052, 20.874098610132933, 20.534214839339256, 22.139282668630273, 21.991975786785275, 22.197371679047734, 33.74599224701524, 33.33016560226679, 33.650211811065674, 16.362757317721844, 16.38732873648405, 16.372579976916313, 22.709859912594155, 23.286582934980586, 22.92109530915816, 22.812158601979405, 22.760234686235577, 22.658934543530137, 21.273268093665436, 21.58013295878966, 21.572958086927727, 21.170349252410233, 21.089592944830656, 20.01216286420822, 20.163576051592827, 20.539679846726358, 19.636376693844795, 27.798868240167693, 27.760479710375265, 27.77983751551558, 29.529106944799423, 29.654948443174362, 30.248738282360137, 31.264061078429222, 31.319681264460087, 31.056796245276928, 24.977392327040434, 24.432165041565895, 24.985226035118103, 16.542980348070458, 17.148390052219227, 17.434133285035685, 19.91653850426276, 20.178743695219353, 19.647640531261757, 20.05491574946791, 19.930811069905758, 19.861249580979347, 22.760417612890393, 23.242646905283124, 23.338244307825022, 19.68033895393212, 19.075447027881935, 19.829626125593975, 22.289672086636216, 22.940523887674004, 23.128797898689896, 17.635391439000756, 17.754515233139188, 17.68743273864189, 21.63247196244386, 21.50121785824497, 21.444593799610928, 22.718730757633836, 22.75594614694515, 22.926339435080678, 17.621796975533158, 17.851936702306062, 17.101108978192002, 22.94884028720358, 22.63675948480764, 22.92637914294997, 28.492600806057453, 28.572926027700305, 28.497563637793064, 20.338421313712985, 20.36724852739522, 20.038696544865758, 21.43958019961913, 21.390896168847874, 21.12448952098687, 39.34087589383125, 39.885235438123345, 39.603249467909336, 30.523057321707398, 30.622342641154916, 31.055154653886945, 23.018756007154778, 23.52314932396014, 23.465055675556258, 24.441242278708756, 24.094966056446225, 23.993849272529275, 25.727392107248306, 26.694265238940716, 26.447571337223053, 20.514674832423523, 20.67238790293534, 20.45305510361989, 34.494700143734605, 34.45824188242355, 34.70789629096785, 26.80906614723304, 26.600294368962437, 26.892910059231014, 16.655357636511326, 17.128469984047115, 16.83008500188589, 20.460336954643324, 20.570953768988446, 20.250119996567562, 22.193362077077225, 22.57979486820598, 22.465975785007075, 25.995858325312525, 25.759795452157647, 26.04512772957483, 22.94191717604795, 23.05313355724016, 23.147197677443415, 27.153888514575854, 26.750089225669697, 26.868764345844582, 21.0834257180492, 21.085121079037577, 20.962963743756205, 12.165137186646461, 12.28025545552373, 11.19683238863945, 22.538682791093976, 22.380921403566987, 22.887697173903376, 24.53674275117615, 24.549744070197136, 24.388575764993817, 32.67622624834378, 32.892964317773774, 32.917945974816874, 22.83074418703714, 22.948385799924523, 22.93544779221216, 20.85772541165352, 21.685430214449298, 21.292021952569485, 29.24242186608413, 28.996324355403573, 29.237343773866684, 25.84582012395063, 26.14372071127096, 26.424732769529015, 23.26501263678074, 22.97927735745907, 23.33382319100201, 25.705786404510334, 25.661976655324295, 25.844338449028626, 23.704573599000767, 24.033321806540087, 23.591791441043213, 30.351179564992577, 30.861129617939383, 30.340824003020913, 32.353482750554875, 31.819691454370812, 32.640207774316266, 34.99578870087862, 35.472018231637776, 34.36830411851406, 29.00630596652627, 28.517339318990707, 28.92371328175068, 24.693553909659386, 25.188802365213633, 25.187195722013712, 23.290176364903644, 23.041183372338608, 23.19330036764343, 34.37698385491967, 34.13967315852642, 33.78493969142437, 34.88466729968786, 34.528722405433655, 34.49698866903782, 21.986369875570134, 21.91554506619771, 21.83017772932847, 34.180599105854824, 33.849470419188336, 33.29429185887177, 25.75378807385762, 25.314878617723778, 25.724945423503712, 27.87465417260924, 27.809649309764296, 27.331654871503503, 6.133257572849587, 7.091080456351236, 6.36387040217717, 28.986733370771006, 28.31715377171834, 29.22768350814779, 30.664025540153176, 30.569708714882523, 30.360738183061272, 18.217047619322926, 18.29396182547012, 18.37750097612539, 23.871481935804084, 23.372317781050995, 23.796718200047806, 15.36117936422427, 15.404756990571812, 14.41482215126355, 37.73540958762169, 37.83860940486193, 37.514996863901615, 24.467867463827133, 24.797996655106544, 24.206635504961014, 27.69909824989736, 27.708098290488124, 27.647149682044983, 22.622983664274216, 22.957994820550084, 22.448219418525696, 24.06780173381169, 24.077808534105614, 24.658429597814873, 23.175777174532413, 22.89071822166443, 22.831961005926132, 19.443078029279903, 18.829872642954186, 19.55267825381209, 23.926445255676896, 23.986059362689645, 24.187050862858683, 21.526027768850327, 21.861921939998865, 21.332112811505795, 23.260001761217907, 23.032968898614243, 23.220918101569012, 19.320141976078347, 19.182498161991433, 19.681071550895766, 24.90072002013524, 24.947180741777018, 24.119376515348748, 24.987741659084946, 25.236928003529698, 25.629841812575847, 20.758812591433525, 20.92469321191311, 21.70407725358382, 22.353381295998886, 21.791397114594773, 22.10668545713027, 22.51189445797354, 22.088290445506573, 22.24755536019802, 22.19346768719454, 21.769928490122155, 22.10679617275794, 28.23518530651927, 28.340611478313804, 27.873502105474472, 17.995301373302937, 18.171102292835712, 18.053013868629932, 26.890669858704, 26.654896626869828, 26.960672084397316, 33.0404035076499, 33.12079780548811, 32.897467881441116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1411846079243658, "mean_inference_ms": 0.6485538928585158, "mean_action_processing_ms": 0.09500367290303197, "mean_env_wait_ms": 0.7959055521426862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1012800, "timesteps_this_iter": 0, "agent_timesteps_total": 3038400, "timers": {"sample_time_ms": 9429.553, "sample_throughput": 509.038, "load_time_ms": 0.2, "load_throughput": 24010327.013, "learn_time_ms": 1203.202, "learn_throughput": 3989.356, "update_time_ms": 1.603}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 0.0005, "total_loss": 6.061809778213501, "policy_loss": -0.0008877032638541227, "vf_loss": 6.229029476642609, "vf_explained_var": 0.023794174194335938, "kl": 0.008540179464343564, "entropy": 16.730579137802124, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1012800, "num_agent_steps_sampled": 3038400, "num_steps_trained": 1012800, "num_agent_steps_trained": 3038400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4306, "training_iteration": 211, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-15-44", "timestamp": 1706148944, "time_this_iter_s": 9.25079870223999, "time_total_s": 1982.04358792305, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C1CC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1982.04358792305, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 9.715384615384615, "ram_util_percent": 48.81538461538461}}
{"episode_reward_max": 118.82936079986393, "episode_reward_min": 19.588208431377993, "episode_reward_mean": 73.16139890055113, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 6.133257572849587}, "policy_reward_max": {"shared_policy": 39.885235438123345}, "policy_reward_mean": {"shared_policy": 24.387132966850373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.33963259216398, 83.33918546605854, 89.43279367033392, 93.64053858816624, 74.39478340372443, 51.12550368532537, 59.74292273074387, 59.846976400353014, 69.34130882599854, 58.58541210740803, 68.35899387300012, 53.07733941078183, 64.57828362029976, 68.40101633965966, 52.57484265603122, 68.51197891496119, 85.56309047155082, 60.74436638597396, 63.954965889453874, 118.82936079986393, 92.20055461674926, 70.00696100667118, 72.53005760768426, 78.86922868341208, 61.64011783897875, 103.66083831712601, 80.30227057542649, 50.61391262244433, 61.28141072019933, 67.23913273029028, 77.800781507045, 69.14224841073153, 80.77274208609013, 63.13151054084298, 35.64222503080964, 67.80730136856434, 73.4750625863671, 98.48713654093443, 68.71457777917382, 63.8351775786723, 87.47608999535439, 78.4142736047506, 69.57811318524182, 77.21210150886326, 71.32968684658407, 91.55313318595287, 96.81338197924195, 104.83611105103046, 86.44735856726766, 75.06955199688673, 69.52466010488568, 102.30159670487046, 103.91037837415934, 65.73209267109631, 101.32436138391493, 76.79361211508511, 83.01595835387704, 19.588208431377993, 86.53157065063714, 91.59447243809697, 54.888510420918436, 71.04051791690289, 45.18075850605963, 113.08901585638523, 73.47249962389469, 83.05434622243047, 68.02919790335, 72.80403986573218, 68.89845640212297, 57.82562892604618, 72.09955548122522, 64.72006252035499, 69.51388876140116, 58.183711688965545, 73.967277277261, 75.85451147519049, 63.38758305693045, 66.25146386772393, 66.84774026367813, 66.07019235007463, 84.44929889030755, 54.21941753476858, 80.50623856997115, 99.05866919457912, 50.38591545075178, 77.0714924149215, 73.1066299341619, 53.92856543883681, 66.12059292942283, 80.1856576912105, 85.30566637217997, 75.8283352255821, 52.24507050216195, 75.99892766028643, 81.91596192866562, 74.30292049795388, 98.71133635565639, 69.00967208296058, 43.26144540682435, 74.76586045802105], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.163576051592827, 20.539679846726358, 19.636376693844795, 27.798868240167693, 27.760479710375265, 27.77983751551558, 29.529106944799423, 29.654948443174362, 30.248738282360137, 31.264061078429222, 31.319681264460087, 31.056796245276928, 24.977392327040434, 24.432165041565895, 24.985226035118103, 16.542980348070458, 17.148390052219227, 17.434133285035685, 19.91653850426276, 20.178743695219353, 19.647640531261757, 20.05491574946791, 19.930811069905758, 19.861249580979347, 22.760417612890393, 23.242646905283124, 23.338244307825022, 19.68033895393212, 19.075447027881935, 19.829626125593975, 22.289672086636216, 22.940523887674004, 23.128797898689896, 17.635391439000756, 17.754515233139188, 17.68743273864189, 21.63247196244386, 21.50121785824497, 21.444593799610928, 22.718730757633836, 22.75594614694515, 22.926339435080678, 17.621796975533158, 17.851936702306062, 17.101108978192002, 22.94884028720358, 22.63675948480764, 22.92637914294997, 28.492600806057453, 28.572926027700305, 28.497563637793064, 20.338421313712985, 20.36724852739522, 20.038696544865758, 21.43958019961913, 21.390896168847874, 21.12448952098687, 39.34087589383125, 39.885235438123345, 39.603249467909336, 30.523057321707398, 30.622342641154916, 31.055154653886945, 23.018756007154778, 23.52314932396014, 23.465055675556258, 24.441242278708756, 24.094966056446225, 23.993849272529275, 25.727392107248306, 26.694265238940716, 26.447571337223053, 20.514674832423523, 20.67238790293534, 20.45305510361989, 34.494700143734605, 34.45824188242355, 34.70789629096785, 26.80906614723304, 26.600294368962437, 26.892910059231014, 16.655357636511326, 17.128469984047115, 16.83008500188589, 20.460336954643324, 20.570953768988446, 20.250119996567562, 22.193362077077225, 22.57979486820598, 22.465975785007075, 25.995858325312525, 25.759795452157647, 26.04512772957483, 22.94191717604795, 23.05313355724016, 23.147197677443415, 27.153888514575854, 26.750089225669697, 26.868764345844582, 21.0834257180492, 21.085121079037577, 20.962963743756205, 12.165137186646461, 12.28025545552373, 11.19683238863945, 22.538682791093976, 22.380921403566987, 22.887697173903376, 24.53674275117615, 24.549744070197136, 24.388575764993817, 32.67622624834378, 32.892964317773774, 32.917945974816874, 22.83074418703714, 22.948385799924523, 22.93544779221216, 20.85772541165352, 21.685430214449298, 21.292021952569485, 29.24242186608413, 28.996324355403573, 29.237343773866684, 25.84582012395063, 26.14372071127096, 26.424732769529015, 23.26501263678074, 22.97927735745907, 23.33382319100201, 25.705786404510334, 25.661976655324295, 25.844338449028626, 23.704573599000767, 24.033321806540087, 23.591791441043213, 30.351179564992577, 30.861129617939383, 30.340824003020913, 32.353482750554875, 31.819691454370812, 32.640207774316266, 34.99578870087862, 35.472018231637776, 34.36830411851406, 29.00630596652627, 28.517339318990707, 28.92371328175068, 24.693553909659386, 25.188802365213633, 25.187195722013712, 23.290176364903644, 23.041183372338608, 23.19330036764343, 34.37698385491967, 34.13967315852642, 33.78493969142437, 34.88466729968786, 34.528722405433655, 34.49698866903782, 21.986369875570134, 21.91554506619771, 21.83017772932847, 34.180599105854824, 33.849470419188336, 33.29429185887177, 25.75378807385762, 25.314878617723778, 25.724945423503712, 27.87465417260924, 27.809649309764296, 27.331654871503503, 6.133257572849587, 7.091080456351236, 6.36387040217717, 28.986733370771006, 28.31715377171834, 29.22768350814779, 30.664025540153176, 30.569708714882523, 30.360738183061272, 18.217047619322926, 18.29396182547012, 18.37750097612539, 23.871481935804084, 23.372317781050995, 23.796718200047806, 15.36117936422427, 15.404756990571812, 14.41482215126355, 37.73540958762169, 37.83860940486193, 37.514996863901615, 24.467867463827133, 24.797996655106544, 24.206635504961014, 27.69909824989736, 27.708098290488124, 27.647149682044983, 22.622983664274216, 22.957994820550084, 22.448219418525696, 24.06780173381169, 24.077808534105614, 24.658429597814873, 23.175777174532413, 22.89071822166443, 22.831961005926132, 19.443078029279903, 18.829872642954186, 19.55267825381209, 23.926445255676896, 23.986059362689645, 24.187050862858683, 21.526027768850327, 21.861921939998865, 21.332112811505795, 23.260001761217907, 23.032968898614243, 23.220918101569012, 19.320141976078347, 19.182498161991433, 19.681071550895766, 24.90072002013524, 24.947180741777018, 24.119376515348748, 24.987741659084946, 25.236928003529698, 25.629841812575847, 20.758812591433525, 20.92469321191311, 21.70407725358382, 22.353381295998886, 21.791397114594773, 22.10668545713027, 22.51189445797354, 22.088290445506573, 22.24755536019802, 22.19346768719454, 21.769928490122155, 22.10679617275794, 28.23518530651927, 28.340611478313804, 27.873502105474472, 17.995301373302937, 18.171102292835712, 18.053013868629932, 26.890669858704, 26.654896626869828, 26.960672084397316, 33.0404035076499, 33.12079780548811, 32.897467881441116, 16.831189766526222, 16.736648753285408, 16.81807693094015, 25.623385063062102, 25.713032171751053, 25.73507518010834, 23.954397052526474, 24.75340836122632, 24.398824520409107, 17.91943732649088, 17.98009004443884, 18.029038067907095, 22.0968150148789, 22.2174699405829, 21.806307973961026, 26.921737798800066, 26.75434286644061, 26.50957702596982, 28.245660093923405, 28.416299996276692, 28.643706281979874, 25.13834627221027, 25.378281640509755, 25.31170731286207, 17.417621480921895, 17.310129980246217, 17.51731904099384, 25.103910356760025, 25.160229668021202, 25.7347876355052, 27.41223559280236, 27.785532367726162, 26.7181939681371, 24.7561850224932, 24.606495705743626, 24.940239769717053, 32.65752711892128, 32.881809301674366, 33.17199993506074, 22.924847061435372, 23.049477356175572, 23.035347665349633, 14.394813980907202, 14.500885270535946, 14.365746155381203, 24.65627422183752, 25.248132933978923, 24.86145330220461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1411801422205462, "mean_inference_ms": 0.6486302163319857, "mean_action_processing_ms": 0.0950140088927936, "mean_env_wait_ms": 0.795927292395676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1017600, "timesteps_this_iter": 0, "agent_timesteps_total": 3052800, "timers": {"sample_time_ms": 9435.584, "sample_throughput": 508.713, "load_time_ms": 0.2, "load_throughput": 24010327.013, "learn_time_ms": 1207.408, "learn_throughput": 3975.457, "update_time_ms": 1.603}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 0.0005, "total_loss": 7.055283606052399, "policy_loss": -0.002667867794257761, "vf_loss": 7.223851799964905, "vf_explained_var": 0.009731732308864594, "kl": 0.006922431756125034, "entropy": 16.668957233428955, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1017600, "num_agent_steps_sampled": 3052800, "num_steps_trained": 1017600, "num_agent_steps_trained": 3052800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4322, "training_iteration": 212, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-15-53", "timestamp": 1706148953, "time_this_iter_s": 9.354170560836792, "time_total_s": 1991.3977584838867, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210633355E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1991.3977584838867, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 10.453846153846152, "ram_util_percent": 48.8}}
{"episode_reward_max": 118.82936079986393, "episode_reward_min": 19.588208431377993, "episode_reward_mean": 73.62790046865412, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 6.133257572849587}, "policy_reward_max": {"shared_policy": 39.885235438123345}, "policy_reward_mean": {"shared_policy": 24.542633489551367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.56309047155082, 60.74436638597396, 63.954965889453874, 118.82936079986393, 92.20055461674926, 70.00696100667118, 72.53005760768426, 78.86922868341208, 61.64011783897875, 103.66083831712601, 80.30227057542649, 50.61391262244433, 61.28141072019933, 67.23913273029028, 77.800781507045, 69.14224841073153, 80.77274208609013, 63.13151054084298, 35.64222503080964, 67.80730136856434, 73.4750625863671, 98.48713654093443, 68.71457777917382, 63.8351775786723, 87.47608999535439, 78.4142736047506, 69.57811318524182, 77.21210150886326, 71.32968684658407, 91.55313318595287, 96.81338197924195, 104.83611105103046, 86.44735856726766, 75.06955199688673, 69.52466010488568, 102.30159670487046, 103.91037837415934, 65.73209267109631, 101.32436138391493, 76.79361211508511, 83.01595835387704, 19.588208431377993, 86.53157065063714, 91.59447243809697, 54.888510420918436, 71.04051791690289, 45.18075850605963, 113.08901585638523, 73.47249962389469, 83.05434622243047, 68.02919790335, 72.80403986573218, 68.89845640212297, 57.82562892604618, 72.09955548122522, 64.72006252035499, 69.51388876140116, 58.183711688965545, 73.967277277261, 75.85451147519049, 63.38758305693045, 66.25146386772393, 66.84774026367813, 66.07019235007463, 84.44929889030755, 54.21941753476858, 80.50623856997115, 99.05866919457912, 50.38591545075178, 77.0714924149215, 73.1066299341619, 53.92856543883681, 66.12059292942283, 80.1856576912105, 85.30566637217997, 75.8283352255821, 52.24507050216195, 75.99892766028643, 81.91596192866562, 74.30292049795388, 98.71133635565639, 69.00967208296058, 43.26144540682435, 74.76586045802105, 82.79387461021541, 88.61116680130361, 67.39547033421694, 73.3740116022527, 63.47315131779759, 73.06623385846612, 62.76357078924775, 70.76602312922475, 55.754554265178726, 90.591745454818, 57.710126936435685, 54.15100978873669, 89.59660162031649, 54.223498564213486, 75.38373915106058, 62.28689087182282], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.492600806057453, 28.572926027700305, 28.497563637793064, 20.338421313712985, 20.36724852739522, 20.038696544865758, 21.43958019961913, 21.390896168847874, 21.12448952098687, 39.34087589383125, 39.885235438123345, 39.603249467909336, 30.523057321707398, 30.622342641154916, 31.055154653886945, 23.018756007154778, 23.52314932396014, 23.465055675556258, 24.441242278708756, 24.094966056446225, 23.993849272529275, 25.727392107248306, 26.694265238940716, 26.447571337223053, 20.514674832423523, 20.67238790293534, 20.45305510361989, 34.494700143734605, 34.45824188242355, 34.70789629096785, 26.80906614723304, 26.600294368962437, 26.892910059231014, 16.655357636511326, 17.128469984047115, 16.83008500188589, 20.460336954643324, 20.570953768988446, 20.250119996567562, 22.193362077077225, 22.57979486820598, 22.465975785007075, 25.995858325312525, 25.759795452157647, 26.04512772957483, 22.94191717604795, 23.05313355724016, 23.147197677443415, 27.153888514575854, 26.750089225669697, 26.868764345844582, 21.0834257180492, 21.085121079037577, 20.962963743756205, 12.165137186646461, 12.28025545552373, 11.19683238863945, 22.538682791093976, 22.380921403566987, 22.887697173903376, 24.53674275117615, 24.549744070197136, 24.388575764993817, 32.67622624834378, 32.892964317773774, 32.917945974816874, 22.83074418703714, 22.948385799924523, 22.93544779221216, 20.85772541165352, 21.685430214449298, 21.292021952569485, 29.24242186608413, 28.996324355403573, 29.237343773866684, 25.84582012395063, 26.14372071127096, 26.424732769529015, 23.26501263678074, 22.97927735745907, 23.33382319100201, 25.705786404510334, 25.661976655324295, 25.844338449028626, 23.704573599000767, 24.033321806540087, 23.591791441043213, 30.351179564992577, 30.861129617939383, 30.340824003020913, 32.353482750554875, 31.819691454370812, 32.640207774316266, 34.99578870087862, 35.472018231637776, 34.36830411851406, 29.00630596652627, 28.517339318990707, 28.92371328175068, 24.693553909659386, 25.188802365213633, 25.187195722013712, 23.290176364903644, 23.041183372338608, 23.19330036764343, 34.37698385491967, 34.13967315852642, 33.78493969142437, 34.88466729968786, 34.528722405433655, 34.49698866903782, 21.986369875570134, 21.91554506619771, 21.83017772932847, 34.180599105854824, 33.849470419188336, 33.29429185887177, 25.75378807385762, 25.314878617723778, 25.724945423503712, 27.87465417260924, 27.809649309764296, 27.331654871503503, 6.133257572849587, 7.091080456351236, 6.36387040217717, 28.986733370771006, 28.31715377171834, 29.22768350814779, 30.664025540153176, 30.569708714882523, 30.360738183061272, 18.217047619322926, 18.29396182547012, 18.37750097612539, 23.871481935804084, 23.372317781050995, 23.796718200047806, 15.36117936422427, 15.404756990571812, 14.41482215126355, 37.73540958762169, 37.83860940486193, 37.514996863901615, 24.467867463827133, 24.797996655106544, 24.206635504961014, 27.69909824989736, 27.708098290488124, 27.647149682044983, 22.622983664274216, 22.957994820550084, 22.448219418525696, 24.06780173381169, 24.077808534105614, 24.658429597814873, 23.175777174532413, 22.89071822166443, 22.831961005926132, 19.443078029279903, 18.829872642954186, 19.55267825381209, 23.926445255676896, 23.986059362689645, 24.187050862858683, 21.526027768850327, 21.861921939998865, 21.332112811505795, 23.260001761217907, 23.032968898614243, 23.220918101569012, 19.320141976078347, 19.182498161991433, 19.681071550895766, 24.90072002013524, 24.947180741777018, 24.119376515348748, 24.987741659084946, 25.236928003529698, 25.629841812575847, 20.758812591433525, 20.92469321191311, 21.70407725358382, 22.353381295998886, 21.791397114594773, 22.10668545713027, 22.51189445797354, 22.088290445506573, 22.24755536019802, 22.19346768719454, 21.769928490122155, 22.10679617275794, 28.23518530651927, 28.340611478313804, 27.873502105474472, 17.995301373302937, 18.171102292835712, 18.053013868629932, 26.890669858704, 26.654896626869828, 26.960672084397316, 33.0404035076499, 33.12079780548811, 32.897467881441116, 16.831189766526222, 16.736648753285408, 16.81807693094015, 25.623385063062102, 25.713032171751053, 25.73507518010834, 23.954397052526474, 24.75340836122632, 24.398824520409107, 17.91943732649088, 17.98009004443884, 18.029038067907095, 22.0968150148789, 22.2174699405829, 21.806307973961026, 26.921737798800066, 26.75434286644061, 26.50957702596982, 28.245660093923405, 28.416299996276692, 28.643706281979874, 25.13834627221027, 25.378281640509755, 25.31170731286207, 17.417621480921895, 17.310129980246217, 17.51731904099384, 25.103910356760025, 25.160229668021202, 25.7347876355052, 27.41223559280236, 27.785532367726162, 26.7181939681371, 24.7561850224932, 24.606495705743626, 24.940239769717053, 32.65752711892128, 32.881809301674366, 33.17199993506074, 22.924847061435372, 23.049477356175572, 23.035347665349633, 14.394813980907202, 14.500885270535946, 14.365746155381203, 24.65627422183752, 25.248132933978923, 24.86145330220461, 27.521229920287922, 27.424174596865967, 27.848470093061522, 29.221894731124237, 29.607095466305807, 29.782176603873566, 22.62189365488787, 22.506325026353196, 22.267251652975872, 24.882258633772523, 24.721004432688147, 23.770748535792023, 21.114089102794722, 21.26258265258123, 21.096479562421635, 24.65819453696409, 23.753332475821168, 24.654706845680863, 20.897434037178755, 21.00194599479437, 20.864190757274628, 23.170958916346223, 23.938565115133912, 23.656499097744614, 19.050770210412637, 18.967153177907065, 17.736630876859024, 30.05251972128947, 30.56609559928377, 29.973130134244755, 19.600257401665047, 18.91403903563817, 19.19583049913247, 17.69569996496041, 18.187776950498417, 18.267532873277858, 29.43688093622525, 30.03112143774827, 30.128599246342972, 18.221407058338315, 18.00795770312348, 17.99413380275169, 25.272109361365438, 25.24552339874208, 24.866106390953064, 21.090652873118714, 21.16625678290923, 20.029981215794876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1411876301411502, "mean_inference_ms": 0.6486951875507271, "mean_action_processing_ms": 0.09500887712843456, "mean_env_wait_ms": 0.7959420842969243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1022400, "timesteps_this_iter": 0, "agent_timesteps_total": 3067200, "timers": {"sample_time_ms": 9434.561, "sample_throughput": 508.768, "load_time_ms": 0.307, "load_throughput": 15640661.28, "learn_time_ms": 1203.2, "learn_throughput": 3989.36, "update_time_ms": 1.603}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 0.0005, "total_loss": 6.412512838840485, "policy_loss": -0.0018693347778189207, "vf_loss": 6.582371830940247, "vf_explained_var": 0.008636370301246643, "kl": 0.004935342906123109, "entropy": 16.855262994766235, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1022400, "num_agent_steps_sampled": 3067200, "num_steps_trained": 1022400, "num_agent_steps_trained": 3067200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4338, "training_iteration": 213, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-16-03", "timestamp": 1706148963, "time_this_iter_s": 9.407524824142456, "time_total_s": 2000.8052833080292, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015BF670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2000.8052833080292, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 7.069230769230769, "ram_util_percent": 48.8}}
{"episode_reward_max": 113.08901585638523, "episode_reward_min": 19.588208431377993, "episode_reward_mean": 73.87948753611475, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": 6.133257572849587}, "policy_reward_max": {"shared_policy": 37.83860940486193}, "policy_reward_mean": {"shared_policy": 24.62649584537158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.77274208609013, 63.13151054084298, 35.64222503080964, 67.80730136856434, 73.4750625863671, 98.48713654093443, 68.71457777917382, 63.8351775786723, 87.47608999535439, 78.4142736047506, 69.57811318524182, 77.21210150886326, 71.32968684658407, 91.55313318595287, 96.81338197924195, 104.83611105103046, 86.44735856726766, 75.06955199688673, 69.52466010488568, 102.30159670487046, 103.91037837415934, 65.73209267109631, 101.32436138391493, 76.79361211508511, 83.01595835387704, 19.588208431377993, 86.53157065063714, 91.59447243809697, 54.888510420918436, 71.04051791690289, 45.18075850605963, 113.08901585638523, 73.47249962389469, 83.05434622243047, 68.02919790335, 72.80403986573218, 68.89845640212297, 57.82562892604618, 72.09955548122522, 64.72006252035499, 69.51388876140116, 58.183711688965545, 73.967277277261, 75.85451147519049, 63.38758305693045, 66.25146386772393, 66.84774026367813, 66.07019235007463, 84.44929889030755, 54.21941753476858, 80.50623856997115, 99.05866919457912, 50.38591545075178, 77.0714924149215, 73.1066299341619, 53.92856543883681, 66.12059292942283, 80.1856576912105, 85.30566637217997, 75.8283352255821, 52.24507050216195, 75.99892766028643, 81.91596192866562, 74.30292049795388, 98.71133635565639, 69.00967208296058, 43.26144540682435, 74.76586045802105, 82.79387461021541, 88.61116680130361, 67.39547033421694, 73.3740116022527, 63.47315131779759, 73.06623385846612, 62.76357078924775, 70.76602312922475, 55.754554265178726, 90.591745454818, 57.710126936435685, 54.15100978873669, 89.59660162031649, 54.223498564213486, 75.38373915106058, 62.28689087182282, 79.01516540348527, 105.98162829922512, 103.88713139295578, 77.5378480553627, 69.47613368183373, 100.24763543903825, 87.26806152611968, 97.03389095701277, 72.73371532186863, 63.50630263984203, 45.71270964294669, 45.091422278434024, 58.27930419240147, 86.17707614041863, 81.13081146031615, 66.45916849840431], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.153888514575854, 26.750089225669697, 26.868764345844582, 21.0834257180492, 21.085121079037577, 20.962963743756205, 12.165137186646461, 12.28025545552373, 11.19683238863945, 22.538682791093976, 22.380921403566987, 22.887697173903376, 24.53674275117615, 24.549744070197136, 24.388575764993817, 32.67622624834378, 32.892964317773774, 32.917945974816874, 22.83074418703714, 22.948385799924523, 22.93544779221216, 20.85772541165352, 21.685430214449298, 21.292021952569485, 29.24242186608413, 28.996324355403573, 29.237343773866684, 25.84582012395063, 26.14372071127096, 26.424732769529015, 23.26501263678074, 22.97927735745907, 23.33382319100201, 25.705786404510334, 25.661976655324295, 25.844338449028626, 23.704573599000767, 24.033321806540087, 23.591791441043213, 30.351179564992577, 30.861129617939383, 30.340824003020913, 32.353482750554875, 31.819691454370812, 32.640207774316266, 34.99578870087862, 35.472018231637776, 34.36830411851406, 29.00630596652627, 28.517339318990707, 28.92371328175068, 24.693553909659386, 25.188802365213633, 25.187195722013712, 23.290176364903644, 23.041183372338608, 23.19330036764343, 34.37698385491967, 34.13967315852642, 33.78493969142437, 34.88466729968786, 34.528722405433655, 34.49698866903782, 21.986369875570134, 21.91554506619771, 21.83017772932847, 34.180599105854824, 33.849470419188336, 33.29429185887177, 25.75378807385762, 25.314878617723778, 25.724945423503712, 27.87465417260924, 27.809649309764296, 27.331654871503503, 6.133257572849587, 7.091080456351236, 6.36387040217717, 28.986733370771006, 28.31715377171834, 29.22768350814779, 30.664025540153176, 30.569708714882523, 30.360738183061272, 18.217047619322926, 18.29396182547012, 18.37750097612539, 23.871481935804084, 23.372317781050995, 23.796718200047806, 15.36117936422427, 15.404756990571812, 14.41482215126355, 37.73540958762169, 37.83860940486193, 37.514996863901615, 24.467867463827133, 24.797996655106544, 24.206635504961014, 27.69909824989736, 27.708098290488124, 27.647149682044983, 22.622983664274216, 22.957994820550084, 22.448219418525696, 24.06780173381169, 24.077808534105614, 24.658429597814873, 23.175777174532413, 22.89071822166443, 22.831961005926132, 19.443078029279903, 18.829872642954186, 19.55267825381209, 23.926445255676896, 23.986059362689645, 24.187050862858683, 21.526027768850327, 21.861921939998865, 21.332112811505795, 23.260001761217907, 23.032968898614243, 23.220918101569012, 19.320141976078347, 19.182498161991433, 19.681071550895766, 24.90072002013524, 24.947180741777018, 24.119376515348748, 24.987741659084946, 25.236928003529698, 25.629841812575847, 20.758812591433525, 20.92469321191311, 21.70407725358382, 22.353381295998886, 21.791397114594773, 22.10668545713027, 22.51189445797354, 22.088290445506573, 22.24755536019802, 22.19346768719454, 21.769928490122155, 22.10679617275794, 28.23518530651927, 28.340611478313804, 27.873502105474472, 17.995301373302937, 18.171102292835712, 18.053013868629932, 26.890669858704, 26.654896626869828, 26.960672084397316, 33.0404035076499, 33.12079780548811, 32.897467881441116, 16.831189766526222, 16.736648753285408, 16.81807693094015, 25.623385063062102, 25.713032171751053, 25.73507518010834, 23.954397052526474, 24.75340836122632, 24.398824520409107, 17.91943732649088, 17.98009004443884, 18.029038067907095, 22.0968150148789, 22.2174699405829, 21.806307973961026, 26.921737798800066, 26.75434286644061, 26.50957702596982, 28.245660093923405, 28.416299996276692, 28.643706281979874, 25.13834627221027, 25.378281640509755, 25.31170731286207, 17.417621480921895, 17.310129980246217, 17.51731904099384, 25.103910356760025, 25.160229668021202, 25.7347876355052, 27.41223559280236, 27.785532367726162, 26.7181939681371, 24.7561850224932, 24.606495705743626, 24.940239769717053, 32.65752711892128, 32.881809301674366, 33.17199993506074, 22.924847061435372, 23.049477356175572, 23.035347665349633, 14.394813980907202, 14.500885270535946, 14.365746155381203, 24.65627422183752, 25.248132933978923, 24.86145330220461, 27.521229920287922, 27.424174596865967, 27.848470093061522, 29.221894731124237, 29.607095466305807, 29.782176603873566, 22.62189365488787, 22.506325026353196, 22.267251652975872, 24.882258633772523, 24.721004432688147, 23.770748535792023, 21.114089102794722, 21.26258265258123, 21.096479562421635, 24.65819453696409, 23.753332475821168, 24.654706845680863, 20.897434037178755, 21.00194599479437, 20.864190757274628, 23.170958916346223, 23.938565115133912, 23.656499097744614, 19.050770210412637, 18.967153177907065, 17.736630876859024, 30.05251972128947, 30.56609559928377, 29.973130134244755, 19.600257401665047, 18.91403903563817, 19.19583049913247, 17.69569996496041, 18.187776950498417, 18.267532873277858, 29.43688093622525, 30.03112143774827, 30.128599246342972, 18.221407058338315, 18.00795770312348, 17.99413380275169, 25.272109361365438, 25.24552339874208, 24.866106390953064, 21.090652873118714, 21.16625678290923, 20.029981215794876, 26.338636534909398, 26.123500684897095, 26.553028183678776, 35.15020453929901, 35.486601785290986, 35.344821974635124, 34.426548317074776, 34.790478967130184, 34.67010410875082, 25.875229761004448, 25.895269960165024, 25.76734833419323, 23.205774576713637, 23.124908824761704, 23.14545028035839, 33.52087103078762, 33.48993227134147, 33.23683213690916, 29.083952928582818, 29.40214818964401, 28.781960407892853, 32.3840042874217, 32.01950344443321, 32.63038322515786, 24.50249787295857, 24.037525484959275, 24.193691963950783, 20.825106412172318, 21.288563556969166, 21.39263267070055, 15.345053682724625, 14.998024376730115, 15.369631583491952, 14.711124320824936, 15.241663494457796, 15.138634463151291, 19.19443730264902, 19.71304448787123, 19.371822401881218, 29.10143364903827, 28.556489085157708, 28.519153406222657, 26.85150223473707, 27.082928741971642, 27.19638048360744, 22.37217649662246, 22.21915091698368, 21.867841084798172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14119567714676287, "mean_inference_ms": 0.6487400579396417, "mean_action_processing_ms": 0.09499808514575245, "mean_env_wait_ms": 0.7959324707988098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1027200, "timesteps_this_iter": 0, "agent_timesteps_total": 3081600, "timers": {"sample_time_ms": 9426.832, "sample_throughput": 509.185, "load_time_ms": 0.407, "load_throughput": 11798323.488, "learn_time_ms": 1202.901, "learn_throughput": 3990.354, "update_time_ms": 1.603}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05701743364334107, "cur_lr": 0.0005, "total_loss": 7.634992778301239, "policy_loss": -0.0022893641628454198, "vf_loss": 7.804413259029388, "vf_explained_var": 0.010503493249416351, "kl": 0.006305275310610377, "entropy": 16.749024152755737, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1027200, "num_agent_steps_sampled": 3081600, "num_steps_trained": 1027200, "num_agent_steps_trained": 3081600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4354, "training_iteration": 214, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-16-12", "timestamp": 1706148972, "time_this_iter_s": 9.199395179748535, "time_total_s": 2010.0046784877777, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D3B310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2010.0046784877777, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 7.707692307692308, "ram_util_percent": 48.76923076923077}}
{"episode_reward_max": 113.08901585638523, "episode_reward_min": -295.9555219486356, "episode_reward_mean": 70.72207184146275, "episode_len_mean": 297.64, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -105.09542800486088}, "policy_reward_max": {"shared_policy": 37.83860940486193}, "policy_reward_mean": {"shared_policy": 23.57402394715424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.44735856726766, 75.06955199688673, 69.52466010488568, 102.30159670487046, 103.91037837415934, 65.73209267109631, 101.32436138391493, 76.79361211508511, 83.01595835387704, 19.588208431377993, 86.53157065063714, 91.59447243809697, 54.888510420918436, 71.04051791690289, 45.18075850605963, 113.08901585638523, 73.47249962389469, 83.05434622243047, 68.02919790335, 72.80403986573218, 68.89845640212297, 57.82562892604618, 72.09955548122522, 64.72006252035499, 69.51388876140116, 58.183711688965545, 73.967277277261, 75.85451147519049, 63.38758305693045, 66.25146386772393, 66.84774026367813, 66.07019235007463, 84.44929889030755, 54.21941753476858, 80.50623856997115, 99.05866919457912, 50.38591545075178, 77.0714924149215, 73.1066299341619, 53.92856543883681, 66.12059292942283, 80.1856576912105, 85.30566637217997, 75.8283352255821, 52.24507050216195, 75.99892766028643, 81.91596192866562, 74.30292049795388, 98.71133635565639, 69.00967208296058, 43.26144540682435, 74.76586045802105, 82.79387461021541, 88.61116680130361, 67.39547033421694, 73.3740116022527, 63.47315131779759, 73.06623385846612, 62.76357078924775, 70.76602312922475, 55.754554265178726, 90.591745454818, 57.710126936435685, 54.15100978873669, 89.59660162031649, 54.223498564213486, 75.38373915106058, 62.28689087182282, 79.01516540348527, 105.98162829922512, 103.88713139295578, 77.5378480553627, 69.47613368183373, 100.24763543903825, 87.26806152611968, 97.03389095701277, 72.73371532186863, 63.50630263984203, 45.71270964294669, 45.091422278434024, 58.27930419240147, 86.17707614041863, 81.13081146031615, 66.45916849840431, 100.82916878163812, 90.87694288790226, 61.43192329257727, 67.98675261065362, 101.70072107762095, 55.539051512256236, 74.5508422926068, 105.6238195337355, 91.3837169893086, 73.6267314366996, 109.22235327400266, 80.68987949937582, 64.1633323729038, 70.8441318646073, -295.9555219486356, 60.82320992602034], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300], "policy_shared_policy_reward": [29.00630596652627, 28.517339318990707, 28.92371328175068, 24.693553909659386, 25.188802365213633, 25.187195722013712, 23.290176364903644, 23.041183372338608, 23.19330036764343, 34.37698385491967, 34.13967315852642, 33.78493969142437, 34.88466729968786, 34.528722405433655, 34.49698866903782, 21.986369875570134, 21.91554506619771, 21.83017772932847, 34.180599105854824, 33.849470419188336, 33.29429185887177, 25.75378807385762, 25.314878617723778, 25.724945423503712, 27.87465417260924, 27.809649309764296, 27.331654871503503, 6.133257572849587, 7.091080456351236, 6.36387040217717, 28.986733370771006, 28.31715377171834, 29.22768350814779, 30.664025540153176, 30.569708714882523, 30.360738183061272, 18.217047619322926, 18.29396182547012, 18.37750097612539, 23.871481935804084, 23.372317781050995, 23.796718200047806, 15.36117936422427, 15.404756990571812, 14.41482215126355, 37.73540958762169, 37.83860940486193, 37.514996863901615, 24.467867463827133, 24.797996655106544, 24.206635504961014, 27.69909824989736, 27.708098290488124, 27.647149682044983, 22.622983664274216, 22.957994820550084, 22.448219418525696, 24.06780173381169, 24.077808534105614, 24.658429597814873, 23.175777174532413, 22.89071822166443, 22.831961005926132, 19.443078029279903, 18.829872642954186, 19.55267825381209, 23.926445255676896, 23.986059362689645, 24.187050862858683, 21.526027768850327, 21.861921939998865, 21.332112811505795, 23.260001761217907, 23.032968898614243, 23.220918101569012, 19.320141976078347, 19.182498161991433, 19.681071550895766, 24.90072002013524, 24.947180741777018, 24.119376515348748, 24.987741659084946, 25.236928003529698, 25.629841812575847, 20.758812591433525, 20.92469321191311, 21.70407725358382, 22.353381295998886, 21.791397114594773, 22.10668545713027, 22.51189445797354, 22.088290445506573, 22.24755536019802, 22.19346768719454, 21.769928490122155, 22.10679617275794, 28.23518530651927, 28.340611478313804, 27.873502105474472, 17.995301373302937, 18.171102292835712, 18.053013868629932, 26.890669858704, 26.654896626869828, 26.960672084397316, 33.0404035076499, 33.12079780548811, 32.897467881441116, 16.831189766526222, 16.736648753285408, 16.81807693094015, 25.623385063062102, 25.713032171751053, 25.73507518010834, 23.954397052526474, 24.75340836122632, 24.398824520409107, 17.91943732649088, 17.98009004443884, 18.029038067907095, 22.0968150148789, 22.2174699405829, 21.806307973961026, 26.921737798800066, 26.75434286644061, 26.50957702596982, 28.245660093923405, 28.416299996276692, 28.643706281979874, 25.13834627221027, 25.378281640509755, 25.31170731286207, 17.417621480921895, 17.310129980246217, 17.51731904099384, 25.103910356760025, 25.160229668021202, 25.7347876355052, 27.41223559280236, 27.785532367726162, 26.7181939681371, 24.7561850224932, 24.606495705743626, 24.940239769717053, 32.65752711892128, 32.881809301674366, 33.17199993506074, 22.924847061435372, 23.049477356175572, 23.035347665349633, 14.394813980907202, 14.500885270535946, 14.365746155381203, 24.65627422183752, 25.248132933978923, 24.86145330220461, 27.521229920287922, 27.424174596865967, 27.848470093061522, 29.221894731124237, 29.607095466305807, 29.782176603873566, 22.62189365488787, 22.506325026353196, 22.267251652975872, 24.882258633772523, 24.721004432688147, 23.770748535792023, 21.114089102794722, 21.26258265258123, 21.096479562421635, 24.65819453696409, 23.753332475821168, 24.654706845680863, 20.897434037178755, 21.00194599479437, 20.864190757274628, 23.170958916346223, 23.938565115133912, 23.656499097744614, 19.050770210412637, 18.967153177907065, 17.736630876859024, 30.05251972128947, 30.56609559928377, 29.973130134244755, 19.600257401665047, 18.91403903563817, 19.19583049913247, 17.69569996496041, 18.187776950498417, 18.267532873277858, 29.43688093622525, 30.03112143774827, 30.128599246342972, 18.221407058338315, 18.00795770312348, 17.99413380275169, 25.272109361365438, 25.24552339874208, 24.866106390953064, 21.090652873118714, 21.16625678290923, 20.029981215794876, 26.338636534909398, 26.123500684897095, 26.553028183678776, 35.15020453929901, 35.486601785290986, 35.344821974635124, 34.426548317074776, 34.790478967130184, 34.67010410875082, 25.875229761004448, 25.895269960165024, 25.76734833419323, 23.205774576713637, 23.124908824761704, 23.14545028035839, 33.52087103078762, 33.48993227134147, 33.23683213690916, 29.083952928582818, 29.40214818964401, 28.781960407892853, 32.3840042874217, 32.01950344443321, 32.63038322515786, 24.50249787295857, 24.037525484959275, 24.193691963950783, 20.825106412172318, 21.288563556969166, 21.39263267070055, 15.345053682724625, 14.998024376730115, 15.369631583491952, 14.711124320824936, 15.241663494457796, 15.138634463151291, 19.19443730264902, 19.71304448787123, 19.371822401881218, 29.10143364903827, 28.556489085157708, 28.519153406222657, 26.85150223473707, 27.082928741971642, 27.19638048360744, 22.37217649662246, 22.21915091698368, 21.867841084798172, 33.77827127153674, 33.64824370170632, 33.40265380839506, 30.224015220999718, 30.42316283285618, 30.229764834046364, 20.571708768606186, 20.679745353758335, 20.180469170212746, 22.679612567027405, 22.65804376949866, 22.649096274127558, 33.640663410226495, 33.97115395466486, 34.0889037127296, 18.501522107670695, 18.54202187123397, 18.49550753335157, 24.93631716320911, 24.762927288810403, 24.85159784058729, 35.51096128424008, 34.618484919269875, 35.49437333022554, 30.27529914677143, 30.631710037589073, 30.47670780494809, 24.42861672739187, 24.455834108094365, 24.742280601213366, 36.25715919335683, 36.19948179026444, 36.76571229038139, 27.03781934827566, 26.702126249670982, 26.949933901429176, 21.395239772895962, 21.14920327315727, 21.618889326850564, 23.74989891673127, 23.445999215046555, 23.648233732829482, -94.83158241957426, -96.02851152420044, -105.09542800486088, 20.52106129083161, 20.253733446200684, 20.048415188988045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14120495302690222, "mean_inference_ms": 0.6488025430529278, "mean_action_processing_ms": 0.09499017812801196, "mean_env_wait_ms": 0.7959436867049041, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1032000, "timesteps_this_iter": 0, "agent_timesteps_total": 3096000, "timers": {"sample_time_ms": 9487.421, "sample_throughput": 505.933, "load_time_ms": 0.407, "load_throughput": 11798323.488, "learn_time_ms": 1210.001, "learn_throughput": 3966.938, "update_time_ms": 1.603}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05701743364334107, "cur_lr": 0.0005, "total_loss": 81.08520317077637, "policy_loss": -0.0026215230639920484, "vf_loss": 81.25411605834961, "vf_explained_var": -0.002980530261993408, "kl": 0.008696171891959613, "entropy": 16.678738594055176, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1032000, "num_agent_steps_sampled": 3096000, "num_steps_trained": 1032000, "num_agent_steps_trained": 3096000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4370, "training_iteration": 215, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-16-22", "timestamp": 1706148982, "time_this_iter_s": 9.936710119247437, "time_total_s": 2019.9413886070251, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210015CE670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2019.9413886070251, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 8.657142857142857, "ram_util_percent": 48.97857142857142}}
{"episode_reward_max": 109.22235327400266, "episode_reward_min": -295.9555219486356, "episode_reward_mean": 69.45838959104731, "episode_len_mean": 297.64, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -105.09542800486088}, "policy_reward_max": {"shared_policy": 36.76571229038139}, "policy_reward_mean": {"shared_policy": 23.152796530349097}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.47249962389469, 83.05434622243047, 68.02919790335, 72.80403986573218, 68.89845640212297, 57.82562892604618, 72.09955548122522, 64.72006252035499, 69.51388876140116, 58.183711688965545, 73.967277277261, 75.85451147519049, 63.38758305693045, 66.25146386772393, 66.84774026367813, 66.07019235007463, 84.44929889030755, 54.21941753476858, 80.50623856997115, 99.05866919457912, 50.38591545075178, 77.0714924149215, 73.1066299341619, 53.92856543883681, 66.12059292942283, 80.1856576912105, 85.30566637217997, 75.8283352255821, 52.24507050216195, 75.99892766028643, 81.91596192866562, 74.30292049795388, 98.71133635565639, 69.00967208296058, 43.26144540682435, 74.76586045802105, 82.79387461021541, 88.61116680130361, 67.39547033421694, 73.3740116022527, 63.47315131779759, 73.06623385846612, 62.76357078924775, 70.76602312922475, 55.754554265178726, 90.591745454818, 57.710126936435685, 54.15100978873669, 89.59660162031649, 54.223498564213486, 75.38373915106058, 62.28689087182282, 79.01516540348527, 105.98162829922512, 103.88713139295578, 77.5378480553627, 69.47613368183373, 100.24763543903825, 87.26806152611968, 97.03389095701277, 72.73371532186863, 63.50630263984203, 45.71270964294669, 45.091422278434024, 58.27930419240147, 86.17707614041863, 81.13081146031615, 66.45916849840431, 100.82916878163812, 90.87694288790226, 61.43192329257727, 67.98675261065362, 101.70072107762095, 55.539051512256236, 74.5508422926068, 105.6238195337355, 91.3837169893086, 73.6267314366996, 109.22235327400266, 80.68987949937582, 64.1633323729038, 70.8441318646073, -295.9555219486356, 60.82320992602034, 89.25762529671192, 69.06062688957897, 72.37987117469308, 67.16615107655522, 77.35493876039979, 79.93767546489835, 89.67482695565559, 57.32146025821564, 54.920602425932884, 47.12311763316393, 86.09443638101219, 62.38232937082648, 72.9342426434159, 58.8573271576315, 63.007710136473165, 72.19145782571283], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.467867463827133, 24.797996655106544, 24.206635504961014, 27.69909824989736, 27.708098290488124, 27.647149682044983, 22.622983664274216, 22.957994820550084, 22.448219418525696, 24.06780173381169, 24.077808534105614, 24.658429597814873, 23.175777174532413, 22.89071822166443, 22.831961005926132, 19.443078029279903, 18.829872642954186, 19.55267825381209, 23.926445255676896, 23.986059362689645, 24.187050862858683, 21.526027768850327, 21.861921939998865, 21.332112811505795, 23.260001761217907, 23.032968898614243, 23.220918101569012, 19.320141976078347, 19.182498161991433, 19.681071550895766, 24.90072002013524, 24.947180741777018, 24.119376515348748, 24.987741659084946, 25.236928003529698, 25.629841812575847, 20.758812591433525, 20.92469321191311, 21.70407725358382, 22.353381295998886, 21.791397114594773, 22.10668545713027, 22.51189445797354, 22.088290445506573, 22.24755536019802, 22.19346768719454, 21.769928490122155, 22.10679617275794, 28.23518530651927, 28.340611478313804, 27.873502105474472, 17.995301373302937, 18.171102292835712, 18.053013868629932, 26.890669858704, 26.654896626869828, 26.960672084397316, 33.0404035076499, 33.12079780548811, 32.897467881441116, 16.831189766526222, 16.736648753285408, 16.81807693094015, 25.623385063062102, 25.713032171751053, 25.73507518010834, 23.954397052526474, 24.75340836122632, 24.398824520409107, 17.91943732649088, 17.98009004443884, 18.029038067907095, 22.0968150148789, 22.2174699405829, 21.806307973961026, 26.921737798800066, 26.75434286644061, 26.50957702596982, 28.245660093923405, 28.416299996276692, 28.643706281979874, 25.13834627221027, 25.378281640509755, 25.31170731286207, 17.417621480921895, 17.310129980246217, 17.51731904099384, 25.103910356760025, 25.160229668021202, 25.7347876355052, 27.41223559280236, 27.785532367726162, 26.7181939681371, 24.7561850224932, 24.606495705743626, 24.940239769717053, 32.65752711892128, 32.881809301674366, 33.17199993506074, 22.924847061435372, 23.049477356175572, 23.035347665349633, 14.394813980907202, 14.500885270535946, 14.365746155381203, 24.65627422183752, 25.248132933978923, 24.86145330220461, 27.521229920287922, 27.424174596865967, 27.848470093061522, 29.221894731124237, 29.607095466305807, 29.782176603873566, 22.62189365488787, 22.506325026353196, 22.267251652975872, 24.882258633772523, 24.721004432688147, 23.770748535792023, 21.114089102794722, 21.26258265258123, 21.096479562421635, 24.65819453696409, 23.753332475821168, 24.654706845680863, 20.897434037178755, 21.00194599479437, 20.864190757274628, 23.170958916346223, 23.938565115133912, 23.656499097744614, 19.050770210412637, 18.967153177907065, 17.736630876859024, 30.05251972128947, 30.56609559928377, 29.973130134244755, 19.600257401665047, 18.91403903563817, 19.19583049913247, 17.69569996496041, 18.187776950498417, 18.267532873277858, 29.43688093622525, 30.03112143774827, 30.128599246342972, 18.221407058338315, 18.00795770312348, 17.99413380275169, 25.272109361365438, 25.24552339874208, 24.866106390953064, 21.090652873118714, 21.16625678290923, 20.029981215794876, 26.338636534909398, 26.123500684897095, 26.553028183678776, 35.15020453929901, 35.486601785290986, 35.344821974635124, 34.426548317074776, 34.790478967130184, 34.67010410875082, 25.875229761004448, 25.895269960165024, 25.76734833419323, 23.205774576713637, 23.124908824761704, 23.14545028035839, 33.52087103078762, 33.48993227134147, 33.23683213690916, 29.083952928582818, 29.40214818964401, 28.781960407892853, 32.3840042874217, 32.01950344443321, 32.63038322515786, 24.50249787295857, 24.037525484959275, 24.193691963950783, 20.825106412172318, 21.288563556969166, 21.39263267070055, 15.345053682724625, 14.998024376730115, 15.369631583491952, 14.711124320824936, 15.241663494457796, 15.138634463151291, 19.19443730264902, 19.71304448787123, 19.371822401881218, 29.10143364903827, 28.556489085157708, 28.519153406222657, 26.85150223473707, 27.082928741971642, 27.19638048360744, 22.37217649662246, 22.21915091698368, 21.867841084798172, 33.77827127153674, 33.64824370170632, 33.40265380839506, 30.224015220999718, 30.42316283285618, 30.229764834046364, 20.571708768606186, 20.679745353758335, 20.180469170212746, 22.679612567027405, 22.65804376949866, 22.649096274127558, 33.640663410226495, 33.97115395466486, 34.0889037127296, 18.501522107670695, 18.54202187123397, 18.49550753335157, 24.93631716320911, 24.762927288810403, 24.85159784058729, 35.51096128424008, 34.618484919269875, 35.49437333022554, 30.27529914677143, 30.631710037589073, 30.47670780494809, 24.42861672739187, 24.455834108094365, 24.742280601213366, 36.25715919335683, 36.19948179026444, 36.76571229038139, 27.03781934827566, 26.702126249670982, 26.949933901429176, 21.395239772895962, 21.14920327315727, 21.618889326850564, 23.74989891673127, 23.445999215046555, 23.648233732829482, -94.83158241957426, -96.02851152420044, -105.09542800486088, 20.52106129083161, 20.253733446200684, 20.048415188988045, 29.794868513941765, 29.682109974324703, 29.780646808445454, 22.97235535706082, 23.129057751658053, 22.959213780860097, 23.575487489501626, 24.500814060370118, 24.303569624821336, 22.35525485376516, 22.467117461065442, 22.34377876172462, 25.448333496848733, 25.959439712266118, 25.94716555128494, 26.360222473740578, 26.677070446312428, 26.900382544845343, 29.970833517843857, 29.816413551568985, 29.887579886242747, 19.145524269590766, 19.155400349448115, 19.020535639176757, 17.839666947722435, 18.41102071851492, 18.66991475969553, 16.247589848935604, 15.10299026966095, 15.772537514567375, 28.857664275293544, 28.913642238204673, 28.32312986751397, 20.9645260758698, 20.758968822658062, 20.658834472298622, 24.38284997145334, 24.139205778638512, 24.412186893324048, 19.696086411674813, 19.833986050759748, 19.32725469519694, 20.99886181702216, 21.26956186195214, 20.739286457498864, 23.784347812334687, 24.201075805040688, 24.206034208337456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14122086342012743, "mean_inference_ms": 0.6488932395270404, "mean_action_processing_ms": 0.09498951728009604, "mean_env_wait_ms": 0.795957422074045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1036800, "timesteps_this_iter": 0, "agent_timesteps_total": 3110400, "timers": {"sample_time_ms": 9490.552, "sample_throughput": 505.766, "load_time_ms": 0.507, "load_throughput": 9470627.152, "learn_time_ms": 1212.307, "learn_throughput": 3959.394, "update_time_ms": 1.503}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05701743364334107, "cur_lr": 0.0005, "total_loss": 7.1135329604148865, "policy_loss": -0.001455809892993598, "vf_loss": 7.281624376773834, "vf_explained_var": 0.009876824915409088, "kl": 0.0047912773228289875, "entropy": 16.69084930419922, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1036800, "num_agent_steps_sampled": 3110400, "num_steps_trained": 1036800, "num_agent_steps_trained": 3110400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4386, "training_iteration": 216, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-16-32", "timestamp": 1706148992, "time_this_iter_s": 9.60776400566101, "time_total_s": 2029.5491526126862, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002D3BE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2029.5491526126862, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 7.778571428571429, "ram_util_percent": 49.13571428571429}}
{"episode_reward_max": 109.22235327400266, "episode_reward_min": -295.9555219486356, "episode_reward_mean": 70.57371837120387, "episode_len_mean": 297.64, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -105.09542800486088}, "policy_reward_max": {"shared_policy": 36.76571229038139}, "policy_reward_mean": {"shared_policy": 23.524572790401283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.44929889030755, 54.21941753476858, 80.50623856997115, 99.05866919457912, 50.38591545075178, 77.0714924149215, 73.1066299341619, 53.92856543883681, 66.12059292942283, 80.1856576912105, 85.30566637217997, 75.8283352255821, 52.24507050216195, 75.99892766028643, 81.91596192866562, 74.30292049795388, 98.71133635565639, 69.00967208296058, 43.26144540682435, 74.76586045802105, 82.79387461021541, 88.61116680130361, 67.39547033421694, 73.3740116022527, 63.47315131779759, 73.06623385846612, 62.76357078924775, 70.76602312922475, 55.754554265178726, 90.591745454818, 57.710126936435685, 54.15100978873669, 89.59660162031649, 54.223498564213486, 75.38373915106058, 62.28689087182282, 79.01516540348527, 105.98162829922512, 103.88713139295578, 77.5378480553627, 69.47613368183373, 100.24763543903825, 87.26806152611968, 97.03389095701277, 72.73371532186863, 63.50630263984203, 45.71270964294669, 45.091422278434024, 58.27930419240147, 86.17707614041863, 81.13081146031615, 66.45916849840431, 100.82916878163812, 90.87694288790226, 61.43192329257727, 67.98675261065362, 101.70072107762095, 55.539051512256236, 74.5508422926068, 105.6238195337355, 91.3837169893086, 73.6267314366996, 109.22235327400266, 80.68987949937582, 64.1633323729038, 70.8441318646073, -295.9555219486356, 60.82320992602034, 89.25762529671192, 69.06062688957897, 72.37987117469308, 67.16615107655522, 77.35493876039979, 79.93767546489835, 89.67482695565559, 57.32146025821564, 54.920602425932884, 47.12311763316393, 86.09443638101219, 62.38232937082648, 72.9342426434159, 58.8573271576315, 63.007710136473165, 72.19145782571283, 92.42279738001524, 72.51421772688627, 75.1173531413078, 82.31707660108802, 75.63314440101384, 95.00867883116004, 84.47015841584653, 72.85929759591816, 104.12922061979769, 63.63404982164499, 72.27759313210844, 41.97216031514105, 87.89224806986748, 71.58548669144508, 54.66752528399226, 66.01202567480505], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.23518530651927, 28.340611478313804, 27.873502105474472, 17.995301373302937, 18.171102292835712, 18.053013868629932, 26.890669858704, 26.654896626869828, 26.960672084397316, 33.0404035076499, 33.12079780548811, 32.897467881441116, 16.831189766526222, 16.736648753285408, 16.81807693094015, 25.623385063062102, 25.713032171751053, 25.73507518010834, 23.954397052526474, 24.75340836122632, 24.398824520409107, 17.91943732649088, 17.98009004443884, 18.029038067907095, 22.0968150148789, 22.2174699405829, 21.806307973961026, 26.921737798800066, 26.75434286644061, 26.50957702596982, 28.245660093923405, 28.416299996276692, 28.643706281979874, 25.13834627221027, 25.378281640509755, 25.31170731286207, 17.417621480921895, 17.310129980246217, 17.51731904099384, 25.103910356760025, 25.160229668021202, 25.7347876355052, 27.41223559280236, 27.785532367726162, 26.7181939681371, 24.7561850224932, 24.606495705743626, 24.940239769717053, 32.65752711892128, 32.881809301674366, 33.17199993506074, 22.924847061435372, 23.049477356175572, 23.035347665349633, 14.394813980907202, 14.500885270535946, 14.365746155381203, 24.65627422183752, 25.248132933978923, 24.86145330220461, 27.521229920287922, 27.424174596865967, 27.848470093061522, 29.221894731124237, 29.607095466305807, 29.782176603873566, 22.62189365488787, 22.506325026353196, 22.267251652975872, 24.882258633772523, 24.721004432688147, 23.770748535792023, 21.114089102794722, 21.26258265258123, 21.096479562421635, 24.65819453696409, 23.753332475821168, 24.654706845680863, 20.897434037178755, 21.00194599479437, 20.864190757274628, 23.170958916346223, 23.938565115133912, 23.656499097744614, 19.050770210412637, 18.967153177907065, 17.736630876859024, 30.05251972128947, 30.56609559928377, 29.973130134244755, 19.600257401665047, 18.91403903563817, 19.19583049913247, 17.69569996496041, 18.187776950498417, 18.267532873277858, 29.43688093622525, 30.03112143774827, 30.128599246342972, 18.221407058338315, 18.00795770312348, 17.99413380275169, 25.272109361365438, 25.24552339874208, 24.866106390953064, 21.090652873118714, 21.16625678290923, 20.029981215794876, 26.338636534909398, 26.123500684897095, 26.553028183678776, 35.15020453929901, 35.486601785290986, 35.344821974635124, 34.426548317074776, 34.790478967130184, 34.67010410875082, 25.875229761004448, 25.895269960165024, 25.76734833419323, 23.205774576713637, 23.124908824761704, 23.14545028035839, 33.52087103078762, 33.48993227134147, 33.23683213690916, 29.083952928582818, 29.40214818964401, 28.781960407892853, 32.3840042874217, 32.01950344443321, 32.63038322515786, 24.50249787295857, 24.037525484959275, 24.193691963950783, 20.825106412172318, 21.288563556969166, 21.39263267070055, 15.345053682724625, 14.998024376730115, 15.369631583491952, 14.711124320824936, 15.241663494457796, 15.138634463151291, 19.19443730264902, 19.71304448787123, 19.371822401881218, 29.10143364903827, 28.556489085157708, 28.519153406222657, 26.85150223473707, 27.082928741971642, 27.19638048360744, 22.37217649662246, 22.21915091698368, 21.867841084798172, 33.77827127153674, 33.64824370170632, 33.40265380839506, 30.224015220999718, 30.42316283285618, 30.229764834046364, 20.571708768606186, 20.679745353758335, 20.180469170212746, 22.679612567027405, 22.65804376949866, 22.649096274127558, 33.640663410226495, 33.97115395466486, 34.0889037127296, 18.501522107670695, 18.54202187123397, 18.49550753335157, 24.93631716320911, 24.762927288810403, 24.85159784058729, 35.51096128424008, 34.618484919269875, 35.49437333022554, 30.27529914677143, 30.631710037589073, 30.47670780494809, 24.42861672739187, 24.455834108094365, 24.742280601213366, 36.25715919335683, 36.19948179026444, 36.76571229038139, 27.03781934827566, 26.702126249670982, 26.949933901429176, 21.395239772895962, 21.14920327315727, 21.618889326850564, 23.74989891673127, 23.445999215046555, 23.648233732829482, -94.83158241957426, -96.02851152420044, -105.09542800486088, 20.52106129083161, 20.253733446200684, 20.048415188988045, 29.794868513941765, 29.682109974324703, 29.780646808445454, 22.97235535706082, 23.129057751658053, 22.959213780860097, 23.575487489501626, 24.500814060370118, 24.303569624821336, 22.35525485376516, 22.467117461065442, 22.34377876172462, 25.448333496848733, 25.959439712266118, 25.94716555128494, 26.360222473740578, 26.677070446312428, 26.900382544845343, 29.970833517843857, 29.816413551568985, 29.887579886242747, 19.145524269590766, 19.155400349448115, 19.020535639176757, 17.839666947722435, 18.41102071851492, 18.66991475969553, 16.247589848935604, 15.10299026966095, 15.772537514567375, 28.857664275293544, 28.913642238204673, 28.32312986751397, 20.9645260758698, 20.758968822658062, 20.658834472298622, 24.38284997145334, 24.139205778638512, 24.412186893324048, 19.696086411674813, 19.833986050759748, 19.32725469519694, 20.99886181702216, 21.26956186195214, 20.739286457498864, 23.784347812334687, 24.201075805040688, 24.206034208337456, 30.65780221422513, 30.785977364828184, 30.979017800961927, 24.303508676588535, 24.04828318953514, 24.162425860762596, 24.775460603336484, 25.221314969162137, 25.120577568809182, 27.215594778458268, 27.491649928192288, 27.609831894437463, 25.3675819200774, 25.063024592896298, 25.20253788804014, 31.615667971471936, 31.769675495723874, 31.62333536396423, 28.6534333107993, 27.799332842230797, 28.01739226281643, 24.49341871341069, 24.009166811903313, 24.35671207060416, 34.8224185531338, 34.512526517113045, 34.79427554955085, 21.069522867600114, 21.434733434269816, 21.129793519775063, 24.115757570912436, 24.03420815368493, 24.12762740751107, 13.719325842956692, 14.162474763269216, 14.090359708915145, 29.373472062249974, 28.921065618594483, 29.59771038902302, 24.09769098336497, 23.887489336232335, 23.60030637184778, 18.35300752023855, 18.042481700579316, 18.272036063174397, 22.11606639251113, 22.248079458251595, 21.64787982404232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14125055213691112, "mean_inference_ms": 0.649039790954768, "mean_action_processing_ms": 0.09499776649016703, "mean_env_wait_ms": 0.7959949919227576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1041600, "timesteps_this_iter": 0, "agent_timesteps_total": 3124800, "timers": {"sample_time_ms": 9539.286, "sample_throughput": 503.182, "load_time_ms": 0.507, "load_throughput": 9470627.152, "learn_time_ms": 1208.407, "learn_throughput": 3972.171, "update_time_ms": 1.504}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028508716821670534, "cur_lr": 0.0005, "total_loss": 5.8883917927742, "policy_loss": -0.0022364375265575553, "vf_loss": 6.058502495288849, "vf_explained_var": 0.01756414771080017, "kl": 0.007653629625887069, "entropy": 16.80923581123352, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1041600, "num_agent_steps_sampled": 3124800, "num_steps_trained": 1041600, "num_agent_steps_trained": 3124800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4402, "training_iteration": 217, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-16-42", "timestamp": 1706149002, "time_this_iter_s": 9.94025206565857, "time_total_s": 2039.4894046783447, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C211F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2039.4894046783447, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 9.22857142857143, "ram_util_percent": 49.107142857142854}}
{"episode_reward_max": 109.22235327400266, "episode_reward_min": -295.9555219486356, "episode_reward_mean": 70.29895426095347, "episode_len_mean": 297.64, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -105.09542800486088}, "policy_reward_max": {"shared_policy": 36.76571229038139}, "policy_reward_mean": {"shared_policy": 23.43298475365115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.71133635565639, 69.00967208296058, 43.26144540682435, 74.76586045802105, 82.79387461021541, 88.61116680130361, 67.39547033421694, 73.3740116022527, 63.47315131779759, 73.06623385846612, 62.76357078924775, 70.76602312922475, 55.754554265178726, 90.591745454818, 57.710126936435685, 54.15100978873669, 89.59660162031649, 54.223498564213486, 75.38373915106058, 62.28689087182282, 79.01516540348527, 105.98162829922512, 103.88713139295578, 77.5378480553627, 69.47613368183373, 100.24763543903825, 87.26806152611968, 97.03389095701277, 72.73371532186863, 63.50630263984203, 45.71270964294669, 45.091422278434024, 58.27930419240147, 86.17707614041863, 81.13081146031615, 66.45916849840431, 100.82916878163812, 90.87694288790226, 61.43192329257727, 67.98675261065362, 101.70072107762095, 55.539051512256236, 74.5508422926068, 105.6238195337355, 91.3837169893086, 73.6267314366996, 109.22235327400266, 80.68987949937582, 64.1633323729038, 70.8441318646073, -295.9555219486356, 60.82320992602034, 89.25762529671192, 69.06062688957897, 72.37987117469308, 67.16615107655522, 77.35493876039979, 79.93767546489835, 89.67482695565559, 57.32146025821564, 54.920602425932884, 47.12311763316393, 86.09443638101219, 62.38232937082648, 72.9342426434159, 58.8573271576315, 63.007710136473165, 72.19145782571283, 92.42279738001524, 72.51421772688627, 75.1173531413078, 82.31707660108802, 75.63314440101384, 95.00867883116004, 84.47015841584653, 72.85929759591816, 104.12922061979769, 63.63404982164499, 72.27759313210844, 41.97216031514105, 87.89224806986748, 71.58548669144508, 54.66752528399226, 66.01202567480505, 52.13005223125219, 54.89669946581125, 77.73941565304993, 94.92957599833605, 90.10350899677724, 90.86696564918384, 50.728472247719765, 46.66503928229211, 66.39963957807046, 98.65299106761813, 50.49148042127487, 59.300343755632625, 62.61992760235442, 80.00158910080789, 77.97989094257352, 83.64735721796748], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [32.65752711892128, 32.881809301674366, 33.17199993506074, 22.924847061435372, 23.049477356175572, 23.035347665349633, 14.394813980907202, 14.500885270535946, 14.365746155381203, 24.65627422183752, 25.248132933978923, 24.86145330220461, 27.521229920287922, 27.424174596865967, 27.848470093061522, 29.221894731124237, 29.607095466305807, 29.782176603873566, 22.62189365488787, 22.506325026353196, 22.267251652975872, 24.882258633772523, 24.721004432688147, 23.770748535792023, 21.114089102794722, 21.26258265258123, 21.096479562421635, 24.65819453696409, 23.753332475821168, 24.654706845680863, 20.897434037178755, 21.00194599479437, 20.864190757274628, 23.170958916346223, 23.938565115133912, 23.656499097744614, 19.050770210412637, 18.967153177907065, 17.736630876859024, 30.05251972128947, 30.56609559928377, 29.973130134244755, 19.600257401665047, 18.91403903563817, 19.19583049913247, 17.69569996496041, 18.187776950498417, 18.267532873277858, 29.43688093622525, 30.03112143774827, 30.128599246342972, 18.221407058338315, 18.00795770312348, 17.99413380275169, 25.272109361365438, 25.24552339874208, 24.866106390953064, 21.090652873118714, 21.16625678290923, 20.029981215794876, 26.338636534909398, 26.123500684897095, 26.553028183678776, 35.15020453929901, 35.486601785290986, 35.344821974635124, 34.426548317074776, 34.790478967130184, 34.67010410875082, 25.875229761004448, 25.895269960165024, 25.76734833419323, 23.205774576713637, 23.124908824761704, 23.14545028035839, 33.52087103078762, 33.48993227134147, 33.23683213690916, 29.083952928582818, 29.40214818964401, 28.781960407892853, 32.3840042874217, 32.01950344443321, 32.63038322515786, 24.50249787295857, 24.037525484959275, 24.193691963950783, 20.825106412172318, 21.288563556969166, 21.39263267070055, 15.345053682724625, 14.998024376730115, 15.369631583491952, 14.711124320824936, 15.241663494457796, 15.138634463151291, 19.19443730264902, 19.71304448787123, 19.371822401881218, 29.10143364903827, 28.556489085157708, 28.519153406222657, 26.85150223473707, 27.082928741971642, 27.19638048360744, 22.37217649662246, 22.21915091698368, 21.867841084798172, 33.77827127153674, 33.64824370170632, 33.40265380839506, 30.224015220999718, 30.42316283285618, 30.229764834046364, 20.571708768606186, 20.679745353758335, 20.180469170212746, 22.679612567027405, 22.65804376949866, 22.649096274127558, 33.640663410226495, 33.97115395466486, 34.0889037127296, 18.501522107670695, 18.54202187123397, 18.49550753335157, 24.93631716320911, 24.762927288810403, 24.85159784058729, 35.51096128424008, 34.618484919269875, 35.49437333022554, 30.27529914677143, 30.631710037589073, 30.47670780494809, 24.42861672739187, 24.455834108094365, 24.742280601213366, 36.25715919335683, 36.19948179026444, 36.76571229038139, 27.03781934827566, 26.702126249670982, 26.949933901429176, 21.395239772895962, 21.14920327315727, 21.618889326850564, 23.74989891673127, 23.445999215046555, 23.648233732829482, -94.83158241957426, -96.02851152420044, -105.09542800486088, 20.52106129083161, 20.253733446200684, 20.048415188988045, 29.794868513941765, 29.682109974324703, 29.780646808445454, 22.97235535706082, 23.129057751658053, 22.959213780860097, 23.575487489501626, 24.500814060370118, 24.303569624821336, 22.35525485376516, 22.467117461065442, 22.34377876172462, 25.448333496848733, 25.959439712266118, 25.94716555128494, 26.360222473740578, 26.677070446312428, 26.900382544845343, 29.970833517843857, 29.816413551568985, 29.887579886242747, 19.145524269590766, 19.155400349448115, 19.020535639176757, 17.839666947722435, 18.41102071851492, 18.66991475969553, 16.247589848935604, 15.10299026966095, 15.772537514567375, 28.857664275293544, 28.913642238204673, 28.32312986751397, 20.9645260758698, 20.758968822658062, 20.658834472298622, 24.38284997145334, 24.139205778638512, 24.412186893324048, 19.696086411674813, 19.833986050759748, 19.32725469519694, 20.99886181702216, 21.26956186195214, 20.739286457498864, 23.784347812334687, 24.201075805040688, 24.206034208337456, 30.65780221422513, 30.785977364828184, 30.979017800961927, 24.303508676588535, 24.04828318953514, 24.162425860762596, 24.775460603336484, 25.221314969162137, 25.120577568809182, 27.215594778458268, 27.491649928192288, 27.609831894437463, 25.3675819200774, 25.063024592896298, 25.20253788804014, 31.615667971471936, 31.769675495723874, 31.62333536396423, 28.6534333107993, 27.799332842230797, 28.01739226281643, 24.49341871341069, 24.009166811903313, 24.35671207060416, 34.8224185531338, 34.512526517113045, 34.79427554955085, 21.069522867600114, 21.434733434269816, 21.129793519775063, 24.115757570912436, 24.03420815368493, 24.12762740751107, 13.719325842956692, 14.162474763269216, 14.090359708915145, 29.373472062249974, 28.921065618594483, 29.59771038902302, 24.09769098336497, 23.887489336232335, 23.60030637184778, 18.35300752023855, 18.042481700579316, 18.272036063174397, 22.11606639251113, 22.248079458251595, 21.64787982404232, 17.262811191380024, 17.451256207190454, 17.415984832681715, 18.43639112263918, 18.33825971186161, 18.122048631310463, 25.689704467852906, 26.16301504274209, 25.886696142454937, 31.780786621073872, 31.69266944254437, 31.456119934717805, 29.961598802357912, 30.050235640257597, 30.091674554161727, 30.181976053863764, 30.30315987765789, 30.381829717662185, 17.09740199148655, 17.079288512468338, 16.551781743764877, 16.043993593504027, 15.479647522171334, 15.141398166616753, 22.28670751086125, 22.297209129823983, 21.81572293738523, 32.77226185798645, 32.951330956071615, 32.929398253560066, 16.876692077765853, 16.90959099183479, 16.70519735167423, 19.537022327383355, 20.073218466093138, 19.690102962156132, 20.757532355686024, 20.517338340481118, 21.34505690618728, 26.793953889360026, 26.663985607524708, 26.543649603923157, 26.13701758782068, 25.93309474984804, 25.9097786049048, 28.02119446049133, 27.941307509938866, 27.684855247537286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14127823290489328, "mean_inference_ms": 0.6491802955988619, "mean_action_processing_ms": 0.09500121819863082, "mean_env_wait_ms": 0.7960271336079856, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1046400, "timesteps_this_iter": 0, "agent_timesteps_total": 3139200, "timers": {"sample_time_ms": 9501.809, "sample_throughput": 505.167, "load_time_ms": 0.507, "load_throughput": 9470627.152, "learn_time_ms": 1204.358, "learn_throughput": 3985.525, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028508716821670534, "cur_lr": 0.0005, "total_loss": 6.783967971801758, "policy_loss": -0.0007740321169289466, "vf_loss": 6.953794717788696, "vf_explained_var": 0.008572742342948914, "kl": 0.007402262359712747, "entropy": 16.926361799240112, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1046400, "num_agent_steps_sampled": 3139200, "num_steps_trained": 1046400, "num_agent_steps_trained": 3139200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4418, "training_iteration": 218, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-16-51", "timestamp": 1706149011, "time_this_iter_s": 9.176392078399658, "time_total_s": 2048.6657967567444, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210634715E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2048.6657967567444, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 6.892307692307693, "ram_util_percent": 48.76153846153846}}
{"episode_reward_max": 118.81652052968272, "episode_reward_min": -295.9555219486356, "episode_reward_mean": 71.98282114434348, "episode_len_mean": 297.64, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -105.09542800486088}, "policy_reward_max": {"shared_policy": 39.95463262269428}, "policy_reward_mean": {"shared_policy": 23.99427371478115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.59660162031649, 54.223498564213486, 75.38373915106058, 62.28689087182282, 79.01516540348527, 105.98162829922512, 103.88713139295578, 77.5378480553627, 69.47613368183373, 100.24763543903825, 87.26806152611968, 97.03389095701277, 72.73371532186863, 63.50630263984203, 45.71270964294669, 45.091422278434024, 58.27930419240147, 86.17707614041863, 81.13081146031615, 66.45916849840431, 100.82916878163812, 90.87694288790226, 61.43192329257727, 67.98675261065362, 101.70072107762095, 55.539051512256236, 74.5508422926068, 105.6238195337355, 91.3837169893086, 73.6267314366996, 109.22235327400266, 80.68987949937582, 64.1633323729038, 70.8441318646073, -295.9555219486356, 60.82320992602034, 89.25762529671192, 69.06062688957897, 72.37987117469308, 67.16615107655522, 77.35493876039979, 79.93767546489835, 89.67482695565559, 57.32146025821564, 54.920602425932884, 47.12311763316393, 86.09443638101219, 62.38232937082648, 72.9342426434159, 58.8573271576315, 63.007710136473165, 72.19145782571283, 92.42279738001524, 72.51421772688627, 75.1173531413078, 82.31707660108802, 75.63314440101384, 95.00867883116004, 84.47015841584653, 72.85929759591816, 104.12922061979769, 63.63404982164499, 72.27759313210844, 41.97216031514105, 87.89224806986748, 71.58548669144508, 54.66752528399226, 66.01202567480505, 52.13005223125219, 54.89669946581125, 77.73941565304993, 94.92957599833605, 90.10350899677724, 90.86696564918384, 50.728472247719765, 46.66503928229211, 66.39963957807046, 98.65299106761813, 50.49148042127487, 59.300343755632625, 62.61992760235442, 80.00158910080789, 77.97989094257352, 83.64735721796748, 108.11867300793527, 93.01904576364903, 62.36904035881159, 69.53506487887353, 86.10346675850448, 48.14412700664249, 89.25377148389816, 118.81652052968272, 98.94322508852927, 82.0665932111442, 74.94064163696021, 56.463900675706086, 53.30717933550477, 101.34648413211104, 90.92261829227206, 61.23558937013148], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [29.43688093622525, 30.03112143774827, 30.128599246342972, 18.221407058338315, 18.00795770312348, 17.99413380275169, 25.272109361365438, 25.24552339874208, 24.866106390953064, 21.090652873118714, 21.16625678290923, 20.029981215794876, 26.338636534909398, 26.123500684897095, 26.553028183678776, 35.15020453929901, 35.486601785290986, 35.344821974635124, 34.426548317074776, 34.790478967130184, 34.67010410875082, 25.875229761004448, 25.895269960165024, 25.76734833419323, 23.205774576713637, 23.124908824761704, 23.14545028035839, 33.52087103078762, 33.48993227134147, 33.23683213690916, 29.083952928582818, 29.40214818964401, 28.781960407892853, 32.3840042874217, 32.01950344443321, 32.63038322515786, 24.50249787295857, 24.037525484959275, 24.193691963950783, 20.825106412172318, 21.288563556969166, 21.39263267070055, 15.345053682724625, 14.998024376730115, 15.369631583491952, 14.711124320824936, 15.241663494457796, 15.138634463151291, 19.19443730264902, 19.71304448787123, 19.371822401881218, 29.10143364903827, 28.556489085157708, 28.519153406222657, 26.85150223473707, 27.082928741971642, 27.19638048360744, 22.37217649662246, 22.21915091698368, 21.867841084798172, 33.77827127153674, 33.64824370170632, 33.40265380839506, 30.224015220999718, 30.42316283285618, 30.229764834046364, 20.571708768606186, 20.679745353758335, 20.180469170212746, 22.679612567027405, 22.65804376949866, 22.649096274127558, 33.640663410226495, 33.97115395466486, 34.0889037127296, 18.501522107670695, 18.54202187123397, 18.49550753335157, 24.93631716320911, 24.762927288810403, 24.85159784058729, 35.51096128424008, 34.618484919269875, 35.49437333022554, 30.27529914677143, 30.631710037589073, 30.47670780494809, 24.42861672739187, 24.455834108094365, 24.742280601213366, 36.25715919335683, 36.19948179026444, 36.76571229038139, 27.03781934827566, 26.702126249670982, 26.949933901429176, 21.395239772895962, 21.14920327315727, 21.618889326850564, 23.74989891673127, 23.445999215046555, 23.648233732829482, -94.83158241957426, -96.02851152420044, -105.09542800486088, 20.52106129083161, 20.253733446200684, 20.048415188988045, 29.794868513941765, 29.682109974324703, 29.780646808445454, 22.97235535706082, 23.129057751658053, 22.959213780860097, 23.575487489501626, 24.500814060370118, 24.303569624821336, 22.35525485376516, 22.467117461065442, 22.34377876172462, 25.448333496848733, 25.959439712266118, 25.94716555128494, 26.360222473740578, 26.677070446312428, 26.900382544845343, 29.970833517843857, 29.816413551568985, 29.887579886242747, 19.145524269590766, 19.155400349448115, 19.020535639176757, 17.839666947722435, 18.41102071851492, 18.66991475969553, 16.247589848935604, 15.10299026966095, 15.772537514567375, 28.857664275293544, 28.913642238204673, 28.32312986751397, 20.9645260758698, 20.758968822658062, 20.658834472298622, 24.38284997145334, 24.139205778638512, 24.412186893324048, 19.696086411674813, 19.833986050759748, 19.32725469519694, 20.99886181702216, 21.26956186195214, 20.739286457498864, 23.784347812334687, 24.201075805040688, 24.206034208337456, 30.65780221422513, 30.785977364828184, 30.979017800961927, 24.303508676588535, 24.04828318953514, 24.162425860762596, 24.775460603336484, 25.221314969162137, 25.120577568809182, 27.215594778458268, 27.491649928192288, 27.609831894437463, 25.3675819200774, 25.063024592896298, 25.20253788804014, 31.615667971471936, 31.769675495723874, 31.62333536396423, 28.6534333107993, 27.799332842230797, 28.01739226281643, 24.49341871341069, 24.009166811903313, 24.35671207060416, 34.8224185531338, 34.512526517113045, 34.79427554955085, 21.069522867600114, 21.434733434269816, 21.129793519775063, 24.115757570912436, 24.03420815368493, 24.12762740751107, 13.719325842956692, 14.162474763269216, 14.090359708915145, 29.373472062249974, 28.921065618594483, 29.59771038902302, 24.09769098336497, 23.887489336232335, 23.60030637184778, 18.35300752023855, 18.042481700579316, 18.272036063174397, 22.11606639251113, 22.248079458251595, 21.64787982404232, 17.262811191380024, 17.451256207190454, 17.415984832681715, 18.43639112263918, 18.33825971186161, 18.122048631310463, 25.689704467852906, 26.16301504274209, 25.886696142454937, 31.780786621073872, 31.69266944254437, 31.456119934717805, 29.961598802357912, 30.050235640257597, 30.091674554161727, 30.181976053863764, 30.30315987765789, 30.381829717662185, 17.09740199148655, 17.079288512468338, 16.551781743764877, 16.043993593504027, 15.479647522171334, 15.141398166616753, 22.28670751086125, 22.297209129823983, 21.81572293738523, 32.77226185798645, 32.951330956071615, 32.929398253560066, 16.876692077765853, 16.90959099183479, 16.70519735167423, 19.537022327383355, 20.073218466093138, 19.690102962156132, 20.757532355686024, 20.517338340481118, 21.34505690618728, 26.793953889360026, 26.663985607524708, 26.543649603923157, 26.13701758782068, 25.93309474984804, 25.9097786049048, 28.02119446049133, 27.941307509938866, 27.684855247537286, 35.680691098173455, 36.25744561788936, 36.18053629187246, 30.784588319559887, 31.13024500974764, 31.104212434341505, 20.99956817800799, 20.872992704311997, 20.4964794764916, 23.329558186233044, 23.483685101382434, 22.72182159125805, 28.559649686018616, 28.83581692042449, 28.708000152061373, 16.35960534742722, 15.859370986620576, 15.925150672594697, 29.579774349927902, 29.8938020914793, 29.78019504249096, 39.95463262269428, 39.307447413603455, 39.55444049338499, 32.90890971322854, 32.97849548173447, 33.055819893566266, 27.08077112336953, 27.714652643849448, 27.271169443925217, 25.349762859754264, 24.76524466276169, 24.825634114444256, 18.742420074840382, 19.193090411853817, 18.528390189011887, 17.646659523248672, 17.718663275241852, 17.941856537014246, 34.16532103220621, 33.65913078437248, 33.52203231553236, 29.994406367341668, 30.28096419076124, 30.647247734169156, 20.3568545927604, 20.460430850585297, 20.418303926785782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14128907490481166, "mean_inference_ms": 0.6492935554093044, "mean_action_processing_ms": 0.09501188290137648, "mean_env_wait_ms": 0.7960503336377827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1051200, "timesteps_this_iter": 0, "agent_timesteps_total": 3153600, "timers": {"sample_time_ms": 9444.041, "sample_throughput": 508.257, "load_time_ms": 0.407, "load_throughput": 11795558.472, "learn_time_ms": 1201.158, "learn_throughput": 3996.143, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028508716821670534, "cur_lr": 0.0005, "total_loss": 7.950157403945923, "policy_loss": -0.0005190702157011895, "vf_loss": 8.119673371315002, "vf_explained_var": 0.00841955840587616, "kl": 0.010492776404465078, "entropy": 16.929600954055786, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1051200, "num_agent_steps_sampled": 3153600, "num_steps_trained": 1051200, "num_agent_steps_trained": 3153600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4434, "training_iteration": 219, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-17-00", "timestamp": 1706149020, "time_this_iter_s": 9.066009283065796, "time_total_s": 2057.73180603981, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021002C11820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2057.73180603981, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 10.815384615384618, "ram_util_percent": 48.70769230769231}}
{"episode_reward_max": 118.81652052968272, "episode_reward_min": -295.9555219486356, "episode_reward_mean": 71.6045088166889, "episode_len_mean": 297.64, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -105.09542800486088}, "policy_reward_max": {"shared_policy": 39.95463262269428}, "policy_reward_mean": {"shared_policy": 23.86816960556296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.27930419240147, 86.17707614041863, 81.13081146031615, 66.45916849840431, 100.82916878163812, 90.87694288790226, 61.43192329257727, 67.98675261065362, 101.70072107762095, 55.539051512256236, 74.5508422926068, 105.6238195337355, 91.3837169893086, 73.6267314366996, 109.22235327400266, 80.68987949937582, 64.1633323729038, 70.8441318646073, -295.9555219486356, 60.82320992602034, 89.25762529671192, 69.06062688957897, 72.37987117469308, 67.16615107655522, 77.35493876039979, 79.93767546489835, 89.67482695565559, 57.32146025821564, 54.920602425932884, 47.12311763316393, 86.09443638101219, 62.38232937082648, 72.9342426434159, 58.8573271576315, 63.007710136473165, 72.19145782571283, 92.42279738001524, 72.51421772688627, 75.1173531413078, 82.31707660108802, 75.63314440101384, 95.00867883116004, 84.47015841584653, 72.85929759591816, 104.12922061979769, 63.63404982164499, 72.27759313210844, 41.97216031514105, 87.89224806986748, 71.58548669144508, 54.66752528399226, 66.01202567480505, 52.13005223125219, 54.89669946581125, 77.73941565304993, 94.92957599833605, 90.10350899677724, 90.86696564918384, 50.728472247719765, 46.66503928229211, 66.39963957807046, 98.65299106761813, 50.49148042127487, 59.300343755632625, 62.61992760235442, 80.00158910080789, 77.97989094257352, 83.64735721796748, 108.11867300793527, 93.01904576364903, 62.36904035881159, 69.53506487887353, 86.10346675850448, 48.14412700664249, 89.25377148389816, 118.81652052968272, 98.94322508852927, 82.0665932111442, 74.94064163696021, 56.463900675706086, 53.30717933550477, 101.34648413211104, 90.92261829227206, 61.23558937013148, 80.04658462665972, 39.520743068307624, 79.72672171145676, 88.93503940477967, 94.1205514781177, 59.80257017910478, 98.52444762736559, 55.60834452509877, 65.86235795915124, 81.59266712516545, 47.52577450126408, 68.85125421779229, 66.66375914961097, 72.97089507989583, 102.18676733993922, 89.21266408637165], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.19443730264902, 19.71304448787123, 19.371822401881218, 29.10143364903827, 28.556489085157708, 28.519153406222657, 26.85150223473707, 27.082928741971642, 27.19638048360744, 22.37217649662246, 22.21915091698368, 21.867841084798172, 33.77827127153674, 33.64824370170632, 33.40265380839506, 30.224015220999718, 30.42316283285618, 30.229764834046364, 20.571708768606186, 20.679745353758335, 20.180469170212746, 22.679612567027405, 22.65804376949866, 22.649096274127558, 33.640663410226495, 33.97115395466486, 34.0889037127296, 18.501522107670695, 18.54202187123397, 18.49550753335157, 24.93631716320911, 24.762927288810403, 24.85159784058729, 35.51096128424008, 34.618484919269875, 35.49437333022554, 30.27529914677143, 30.631710037589073, 30.47670780494809, 24.42861672739187, 24.455834108094365, 24.742280601213366, 36.25715919335683, 36.19948179026444, 36.76571229038139, 27.03781934827566, 26.702126249670982, 26.949933901429176, 21.395239772895962, 21.14920327315727, 21.618889326850564, 23.74989891673127, 23.445999215046555, 23.648233732829482, -94.83158241957426, -96.02851152420044, -105.09542800486088, 20.52106129083161, 20.253733446200684, 20.048415188988045, 29.794868513941765, 29.682109974324703, 29.780646808445454, 22.97235535706082, 23.129057751658053, 22.959213780860097, 23.575487489501626, 24.500814060370118, 24.303569624821336, 22.35525485376516, 22.467117461065442, 22.34377876172462, 25.448333496848733, 25.959439712266118, 25.94716555128494, 26.360222473740578, 26.677070446312428, 26.900382544845343, 29.970833517843857, 29.816413551568985, 29.887579886242747, 19.145524269590766, 19.155400349448115, 19.020535639176757, 17.839666947722435, 18.41102071851492, 18.66991475969553, 16.247589848935604, 15.10299026966095, 15.772537514567375, 28.857664275293544, 28.913642238204673, 28.32312986751397, 20.9645260758698, 20.758968822658062, 20.658834472298622, 24.38284997145334, 24.139205778638512, 24.412186893324048, 19.696086411674813, 19.833986050759748, 19.32725469519694, 20.99886181702216, 21.26956186195214, 20.739286457498864, 23.784347812334687, 24.201075805040688, 24.206034208337456, 30.65780221422513, 30.785977364828184, 30.979017800961927, 24.303508676588535, 24.04828318953514, 24.162425860762596, 24.775460603336484, 25.221314969162137, 25.120577568809182, 27.215594778458268, 27.491649928192288, 27.609831894437463, 25.3675819200774, 25.063024592896298, 25.20253788804014, 31.615667971471936, 31.769675495723874, 31.62333536396423, 28.6534333107993, 27.799332842230797, 28.01739226281643, 24.49341871341069, 24.009166811903313, 24.35671207060416, 34.8224185531338, 34.512526517113045, 34.79427554955085, 21.069522867600114, 21.434733434269816, 21.129793519775063, 24.115757570912436, 24.03420815368493, 24.12762740751107, 13.719325842956692, 14.162474763269216, 14.090359708915145, 29.373472062249974, 28.921065618594483, 29.59771038902302, 24.09769098336497, 23.887489336232335, 23.60030637184778, 18.35300752023855, 18.042481700579316, 18.272036063174397, 22.11606639251113, 22.248079458251595, 21.64787982404232, 17.262811191380024, 17.451256207190454, 17.415984832681715, 18.43639112263918, 18.33825971186161, 18.122048631310463, 25.689704467852906, 26.16301504274209, 25.886696142454937, 31.780786621073872, 31.69266944254437, 31.456119934717805, 29.961598802357912, 30.050235640257597, 30.091674554161727, 30.181976053863764, 30.30315987765789, 30.381829717662185, 17.09740199148655, 17.079288512468338, 16.551781743764877, 16.043993593504027, 15.479647522171334, 15.141398166616753, 22.28670751086125, 22.297209129823983, 21.81572293738523, 32.77226185798645, 32.951330956071615, 32.929398253560066, 16.876692077765853, 16.90959099183479, 16.70519735167423, 19.537022327383355, 20.073218466093138, 19.690102962156132, 20.757532355686024, 20.517338340481118, 21.34505690618728, 26.793953889360026, 26.663985607524708, 26.543649603923157, 26.13701758782068, 25.93309474984804, 25.9097786049048, 28.02119446049133, 27.941307509938866, 27.684855247537286, 35.680691098173455, 36.25744561788936, 36.18053629187246, 30.784588319559887, 31.13024500974764, 31.104212434341505, 20.99956817800799, 20.872992704311997, 20.4964794764916, 23.329558186233044, 23.483685101382434, 22.72182159125805, 28.559649686018616, 28.83581692042449, 28.708000152061373, 16.35960534742722, 15.859370986620576, 15.925150672594697, 29.579774349927902, 29.8938020914793, 29.78019504249096, 39.95463262269428, 39.307447413603455, 39.55444049338499, 32.90890971322854, 32.97849548173447, 33.055819893566266, 27.08077112336953, 27.714652643849448, 27.271169443925217, 25.349762859754264, 24.76524466276169, 24.825634114444256, 18.742420074840382, 19.193090411853817, 18.528390189011887, 17.646659523248672, 17.718663275241852, 17.941856537014246, 34.16532103220621, 33.65913078437248, 33.52203231553236, 29.994406367341668, 30.28096419076124, 30.647247734169156, 20.3568545927604, 20.460430850585297, 20.418303926785782, 26.437722677985818, 27.060564160967857, 26.548297787706048, 12.674433802564934, 13.53655670707424, 13.30975255866845, 26.949481663604573, 26.761969735225037, 26.015270312627152, 29.851877750828862, 29.199454724788666, 29.883706929162145, 31.45741980522871, 31.81373031809926, 30.849401354789734, 20.148571687440068, 19.388496498266846, 20.265501993397862, 32.76262325048447, 32.99723298102617, 32.76459139585495, 18.604222430537135, 18.773189565787703, 18.230932528773934, 22.16286257157722, 22.080919596056134, 21.618575791517884, 27.218798418839768, 27.47343948235114, 26.90042922397454, 15.758145799239472, 16.2273068105181, 15.540321891506508, 23.299994643622384, 23.228696710740522, 22.322562863429383, 22.153985793391854, 22.320917988816888, 22.188855367402226, 24.477434382463485, 24.18477979550758, 24.30868090192476, 34.36478007577048, 33.48578473428884, 34.3362025298799, 30.000873332222298, 29.961421483506754, 29.250369270642594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14129357069093917, "mean_inference_ms": 0.6493920472938997, "mean_action_processing_ms": 0.09502754458701211, "mean_env_wait_ms": 0.7960609482254363, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1056000, "timesteps_this_iter": 0, "agent_timesteps_total": 3168000, "timers": {"sample_time_ms": 9425.605, "sample_throughput": 509.251, "load_time_ms": 0.407, "load_throughput": 11795558.472, "learn_time_ms": 1201.957, "learn_throughput": 3993.486, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028508716821670534, "cur_lr": 0.0005, "total_loss": 8.057230591773987, "policy_loss": -0.00015052717397334714, "vf_loss": 8.228766679763794, "vf_explained_var": 0.005071453750133514, "kl": 0.010676180827774573, "entropy": 17.169028997421265, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1056000, "num_agent_steps_sampled": 3168000, "num_steps_trained": 1056000, "num_agent_steps_trained": 3168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4450, "training_iteration": 220, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-17-09", "timestamp": 1706149029, "time_this_iter_s": 9.048644542694092, "time_total_s": 2066.7804505825043, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000021063335790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2066.7804505825043, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 8.946153846153846, "ram_util_percent": 48.75384615384615}}
{"episode_reward_max": 118.81652052968272, "episode_reward_min": -295.9555219486356, "episode_reward_mean": 70.04516295761394, "episode_len_mean": 297.64, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -105.09542800486088}, "policy_reward_max": {"shared_policy": 39.95463262269428}, "policy_reward_mean": {"shared_policy": 23.348387652537973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.1633323729038, 70.8441318646073, -295.9555219486356, 60.82320992602034, 89.25762529671192, 69.06062688957897, 72.37987117469308, 67.16615107655522, 77.35493876039979, 79.93767546489835, 89.67482695565559, 57.32146025821564, 54.920602425932884, 47.12311763316393, 86.09443638101219, 62.38232937082648, 72.9342426434159, 58.8573271576315, 63.007710136473165, 72.19145782571283, 92.42279738001524, 72.51421772688627, 75.1173531413078, 82.31707660108802, 75.63314440101384, 95.00867883116004, 84.47015841584653, 72.85929759591816, 104.12922061979769, 63.63404982164499, 72.27759313210844, 41.97216031514105, 87.89224806986748, 71.58548669144508, 54.66752528399226, 66.01202567480505, 52.13005223125219, 54.89669946581125, 77.73941565304993, 94.92957599833605, 90.10350899677724, 90.86696564918384, 50.728472247719765, 46.66503928229211, 66.39963957807046, 98.65299106761813, 50.49148042127487, 59.300343755632625, 62.61992760235442, 80.00158910080789, 77.97989094257352, 83.64735721796748, 108.11867300793527, 93.01904576364903, 62.36904035881159, 69.53506487887353, 86.10346675850448, 48.14412700664249, 89.25377148389816, 118.81652052968272, 98.94322508852927, 82.0665932111442, 74.94064163696021, 56.463900675706086, 53.30717933550477, 101.34648413211104, 90.92261829227206, 61.23558937013148, 80.04658462665972, 39.520743068307624, 79.72672171145676, 88.93503940477967, 94.1205514781177, 59.80257017910478, 98.52444762736559, 55.60834452509877, 65.86235795915124, 81.59266712516545, 47.52577450126408, 68.85125421779229, 66.66375914961097, 72.97089507989583, 102.18676733993922, 89.21266408637165, 58.27770467475055, 78.05748493410645, 56.62313870340583, 74.25217018090187, 65.23795740306376, 46.02004774380475, 86.7054900974035, 71.19949037581682, 82.14813730120659, 74.63432120531796, 68.79542773030697, 75.7814591899514, 94.75214293971655, 73.43733635544774, 50.20235735923052, 93.44901137799025], "episode_lengths": [300, 300, 64, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.395239772895962, 21.14920327315727, 21.618889326850564, 23.74989891673127, 23.445999215046555, 23.648233732829482, -94.83158241957426, -96.02851152420044, -105.09542800486088, 20.52106129083161, 20.253733446200684, 20.048415188988045, 29.794868513941765, 29.682109974324703, 29.780646808445454, 22.97235535706082, 23.129057751658053, 22.959213780860097, 23.575487489501626, 24.500814060370118, 24.303569624821336, 22.35525485376516, 22.467117461065442, 22.34377876172462, 25.448333496848733, 25.959439712266118, 25.94716555128494, 26.360222473740578, 26.677070446312428, 26.900382544845343, 29.970833517843857, 29.816413551568985, 29.887579886242747, 19.145524269590766, 19.155400349448115, 19.020535639176757, 17.839666947722435, 18.41102071851492, 18.66991475969553, 16.247589848935604, 15.10299026966095, 15.772537514567375, 28.857664275293544, 28.913642238204673, 28.32312986751397, 20.9645260758698, 20.758968822658062, 20.658834472298622, 24.38284997145334, 24.139205778638512, 24.412186893324048, 19.696086411674813, 19.833986050759748, 19.32725469519694, 20.99886181702216, 21.26956186195214, 20.739286457498864, 23.784347812334687, 24.201075805040688, 24.206034208337456, 30.65780221422513, 30.785977364828184, 30.979017800961927, 24.303508676588535, 24.04828318953514, 24.162425860762596, 24.775460603336484, 25.221314969162137, 25.120577568809182, 27.215594778458268, 27.491649928192288, 27.609831894437463, 25.3675819200774, 25.063024592896298, 25.20253788804014, 31.615667971471936, 31.769675495723874, 31.62333536396423, 28.6534333107993, 27.799332842230797, 28.01739226281643, 24.49341871341069, 24.009166811903313, 24.35671207060416, 34.8224185531338, 34.512526517113045, 34.79427554955085, 21.069522867600114, 21.434733434269816, 21.129793519775063, 24.115757570912436, 24.03420815368493, 24.12762740751107, 13.719325842956692, 14.162474763269216, 14.090359708915145, 29.373472062249974, 28.921065618594483, 29.59771038902302, 24.09769098336497, 23.887489336232335, 23.60030637184778, 18.35300752023855, 18.042481700579316, 18.272036063174397, 22.11606639251113, 22.248079458251595, 21.64787982404232, 17.262811191380024, 17.451256207190454, 17.415984832681715, 18.43639112263918, 18.33825971186161, 18.122048631310463, 25.689704467852906, 26.16301504274209, 25.886696142454937, 31.780786621073872, 31.69266944254437, 31.456119934717805, 29.961598802357912, 30.050235640257597, 30.091674554161727, 30.181976053863764, 30.30315987765789, 30.381829717662185, 17.09740199148655, 17.079288512468338, 16.551781743764877, 16.043993593504027, 15.479647522171334, 15.141398166616753, 22.28670751086125, 22.297209129823983, 21.81572293738523, 32.77226185798645, 32.951330956071615, 32.929398253560066, 16.876692077765853, 16.90959099183479, 16.70519735167423, 19.537022327383355, 20.073218466093138, 19.690102962156132, 20.757532355686024, 20.517338340481118, 21.34505690618728, 26.793953889360026, 26.663985607524708, 26.543649603923157, 26.13701758782068, 25.93309474984804, 25.9097786049048, 28.02119446049133, 27.941307509938866, 27.684855247537286, 35.680691098173455, 36.25744561788936, 36.18053629187246, 30.784588319559887, 31.13024500974764, 31.104212434341505, 20.99956817800799, 20.872992704311997, 20.4964794764916, 23.329558186233044, 23.483685101382434, 22.72182159125805, 28.559649686018616, 28.83581692042449, 28.708000152061373, 16.35960534742722, 15.859370986620576, 15.925150672594697, 29.579774349927902, 29.8938020914793, 29.78019504249096, 39.95463262269428, 39.307447413603455, 39.55444049338499, 32.90890971322854, 32.97849548173447, 33.055819893566266, 27.08077112336953, 27.714652643849448, 27.271169443925217, 25.349762859754264, 24.76524466276169, 24.825634114444256, 18.742420074840382, 19.193090411853817, 18.528390189011887, 17.646659523248672, 17.718663275241852, 17.941856537014246, 34.16532103220621, 33.65913078437248, 33.52203231553236, 29.994406367341668, 30.28096419076124, 30.647247734169156, 20.3568545927604, 20.460430850585297, 20.418303926785782, 26.437722677985818, 27.060564160967857, 26.548297787706048, 12.674433802564934, 13.53655670707424, 13.30975255866845, 26.949481663604573, 26.761969735225037, 26.015270312627152, 29.851877750828862, 29.199454724788666, 29.883706929162145, 31.45741980522871, 31.81373031809926, 30.849401354789734, 20.148571687440068, 19.388496498266846, 20.265501993397862, 32.76262325048447, 32.99723298102617, 32.76459139585495, 18.604222430537135, 18.773189565787703, 18.230932528773934, 22.16286257157722, 22.080919596056134, 21.618575791517884, 27.218798418839768, 27.47343948235114, 26.90042922397454, 15.758145799239472, 16.2273068105181, 15.540321891506508, 23.299994643622384, 23.228696710740522, 22.322562863429383, 22.153985793391854, 22.320917988816888, 22.188855367402226, 24.477434382463485, 24.18477979550758, 24.30868090192476, 34.36478007577048, 33.48578473428884, 34.3362025298799, 30.000873332222298, 29.961421483506754, 29.250369270642594, 19.581651003410414, 19.31932546695073, 19.37672820438941, 25.87226015826066, 26.251787602280572, 25.933437173565224, 18.92380681882301, 18.79179750631252, 18.9075343782703, 25.082468833153442, 24.69414122899373, 24.4755601187547, 21.709767286976174, 21.824769978721932, 21.703420137365654, 15.205901339650154, 15.48665261361748, 15.327493790537119, 28.763162347177655, 28.977575602630765, 28.964752147595078, 23.843746304512024, 23.865903697907925, 23.489840373396873, 27.4981648363173, 27.15426080673933, 27.495711658149958, 25.11486245443423, 24.95748760302861, 24.561971147855118, 22.626465653379753, 23.154950916146234, 23.01401116078098, 25.09634919961293, 25.505474997063473, 25.179634993275002, 31.664239952961594, 31.38479788104692, 31.703105105708033, 24.62827120224634, 24.520218337575585, 24.288846815625817, 17.05095306970179, 16.094640791416168, 17.05676349811256, 30.943850219249725, 31.115455977618694, 31.389705181121826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14129103857293782, "mean_inference_ms": 0.6494422865480604, "mean_action_processing_ms": 0.09503924724940235, "mean_env_wait_ms": 0.7960360816652513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1060800, "timesteps_this_iter": 0, "agent_timesteps_total": 3182400, "timers": {"sample_time_ms": 9409.824, "sample_throughput": 510.105, "load_time_ms": 0.307, "load_throughput": 15639446.283, "learn_time_ms": 1204.757, "learn_throughput": 3984.207, "update_time_ms": 1.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028508716821670534, "cur_lr": 0.0005, "total_loss": 7.189508855342865, "policy_loss": -0.0016769178615585467, "vf_loss": 7.3612253069877625, "vf_explained_var": 0.003928661346435547, "kl": 0.012175284617449862, "entropy": 17.038702964782715, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1060800, "num_agent_steps_sampled": 3182400, "num_steps_trained": 1060800, "num_agent_steps_trained": 3182400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4466, "training_iteration": 221, "trial_id": "03f88_00000", "experiment_id": "b40465194040480b83412adfa1859a6b", "date": "2024-01-25_03-17-18", "timestamp": 1706149038, "time_this_iter_s": 9.106407642364502, "time_total_s": 2075.886858224869, "pid": 26256, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 300, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000210633355E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2075.886858224869, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 7.433333333333334, "ram_util_percent": 48.775}}
